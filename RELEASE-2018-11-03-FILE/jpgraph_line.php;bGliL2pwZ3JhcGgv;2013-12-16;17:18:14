{
    "namaFile": "lib\/jpgraph\/jpgraph_line.php",
    "lastUpdate": "2013-12-16+17:18:14.00",
    "contentFile": "PD9waHAKLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogLy8gRmlsZTogIAkJIEpQR1JBUEhfTElORS5QSFAKIC8vIERlc2NyaXB0aW9uOiBMaW5lIHBsb3QgZXh0ZW5zaW9uIGZvciBKcEdyYXBoCiAvLyBDcmVhdGVkOiAgCSAyMDAxLTAxLTA4CiAvLyBWZXI6ICAJCSAkSWQ6IGpwZ3JhcGhfbGluZS5waHAgMTkyMSAyMDA5LTEyLTExIDExOjQ2OjM5WiBsanAgJAogLy8KIC8vIENvcHlyaWdodCAoYykgQXNpYWwgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogKi8KCnJlcXVpcmVfb25jZSAoJ2pwZ3JhcGhfcGxvdG1hcmsuaW5jLnBocCcpOwoKLy8gY29uc3RhbnRzIGZvciB0aGUgKGZpbGxlZCkgYXJlYQpERUZJTkUoIkxQX0FSRUFfRklMTEVEIiwgdHJ1ZSk7CkRFRklORSgiTFBfQVJFQV9OT1RfRklMTEVEIiwgZmFsc2UpOwpERUZJTkUoIkxQX0FSRUFfQk9SREVSIixmYWxzZSk7CkRFRklORSgiTFBfQVJFQV9OT19CT1JERVIiLHRydWUpOwoKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gQ0xBU1MgTGluZVBsb3QKLy8gRGVzY3JpcHRpb246Ci8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmNsYXNzIExpbmVQbG90IGV4dGVuZHMgUGxvdHsKICAgIHB1YmxpYyAkbWFyaz1udWxsOwogICAgcHJvdGVjdGVkICRmaWxsZWQ9ZmFsc2U7CiAgICBwcm90ZWN0ZWQgJGZpbGxfY29sb3I9J2JsdWUnOwogICAgcHJvdGVjdGVkICRzdGVwX3N0eWxlPWZhbHNlLCAkY2VudGVyPWZhbHNlOwogICAgcHJvdGVjdGVkICRsaW5lX3N0eWxlPTE7IC8vIERlZmF1bHQgdG8gc29saWQKICAgIHByb3RlY3RlZCAkZmlsbGVkQXJlYXMgPSBhcnJheSgpOyAvLyBhcnJheSBvZiBhcnJheXMod2l0aCBtaW4sbWF4LGNvbCxmaWxsZWQgaW4gdGhlbSkKICAgIHB1YmxpYyAkYmFyY2VudGVyPWZhbHNlOyAgLy8gV2hlbiB3ZSBtaXggbGluZSBhbmQgYmFyLiBTaG91bGQgd2UgY2VudGVyIHRoZSBsaW5lIGluIHRoZSBiYXIuCiAgICBwcm90ZWN0ZWQgJGZpbGxGcm9tTWluID0gZmFsc2UsICRmaWxsRnJvbU1heCA9IGZhbHNlOwogICAgcHJvdGVjdGVkICRmaWxsZ3JhZD1mYWxzZSwkZmlsbGdyYWRfZnJvbWNvbG9yPSduYXZ5JywkZmlsbGdyYWRfdG9jb2xvcj0nc2lsdmVyJywkZmlsbGdyYWRfbnVtY29sb3JzPTEwMDsKICAgIHByb3RlY3RlZCAkaUZhc3RTdHJva2U9ZmFsc2U7CgogICAgLy8tLS0tLS0tLS0tLS0tLS0KICAgIC8vIENPTlNUUlVDVE9SCiAgICBmdW5jdGlvbiBMaW5lUGxvdCgkZGF0YXksJGRhdGF4PWZhbHNlKSB7CiAgICAgICAgcGFyZW50OjpfX2NvbnN0cnVjdCgkZGF0YXksJGRhdGF4KTsKICAgICAgICAkdGhpcy0+bWFyayA9IG5ldyBQbG90TWFyaygpIDsKICAgICAgICAkdGhpcy0+Y29sb3IgPSBDb2xvckZhY3Rvcnk6OmdldENvbG9yKCk7CiAgICAgICAgJHRoaXMtPmZpbGxfY29sb3IgPSAkdGhpcy0+Y29sb3I7CiAgICB9CiAgICAvLy0tLS0tLS0tLS0tLS0tLQogICAgLy8gUFVCTElDIE1FVEhPRFMKCiAgICBmdW5jdGlvbiBTZXRGaWxsZWQoJGFGbGc9dHJ1ZSkgewoJCSR0aGlzLT5maWxsZWQgPSAkYUZsZzsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRCYXJDZW50ZXIoJGFGbGFnPXRydWUpIHsKICAgICAgICAkdGhpcy0+YmFyY2VudGVyPSRhRmxhZzsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRTdHlsZSgkYVN0eWxlKSB7CiAgICAgICAgJHRoaXMtPmxpbmVfc3R5bGU9JGFTdHlsZTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRTdGVwU3R5bGUoJGFGbGFnPXRydWUpIHsKICAgICAgICAkdGhpcy0+c3RlcF9zdHlsZSA9ICRhRmxhZzsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRDb2xvcigkYUNvbG9yKSB7CiAgICAgICAgcGFyZW50OjpTZXRDb2xvcigkYUNvbG9yKTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRGaWxsRnJvbVlNaW4oJGY9dHJ1ZSkgewogICAgICAgICR0aGlzLT5maWxsRnJvbU1pbiA9ICRmIDsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRGaWxsRnJvbVlNYXgoJGY9dHJ1ZSkgewogICAgICAgICR0aGlzLT5maWxsRnJvbU1heCA9ICRmIDsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRGaWxsQ29sb3IoJGFDb2xvciwkYUZpbGxlZD10cnVlKSB7CiAgICAJLy8kdGhpcy0+Y29sb3IgPSAkYUNvbG9yOwogICAgICAgICR0aGlzLT5maWxsX2NvbG9yPSRhQ29sb3I7CiAgICAgICAgJHRoaXMtPmZpbGxlZD0kYUZpbGxlZDsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRGaWxsR3JhZGllbnQoJGFGcm9tQ29sb3IsJGFUb0NvbG9yLCRhTnVtQ29sb3JzPTEwMCwkYUZpbGxlZD10cnVlKSB7CiAgICAgICAgJHRoaXMtPmZpbGxncmFkX2Zyb21jb2xvciA9ICRhRnJvbUNvbG9yOwogICAgICAgICR0aGlzLT5maWxsZ3JhZF90b2NvbG9yICAgPSAkYVRvQ29sb3I7CiAgICAgICAgJHRoaXMtPmZpbGxncmFkX251bWNvbG9ycyA9ICRhTnVtQ29sb3JzOwogICAgICAgICR0aGlzLT5maWxsZWQgPSAkYUZpbGxlZDsKICAgICAgICAkdGhpcy0+ZmlsbGdyYWQgPSB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIExlZ2VuZCgkZ3JhcGgpIHsKICAgICAgICBpZiggJHRoaXMtPmxlZ2VuZCE9IiIgKSB7CiAgICAgICAgICAgIGlmKCAkdGhpcy0+ZmlsbGVkICYmICEkdGhpcy0+ZmlsbGdyYWQgKSB7CiAgICAgICAgICAgICAgICAkZ3JhcGgtPmxlZ2VuZC0+QWRkKCR0aGlzLT5sZWdlbmQsCiAgICAgICAgICAgICAgICAkdGhpcy0+ZmlsbF9jb2xvciwkdGhpcy0+bWFyaywwLAogICAgICAgICAgICAgICAgJHRoaXMtPmxlZ2VuZGNzaW10YXJnZXQsJHRoaXMtPmxlZ2VuZGNzaW1hbHQsJHRoaXMtPmxlZ2VuZGNzaW13aW50YXJnZXQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2VpZiggJHRoaXMtPmZpbGxncmFkICkgewogICAgICAgICAgICAgICAgJGNvbG9yPWFycmF5KCR0aGlzLT5maWxsZ3JhZF9mcm9tY29sb3IsJHRoaXMtPmZpbGxncmFkX3RvY29sb3IpOwogICAgICAgICAgICAgICAgLy8gSW4gb3JkZXIgdG8gZGlmZmVyZW50aWF0ZSBiZXR3ZWVuIGdyYWRpZW50cyBhbmQgY29vb3JzIHNwZWNpZmllZCBhcyBhbiBSR0IgdHJpcGxlCiAgICAgICAgICAgICAgICAkZ3JhcGgtPmxlZ2VuZC0+QWRkKCR0aGlzLT5sZWdlbmQsJGNvbG9yLCIiLC0yIC8qIC1HUkFEX0hPUiAqLywKICAgICAgICAgICAgICAgICR0aGlzLT5sZWdlbmRjc2ltdGFyZ2V0LCR0aGlzLT5sZWdlbmRjc2ltYWx0LCR0aGlzLT5sZWdlbmRjc2ltd2ludGFyZ2V0KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICRncmFwaC0+bGVnZW5kLT5BZGQoJHRoaXMtPmxlZ2VuZCwKICAgICAgICAgICAgICAgICR0aGlzLT5jb2xvciwkdGhpcy0+bWFyaywkdGhpcy0+bGluZV9zdHlsZSwKICAgICAgICAgICAgICAgICR0aGlzLT5sZWdlbmRjc2ltdGFyZ2V0LCR0aGlzLT5sZWdlbmRjc2ltYWx0LCR0aGlzLT5sZWdlbmRjc2ltd2ludGFyZ2V0KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBBZGRBcmVhKCRhTWluPTAsJGFNYXg9MCwkYUZpbGxlZD1MUF9BUkVBX05PVF9GSUxMRUQsJGFDb2xvcj0iZ3JheTkiLCRhQm9yZGVyPUxQX0FSRUFfQk9SREVSKSB7CiAgICAgICAgaWYoJGFNaW4gPiAkYU1heCkgewogICAgICAgICAgICAvLyBzd2FwCiAgICAgICAgICAgICR0bXAgPSAkYU1pbjsKICAgICAgICAgICAgJGFNaW4gPSAkYU1heDsKICAgICAgICAgICAgJGFNYXggPSAkdG1wOwogICAgICAgIH0KICAgICAgICAkdGhpcy0+ZmlsbGVkQXJlYXNbXSA9IGFycmF5KCRhTWluLCRhTWF4LCRhQ29sb3IsJGFGaWxsZWQsJGFCb3JkZXIpOwogICAgfQoKICAgIC8vIEdldHMgY2FsbGVkIGJlZm9yZSBhbnkgYXhpcyBhcmUgc3Ryb2tlZAogICAgZnVuY3Rpb24gUHJlU3Ryb2tlQWRqdXN0KCRncmFwaCkgewoKICAgICAgICAvLyBJZiBhbm90aGVyIHBsb3QgdHlwZSBoYXZlIGFscmVhZHkgYWRqdXN0ZWQgdGhlCiAgICAgICAgLy8gb2Zmc2V0IHdlIGRvbid0IHRvdWNoIGl0LgogICAgICAgIC8vIChXZSBjaGVjayBmb3IgZW1wdHkgaW4gY2FzZSB0aGUgc2NhbGUgaXMgIGEgbG9nIHNjYWxlCiAgICAgICAgLy8gYW5kIGhlbmNlIGRvZXNuJ3QgY29udGFpbiBhbnkgeGxhYmVsX29mZnNldCkKICAgICAgICBpZiggZW1wdHkoJGdyYXBoLT54YXhpcy0+c2NhbGUtPnRpY2tzLT54bGFiZWxfb2Zmc2V0KSB8fCAkZ3JhcGgtPnhheGlzLT5zY2FsZS0+dGlja3MtPnhsYWJlbF9vZmZzZXQgPT0gMCApIHsKICAgICAgICAgICAgaWYoICR0aGlzLT5jZW50ZXIgKSB7CiAgICAgICAgICAgICAgICArKyR0aGlzLT5udW1wb2ludHM7CiAgICAgICAgICAgICAgICAkYT0wLjU7ICRiPTAuNTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICRhPTA7ICRiPTA7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJGdyYXBoLT54YXhpcy0+c2NhbGUtPnRpY2tzLT5TZXRYTGFiZWxPZmZzZXQoJGEpOwogICAgICAgICAgICAkZ3JhcGgtPlNldFRleHRTY2FsZU9mZigkYik7CiAgICAgICAgICAgIC8vJGdyYXBoLT54YXhpcy0+c2NhbGUtPnRpY2tzLT5TdXByZXNzTWlub3JUaWNrTWFya3MoKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gU2V0RmFzdFN0cm9rZSgkYUZsZz10cnVlKSB7CiAgICAgICAgJHRoaXMtPmlGYXN0U3Ryb2tlID0gJGFGbGc7CiAgICB9CgogICAgZnVuY3Rpb24gRmFzdFN0cm9rZSgkaW1nLCR4c2NhbGUsJHlzY2FsZSwkYVN0YXJ0UG9pbnQ9MCwkZXhpc3RfeD10cnVlKSB7CiAgICAgICAgLy8gQW4gb3B0aW1pemVkIHN0cm9rZSBmb3IgbWFueSBkYXRhIHBvaW50cyB3aXRoIG5vIGV4dHJhCiAgICAgICAgLy8gZmVhdHVyZXMgYnV0IDYwJSBmYXN0ZXIuIFlvdSBjYW4ndCBoYXZlIHZhbHVlcyBvciBsaW5lIHN0eWxlcywgb3IgbnVsbAogICAgICAgIC8vIHZhbHVlcyBpbiBwbG90cy4KICAgICAgICAkbnVtcG9pbnRzPWNvdW50KCR0aGlzLT5jb29yZHNbMF0pOwogICAgICAgIGlmKCAkdGhpcy0+YmFyY2VudGVyICkgewogICAgICAgICAgICAkdGV4dGFkaiA9IDAuNS0keHNjYWxlLT50ZXh0X3NjYWxlX29mZjsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICR0ZXh0YWRqID0gMDsKICAgICAgICB9CgogICAgICAgICRpbWctPlNldENvbG9yKCR0aGlzLT5jb2xvcik7CiAgICAgICAgJGltZy0+U2V0TGluZVdlaWdodCgkdGhpcy0+d2VpZ2h0KTsKICAgICAgICAkcG50cz0kYVN0YXJ0UG9pbnQ7CiAgICAgICAgd2hpbGUoICRwbnRzIDwgJG51bXBvaW50cyApIHsKICAgICAgICAgICAgaWYoICRleGlzdF94ICkgewogICAgICAgICAgICAgICAgJHg9JHRoaXMtPmNvb3Jkc1sxXVskcG50c107CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAkeD0kcG50cyskdGV4dGFkajsKICAgICAgICAgICAgfQogICAgICAgICAgICAkeHQgPSAkeHNjYWxlLT5UcmFuc2xhdGUoJHgpOwogICAgICAgICAgICAkeT0kdGhpcy0+Y29vcmRzWzBdWyRwbnRzXTsKICAgICAgICAgICAgJHl0ID0gJHlzY2FsZS0+VHJhbnNsYXRlKCR5KTsKICAgICAgICAgICAgaWYoIGlzX251bWVyaWMoJHkpICkgewogICAgICAgICAgICAgICAgJGNvcmRbXSA9ICR4dDsKICAgICAgICAgICAgICAgICRjb3JkW10gPSAkeXQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZWlmKCAkeSA9PSAnLScgJiYgJHBudHMgPiAwICkgewogICAgICAgICAgICAgICAgLy8gSnVzdCBpZ25vcmUKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDEwMDAyKTsvLygnUGxvdCB0b28gY29tcGxpY2F0ZWQgZm9yIGZhc3QgbGluZSBTdHJva2UuIFVzZSBzdGFuZGFyZCBTdHJva2UoKScpOwogICAgICAgICAgICB9CiAgICAgICAgICAgICsrJHBudHM7CiAgICAgICAgfSAvLyBXSElMRQoKICAgICAgICAkaW1nLT5Qb2x5Z29uKCRjb3JkLGZhbHNlLHRydWUpOwogICAgfQoKICAgIGZ1bmN0aW9uIFN0cm9rZSgkaW1nLCR4c2NhbGUsJHlzY2FsZSkgewogICAgICAgICRpZHg9MDsKICAgICAgICAkbnVtcG9pbnRzPWNvdW50KCR0aGlzLT5jb29yZHNbMF0pOwogICAgICAgIGlmKCBpc3NldCgkdGhpcy0+Y29vcmRzWzFdKSApIHsKICAgICAgICAgICAgaWYoIGNvdW50KCR0aGlzLT5jb29yZHNbMV0pIT0kbnVtcG9pbnRzICkgewogICAgICAgICAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoMjAwMyxjb3VudCgkdGhpcy0+Y29vcmRzWzFdKSwkbnVtcG9pbnRzKTsKICAgICAgICAgICAgLy8oIk51bWJlciBvZiBYIGFuZCBZIHBvaW50cyBhcmUgbm90IGVxdWFsLiBOdW1iZXIgb2YgWC1wb2ludHM6Ii5jb3VudCgkdGhpcy0+Y29vcmRzWzFdKS4iIE51bWJlciBvZiBZLXBvaW50czokbnVtcG9pbnRzIik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAkZXhpc3RfeCA9IHRydWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICRleGlzdF94ID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICBpZiggJHRoaXMtPmJhcmNlbnRlciApIHsKICAgICAgICAgICAgJHRleHRhZGogPSAwLjUtJHhzY2FsZS0+dGV4dF9zY2FsZV9vZmY7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAkdGV4dGFkaiA9IDA7CiAgICAgICAgfQoKICAgICAgICAvLyBGaW5kIHRoZSBmaXJzdCBudW1lcmljIGRhdGEgcG9pbnQKICAgICAgICAkc3RhcnRwb2ludD0wOwogICAgICAgIHdoaWxlKCAkc3RhcnRwb2ludCA8ICRudW1wb2ludHMgJiYgIWlzX251bWVyaWMoJHRoaXMtPmNvb3Jkc1swXVskc3RhcnRwb2ludF0pICkgewogICAgICAgICAgICArKyRzdGFydHBvaW50OwogICAgICAgIH0KCiAgICAgICAgLy8gQmFpbCBvdXQgaWYgbm8gZGF0YSBwb2ludHMKICAgICAgICBpZiggJHN0YXJ0cG9pbnQgPT0gJG51bXBvaW50cyApIHJldHVybjsKCiAgICAgICAgaWYoICR0aGlzLT5pRmFzdFN0cm9rZSApIHsKICAgICAgICAgICAgJHRoaXMtPkZhc3RTdHJva2UoJGltZywkeHNjYWxlLCR5c2NhbGUsJHN0YXJ0cG9pbnQsJGV4aXN0X3gpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiggJGV4aXN0X3ggKSB7CiAgICAgICAgICAgICR4cz0kdGhpcy0+Y29vcmRzWzFdWyRzdGFydHBvaW50XTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICR4cz0gJHRleHRhZGorJHN0YXJ0cG9pbnQ7CiAgICAgICAgfQoKICAgICAgICAkaW1nLT5TZXRTdGFydFBvaW50KCR4c2NhbGUtPlRyYW5zbGF0ZSgkeHMpLAogICAgICAgICR5c2NhbGUtPlRyYW5zbGF0ZSgkdGhpcy0+Y29vcmRzWzBdWyRzdGFydHBvaW50XSkpOwoKICAgICAgICBpZiggJHRoaXMtPmZpbGxlZCApIHsKICAgICAgICAgICAgaWYoICR0aGlzLT5maWxsRnJvbU1heCApIHsKICAgICAgICAgICAgICAgIC8vJG1heCA9ICR5c2NhbGUtPkdldE1heFZhbCgpOwogICAgICAgICAgICAgICAgJGNvcmRbJGlkeCsrXSA9ICR4c2NhbGUtPlRyYW5zbGF0ZSgkeHMpOwogICAgICAgICAgICAgICAgJGNvcmRbJGlkeCsrXSA9ICR5c2NhbGUtPnNjYWxlX2Fic1sxXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICRtaW4gPSAkeXNjYWxlLT5HZXRNaW5WYWwoKTsKICAgICAgICAgICAgICAgIGlmKCAkbWluID4gMCB8fCAkdGhpcy0+ZmlsbEZyb21NaW4gKSB7CiAgICAgICAgICAgICAgICAgICAgJGZpbGxtaW4gPSAkeXNjYWxlLT5zY2FsZV9hYnNbMF07Ly9UcmFuc2xhdGUoJG1pbik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkZmlsbG1pbiA9ICR5c2NhbGUtPlRyYW5zbGF0ZSgwKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkY29yZFskaWR4KytdID0gJHhzY2FsZS0+VHJhbnNsYXRlKCR4cyk7CiAgICAgICAgICAgICAgICAkY29yZFskaWR4KytdID0gJGZpbGxtaW47CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgJHh0ID0gJHhzY2FsZS0+VHJhbnNsYXRlKCR4cyk7CiAgICAgICAgJHl0ID0gJHlzY2FsZS0+VHJhbnNsYXRlKCR0aGlzLT5jb29yZHNbMF1bJHN0YXJ0cG9pbnRdKTsKICAgICAgICAkY29yZFskaWR4KytdID0gJHh0OwogICAgICAgICRjb3JkWyRpZHgrK10gPSAkeXQ7CiAgICAgICAgJHl0X29sZCA9ICR5dDsKICAgICAgICAkeHRfb2xkID0gJHh0OwogICAgICAgICR5X29sZCA9ICR0aGlzLT5jb29yZHNbMF1bJHN0YXJ0cG9pbnRdOwoKICAgICAgICAkdGhpcy0+dmFsdWUtPlN0cm9rZSgkaW1nLCR0aGlzLT5jb29yZHNbMF1bJHN0YXJ0cG9pbnRdLCR4dCwkeXQpOwoKICAgICAgICAkaW1nLT5TZXRDb2xvcigkdGhpcy0+Y29sb3IpOwogICAgICAgICRpbWctPlNldExpbmVXZWlnaHQoJHRoaXMtPndlaWdodCk7CiAgICAgICAgJGltZy0+U2V0TGluZVN0eWxlKCR0aGlzLT5saW5lX3N0eWxlKTsKICAgICAgICAkcG50cz0kc3RhcnRwb2ludCsxOwogICAgICAgICRmaXJzdG5vbnVtZXJpYyA9IGZhbHNlOwoKCiAgICAgICAgd2hpbGUoICRwbnRzIDwgJG51bXBvaW50cyApIHsKCiAgICAgICAgICAgIGlmKCAkZXhpc3RfeCApIHsKICAgICAgICAgICAgICAgICR4PSR0aGlzLT5jb29yZHNbMV1bJHBudHNdOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgJHg9JHBudHMrJHRleHRhZGo7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJHh0ID0gJHhzY2FsZS0+VHJhbnNsYXRlKCR4KTsKICAgICAgICAgICAgJHl0ID0gJHlzY2FsZS0+VHJhbnNsYXRlKCR0aGlzLT5jb29yZHNbMF1bJHBudHNdKTsKCiAgICAgICAgICAgICR5PSR0aGlzLT5jb29yZHNbMF1bJHBudHNdOwogICAgICAgICAgICBpZiggJHRoaXMtPnN0ZXBfc3R5bGUgKSB7CiAgICAgICAgICAgICAgICAvLyBUbyBoYW5kbGUgbnVsbCB2YWx1ZXMgd2l0aGluIHN0ZXAgc3R5bGUgd2UgbmVlZCB0byByZWNvcmQgdGhlCiAgICAgICAgICAgICAgICAvLyBmaXJzdCBub24gbnVtZXJpYyB2YWx1ZSBzbyB3ZSBrbm93IGZyb20gd2hlcmUgdG8gc3RhcnQgaWYgdGhlCiAgICAgICAgICAgICAgICAvLyBub24gdmFsdWUgaXMgJy0nLgogICAgICAgICAgICAgICAgaWYoIGlzX251bWVyaWMoJHkpICkgewogICAgICAgICAgICAgICAgICAgICRmaXJzdG5vbnVtZXJpYyA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIGlmKCBpc19udW1lcmljKCR5X29sZCkgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRpbWctPlN0eWxlTGluZSgkeHRfb2xkLCR5dF9vbGQsJHh0LCR5dF9vbGQpOwogICAgICAgICAgICAgICAgICAgICAgICAkaW1nLT5TdHlsZUxpbmUoJHh0LCR5dF9vbGQsJHh0LCR5dCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiggJHlfb2xkID09ICctJyApIHsKICAgICAgICAgICAgICAgICAgICAgICAgJGltZy0+U3R5bGVMaW5lKCR4dF9maXJzdCwkeXRfZmlyc3QsJHh0LCR5dF9maXJzdCk7CiAgICAgICAgICAgICAgICAgICAgICAgICRpbWctPlN0eWxlTGluZSgkeHQsJHl0X2ZpcnN0LCR4dCwkeXQpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHl0X29sZCA9ICR5dDsKICAgICAgICAgICAgICAgICAgICAgICAgJHh0X29sZCA9ICR4dDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJGNvcmRbJGlkeCsrXSA9ICR4dDsKICAgICAgICAgICAgICAgICAgICAkY29yZFskaWR4KytdID0gJHl0X29sZDsKICAgICAgICAgICAgICAgICAgICAkY29yZFskaWR4KytdID0gJHh0OwogICAgICAgICAgICAgICAgICAgICRjb3JkWyRpZHgrK10gPSAkeXQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlaWYoICRmaXJzdG5vbnVtZXJpYz09ZmFsc2UgKSB7CiAgICAgICAgICAgICAgICAgICAgJGZpcnN0bm9udW1lcmljID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAkeXRfZmlyc3QgPSAkeXRfb2xkOwogICAgICAgICAgICAgICAgICAgICR4dF9maXJzdCA9ICR4dF9vbGQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAkdG1wMT0keTsKICAgICAgICAgICAgICAgICRwcmV2PSR0aGlzLT5jb29yZHNbMF1bJHBudHMtMV07CiAgICAgICAgICAgICAgICBpZiggJHRtcDE9PT0nJyB8fCAkdG1wMT09PU5VTEwgfHwgJHRtcDE9PT0nWCcgKSAkdG1wMSA9ICd4JzsKICAgICAgICAgICAgICAgIGlmKCAkcHJldj09PScnIHx8ICRwcmV2PT09bnVsbCB8fCAkcHJldj09PSdYJyApICRwcmV2ID0gJ3gnOwoKICAgICAgICAgICAgICAgIGlmKCBpc19udW1lcmljKCR5KSB8fCAoaXNfc3RyaW5nKCR5KSAmJiAkeSAhPSAnLScpICkgewogICAgICAgICAgICAgICAgICAgIGlmKCBpc19udW1lcmljKCR5KSAmJiAoaXNfbnVtZXJpYygkcHJldikgfHwgJHByZXYgPT09ICctJyApICkgewogICAgICAgICAgICAgICAgICAgICAgICAkaW1nLT5TdHlsZUxpbmVUbygkeHQsJHl0KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRpbWctPlNldFN0YXJ0UG9pbnQoJHh0LCR5dCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYoICR0aGlzLT5maWxsZWQgJiYgJHRtcDEgIT09ICctJyApIHsKICAgICAgICAgICAgICAgICAgICBpZiggJHRtcDEgPT09ICd4JyApIHsKICAgICAgICAgICAgICAgICAgICAgICAgJGNvcmRbJGlkeCsrXSA9ICRjb3JkWyRpZHgtM107CiAgICAgICAgICAgICAgICAgICAgICAgICRjb3JkWyRpZHgrK10gPSAkZmlsbG1pbjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZWlmKCAkcHJldiA9PT0gJ3gnICkgewogICAgICAgICAgICAgICAgICAgICAgICAkY29yZFskaWR4KytdID0gJHh0OwogICAgICAgICAgICAgICAgICAgICAgICAkY29yZFskaWR4KytdID0gJGZpbGxtaW47CiAgICAgICAgICAgICAgICAgICAgICAgICRjb3JkWyRpZHgrK10gPSAkeHQ7CiAgICAgICAgICAgICAgICAgICAgICAgICRjb3JkWyRpZHgrK10gPSAkeXQ7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAkY29yZFskaWR4KytdID0gJHh0OwogICAgICAgICAgICAgICAgICAgICAgICAkY29yZFskaWR4KytdID0gJHl0OwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIGlmKCBpc19udW1lcmljKCR0bXAxKSAgJiYgKGlzX251bWVyaWMoJHByZXYpIHx8ICRwcmV2ID09PSAnLScgKSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgJGNvcmRbJGlkeCsrXSA9ICR4dDsKICAgICAgICAgICAgICAgICAgICAgICAgJGNvcmRbJGlkeCsrXSA9ICR5dDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJHl0X29sZCA9ICR5dDsKICAgICAgICAgICAgJHh0X29sZCA9ICR4dDsKICAgICAgICAgICAgJHlfb2xkID0gJHk7CgogICAgICAgICAgICAkdGhpcy0+U3Ryb2tlRGF0YVZhbHVlKCRpbWcsJHRoaXMtPmNvb3Jkc1swXVskcG50c10sJHh0LCR5dCk7CgogICAgICAgICAgICArKyRwbnRzOwogICAgICAgIH0KCiAgICAgICAgaWYoICR0aGlzLT5maWxsZWQgICkgewogICAgICAgICAgICAkY29yZFskaWR4KytdID0gJHh0OwogICAgICAgICAgICBpZiggJHRoaXMtPmZpbGxGcm9tTWF4ICkgewogICAgICAgICAgICAgICAgJGNvcmRbJGlkeCsrXSA9ICR5c2NhbGUtPnNjYWxlX2Fic1sxXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIGlmKCAkbWluID4gMCB8fCAkdGhpcy0+ZmlsbEZyb21NaW4gKSB7CiAgICAgICAgICAgICAgICAgICAgJGNvcmRbJGlkeCsrXSA9ICR5c2NhbGUtPlRyYW5zbGF0ZSgkbWluKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICRjb3JkWyRpZHgrK10gPSAkeXNjYWxlLT5UcmFuc2xhdGUoMCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoICR0aGlzLT5maWxsZ3JhZCApIHsKICAgICAgICAgICAgICAgICRpbWctPlNldExpbmVXZWlnaHQoMSk7CiAgICAgICAgICAgICAgICAkZ3JhZCA9IG5ldyBHcmFkaWVudCgkaW1nKTsKICAgICAgICAgICAgICAgICRncmFkLT5TZXROdW1Db2xvcnMoJHRoaXMtPmZpbGxncmFkX251bWNvbG9ycyk7CiAgICAgICAgICAgICAgICAkZ3JhZC0+RmlsbGVkRmxhdFBvbHlnb24oJGNvcmQsJHRoaXMtPmZpbGxncmFkX2Zyb21jb2xvciwkdGhpcy0+ZmlsbGdyYWRfdG9jb2xvcik7CiAgICAgICAgICAgICAgICAkaW1nLT5TZXRMaW5lV2VpZ2h0KCR0aGlzLT53ZWlnaHQpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgJGltZy0+U2V0Q29sb3IoJHRoaXMtPmZpbGxfY29sb3IpOwogICAgICAgICAgICAgICAgJGltZy0+RmlsbGVkUG9seWdvbigkY29yZCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoICR0aGlzLT53ZWlnaHQgPiAwICkgeyAKICAgICAgICAgICAgICAgICRpbWctPlNldExpbmVXZWlnaHQoJHRoaXMtPndlaWdodCk7CiAgICAgICAgICAgICAgICAkaW1nLT5TZXRDb2xvcigkdGhpcy0+Y29sb3IpOwogICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGZpcnN0IGFuZCBsYXN0IGNvb3JkaW5hdGUgYmVmb3JlIGRyYXdpbmcgdGhlIGxpbmUKICAgICAgICAgICAgICAgIC8vIHNpbmUgd2Ugb3RoZXJ3aXNlIGdldCB0aGUgdmVydGljYWwgc3RhcnQgYW5kIGVuZCBsaW5lcyB3aGljaAogICAgICAgICAgICAgICAgLy8gZG9lc24ndCBsb29rIGFwcHJvcHJpYXRlCiAgICAgICAgICAgICAgICAkaW1nLT5Qb2x5Z29uKGFycmF5X3NsaWNlKCRjb3JkLDIsY291bnQoJGNvcmQpLTQpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYoIWVtcHR5KCR0aGlzLT5maWxsZWRBcmVhcykpIHsKCiAgICAgICAgICAgICRtaW5ZID0gJHlzY2FsZS0+VHJhbnNsYXRlKCR5c2NhbGUtPkdldE1pblZhbCgpKTsKICAgICAgICAgICAgJGZhY3RvciA9ICgkdGhpcy0+c3RlcF9zdHlsZSA\/IDQgOiAyKTsKCiAgICAgICAgICAgIGZvcigkaSA9IDA7ICRpIDwgc2l6ZW9mKCR0aGlzLT5maWxsZWRBcmVhcyk7ICsrJGkpIHsKICAgICAgICAgICAgICAgIC8vIGdvIHRocm91Z2ggYWxsIGZpbGxlZCBhcmVhIGVsZW1lbnRzIG9yZGVyZWQgYnkgaW5zZXJ0aW9uCiAgICAgICAgICAgICAgICAvLyBmaWxsIHBvbHlnb24gYXJyYXkKICAgICAgICAgICAgICAgICRhcmVhQ29vcmRzW10gPSAkY29yZFskdGhpcy0+ZmlsbGVkQXJlYXNbJGldWzBdICogJGZhY3Rvcl07CiAgICAgICAgICAgICAgICAkYXJlYUNvb3Jkc1tdID0gJG1pblk7CgogICAgICAgICAgICAgICAgJGFyZWFDb29yZHMgPQogICAgICAgICAgICAgICAgYXJyYXlfbWVyZ2UoJGFyZWFDb29yZHMsCiAgICAgICAgICAgICAgICBhcnJheV9zbGljZSgkY29yZCwKICAgICAgICAgICAgICAgICR0aGlzLT5maWxsZWRBcmVhc1skaV1bMF0gKiAkZmFjdG9yLAogICAgICAgICAgICAgICAgKCR0aGlzLT5maWxsZWRBcmVhc1skaV1bMV0gLSAkdGhpcy0+ZmlsbGVkQXJlYXNbJGldWzBdICsgKCR0aGlzLT5zdGVwX3N0eWxlID8gMCA6IDEpKSAgKiAkZmFjdG9yKSk7CiAgICAgICAgICAgICAgICAkYXJlYUNvb3Jkc1tdID0gJGFyZWFDb29yZHNbc2l6ZW9mKCRhcmVhQ29vcmRzKS0yXTsgLy8gbGFzdCB4CiAgICAgICAgICAgICAgICAkYXJlYUNvb3Jkc1tdID0gJG1pblk7IC8vIGxhc3QgeQoKICAgICAgICAgICAgICAgIGlmKCR0aGlzLT5maWxsZWRBcmVhc1skaV1bM10pIHsKICAgICAgICAgICAgICAgICAgICAkaW1nLT5TZXRDb2xvcigkdGhpcy0+ZmlsbGVkQXJlYXNbJGldWzJdKTsKICAgICAgICAgICAgICAgICAgICAkaW1nLT5GaWxsZWRQb2x5Z29uKCRhcmVhQ29vcmRzKTsKICAgICAgICAgICAgICAgICAgICAkaW1nLT5TZXRDb2xvcigkdGhpcy0+Y29sb3IpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgd2Ugc2hvdWxkIGRyYXcgdGhlIGZyYW1lLgogICAgICAgICAgICAgICAgLy8gSWYgbm90IHdlIHN0aWxsIHJlLWRyYXcgdGhlIGxpbmUgc2luY2UgaXQgbWlnaHQgaGF2ZSBiZWVuCiAgICAgICAgICAgICAgICAvLyBwYXJ0aWFsbHkgb3ZlcndyaXR0ZW4gYnkgdGhlIGZpbGxlZCBhcmVhIGFuZCBpdCBkb2Vzbid0IGxvb2sKICAgICAgICAgICAgICAgIC8vIHZlcnkgZ29vZC4KICAgICAgICAgICAgICAgIGlmKCAkdGhpcy0+ZmlsbGVkQXJlYXNbJGldWzRdICkgewogICAgICAgICAgICAgICAgICAgICRpbWctPlBvbHlnb24oJGFyZWFDb29yZHMpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJGltZy0+UG9seWdvbigkY29yZCk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgJGFyZWFDb29yZHMgPSBhcnJheSgpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiggJHRoaXMtPm1hcmstPnR5cGUgPT0gLTEgfHwgJHRoaXMtPm1hcmstPnNob3cgPT0gZmFsc2UgKQogICAgICAgIHJldHVybjsKCiAgICAgICAgZm9yKCAkcG50cz0wOyAkcG50czwkbnVtcG9pbnRzOyArKyRwbnRzKSB7CgogICAgICAgICAgICBpZiggJGV4aXN0X3ggKSB7CiAgICAgICAgICAgICAgICAkeD0kdGhpcy0+Y29vcmRzWzFdWyRwbnRzXTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICR4PSRwbnRzKyR0ZXh0YWRqOwogICAgICAgICAgICB9CiAgICAgICAgICAgICR4dCA9ICR4c2NhbGUtPlRyYW5zbGF0ZSgkeCk7CiAgICAgICAgICAgICR5dCA9ICR5c2NhbGUtPlRyYW5zbGF0ZSgkdGhpcy0+Y29vcmRzWzBdWyRwbnRzXSk7CgogICAgICAgICAgICBpZiggaXNfbnVtZXJpYygkdGhpcy0+Y29vcmRzWzBdWyRwbnRzXSkgKSB7CiAgICAgICAgICAgICAgICBpZiggIWVtcHR5KCR0aGlzLT5jc2ltdGFyZ2V0c1skcG50c10pICkgewogICAgICAgICAgICAgICAgICAgIGlmKCAhZW1wdHkoJHRoaXMtPmNzaW13aW50YXJnZXRzWyRwbnRzXSkgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5tYXJrLT5TZXRDU0lNVGFyZ2V0KCR0aGlzLT5jc2ltdGFyZ2V0c1skcG50c10sJHRoaXMtPmNzaW13aW50YXJnZXRzWyRwbnRzXSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+bWFyay0+U2V0Q1NJTVRhcmdldCgkdGhpcy0+Y3NpbXRhcmdldHNbJHBudHNdKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm1hcmstPlNldENTSU1BbHQoJHRoaXMtPmNzaW1hbHRzWyRwbnRzXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiggJGV4aXN0X3ggKSB7CiAgICAgICAgICAgICAgICAgICAgJHg9JHRoaXMtPmNvb3Jkc1sxXVskcG50c107CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkeD0kcG50czsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICR0aGlzLT5tYXJrLT5TZXRDU0lNQWx0VmFsKCR0aGlzLT5jb29yZHNbMF1bJHBudHNdLCR4KTsKICAgICAgICAgICAgICAgICR0aGlzLT5tYXJrLT5TdHJva2UoJGltZywkeHQsJHl0KTsKICAgICAgICAgICAgICAgICR0aGlzLT5jc2ltYXJlYXMgLj0gJHRoaXMtPm1hcmstPkdldENTSU1BcmVhcygpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9IC8vIENsYXNzCgoKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gQ0xBU1MgQWNjTGluZVBsb3QKLy8gRGVzY3JpcHRpb246Ci8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmNsYXNzIEFjY0xpbmVQbG90IGV4dGVuZHMgUGxvdCB7CiAgICBwcm90ZWN0ZWQgJHBsb3RzPW51bGwsJG5icnBsb3RzPTA7CiAgICBwcml2YXRlICRpU3RhcnRFbmRaZXJvPXRydWU7CiAgICAvLy0tLS0tLS0tLS0tLS0tLQogICAgLy8gQ09OU1RSVUNUT1IKICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRwbG90cykgewogICAgICAgICR0aGlzLT5wbG90cyA9ICRwbG90czsKICAgICAgICAkdGhpcy0+bmJycGxvdHMgPSBjb3VudCgkcGxvdHMpOwogICAgICAgICR0aGlzLT5udW1wb2ludHMgPSAkcGxvdHNbMF0tPm51bXBvaW50czsKCiAgICAgICAgLy8gVmVyaWZ5IHRoYXQgYWxsIHBsb3RzIGhhdmUgdGhlIHNhbWUgbnVtYmVyIG9mIGRhdGEgcG9pbnRzCiAgICAgICAgZm9yKCAkaT0xOyAkaSA8ICR0aGlzLT5uYnJwbG90czsgKyskaSApIHsKICAgICAgICAgICAgaWYoICRwbG90c1skaV0tPm51bXBvaW50cyAhPSAkdGhpcy0+bnVtcG9pbnRzICkgewogICAgICAgICAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoMTAwMDMpOy8vKCdFYWNoIHBsb3QgaW4gYW4gYWNjdW11bGF0ZWQgbGluZXBsb3QgbXVzdCBoYXZlIHRoZSBzYW1lIG51bWJlciBvZiBkYXRhIHBvaW50cycsMCkKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgZm9yKCRpPTA7ICRpIDwgJHRoaXMtPm5icnBsb3RzOyArKyRpICkgewogICAgICAgICAgICAkdGhpcy0+TGluZUludGVycG9sYXRlKCR0aGlzLT5wbG90c1skaV0tPmNvb3Jkc1swXSk7CiAgICAgICAgfQogICAgfQoKICAgIC8vLS0tLS0tLS0tLS0tLS0tCiAgICAvLyBQVUJMSUMgTUVUSE9EUwogICAgZnVuY3Rpb24gTGVnZW5kKCRncmFwaCkgewogICAgICAgIGZvcmVhY2goICR0aGlzLT5wbG90cyBhcyAkcCApIHsKICAgICAgICAgICAgJHAtPkRvTGVnZW5kKCRncmFwaCk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIE1heCgpIHsKICAgICAgICBsaXN0KCR4bWF4KSA9ICR0aGlzLT5wbG90c1swXS0+TWF4KCk7CiAgICAgICAgJG5tYXg9MDsKICAgICAgICAkbiA9IGNvdW50KCR0aGlzLT5wbG90cyk7CiAgICAgICAgZm9yKCRpPTA7ICRpIDwgJG47ICsrJGkpIHsKICAgICAgICAgICAgJG5jID0gY291bnQoJHRoaXMtPnBsb3RzWyRpXS0+Y29vcmRzWzBdKTsKICAgICAgICAgICAgJG5tYXggPSBtYXgoJG5tYXgsJG5jKTsKICAgICAgICAgICAgbGlzdCgkeCkgPSAkdGhpcy0+cGxvdHNbJGldLT5NYXgoKTsKICAgICAgICAgICAgJHhtYXggPSBNYXgoJHhtYXgsJHgpOwogICAgICAgIH0KICAgICAgICBmb3IoICRpID0gMDsgJGkgPCAkbm1heDsgJGkrKyApIHsKICAgICAgICAgICAgLy8gR2V0IHktdmFsdWUgZm9yIGxpbmUgJGkgYnkgYWRkaW5nIHRoZQogICAgICAgICAgICAvLyBpbmRpdmlkdWFsIGJhcnMgZnJvbSBhbGwgdGhlIHBsb3RzIGFkZGVkLgogICAgICAgICAgICAvLyBJdCB3b3VsZCBiZSB3cm9uZyB0byBqdXN0IGFkZCB0aGUKICAgICAgICAgICAgLy8gaW5kaXZpZHVhbCBwbG90cyBtYXggeS12YWx1ZSBzaW5jZSB0aGF0CiAgICAgICAgICAgIC8vIHdvdWxkIGluIG1vc3QgY2FzZXMgZ2l2ZSB0byBsYXJnZSB5LXZhbHVlLgogICAgICAgICAgICAkeT0kdGhpcy0+cGxvdHNbMF0tPmNvb3Jkc1swXVskaV07CiAgICAgICAgICAgIGZvciggJGogPSAxOyAkaiA8ICR0aGlzLT5uYnJwbG90czsgJGorKyApIHsKICAgICAgICAgICAgICAgICR5ICs9ICR0aGlzLT5wbG90c1sgJGogXS0+Y29vcmRzWzBdWyRpXTsKICAgICAgICAgICAgfQogICAgICAgICAgICAkeW1heFskaV0gPSAkeTsKICAgICAgICB9CiAgICAgICAgJHltYXggPSBtYXgoJHltYXgpOwogICAgICAgIHJldHVybiBhcnJheSgkeG1heCwkeW1heCk7CiAgICB9CgogICAgZnVuY3Rpb24gTWluKCkgewogICAgICAgICRubWF4PTA7CiAgICAgICAgbGlzdCgkeG1pbiwkeXNldG1pbikgPSAkdGhpcy0+cGxvdHNbMF0tPk1pbigpOwogICAgICAgICRuID0gY291bnQoJHRoaXMtPnBsb3RzKTsKICAgICAgICBmb3IoJGk9MDsgJGkgPCAkbjsgKyskaSkgewogICAgICAgICAgICAkbmMgPSBjb3VudCgkdGhpcy0+cGxvdHNbJGldLT5jb29yZHNbMF0pOwogICAgICAgICAgICAkbm1heCA9IG1heCgkbm1heCwkbmMpOwogICAgICAgICAgICBsaXN0KCR4LCR5KSA9ICR0aGlzLT5wbG90c1skaV0tPk1pbigpOwogICAgICAgICAgICAkeG1pbiA9IE1pbigkeG1pbiwkeCk7CiAgICAgICAgICAgICR5c2V0bWluID0gTWluKCR5LCR5c2V0bWluKTsKICAgICAgICB9CiAgICAgICAgZm9yKCAkaSA9IDA7ICRpIDwgJG5tYXg7ICRpKysgKSB7CiAgICAgICAgICAgIC8vIEdldCB5LXZhbHVlIGZvciBsaW5lICRpIGJ5IGFkZGluZyB0aGUKICAgICAgICAgICAgLy8gaW5kaXZpZHVhbCBiYXJzIGZyb20gYWxsIHRoZSBwbG90cyBhZGRlZC4KICAgICAgICAgICAgLy8gSXQgd291bGQgYmUgd3JvbmcgdG8ganVzdCBhZGQgdGhlCiAgICAgICAgICAgIC8vIGluZGl2aWR1YWwgcGxvdHMgbWluIHktdmFsdWUgc2luY2UgdGhhdAogICAgICAgICAgICAvLyB3b3VsZCBpbiBtb3N0IGNhc2VzIGdpdmUgdG8gc21hbGwgeS12YWx1ZS4KICAgICAgICAgICAgJHk9JHRoaXMtPnBsb3RzWzBdLT5jb29yZHNbMF1bJGldOwogICAgICAgICAgICBmb3IoICRqID0gMTsgJGogPCAkdGhpcy0+bmJycGxvdHM7ICRqKysgKSB7CiAgICAgICAgICAgICAgICAkeSArPSAkdGhpcy0+cGxvdHNbICRqIF0tPmNvb3Jkc1swXVskaV07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJHltaW5bJGldID0gJHk7CiAgICAgICAgfQogICAgICAgICR5bWluID0gTWluKCR5c2V0bWluLE1pbigkeW1pbikpOwogICAgICAgIHJldHVybiBhcnJheSgkeG1pbiwkeW1pbik7CiAgICB9CgogICAgLy8gR2V0cyBjYWxsZWQgYmVmb3JlIGFueSBheGlzIGFyZSBzdHJva2VkCiAgICBmdW5jdGlvbiBQcmVTdHJva2VBZGp1c3QoJGdyYXBoKSB7CgogICAgICAgIC8vIElmIGFub3RoZXIgcGxvdCB0eXBlIGhhdmUgYWxyZWFkeSBhZGp1c3RlZCB0aGUKICAgICAgICAvLyBvZmZzZXQgd2UgZG9uJ3QgdG91Y2ggaXQuCiAgICAgICAgLy8gKFdlIGNoZWNrIGZvciBlbXB0eSBpbiBjYXNlIHRoZSBzY2FsZSBpcyAgYSBsb2cgc2NhbGUKICAgICAgICAvLyBhbmQgaGVuY2UgZG9lc24ndCBjb250YWluIGFueSB4bGFiZWxfb2Zmc2V0KQoKICAgICAgICBpZiggZW1wdHkoJGdyYXBoLT54YXhpcy0+c2NhbGUtPnRpY2tzLT54bGFiZWxfb2Zmc2V0KSB8fAogICAgICAgICRncmFwaC0+eGF4aXMtPnNjYWxlLT50aWNrcy0+eGxhYmVsX29mZnNldCA9PSAwICkgewogICAgICAgICAgICBpZiggJHRoaXMtPmNlbnRlciApIHsKICAgICAgICAgICAgICAgICsrJHRoaXMtPm51bXBvaW50czsKICAgICAgICAgICAgICAgICRhPTAuNTsgJGI9MC41OwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgJGE9MDsgJGI9MDsKICAgICAgICAgICAgfQogICAgICAgICAgICAkZ3JhcGgtPnhheGlzLT5zY2FsZS0+dGlja3MtPlNldFhMYWJlbE9mZnNldCgkYSk7CiAgICAgICAgICAgICRncmFwaC0+U2V0VGV4dFNjYWxlT2ZmKCRiKTsKICAgICAgICAgICAgJGdyYXBoLT54YXhpcy0+c2NhbGUtPnRpY2tzLT5TdXByZXNzTWlub3JUaWNrTWFya3MoKTsKICAgICAgICB9CgogICAgfQoKICAgIGZ1bmN0aW9uIFNldEludGVycG9sYXRlTW9kZSgkYUludE1vZGUpIHsKICAgICAgICAkdGhpcy0+aVN0YXJ0RW5kWmVybz0kYUludE1vZGU7CiAgICB9CgogICAgLy8gUmVwbGFjZSBhbGwgJy0nIHdpdGggYW4gaW50ZXJwb2xhdGVkIHZhbHVlLiBXZSB1c2Ugc3RyYWlnaHRmb3J3YXJkCiAgICAvLyBsaW5lYXIgaW50ZXJwb2xhdGlvbi4gSWYgdGhlIGRhdGEgc3RhcnRzIHdpdGggb25lIG9yIHNldmVyYWwgJy0nIHRoZXkKICAgIC8vIHdpbGwgYmUgcmVwbGFjZWQgYnkgdGhlIHRoZSBmaXJzdCB2YWxpZCBkYXRhIHBvaW50CiAgICBmdW5jdGlvbiBMaW5lSW50ZXJwb2xhdGUoJiRhRGF0YSkgewoKICAgICAgICAkbj1jb3VudCgkYURhdGEpOwogICAgICAgICRpPTA7CgogICAgICAgIC8vIElmIGZpcnN0IHBvaW50IGlzIHVuZGVmaW5lZCB3ZSB3aWxsIHNldCBpdCB0byB0aGUgc2FtZSBhcyB0aGUgZmlyc3QKICAgICAgICAvLyB2YWxpZCBkYXRhCiAgICAgICAgaWYoICRhRGF0YVskaV09PT0nLScgKSB7CiAgICAgICAgICAgIC8vIEZpbmQgdGhlIGZpcnN0IHZhbGlkIGRhdGEKICAgICAgICAgICAgd2hpbGUoICRpIDwgJG4gJiYgJGFEYXRhWyRpXT09PSctJyApIHsKICAgICAgICAgICAgICAgICsrJGk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoICRpIDwgJG4gKSB7CiAgICAgICAgICAgICAgICBmb3IoJGo9MDsgJGogPCAkaTsgKyskaiApIHsKICAgICAgICAgICAgICAgICAgICBpZiggJHRoaXMtPmlTdGFydEVuZFplcm8gKQogICAgICAgICAgICAgICAgICAgICRhRGF0YVskaV0gPSAwOwogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAkYURhdGFbJGpdID0gJGFEYXRhWyRpXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIEFsbCAnLScgPT4gRXJyb3IKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgd2hpbGUoJGkgPCAkbikgewogICAgICAgICAgICB3aGlsZSggJGkgPCAkbiAmJiAkYURhdGFbJGldICE9PSAnLScgKSB7CiAgICAgICAgICAgICAgICArKyRpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKCAkaSA8ICRuICkgewogICAgICAgICAgICAgICAgJHBzdGFydD0kaS0xOwoKICAgICAgICAgICAgICAgIC8vIE5vdyBzZWUgaG93IGxvbmcgdGhpcyBzZWdtZW50IG9mICctJyBhcmUKICAgICAgICAgICAgICAgIHdoaWxlKCAkaSA8ICRuICYmICRhRGF0YVskaV0gPT09ICctJyApIHsKICAgICAgICAgICAgICAgICAgICArKyRpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYoICRpIDwgJG4gKSB7CiAgICAgICAgICAgICAgICAgICAgJHBlbmQ9JGk7CiAgICAgICAgICAgICAgICAgICAgJHNpemU9JHBlbmQtJHBzdGFydDsKICAgICAgICAgICAgICAgICAgICAkaz0oJGFEYXRhWyRwZW5kXS0kYURhdGFbJHBzdGFydF0pLyRzaXplOwogICAgICAgICAgICAgICAgICAgIC8vIFJlcGxhY2UgdGhlIHNlZ21lbnQgb2YgJy0nIHdpdGggYSBsaW5lYXIgaW50ZXJwb2xhdGVkIHZhbHVlLgogICAgICAgICAgICAgICAgICAgIGZvcigkaj0xOyAkaiA8ICRzaXplOyArKyRqICkgewogICAgICAgICAgICAgICAgICAgICAgICAkYURhdGFbJHBzdGFydCskal0gPSAkYURhdGFbJHBzdGFydF0gKyAkaiokayA7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgLy8gVGhlcmUgYXJlIG5vIHZhbGlkIGVuZCBwb2ludC4gVGhlICctJyBnb2VzIGFsbCB0aGUgd2F5IHRvIHRoZSBlbmQKICAgICAgICAgICAgICAgICAgICAvLyBJbiB0aGF0IGNhc2Ugd2UganVzdCBzZXQgYWxsIHRoZSByZW1haW5pbmcgdmFsdWVzIHRoZSB0aGUgc2FtZSBhcyB0aGUKICAgICAgICAgICAgICAgICAgICAvLyBsYXN0IHZhbGlkIGRhdGEgcG9pbnQuCiAgICAgICAgICAgICAgICAgICAgZm9yKCAkaj0kcHN0YXJ0KzE7ICRqIDwgJG47ICsrJGogKQogICAgICAgICAgICAgICAgICAgIGlmKCAkdGhpcy0+aVN0YXJ0RW5kWmVybyApIHsKICAgICAgICAgICAgICAgICAgICAgICAgJGFEYXRhWyRqXSA9IDA7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAkYURhdGFbJGpdID0gJGFEYXRhWyRwc3RhcnRdIDsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLy8gVG8gYXZvaWQgZHVwbGljYXRlIG9mIGxpbmUgZHJhd2luZyBjb2RlIGhlcmUgd2UganVzdAogICAgLy8gY2hhbmdlIHRoZSB5LXZhbHVlcyBmb3IgZWFjaCBwbG90IGFuZCB0aGVuIHJlc3RvcmUgaXQKICAgIC8vIGFmdGVyIHdlIGhhdmUgbWFkZSB0aGUgc3Ryb2tlLiBXZSBtdXN0IGRvIHRoaXMgY29weSBzaW5jZQogICAgLy8gaXQgd291bGRuJ3QgYmUgcG9zc2libGUgdG8gY3JlYXRlIGFuIGFjYyBsaW5lIHBsb3QKICAgIC8vIHdpdGggdGhlIHNhbWUgZ3JhcGhzLCBpLmUgQWNjTGluZVBsb3QoYXJyYXkoJHBsLCRwbCwkcGwpKTsKICAgIC8vIHNpbmNlIHRoaXMgbWV0aG9kIHdvdWxkIGhhdmUgYSBzaWRlIGVmZmVjdC4KICAgIGZ1bmN0aW9uIFN0cm9rZSgkaW1nLCR4c2NhbGUsJHlzY2FsZSkgewogICAgICAgICRpbWctPlNldExpbmVXZWlnaHQoJHRoaXMtPndlaWdodCk7CiAgICAgICAgJHRoaXMtPm51bXBvaW50cyA9IGNvdW50KCR0aGlzLT5wbG90c1swXS0+Y29vcmRzWzBdKTsKICAgICAgICAvLyBBbGxvY2F0ZSBhcnJheQogICAgICAgICRjb29yZHNbJHRoaXMtPm5icnBsb3RzXVskdGhpcy0+bnVtcG9pbnRzXT0wOwogICAgICAgIGZvcigkaT0wOyAkaTwkdGhpcy0+bnVtcG9pbnRzOyAkaSsrKSB7CiAgICAgICAgICAgICRjb29yZHNbMF1bJGldPSR0aGlzLT5wbG90c1swXS0+Y29vcmRzWzBdWyRpXTsKICAgICAgICAgICAgJGFjY3k9JGNvb3Jkc1swXVskaV07CiAgICAgICAgICAgIGZvcigkaj0xOyAkajwkdGhpcy0+bmJycGxvdHM7ICsrJGogKSB7CiAgICAgICAgICAgICAgICAkY29vcmRzWyRqXVskaV0gPSAkdGhpcy0+cGxvdHNbJGpdLT5jb29yZHNbMF1bJGldKyRhY2N5OwogICAgICAgICAgICAgICAgJGFjY3kgPSAkY29vcmRzWyRqXVskaV07CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZm9yKCRqPSR0aGlzLT5uYnJwbG90cy0xOyAkaj49MDsgLS0kaikgewogICAgICAgICAgICAkcD0kdGhpcy0+cGxvdHNbJGpdOwogICAgICAgICAgICBmb3IoICRpPTA7ICRpPCR0aGlzLT5udW1wb2ludHM7ICsrJGkpIHsKICAgICAgICAgICAgICAgICR0bXBbJGldPSRwLT5jb29yZHNbMF1bJGldOwogICAgICAgICAgICAgICAgJHAtPmNvb3Jkc1swXVskaV09JGNvb3Jkc1skal1bJGldOwogICAgICAgICAgICB9CiAgICAgICAgICAgICRwLT5TdHJva2UoJGltZywkeHNjYWxlLCR5c2NhbGUpOwogICAgICAgICAgICBmb3IoICRpPTA7ICRpPCR0aGlzLT5udW1wb2ludHM7ICsrJGkpIHsKICAgICAgICAgICAgICAgICRwLT5jb29yZHNbMF1bJGldPSR0bXBbJGldOwogICAgICAgICAgICB9CiAgICAgICAgICAgICRwLT5jb29yZHNbMF1bXT0kdG1wOwogICAgICAgIH0KICAgIH0KfSAvLyBDbGFzcwoKCi8qIEVPRiAqLwo\/Pgo=",
    "size": "23786"
}