{
    "namaFile": "pages\/admin\/menu\/assets\/js\/libs\/DataTables\/extensions\/ColReorder\/js\/dataTables.colReorder.js",
    "lastUpdate": "2018-03-22+14:27:25.35",
    "contentFile": "LyohIENvbFJlb3JkZXIgMS4xLjIKICogwqkyMDEwLTIwMTQgU3ByeU1lZGlhIEx0ZCAtIGRhdGF0YWJsZXMubmV0L2xpY2Vuc2UKICovCgovKioKICogQHN1bW1hcnkgICAgIENvbFJlb3JkZXIKICogQGRlc2NyaXB0aW9uIFByb3ZpZGUgdGhlIGFiaWxpdHkgdG8gcmVvcmRlciBjb2x1bW5zIGluIGEgRGF0YVRhYmxlCiAqIEB2ZXJzaW9uICAgICAxLjEuMgogKiBAZmlsZSAgICAgICAgZGF0YVRhYmxlcy5jb2xSZW9yZGVyLmpzCiAqIEBhdXRob3IgICAgICBTcHJ5TWVkaWEgTHRkICh3d3cuc3ByeW1lZGlhLmNvLnVrKQogKiBAY29udGFjdCAgICAgd3d3LnNwcnltZWRpYS5jby51ay9jb250YWN0CiAqIEBjb3B5cmlnaHQgICBDb3B5cmlnaHQgMjAxMC0yMDE0IFNwcnlNZWRpYSBMdGQuCiAqCiAqIFRoaXMgc291cmNlIGZpbGUgaXMgZnJlZSBzb2Z0d2FyZSwgYXZhaWxhYmxlIHVuZGVyIHRoZSBmb2xsb3dpbmcgbGljZW5zZToKICogICBNSVQgbGljZW5zZSAtIGh0dHA6Ly9kYXRhdGFibGVzLm5ldC9saWNlbnNlL21pdAogKgogKiBUaGlzIHNvdXJjZSBmaWxlIGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsIGJ1dAogKiBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mIE1FUkNIQU5UQUJJTElUWQogKiBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gU2VlIHRoZSBsaWNlbnNlIGZpbGVzIGZvciBkZXRhaWxzLgogKgogKiBGb3IgZGV0YWlscyBwbGVhc2UgcmVmZXIgdG86IGh0dHA6Ly93d3cuZGF0YXRhYmxlcy5uZXQKICovCgooZnVuY3Rpb24od2luZG93LCBkb2N1bWVudCwgdW5kZWZpbmVkKSB7CgoKLyoqCiAqIFN3aXRjaCB0aGUga2V5IHZhbHVlIHBhaXJpbmcgb2YgYW4gaW5kZXggYXJyYXkgdG8gYmUgdmFsdWUga2V5IChpLmUuIHRoZSBvbGQgdmFsdWUgaXMgbm93IHRoZQogKiBrZXkpLiBGb3IgZXhhbXBsZSBjb25zaWRlciBbIDIsIDAsIDEgXSB0aGlzIHdvdWxkIGJlIHJldHVybmVkIGFzIFsgMSwgMiwgMCBdLgogKiAgQG1ldGhvZCAgZm5JbnZlcnRLZXlWYWx1ZXMKICogIEBwYXJhbSAgIGFycmF5IGFJbiBBcnJheSB0byBzd2l0Y2ggYXJvdW5kCiAqICBAcmV0dXJucyBhcnJheQogKi8KZnVuY3Rpb24gZm5JbnZlcnRLZXlWYWx1ZXMoIGFJbiApCnsKCXZhciBhUmV0PVtdOwoJZm9yICggdmFyIGk9MCwgaUxlbj1hSW4ubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCXsKCQlhUmV0WyBhSW5baV0gXSA9IGk7Cgl9CglyZXR1cm4gYVJldDsKfQoKCi8qKgogKiBNb2RpZnkgYW4gYXJyYXkgYnkgc3dpdGNoaW5nIHRoZSBwb3NpdGlvbiBvZiB0d28gZWxlbWVudHMKICogIEBtZXRob2QgIGZuQXJyYXlTd2l0Y2gKICogIEBwYXJhbSAgIGFycmF5IGFBcnJheSBBcnJheSB0byBjb25zaWRlciwgd2lsbCBiZSBtb2RpZmllZCBieSByZWZlcmVuY2UgKGkuZS4gbm8gcmV0dXJuKQogKiAgQHBhcmFtICAgaW50IGlGcm9tIEZyb20gcG9pbnQKICogIEBwYXJhbSAgIGludCBpVG8gSW5zZXJ0IHBvaW50CiAqICBAcmV0dXJucyB2b2lkCiAqLwpmdW5jdGlvbiBmbkFycmF5U3dpdGNoKCBhQXJyYXksIGlGcm9tLCBpVG8gKQp7Cgl2YXIgbVN0b3JlID0gYUFycmF5LnNwbGljZSggaUZyb20sIDEgKVswXTsKCWFBcnJheS5zcGxpY2UoIGlUbywgMCwgbVN0b3JlICk7Cn0KCgovKioKICogU3dpdGNoIHRoZSBwb3NpdGlvbnMgb2Ygbm9kZXMgaW4gYSBwYXJlbnQgbm9kZSAobm90ZSB0aGlzIGlzIHNwZWNpZmljYWxseSBkZXNpZ25lZCBmb3IKICogdGFibGUgcm93cykuIE5vdGUgdGhpcyBmdW5jdGlvbiBjb25zaWRlcnMgYWxsIGVsZW1lbnQgbm9kZXMgdW5kZXIgdGhlIHBhcmVudCEKICogIEBtZXRob2QgIGZuRG9tU3dpdGNoCiAqICBAcGFyYW0gICBzdHJpbmcgc1RhZyBUYWcgdG8gY29uc2lkZXIKICogIEBwYXJhbSAgIGludCBpRnJvbSBFbGVtZW50IHRvIG1vdmUKICogIEBwYXJhbSAgIGludCBQb2ludCB0byBlbGVtZW50IHRoZSBlbGVtZW50IHRvIChiZWZvcmUgdGhpcyBwb2ludCksIGNhbiBiZSBudWxsIGZvciBhcHBlbmQKICogIEByZXR1cm5zIHZvaWQKICovCmZ1bmN0aW9uIGZuRG9tU3dpdGNoKCBuUGFyZW50LCBpRnJvbSwgaVRvICkKewoJdmFyIGFuVGFncyA9IFtdOwoJZm9yICggdmFyIGk9MCwgaUxlbj1uUGFyZW50LmNoaWxkTm9kZXMubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCXsKCQlpZiAoIG5QYXJlbnQuY2hpbGROb2Rlc1tpXS5ub2RlVHlwZSA9PSAxICkKCQl7CgkJCWFuVGFncy5wdXNoKCBuUGFyZW50LmNoaWxkTm9kZXNbaV0gKTsKCQl9Cgl9Cgl2YXIgblN0b3JlID0gYW5UYWdzWyBpRnJvbSBdOwoKCWlmICggaVRvICE9PSBudWxsICkKCXsKCQluUGFyZW50Lmluc2VydEJlZm9yZSggblN0b3JlLCBhblRhZ3NbaVRvXSApOwoJfQoJZWxzZQoJewoJCW5QYXJlbnQuYXBwZW5kQ2hpbGQoIG5TdG9yZSApOwoJfQp9CgoKCi8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoKICogRGF0YVRhYmxlcyBwbHVnLWluIEFQSSBmdW5jdGlvbnMKICoKICogVGhpcyBhcmUgcmVxdWlyZWQgYnkgQ29sUmVvcmRlciBpbiBvcmRlciB0byBwZXJmb3JtIHRoZSB0YXNrcyByZXF1aXJlZCwgYW5kIGFsc28ga2VlcCB0aGlzCiAqIGNvZGUgcG9ydGFibGUsIHRvIGJlIHVzZWQgZm9yIG90aGVyIGNvbHVtbiByZW9yZGVyaW5nIHByb2plY3RzIHdpdGggRGF0YVRhYmxlcywgaWYgbmVlZGVkLgogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqLwoKCi8qKgogKiBQbHVnLWluIGZvciBEYXRhVGFibGVzIHdoaWNoIHdpbGwgcmVvcmRlciB0aGUgaW50ZXJuYWwgY29sdW1uIHN0cnVjdHVyZSBieSB0YWtpbmcgdGhlIGNvbHVtbgogKiBmcm9tIG9uZSBwb3NpdGlvbiAoaUZyb20pIGFuZCBpbnNlcnQgaXQgaW50byBhIGdpdmVuIHBvaW50IChpVG8pLgogKiAgQG1ldGhvZCAgJC5mbi5kYXRhVGFibGVFeHQub0FwaS5mbkNvbFJlb3JkZXIKICogIEBwYXJhbSAgIG9iamVjdCBvU2V0dGluZ3MgRGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QgLSBhdXRvbWF0aWNhbGx5IGFkZGVkIGJ5IERhdGFUYWJsZXMhCiAqICBAcGFyYW0gICBpbnQgaUZyb20gVGFrZSB0aGUgY29sdW1uIHRvIGJlIHJlcG9zaXRpb25lZCBmcm9tIHRoaXMgcG9pbnQKICogIEBwYXJhbSAgIGludCBpVG8gYW5kIGluc2VydCBpdCBpbnRvIHRoaXMgcG9pbnQKICogIEByZXR1cm5zIHZvaWQKICovCiQuZm4uZGF0YVRhYmxlRXh0Lm9BcGkuZm5Db2xSZW9yZGVyID0gZnVuY3Rpb24gKCBvU2V0dGluZ3MsIGlGcm9tLCBpVG8gKQp7Cgl2YXIgdjExMCA9ICQuZm4uZGF0YVRhYmxlLkFwaSA\/IHRydWUgOiBmYWxzZTsKCXZhciBpLCBpTGVuLCBqLCBqTGVuLCBpQ29scz1vU2V0dGluZ3MuYW9Db2x1bW5zLmxlbmd0aCwgblRycywgb0NvbDsKCXZhciBhdHRyTWFwID0gZnVuY3Rpb24gKCBvYmosIHByb3AsIG1hcHBpbmcgKSB7CgkJaWYgKCAhIG9ialsgcHJvcCBdICkgewoJCQlyZXR1cm47CgkJfQoKCQl2YXIgYSA9IG9ialsgcHJvcCBdLnNwbGl0KCcuJyk7CgkJdmFyIG51bSA9IGEuc2hpZnQoKTsKCgkJaWYgKCBpc05hTiggbnVtKjEgKSApIHsKCQkJcmV0dXJuOwoJCX0KCgkJb2JqWyBwcm9wIF0gPSBtYXBwaW5nWyBudW0qMSBdKycuJythLmpvaW4oJy4nKTsKCX07CgoJLyogU2FuaXR5IGNoZWNrIGluIHRoZSBpbnB1dCAqLwoJaWYgKCBpRnJvbSA9PSBpVG8gKQoJewoJCS8qIFBvaW50bGVzcyByZW9yZGVyICovCgkJcmV0dXJuOwoJfQoKCWlmICggaUZyb20gPCAwIHx8IGlGcm9tID49IGlDb2xzICkKCXsKCQl0aGlzLm9BcGkuX2ZuTG9nKCBvU2V0dGluZ3MsIDEsICJDb2xSZW9yZGVyICdmcm9tJyBpbmRleCBpcyBvdXQgb2YgYm91bmRzOiAiK2lGcm9tICk7CgkJcmV0dXJuOwoJfQoKCWlmICggaVRvIDwgMCB8fCBpVG8gPj0gaUNvbHMgKQoJewoJCXRoaXMub0FwaS5fZm5Mb2coIG9TZXR0aW5ncywgMSwgIkNvbFJlb3JkZXIgJ3RvJyBpbmRleCBpcyBvdXQgb2YgYm91bmRzOiAiK2lUbyApOwoJCXJldHVybjsKCX0KCgkvKgoJICogQ2FsY3VsYXRlIHRoZSBuZXcgY29sdW1uIGFycmF5IGluZGV4LCBzbyB3ZSBoYXZlIGEgbWFwcGluZyBiZXR3ZWVuIHRoZSBvbGQgYW5kIG5ldwoJICovCgl2YXIgYWlNYXBwaW5nID0gW107Cglmb3IgKCBpPTAsIGlMZW49aUNvbHMgOyBpPGlMZW4gOyBpKysgKQoJewoJCWFpTWFwcGluZ1tpXSA9IGk7Cgl9CglmbkFycmF5U3dpdGNoKCBhaU1hcHBpbmcsIGlGcm9tLCBpVG8gKTsKCXZhciBhaUludmVydE1hcHBpbmcgPSBmbkludmVydEtleVZhbHVlcyggYWlNYXBwaW5nICk7CgoKCS8qCgkgKiBDb252ZXJ0IGFsbCBpbnRlcm5hbCBpbmRleGluZyB0byB0aGUgbmV3IGNvbHVtbiBvcmRlciBpbmRleGVzCgkgKi8KCS8qIFNvcnRpbmcgKi8KCWZvciAoIGk9MCwgaUxlbj1vU2V0dGluZ3MuYWFTb3J0aW5nLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApCgl7CgkJb1NldHRpbmdzLmFhU29ydGluZ1tpXVswXSA9IGFpSW52ZXJ0TWFwcGluZ1sgb1NldHRpbmdzLmFhU29ydGluZ1tpXVswXSBdOwoJfQoKCS8qIEZpeGVkIHNvcnRpbmcgKi8KCWlmICggb1NldHRpbmdzLmFhU29ydGluZ0ZpeGVkICE9PSBudWxsICkKCXsKCQlmb3IgKCBpPTAsIGlMZW49b1NldHRpbmdzLmFhU29ydGluZ0ZpeGVkLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApCgkJewoJCQlvU2V0dGluZ3MuYWFTb3J0aW5nRml4ZWRbaV1bMF0gPSBhaUludmVydE1hcHBpbmdbIG9TZXR0aW5ncy5hYVNvcnRpbmdGaXhlZFtpXVswXSBdOwoJCX0KCX0KCgkvKiBEYXRhIGNvbHVtbiBzb3J0aW5nICh0aGUgY29sdW1uIHdoaWNoIHRoZSBzb3J0IGZvciBhIGdpdmVuIGNvbHVtbiBzaG91bGQgdGFrZSBwbGFjZSBvbikgKi8KCWZvciAoIGk9MCwgaUxlbj1pQ29scyA7IGk8aUxlbiA7IGkrKyApCgl7CgkJb0NvbCA9IG9TZXR0aW5ncy5hb0NvbHVtbnNbaV07CgkJZm9yICggaj0wLCBqTGVuPW9Db2wuYURhdGFTb3J0Lmxlbmd0aCA7IGo8akxlbiA7IGorKyApCgkJewoJCQlvQ29sLmFEYXRhU29ydFtqXSA9IGFpSW52ZXJ0TWFwcGluZ1sgb0NvbC5hRGF0YVNvcnRbal0gXTsKCQl9CgoJCS8vIFVwZGF0ZSB0aGUgY29sdW1uIGluZGV4ZXMKCQlpZiAoIHYxMTAgKSB7CgkJCW9Db2wuaWR4ID0gYWlJbnZlcnRNYXBwaW5nWyBvQ29sLmlkeCBdOwoJCX0KCX0KCglpZiAoIHYxMTAgKSB7CgkJLy8gVXBkYXRlIDEuMTAgb3B0aW1pc2VkIHNvcnQgY2xhc3MgcmVtb3ZhbCB2YXJpYWJsZQoJCSQuZWFjaCggb1NldHRpbmdzLmFMYXN0U29ydCwgZnVuY3Rpb24gKGksIHZhbCkgewoJCQlvU2V0dGluZ3MuYUxhc3RTb3J0W2ldLnNyYyA9IGFpSW52ZXJ0TWFwcGluZ1sgdmFsLnNyYyBdOwoJCX0gKTsKCX0KCgkvKiBVcGRhdGUgdGhlIEdldCBhbmQgU2V0IGZ1bmN0aW9ucyBmb3IgZWFjaCBjb2x1bW4gKi8KCWZvciAoIGk9MCwgaUxlbj1pQ29scyA7IGk8aUxlbiA7IGkrKyApCgl7CgkJb0NvbCA9IG9TZXR0aW5ncy5hb0NvbHVtbnNbaV07CgoJCWlmICggdHlwZW9mIG9Db2wubURhdGEgPT0gJ251bWJlcicgKSB7CgkJCW9Db2wubURhdGEgPSBhaUludmVydE1hcHBpbmdbIG9Db2wubURhdGEgXTsKCgkJCS8vIHJlZ2VuZXJhdGUgdGhlIGdldCAvIHNldCBmdW5jdGlvbnMKCQkJb1NldHRpbmdzLm9BcGkuX2ZuQ29sdW1uT3B0aW9ucyggb1NldHRpbmdzLCBpLCB7fSApOwoJCX0KCQllbHNlIGlmICggJC5pc1BsYWluT2JqZWN0KCBvQ29sLm1EYXRhICkgKSB7CgkJCS8vIEhUTUw1IGRhdGEgc291cmNlZAoJCQlhdHRyTWFwKCBvQ29sLm1EYXRhLCAnXycsICAgICAgYWlJbnZlcnRNYXBwaW5nICk7CgkJCWF0dHJNYXAoIG9Db2wubURhdGEsICdmaWx0ZXInLCBhaUludmVydE1hcHBpbmcgKTsKCQkJYXR0ck1hcCggb0NvbC5tRGF0YSwgJ3NvcnQnLCAgIGFpSW52ZXJ0TWFwcGluZyApOwoJCQlhdHRyTWFwKCBvQ29sLm1EYXRhLCAndHlwZScsICAgYWlJbnZlcnRNYXBwaW5nICk7CgoJCQkvLyByZWdlbmVyYXRlIHRoZSBnZXQgLyBzZXQgZnVuY3Rpb25zCgkJCW9TZXR0aW5ncy5vQXBpLl9mbkNvbHVtbk9wdGlvbnMoIG9TZXR0aW5ncywgaSwge30gKTsKCQl9Cgl9CgoKCS8qCgkgKiBNb3ZlIHRoZSBET00gZWxlbWVudHMKCSAqLwoJaWYgKCBvU2V0dGluZ3MuYW9Db2x1bW5zW2lGcm9tXS5iVmlzaWJsZSApCgl7CgkJLyogQ2FsY3VsYXRlIHRoZSBjdXJyZW50IHZpc2libGUgaW5kZXggYW5kIHRoZSBwb2ludCB0byBpbnNlcnQgdGhlIG5vZGUgYmVmb3JlLiBUaGUgaW5zZXJ0CgkJICogYmVmb3JlIG5lZWRzIHRvIHRha2UgaW50byBhY2NvdW50IHRoYXQgdGhlcmUgbWlnaHQgbm90IGJlIGFuIGVsZW1lbnQgdG8gaW5zZXJ0IGJlZm9yZSwKCQkgKiBpbiB3aGljaCBjYXNlIGl0IHdpbGwgYmUgbnVsbCwgYW5kIGFuIGFwcGVuZENoaWxkIHNob3VsZCBiZSB1c2VkCgkJICovCgkJdmFyIGlWaXNpYmxlSW5kZXggPSB0aGlzLm9BcGkuX2ZuQ29sdW1uSW5kZXhUb1Zpc2libGUoIG9TZXR0aW5ncywgaUZyb20gKTsKCQl2YXIgaUluc2VydEJlZm9yZUluZGV4ID0gbnVsbDsKCgkJaSA9IGlUbyA8IGlGcm9tID8gaVRvIDogaVRvICsgMTsKCQl3aGlsZSAoIGlJbnNlcnRCZWZvcmVJbmRleCA9PT0gbnVsbCAmJiBpIDwgaUNvbHMgKQoJCXsKCQkJaUluc2VydEJlZm9yZUluZGV4ID0gdGhpcy5vQXBpLl9mbkNvbHVtbkluZGV4VG9WaXNpYmxlKCBvU2V0dGluZ3MsIGkgKTsKCQkJaSsrOwoJCX0KCgkJLyogSGVhZGVyICovCgkJblRycyA9IG9TZXR0aW5ncy5uVEhlYWQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RyJyk7CgkJZm9yICggaT0wLCBpTGVuPW5UcnMubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQl7CgkJCWZuRG9tU3dpdGNoKCBuVHJzW2ldLCBpVmlzaWJsZUluZGV4LCBpSW5zZXJ0QmVmb3JlSW5kZXggKTsKCQl9CgoJCS8qIEZvb3RlciAqLwoJCWlmICggb1NldHRpbmdzLm5URm9vdCAhPT0gbnVsbCApCgkJewoJCQluVHJzID0gb1NldHRpbmdzLm5URm9vdC5nZXRFbGVtZW50c0J5VGFnTmFtZSgndHInKTsKCQkJZm9yICggaT0wLCBpTGVuPW5UcnMubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQkJewoJCQkJZm5Eb21Td2l0Y2goIG5UcnNbaV0sIGlWaXNpYmxlSW5kZXgsIGlJbnNlcnRCZWZvcmVJbmRleCApOwoJCQl9CgkJfQoKCQkvKiBCb2R5ICovCgkJZm9yICggaT0wLCBpTGVuPW9TZXR0aW5ncy5hb0RhdGEubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQl7CgkJCWlmICggb1NldHRpbmdzLmFvRGF0YVtpXS5uVHIgIT09IG51bGwgKQoJCQl7CgkJCQlmbkRvbVN3aXRjaCggb1NldHRpbmdzLmFvRGF0YVtpXS5uVHIsIGlWaXNpYmxlSW5kZXgsIGlJbnNlcnRCZWZvcmVJbmRleCApOwoJCQl9CgkJfQoJfQoKCS8qCgkgKiBNb3ZlIHRoZSBpbnRlcm5hbCBhcnJheSBlbGVtZW50cwoJICovCgkvKiBDb2x1bW5zICovCglmbkFycmF5U3dpdGNoKCBvU2V0dGluZ3MuYW9Db2x1bW5zLCBpRnJvbSwgaVRvICk7CgoJLyogU2VhcmNoIGNvbHVtbnMgKi8KCWZuQXJyYXlTd2l0Y2goIG9TZXR0aW5ncy5hb1ByZVNlYXJjaENvbHMsIGlGcm9tLCBpVG8gKTsKCgkvKiBBcnJheSBhcnJheSAtIGludGVybmFsIGRhdGEgYW5vZGVzIGNhY2hlICovCglmb3IgKCBpPTAsIGlMZW49b1NldHRpbmdzLmFvRGF0YS5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJewoJCXZhciBkYXRhID0gb1NldHRpbmdzLmFvRGF0YVtpXTsKCgkJaWYgKCB2MTEwICkgewoJCQkvLyBEYXRhVGFibGVzIDEuMTArCgkJCWlmICggZGF0YS5hbkNlbGxzICkgewoJCQkJZm5BcnJheVN3aXRjaCggZGF0YS5hbkNlbGxzLCBpRnJvbSwgaVRvICk7CgkJCX0KCgkJCS8vIEZvciBET00gc291cmNlZCBkYXRhLCB0aGUgaW52YWxpZGF0ZSB3aWxsIHJlcmVhZCB0aGUgY2VsbCBpbnRvCgkJCS8vIHRoZSBkYXRhIGFycmF5LCBidXQgZm9yIGRhdGEgc291cmNlcyBhcyBhbiBhcnJheSwgdGhleSBuZWVkIHRvCgkJCS8vIGJlIGZsaXBwZWQKCQkJaWYgKCBkYXRhLnNyYyAhPT0gJ2RvbScgJiYgJC5pc0FycmF5KCBkYXRhLl9hRGF0YSApICkgewoJCQkJZm5BcnJheVN3aXRjaCggZGF0YS5fYURhdGEsIGlGcm9tLCBpVG8gKTsKCQkJfQoJCX0KCQllbHNlIHsKCQkJLy8gRGF0YVRhYmxlcyAxLjktCgkJCWlmICggJC5pc0FycmF5KCBkYXRhLl9hRGF0YSApICkgewoJCQkJZm5BcnJheVN3aXRjaCggZGF0YS5fYURhdGEsIGlGcm9tLCBpVG8gKTsKCQkJfQoJCQlmbkFycmF5U3dpdGNoKCBkYXRhLl9hbkhpZGRlbiwgaUZyb20sIGlUbyApOwoJCX0KCX0KCgkvKiBSZXBvc2l0aW9uIHRoZSBoZWFkZXIgZWxlbWVudHMgaW4gdGhlIGhlYWRlciBsYXlvdXQgYXJyYXkgKi8KCWZvciAoIGk9MCwgaUxlbj1vU2V0dGluZ3MuYW9IZWFkZXIubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCXsKCQlmbkFycmF5U3dpdGNoKCBvU2V0dGluZ3MuYW9IZWFkZXJbaV0sIGlGcm9tLCBpVG8gKTsKCX0KCglpZiAoIG9TZXR0aW5ncy5hb0Zvb3RlciAhPT0gbnVsbCApCgl7CgkJZm9yICggaT0wLCBpTGVuPW9TZXR0aW5ncy5hb0Zvb3Rlci5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCXsKCQkJZm5BcnJheVN3aXRjaCggb1NldHRpbmdzLmFvRm9vdGVyW2ldLCBpRnJvbSwgaVRvICk7CgkJfQoJfQoKCS8vIEluIDEuMTAgd2UgbmVlZCB0byBpbnZhbGlkYXRlIHJvdyBjYWNoZWQgZGF0YSBmb3Igc29ydGluZywgZmlsdGVyaW5nIGV0YwoJaWYgKCB2MTEwICkgewoJCXZhciBhcGkgPSBuZXcgJC5mbi5kYXRhVGFibGUuQXBpKCBvU2V0dGluZ3MgKTsKCQlhcGkucm93cygpLmludmFsaWRhdGUoKTsKCX0KCgkvKgoJICogVXBkYXRlIERhdGFUYWJsZXMnIGV2ZW50IGhhbmRsZXJzCgkgKi8KCgkvKiBTb3J0IGxpc3RlbmVyICovCglmb3IgKCBpPTAsIGlMZW49aUNvbHMgOyBpPGlMZW4gOyBpKysgKQoJewoJCSQob1NldHRpbmdzLmFvQ29sdW1uc1tpXS5uVGgpLm9mZignY2xpY2suRFQnKTsKCQl0aGlzLm9BcGkuX2ZuU29ydEF0dGFjaExpc3RlbmVyKCBvU2V0dGluZ3MsIG9TZXR0aW5ncy5hb0NvbHVtbnNbaV0ublRoLCBpICk7Cgl9CgoKCS8qIEZpcmUgYW4gZXZlbnQgc28gb3RoZXIgcGx1Zy1pbnMgY2FuIHVwZGF0ZSAqLwoJJChvU2V0dGluZ3Mub0luc3RhbmNlKS50cmlnZ2VyKCAnY29sdW1uLXJlb3JkZXInLCBbIG9TZXR0aW5ncywgewoJCSJpRnJvbSI6IGlGcm9tLAoJCSJpVG8iOiBpVG8sCgkJImFpSW52ZXJ0TWFwcGluZyI6IGFpSW52ZXJ0TWFwcGluZwoJfSBdICk7Cn07CgoKCnZhciBmYWN0b3J5ID0gZnVuY3Rpb24oICQsIERhdGFUYWJsZSApIHsKInVzZSBzdHJpY3QiOwoKLyoqCiAqIENvbFJlb3JkZXIgcHJvdmlkZXMgY29sdW1uIHZpc2liaWxpdHkgY29udHJvbCBmb3IgRGF0YVRhYmxlcwogKiBAY2xhc3MgQ29sUmVvcmRlcgogKiBAY29uc3RydWN0b3IKICogQHBhcmFtIHtvYmplY3R9IGR0IERhdGFUYWJsZXMgc2V0dGluZ3Mgb2JqZWN0CiAqIEBwYXJhbSB7b2JqZWN0fSBvcHRzIENvbFJlb3JkZXIgb3B0aW9ucwogKi8KdmFyIENvbFJlb3JkZXIgPSBmdW5jdGlvbiggZHQsIG9wdHMgKQp7Cgl2YXIgb0RUU2V0dGluZ3M7CgoJaWYgKCAkLmZuLmRhdGFUYWJsZS5BcGkgKSB7CgkJb0RUU2V0dGluZ3MgPSBuZXcgJC5mbi5kYXRhVGFibGUuQXBpKCBkdCApLnNldHRpbmdzKClbMF07Cgl9CgkvLyAxLjkgY29tcGF0aWJpbGl0eQoJZWxzZSBpZiAoIGR0LmZuU2V0dGluZ3MgKSB7CgkJLy8gRGF0YVRhYmxlcyBvYmplY3QsIGNvbnZlcnQgdG8gdGhlIHNldHRpbmdzIG9iamVjdAoJCW9EVFNldHRpbmdzID0gZHQuZm5TZXR0aW5ncygpOwoJfQoJZWxzZSBpZiAoIHR5cGVvZiBkdCA9PT0gJ3N0cmluZycgKSB7CgkJLy8galF1ZXJ5IHNlbGVjdG9yCgkJaWYgKCAkLmZuLmRhdGFUYWJsZS5mbklzRGF0YVRhYmxlKCAkKGR0KVswXSApICkgewoJCQlvRFRTZXR0aW5ncyA9ICQoZHQpLmVxKDApLmRhdGFUYWJsZSgpLmZuU2V0dGluZ3MoKTsKCQl9Cgl9CgllbHNlIGlmICggZHQubm9kZU5hbWUgJiYgZHQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ3RhYmxlJyApIHsKCQkvLyBUYWJsZSBub2RlCgkJaWYgKCAkLmZuLmRhdGFUYWJsZS5mbklzRGF0YVRhYmxlKCBkdC5ub2RlTmFtZSApICkgewoJCQlvRFRTZXR0aW5ncyA9ICQoZHQubm9kZU5hbWUpLmRhdGFUYWJsZSgpLmZuU2V0dGluZ3MoKTsKCQl9Cgl9CgllbHNlIGlmICggZHQgaW5zdGFuY2VvZiBqUXVlcnkgKSB7CgkJLy8galF1ZXJ5IG9iamVjdAoJCWlmICggJC5mbi5kYXRhVGFibGUuZm5Jc0RhdGFUYWJsZSggZHRbMF0gKSApIHsKCQkJb0RUU2V0dGluZ3MgPSBkdC5lcSgwKS5kYXRhVGFibGUoKS5mblNldHRpbmdzKCk7CgkJfQoJfQoJZWxzZSB7CgkJLy8gRGF0YVRhYmxlcyBzZXR0aW5ncyBvYmplY3QKCQlvRFRTZXR0aW5ncyA9IGR0OwoJfQoKCS8vIENvbnZlcnQgZnJvbSBjYW1lbENhc2UgdG8gSHVuZ2FyaWFuLCBqdXN0IGFzIERhdGFUYWJsZXMgZG9lcwoJdmFyIGNhbWVsVG9IdW5nYXJpYW4gPSAkLmZuLmRhdGFUYWJsZS5jYW1lbFRvSHVuZ2FyaWFuOwoJaWYgKCBjYW1lbFRvSHVuZ2FyaWFuICkgewoJCWNhbWVsVG9IdW5nYXJpYW4oIENvbFJlb3JkZXIuZGVmYXVsdHMsIENvbFJlb3JkZXIuZGVmYXVsdHMsIHRydWUgKTsKCQljYW1lbFRvSHVuZ2FyaWFuKCBDb2xSZW9yZGVyLmRlZmF1bHRzLCBvcHRzIHx8IHt9ICk7Cgl9CgoKCS8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoKCSAqIFB1YmxpYyBjbGFzcyB2YXJpYWJsZXMKCSAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICovCgoJLyoqCgkgKiBAbmFtZXNwYWNlIFNldHRpbmdzIG9iamVjdCB3aGljaCBjb250YWlucyBjdXN0b21pc2FibGUgaW5mb3JtYXRpb24gZm9yIENvbFJlb3JkZXIgaW5zdGFuY2UKCSAqLwoJdGhpcy5zID0gewoJCS8qKgoJCSAqIERhdGFUYWJsZXMgc2V0dGluZ3Mgb2JqZWN0CgkJICogIEBwcm9wZXJ0eSBkdAoJCSAqICBAdHlwZSAgICAgT2JqZWN0CgkJICogIEBkZWZhdWx0ICBudWxsCgkJICovCgkJImR0IjogbnVsbCwKCgkJLyoqCgkJICogSW5pdGlhbGlzYXRpb24gb2JqZWN0IHVzZWQgZm9yIHRoaXMgaW5zdGFuY2UKCQkgKiAgQHByb3BlcnR5IGluaXQKCQkgKiAgQHR5cGUgICAgIG9iamVjdAoJCSAqICBAZGVmYXVsdCAge30KCQkgKi8KCQkiaW5pdCI6ICQuZXh0ZW5kKCB0cnVlLCB7fSwgQ29sUmVvcmRlci5kZWZhdWx0cywgb3B0cyApLAoKCQkvKioKCQkgKiBOdW1iZXIgb2YgY29sdW1ucyB0byBmaXggKG5vdCBhbGxvdyB0byBiZSByZW9yZGVyZWQpCgkJICogIEBwcm9wZXJ0eSBmaXhlZAoJCSAqICBAdHlwZSAgICAgaW50CgkJICogIEBkZWZhdWx0ICAwCgkJICovCgkJImZpeGVkIjogMCwKCgkJLyoqCgkJICogTnVtYmVyIG9mIGNvbHVtbnMgdG8gZml4IGNvdW50aW5nIGZyb20gcmlnaHQgKG5vdCBhbGxvdyB0byBiZSByZW9yZGVyZWQpCgkJICogIEBwcm9wZXJ0eSBmaXhlZFJpZ2h0CgkJICogIEB0eXBlICAgICBpbnQKCQkgKiAgQGRlZmF1bHQgIDAKCQkgKi8KCQkiZml4ZWRSaWdodCI6IDAsCgoJCS8qKgoJCSAqIENhbGxiYWNrIGZ1bmN0aW9uIGZvciBvbmNlIHRoZSByZW9yZGVyIGhhcyBiZWVuIGRvbmUKCQkgKiAgQHByb3BlcnR5IGRyb3BjYWxsYmFjawoJCSAqICBAdHlwZSAgICAgZnVuY3Rpb24KCQkgKiAgQGRlZmF1bHQgIG51bGwKCQkgKi8KCQkiZHJvcENhbGxiYWNrIjogbnVsbCwKCgkJLyoqCgkJICogQG5hbWVzcGFjZSBJbmZvcm1hdGlvbiB1c2VkIGZvciB0aGUgbW91c2UgZHJhZwoJCSAqLwoJCSJtb3VzZSI6IHsKCQkJInN0YXJ0WCI6IC0xLAoJCQkic3RhcnRZIjogLTEsCgkJCSJvZmZzZXRYIjogLTEsCgkJCSJvZmZzZXRZIjogLTEsCgkJCSJ0YXJnZXQiOiAtMSwKCQkJInRhcmdldEluZGV4IjogLTEsCgkJCSJmcm9tSW5kZXgiOiAtMQoJCX0sCgoJCS8qKgoJCSAqIEluZm9ybWF0aW9uIHdoaWNoIGlzIHVzZWQgZm9yIHBvc2l0aW9uaW5nIHRoZSBpbnNlcnQgY3Vzb3IgYW5kIGtub3dpbmcgd2hlcmUgdG8gZG8gdGhlCgkJICogaW5zZXJ0LiBBcnJheSBvZiBvYmplY3RzIHdpdGggdGhlIHByb3BlcnRpZXM6CgkJICogICB4OiB4LWF4aXMgcG9zaXRpb24KCQkgKiAgIHRvOiBpbnNlcnQgcG9pbnQKCQkgKiAgQHByb3BlcnR5IGFvVGFyZ2V0cwoJCSAqICBAdHlwZSAgICAgYXJyYXkKCQkgKiAgQGRlZmF1bHQgIFtdCgkJICovCgkJImFvVGFyZ2V0cyI6IFtdCgl9OwoKCgkvKioKCSAqIEBuYW1lc3BhY2UgQ29tbW9uIGFuZCB1c2VmdWwgRE9NIGVsZW1lbnRzIGZvciB0aGUgY2xhc3MgaW5zdGFuY2UKCSAqLwoJdGhpcy5kb20gPSB7CgkJLyoqCgkJICogRHJhZ2dpbmcgZWxlbWVudCAodGhlIG9uZSB0aGUgbW91c2UgaXMgbW92aW5nKQoJCSAqICBAcHJvcGVydHkgZHJhZwoJCSAqICBAdHlwZSAgICAgZWxlbWVudAoJCSAqICBAZGVmYXVsdCAgbnVsbAoJCSAqLwoJCSJkcmFnIjogbnVsbCwKCgkJLyoqCgkJICogVGhlIGluc2VydCBjdXJzb3IKCQkgKiAgQHByb3BlcnR5IHBvaW50ZXIKCQkgKiAgQHR5cGUgICAgIGVsZW1lbnQKCQkgKiAgQGRlZmF1bHQgIG51bGwKCQkgKi8KCQkicG9pbnRlciI6IG51bGwKCX07CgoKCS8qIENvbnN0cnVjdG9yIGxvZ2ljICovCgl0aGlzLnMuZHQgPSBvRFRTZXR0aW5ncy5vSW5zdGFuY2UuZm5TZXR0aW5ncygpOwoJdGhpcy5zLmR0Ll9jb2xSZW9yZGVyID0gdGhpczsKCXRoaXMuX2ZuQ29uc3RydWN0KCk7CgoJLyogQWRkIGRlc3Ryb3kgY2FsbGJhY2sgKi8KCW9EVFNldHRpbmdzLm9BcGkuX2ZuQ2FsbGJhY2tSZWcob0RUU2V0dGluZ3MsICdhb0Rlc3Ryb3lDYWxsYmFjaycsICQucHJveHkodGhpcy5fZm5EZXN0cm95LCB0aGlzKSwgJ0NvbFJlb3JkZXInKTsKCglyZXR1cm4gdGhpczsKfTsKCgoKQ29sUmVvcmRlci5wcm90b3R5cGUgPSB7CgkvKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqCgkgKiBQdWJsaWMgbWV0aG9kcwoJICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKi8KCgkvKioKCSAqIFJlc2V0IHRoZSBjb2x1bW4gb3JkZXJpbmcgdG8gdGhlIG9yaWdpbmFsIG9yZGVyaW5nIHRoYXQgd2FzIGRldGVjdGVkIG9uCgkgKiBzdGFydCB1cC4KCSAqICBAcmV0dXJuIHt0aGlzfSBSZXR1cm5zIGB0aGlzYCBmb3IgY2hhaW5pbmcuCgkgKgoJICogIEBleGFtcGxlCgkgKiAgICAvLyBEYXRhVGFibGVzIGluaXRpYWxpc2F0aW9uIHdpdGggQ29sUmVvcmRlcgoJICogICAgdmFyIHRhYmxlID0gJCgnI2V4YW1wbGUnKS5kYXRhVGFibGUoIHsKCSAqICAgICAgICAic0RvbSI6ICdSbGZydGlwJwoJICogICAgfSApOwoJICoKCSAqICAgIC8vIEFkZCBjbGljayBldmVudCB0byBhIGJ1dHRvbiB0byByZXNldCB0aGUgb3JkZXJpbmcKCSAqICAgICQoJyNyZXNldE9yZGVyaW5nJykuY2xpY2soIGZ1bmN0aW9uIChlKSB7CgkgKiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwoJICogICAgICAgICQuZm4uZGF0YVRhYmxlLkNvbFJlb3JkZXIoIHRhYmxlICkuZm5SZXNldCgpOwoJICogICAgfSApOwoJICovCgkiZm5SZXNldCI6IGZ1bmN0aW9uICgpCgl7CgkJdmFyIGEgPSBbXTsKCQlmb3IgKCB2YXIgaT0wLCBpTGVuPXRoaXMucy5kdC5hb0NvbHVtbnMubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQl7CgkJCWEucHVzaCggdGhpcy5zLmR0LmFvQ29sdW1uc1tpXS5fQ29sUmVvcmRlcl9pT3JpZ0NvbCApOwoJCX0KCgkJdGhpcy5fZm5PcmRlckNvbHVtbnMoIGEgKTsKCgkJcmV0dXJuIHRoaXM7Cgl9LAoKCS8qKgoJICogYERlcHJlY2F0ZWRgIC0gR2V0IHRoZSBjdXJyZW50IG9yZGVyIG9mIHRoZSBjb2x1bW5zLCBhcyBhbiBhcnJheS4KCSAqICBAcmV0dXJuIHthcnJheX0gQXJyYXkgb2YgY29sdW1uIGlkZW50aWZpZXJzCgkgKiAgQGRlcHJlY2F0ZWQgYGZuT3JkZXJgIHNob3VsZCBiZSB1c2VkIGluIHByZWZlcmVuY2UgdG8gdGhpcyBtZXRob2QuCgkgKiAgICAgIGBmbk9yZGVyYCBhY3RzIGFzIGEgZ2V0dGVyL3NldHRlci4KCSAqLwoJImZuR2V0Q3VycmVudE9yZGVyIjogZnVuY3Rpb24gKCkKCXsKCQlyZXR1cm4gdGhpcy5mbk9yZGVyKCk7Cgl9LAoKCS8qKgoJICogR2V0IHRoZSBjdXJyZW50IG9yZGVyIG9mIHRoZSBjb2x1bW5zLCBhcyBhbiBhcnJheS4gTm90ZSB0aGF0IHRoZSB2YWx1ZXMKCSAqIGdpdmVuIGluIHRoZSBhcnJheSBhcmUgdW5pcXVlIGlkZW50aWZpZXJzIGZvciBlYWNoIGNvbHVtbi4gQ3VycmVudGx5CgkgKiB0aGVzZSBhcmUgdGhlIG9yaWdpbmFsIG9yZGVyaW5nIG9mIHRoZSBjb2x1bW5zIHRoYXQgd2FzIGRldGVjdGVkIG9uCgkgKiBzdGFydCB1cCwgYnV0IHRoaXMgY291bGQgcG90ZW50aWFsbHkgY2hhbmdlIGluIGZ1dHVyZS4KCSAqICBAcmV0dXJuIHthcnJheX0gQXJyYXkgb2YgY29sdW1uIGlkZW50aWZpZXJzCgkgKgoJICogIEBleGFtcGxlCgkgKiAgICAvLyBHZXQgY29sdW1uIG9yZGVyaW5nIGZvciB0aGUgdGFibGUKCSAqICAgIHZhciBvcmRlciA9ICQuZm4uZGF0YVRhYmxlLkNvbFJlb3JkZXIoIGRhdGFUYWJsZSApLmZuT3JkZXIoKTsKCSAqLy8qKgoJICogU2V0IHRoZSBvcmRlciBvZiB0aGUgY29sdW1ucywgZnJvbSB0aGUgcG9zaXRpb25zIGlkZW50aWZpZWQgaW4gdGhlCgkgKiBvcmRlcmluZyBhcnJheSBnaXZlbi4gTm90ZSB0aGF0IENvbFJlb3JkZXIgdGFrZXMgYSBicnV0ZSBmb3JjZSBhcHByb2FjaAoJICogdG8gcmVvcmRlcmluZywgc28gaXQgaXMgcG9zc2libGUgbXVsdGlwbGUgcmVvcmRlcmluZyBldmVudHMgd2lsbCBvY2N1cgoJICogYmVmb3JlIHRoZSBmaW5hbCBvcmRlciBpcyBzZXR0bGVkIHVwb24uCgkgKiAgQHBhcmFtIHthcnJheX0gW3NldF0gQXJyYXkgb2YgY29sdW1uIGlkZW50aWZpZXJzIGluIHRoZSBuZXcgb3JkZXIuIE5vdGUKCSAqICAgIHRoYXQgZXZlcnkgY29sdW1uIG11c3QgYmUgaW5jbHVkZWQsIHVuaXF1ZWx5LCBpbiB0aGlzIGFycmF5LgoJICogIEByZXR1cm4ge3RoaXN9IFJldHVybnMgYHRoaXNgIGZvciBjaGFpbmluZy4KCSAqCgkgKiAgQGV4YW1wbGUKCSAqICAgIC8vIFN3YXAgdGhlIGZpcnN0IGFuZCBzZWNvbmQgY29sdW1ucwoJICogICAgJC5mbi5kYXRhVGFibGUuQ29sUmVvcmRlciggZGF0YVRhYmxlICkuZm5PcmRlciggWzEsIDAsIDIsIDMsIDRdICk7CgkgKgoJICogIEBleGFtcGxlCgkgKiAgICAvLyBNb3ZlIHRoZSBmaXJzdCBjb2x1bW4gdG8gdGhlIGVuZCBmb3IgdGhlIHRhYmxlIGAjZXhhbXBsZWAKCSAqICAgIHZhciBjdXJyID0gJC5mbi5kYXRhVGFibGUuQ29sUmVvcmRlciggJyNleGFtcGxlJyApLmZuT3JkZXIoKTsKCSAqICAgIHZhciBmaXJzdCA9IGN1cnIuc2hpZnQoKTsKCSAqICAgIGN1cnIucHVzaCggZmlyc3QgKTsKCSAqICAgICQuZm4uZGF0YVRhYmxlLkNvbFJlb3JkZXIoICcjZXhhbXBsZScgKS5mbk9yZGVyKCBjdXJyICk7CgkgKgoJICogIEBleGFtcGxlCgkgKiAgICAvLyBSZXZlcnNlIHRoZSB0YWJsZSdzIG9yZGVyCgkgKiAgICAkLmZuLmRhdGFUYWJsZS5Db2xSZW9yZGVyKCAnI2V4YW1wbGUnICkuZm5PcmRlcigKCSAqICAgICAgJC5mbi5kYXRhVGFibGUuQ29sUmVvcmRlciggJyNleGFtcGxlJyApLmZuT3JkZXIoKS5yZXZlcnNlKCkKCSAqICAgICk7CgkgKi8KCSJmbk9yZGVyIjogZnVuY3Rpb24gKCBzZXQgKQoJewoJCWlmICggc2V0ID09PSB1bmRlZmluZWQgKQoJCXsKCQkJdmFyIGEgPSBbXTsKCQkJZm9yICggdmFyIGk9MCwgaUxlbj10aGlzLnMuZHQuYW9Db2x1bW5zLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApCgkJCXsKCQkJCWEucHVzaCggdGhpcy5zLmR0LmFvQ29sdW1uc1tpXS5fQ29sUmVvcmRlcl9pT3JpZ0NvbCApOwoJCQl9CgkJCXJldHVybiBhOwoJCX0KCgkJdGhpcy5fZm5PcmRlckNvbHVtbnMoIGZuSW52ZXJ0S2V5VmFsdWVzKCBzZXQgKSApOwoKCQlyZXR1cm4gdGhpczsKCX0sCgoKCS8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoKCSAqIFByaXZhdGUgbWV0aG9kcyAodGhleSBhcmUgb2YgY291cnNlIHB1YmxpYyBpbiBKUywgYnV0IHJlY29tbWVuZGVkIGFzIHByaXZhdGUpCgkgKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqLwoKCS8qKgoJICogQ29uc3RydWN0b3IgbG9naWMKCSAqICBAbWV0aG9kICBfZm5Db25zdHJ1Y3QKCSAqICBAcmV0dXJucyB2b2lkCgkgKiAgQHByaXZhdGUKCSAqLwoJIl9mbkNvbnN0cnVjdCI6IGZ1bmN0aW9uICgpCgl7CgkJdmFyIHRoYXQgPSB0aGlzOwoJCXZhciBpTGVuID0gdGhpcy5zLmR0LmFvQ29sdW1ucy5sZW5ndGg7CgkJdmFyIGk7CgoJCS8qIENvbHVtbnMgZGlzY291bnRlZCBmcm9tIHJlb3JkZXJpbmcgLSBjb3VudGluZyBsZWZ0IHRvIHJpZ2h0ICovCgkJaWYgKCB0aGlzLnMuaW5pdC5pRml4ZWRDb2x1bW5zICkKCQl7CgkJCXRoaXMucy5maXhlZCA9IHRoaXMucy5pbml0LmlGaXhlZENvbHVtbnM7CgkJfQoKCQkvKiBDb2x1bW5zIGRpc2NvdW50ZWQgZnJvbSByZW9yZGVyaW5nIC0gY291bnRpbmcgcmlnaHQgdG8gbGVmdCAqLwoJCXRoaXMucy5maXhlZFJpZ2h0ID0gdGhpcy5zLmluaXQuaUZpeGVkQ29sdW1uc1JpZ2h0ID8KCQkJdGhpcy5zLmluaXQuaUZpeGVkQ29sdW1uc1JpZ2h0IDoKCQkJMDsKCgkJLyogRHJvcCBjYWxsYmFjayBpbml0aWFsaXNhdGlvbiBvcHRpb24gKi8KCQlpZiAoIHRoaXMucy5pbml0LmZuUmVvcmRlckNhbGxiYWNrICkKCQl7CgkJCXRoaXMucy5kcm9wQ2FsbGJhY2sgPSB0aGlzLnMuaW5pdC5mblJlb3JkZXJDYWxsYmFjazsKCQl9CgoJCS8qIEFkZCBldmVudCBoYW5kbGVycyBmb3IgdGhlIGRyYWcgYW5kIGRyb3AsIGFuZCBhbHNvIG1hcmsgdGhlIG9yaWdpbmFsIGNvbHVtbiBvcmRlciAqLwoJCWZvciAoIGkgPSAwOyBpIDwgaUxlbjsgaSsrICkKCQl7CgkJCWlmICggaSA+IHRoaXMucy5maXhlZC0xICYmIGkgPCBpTGVuIC0gdGhpcy5zLmZpeGVkUmlnaHQgKQoJCQl7CgkJCQl0aGlzLl9mbk1vdXNlTGlzdGVuZXIoIGksIHRoaXMucy5kdC5hb0NvbHVtbnNbaV0ublRoICk7CgkJCX0KCgkJCS8qIE1hcmsgdGhlIG9yaWdpbmFsIGNvbHVtbiBvcmRlciBmb3IgbGF0ZXIgcmVmZXJlbmNlICovCgkJCXRoaXMucy5kdC5hb0NvbHVtbnNbaV0uX0NvbFJlb3JkZXJfaU9yaWdDb2wgPSBpOwoJCX0KCgkJLyogU3RhdGUgc2F2aW5nICovCgkJdGhpcy5zLmR0Lm9BcGkuX2ZuQ2FsbGJhY2tSZWcoIHRoaXMucy5kdCwgJ2FvU3RhdGVTYXZlUGFyYW1zJywgZnVuY3Rpb24gKG9TLCBvRGF0YSkgewoJCQl0aGF0Ll9mblN0YXRlU2F2ZS5jYWxsKCB0aGF0LCBvRGF0YSApOwoJCX0sICJDb2xSZW9yZGVyX1N0YXRlIiApOwoKCQkvKiBBbiBpbml0aWFsIGNvbHVtbiBvcmRlciBoYXMgYmVlbiBzcGVjaWZpZWQgKi8KCQl2YXIgYWlPcmRlciA9IG51bGw7CgkJaWYgKCB0aGlzLnMuaW5pdC5haU9yZGVyICkKCQl7CgkJCWFpT3JkZXIgPSB0aGlzLnMuaW5pdC5haU9yZGVyLnNsaWNlKCk7CgkJfQoKCQkvKiBTdGF0ZSBsb2FkaW5nLCBvdmVycmlkZXMgdGhlIGNvbHVtbiBvcmRlciBnaXZlbiAqLwoJCWlmICggdGhpcy5zLmR0Lm9Mb2FkZWRTdGF0ZSAmJiB0eXBlb2YgdGhpcy5zLmR0Lm9Mb2FkZWRTdGF0ZS5Db2xSZW9yZGVyICE9ICd1bmRlZmluZWQnICYmCgkJICB0aGlzLnMuZHQub0xvYWRlZFN0YXRlLkNvbFJlb3JkZXIubGVuZ3RoID09IHRoaXMucy5kdC5hb0NvbHVtbnMubGVuZ3RoICkKCQl7CgkJCWFpT3JkZXIgPSB0aGlzLnMuZHQub0xvYWRlZFN0YXRlLkNvbFJlb3JkZXI7CgkJfQoKCQkvKiBJZiB3ZSBoYXZlIGFuIG9yZGVyIHRvIGFwcGx5IC0gZG8gc28gKi8KCQlpZiAoIGFpT3JkZXIgKQoJCXsKCQkJLyogV2UgbWlnaHQgYmUgY2FsbGVkIGR1cmluZyBvciBhZnRlciB0aGUgRGF0YVRhYmxlcyBpbml0aWFsaXNhdGlvbi4gSWYgYmVmb3JlLCB0aGVuIHdlIG5lZWQKCQkJICogdG8gd2FpdCB1bnRpbCB0aGUgZHJhdyBpcyBkb25lLCBpZiBhZnRlciwgdGhlbiBkbyB3aGF0IHdlIG5lZWQgdG8gZG8gcmlnaHQgYXdheQoJCQkgKi8KCQkJaWYgKCAhdGhhdC5zLmR0Ll9iSW5pdENvbXBsZXRlICkKCQkJewoJCQkJdmFyIGJEb25lID0gZmFsc2U7CgkJCQl0aGlzLnMuZHQuYW9EcmF3Q2FsbGJhY2sucHVzaCggewoJCQkJCSJmbiI6IGZ1bmN0aW9uICgpIHsKCQkJCQkJaWYgKCAhdGhhdC5zLmR0Ll9iSW5pdENvbXBsZXRlICYmICFiRG9uZSApCgkJCQkJCXsKCQkJCQkJCWJEb25lID0gdHJ1ZTsKCQkJCQkJCXZhciByZXNvcnQgPSBmbkludmVydEtleVZhbHVlcyggYWlPcmRlciApOwoJCQkJCQkJdGhhdC5fZm5PcmRlckNvbHVtbnMuY2FsbCggdGhhdCwgcmVzb3J0ICk7CgkJCQkJCX0KCQkJCQl9LAoJCQkJCSJzTmFtZSI6ICJDb2xSZW9yZGVyX1ByZSIKCQkJCX0gKTsKCQkJfQoJCQllbHNlCgkJCXsKCQkJCXZhciByZXNvcnQgPSBmbkludmVydEtleVZhbHVlcyggYWlPcmRlciApOwoJCQkJdGhhdC5fZm5PcmRlckNvbHVtbnMuY2FsbCggdGhhdCwgcmVzb3J0ICk7CgkJCX0KCQl9CgkJZWxzZSB7CgkJCXRoaXMuX2ZuU2V0Q29sdW1uSW5kZXhlcygpOwoJCX0KCX0sCgoKCS8qKgoJICogU2V0IHRoZSBjb2x1bW4gb3JkZXIgZnJvbSBhbiBhcnJheQoJICogIEBtZXRob2QgIF9mbk9yZGVyQ29sdW1ucwoJICogIEBwYXJhbSAgIGFycmF5IGEgQW4gYXJyYXkgb2YgaW50ZWdlcnMgd2hpY2ggZGljdGF0ZSB0aGUgY29sdW1uIG9yZGVyIHRoYXQgc2hvdWxkIGJlIGFwcGxpZWQKCSAqICBAcmV0dXJucyB2b2lkCgkgKiAgQHByaXZhdGUKCSAqLwoJIl9mbk9yZGVyQ29sdW1ucyI6IGZ1bmN0aW9uICggYSApCgl7CgkJaWYgKCBhLmxlbmd0aCAhPSB0aGlzLnMuZHQuYW9Db2x1bW5zLmxlbmd0aCApCgkJewoJCQl0aGlzLnMuZHQub0luc3RhbmNlLm9BcGkuX2ZuTG9nKCB0aGlzLnMuZHQsIDEsICJDb2xSZW9yZGVyIC0gYXJyYXkgcmVvcmRlciBkb2VzIG5vdCAiKwoJCQkJIm1hdGNoIGtub3duIG51bWJlciBvZiBjb2x1bW5zLiBTa2lwcGluZy4iICk7CgkJCXJldHVybjsKCQl9CgoJCWZvciAoIHZhciBpPTAsIGlMZW49YS5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCXsKCQkJdmFyIGN1cnJJbmRleCA9ICQuaW5BcnJheSggaSwgYSApOwoJCQlpZiAoIGkgIT0gY3VyckluZGV4ICkKCQkJewoJCQkJLyogUmVvcmRlciBvdXIgc3dpdGNoaW5nIGFycmF5ICovCgkJCQlmbkFycmF5U3dpdGNoKCBhLCBjdXJySW5kZXgsIGkgKTsKCgkJCQkvKiBEbyB0aGUgY29sdW1uIHJlb3JkZXIgaW4gdGhlIHRhYmxlICovCgkJCQl0aGlzLnMuZHQub0luc3RhbmNlLmZuQ29sUmVvcmRlciggY3VyckluZGV4LCBpICk7CgkJCX0KCQl9CgoJCS8qIFdoZW4gc2Nyb2xsaW5nIHdlIG5lZWQgdG8gcmVjYWxjdWxhdGUgdGhlIGNvbHVtbiBzaXplcyB0byBhbGxvdyBmb3IgdGhlIHNoaWZ0ICovCgkJaWYgKCB0aGlzLnMuZHQub1Njcm9sbC5zWCAhPT0gIiIgfHwgdGhpcy5zLmR0Lm9TY3JvbGwuc1kgIT09ICIiICkKCQl7CgkJCXRoaXMucy5kdC5vSW5zdGFuY2UuZm5BZGp1c3RDb2x1bW5TaXppbmcoKTsKCQl9CgoJCS8qIFNhdmUgdGhlIHN0YXRlICovCgkJdGhpcy5zLmR0Lm9JbnN0YW5jZS5vQXBpLl9mblNhdmVTdGF0ZSggdGhpcy5zLmR0ICk7CgoJCXRoaXMuX2ZuU2V0Q29sdW1uSW5kZXhlcygpOwoJfSwKCgoJLyoqCgkgKiBCZWNhdXNlIHdlIGNoYW5nZSB0aGUgaW5kZXhlcyBvZiBjb2x1bW5zIGluIHRoZSB0YWJsZSwgcmVsYXRpdmUgdG8gdGhlaXIgc3RhcnRpbmcgcG9pbnQKCSAqIHdlIG5lZWQgdG8gcmVvcmRlciB0aGUgc3RhdGUgY29sdW1ucyB0byB3aGF0IHRoZXkgYXJlIGF0IHRoZSBzdGFydGluZyBwb2ludCBzbyB3ZSBjYW4KCSAqIHRoZW4gcmVhcnJhbmdlIHRoZW0gYWdhaW4gb24gc3RhdGUgbG9hZCEKCSAqICBAbWV0aG9kICBfZm5TdGF0ZVNhdmUKCSAqICBAcGFyYW0gICBvYmplY3Qgb1N0YXRlIERhdGFUYWJsZXMgc3RhdGUKCSAqICBAcmV0dXJucyBzdHJpbmcgSlNPTiBlbmNvZGVkIGNvb2tpZSBzdHJpbmcgZm9yIERhdGFUYWJsZXMKCSAqICBAcHJpdmF0ZQoJICovCgkiX2ZuU3RhdGVTYXZlIjogZnVuY3Rpb24gKCBvU3RhdGUgKQoJewoJCXZhciBpLCBpTGVuLCBhQ29weSwgaU9yaWdDb2x1bW47CgkJdmFyIG9TZXR0aW5ncyA9IHRoaXMucy5kdDsKCQl2YXIgY29sdW1ucyA9IG9TZXR0aW5ncy5hb0NvbHVtbnM7CgoJCW9TdGF0ZS5Db2xSZW9yZGVyID0gW107CgoJCS8qIFNvcnRpbmcgKi8KCQlpZiAoIG9TdGF0ZS5hYVNvcnRpbmcgKSB7CgkJCS8vIDEuMTAuMC0KCQkJZm9yICggaT0wIDsgaTxvU3RhdGUuYWFTb3J0aW5nLmxlbmd0aCA7IGkrKyApIHsKCQkJCW9TdGF0ZS5hYVNvcnRpbmdbaV1bMF0gPSBjb2x1bW5zWyBvU3RhdGUuYWFTb3J0aW5nW2ldWzBdIF0uX0NvbFJlb3JkZXJfaU9yaWdDb2w7CgkJCX0KCgkJCXZhciBhU2VhcmNoQ29weSA9ICQuZXh0ZW5kKCB0cnVlLCBbXSwgb1N0YXRlLmFvU2VhcmNoQ29scyApOwoKCQkJZm9yICggaT0wLCBpTGVuPWNvbHVtbnMubGVuZ3RoIDsgaTxpTGVuIDsgaSsrICkKCQkJewoJCQkJaU9yaWdDb2x1bW4gPSBjb2x1bW5zW2ldLl9Db2xSZW9yZGVyX2lPcmlnQ29sOwoKCQkJCS8qIENvbHVtbiBmaWx0ZXIgKi8KCQkJCW9TdGF0ZS5hb1NlYXJjaENvbHNbIGlPcmlnQ29sdW1uIF0gPSBhU2VhcmNoQ29weVtpXTsKCgkJCQkvKiBWaXNpYmlsaXR5ICovCgkJCQlvU3RhdGUuYWJWaXNDb2xzWyBpT3JpZ0NvbHVtbiBdID0gY29sdW1uc1tpXS5iVmlzaWJsZTsKCgkJCQkvKiBDb2x1bW4gcmVvcmRlcmluZyAqLwoJCQkJb1N0YXRlLkNvbFJlb3JkZXIucHVzaCggaU9yaWdDb2x1bW4gKTsKCQkJfQoJCX0KCQllbHNlIGlmICggb1N0YXRlLm9yZGVyICkgewoJCQkvLyAxLjEwLjErCgkJCWZvciAoIGk9MCA7IGk8b1N0YXRlLm9yZGVyLmxlbmd0aCA7IGkrKyApIHsKCQkJCW9TdGF0ZS5vcmRlcltpXVswXSA9IGNvbHVtbnNbIG9TdGF0ZS5vcmRlcltpXVswXSBdLl9Db2xSZW9yZGVyX2lPcmlnQ29sOwoJCQl9CgoJCQl2YXIgc3RhdGVDb2x1bW5zQ29weSA9ICQuZXh0ZW5kKCB0cnVlLCBbXSwgb1N0YXRlLmNvbHVtbnMgKTsKCgkJCWZvciAoIGk9MCwgaUxlbj1jb2x1bW5zLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApCgkJCXsKCQkJCWlPcmlnQ29sdW1uID0gY29sdW1uc1tpXS5fQ29sUmVvcmRlcl9pT3JpZ0NvbDsKCgkJCQkvKiBDb2x1bW5zICovCgkJCQlvU3RhdGUuY29sdW1uc1sgaU9yaWdDb2x1bW4gXSA9IHN0YXRlQ29sdW1uc0NvcHlbaV07CgoJCQkJLyogQ29sdW1uIHJlb3JkZXJpbmcgKi8KCQkJCW9TdGF0ZS5Db2xSZW9yZGVyLnB1c2goIGlPcmlnQ29sdW1uICk7CgkJCX0KCQl9Cgl9LAoKCgkvKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqCgkgKiBNb3VzZSBkcm9wIGFuZCBkcmFnCgkgKi8KCgkvKioKCSAqIEFkZCBhIG1vdXNlIGRvd24gbGlzdGVuZXIgdG8gYSBwYXJ0aWNsdWFyIFRIIGVsZW1lbnQKCSAqICBAbWV0aG9kICBfZm5Nb3VzZUxpc3RlbmVyCgkgKiAgQHBhcmFtICAgaW50IGkgQ29sdW1uIGluZGV4CgkgKiAgQHBhcmFtICAgZWxlbWVudCBuVGggVEggZWxlbWVudCBjbGlja2VkIG9uCgkgKiAgQHJldHVybnMgdm9pZAoJICogIEBwcml2YXRlCgkgKi8KCSJfZm5Nb3VzZUxpc3RlbmVyIjogZnVuY3Rpb24gKCBpLCBuVGggKQoJewoJCXZhciB0aGF0ID0gdGhpczsKCQkkKG5UaCkub24oICdtb3VzZWRvd24uQ29sUmVvcmRlcicsIGZ1bmN0aW9uIChlKSB7CgkJCWUucHJldmVudERlZmF1bHQoKTsKCQkJdGhhdC5fZm5Nb3VzZURvd24uY2FsbCggdGhhdCwgZSwgblRoICk7CgkJfSApOwoJfSwKCgoJLyoqCgkgKiBNb3VzZSBkb3duIG9uIGEgVEggZWxlbWVudCBpbiB0aGUgdGFibGUgaGVhZGVyCgkgKiAgQG1ldGhvZCAgX2ZuTW91c2VEb3duCgkgKiAgQHBhcmFtICAgZXZlbnQgZSBNb3VzZSBldmVudAoJICogIEBwYXJhbSAgIGVsZW1lbnQgblRoIFRIIGVsZW1lbnQgdG8gYmUgZHJhZ2dlZAoJICogIEByZXR1cm5zIHZvaWQKCSAqICBAcHJpdmF0ZQoJICovCgkiX2ZuTW91c2VEb3duIjogZnVuY3Rpb24gKCBlLCBuVGggKQoJewoJCXZhciB0aGF0ID0gdGhpczsKCgkJLyogU3RvcmUgaW5mb3JtYXRpb24gYWJvdXQgdGhlIG1vdXNlIHBvc2l0aW9uICovCgkJdmFyIHRhcmdldCA9ICQoZS50YXJnZXQpLmNsb3Nlc3QoJ3RoLCB0ZCcpOwoJCXZhciBvZmZzZXQgPSB0YXJnZXQub2Zmc2V0KCk7CgkJdmFyIGlkeCA9IHBhcnNlSW50KCAkKG5UaCkuYXR0cignZGF0YS1jb2x1bW4taW5kZXgnKSwgMTAgKTsKCgkJaWYgKCBpZHggPT09IHVuZGVmaW5lZCApIHsKCQkJcmV0dXJuOwoJCX0KCgkJdGhpcy5zLm1vdXNlLnN0YXJ0WCA9IGUucGFnZVg7CgkJdGhpcy5zLm1vdXNlLnN0YXJ0WSA9IGUucGFnZVk7CgkJdGhpcy5zLm1vdXNlLm9mZnNldFggPSBlLnBhZ2VYIC0gb2Zmc2V0LmxlZnQ7CgkJdGhpcy5zLm1vdXNlLm9mZnNldFkgPSBlLnBhZ2VZIC0gb2Zmc2V0LnRvcDsKCQl0aGlzLnMubW91c2UudGFyZ2V0ID0gdGhpcy5zLmR0LmFvQ29sdW1uc1sgaWR4IF0ublRoOy8vdGFyZ2V0WzBdOwoJCXRoaXMucy5tb3VzZS50YXJnZXRJbmRleCA9IGlkeDsKCQl0aGlzLnMubW91c2UuZnJvbUluZGV4ID0gaWR4OwoKCQl0aGlzLl9mblJlZ2lvbnMoKTsKCgkJLyogQWRkIGV2ZW50IGhhbmRsZXJzIHRvIHRoZSBkb2N1bWVudCAqLwoJCSQoZG9jdW1lbnQpCgkJCS5vbiggJ21vdXNlbW92ZS5Db2xSZW9yZGVyJywgZnVuY3Rpb24gKGUpIHsKCQkJCXRoYXQuX2ZuTW91c2VNb3ZlLmNhbGwoIHRoYXQsIGUgKTsKCQkJfSApCgkJCS5vbiggJ21vdXNldXAuQ29sUmVvcmRlcicsIGZ1bmN0aW9uIChlKSB7CgkJCQl0aGF0Ll9mbk1vdXNlVXAuY2FsbCggdGhhdCwgZSApOwoJCQl9ICk7Cgl9LAoKCgkvKioKCSAqIERlYWwgd2l0aCBhIG1vdXNlIG1vdmUgZXZlbnQgd2hpbGUgZHJhZ2dpbmcgYSBub2RlCgkgKiAgQG1ldGhvZCAgX2ZuTW91c2VNb3ZlCgkgKiAgQHBhcmFtICAgZXZlbnQgZSBNb3VzZSBldmVudAoJICogIEByZXR1cm5zIHZvaWQKCSAqICBAcHJpdmF0ZQoJICovCgkiX2ZuTW91c2VNb3ZlIjogZnVuY3Rpb24gKCBlICkKCXsKCQl2YXIgdGhhdCA9IHRoaXM7CgoJCWlmICggdGhpcy5kb20uZHJhZyA9PT0gbnVsbCApCgkJewoJCQkvKiBPbmx5IGNyZWF0ZSB0aGUgZHJhZyBlbGVtZW50IGlmIHRoZSBtb3VzZSBoYXMgbW92ZWQgYSBzcGVjaWZpYyBkaXN0YW5jZSBmcm9tIHRoZSBzdGFydAoJCQkgKiBwb2ludCAtIHRoaXMgYWxsb3dzIHRoZSB1c2VyIHRvIG1ha2Ugc21hbGwgbW91c2UgbW92ZW1lbnRzIHdoZW4gc29ydGluZyBhbmQgbm90IGhhdmUgYQoJCQkgKiBwb3NzaWJseSBjb25mdXNpbmcgZHJhZyBlbGVtZW50IHNob3dpbmcgdXAKCQkJICovCgkJCWlmICggTWF0aC5wb3coCgkJCQlNYXRoLnBvdyhlLnBhZ2VYIC0gdGhpcy5zLm1vdXNlLnN0YXJ0WCwgMikgKwoJCQkJTWF0aC5wb3coZS5wYWdlWSAtIHRoaXMucy5tb3VzZS5zdGFydFksIDIpLCAwLjUgKSA8IDUgKQoJCQl7CgkJCQlyZXR1cm47CgkJCX0KCQkJdGhpcy5fZm5DcmVhdGVEcmFnTm9kZSgpOwoJCX0KCgkJLyogUG9zaXRpb24gdGhlIGVsZW1lbnQgLSB3ZSByZXNwZWN0IHdoZXJlIGluIHRoZSBlbGVtZW50IHRoZSBjbGljayBvY2N1cmVkICovCgkJdGhpcy5kb20uZHJhZy5jc3MoIHsKCQkJbGVmdDogZS5wYWdlWCAtIHRoaXMucy5tb3VzZS5vZmZzZXRYLAoJCQl0b3A6IGUucGFnZVkgLSB0aGlzLnMubW91c2Uub2Zmc2V0WQoJCX0gKTsKCgkJLyogQmFzZWQgb24gdGhlIGN1cnJlbnQgbW91c2UgcG9zaXRpb24sIGNhbGN1bGF0ZSB3aGVyZSB0aGUgaW5zZXJ0IHNob3VsZCBnbyAqLwoJCXZhciBiU2V0ID0gZmFsc2U7CgkJdmFyIGxhc3RUb0luZGV4ID0gdGhpcy5zLm1vdXNlLnRvSW5kZXg7CgoJCWZvciAoIHZhciBpPTEsIGlMZW49dGhpcy5zLmFvVGFyZ2V0cy5sZW5ndGggOyBpPGlMZW4gOyBpKysgKQoJCXsKCQkJaWYgKCBlLnBhZ2VYIDwgdGhpcy5zLmFvVGFyZ2V0c1tpLTFdLnggKyAoKHRoaXMucy5hb1RhcmdldHNbaV0ueC10aGlzLnMuYW9UYXJnZXRzW2ktMV0ueCkvMikgKQoJCQl7CgkJCQl0aGlzLmRvbS5wb2ludGVyLmNzcyggJ2xlZnQnLCB0aGlzLnMuYW9UYXJnZXRzW2ktMV0ueCApOwoJCQkJdGhpcy5zLm1vdXNlLnRvSW5kZXggPSB0aGlzLnMuYW9UYXJnZXRzW2ktMV0udG87CgkJCQliU2V0ID0gdHJ1ZTsKCQkJCWJyZWFrOwoJCQl9CgkJfQoKCQkvLyBUaGUgaW5zZXJ0IGVsZW1lbnQgd2Fzbid0IHBvc2l0aW9uZWQgaW4gdGhlIGFycmF5IChsZXNzIHRoYW4KCQkvLyBvcGVyYXRvciksIHNvIHdlIHB1dCBpdCBhdCB0aGUgZW5kCgkJaWYgKCAhYlNldCApCgkJewoJCQl0aGlzLmRvbS5wb2ludGVyLmNzcyggJ2xlZnQnLCB0aGlzLnMuYW9UYXJnZXRzW3RoaXMucy5hb1RhcmdldHMubGVuZ3RoLTFdLnggKTsKCQkJdGhpcy5zLm1vdXNlLnRvSW5kZXggPSB0aGlzLnMuYW9UYXJnZXRzW3RoaXMucy5hb1RhcmdldHMubGVuZ3RoLTFdLnRvOwoJCX0KCgkJLy8gUGVyZm9ybSByZW9yZGVyaW5nIGlmIHJlYWx0aW1lIHVwZGF0aW5nIGlzIG9uIGFuZCB0aGUgY29sdW1uIGhhcyBtb3ZlZAoJCWlmICggdGhpcy5zLmluaXQuYlJlYWx0aW1lICYmIGxhc3RUb0luZGV4ICE9PSB0aGlzLnMubW91c2UudG9JbmRleCApIHsKCQkJdGhpcy5zLmR0Lm9JbnN0YW5jZS5mbkNvbFJlb3JkZXIoIHRoaXMucy5tb3VzZS5mcm9tSW5kZXgsIHRoaXMucy5tb3VzZS50b0luZGV4ICk7CgkJCXRoaXMucy5tb3VzZS5mcm9tSW5kZXggPSB0aGlzLnMubW91c2UudG9JbmRleDsKCQkJdGhpcy5fZm5SZWdpb25zKCk7CgkJfQoJfSwKCgoJLyoqCgkgKiBGaW5pc2ggb2ZmIHRoZSBtb3VzZSBkcmFnIGFuZCBpbnNlcnQgdGhlIGNvbHVtbiB3aGVyZSBuZWVkZWQKCSAqICBAbWV0aG9kICBfZm5Nb3VzZVVwCgkgKiAgQHBhcmFtICAgZXZlbnQgZSBNb3VzZSBldmVudAoJICogIEByZXR1cm5zIHZvaWQKCSAqICBAcHJpdmF0ZQoJICovCgkiX2ZuTW91c2VVcCI6IGZ1bmN0aW9uICggZSApCgl7CgkJdmFyIHRoYXQgPSB0aGlzOwoKCQkkKGRvY3VtZW50KS5vZmYoICdtb3VzZW1vdmUuQ29sUmVvcmRlciBtb3VzZXVwLkNvbFJlb3JkZXInICk7CgoJCWlmICggdGhpcy5kb20uZHJhZyAhPT0gbnVsbCApCgkJewoJCQkvKiBSZW1vdmUgdGhlIGd1aWRlIGVsZW1lbnRzICovCgkJCXRoaXMuZG9tLmRyYWcucmVtb3ZlKCk7CgkJCXRoaXMuZG9tLnBvaW50ZXIucmVtb3ZlKCk7CgkJCXRoaXMuZG9tLmRyYWcgPSBudWxsOwoJCQl0aGlzLmRvbS5wb2ludGVyID0gbnVsbDsKCgkJCS8qIEFjdHVhbGx5IGRvIHRoZSByZW9yZGVyICovCgkJCXRoaXMucy5kdC5vSW5zdGFuY2UuZm5Db2xSZW9yZGVyKCB0aGlzLnMubW91c2UuZnJvbUluZGV4LCB0aGlzLnMubW91c2UudG9JbmRleCApOwoJCQl0aGlzLl9mblNldENvbHVtbkluZGV4ZXMoKTsKCgkJCS8qIFdoZW4gc2Nyb2xsaW5nIHdlIG5lZWQgdG8gcmVjYWxjdWxhdGUgdGhlIGNvbHVtbiBzaXplcyB0byBhbGxvdyBmb3IgdGhlIHNoaWZ0ICovCgkJCWlmICggdGhpcy5zLmR0Lm9TY3JvbGwuc1ggIT09ICIiIHx8IHRoaXMucy5kdC5vU2Nyb2xsLnNZICE9PSAiIiApCgkJCXsKCQkJCXRoaXMucy5kdC5vSW5zdGFuY2UuZm5BZGp1c3RDb2x1bW5TaXppbmcoKTsKCQkJfQoKCQkJaWYgKCB0aGlzLnMuZHJvcENhbGxiYWNrICE9PSBudWxsICkKCQkJewoJCQkJdGhpcy5zLmRyb3BDYWxsYmFjay5jYWxsKCB0aGlzICk7CgkJCX0KCgkJCS8qIFNhdmUgdGhlIHN0YXRlICovCgkJCXRoaXMucy5kdC5vSW5zdGFuY2Uub0FwaS5fZm5TYXZlU3RhdGUoIHRoaXMucy5kdCApOwoJCX0KCX0sCgoKCS8qKgoJICogQ2FsY3VsYXRlIGEgY2FjaGVkIGFycmF5IHdpdGggdGhlIHBvaW50cyBvZiB0aGUgY29sdW1uIGluc2VydHMsIGFuZCB0aGUKCSAqICd0bycgcG9pbnRzCgkgKiAgQG1ldGhvZCAgX2ZuUmVnaW9ucwoJICogIEByZXR1cm5zIHZvaWQKCSAqICBAcHJpdmF0ZQoJICovCgkiX2ZuUmVnaW9ucyI6IGZ1bmN0aW9uICgpCgl7CgkJdmFyIGFvQ29sdW1ucyA9IHRoaXMucy5kdC5hb0NvbHVtbnM7CgoJCXRoaXMucy5hb1RhcmdldHMuc3BsaWNlKCAwLCB0aGlzLnMuYW9UYXJnZXRzLmxlbmd0aCApOwoKCQl0aGlzLnMuYW9UYXJnZXRzLnB1c2goIHsKCQkJIngiOiAgJCh0aGlzLnMuZHQublRhYmxlKS5vZmZzZXQoKS5sZWZ0LAoJCQkidG8iOiAwCgkJfSApOwoKCQl2YXIgaVRvUG9pbnQgPSAwOwoJCWZvciAoIHZhciBpPTAsIGlMZW49YW9Db2x1bW5zLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApCgkJewoJCQkvKiBGb3IgdGhlIGNvbHVtbiAvIGhlYWRlciBpbiBxdWVzdGlvbiwgd2Ugd2FudCBpdCdzIHBvc2l0aW9uIHRvIHJlbWFpbiB0aGUgc2FtZSBpZiB0aGUKCQkJICogcG9zaXRpb24gaXMganVzdCB0byBpdCdzIGltbWVkaWF0ZSBsZWZ0IG9yIHJpZ2h0LCBzbyB3ZSBvbmx5IGluY3JlbWVtZW50IHRoZSBjb3VudGVyIGZvcgoJCQkgKiBvdGhlciBjb2x1bW5zCgkJCSAqLwoJCQlpZiAoIGkgIT0gdGhpcy5zLm1vdXNlLmZyb21JbmRleCApCgkJCXsKCQkJCWlUb1BvaW50Kys7CgkJCX0KCgkJCWlmICggYW9Db2x1bW5zW2ldLmJWaXNpYmxlICkKCQkJewoJCQkJdGhpcy5zLmFvVGFyZ2V0cy5wdXNoKCB7CgkJCQkJIngiOiAgJChhb0NvbHVtbnNbaV0ublRoKS5vZmZzZXQoKS5sZWZ0ICsgJChhb0NvbHVtbnNbaV0ublRoKS5vdXRlcldpZHRoKCksCgkJCQkJInRvIjogaVRvUG9pbnQKCQkJCX0gKTsKCQkJfQoJCX0KCgkJLyogRGlzYWxsb3cgY29sdW1ucyBmb3IgYmVpbmcgcmVvcmRlcmVkIGJ5IGRyYWcgYW5kIGRyb3AsIGNvdW50aW5nIHJpZ2h0IHRvIGxlZnQgKi8KCQlpZiAoIHRoaXMucy5maXhlZFJpZ2h0ICE9PSAwICkKCQl7CgkJCXRoaXMucy5hb1RhcmdldHMuc3BsaWNlKCB0aGlzLnMuYW9UYXJnZXRzLmxlbmd0aCAtIHRoaXMucy5maXhlZFJpZ2h0ICk7CgkJfQoKCQkvKiBEaXNhbGxvdyBjb2x1bW5zIGZvciBiZWluZyByZW9yZGVyZWQgYnkgZHJhZyBhbmQgZHJvcCwgY291bnRpbmcgbGVmdCB0byByaWdodCAqLwoJCWlmICggdGhpcy5zLmZpeGVkICE9PSAwICkKCQl7CgkJCXRoaXMucy5hb1RhcmdldHMuc3BsaWNlKCAwLCB0aGlzLnMuZml4ZWQgKTsKCQl9Cgl9LAoKCgkvKioKCSAqIENvcHkgdGhlIFRIIGVsZW1lbnQgdGhhdCBpcyBiZWluZyBkcmFncyBzbyB0aGUgdXNlciBoYXMgdGhlIGlkZWEgdGhhdCB0aGV5IGFyZSBhY3R1YWxseQoJICogbW92aW5nIGl0IGFyb3VuZCB0aGUgcGFnZS4KCSAqICBAbWV0aG9kICBfZm5DcmVhdGVEcmFnTm9kZQoJICogIEByZXR1cm5zIHZvaWQKCSAqICBAcHJpdmF0ZQoJICovCgkiX2ZuQ3JlYXRlRHJhZ05vZGUiOiBmdW5jdGlvbiAoKQoJewoJCXZhciBzY3JvbGxpbmcgPSB0aGlzLnMuZHQub1Njcm9sbC5zWCAhPT0gIiIgfHwgdGhpcy5zLmR0Lm9TY3JvbGwuc1kgIT09ICIiOwoKCQl2YXIgb3JpZ0NlbGwgPSB0aGlzLnMuZHQuYW9Db2x1bW5zWyB0aGlzLnMubW91c2UudGFyZ2V0SW5kZXggXS5uVGg7CgkJdmFyIG9yaWdUciA9IG9yaWdDZWxsLnBhcmVudE5vZGU7CgkJdmFyIG9yaWdUaGVhZCA9IG9yaWdUci5wYXJlbnROb2RlOwoJCXZhciBvcmlnVGFibGUgPSBvcmlnVGhlYWQucGFyZW50Tm9kZTsKCQl2YXIgY2xvbmVDZWxsID0gJChvcmlnQ2VsbCkuY2xvbmUoKTsKCgkJLy8gVGhpcyBpcyBhIHNsaWdodGx5IG9kZCBjb21iaW5hdGlvbiBvZiBqUXVlcnkgYW5kIERPTSwgYnV0IGl0IGlzIHRoZQoJCS8vIGZhc3Rlc3QgYW5kIGxlYXN0IHJlc291cmNlIGludGVuc2l2ZSB3YXkgSSBjb3VsZCB0aGluayBvZiBjbG9uaW5nCgkJLy8gdGhlIHRhYmxlIHdpdGgganVzdCBhIHNpbmdsZSBoZWFkZXIgY2VsbCBpbiBpdC4KCQl0aGlzLmRvbS5kcmFnID0gJChvcmlnVGFibGUuY2xvbmVOb2RlKGZhbHNlKSkKCQkJLmFkZENsYXNzKCAnRFRDUl9jbG9uZWRUYWJsZScgKQoJCQkuYXBwZW5kKAoJCQkJb3JpZ1RoZWFkLmNsb25lTm9kZShmYWxzZSkuYXBwZW5kQ2hpbGQoCgkJCQkJb3JpZ1RyLmNsb25lTm9kZShmYWxzZSkuYXBwZW5kQ2hpbGQoCgkJCQkJCWNsb25lQ2VsbFswXQoJCQkJCSkKCQkJCSkKCQkJKQoJCQkuY3NzKCB7CgkJCQlwb3NpdGlvbjogJ2Fic29sdXRlJywKCQkJCXRvcDogMCwKCQkJCWxlZnQ6IDAsCgkJCQl3aWR0aDogJChvcmlnQ2VsbCkub3V0ZXJXaWR0aCgpLAoJCQkJaGVpZ2h0OiAkKG9yaWdDZWxsKS5vdXRlckhlaWdodCgpCgkJCX0gKQoJCQkuYXBwZW5kVG8oICdib2R5JyApOwoKCQl0aGlzLmRvbS5wb2ludGVyID0gJCgnPGRpdj48L2Rpdj4nKQoJCQkuYWRkQ2xhc3MoICdEVENSX3BvaW50ZXInICkKCQkJLmNzcyggewoJCQkJcG9zaXRpb246ICdhYnNvbHV0ZScsCgkJCQl0b3A6IHNjcm9sbGluZyA\/CgkJCQkJJCgnZGl2LmRhdGFUYWJsZXNfc2Nyb2xsJywgdGhpcy5zLmR0Lm5UYWJsZVdyYXBwZXIpLm9mZnNldCgpLnRvcCA6CgkJCQkJJCh0aGlzLnMuZHQublRhYmxlKS5vZmZzZXQoKS50b3AsCgkJCQloZWlnaHQgOiBzY3JvbGxpbmcgPwoJCQkJCSQoJ2Rpdi5kYXRhVGFibGVzX3Njcm9sbCcsIHRoaXMucy5kdC5uVGFibGVXcmFwcGVyKS5oZWlnaHQoKSA6CgkJCQkJJCh0aGlzLnMuZHQublRhYmxlKS5oZWlnaHQoKQoJCQl9ICkKCQkJLmFwcGVuZFRvKCAnYm9keScgKTsKCX0sCgoJLyoqCgkgKiBDbGVhbiB1cCBDb2xSZW9yZGVyIG1lbW9yeSByZWZlcmVuY2VzIGFuZCBldmVudCBoYW5kbGVycwoJICogIEBtZXRob2QgIF9mbkRlc3Ryb3kKCSAqICBAcmV0dXJucyB2b2lkCgkgKiAgQHByaXZhdGUKCSAqLwoJIl9mbkRlc3Ryb3kiOiBmdW5jdGlvbiAoKQoJewoJCXZhciBpLCBpTGVuOwoKCQlmb3IgKCBpPTAsIGlMZW49dGhpcy5zLmR0LmFvRHJhd0NhbGxiYWNrLmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApCgkJewoJCQlpZiAoIHRoaXMucy5kdC5hb0RyYXdDYWxsYmFja1tpXS5zTmFtZSA9PT0gJ0NvbFJlb3JkZXJfUHJlJyApCgkJCXsKCQkJCXRoaXMucy5kdC5hb0RyYXdDYWxsYmFjay5zcGxpY2UoIGksIDEgKTsKCQkJCWJyZWFrOwoJCQl9CgkJfQoKCQkkKHRoaXMucy5kdC5uVEhlYWQpLmZpbmQoICcqJyApLm9mZiggJy5Db2xSZW9yZGVyJyApOwoKCQkkLmVhY2goIHRoaXMucy5kdC5hb0NvbHVtbnMsIGZ1bmN0aW9uIChpLCBjb2x1bW4pIHsKCQkJJChjb2x1bW4ublRoKS5yZW1vdmVBdHRyKCdkYXRhLWNvbHVtbi1pbmRleCcpOwoJCX0gKTsKCgkJdGhpcy5zLmR0Ll9jb2xSZW9yZGVyID0gbnVsbDsKCQl0aGlzLnMgPSBudWxsOwoJfSwKCgoJLyoqCgkgKiBBZGQgYSBkYXRhIGF0dHJpYnV0ZSB0byB0aGUgY29sdW1uIGhlYWRlcnMsIHNvIHdlIGtub3cgdGhlIGluZGV4IG9mCgkgKiB0aGUgcm93IHRvIGJlIHJlb3JkZXJlZC4gVGhpcyBhbGxvd3MgZmFzdCBkZXRlY3Rpb24gb2YgdGhlIGluZGV4LCBhbmQKCSAqIGZvciB0aGlzIHBsdWctaW4gdG8gd29yayB3aXRoIEZpeGVkSGVhZGVyIHdoaWNoIGNsb25lcyB0aGUgbm9kZXMuCgkgKiAgQHByaXZhdGUKCSAqLwoJIl9mblNldENvbHVtbkluZGV4ZXMiOiBmdW5jdGlvbiAoKQoJewoJCSQuZWFjaCggdGhpcy5zLmR0LmFvQ29sdW1ucywgZnVuY3Rpb24gKGksIGNvbHVtbikgewoJCQkkKGNvbHVtbi5uVGgpLmF0dHIoJ2RhdGEtY29sdW1uLWluZGV4JywgaSk7CgkJfSApOwoJfQp9OwoKCgoKCi8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKgogKiBTdGF0aWMgcGFyYW1ldGVycwogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICovCgoKLyoqCiAqIENvbFJlb3JkZXIgZGVmYXVsdCBzZXR0aW5ncyBmb3IgaW5pdGlhbGlzYXRpb24KICogIEBuYW1lc3BhY2UKICogIEBzdGF0aWMKICovCkNvbFJlb3JkZXIuZGVmYXVsdHMgPSB7CgkvKioKCSAqIFByZWRlZmluZWQgb3JkZXJpbmcgZm9yIHRoZSBjb2x1bW5zIHRoYXQgd2lsbCBiZSBhcHBsaWVkIGF1dG9tYXRpY2FsbHkKCSAqIG9uIGluaXRpYWxpc2F0aW9uLiBJZiBub3Qgc3BlY2lmaWVkIHRoZW4gdGhlIG9yZGVyIHRoYXQgdGhlIGNvbHVtbnMgYXJlCgkgKiBmb3VuZCB0byBiZSBpbiB0aGUgSFRNTCBpcyB0aGUgb3JkZXIgdXNlZC4KCSAqICBAdHlwZSBhcnJheQoJICogIEBkZWZhdWx0IG51bGwKCSAqICBAc3RhdGljCgkgKiAgQGV4YW1wbGUKCSAqICAgICAgLy8gVXNpbmcgdGhlIGBvQ29sUmVvcmRlcmAgb3B0aW9uIGluIHRoZSBEYXRhVGFibGVzIG9wdGlvbnMgb2JqZWN0CgkgKiAgICAgICQoJyNleGFtcGxlJykuZGF0YVRhYmxlKCB7CgkgKiAgICAgICAgICAic0RvbSI6ICdSbGZydGlwJywKCSAqICAgICAgICAgICJvQ29sUmVvcmRlciI6IHsKCSAqICAgICAgICAgICAgICAiYWlPcmRlciI6IFsgNCwgMywgMiwgMSwgMCBdCgkgKiAgICAgICAgICB9CgkgKiAgICAgIH0gKTsKCSAqCgkgKiAgQGV4YW1wbGUKCSAqICAgICAgLy8gVXNpbmcgYG5ld2AgY29uc3RydWN0b3IKCSAqICAgICAgJCgnI2V4YW1wbGUnKS5kYXRhVGFibGUoKQoJICoKCSAqICAgICAgbmV3ICQuZm4uZGF0YVRhYmxlLkNvbFJlb3JkZXIoICcjZXhhbXBsZScsIHsKCSAqICAgICAgICAgICJhaU9yZGVyIjogWyA0LCAzLCAyLCAxLCAwIF0KCSAqICAgICAgfSApOwoJICovCglhaU9yZGVyOiBudWxsLAoKCS8qKgoJICogUmVkcmF3IHRoZSB0YWJsZSdzIGNvbHVtbiBvcmRlcmluZyBhcyB0aGUgZW5kIHVzZXIgZHJhd3MgdGhlIGNvbHVtbgoJICogKGB0cnVlYCkgb3Igd2FpdCB1bnRpbCB0aGUgbW91c2UgaXMgcmVsZWFzZWQgKGBmYWxzZWAgLSBkZWZhdWx0KS4gTm90ZQoJICogdGhhdCB0aGlzIHdpbGwgcGVyZm9ybSBhIHJlZHJhdyBvbiBlYWNoIHJlb3JkZXJpbmcsIHdoaWNoIGludm9sdmVzIGFuCgkgKiBBamF4IHJlcXVlc3QgZWFjaCB0aW1lIGlmIHlvdSBhcmUgdXNpbmcgc2VydmVyLXNpZGUgcHJvY2Vzc2luZyBpbgoJICogRGF0YVRhYmxlcy4KCSAqICBAdHlwZSBib29sZWFuCgkgKiAgQGRlZmF1bHQgZmFsc2UKCSAqICBAc3RhdGljCgkgKiAgQGV4YW1wbGUKCSAqICAgICAgLy8gVXNpbmcgdGhlIGBvQ29sUmVvcmRlcmAgb3B0aW9uIGluIHRoZSBEYXRhVGFibGVzIG9wdGlvbnMgb2JqZWN0CgkgKiAgICAgICQoJyNleGFtcGxlJykuZGF0YVRhYmxlKCB7CgkgKiAgICAgICAgICAic0RvbSI6ICdSbGZydGlwJywKCSAqICAgICAgICAgICJvQ29sUmVvcmRlciI6IHsKCSAqICAgICAgICAgICAgICAiYlJlYWx0aW1lIjogdHJ1ZQoJICogICAgICAgICAgfQoJICogICAgICB9ICk7CgkgKgoJICogIEBleGFtcGxlCgkgKiAgICAgIC8vIFVzaW5nIGBuZXdgIGNvbnN0cnVjdG9yCgkgKiAgICAgICQoJyNleGFtcGxlJykuZGF0YVRhYmxlKCkKCSAqCgkgKiAgICAgIG5ldyAkLmZuLmRhdGFUYWJsZS5Db2xSZW9yZGVyKCAnI2V4YW1wbGUnLCB7CgkgKiAgICAgICAgICAiYlJlYWx0aW1lIjogdHJ1ZQoJICogICAgICB9ICk7CgkgKi8KCWJSZWFsdGltZTogZmFsc2UsCgoJLyoqCgkgKiBJbmRpY2F0ZSBob3cgbWFueSBjb2x1bW5zIHNob3VsZCBiZSBmaXhlZCBpbiBwb3NpdGlvbiAoY291bnRpbmcgZnJvbSB0aGUKCSAqIGxlZnQpLiBUaGlzIHdpbGwgdHlwaWNhbGx5IGJlIDEgaWYgdXNlZCwgYnV0IGNhbiBiZSBhcyBoaWdoIGFzIHlvdSBsaWtlLgoJICogIEB0eXBlIGludAoJICogIEBkZWZhdWx0IDAKCSAqICBAc3RhdGljCgkgKiAgQGV4YW1wbGUKCSAqICAgICAgLy8gVXNpbmcgdGhlIGBvQ29sUmVvcmRlcmAgb3B0aW9uIGluIHRoZSBEYXRhVGFibGVzIG9wdGlvbnMgb2JqZWN0CgkgKiAgICAgICQoJyNleGFtcGxlJykuZGF0YVRhYmxlKCB7CgkgKiAgICAgICAgICAic0RvbSI6ICdSbGZydGlwJywKCSAqICAgICAgICAgICJvQ29sUmVvcmRlciI6IHsKCSAqICAgICAgICAgICAgICAiaUZpeGVkQ29sdW1ucyI6IDEKCSAqICAgICAgICAgIH0KCSAqICAgICAgfSApOwoJICoKCSAqICBAZXhhbXBsZQoJICogICAgICAvLyBVc2luZyBgbmV3YCBjb25zdHJ1Y3RvcgoJICogICAgICAkKCcjZXhhbXBsZScpLmRhdGFUYWJsZSgpCgkgKgoJICogICAgICBuZXcgJC5mbi5kYXRhVGFibGUuQ29sUmVvcmRlciggJyNleGFtcGxlJywgewoJICogICAgICAgICAgImlGaXhlZENvbHVtbnMiOiAxCgkgKiAgICAgIH0gKTsKCSAqLwoJaUZpeGVkQ29sdW1uczogMCwKCgkvKioKCSAqIEFzIGBpRml4ZWRDb2x1bW5zUmlnaHRgIGJ1dCBjb3VudGluZyBmcm9tIHRoZSByaWdodC4KCSAqICBAdHlwZSBpbnQKCSAqICBAZGVmYXVsdCAwCgkgKiAgQHN0YXRpYwoJICogIEBleGFtcGxlCgkgKiAgICAgIC8vIFVzaW5nIHRoZSBgb0NvbFJlb3JkZXJgIG9wdGlvbiBpbiB0aGUgRGF0YVRhYmxlcyBvcHRpb25zIG9iamVjdAoJICogICAgICAkKCcjZXhhbXBsZScpLmRhdGFUYWJsZSggewoJICogICAgICAgICAgInNEb20iOiAnUmxmcnRpcCcsCgkgKiAgICAgICAgICAib0NvbFJlb3JkZXIiOiB7CgkgKiAgICAgICAgICAgICAgImlGaXhlZENvbHVtbnNSaWdodCI6IDEKCSAqICAgICAgICAgIH0KCSAqICAgICAgfSApOwoJICoKCSAqICBAZXhhbXBsZQoJICogICAgICAvLyBVc2luZyBgbmV3YCBjb25zdHJ1Y3RvcgoJICogICAgICAkKCcjZXhhbXBsZScpLmRhdGFUYWJsZSgpCgkgKgoJICogICAgICBuZXcgJC5mbi5kYXRhVGFibGUuQ29sUmVvcmRlciggJyNleGFtcGxlJywgewoJICogICAgICAgICAgImlGaXhlZENvbHVtbnNSaWdodCI6IDEKCSAqICAgICAgfSApOwoJICovCglpRml4ZWRDb2x1bW5zUmlnaHQ6IDAsCgoJLyoqCgkgKiBDYWxsYmFjayBmdW5jdGlvbiB0aGF0IGlzIGZpcmVkIHdoZW4gY29sdW1ucyBhcmUgcmVvcmRlcmVkCgkgKiAgQHR5cGUgZnVuY3Rpb24oKTp2b2lkCgkgKiAgQGRlZmF1bHQgbnVsbAoJICogIEBzdGF0aWMKCSAqICBAZXhhbXBsZQoJICogICAgICAvLyBVc2luZyB0aGUgYG9Db2xSZW9yZGVyYCBvcHRpb24gaW4gdGhlIERhdGFUYWJsZXMgb3B0aW9ucyBvYmplY3QKCSAqICAgICAgJCgnI2V4YW1wbGUnKS5kYXRhVGFibGUoIHsKCSAqICAgICAgICAgICJzRG9tIjogJ1JsZnJ0aXAnLAoJICogICAgICAgICAgIm9Db2xSZW9yZGVyIjogewoJICogICAgICAgICAgICAgICJmblJlb3JkZXJDYWxsYmFjayI6IGZ1bmN0aW9uICgpIHsKCSAqICAgICAgICAgICAgICAgICAgYWxlcnQoICdDb2x1bW5zIHJlb3JkZXJlZCcgKTsKCSAqICAgICAgICAgICAgICB9CgkgKiAgICAgICAgICB9CgkgKiAgICAgIH0gKTsKCSAqCgkgKiAgQGV4YW1wbGUKCSAqICAgICAgLy8gVXNpbmcgYG5ld2AgY29uc3RydWN0b3IKCSAqICAgICAgJCgnI2V4YW1wbGUnKS5kYXRhVGFibGUoKQoJICoKCSAqICAgICAgbmV3ICQuZm4uZGF0YVRhYmxlLkNvbFJlb3JkZXIoICcjZXhhbXBsZScsIHsKCSAqICAgICAgICAgICJmblJlb3JkZXJDYWxsYmFjayI6IGZ1bmN0aW9uICgpIHsKCSAqICAgICAgICAgICAgICBhbGVydCggJ0NvbHVtbnMgcmVvcmRlcmVkJyApOwoJICogICAgICAgICAgfQoJICogICAgICB9ICk7CgkgKi8KCWZuUmVvcmRlckNhbGxiYWNrOiBudWxsCn07CgoKCi8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKgogKiBDb25zdGFudHMKICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqLwoKLyoqCiAqIENvbFJlb3JkZXIgdmVyc2lvbgogKiAgQGNvbnN0YW50ICB2ZXJzaW9uCiAqICBAdHlwZSAgICAgIFN0cmluZwogKiAgQGRlZmF1bHQgICBBcyBjb2RlCiAqLwpDb2xSZW9yZGVyLnZlcnNpb24gPSAiMS4xLjIiOwoKCgovKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoKICogRGF0YVRhYmxlcyBpbnRlcmZhY2VzCiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKi8KCi8vIEV4cG9zZQokLmZuLmRhdGFUYWJsZS5Db2xSZW9yZGVyID0gQ29sUmVvcmRlcjsKJC5mbi5EYXRhVGFibGUuQ29sUmVvcmRlciA9IENvbFJlb3JkZXI7CgoKLy8gUmVnaXN0ZXIgYSBuZXcgZmVhdHVyZSB3aXRoIERhdGFUYWJsZXMKaWYgKCB0eXBlb2YgJC5mbi5kYXRhVGFibGUgPT0gImZ1bmN0aW9uIiAmJgogICAgIHR5cGVvZiAkLmZuLmRhdGFUYWJsZUV4dC5mblZlcnNpb25DaGVjayA9PSAiZnVuY3Rpb24iICYmCiAgICAgJC5mbi5kYXRhVGFibGVFeHQuZm5WZXJzaW9uQ2hlY2soJzEuOS4zJykgKQp7CgkkLmZuLmRhdGFUYWJsZUV4dC5hb0ZlYXR1cmVzLnB1c2goIHsKCQkiZm5Jbml0IjogZnVuY3Rpb24oIHNldHRpbmdzICkgewoJCQl2YXIgdGFibGUgPSBzZXR0aW5ncy5vSW5zdGFuY2U7CgoJCQlpZiAoICEgc2V0dGluZ3MuX2NvbFJlb3JkZXIgKSB7CgkJCQl2YXIgZHRJbml0ID0gc2V0dGluZ3Mub0luaXQ7CgkJCQl2YXIgb3B0cyA9IGR0SW5pdC5jb2xSZW9yZGVyIHx8IGR0SW5pdC5vQ29sUmVvcmRlciB8fCB7fTsKCgkJCQluZXcgQ29sUmVvcmRlciggc2V0dGluZ3MsIG9wdHMgKTsKCQkJfQoJCQllbHNlIHsKCQkJCXRhYmxlLm9BcGkuX2ZuTG9nKCBzZXR0aW5ncywgMSwgIkNvbFJlb3JkZXIgYXR0ZW1wdGVkIHRvIGluaXRpYWxpc2UgdHdpY2UuIElnbm9yaW5nIHNlY29uZCIgKTsKCQkJfQoKCQkJcmV0dXJuIG51bGw7IC8qIE5vIG5vZGUgZm9yIERhdGFUYWJsZXMgdG8gaW5zZXJ0ICovCgkJfSwKCQkiY0ZlYXR1cmUiOiAiUiIsCgkJInNGZWF0dXJlIjogIkNvbFJlb3JkZXIiCgl9ICk7Cn0KZWxzZSB7CglhbGVydCggIldhcm5pbmc6IENvbFJlb3JkZXIgcmVxdWlyZXMgRGF0YVRhYmxlcyAxLjkuMyBvciBncmVhdGVyIC0gd3d3LmRhdGF0YWJsZXMubmV0L2Rvd25sb2FkIik7Cn0KCgovLyBBUEkgYXVnbWVudGF0aW9uCmlmICggJC5mbi5kYXRhVGFibGUuQXBpICkgewoJJC5mbi5kYXRhVGFibGUuQXBpLnJlZ2lzdGVyKCAnY29sUmVvcmRlci5yZXNldCgpJywgZnVuY3Rpb24gKCkgewoJCXJldHVybiB0aGlzLml0ZXJhdG9yKCAndGFibGUnLCBmdW5jdGlvbiAoIGN0eCApIHsKCQkJY3R4Ll9jb2xSZW9yZGVyLmZuUmVzZXQoKTsKCQl9ICk7Cgl9ICk7CgoJJC5mbi5kYXRhVGFibGUuQXBpLnJlZ2lzdGVyKCAnY29sUmVvcmRlci5vcmRlcigpJywgZnVuY3Rpb24gKCBzZXQgKSB7CgkJaWYgKCBzZXQgKSB7CgkJCXJldHVybiB0aGlzLml0ZXJhdG9yKCAndGFibGUnLCBmdW5jdGlvbiAoIGN0eCApIHsKCQkJCWN0eC5fY29sUmVvcmRlci5mbk9yZGVyKCBzZXQgKTsKCQkJfSApOwoJCX0KCgkJcmV0dXJuIHRoaXMuY29udGV4dC5sZW5ndGggPwoJCQl0aGlzLmNvbnRleHRbMF0uX2NvbFJlb3JkZXIuZm5PcmRlcigpIDoKCQkJbnVsbDsKCX0gKTsKfQoKcmV0dXJuIENvbFJlb3JkZXI7Cn07IC8vIC9mYWN0b3J5CgoKLy8gRGVmaW5lIGFzIGFuIEFNRCBtb2R1bGUgaWYgcG9zc2libGUKaWYgKCB0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgKSB7CglkZWZpbmUoIFsnanF1ZXJ5JywgJ2RhdGF0YWJsZXMnXSwgZmFjdG9yeSApOwp9CmVsc2UgaWYgKCB0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgKSB7CiAgICAvLyBOb2RlL0NvbW1vbkpTCiAgICBmYWN0b3J5KCByZXF1aXJlKCdqcXVlcnknKSwgcmVxdWlyZSgnZGF0YXRhYmxlcycpICk7Cn0KZWxzZSBpZiAoIGpRdWVyeSAmJiAhalF1ZXJ5LmZuLmRhdGFUYWJsZS5Db2xSZW9yZGVyICkgewoJLy8gT3RoZXJ3aXNlIHNpbXBseSBpbml0aWFsaXNlIGFzIG5vcm1hbCwgc3RvcHBpbmcgbXVsdGlwbGUgZXZhbHVhdGlvbgoJZmFjdG9yeSggalF1ZXJ5LCBqUXVlcnkuZm4uZGF0YVRhYmxlICk7Cn0KCgp9KSh3aW5kb3csIGRvY3VtZW50KTsK",
    "size": "36465"
}