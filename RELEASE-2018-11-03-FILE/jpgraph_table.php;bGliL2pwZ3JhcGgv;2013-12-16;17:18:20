{
    "namaFile": "lib\/jpgraph\/jpgraph_table.php",
    "lastUpdate": "2013-12-16+17:18:20.00",
    "contentFile": "PD9waHAKLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogLy8gRmlsZTogICAgICAgIEpQR1JBUEhfVEFCTEUuUEhQCiAvLyBEZXNjcmlwdGlvbjogQ2xhc3NlcyB0byBjcmVhdGUgYmFzaWMgdGFibGVzIG9mIGRhdGEKIC8vIENyZWF0ZWQ6ICAgICAyMDA2LTAxLTI1CiAvLyBWZXI6ICAgICAgICAgJElkOiBqcGdyYXBoX3RhYmxlLnBocCAxNTE0IDIwMDktMDctMDcgMTE6MTU6NThaIGxqcCAkCiAvLwogLy8gQ29weXJpZ2h0IChjKSBBc2lhbCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAqLwoKLy8gU3R5bGUgb2YgZ3JpZCBsaW5lcyBpbiB0YWJsZQpERUZJTkUoJ1RHUklEX1NJTkdMRScsMSk7CkRFRklORSgnVEdSSURfRE9VQkxFJywyKTsKREVGSU5FKCdUR1JJRF9ET1VCTEUyJywzKTsKCi8vIFR5cGUgb2YgY29uc3RyYWluIGZvciBpbWFnZSBjb25zdHJhaW4KREVGSU5FKCdUSU1HX1dJRFRIJywxKTsKREVGSU5FKCdUSU1HX0hFSUdIVCcsMik7CgovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyBDTEFTUyBHVGV4dFRhYmxlQ2VsbAovLyBEZXNjcmlwdGlvbjoKLy8gSW50ZXJuYWwgY2xhc3MgdGhhdCByZXByZXNlbnRzIGVhY2ggY2VsbCBpbiB0aGUgdGFibGUKLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KY2xhc3MgR1RleHRUYWJsZUNlbGwgewogICAgcHVibGljICRpQ29sU3Bhbj0xLCRpUm93U3Bhbj0xOwogICAgcHVibGljICRpTWFyZ2luTGVmdD01LCRpTWFyZ2luUmlnaHQ9NSwkaU1hcmdpblRvcD01LCRpTWFyZ2luQm90dG9tPTU7CiAgICBwdWJsaWMgJGlWYWw9TlVMTDsKICAgIHByaXZhdGUgJGlCR0NvbG9yPScnLCAkaUZvbnRDb2xvcj0nYmxhY2snOwogICAgcHJpdmF0ZSAkaUZGPUZGX0ZPTlQxLCRpRlM9RlNfTk9STUFMLCRpRlNpemU9MTA7CiAgICBwcml2YXRlICRpUm93PTAsICRpQ29sPTA7CiAgICBwcml2YXRlICRpVmVydEFsaWduID0gJ2JvdHRvbScsICRpSG9yQWxpZ24gPSAnbGVmdCc7CiAgICBwcml2YXRlICRpTWVyZ2VkPUZBTFNFLCRpUFJvdz1OVUxMLCRpUENvbD1OVUxMOwogICAgcHJpdmF0ZSAkaVRhYmxlPU5VTEw7CiAgICBwcml2YXRlICRpR3JpZENvbG9yPWFycmF5KCdkYXJrZ3JheScsJ2RhcmtncmF5JywnZGFya2dyYXknLCdkYXJrZ3JheScpOwogICAgcHJpdmF0ZSAkaUdyaWRXZWlnaHQ9YXJyYXkoMSwxLDAsMCk7IC8vIGxlZnQsdG9wLGJvdHRvbSxyaWdodDsKICAgIHByaXZhdGUgJGlHcmlkU3R5bGU9YXJyYXkoVEdSSURfU0lOR0xFLFRHUklEX1NJTkdMRSxUR1JJRF9TSU5HTEUsVEdSSURfU0lOR0xFKTsgLy8gbGVmdCx0b3AsYm90dG9tLHJpZ2h0OwogICAgcHJpdmF0ZSAkaU51bWJlckZvcm1hdD1udWxsOwogICAgcHJpdmF0ZSAkaUljb249bnVsbCwgJGlJY29uQ29uc3RyYWluPWFycmF5KCk7CiAgICBwcml2YXRlICRpQ1NJTXRhcmdldCA9ICcnLCRpQ1NJTXdpbnRhcmdldCA9ICcnLCAkaUNTSU1hbHQgPSAnJywgJGlDU0lNQXJlYSA9ICcnOwoKICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRhVmFsPScnLCRhUm93PTAsJGFDb2w9MCkgewogICAgICAgICR0aGlzLT5pVmFsID0gbmV3IFRleHQoJGFWYWwpOwogICAgICAgICR0aGlzLT5pUm93ID0gJGFSb3c7CiAgICAgICAgJHRoaXMtPmlDb2wgPSAkYUNvbDsKICAgICAgICAkdGhpcy0+aVBSb3cgPSAkYVJvdzsgLy8gSW5pdGlhbGl5IGVhY2ggY2VsbCBpcyBpdHMgb3duIHBhcmVudAogICAgICAgICR0aGlzLT5pUENvbCA9ICRhQ29sOwogICAgICAgICR0aGlzLT5pSWNvbkNvbnN0cmFpbiA9IGFycmF5KC0xLC0xKTsKICAgIH0KCiAgICBmdW5jdGlvbiBJbml0KCRhVGFibGUpIHsKICAgICAgICAkdGhpcy0+aVRhYmxlID0gJGFUYWJsZTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRDU0lNVGFyZ2V0KCRhVGFyZ2V0LCRhQWx0PScnLCRhV2luVGFyZ2V0PScnKSB7CiAgICAgICAgJHRoaXMtPmlDU0lNdGFyZ2V0ID0gJGFUYXJnZXQ7CiAgICAgICAgJHRoaXMtPmlDU0lNd2ludGFyZ2V0ID0gJGFXaW5UYXJnZXQ7CiAgICAgICAgJHRoaXMtPmlDU0lNYWx0ID0gJGFBbHQ7CiAgICB9CgogICAgZnVuY3Rpb24gR2V0Q1NJTUFyZWEoKSB7CiAgICAgICAgaWYoICR0aGlzLT5pQ1NJTXRhcmdldCAhPT0gJycgKQogICAgICAgIHJldHVybiAkdGhpcy0+aUNTSU1BcmVhOwogICAgICAgIGVsc2UKICAgICAgICByZXR1cm4gJyc7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0SW1hZ2VDb25zdHJhaW4oJGFUeXBlLCRhVmFsKSB7CiAgICAgICAgaWYoICFpbl9hcnJheSgkYVR5cGUsYXJyYXkoVElNR19XSURUSCwgVElNR19IRUlHSFQpKSApIHsKICAgICAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoMjcwMTUpOwogICAgICAgIH0KICAgICAgICAkdGhpcy0+aUljb25Db25zdHJhaW4gPSBhcnJheSgkYVR5cGUsJGFWYWwpOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldENvdW50cnlGbGFnKCRhRmxhZywkYVNjYWxlPTEuMCwkYU1peD0xMDAsJGFTdGRTaXplPTMpIHsKICAgICAgICAkdGhpcy0+aUljb24gPSBuZXcgSWNvblBsb3QoKTsKICAgICAgICAkdGhpcy0+aUljb24tPlNldENvdW50cnlGbGFnKCRhRmxhZywwLDAsJGFTY2FsZSwkYU1peCwkYVN0ZFNpemUpOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldEltYWdlKCRhRmlsZSwkYVNjYWxlPTEuMCwkYU1peD0xMDApIHsKICAgICAgICAkdGhpcy0+aUljb24gPSBuZXcgSWNvblBsb3QoJGFGaWxlLDAsMCwkYVNjYWxlLCRhTWl4KTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRJbWFnZUZyb21TdHJpbmcoJGFTdHIsJGFTY2FsZT0xLjAsJGFNaXg9MTAwKSB7CiAgICAgICAgJHRoaXMtPmlJY29uID0gbmV3IEljb25QbG90KCIiLDAsMCwkYVNjYWxlLCRhTWl4KTsKICAgICAgICAkdGhpcy0+aUljb24tPkNyZWF0ZUZyb21TdHJpbmcoJGFTdHIpOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldFJvd0NvbFNwYW4oJGFSb3dTcGFuLCRhQ29sU3BhbikgewogICAgICAgICR0aGlzLT5pUm93U3BhbiA9ICRhUm93U3BhbjsKICAgICAgICAkdGhpcy0+aUNvbFNwYW4gPSAkYUNvbFNwYW47CiAgICAgICAgJHRoaXMtPmlNZXJnZWQgPSB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldE1lcmdlZCgkYVBSb3csJGFQQ29sLCRhRmxnPXRydWUpIHsKICAgICAgICAkdGhpcy0+aU1lcmdlZCA9ICRhRmxnOwogICAgICAgICR0aGlzLT5pUFJvdz0kYVBSb3c7CiAgICAgICAgJHRoaXMtPmlQQ29sPSRhUENvbDsKICAgIH0KCiAgICBmdW5jdGlvbiBJc01lcmdlZCgpIHsKICAgICAgICByZXR1cm4gJHRoaXMtPmlNZXJnZWQ7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0TnVtYmVyRm9ybWF0KCRhRikgewogICAgICAgICR0aGlzLT5pTnVtYmVyRm9ybWF0ID0gJGFGOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldCgkYVR4dCkgewogICAgICAgICR0aGlzLT5pVmFsLT5TZXQoJGFUeHQpOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldEZvbnQoJGFGRiwkYUZTLCRhRlNpemUpIHsKICAgICAgICAkdGhpcy0+aUZGID0gJGFGRjsKICAgICAgICAkdGhpcy0+aUZTID0gJGFGUzsKICAgICAgICAkdGhpcy0+aUZTaXplID0gJGFGU2l6ZTsKICAgICAgICAkdGhpcy0+aVZhbC0+U2V0Rm9udCgkYUZGLCRhRlMsJGFGU2l6ZSk7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0RmlsbENvbG9yKCRhQ29sb3IpIHsKICAgICAgICAkdGhpcy0+aUJHQ29sb3I9JGFDb2xvcjsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRGb250Q29sb3IoJGFDb2xvcikgewogICAgICAgICR0aGlzLT5pRm9udENvbG9yPSRhQ29sb3I7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0R3JpZENvbG9yKCRhTGVmdCwkYVRvcD1udWxsLCRhQm90dG9tPW51bGwsJGFSaWdodD1udWxsKSB7CiAgICAgICAgaWYoICRhTGVmdCAhPT0gbnVsbCApICR0aGlzLT5pR3JpZENvbG9yWzBdID0gJGFMZWZ0OwogICAgICAgIGlmKCAkYVRvcCAhPT0gbnVsbCApICR0aGlzLT5pR3JpZENvbG9yWzFdID0gJGFUb3A7CiAgICAgICAgaWYoICRhQm90dG9tICE9PSBudWxsICkgJHRoaXMtPmlHcmlkQ29sb3JbMl0gPSAkYUJvdHRvbTsKICAgICAgICBpZiggJGFSaWdodCAhPT0gbnVsbCApJHRoaXMtPmlHcmlkQ29sb3JbM10gPSAkYVJpZ2h0OwogICAgfQoKICAgIGZ1bmN0aW9uIFNldEdyaWRTdHlsZSgkYUxlZnQsJGFUb3A9bnVsbCwkYUJvdHRvbT1udWxsLCRhUmlnaHQ9bnVsbCkgewogICAgICAgIGlmKCAkYUxlZnQgIT09IG51bGwgKSAkdGhpcy0+aUdyaWRTdHlsZVswXSA9ICRhTGVmdDsKICAgICAgICBpZiggJGFUb3AgIT09IG51bGwgKSAkdGhpcy0+aUdyaWRTdHlsZVsxXSA9ICRhVG9wOwogICAgICAgIGlmKCAkYUJvdHRvbSAhPT0gbnVsbCApICR0aGlzLT5pR3JpZFN0eWxlWzJdID0gJGFCb3R0b207CiAgICAgICAgaWYoICRhUmlnaHQgIT09IG51bGwgKSR0aGlzLT5pR3JpZFN0eWxlWzNdID0gJGFSaWdodDsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRHcmlkV2VpZ2h0KCRhTGVmdD1udWxsLCRhVG9wPW51bGwsJGFCb3R0b209bnVsbCwkYVJpZ2h0PW51bGwpIHsKICAgICAgICBpZiggJGFMZWZ0ICE9PSBudWxsICkgJHRoaXMtPmlHcmlkV2VpZ2h0WzBdID0gJGFMZWZ0OwogICAgICAgIGlmKCAkYVRvcCAhPT0gbnVsbCApICR0aGlzLT5pR3JpZFdlaWdodFsxXSA9ICRhVG9wOwogICAgICAgIGlmKCAkYUJvdHRvbSAhPT0gbnVsbCApICR0aGlzLT5pR3JpZFdlaWdodFsyXSA9ICRhQm90dG9tOwogICAgICAgIGlmKCAkYVJpZ2h0ICE9PSBudWxsICkgJHRoaXMtPmlHcmlkV2VpZ2h0WzNdID0gJGFSaWdodDsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRNYXJnaW4oJGFMZWZ0LCRhUmlnaHQsJGFUb3AsJGFCb3R0b20pIHsKICAgICAgICAkdGhpcy0+aU1hcmdpbkxlZnQ9JGFMZWZ0OwogICAgICAgICR0aGlzLT5pTWFyZ2luUmlnaHQ9JGFSaWdodDsKICAgICAgICAkdGhpcy0+aU1hcmdpblRvcD0kYVRvcDsKICAgICAgICAkdGhpcy0+aU1hcmdpbkJvdHRvbT0kYUJvdHRvbTsKICAgIH0KCiAgICBmdW5jdGlvbiBHZXRXaWR0aCgkYUltZykgewogICAgICAgIGlmKCAkdGhpcy0+aUljb24gIT09IG51bGwgKSB7CiAgICAgICAgICAgIGlmKCAkdGhpcy0+aUljb25Db25zdHJhaW5bMF0gPT0gVElNR19XSURUSCApIHsKICAgICAgICAgICAgCSR0aGlzLT5pSWNvbi0+U2V0U2NhbGUoMSk7CiAgICAgICAgICAgIAkkdG1wID0gJHRoaXMtPmlJY29uLT5HZXRXaWR0aEhlaWdodCgpOwogICAgICAgICAgICAgICAgJHRoaXMtPmlJY29uLT5TZXRTY2FsZSgkdGhpcy0+aUljb25Db25zdHJhaW5bMV0vJHRtcFswXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZWlmKCAkdGhpcy0+aUljb25Db25zdHJhaW5bMF0gPT0gVElNR19IRUlHSFQgKSB7CiAgICAgICAgICAgIAkkdGhpcy0+aUljb24tPlNldFNjYWxlKDEpOwogICAgICAgICAgICAJJHRtcCA9ICR0aGlzLT5pSWNvbi0+R2V0V2lkdGhIZWlnaHQoKTsKICAgICAgICAgICAgICAgICR0aGlzLT5pSWNvbi0+U2V0U2NhbGUoJHRoaXMtPmlJY29uQ29uc3RyYWluWzFdLyR0bXBbMV0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgICR0bXAgPSAkdGhpcy0+aUljb24tPkdldFdpZHRoSGVpZ2h0KCk7CiAgICAgICAgICAgICRpd2lkdGggPSAkdG1wWzBdOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJGl3aWR0aD0wOwogICAgICAgIH0KICAgICAgICBpZiggJHRoaXMtPmlUYWJsZS0+aUNlbGxzWyR0aGlzLT5pUFJvd11bJHRoaXMtPmlQQ29sXS0+aVZhbC0+ZGlyID09IDAgKSB7CiAgICAgICAgICAgICRwd2lkdGggPSAkdGhpcy0+aVRhYmxlLT5pQ2VsbHNbJHRoaXMtPmlQUm93XVskdGhpcy0+aVBDb2xdLT5pVmFsLT5HZXRXaWR0aCgkYUltZyk7CiAgICAgICAgfQogICAgICAgIGVsc2VpZiggJHRoaXMtPmlUYWJsZS0+aUNlbGxzWyR0aGlzLT5pUFJvd11bJHRoaXMtPmlQQ29sXS0+aVZhbC0+ZGlyID09IDkwICkgewogICAgICAgICAgICAkcHdpZHRoID0gJHRoaXMtPmlUYWJsZS0+aUNlbGxzWyR0aGlzLT5pUFJvd11bJHRoaXMtPmlQQ29sXS0+aVZhbC0+R2V0Rm9udEhlaWdodCgkYUltZykrMjsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICRwd2lkdGggPSAkdGhpcy0+aVRhYmxlLT5pQ2VsbHNbJHRoaXMtPmlQUm93XVskdGhpcy0+aVBDb2xdLT5pVmFsLT5HZXRXaWR0aCgkYUltZykrMjsKICAgICAgICB9CgogICAgICAgICRwY29sc3BhbiA9ICR0aGlzLT5pVGFibGUtPmlDZWxsc1skdGhpcy0+aVBSb3ddWyR0aGlzLT5pUENvbF0tPmlDb2xTcGFuOwogICAgICAgIHJldHVybiByb3VuZChtYXgoJGl3aWR0aCwkcHdpZHRoKS8kcGNvbHNwYW4pICsgJHRoaXMtPmlNYXJnaW5MZWZ0ICsgJHRoaXMtPmlNYXJnaW5SaWdodDsKICAgIH0KCiAgICBmdW5jdGlvbiBHZXRIZWlnaHQoJGFJbWcpIHsKICAgICAgICBpZiggJHRoaXMtPmlJY29uICE9PSBudWxsICkgewogICAgICAgICAgICBpZiggJHRoaXMtPmlJY29uQ29uc3RyYWluWzBdID09IFRJTUdfV0lEVEggKSB7CiAgICAgICAgICAgIAkkdGhpcy0+aUljb24tPlNldFNjYWxlKDEpOwogICAgICAgICAgICAJJHRtcCA9ICR0aGlzLT5pSWNvbi0+R2V0V2lkdGhIZWlnaHQoKTsKICAgICAgICAgICAgCSR0aGlzLT5pSWNvbi0+U2V0U2NhbGUoJHRoaXMtPmlJY29uQ29uc3RyYWluWzFdLyR0bXBbMF0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2VpZiggJHRoaXMtPmlJY29uQ29uc3RyYWluWzBdID09IFRJTUdfSEVJR0hUICkgewogICAgICAgICAgICAJJHRoaXMtPmlJY29uLT5TZXRTY2FsZSgxKTsKICAgICAgICAgICAgCSR0bXAgPSAkdGhpcy0+aUljb24tPkdldFdpZHRoSGVpZ2h0KCk7CiAgICAgICAgICAgICAgICAkdGhpcy0+aUljb24tPlNldFNjYWxlKCR0aGlzLT5pSWNvbkNvbnN0cmFpblsxXS8kdG1wWzFdKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAkdG1wID0gJHRoaXMtPmlJY29uLT5HZXRXaWR0aEhlaWdodCgpOwogICAgICAgICAgICAkaWhlaWdodCA9ICAkdG1wWzFdOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJGloZWlnaHQgPSAwOwogICAgICAgIH0KICAgICAgICBpZiggJHRoaXMtPmlUYWJsZS0+aUNlbGxzWyR0aGlzLT5pUFJvd11bJHRoaXMtPmlQQ29sXS0+aVZhbC0+ZGlyID09IDAgKSB7CiAgICAgICAgICAgICRwaGVpZ2h0ID0gJHRoaXMtPmlUYWJsZS0+aUNlbGxzWyR0aGlzLT5pUFJvd11bJHRoaXMtPmlQQ29sXS0+aVZhbC0+R2V0SGVpZ2h0KCRhSW1nKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICRwaGVpZ2h0ID0gJHRoaXMtPmlUYWJsZS0+aUNlbGxzWyR0aGlzLT5pUFJvd11bJHRoaXMtPmlQQ29sXS0+aVZhbC0+R2V0SGVpZ2h0KCRhSW1nKSsxOwogICAgICAgIH0KICAgICAgICAkcHJvd3NwYW4gPSAkdGhpcy0+aVRhYmxlLT5pQ2VsbHNbJHRoaXMtPmlQUm93XVskdGhpcy0+aVBDb2xdLT5pUm93U3BhbjsKICAgICAgICByZXR1cm4gcm91bmQobWF4KCRpaGVpZ2h0LCRwaGVpZ2h0KS8kcHJvd3NwYW4pICsgJHRoaXMtPmlNYXJnaW5Ub3AgKyAkdGhpcy0+aU1hcmdpbkJvdHRvbTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRBbGlnbigkYUhvckFsaWduPSdsZWZ0JywkYVZlcnRBbGlnbj0nYm90dG9tJykgewogICAgICAgICRhSG9yQWxpZ24gPSBzdHJ0b2xvd2VyKCRhSG9yQWxpZ24pOwogICAgICAgICRhVmVydEFsaWduID0gc3RydG9sb3dlcigkYVZlcnRBbGlnbik7CiAgICAgICAgJGNoayA9IGFycmF5KCdsZWZ0JywncmlnaHQnLCdjZW50ZXInLCdib3R0b20nLCd0b3AnLCdtaWRkbGUnKTsKICAgICAgICBpZiggIWluX2FycmF5KCRhSG9yQWxpZ24sJGNoaykgfHwgIWluX2FycmF5KCRhVmVydEFsaWduLCRjaGspICkgewogICAgICAgICAgICBKcEdyYXBoRXJyb3I6OlJhaXNlTCgyNzAxMSwkYUhvckFsaWduLCRhVmVydEFsaWduKTsKICAgICAgICB9CiAgICAgICAgJHRoaXMtPmlWZXJ0QWxpZ24gPSAkYVZlcnRBbGlnbjsKICAgICAgICAkdGhpcy0+aUhvckFsaWduID0gJGFIb3JBbGlnbjsKICAgIH0KCiAgICBmdW5jdGlvbiBBZGp1c3RNYXJnaW5zRm9yR3JpZCgpIHsKICAgICAgICBpZiggJHRoaXMtPmlDb2wgPiAwICkgewogICAgICAgICAgICBzd2l0Y2goICR0aGlzLT5pR3JpZFN0eWxlWzBdICkgewogICAgICAgICAgICAgICAgY2FzZSBUR1JJRF9TSU5HTEU6ICAkd2Y9MTsgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBUR1JJRF9ET1VCTEU6ICAkd2Y9MzsgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBUR1JJRF9ET1VCTEUyOiAkd2Y9NDsgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgICR0aGlzLT5pTWFyZ2luTGVmdCArPSAkdGhpcy0+aUdyaWRXZWlnaHRbMF0qJHdmOwogICAgICAgIH0KICAgICAgICBpZiggJHRoaXMtPmlSb3cgPiAwICkgewogICAgICAgICAgICBzd2l0Y2goICR0aGlzLT5pR3JpZFN0eWxlWzFdICkgewogICAgICAgICAgICAgICAgY2FzZSBUR1JJRF9TSU5HTEU6ICAkd2Y9MTsgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBUR1JJRF9ET1VCTEU6ICAkd2Y9MzsgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBUR1JJRF9ET1VCTEUyOiAkd2Y9NDsgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgICR0aGlzLT5pTWFyZ2luVG9wICs9ICR0aGlzLT5pR3JpZFdlaWdodFsxXSokd2Y7CiAgICAgICAgfQogICAgICAgIGlmKCAkdGhpcy0+aVJvdyskdGhpcy0+aVJvd1NwYW4tMSA8ICR0aGlzLT5pVGFibGUtPmlTaXplWzBdLTEgKSB7CiAgICAgICAgICAgIHN3aXRjaCggJHRoaXMtPmlHcmlkU3R5bGVbMl0gKSB7CiAgICAgICAgICAgICAgICBjYXNlIFRHUklEX1NJTkdMRTogJHdmPTE7IGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBUR1JJRF9ET1VCTEU6ICR3Zj0zOyBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgVEdSSURfRE9VQkxFMjogJHdmPTQ7IGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgICR0aGlzLT5pTWFyZ2luQm90dG9tICs9ICR0aGlzLT5pR3JpZFdlaWdodFsyXSokd2Y7CiAgICAgICAgfQogICAgICAgIGlmKCAkdGhpcy0+aUNvbCskdGhpcy0+aUNvbFNwYW4tMSA8ICR0aGlzLT5pVGFibGUtPmlTaXplWzFdLTEgKSB7CiAgICAgICAgICAgIHN3aXRjaCggJHRoaXMtPmlHcmlkU3R5bGVbM10gKSB7CiAgICAgICAgICAgICAgICBjYXNlIFRHUklEX1NJTkdMRTogJHdmPTE7IGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSBUR1JJRF9ET1VCTEU6ICR3Zj0zOyBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgVEdSSURfRE9VQkxFMjogJHdmPTQ7IGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICAgICR0aGlzLT5pTWFyZ2luUmlnaHQgKz0gJHRoaXMtPmlHcmlkV2VpZ2h0WzNdKiR3ZjsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gU3Ryb2tlVkdyaWQoJGFJbWcsJGFYLCRhWSwkYVdpZHRoLCRhSGVpZ2h0LCRhRGlyPTEpIHsKICAgICAgICAvLyBMZWZ0IG9yIHJpZ2h0IGdyaWQgbGluZQogICAgICAgIC8vIEZvciB0aGUgcmlnaHQgd2UgaW5jcmVhc2UgdGhlIFgtcG9zIGFuZCBmb3IgdGhlIHJpZ2h0IHdlIGRlY3JlYXNlIGl0LiBUaGlzIGlzCiAgICAgICAgLy8gZGV0ZXJtaW5lZCBieSB0aGUgZGlyZWN0aW9uIGFyZ3VtZW50LgogICAgICAgICRpZHggPSAkYURpcj09MSA\/IDAgOiAzOwoKICAgICAgICAvLyBXZSBkb24ndCBzdHJva2UgdGhlIGdyaWQgbGluZXMgdGhhdCBhcmUgb24gdGhlIGVkZ2Ugb2YgdGhlIHRhYmxlIHNpbmNlIHRoaXMgaXMKICAgICAgICAvLyB0aGUgcGxhY2Ugb2YgdGhlIGJvcmRlci4KICAgICAgICBpZiggKCAoJHRoaXMtPmlDb2wgPiAwICYmICRpZHg9PTApIHx8ICgkdGhpcy0+aUNvbCskdGhpcy0+aUNvbFNwYW4tMSA8ICR0aGlzLT5pVGFibGUtPmlTaXplWzFdLTEgJiYgJGlkeD09MykgKQogICAgICAgICYmICR0aGlzLT5pR3JpZFdlaWdodFskaWR4XSA+IDAgKSB7CiAgICAgICAgICAgICR4ID0gJGFEaXI9PTEgPyAkYVggOiAkYVggKyAkYVdpZHRoLTE7CiAgICAgICAgICAgICR5ID0gJGFZKyRhSGVpZ2h0LTE7CiAgICAgICAgICAgICRhSW1nLT5TZXRDb2xvcigkdGhpcy0+aUdyaWRDb2xvclskaWR4XSk7CiAgICAgICAgICAgIHN3aXRjaCggJHRoaXMtPmlHcmlkU3R5bGVbJGlkeF0gKSB7CiAgICAgICAgICAgICAgICBjYXNlIFRHUklEX1NJTkdMRToKICAgICAgICAgICAgICAgICAgICBmb3IoICRpPTA7ICRpIDwgJHRoaXMtPmlHcmlkV2VpZ2h0WyRpZHhdOyArKyRpICkKICAgICAgICAgICAgICAgICAgICAkYUltZy0+TGluZSgkeCskaSokYURpciwkYVksICR4KyRpKiRhRGlyLCR5KTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICBjYXNlIFRHUklEX0RPVUJMRToKICAgICAgICAgICAgICAgICAgICBmb3IoICRpPTA7ICRpIDwgJHRoaXMtPmlHcmlkV2VpZ2h0WyRpZHhdOyArKyRpICkKICAgICAgICAgICAgICAgICAgICAkYUltZy0+TGluZSgkeCskaSokYURpciwkYVksICR4KyRpKiRhRGlyLCR5KTsKICAgICAgICAgICAgICAgICAgICAkeCArPSAkdGhpcy0+aUdyaWRXZWlnaHRbJGlkeF0qMjsKICAgICAgICAgICAgICAgICAgICBmb3IoICRpPTA7ICRpIDwgJHRoaXMtPmlHcmlkV2VpZ2h0WyRpZHhdOyArKyRpICkKICAgICAgICAgICAgICAgICAgICAkYUltZy0+TGluZSgkeCskaSokYURpciwkYVksICR4KyRpKiRhRGlyLCR5KTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICBjYXNlIFRHUklEX0RPVUJMRTI6CiAgICAgICAgICAgICAgICAgICAgZm9yKCAkaT0wOyAkaSA8ICR0aGlzLT5pR3JpZFdlaWdodFskaWR4XSoyOyArKyRpICkKICAgICAgICAgICAgICAgICAgICAkYUltZy0+TGluZSgkeCskaSokYURpciwkYVksJHgrJGkqJGFEaXIsJHkpOwogICAgICAgICAgICAgICAgICAgICR4ICs9ICR0aGlzLT5pR3JpZFdlaWdodFskaWR4XSozOwogICAgICAgICAgICAgICAgICAgIGZvciggJGk9MDsgJGkgPCAkdGhpcy0+aUdyaWRXZWlnaHRbJGlkeF07ICsrJGkgKQogICAgICAgICAgICAgICAgICAgICRhSW1nLT5MaW5lKCR4KyRpKiRhRGlyLCRhWSwgJHgrJGkqJGFEaXIsJHkpOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIFN0cm9rZUhHcmlkKCRhSW1nLCRhWCwkYVksJGFXaWR0aCwkYUhlaWdodCwkYURpcj0xKSB7CiAgICAgICAgLy8gVG9wIG9yIGJvdHRvbSBncmlkIGxpbmUKICAgICAgICAvLyBGb3IgdGhlIGxlZnQgd2UgaW5jcmVhc2UgdGhlIFgtcG9zIGFuZCBmb3IgdGhlIHJpZ2h0IHdlIGRlY3JlYXNlIGl0LiBUaGlzIGlzCiAgICAgICAgLy8gZGV0ZXJtaW5lZCBieSB0aGUgZGlyZWN0aW9uIGFyZ3VtZW50LgogICAgICAgICRpZHggPSAkYURpcj09MSA\/IDEgOiAyOwoKICAgICAgICAvLyBXZSBkb24ndCBzdHJva2UgdGhlIGdyaWQgbGluZXMgdGhhdCBhcmUgb24gdGhlIGVkZ2Ugb2YgdGhlIHRhYmxlIHNpbmNlIHRoaXMgaXMKICAgICAgICAvLyB0aGUgcGxhY2Ugb2YgdGhlIGJvcmRlci4KICAgICAgICBpZiggKCAoJHRoaXMtPmlSb3cgPiAwICYmICRpZHg9PTEpIHx8ICgkdGhpcy0+aVJvdyskdGhpcy0+aVJvd1NwYW4tMSA8ICR0aGlzLT5pVGFibGUtPmlTaXplWzBdLTEgJiYgJGlkeD09MikgKQogICAgICAgICYmICR0aGlzLT5pR3JpZFdlaWdodFskaWR4XSA+IDApIHsKICAgICAgICAgICAgJHkgPSAkYURpcj09MSA\/ICRhWSA6ICRhWSskYUhlaWdodC0xOwogICAgICAgICAgICAkeCA9ICRhWCskYVdpZHRoLTE7CiAgICAgICAgICAgICRhSW1nLT5TZXRDb2xvcigkdGhpcy0+aUdyaWRDb2xvclskaWR4XSk7CiAgICAgICAgICAgIHN3aXRjaCggJHRoaXMtPmlHcmlkU3R5bGVbJGlkeF0gKSB7CiAgICAgICAgICAgICAgICBjYXNlIFRHUklEX1NJTkdMRToKICAgICAgICAgICAgICAgICAgICBmb3IoICRpPTA7ICRpIDwgJHRoaXMtPmlHcmlkV2VpZ2h0WyRpZHhdOyArKyRpICkKICAgICAgICAgICAgICAgICAgICAkYUltZy0+TGluZSgkYVgsJHkrJGksICR4LCR5KyRpKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICBjYXNlIFRHUklEX0RPVUJMRToKICAgICAgICAgICAgICAgICAgICBmb3IoICRpPTA7ICRpIDwgJHRoaXMtPmlHcmlkV2VpZ2h0WyRpZHhdOyArKyRpICkKICAgICAgICAgICAgICAgICAgICAkYUltZy0+TGluZSgkYVgsJHkrJGksICR4LCR5KyRpKTsKICAgICAgICAgICAgICAgICAgICAkeSArPSAkdGhpcy0+aUdyaWRXZWlnaHRbJGlkeF0qMjsKICAgICAgICAgICAgICAgICAgICBmb3IoICRpPTA7ICRpIDwgJHRoaXMtPmlHcmlkV2VpZ2h0WyRpZHhdOyArKyRpICkKICAgICAgICAgICAgICAgICAgICAkYUltZy0+TGluZSgkYVgsJHkrJGksICR4LCR5KyRpKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICBjYXNlIFRHUklEX0RPVUJMRTI6CiAgICAgICAgICAgICAgICAgICAgZm9yKCAkaT0wOyAkaSA8ICR0aGlzLT5pR3JpZFdlaWdodFskaWR4XSoyOyArKyRpICkKICAgICAgICAgICAgICAgICAgICAkYUltZy0+TGluZSgkYVgsJHkrJGksICR4LCR5KyRpKTsKICAgICAgICAgICAgICAgICAgICAkeSArPSAkdGhpcy0+aUdyaWRXZWlnaHRbJGlkeF0qMzsKICAgICAgICAgICAgICAgICAgICBmb3IoICRpPTA7ICRpIDwgJHRoaXMtPmlHcmlkV2VpZ2h0WyRpZHhdOyArKyRpICkKICAgICAgICAgICAgICAgICAgICAkYUltZy0+TGluZSgkYVgsJHkrJGksICR4LCR5KyRpKTsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBTdHJva2UoJGFJbWcsJGFYLCRhWSwkYVdpZHRoLCRhSGVpZ2h0KSB7CiAgICAgICAgLy8gSWYgdGhpcyBpcyBhIG1lcmdlZCBjZWxsIHdlIG9ubHkgc3Ryb2tlIGlmIGl0IGlzIHRoZSBwYXJlbnQgY2VsbC4KICAgICAgICAvLyBUaGUgcGFyZW50IGNlbGwgaG9sZHMgdGhlIG1lcmdlZCBjZWxsIGJsb2NrCiAgICAgICAgaWYoICR0aGlzLT5pTWVyZ2VkICYmICgkdGhpcy0+aVJvdyAhPSAkdGhpcy0+aVBSb3cgfHwgJHRoaXMtPmlDb2wgIT0gJHRoaXMtPmlQQ29sKSApIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYoICR0aGlzLT5pQkdDb2xvciAhPSAnJyApIHsKICAgICAgICAgICAgJGFJbWctPlNldENvbG9yKCR0aGlzLT5pQkdDb2xvcik7CiAgICAgICAgICAgICRhSW1nLT5GaWxsZWRSZWN0YW5nbGUoJGFYLCRhWSwkYVgrJGFXaWR0aC0xLCRhWSskYUhlaWdodC0xKTsKICAgICAgICB9CgogICAgICAgICRjb29yZHMgPSAkYVguJywnLiRhWS4nLCcuKCRhWCskYVdpZHRoLTEpLicsJy4kYVkuJywnLigkYVgrJGFXaWR0aC0xKS4nLCcuKCRhWSskYUhlaWdodC0xKS4nLCcuJGFYLicsJy4oJGFZKyRhSGVpZ2h0LTEpOwogICAgICAgIGlmKCAhIGVtcHR5KCR0aGlzLT5pQ1NJTXRhcmdldCkgKSB7CiAgICAgICAgICAgICR0aGlzLT5pQ1NJTUFyZWEgPSAnPGFyZWEgc2hhcGU9InBvbHkiIGNvb3Jkcz0iJy4kY29vcmRzLiciIGhyZWY9IicuJHRoaXMtPmlDU0lNdGFyZ2V0LiciJzsKICAgICAgICAgICAgaWYoICEgZW1wdHkoJHRoaXMtPmlDU0lNd2ludGFyZ2V0KSApIHsKICAgICAgICAgICAgICAgICR0aGlzLT5pQ1NJTUFyZWEgLj0gIiB0YXJnZXQ9XCIiLiR0aGlzLT5pQ1NJTXdpbnRhcmdldC4iXCIiOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKCAhIGVtcHR5KCR0aGlzLT5pQ1NJTWFsdCkgKSB7CiAgICAgICAgICAgICAgICAkdGhpcy0+aUNTSU1BcmVhIC49ICcgYWx0PSInLiR0aGlzLT5pQ1NJTWFsdC4nIiB0aXRsZT0iJy4kdGhpcy0+aUNTSU1hbHQuIlwiICI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJHRoaXMtPmlDU0lNQXJlYSAuPSAiIC8+XG4iOwogICAgICAgIH0KCiAgICAgICAgJHRoaXMtPlN0cm9rZVZHcmlkKCRhSW1nLCRhWCwkYVksJGFXaWR0aCwkYUhlaWdodCk7CiAgICAgICAgJHRoaXMtPlN0cm9rZVZHcmlkKCRhSW1nLCRhWCwkYVksJGFXaWR0aCwkYUhlaWdodCwtMSk7CiAgICAgICAgJHRoaXMtPlN0cm9rZUhHcmlkKCRhSW1nLCRhWCwkYVksJGFXaWR0aCwkYUhlaWdodCk7CiAgICAgICAgJHRoaXMtPlN0cm9rZUhHcmlkKCRhSW1nLCRhWCwkYVksJGFXaWR0aCwkYUhlaWdodCwtMSk7CgogICAgICAgIGlmKCAkdGhpcy0+aUljb24gIT09IG51bGwgKSB7CiAgICAgICAgICAgIHN3aXRjaCggJHRoaXMtPmlIb3JBbGlnbiApIHsKICAgICAgICAgICAgICAgIGNhc2UgJ2xlZnQnOgogICAgICAgICAgICAgICAgICAgICR4ID0gJGFYKyR0aGlzLT5pTWFyZ2luTGVmdDsKICAgICAgICAgICAgICAgICAgICAkaGFuY2hvcj0nbGVmdCc7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlICdjZW50ZXInOgogICAgICAgICAgICAgICAgY2FzZSAnbWlkZGxlJzoKICAgICAgICAgICAgICAgICAgICAkeCA9ICRhWCskdGhpcy0+aU1hcmdpbkxlZnQrcm91bmQoKCRhV2lkdGgtJHRoaXMtPmlNYXJnaW5MZWZ0LSR0aGlzLT5pTWFyZ2luUmlnaHQpLzIpOwogICAgICAgICAgICAgICAgICAgICRoYW5jaG9yPSdjZW50ZXInOwogICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgY2FzZSAncmlnaHQnOgogICAgICAgICAgICAgICAgICAgICR4ID0gJGFYKyRhV2lkdGgtJHRoaXMtPmlNYXJnaW5SaWdodC0xOwogICAgICAgICAgICAgICAgICAgICRoYW5jaG9yPSdyaWdodCc7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDI3MDEyLCR0aGlzLT5pSG9yQWxpZ24pOwogICAgICAgICAgICB9CgogICAgICAgICAgICBzd2l0Y2goICR0aGlzLT5pVmVydEFsaWduICkgewogICAgICAgICAgICAgICAgY2FzZSAndG9wJzoKICAgICAgICAgICAgICAgICAgICAkeSA9ICRhWSskdGhpcy0+aU1hcmdpblRvcDsKICAgICAgICAgICAgICAgICAgICAkdmFuY2hvcj0ndG9wJzsKICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIGNhc2UgJ2NlbnRlcic6CiAgICAgICAgICAgICAgICBjYXNlICdtaWRkbGUnOgogICAgICAgICAgICAgICAgICAgICR5ID0gJGFZKyR0aGlzLT5pTWFyZ2luVG9wK3JvdW5kKCgkYUhlaWdodC0kdGhpcy0+aU1hcmdpblRvcC0kdGhpcy0+aU1hcmdpbkJvdHRvbSkvMik7CiAgICAgICAgICAgICAgICAgICAgJHZhbmNob3I9J2NlbnRlcic7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBjYXNlICdib3R0b20nOgogICAgICAgICAgICAgICAgICAgICR5ID0gJGFZKyRhSGVpZ2h0LTEtJHRoaXMtPmlNYXJnaW5Cb3R0b207CiAgICAgICAgICAgICAgICAgICAgJHZhbmNob3I9J2JvdHRvbSc7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDI3MDEyLCR0aGlzLT5pVmVydEFsaWduKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAkdGhpcy0+aUljb24tPlNldEFuY2hvcigkaGFuY2hvciwkdmFuY2hvcik7CiAgICAgICAgICAgICR0aGlzLT5pSWNvbi0+X1N0cm9rZSgkYUltZywkeCwkeSk7CiAgICAgICAgfQogICAgICAgICR0aGlzLT5pVmFsLT5TZXRDb2xvcigkdGhpcy0+aUZvbnRDb2xvcik7CiAgICAgICAgJHRoaXMtPmlWYWwtPlNldEZvbnQoJHRoaXMtPmlGRiwkdGhpcy0+aUZTLCR0aGlzLT5pRlNpemUpOwogICAgICAgIHN3aXRjaCggJHRoaXMtPmlIb3JBbGlnbiApIHsKICAgICAgICAgICAgY2FzZSAnbGVmdCc6CiAgICAgICAgICAgICAgICAkeCA9ICRhWCskdGhpcy0+aU1hcmdpbkxlZnQ7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnY2VudGVyJzoKICAgICAgICAgICAgY2FzZSAnbWlkZGxlJzoKICAgICAgICAgICAgICAgICR4ID0gJGFYKyR0aGlzLT5pTWFyZ2luTGVmdCtyb3VuZCgoJGFXaWR0aC0kdGhpcy0+aU1hcmdpbkxlZnQtJHRoaXMtPmlNYXJnaW5SaWdodCkvMik7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAncmlnaHQnOgogICAgICAgICAgICAgICAgJHggPSAkYVgrJGFXaWR0aC0kdGhpcy0+aU1hcmdpblJpZ2h0LTE7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDI3MDEyLCR0aGlzLT5pSG9yQWxpZ24pOwogICAgICAgIH0KICAgICAgICAvLyBBIHdvcmthcm91bmQgZm9yIHRoZSBzaG9ydGNvbWluZ3MgaW4gdGhlIFRURiBmb250IGhhbmRsaW5nIGluIEdECiAgICAgICAgLy8gVGhlIGFuY2hvciBwb3NpdGlvbiBmb3Igcm90YXRlZCB0ZXh0ICg9OTApIGlzIHRvICJzaG9ydCIgc28gd2UgYWRkCiAgICAgICAgLy8gYW4gb2Zmc2V0IGJhc2VkIG9uIHRoZSBhY3R1YWwgZm9udCBzaXplCiAgICAgICAgaWYoICR0aGlzLT5pVmFsLT5kaXIgIT0gMCAmJiAkdGhpcy0+aVZhbC0+Zm9udF9mYW1pbHkgPj0gMTAgKSB7CiAgICAgICAgICAgICRhWSArPSA0ICsgcm91bmQoJHRoaXMtPmlWYWwtPmZvbnRfc2l6ZSowLjgpOwogICAgICAgIH0KICAgICAgICBzd2l0Y2goICR0aGlzLT5pVmVydEFsaWduICkgewogICAgICAgICAgICBjYXNlICd0b3AnOgogICAgICAgICAgICAgICAgJHkgPSAkYVkrJHRoaXMtPmlNYXJnaW5Ub3A7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnY2VudGVyJzoKICAgICAgICAgICAgY2FzZSAnbWlkZGxlJzoKICAgICAgICAgICAgICAgICR5ID0gJGFZKyR0aGlzLT5pTWFyZ2luVG9wK3JvdW5kKCgkYUhlaWdodC0kdGhpcy0+aU1hcmdpblRvcC0kdGhpcy0+aU1hcmdpbkJvdHRvbSkvMik7CiAgICAgICAgICAgICAgICAvLyR5IC09IHJvdW5kKCR0aGlzLT5pVmFsLT5HZXRGb250SGVpZ2h0KCRhSW1nKS8yKTsKICAgICAgICAgICAgICAgICR5IC09IHJvdW5kKCR0aGlzLT5pVmFsLT5HZXRIZWlnaHQoJGFJbWcpLzIpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ2JvdHRvbSc6CiAgICAgICAgICAgICAgICAvLyR5ID0gJGFZKyRhSGVpZ2h0LTEtJHRoaXMtPmlNYXJnaW5Cb3R0b20tJHRoaXMtPmlWYWwtPkdldEZvbnRIZWlnaHQoJGFJbWcpOwogICAgICAgICAgICAgICAgJHkgPSAkYVkrJGFIZWlnaHQtJHRoaXMtPmlNYXJnaW5Cb3R0b20tJHRoaXMtPmlWYWwtPkdldEhlaWdodCgkYUltZyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDI3MDEyLCR0aGlzLT5pVmVydEFsaWduKTsKICAgICAgICB9CiAgICAgICAgJHRoaXMtPmlWYWwtPlNldEFsaWduKCR0aGlzLT5pSG9yQWxpZ24sJ3RvcCcpOwogICAgICAgIGlmKCAkdGhpcy0+aU51bWJlckZvcm1hdCAhPT0gbnVsbCAmJiBpc19udW1lcmljKCR0aGlzLT5pVmFsLT50KSApIHsKICAgICAgICAgICAgJHRoaXMtPmlWYWwtPnQgPSBzcHJpbnRmKCR0aGlzLT5pTnVtYmVyRm9ybWF0LCR0aGlzLT5pVmFsLT50KTsKICAgICAgICB9CiAgICAgICAgJHRoaXMtPmlWYWwtPlN0cm9rZSgkYUltZywkeCwkeSk7CiAgICB9Cn0KCi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIENMQVNTIEdUZXh0VGFibGUKLy8gRGVzY3JpcHRpb246Ci8vIEdyYXBoaWMgdGV4dCB0YWJsZQovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQpjbGFzcyBHVGV4dFRhYmxlIHsKICAgIHB1YmxpYyAkaUNlbGxzID0gYXJyYXkoKSwgJGlTaXplPWFycmF5KDAsMCk7IC8vIE5lZWQgdG8gYmUgcHVibGljIHNpbmNlIHRoZXkgYXJlIHVzZWQgYnkgdGhlIGNlbGwKICAgIHByaXZhdGUgJGlXaWR0aD0wLCAkaUhlaWdodD0wOwogICAgcHJpdmF0ZSAkaUNvbFdpZHRoPU5VTEwsJGlSb3dIZWlnaHQ9TlVMTDsKICAgIHByaXZhdGUgJGlJbWc9TlVMTDsKICAgIHByaXZhdGUgJGlYUG9zPTAsICRpWVBvcz0wOwogICAgcHJpdmF0ZSAkaVNjYWxlWFBvcz1udWxsLCRpU2NhbGVZUG9zPW51bGw7CiAgICBwcml2YXRlICRpQkdDb2xvcj0nJzsKICAgIHByaXZhdGUgJGlCb3JkZXJDb2xvcj0nYmxhY2snLCRpQm9yZGVyV2VpZ2h0PTE7CiAgICBwcml2YXRlICRpSW5pdD1mYWxzZTsKICAgIHByaXZhdGUgJGlZQW5jaG9yPSd0b3AnLCRpWEFuY2hvcj0nbGVmdCc7CiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgKiBGaXJzdCBhbmQgc2Vjb25kIHBoYXNlIGNvbnN0cnVjdG9ycwogICAgICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICovCiAgICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgpIHsKICAgICAgICAvLyBFbXB0eQogICAgfQoKICAgIGZ1bmN0aW9uIEluaXQoJGFSb3dzPTAsJGFDb2xzPTAsJGFGaWxsVGV4dD0nJykgewogICAgICAgICR0aGlzLT5pU2l6ZVswXSA9ICRhUm93czsKICAgICAgICAkdGhpcy0+aVNpemVbMV0gPSAkYUNvbHM7CiAgICAgICAgZm9yKCRpPTA7ICRpIDwgJHRoaXMtPmlTaXplWzBdOyArKyRpKSB7CiAgICAgICAgICAgIGZvcigkaj0wOyAkaiA8ICR0aGlzLT5pU2l6ZVsxXTsgKyskaikgewogICAgICAgICAgICAgICAgJHRoaXMtPmlDZWxsc1skaV1bJGpdID0gbmV3IEdUZXh0VGFibGVDZWxsKCRhRmlsbFRleHQsJGksJGopOwogICAgICAgICAgICAgICAgJHRoaXMtPmlDZWxsc1skaV1bJGpdLT5Jbml0KCR0aGlzKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAkdGhpcy0+aUluaXQ9dHJ1ZTsKICAgIH0KCiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgKiBPdXRlciBib3JkZXIgb2YgdGFibGUKICAgICAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAqLwogICAgZnVuY3Rpb24gU2V0Qm9yZGVyKCRhV2VpZ2h0PTEsJGFDb2xvcj0nYmxhY2snKSB7CiAgICAgICAgJHRoaXMtPmlCb3JkZXJDb2xvcj0kYUNvbG9yOwogICAgICAgICR0aGlzLT5pQm9yZGVyV2VpZ2h0ID0gJGFXZWlnaHQ7CiAgICB9CgoKICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAqIFBvc2l0aW9uIGluIGdyYXBoIG9mIHRhYmxlCiAgICAgKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgKi8KICAgIGZ1bmN0aW9uIFNldFBvcygkYVgsJGFZKSB7CiAgICAgICAgJHRoaXMtPmlYUG9zID0gJGFYOwogICAgICAgICR0aGlzLT5pWVBvcyA9ICRhWTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRTY2FsZVBvcygkYVgsJGFZKSB7CiAgICAgICAgJHRoaXMtPmlTY2FsZVhQb3MgPSAkYVg7CiAgICAgICAgJHRoaXMtPmlTY2FsZVlQb3MgPSAkYVk7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0QW5jaG9yUG9zKCRhWEFuY2hvciwkYVlBbmNob3I9J3RvcCcpIHsKICAgICAgICAkdGhpcy0+aVhBbmNob3IgPSAkYVhBbmNob3I7CiAgICAgICAgJHRoaXMtPmlZQW5jaG9yID0gJGFZQW5jaG9yOwogICAgfQoKICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAqIFNldHVwIGNvdW50cnkgZmxhZyBpbiBhIGNlbGwKICAgICAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAqLwogICAgZnVuY3Rpb24gU2V0Q2VsbENvdW50cnlGbGFnKCRhUm93LCRhQ29sLCRhRmxhZywkYVNjYWxlPTEuMCwkYU1peD0xMDAsJGFTdGRTaXplPTMpIHsKICAgICAgICAkdGhpcy0+X2Noa1IoJGFSb3cpOwogICAgICAgICR0aGlzLT5fY2hrQygkYUNvbCk7CiAgICAgICAgJHRoaXMtPmlDZWxsc1skYVJvd11bJGFDb2xdLT5TZXRDb3VudHJ5RmxhZygkYUZsYWcsJGFTY2FsZSwkYU1peCwkYVN0ZFNpemUpOwoKICAgIH0KCiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgKiBTZXR1cCBpbWFnZSBpbiBhIGNlbGwKICAgICAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAqLwogICAgZnVuY3Rpb24gU2V0Q2VsbEltYWdlKCRhUm93LCRhQ29sLCRhRmlsZSwkYVNjYWxlPTEuMCwkYU1peD0xMDApIHsKICAgICAgICAkdGhpcy0+X2Noa1IoJGFSb3cpOwogICAgICAgICR0aGlzLT5fY2hrQygkYUNvbCk7CiAgICAgICAgJHRoaXMtPmlDZWxsc1skYVJvd11bJGFDb2xdLT5TZXRJbWFnZSgkYUZpbGUsJGFTY2FsZSwkYU1peCk7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0Um93SW1hZ2UoJGFSb3csJGFGaWxlLCRhU2NhbGU9MS4wLCRhTWl4PTEwMCkgewogICAgICAgICR0aGlzLT5fY2hrUigkYVJvdyk7CiAgICAgICAgZm9yKCRqPTA7ICRqIDwgJHRoaXMtPmlTaXplWzFdOyArKyRqKSB7CiAgICAgICAgICAgICR0aGlzLT5pQ2VsbHNbJGFSb3ddWyRqXS0+U2V0SW1hZ2UoJGFGaWxlLCRhU2NhbGUsJGFNaXgpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBTZXRDb2xJbWFnZSgkYUNvbCwkYUZpbGUsJGFTY2FsZT0xLjAsJGFNaXg9MTAwKSB7CiAgICAgICAgJHRoaXMtPl9jaGtDKCRhQ29sKTsKICAgICAgICBmb3IoJGo9MDsgJGogPCAkdGhpcy0+aVNpemVbMF07ICsrJGopIHsKICAgICAgICAgICAgJHRoaXMtPmlDZWxsc1skal1bJGFDb2xdLT5TZXRJbWFnZSgkYUZpbGUsJGFTY2FsZSwkYU1peCk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIFNldEltYWdlKCRhRmlsZVIxLCRhU2NhbGVDMT1udWxsLCRhTWl4UjI9bnVsbCwkYUMyPW51bGwsJGFGaWxlPW51bGwsJGFTY2FsZT0xLjAsJGFNaXg9MTAwKSB7CiAgICAgICAgaWYoICRhU2NhbGVDMSAhPT0gbnVsbCAmJiAkYU1peFIyIT09bnVsbCAmJiAkYUMyIT09bnVsbCAmJiAkYUZpbGUhPT1udWxsICkgewogICAgICAgICAgICAkdGhpcy0+X2Noa1IoJGFBcmdSMSk7ICAkdGhpcy0+X2Noa0MoJGFDMSk7CiAgICAgICAgICAgICR0aGlzLT5fY2hrUigkYVIyKTsgICR0aGlzLT5fY2hrQygkYUMyKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGlmKCAkYVNjYWxlQzEgIT09IG51bGwgKSAkYVNjYWxlID0gJGFTY2FsZUMxOwogICAgICAgICAgICBpZiggJGFNaXhSMiAhPT0gbnVsbCApICRhTWl4ID0gJGFNaXhSMjsKICAgICAgICAgICAgJGFGaWxlID0gJGFGaWxlUjE7CiAgICAgICAgICAgICRhTWl4UjIgPSAkdGhpcy0+aVNpemVbMF0tMTsgJGFGaWxlUjEgPSAwOwogICAgICAgICAgICAkYUMyID0gJHRoaXMtPmlTaXplWzFdLTE7ICRhU2NhbGVDMSA9IDA7CiAgICAgICAgfQogICAgICAgIGZvcigkaT0kYUFyZ1IxOyAkaSA8PSAkYVIyOyArKyRpKSB7CiAgICAgICAgICAgIGZvcigkaj0kYUMxOyAkaiA8PSAkYUMyOyArKyRqKSB7CiAgICAgICAgICAgICAgICAkdGhpcy0+aUNlbGxzWyRpXVskal0tPlNldEltYWdlKCRhRmlsZSwkYVNjYWxlLCRhTWl4KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBTZXRDZWxsSW1hZ2VDb25zdHJhaW4oJGFSb3csJGFDb2wsJGFUeXBlLCRhVmFsKSB7CiAgICAgICAgJHRoaXMtPl9jaGtSKCRhUm93KTsKICAgICAgICAkdGhpcy0+X2Noa0MoJGFDb2wpOwogICAgICAgICR0aGlzLT5pQ2VsbHNbJGFSb3ddWyRhQ29sXS0+U2V0SW1hZ2VDb25zdHJhaW4oJGFUeXBlLCRhVmFsKTsKICAgIH0KCiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgKiBHZW5lcmF0ZSBhIEhUTUwgdmVyc2lvbiBvZiB0aGUgdGFibGUKICAgICAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAqLwogICAgZnVuY3Rpb24gdG9TdHJpbmcoKSB7CiAgICAgICAgJHQgPSAnPHRhYmxlIGJvcmRlcj0xIGNlbGxzcGFjaW5nPTAgY2VsbHBhZGRpbmc9MD4nOwogICAgICAgIGZvcigkaT0wOyAkaSA8ICR0aGlzLT5pU2l6ZVswXTsgKyskaSkgewogICAgICAgICAgICAkdCAuPSAnPHRyPic7CiAgICAgICAgICAgIGZvcigkaj0wOyAkaiA8ICR0aGlzLT5pU2l6ZVsxXTsgKyskaikgewogICAgICAgICAgICAgICAgJHQgLj0gJzx0ZD4nOwogICAgICAgICAgICAgICAgaWYoICR0aGlzLT5pQ2VsbHNbJGldWyRqXS0+aU1lcmdlZCApCiAgICAgICAgICAgICAgICAkdCAuPSAnTSAnOwogICAgICAgICAgICAgICAgJHQgLj0gJ3ZhbD0nLiR0aGlzLT5pQ2VsbHNbJGldWyRqXS0+aVZhbC0+dDsKICAgICAgICAgICAgICAgICR0IC49ICcgKGNzPScuJHRoaXMtPmlDZWxsc1skaV1bJGpdLT5pQ29sU3Bhbi4KICAgICAgICAnLCBycz0nLiR0aGlzLT5pQ2VsbHNbJGldWyRqXS0+aVJvd1NwYW4uJyknOwogICAgICAgICAgICAgICAgJHQgLj0gJzwvdGQ+JzsKICAgICAgICAgICAgfQogICAgICAgICAgICAkdCAuPSAnPC90cj4nOwogICAgICAgIH0KICAgICAgICAkdCAuPSAnPC90YWJsZT4nOwogICAgICAgIHJldHVybiAkdDsKICAgIH0KCiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgKiBTcGVjaWZ5IGRhdGEgZm9yIHRhYmxlCiAgICAgKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgKi8KICAgIGZ1bmN0aW9uIFNldCgkYUFyZzEsJGFBcmcyPU5VTEwsJGFBcmczPU5VTEwpIHsKICAgICAgICBpZiggJGFBcmcyPT09TlVMTCAmJiAkYUFyZzM9PT1OVUxMICkgewogICAgICAgICAgICBpZiggaXNfYXJyYXkoJGFBcmcxKSApIHsKICAgICAgICAgICAgICAgIGlmKCBpc19hcnJheSgkYUFyZzFbMF0pICkgewogICAgICAgICAgICAgICAgICAgICRtID0gY291bnQoJGFBcmcxKTsKICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIHRoZSBsb25nZXN0IHJvdwogICAgICAgICAgICAgICAgICAgICRuPTA7CiAgICAgICAgICAgICAgICAgICAgZm9yKCRpPTA7ICRpIDwgJG07ICsrJGkpCiAgICAgICAgICAgICAgICAgICAgJG4gPSBtYXgoY291bnQoJGFBcmcxWyRpXSksJG4pOwogICAgICAgICAgICAgICAgICAgIGZvcigkaT0wOyAkaSA8ICRtOyArKyRpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcigkaj0wOyAkaiA8ICRuOyArKyRqKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiggaXNzZXQoJGFBcmcxWyRpXVskal0pICl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPl9zZXRjZWxsKCRpLCRqLChzdHJpbmcpJGFBcmcxWyRpXVskal0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPl9zZXRjZWxsKCRpLCRqKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAkdGhpcy0+aVNpemVbMF0gPSAkbTsKICAgICAgICAgICAgICAgICAgICAkdGhpcy0+aVNpemVbMV0gPSAkbjsKICAgICAgICAgICAgICAgICAgICAkdGhpcy0+aUluaXQ9dHJ1ZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDI3MDAxKTsKICAgICAgICAgICAgICAgICAgICAvLygnSWxsZWdhbCBhcmd1bWVudCB0byBHVGV4dFRhYmxlOjpTZXQoKS4gQXJyYXkgbXVzdCBiZSAyIGRpbWVuc2lvbmFsJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBKcEdyYXBoRXJyb3I6OlJhaXNlTCgyNzAwMik7CiAgICAgICAgICAgICAgICAvLygnSWxsZWdhbCBhcmd1bWVudCB0byBHVGV4dFRhYmxlOjpTZXQoKScpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAvLyBNdXN0IGJlIGluIHRoZSBmb3JtIChyb3csY29sLHZhbCkKICAgICAgICAgICAgJHRoaXMtPl9jaGtSKCRhQXJnMSk7CiAgICAgICAgICAgICR0aGlzLT5fY2hrQygkYUFyZzIpOwogICAgICAgICAgICAkdGhpcy0+X3NldGNlbGwoJGFBcmcxLCRhQXJnMiwoc3RyaW5nKSRhQXJnMyk7CiAgICAgICAgfQogICAgfQoKICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgKiBDZWxsIG1hcmdpbiBzZXR0aW5nCiAgICAgKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICovCiAgICBmdW5jdGlvbiBTZXRQYWRkaW5nKCRhQXJnUjEsJGFDMT1udWxsLCRhUjI9bnVsbCwkYUMyPW51bGwsJGFQYWQ9bnVsbCkgewogICAgICAgIGlmKCAkYUMxICE9PSBudWxsICYmICRhUjIhPT1udWxsICYmICRhQzIhPT1udWxsICYmICRhUGFkIT09bnVsbCApIHsKICAgICAgICAgICAgJHRoaXMtPl9jaGtSKCRhQXJnUjEpOyAgJHRoaXMtPl9jaGtDKCRhQzEpOwogICAgICAgICAgICAkdGhpcy0+X2Noa1IoJGFSMik7ICAkdGhpcy0+X2Noa0MoJGFDMik7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAkYVBhZCA9ICRhQXJnUjE7CiAgICAgICAgICAgICRhUjIgPSAkdGhpcy0+aVNpemVbMF0tMTsgJGFBcmdSMSA9IDA7CiAgICAgICAgICAgICRhQzIgPSAkdGhpcy0+aVNpemVbMV0tMTsgJGFDMSA9IDA7CiAgICAgICAgfQogICAgICAgIGZvcigkaT0kYUFyZ1IxOyAkaSA8PSAkYVIyOyArKyRpKSB7CiAgICAgICAgICAgIGZvcigkaj0kYUMxOyAkaiA8PSAkYUMyOyArKyRqKSB7CiAgICAgICAgICAgICAgICAkdGhpcy0+aUNlbGxzWyRpXVskal0tPlNldE1hcmdpbigkYVBhZCwkYVBhZCwkYVBhZCwkYVBhZCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gU2V0Um93UGFkZGluZygkYVJvdywkYVBhZCkgewogICAgICAgICR0aGlzLT5fY2hrUigkYVJvdyk7CiAgICAgICAgZm9yKCRqPTA7ICRqIDwgJHRoaXMtPmlTaXplWzFdOyArKyRqKSB7CiAgICAgICAgICAgICR0aGlzLT5pQ2VsbHNbJGFSb3ddWyRqXS0+U2V0TWFyZ2luKCRhUGFkLCRhUGFkLCRhUGFkLCRhUGFkKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gU2V0Q29sUGFkZGluZygkYUNvbCwkYVBhZCkgewogICAgICAgICR0aGlzLT5fY2hrQygkYUNvbCk7CiAgICAgICAgZm9yKCRqPTA7ICRqIDwgJHRoaXMtPmlTaXplWzBdOyArKyRqKSB7CiAgICAgICAgICAgICR0aGlzLT5pQ2VsbHNbJGpdWyRhQ29sXS0+U2V0TWFyZ2luKCRhUGFkLCRhUGFkLCRhUGFkLCRhUGFkKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gU2V0Q2VsbFBhZGRpbmcoJGFSb3csJGFDb2wsJGFQYWQpIHsKICAgICAgICAkdGhpcy0+X2Noa1IoJGFSb3cpOwogICAgICAgICR0aGlzLT5fY2hrQygkYUNvbCk7CiAgICAgICAgJHRoaXMtPmlDZWxsc1skYVJvd11bJGFDb2xdLT5TZXRNYXJnaW4oJGFQYWQsJGFQYWQsJGFQYWQsJGFQYWQpOwogICAgfQoKCiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICogQ2VsbCB0ZXh0IG9yaWVudGF0aW9uIHNldHRpbmcKICAgICAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgKi8KICAgIGZ1bmN0aW9uIFNldFRleHRPcmllbnRhdGlvbigkYUFyZ1IxLCRhQzE9bnVsbCwkYVIyPW51bGwsJGFDMj1udWxsLCRhTz1udWxsKSB7CiAgICAgICAgaWYoICRhQzEgIT09IG51bGwgJiYgJGFSMiE9PW51bGwgJiYgJGFDMiE9PW51bGwgJiYgJGFQYWQhPT1udWxsICkgewogICAgICAgICAgICAkdGhpcy0+X2Noa1IoJGFBcmdSMSk7ICAkdGhpcy0+X2Noa0MoJGFDMSk7CiAgICAgICAgICAgICR0aGlzLT5fY2hrUigkYVIyKTsgICR0aGlzLT5fY2hrQygkYUMyKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICRhTyA9ICRhQXJnUjE7CiAgICAgICAgICAgICRhUjIgPSAkdGhpcy0+aVNpemVbMF0tMTsgJGFBcmdSMSA9IDA7CiAgICAgICAgICAgICRhQzIgPSAkdGhpcy0+aVNpemVbMV0tMTsgJGFDMSA9IDA7CiAgICAgICAgfQogICAgICAgIGZvcigkaT0kYUFyZ1IxOyAkaSA8PSAkYVIyOyArKyRpKSB7CiAgICAgICAgICAgIGZvcigkaj0kYUMxOyAkaiA8PSAkYUMyOyArKyRqKSB7CiAgICAgICAgICAgICAgICAkdGhpcy0+aUNlbGxzWyRpXVskal0tPmlWYWwtPlNldE9yaWVudGF0aW9uKCRhTyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gU2V0Um93VGV4dE9yaWVudGF0aW9uKCRhUm93LCRhTykgewogICAgICAgICR0aGlzLT5fY2hrUigkYVJvdyk7CiAgICAgICAgZm9yKCRqPTA7ICRqIDwgJHRoaXMtPmlTaXplWzFdOyArKyRqKSB7CiAgICAgICAgICAgICR0aGlzLT5pQ2VsbHNbJGFSb3ddWyRqXS0+aVZhbC0+U2V0T3JpZW50YXRpb24oJGFPKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gU2V0Q29sVGV4dE9yaWVudGF0aW9uKCRhQ29sLCRhTykgewogICAgICAgICR0aGlzLT5fY2hrQygkYUNvbCk7CiAgICAgICAgZm9yKCRqPTA7ICRqIDwgJHRoaXMtPmlTaXplWzBdOyArKyRqKSB7CiAgICAgICAgICAgICR0aGlzLT5pQ2VsbHNbJGpdWyRhQ29sXS0+aVZhbC0+U2V0T3JpZW50YXRpb24oJGFPKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gU2V0Q2VsbFRleHRPcmllbnRhdGlvbigkYVJvdywkYUNvbCwkYU8pIHsKICAgICAgICAkdGhpcy0+X2Noa1IoJGFSb3cpOwogICAgICAgICR0aGlzLT5fY2hrQygkYUNvbCk7CiAgICAgICAgJHRoaXMtPmlDZWxsc1skYVJvd11bJGFDb2xdLT5pVmFsLT5TZXRPcmllbnRhdGlvbigkYU8pOwogICAgfQoKCgoKICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgKiBGb250IGNvbG9yIHNldHRpbmcKICAgICAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgKi8KCiAgICBmdW5jdGlvbiBTZXRDb2xvcigkYUFyZ1IxLCRhQzE9bnVsbCwkYVIyPW51bGwsJGFDMj1udWxsLCRhQXJnPW51bGwpIHsKICAgICAgICBpZiggJGFDMSAhPT0gbnVsbCAmJiAkYVIyIT09bnVsbCAmJiAkYUMyIT09bnVsbCAmJiAkYUFyZyE9PW51bGwgKSB7CiAgICAgICAgICAgICR0aGlzLT5fY2hrUigkYUFyZ1IxKTsgICR0aGlzLT5fY2hrQygkYUMxKTsKICAgICAgICAgICAgJHRoaXMtPl9jaGtSKCRhUjIpOyAgJHRoaXMtPl9jaGtDKCRhQzIpOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJGFBcmcgPSAkYUFyZ1IxOwogICAgICAgICAgICAkYVIyID0gJHRoaXMtPmlTaXplWzBdLTE7ICRhQXJnUjEgPSAwOwogICAgICAgICAgICAkYUMyID0gJHRoaXMtPmlTaXplWzFdLTE7ICRhQzEgPSAwOwogICAgICAgIH0KICAgICAgICBmb3IoJGk9JGFBcmdSMTsgJGkgPD0gJGFSMjsgKyskaSkgewogICAgICAgICAgICBmb3IoJGo9JGFDMTsgJGogPD0gJGFDMjsgKyskaikgewogICAgICAgICAgICAgICAgJHRoaXMtPmlDZWxsc1skaV1bJGpdLT5TZXRGb250Q29sb3IoJGFBcmcpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIFNldFJvd0NvbG9yKCRhUm93LCRhQ29sb3IpIHsKICAgICAgICAkdGhpcy0+X2Noa1IoJGFSb3cpOwogICAgICAgIGZvcigkaj0wOyAkaiA8ICR0aGlzLT5pU2l6ZVsxXTsgKyskaikgewogICAgICAgICAgICAkdGhpcy0+aUNlbGxzWyRhUm93XVskal0tPlNldEZvbnRDb2xvcigkYUNvbG9yKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gU2V0Q29sQ29sb3IoJGFDb2wsJGFDb2xvcikgewogICAgICAgICR0aGlzLT5fY2hrQygkYUNvbCk7CiAgICAgICAgZm9yKCRpPTA7ICRpIDwgJHRoaXMtPmlTaXplWzBdOyArKyRpKSB7CiAgICAgICAgICAgICR0aGlzLT5pQ2VsbHNbJGldWyRhQ29sXS0+U2V0Rm9udENvbG9yKCRhQ29sb3IpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBTZXRDZWxsQ29sb3IoJGFSb3csJGFDb2wsJGFDb2xvcikgewogICAgICAgICR0aGlzLT5fY2hrUigkYVJvdyk7CiAgICAgICAgJHRoaXMtPl9jaGtDKCRhQ29sKTsKICAgICAgICAkdGhpcy0+aUNlbGxzWyRhUm93XVskYUNvbF0tPlNldEZvbnRDb2xvcigkYUNvbG9yKTsKICAgIH0KCiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICogRmlsbCBjb2xvciBzZXR0aW5ncwogICAgICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAqLwoKICAgIGZ1bmN0aW9uIFNldEZpbGxDb2xvcigkYUFyZ1IxLCRhQzE9bnVsbCwkYVIyPW51bGwsJGFDMj1udWxsLCRhQXJnPW51bGwpIHsKICAgICAgICBpZiggJGFDMSAhPT0gbnVsbCAmJiAkYVIyIT09bnVsbCAmJiAkYUMyIT09bnVsbCAmJiAkYUFyZyE9PW51bGwgKSB7CiAgICAgICAgICAgICR0aGlzLT5fY2hrUigkYUFyZ1IxKTsgICR0aGlzLT5fY2hrQygkYUMxKTsKICAgICAgICAgICAgJHRoaXMtPl9jaGtSKCRhUjIpOyAgJHRoaXMtPl9jaGtDKCRhQzIpOwogICAgICAgICAgICBmb3IoJGk9JGFBcmdSMTsgJGkgPD0gJGFSMjsgKyskaSkgewogICAgICAgICAgICAgICAgZm9yKCRqPSRhQzE7ICRqIDw9ICRhQzI7ICsrJGopIHsKICAgICAgICAgICAgICAgICAgICAkdGhpcy0+aUNlbGxzWyRpXVskal0tPlNldEZpbGxDb2xvcigkYUFyZyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICR0aGlzLT5pQkdDb2xvciA9ICRhQXJnUjE7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIFNldFJvd0ZpbGxDb2xvcigkYVJvdywkYUNvbG9yKSB7CiAgICAgICAgJHRoaXMtPl9jaGtSKCRhUm93KTsKICAgICAgICBmb3IoJGo9MDsgJGogPCAkdGhpcy0+aVNpemVbMV07ICsrJGopIHsKICAgICAgICAgICAgJHRoaXMtPmlDZWxsc1skYVJvd11bJGpdLT5TZXRGaWxsQ29sb3IoJGFDb2xvcik7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIFNldENvbEZpbGxDb2xvcigkYUNvbCwkYUNvbG9yKSB7CiAgICAgICAgJHRoaXMtPl9jaGtDKCRhQ29sKTsKICAgICAgICBmb3IoJGk9MDsgJGkgPCAkdGhpcy0+aVNpemVbMF07ICsrJGkpIHsKICAgICAgICAgICAgJHRoaXMtPmlDZWxsc1skaV1bJGFDb2xdLT5TZXRGaWxsQ29sb3IoJGFDb2xvcik7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIFNldENlbGxGaWxsQ29sb3IoJGFSb3csJGFDb2wsJGFDb2xvcikgewogICAgICAgICR0aGlzLT5fY2hrUigkYVJvdyk7CiAgICAgICAgJHRoaXMtPl9jaGtDKCRhQ29sKTsKICAgICAgICAkdGhpcy0+aUNlbGxzWyRhUm93XVskYUNvbF0tPlNldEZpbGxDb2xvcigkYUNvbG9yKTsKICAgIH0KCiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICogRm9udCBmYW1pbHkgc2V0dGluZwogICAgICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAqLwogICAgZnVuY3Rpb24gU2V0Rm9udCgpIHsKICAgICAgICAkbnVtYXJncyA9IGZ1bmNfbnVtX2FyZ3MoKTsKICAgICAgICBpZiggJG51bWFyZ3MgPT0gMiB8fCAkbnVtYXJncyA9PSAzICkgewogICAgICAgICAgICAkYUZGID0gZnVuY19nZXRfYXJnKDApOwogICAgICAgICAgICAkYUZTID0gZnVuY19nZXRfYXJnKDEpOwogICAgICAgICAgICBpZiggJG51bWFyZ3MgPT0gMyApCiAgICAgICAgICAgICRhRlNpemU9ZnVuY19nZXRfYXJnKDIpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICRhRlNpemU9MTA7CiAgICAgICAgICAgICRhUjIgPSAkdGhpcy0+aVNpemVbMF0tMTsgJGFSMSA9IDA7CiAgICAgICAgICAgICRhQzIgPSAkdGhpcy0+aVNpemVbMV0tMTsgJGFDMSA9IDA7CgogICAgICAgIH0KICAgICAgICBlbHNlaWYoJG51bWFyZ3MgPT0gNiB8fCAkbnVtYXJncyA9PSA3ICkgewogICAgICAgICAgICAkYVIxID0gZnVuY19nZXRfYXJnKDApOyAkYUMxID0gZnVuY19nZXRfYXJnKDEpOwogICAgICAgICAgICAkYVIyID0gZnVuY19nZXRfYXJnKDIpOyAkYUMyID0gZnVuY19nZXRfYXJnKDMpOwogICAgICAgICAgICAkYUZGID0gZnVuY19nZXRfYXJnKDQpOyAkYUZTID0gZnVuY19nZXRfYXJnKDUpOwogICAgICAgICAgICBpZiggJG51bWFyZ3MgPT0gNyApCiAgICAgICAgICAgICRhRlNpemU9ZnVuY19nZXRfYXJnKDYpOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICRhRlNpemU9MTA7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBKcEdyYXBoRXJyb3I6OlJhaXNlTCgyNzAwMyk7CiAgICAgICAgICAgIC8vKCdXcm9uZyBudW1iZXIgb2YgYXJndW1lbnRzIHRvIEdUZXh0VGFibGU6OlNldENvbG9yKCknKTsKICAgICAgICB9CiAgICAgICAgJHRoaXMtPl9jaGtSKCRhUjEpOyAgJHRoaXMtPl9jaGtDKCRhQzEpOwogICAgICAgICR0aGlzLT5fY2hrUigkYVIyKTsgICR0aGlzLT5fY2hrQygkYUMyKTsKICAgICAgICBmb3IoJGk9JGFSMTsgJGkgPD0gJGFSMjsgKyskaSkgewogICAgICAgICAgICBmb3IoJGo9JGFDMTsgJGogPD0gJGFDMjsgKyskaikgewogICAgICAgICAgICAgICAgJHRoaXMtPmlDZWxsc1skaV1bJGpdLT5TZXRGb250KCRhRkYsJGFGUywkYUZTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBTZXRSb3dGb250KCRhUm93LCRhRkYsJGFGUywkYUZTaXplPTEwKSB7CiAgICAgICAgJHRoaXMtPl9jaGtSKCRhUm93KTsKICAgICAgICBmb3IoJGo9MDsgJGogPCAkdGhpcy0+aVNpemVbMV07ICsrJGopIHsKICAgICAgICAgICAgJHRoaXMtPmlDZWxsc1skYVJvd11bJGpdLT5TZXRGb250KCRhRkYsJGFGUywkYUZTaXplKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gU2V0Q29sRm9udCgkYUNvbCwkYUZGLCRhRlMsJGFGU2l6ZT0xMCkgewogICAgICAgICR0aGlzLT5fY2hrQygkYUNvbCk7CiAgICAgICAgZm9yKCRpPTA7ICRpIDwgJHRoaXMtPmlTaXplWzBdOyArKyRpKSB7CiAgICAgICAgICAgICR0aGlzLT5pQ2VsbHNbJGldWyRhQ29sXS0+U2V0Rm9udCgkYUZGLCRhRlMsJGFGU2l6ZSk7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIFNldENlbGxGb250KCRhUm93LCRhQ29sLCRhRkYsJGFGUywkYUZTaXplPTEwKSB7CiAgICAgICAgJHRoaXMtPl9jaGtSKCRhUm93KTsKICAgICAgICAkdGhpcy0+X2Noa0MoJGFDb2wpOwogICAgICAgICR0aGlzLT5pQ2VsbHNbJGFSb3ddWyRhQ29sXS0+U2V0Rm9udCgkYUZGLCRhRlMsJGFGU2l6ZSk7CiAgICB9CgogICAgLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgICAqIENlbGwgYWxpZ24gc2V0dGluZ3MKICAgICAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgKi8KCiAgICBmdW5jdGlvbiBTZXRBbGlnbigkYVIxSEFsaWduPW51bGwsJGFDMVZBbGlnbj1udWxsLCRhUjI9bnVsbCwkYUMyPW51bGwsJGFIQXJnPW51bGwsJGFWQXJnPSdjZW50ZXInKSB7CiAgICAgICAgaWYoICRhQzFWQWxpZ24gIT09IG51bGwgJiYgJGFSMiE9PW51bGwgJiYgJGFDMiE9PW51bGwgJiYgJGFIQXJnIT09bnVsbCApIHsKICAgICAgICAgICAgJHRoaXMtPl9jaGtSKCRhUjFIQWxpZ24pOyAgJHRoaXMtPl9jaGtDKCRhQzFWQWxpZ24pOwogICAgICAgICAgICAkdGhpcy0+X2Noa1IoJGFSMik7ICAkdGhpcy0+X2Noa0MoJGFDMik7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBpZiggJGFSMUhBbGlnbiA9PT0gbnVsbCApIHsKICAgICAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDI3MDEwKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiggJGFDMVZBbGlnbiA9PT0gbnVsbCApIHsKICAgICAgICAgICAgICAgICRhQzFWQWxpZ24gPSAnY2VudGVyJzsKICAgICAgICAgICAgfQogICAgICAgICAgICAkYUhBcmcgPSAkYVIxSEFsaWduOwogICAgICAgICAgICAkYVZBcmcgPSAkYUMxVkFsaWduID09PSBudWxsID8gJ2NlbnRlcicgOiAkYUMxVkFsaWduIDsKICAgICAgICAgICAgJGFSMiA9ICR0aGlzLT5pU2l6ZVswXS0xOyAkYVIxSEFsaWduID0gMDsKICAgICAgICAgICAgJGFDMiA9ICR0aGlzLT5pU2l6ZVsxXS0xOyAkYUMxVkFsaWduID0gMDsKICAgICAgICB9CiAgICAgICAgZm9yKCRpPSRhUjFIQWxpZ247ICRpIDw9ICRhUjI7ICsrJGkpIHsKICAgICAgICAgICAgZm9yKCRqPSRhQzFWQWxpZ247ICRqIDw9ICRhQzI7ICsrJGopIHsKICAgICAgICAgICAgICAgICR0aGlzLT5pQ2VsbHNbJGldWyRqXS0+U2V0QWxpZ24oJGFIQXJnLCRhVkFyZyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gU2V0Q2VsbEFsaWduKCRhUm93LCRhQ29sLCRhSG9yQWxpZ24sJGFWZXJ0QWxpZ249J2JvdHRvbScpIHsKICAgICAgICAkdGhpcy0+X2Noa1IoJGFSb3cpOwogICAgICAgICR0aGlzLT5fY2hrQygkYUNvbCk7CiAgICAgICAgJHRoaXMtPmlDZWxsc1skYVJvd11bJGFDb2xdLT5TZXRBbGlnbigkYUhvckFsaWduLCRhVmVydEFsaWduKTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRSb3dBbGlnbigkYVJvdywkYUhvckFsaWduLCRhVmVydEFsaWduPSdib3R0b20nKSB7CiAgICAgICAgJHRoaXMtPl9jaGtSKCRhUm93KTsKICAgICAgICBmb3IoJGo9MDsgJGogPCAkdGhpcy0+aVNpemVbMV07ICsrJGopIHsKICAgICAgICAgICAgJHRoaXMtPmlDZWxsc1skYVJvd11bJGpdLT5TZXRBbGlnbigkYUhvckFsaWduLCRhVmVydEFsaWduKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gU2V0Q29sQWxpZ24oJGFDb2wsJGFIb3JBbGlnbiwkYVZlcnRBbGlnbj0nYm90dG9tJykgewogICAgICAgICR0aGlzLT5fY2hrQygkYUNvbCk7CiAgICAgICAgZm9yKCRpPTA7ICRpIDwgJHRoaXMtPmlTaXplWzBdOyArKyRpKSB7CiAgICAgICAgICAgICR0aGlzLT5pQ2VsbHNbJGldWyRhQ29sXS0+U2V0QWxpZ24oJGFIb3JBbGlnbiwkYVZlcnRBbGlnbik7CiAgICAgICAgfQogICAgfQoKICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgKiBDZWxsIG51bWJlciBmb3JtYXQKICAgICAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgKi8KCiAgICBmdW5jdGlvbiBTZXROdW1iZXJGb3JtYXQoJGFBcmdSMSwkYUMxPW51bGwsJGFSMj1udWxsLCRhQzI9bnVsbCwkYUFyZz1udWxsKSB7CiAgICAgICAgaWYoICRhQzEgIT09IG51bGwgJiYgJGFSMiE9PW51bGwgJiYgJGFDMiE9PW51bGwgJiYgJGFBcmchPT1udWxsICkgewogICAgICAgICAgICAkdGhpcy0+X2Noa1IoJGFBcmdSMSk7ICAkdGhpcy0+X2Noa0MoJGFDMSk7CiAgICAgICAgICAgICR0aGlzLT5fY2hrUigkYVIyKTsgICR0aGlzLT5fY2hrQygkYUMyKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICRhQXJnID0gJGFBcmdSMTsKICAgICAgICAgICAgJGFSMiA9ICR0aGlzLT5pU2l6ZVswXS0xOyAkYUFyZ1IxID0gMDsKICAgICAgICAgICAgJGFDMiA9ICR0aGlzLT5pU2l6ZVsxXS0xOyAkYUMxID0gMDsKICAgICAgICB9CiAgICAgICAgaWYoICFpc19zdHJpbmcoJGFBcmcpICkgewogICAgICAgICAgICBKcEdyYXBoRXJyb3I6OlJhaXNlTCgyNzAxMyk7IC8vIGFyZ3VtZW50IG11c3QgYmUgYSBzdHJpbmcKICAgICAgICB9CiAgICAgICAgZm9yKCRpPSRhQXJnUjE7ICRpIDw9ICRhUjI7ICsrJGkpIHsKICAgICAgICAgICAgZm9yKCRqPSRhQzE7ICRqIDw9ICRhQzI7ICsrJGopIHsKICAgICAgICAgICAgICAgICR0aGlzLT5pQ2VsbHNbJGldWyRqXS0+U2V0TnVtYmVyRm9ybWF0KCRhQXJnKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBTZXRSb3dOdW1iZXJGb3JtYXQoJGFSb3csJGFGKSB7CiAgICAgICAgJHRoaXMtPl9jaGtSKCRhUm93KTsKICAgICAgICBpZiggIWlzX3N0cmluZygkYUYpICkgewogICAgICAgICAgICBKcEdyYXBoRXJyb3I6OlJhaXNlTCgyNzAxMyk7IC8vIGFyZ3VtZW50IG11c3QgYmUgYSBzdHJpbmcKICAgICAgICB9CiAgICAgICAgZm9yKCRqPTA7ICRqIDwgJHRoaXMtPmlTaXplWzFdOyArKyRqKSB7CiAgICAgICAgICAgICR0aGlzLT5pQ2VsbHNbJGFSb3ddWyRqXS0+U2V0TnVtYmVyRm9ybWF0KCRhRik7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIFNldENvbE51bWJlckZvcm1hdCgkYUNvbCwkYUYpIHsKICAgICAgICAkdGhpcy0+X2Noa0MoJGFDb2wpOwogICAgICAgIGlmKCAhaXNfc3RyaW5nKCRhRikgKSB7CiAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDI3MDEzKTsgLy8gYXJndW1lbnQgbXVzdCBiZSBhIHN0cmluZwogICAgICAgIH0KICAgICAgICBmb3IoJGk9MDsgJGkgPCAkdGhpcy0+aVNpemVbMF07ICsrJGkpIHsKICAgICAgICAgICAgJHRoaXMtPmlDZWxsc1skaV1bJGFDb2xdLT5TZXROdW1iZXJGb3JtYXQoJGFGKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gU2V0Q2VsbE51bWJlckZvcm1hdCgkYVJvdywkYUNvbCwkYUYpIHsKICAgICAgICAkdGhpcy0+X2Noa1IoJGFSb3cpOyAkdGhpcy0+X2Noa0MoJGFDb2wpOwogICAgICAgIGlmKCAhaXNfc3RyaW5nKCRhRikgKSB7CiAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDI3MDEzKTsgLy8gYXJndW1lbnQgbXVzdCBiZSBhIHN0cmluZwogICAgICAgIH0KICAgICAgICAkdGhpcy0+aUNlbGxzWyRhUm93XVskYUNvbF0tPlNldE51bWJlckZvcm1hdCgkYUYpOwogICAgfQoKICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgKiBTZXQgcm93IGFuZCBjb2x1bW4gbWluIHNpemUKICAgICAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgKi8KCiAgICBmdW5jdGlvbiBTZXRNaW5Db2xXaWR0aCgkYUNvbFdpZHRoLCRhV2lkdGg9bnVsbCkgewogICAgICAgIC8vIElmIHRoZXJlIGlzIG9ubHkgb25lIGFyZ3VtZW50IHRoaXMgbWVhbnMgdGhhdCBhbGwKICAgICAgICAvLyBjb2x1bW5zIGdldCBzZXQgdG8gdGhlIHNhbWUgd2lkdGgKICAgICAgICBpZiggJGFXaWR0aD09PW51bGwgKSB7CiAgICAgICAgICAgIGZvcigkaT0wOyAkaSA8ICR0aGlzLT5pU2l6ZVsxXTsgKyskaSkgewogICAgICAgICAgICAgICAgJHRoaXMtPmlDb2xXaWR0aFskaV0gID0gJGFDb2xXaWR0aDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJHRoaXMtPl9jaGtDKCRhQ29sV2lkdGgpOwogICAgICAgICAgICAkdGhpcy0+aUNvbFdpZHRoWyRhQ29sV2lkdGhdICA9ICRhV2lkdGg7CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIFNldE1pblJvd0hlaWdodCgkYVJvd0hlaWdodCwkYUhlaWdodD1udWxsKSB7CiAgICAgICAgLy8gSWYgdGhlcmUgaXMgb25seSBvbmUgYXJndW1lbnQgdGhpcyBtZWFucyB0aGF0IGFsbAogICAgICAgIC8vIHJvd3MgZ2V0IHNldCB0byB0aGUgc2FtZSBoZWlnaHQKICAgICAgICBpZiggJGFIZWlnaHQ9PT1udWxsICkgewogICAgICAgICAgICBmb3IoJGk9MDsgJGkgPCAkdGhpcy0+aVNpemVbMF07ICsrJGkpIHsKICAgICAgICAgICAgICAgICR0aGlzLT5pUm93SGVpZ2h0WyRpXSAgPSAkYVJvd0hlaWdodDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJHRoaXMtPl9jaGtSKCRhUm93SGVpZ2h0KTsKICAgICAgICAgICAgJHRoaXMtPmlSb3dIZWlnaHRbJGFSb3dIZWlnaHRdICA9ICRhSGVpZ2h0OwogICAgICAgIH0KICAgIH0KCiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICogR3JpZCBsaW5lIHNldHRpbmdzCiAgICAgKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICovCgogICAgZnVuY3Rpb24gU2V0R3JpZCgkYVdlaWdodD0xLCRhQ29sb3I9J2JsYWNrJywkYVN0eWxlPVRHUklEX1NJTkdMRSkgewogICAgICAgICRyYyA9ICR0aGlzLT5pU2l6ZVswXTsKICAgICAgICAkY2MgPSAkdGhpcy0+aVNpemVbMV07CiAgICAgICAgZm9yKCRpPTA7ICRpIDwgJHJjOyArKyRpKSB7CiAgICAgICAgICAgIGZvcigkaj0wOyAkaiA8ICRjYzsgKyskaikgewogICAgICAgICAgICAgICAgJHRoaXMtPmlDZWxsc1skaV1bJGpdLT5TZXRHcmlkQ29sb3IoJGFDb2xvciwkYUNvbG9yKTsKICAgICAgICAgICAgICAgICR0aGlzLT5pQ2VsbHNbJGldWyRqXS0+U2V0R3JpZFdlaWdodCgkYVdlaWdodCwkYVdlaWdodCk7CiAgICAgICAgICAgICAgICAkdGhpcy0+aUNlbGxzWyRpXVskal0tPlNldEdyaWRTdHlsZSgkYVN0eWxlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBTZXRDb2xHcmlkKCRhQ29sLCRhV2VpZ2h0PTEsJGFDb2xvcj0nYmxhY2snLCRhU3R5bGU9VEdSSURfU0lOR0xFKSB7CiAgICAgICAgJHRoaXMtPl9jaGtDKCRhQ29sKTsKICAgICAgICBmb3IoJGk9MDsgJGkgPCAkdGhpcy0+aVNpemVbMF07ICsrJGkpIHsKICAgICAgICAgICAgJHRoaXMtPmlDZWxsc1skaV1bJGFDb2xdLT5TZXRHcmlkV2VpZ2h0KCRhV2VpZ2h0KTsKICAgICAgICAgICAgJHRoaXMtPmlDZWxsc1skaV1bJGFDb2xdLT5TZXRHcmlkQ29sb3IoJGFDb2xvcik7CiAgICAgICAgICAgICR0aGlzLT5pQ2VsbHNbJGldWyRhQ29sXS0+U2V0R3JpZFN0eWxlKCRhU3R5bGUpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBTZXRSb3dHcmlkKCRhUm93LCRhV2VpZ2h0PTEsJGFDb2xvcj0nYmxhY2snLCRhU3R5bGU9VEdSSURfU0lOR0xFKSB7CiAgICAgICAgJHRoaXMtPl9jaGtSKCRhUm93KTsKICAgICAgICBmb3IoJGo9MDsgJGogPCAkdGhpcy0+aVNpemVbMV07ICsrJGopIHsKICAgICAgICAgICAgJHRoaXMtPmlDZWxsc1skYVJvd11bJGpdLT5TZXRHcmlkV2VpZ2h0KE5VTEwsJGFXZWlnaHQpOwogICAgICAgICAgICAkdGhpcy0+aUNlbGxzWyRhUm93XVskal0tPlNldEdyaWRDb2xvcihOVUxMLCRhQ29sb3IpOwogICAgICAgICAgICAkdGhpcy0+aUNlbGxzWyRhUm93XVskal0tPlNldEdyaWRTdHlsZShOVUxMLCRhU3R5bGUpOwogICAgICAgIH0KICAgIH0KCiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICogTWVyZ2UgY2VsbHMKICAgICAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgKi8KCiAgICBmdW5jdGlvbiBNZXJnZVJvdygkYVJvdywkYUhBbGlnbj0nY2VudGVyJywkYVZBbGlnbj0nY2VudGVyJykgewogICAgICAgICR0aGlzLT5fY2hrUigkYVJvdyk7CiAgICAgICAgJHRoaXMtPk1lcmdlQ2VsbHMoJGFSb3csMCwkYVJvdywkdGhpcy0+aVNpemVbMV0tMSwkYUhBbGlnbiwkYVZBbGlnbik7CiAgICB9CgogICAgZnVuY3Rpb24gTWVyZ2VDb2woJGFDb2wsJGFIQWxpZ249J2NlbnRlcicsJGFWQWxpZ249J2NlbnRlcicpIHsKICAgICAgICAkdGhpcy0+X2Noa0MoJGFDb2wpOwogICAgICAgICR0aGlzLT5NZXJnZUNlbGxzKDAsJGFDb2wsJHRoaXMtPmlTaXplWzBdLTEsJGFDb2wsJGFIQWxpZ24sJGFWQWxpZ24pOwogICAgfQoKICAgIGZ1bmN0aW9uIE1lcmdlQ2VsbHMoJGFSMSwkYUMxLCRhUjIsJGFDMiwkYUhBbGlnbj0nY2VudGVyJywkYVZBbGlnbj0nY2VudGVyJykgewogICAgICAgIGlmKCAkYVIxID4gJGFSMiB8fCAkYUMxID4gJGFDMiApIHsKICAgICAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoMjcwMDQpOwogICAgICAgICAgICAvLygnR1RleHRUYWJsZTo6TWVyZ2VDZWxscygpLiBTcGVjaWZpZWQgY2VsbCByYW5nZSB0byBiZSBtZXJnZWQgaXMgbm90IHZhbGlkLicpOwogICAgICAgIH0KICAgICAgICAkdGhpcy0+X2Noa1IoJGFSMSk7ICR0aGlzLT5fY2hrQygkYUMxKTsKICAgICAgICAkdGhpcy0+X2Noa1IoJGFSMik7ICR0aGlzLT5fY2hrQygkYUMyKTsKICAgICAgICAkcnNwYW4gPSAkYVIyLSRhUjErMTsKICAgICAgICAkY3NwYW4gPSAkYUMyLSRhQzErMTsKICAgICAgICAvLyBTZXR1cCB0aGUgcGFyZW50IGNlbGwgZm9yIHRoaXMgbWVyZ2VkIGdyb3VwCiAgICAgICAgaWYoICR0aGlzLT5pQ2VsbHNbJGFSMV1bJGFDMV0tPklzTWVyZ2VkKCkgKSB7CiAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDI3MDA1LCRhUjEsJGFDMSwkYVIyLCRhQzIpOwogICAgICAgICAgICAvLygiQ2Fubm90IG1lcmdlIGFscmVhZHkgbWVyZ2VkIGNlbGxzIGluIHRoZSByYW5nZSAoJGFSMSwkYUMxKSwgKCRhUjIsJGFDMikiKTsKICAgICAgICB9CiAgICAgICAgJHRoaXMtPmlDZWxsc1skYVIxXVskYUMxXS0+U2V0Um93Q29sU3BhbigkcnNwYW4sJGNzcGFuKTsKICAgICAgICAkdGhpcy0+aUNlbGxzWyRhUjFdWyRhQzFdLT5TZXRBbGlnbigkYUhBbGlnbiwkYVZBbGlnbik7CiAgICAgICAgZm9yKCRpPSRhUjE7ICRpIDw9ICRhUjI7ICsrJGkpIHsKICAgICAgICAgICAgZm9yKCRqPSRhQzE7ICRqIDw9ICRhQzI7ICsrJGopIHsKICAgICAgICAgICAgICAgIGlmKCAhICgkaSA9PSAkYVIxICYmICRqID09ICRhQzEpICkgewogICAgICAgICAgICAgICAgICAgIGlmKCAkdGhpcy0+aUNlbGxzWyRpXVskal0tPklzTWVyZ2VkKCkgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDI3MDA1LCRhUjEsJGFDMSwkYVIyLCRhQzIpOwogICAgICAgICAgICAgICAgICAgICAgICAvLygiQ2Fubm90IG1lcmdlIGFscmVhZHkgbWVyZ2VkIGNlbGxzIGluIHRoZSByYW5nZSAoJGFSMSwkYUMxKSwgKCRhUjIsJGFDMikiKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmlDZWxsc1skaV1bJGpdLT5TZXRNZXJnZWQoJGFSMSwkYUMxLHRydWUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKCiAgICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICogQ1NJTSBtZXRob2RzCiAgICAgKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICovCgogICAgZnVuY3Rpb24gU2V0Q1NJTVRhcmdldCgkYVRhcmdldCwkYUFsdD1udWxsLCRhQXV0b1RhcmdldD1mYWxzZSkgewogICAgICAgICRtID0gJHRoaXMtPmlTaXplWzBdOwogICAgICAgICRuID0gJHRoaXMtPmlTaXplWzFdOwogICAgICAgICRjc2ltID0gJyc7CiAgICAgICAgZm9yKCRpPTA7ICRpIDwgJG07ICsrJGkpIHsKICAgICAgICAgICAgZm9yKCRqPTA7ICRqIDwgJG47ICsrJGopIHsKICAgICAgICAgICAgICAgIGlmKCAkYUF1dG9UYXJnZXQgKQogICAgICAgICAgICAgICAgJHQgPSAkYVRhcmdldC4iP3Jvdz0kaSZjb2w9JGoiOwogICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgJHQgPSAkYVRhcmdldDsKICAgICAgICAgICAgICAgICR0aGlzLT5pQ2VsbHNbJGldWyRqXS0+U2V0Q1NJTVRhcmdldCgkdCwkYUFsdCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gU2V0Q2VsbENTSU1UYXJnZXQoJGFSb3csJGFDb2wsJGFUYXJnZXQsJGFBbHQ9bnVsbCkgewogICAgICAgICR0aGlzLT5fY2hrUigkYVJvdyk7CiAgICAgICAgJHRoaXMtPl9jaGtDKCRhQ29sKTsKICAgICAgICAkdGhpcy0+aUNlbGxzWyRhUm93XVskYUNvbF0tPlNldENTSU1UYXJnZXQoJGFUYXJnZXQsJGFBbHQpOwogICAgfQoKICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgKiBQcml2YXRlIG1ldGhvZHMKICAgICAqLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICAgKi8KCiAgICBmdW5jdGlvbiBHZXRDU0lNQXJlYXMoKSB7CiAgICAgICAgJG0gPSAkdGhpcy0+aVNpemVbMF07CiAgICAgICAgJG4gPSAkdGhpcy0+aVNpemVbMV07CiAgICAgICAgJGNzaW0gPSAnJzsKICAgICAgICBmb3IoJGk9MDsgJGkgPCAkbTsgKyskaSkgewogICAgICAgICAgICBmb3IoJGo9MDsgJGogPCAkbjsgKyskaikgewogICAgICAgICAgICAgICAgJGNzaW0gLj0gJHRoaXMtPmlDZWxsc1skaV1bJGpdLT5HZXRDU0lNQXJlYSgpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiAkY3NpbTsKICAgIH0KCiAgICBmdW5jdGlvbiBfY2hrQygkYUNvbCkgewogICAgICAgIGlmKCAhICR0aGlzLT5pSW5pdCApIHsKICAgICAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZSgyNzAxNCk7IC8vIFRhYmxlIG5vdCBpbml0aWFsaXplZAogICAgICAgIH0KICAgICAgICBpZiggJGFDb2wgPCAwIHx8ICRhQ29sID49ICR0aGlzLT5pU2l6ZVsxXSApCiAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoMjcwMDYsJGFDb2wpOwogICAgICAgIC8vKCJHVGV4dFRhYmxlOlxuQ29sdW1uIGFyZ3VtZW50ICgkYUNvbCkgaXMgb3V0c2lkZSBzcGVjaWZpZWQgdGFibGUgc2l6ZS4iKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfY2hrUigkYVJvdykgewogICAgICAgIGlmKCAhICR0aGlzLT5pSW5pdCApIHsKICAgICAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZSgyNzAxNCk7IC8vIFRhYmxlIG5vdCBpbml0aWFsaXplZAogICAgICAgIH0KICAgICAgICBpZiggJGFSb3cgPCAwIHx8ICRhUm93ID49ICR0aGlzLT5pU2l6ZVswXSApCiAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoMjcwMDcsJGFSb3cpOwogICAgICAgIC8vKCJHVGV4dFRhYmxlOlxuUm93IGFyZ3VtZW50ICgkYVJvdykgaXMgb3V0c2lkZSBzcGVjaWZpZWQgdGFibGUgc2l6ZS4iKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfZ2V0U2NhbGVQb3MoKSB7CiAgICAgICAgaWYoICR0aGlzLT5pU2NhbGVYUG9zID09PSBudWxsIHx8ICR0aGlzLT5pU2NhbGVZUG9zID09PSBudWxsICkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJldHVybiBhcnJheSgkdGhpcy0+aVNjYWxlWFBvcywgJHRoaXMtPmlTY2FsZVlQb3MpOwogICAgfQoKICAgIGZ1bmN0aW9uIF9hdXRvU2l6ZVRhYmxlKCRhSW1nKSB7CiAgICAgICAgLy8gR2V0IG1heGltdW0gY29sdW1uIHdpZHRoIGFuZCByb3cgaGVpZ2h0CiAgICAgICAgJG0gPSAkdGhpcy0+aVNpemVbMF07CiAgICAgICAgJG4gPSAkdGhpcy0+aVNpemVbMV07CiAgICAgICAgJHc9MTskaD0xOwoKICAgICAgICAvLyBHZXQgbWF4aW11bSByb3cgaGVpZ2h0IHBlciByb3cKICAgICAgICBmb3IoJGk9MDsgJGkgPCAkbTsgKyskaSkgewogICAgICAgICAgICAkaD0wOwogICAgICAgICAgICBmb3IoJGo9MDsgJGogPCAkbjsgKyskaikgewogICAgICAgICAgICAgICAgJGggPSBtYXgoJGgsJHRoaXMtPmlDZWxsc1skaV1bJGpdLT5HZXRIZWlnaHQoJGFJbWcpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiggaXNzZXQoJHRoaXMtPmlSb3dIZWlnaHRbJGldKSApIHsKICAgICAgICAgICAgICAgICR0aGlzLT5pUm93SGVpZ2h0WyRpXSAgPSBtYXgoJGgsJHRoaXMtPmlSb3dIZWlnaHRbJGldKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICR0aGlzLT5pUm93SGVpZ2h0WyRpXSAgPSAkaDsKICAgICAgICB9CgogICAgICAgIC8vIEdldCBtYXhpbXVtIGNvbCB3aWR0aCBwZXIgY29sdW1ucwogICAgICAgIGZvcigkaj0wOyAkaiA8ICRuOyArKyRqKSB7CiAgICAgICAgICAgICR3PTA7CiAgICAgICAgICAgIGZvcigkaT0wOyAkaSA8ICRtOyArKyRpKSB7CiAgICAgICAgICAgICAgICAkdyA9IG1heCgkdywkdGhpcy0+aUNlbGxzWyRpXVskal0tPkdldFdpZHRoKCRhSW1nKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoIGlzc2V0KCR0aGlzLT5pQ29sV2lkdGhbJGpdKSApIHsKICAgICAgICAgICAgICAgICR0aGlzLT5pQ29sV2lkdGhbJGpdICA9IG1heCgkdywkdGhpcy0+aUNvbFdpZHRoWyRqXSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAkdGhpcy0+aUNvbFdpZHRoWyRqXSAgPSAkdzsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gX3NldGNlbGwoJGFSb3csJGFDb2wsJGFWYWw9JycpIHsKICAgICAgICBpZiggaXNzZXQoJHRoaXMtPmlDZWxsc1skYVJvd11bJGFDb2xdKSApIHsKICAgICAgICAgICAgJHRoaXMtPmlDZWxsc1skYVJvd11bJGFDb2xdLT5TZXQoJGFWYWwpOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJHRoaXMtPmlDZWxsc1skYVJvd11bJGFDb2xdID0gbmV3IEdUZXh0VGFibGVDZWxsKChzdHJpbmcpJGFWYWwsJGFSb3csJGFDb2wpOwogICAgICAgICAgICAkdGhpcy0+aUNlbGxzWyRhUm93XVskYUNvbF0tPkluaXQoJHRoaXMpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBTdHJva2VXaXRoU2NhbGUoJGFJbWcsJGFYU2NhbGUsJGFZU2NhbGUpIHsKICAgICAgICBpZiggaXNfbnVtZXJpYygkdGhpcy0+aVNjYWxlWFBvcykgJiYgaXNfbnVtZXJpYygkdGhpcy0+aVNjYWxlWVBvcykgKSB7CiAgICAgICAgICAgICR4ID0gcm91bmQoJGFYU2NhbGUtPlRyYW5zbGF0ZSgkdGhpcy0+aVNjYWxlWFBvcykpOwogICAgICAgICAgICAkeSA9IHJvdW5kKCRhWVNjYWxlLT5UcmFuc2xhdGUoJHRoaXMtPmlTY2FsZVlQb3MpKTsKICAgICAgICAgICAgJHRoaXMtPlN0cm9rZSgkYUltZywkeCwkeSk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAkdGhpcy0+U3Ryb2tlKCRhSW1nKTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gU3Ryb2tlKCRhSW1nLCRhWD1OVUxMLCRhWT1OVUxMKSB7CiAgICAgICAgaWYoICRhWCAhPT0gTlVMTCAmJiAkYVkgIT09IE5VTEwgKSB7CiAgICAgICAgICAgICR0aGlzLT5pWFBvcyA9ICRhWDsKICAgICAgICAgICAgJHRoaXMtPmlZUG9zID0gJGFZOwogICAgICAgIH0KCiAgICAgICAgJHJjID0gJHRoaXMtPmlTaXplWzBdOyAvLyByb3cgY291bnQKICAgICAgICAkY2MgPSAkdGhpcy0+aVNpemVbMV07IC8vIGNvbHVtbiBjb3VudAoKICAgICAgICBpZiggJHJjID09IDAgfHwgJGNjID09IDAgKSB7CiAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDI3MDA5KTsKICAgICAgICB9CgogICAgICAgIC8vIEFkanVzdCBtYXJnaW5zIG9mIGVhY2ggY2VsbCBiYXNlZCBvbiB0aGUgd2VpZ2h0IG9mIHRoZSBncmlkLiBFYWNoIHRhYmxlIGdyaWQgbGluZQogICAgICAgIC8vIGlzIGFjdHVhbGx5IG9jY3VweWluZyB0aGUgbGVmdCBzaWRlIGFuZCB0b3AgcGFydCBvZiBlYWNoIGNlbGwuCiAgICAgICAgZm9yKCRqPTA7ICRqIDwgJGNjOyArKyRqKSB7CiAgICAgICAgICAgICR0aGlzLT5pQ2VsbHNbMF1bJGpdLT5pTWFyZ2luVG9wICs9ICR0aGlzLT5pQm9yZGVyV2VpZ2h0OwogICAgICAgIH0KICAgICAgICBmb3IoJGk9MDsgJGkgPCAkcmM7ICsrJGkpIHsKICAgICAgICAgICAgJHRoaXMtPmlDZWxsc1skaV1bMF0tPmlNYXJnaW5MZWZ0ICs9ICR0aGlzLT5pQm9yZGVyV2VpZ2h0OwogICAgICAgIH0KICAgICAgICBmb3IoJGk9MDsgJGkgPCAkcmM7ICsrJGkpIHsKICAgICAgICAgICAgZm9yKCRqPTA7ICRqIDwgJGNjOyArKyRqKSB7CiAgICAgICAgICAgICAgICAkdGhpcy0+aUNlbGxzWyRpXVskal0tPkFkanVzdE1hcmdpbnNGb3JHcmlkKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIGFkanVzdCByb3cgYW5kIGNvbHVtbiBzaXplIGRlcGVuZGluZyBvbiBjZWxsIGNvbnRlbnQKICAgICAgICAkdGhpcy0+X2F1dG9TaXplVGFibGUoJGFJbWcpOwoKICAgICAgICBpZiggJHRoaXMtPmlTaXplWzFdICE9IGNvdW50KCR0aGlzLT5pQ29sV2lkdGgpIHx8ICR0aGlzLT5pU2l6ZVswXSAhPSBjb3VudCgkdGhpcy0+aVJvd0hlaWdodCkgKSB7CiAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDI3MDA4KTsKICAgICAgICAgICAgLy8oJ0NvbHVtbiBhbmQgcm93IHNpemUgYXJyYXlzIG11c3QgbWF0Y2ggdGhlIGRpbWVzbmlvbnMgb2YgdGhlIHRhYmxlJyk7CiAgICAgICAgfQoKICAgICAgICAvLyBGaW5kIG91dCBvdmVyYWxsIHRhYmxlIHNpemUKICAgICAgICAkd2lkdGg9MDsKICAgICAgICBmb3IoJGk9MDsgJGkgPCAkY2M7ICsrJGkpIHsKICAgICAgICAgICAgJHdpZHRoICs9ICR0aGlzLT5pQ29sV2lkdGhbJGldOwogICAgICAgIH0KICAgICAgICAkaGVpZ2h0PTA7CiAgICAgICAgZm9yKCRpPTA7ICRpIDwgJHJjOyArKyRpKSB7CiAgICAgICAgICAgICRoZWlnaHQgKz0gJHRoaXMtPmlSb3dIZWlnaHRbJGldOwogICAgICAgIH0KCiAgICAgICAgLy8gQWRqdXN0IHRoZSBYLFkgcG9zaXRpb24gdG8gYWx3YXkgYmUgYXQgdGhlIHRvcCBsZWZ0IGNvcm5lcgogICAgICAgIC8vIFRoZSBhbmNob3IgcG9zaXRpb24sIGkuZS4gaG93IHRoZSBjbGllbnQgd2FudCB0byBpbnRlcnByZXQgdGhlIHNwZWNpZmllZAogICAgICAgIC8vIHggYW5kIHkgY29vcmRpbmF0ZSBtdXN0IGJlIHRha2VuIGludG8gYWNjb3VudAogICAgICAgIHN3aXRjaCggc3RydG9sb3dlcigkdGhpcy0+aVhBbmNob3IpICkgewogICAgICAgICAgICBjYXNlICdsZWZ0JyA6CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnY2VudGVyJzoKICAgICAgICAgICAgICAgICR0aGlzLT5pWFBvcyAtPSByb3VuZCgkd2lkdGgvMik7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAncmlnaHQnOgogICAgICAgICAgICAgICAgJHRoaXMtPmlYUG9zIC09ICR3aWR0aDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICBzd2l0Y2goIHN0cnRvbG93ZXIoJHRoaXMtPmlZQW5jaG9yKSApIHsKICAgICAgICAgICAgY2FzZSAndG9wJyA6CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnY2VudGVyJzoKICAgICAgICAgICAgY2FzZSAnbWlkZGxlJzoKICAgICAgICAgICAgICAgICR0aGlzLT5pWVBvcyAtPSByb3VuZCgkaGVpZ2h0LzIpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJ2JvdHRvbSc6CiAgICAgICAgICAgICAgICAkdGhpcy0+aVlQb3MgLT0gJGhlaWdodDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KCiAgICAgICAgLy8gU2V0IHRoZSBvdmVyYWxsIGJhY2tncm91bmQgY29sb3Igb2YgdGhlIHRhYmxlIGlmIHNldAogICAgICAgIGlmKCAkdGhpcy0+aUJHQ29sb3IgIT09ICcnICkgewogICAgICAgICAgICAkYUltZy0+U2V0Q29sb3IoJHRoaXMtPmlCR0NvbG9yKTsKICAgICAgICAgICAgJGFJbWctPkZpbGxlZFJlY3RhbmdsZSgkdGhpcy0+aVhQb3MsJHRoaXMtPmlZUG9zLCR0aGlzLT5pWFBvcyskd2lkdGgsJHRoaXMtPmlZUG9zKyRoZWlnaHQpOwogICAgICAgIH0KCiAgICAgICAgLy8gU3Ryb2tlIGFsbCBjZWxscwogICAgICAgICRycG9zPSR0aGlzLT5pWVBvczsKICAgICAgICBmb3IoJGk9MDsgJGkgPCAkcmM7ICsrJGkpIHsKICAgICAgICAgICAgJGNwb3M9JHRoaXMtPmlYUG9zOwogICAgICAgICAgICBmb3IoJGo9MDsgJGogPCAkY2M7ICsrJGopIHsKICAgICAgICAgICAgICAgIC8vIENhbGN1bGF0ZSB3aWR0aCBhbmQgaGVpZ2h0IG9mIHRoaXMgY2VsbCBpZiBpdCBpcyBzcGFubmluZwogICAgICAgICAgICAgICAgLy8gbW9yZSB0aGFuIG9uZSBjb2x1bW4gb3Igcm93CiAgICAgICAgICAgICAgICAkY3dpZHRoPTA7CiAgICAgICAgICAgICAgICBmb3IoICRrPTA7ICRrIDwgJHRoaXMtPmlDZWxsc1skaV1bJGpdLT5pQ29sU3BhbjsgKyskayApIHsKICAgICAgICAgICAgICAgICAgICAkY3dpZHRoICs9ICR0aGlzLT5pQ29sV2lkdGhbJGorJGtdOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJGNoZWlnaHQ9MDsKICAgICAgICAgICAgICAgIGZvciggJGs9MDsgJGsgPCAkdGhpcy0+aUNlbGxzWyRpXVskal0tPmlSb3dTcGFuOyArKyRrICkgewogICAgICAgICAgICAgICAgICAgICRjaGVpZ2h0ICs9ICR0aGlzLT5pUm93SGVpZ2h0WyRpKyRrXTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkdGhpcy0+aUNlbGxzWyRpXVskal0tPlN0cm9rZSgkYUltZywkY3BvcywkcnBvcywkY3dpZHRoLCRjaGVpZ2h0KTsKICAgICAgICAgICAgICAgICRjcG9zICs9ICR0aGlzLT5pQ29sV2lkdGhbJGpdOwogICAgICAgICAgICB9CiAgICAgICAgICAgICRycG9zICs9ICR0aGlzLT5pUm93SGVpZ2h0WyRpXTsKICAgICAgICB9CgogICAgICAgIC8vIFN0cm9rZSBvdXRlciBib3JkZXIKICAgICAgICAkYUltZy0+U2V0Q29sb3IoJHRoaXMtPmlCb3JkZXJDb2xvcik7CiAgICAgICAgaWYoICR0aGlzLT5pQm9yZGVyV2VpZ2h0ID09IDEgKQogICAgICAgICRhSW1nLT5SZWN0YW5nbGUoJHRoaXMtPmlYUG9zLCR0aGlzLT5pWVBvcywkdGhpcy0+aVhQb3MrJHdpZHRoLCR0aGlzLT5pWVBvcyskaGVpZ2h0KTsKICAgICAgICBlbHNlIHsKICAgICAgICAgICAgZm9yKCAkaT0wOyAkaSA8ICR0aGlzLT5pQm9yZGVyV2VpZ2h0OyArKyRpICkKICAgICAgICAgICAgJGFJbWctPlJlY3RhbmdsZSgkdGhpcy0+aVhQb3MrJGksJHRoaXMtPmlZUG9zKyRpLAogICAgICAgICAgICAkdGhpcy0+aVhQb3MrJHdpZHRoLTErJHRoaXMtPmlCb3JkZXJXZWlnaHQtJGksCiAgICAgICAgICAgICR0aGlzLT5pWVBvcyskaGVpZ2h0LTErJHRoaXMtPmlCb3JkZXJXZWlnaHQtJGkpOwogICAgICAgIH0KICAgIH0KfQoKLyoKIEVPRgogKi8KPz4K",
    "size": "48102"
}