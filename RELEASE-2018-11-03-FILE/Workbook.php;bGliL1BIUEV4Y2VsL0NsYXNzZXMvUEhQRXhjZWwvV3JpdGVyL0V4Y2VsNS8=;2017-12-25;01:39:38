{
    "namaFile": "lib\/PHPExcel\/Classes\/PHPExcel\/Writer\/Excel5\/Workbook.php",
    "lastUpdate": "2017-12-25+01:39:38.00",
    "contentFile": "PD9waHAKCi8qKgogKiBQSFBFeGNlbF9Xcml0ZXJfRXhjZWw1X1dvcmtib29rCiAqCiAqIENvcHlyaWdodCAoYykgMjAwNiAtIDIwMTUgUEhQRXhjZWwKICoKICogVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgogKiBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCiAqIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlcgogKiB2ZXJzaW9uIDIuMSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KICoKICogVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCiAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCiAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VCiAqIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCiAqCiAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKICogTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZQogKiBGb3VuZGF0aW9uLCBJbmMuLCA1MSBGcmFua2xpbiBTdHJlZXQsIEZpZnRoIEZsb29yLCBCb3N0b24sIE1BICAwMjExMC0xMzAxICBVU0EKICoKICogQGNhdGVnb3J5ICAgUEhQRXhjZWwKICogQHBhY2thZ2UgICAgUEhQRXhjZWxfV3JpdGVyX0V4Y2VsNQogKiBAY29weXJpZ2h0ICBDb3B5cmlnaHQgKGMpIDIwMDYgLSAyMDE1IFBIUEV4Y2VsIChodHRwOi8vd3d3LmNvZGVwbGV4LmNvbS9QSFBFeGNlbCkKICogQGxpY2Vuc2UgICAgaHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL29sZC1saWNlbnNlcy9sZ3BsLTIuMS50eHQgICAgTEdQTAogKiBAdmVyc2lvbiAgICAjI1ZFUlNJT04jIywgIyNEQVRFIyMKICovCgovLyBPcmlnaW5hbCBmaWxlIGhlYWRlciBvZiBQRUFSOjpTcHJlYWRzaGVldF9FeGNlbF9Xcml0ZXJfV29ya2Jvb2sgKHVzZWQgYXMgdGhlIGJhc2UgZm9yIHRoaXMgY2xhc3MpOgovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLyAvKgovLyAqICBNb2R1bGUgd3JpdHRlbi9wb3J0ZWQgYnkgWGF2aWVyIE5vZ3VlciA8eG5vZ3VlckByZXplYnJhLmNvbT4KLy8gKgovLyAqICBUaGUgbWFqb3JpdHkgb2YgdGhpcyBpcyBfTk9UXyBteSBjb2RlLiAgSSBzaW1wbHkgcG9ydGVkIGl0IGZyb20gdGhlCi8vICogIFBFUkwgU3ByZWFkc2hlZXQ6OldyaXRlRXhjZWwgbW9kdWxlLgovLyAqCi8vICogIFRoZSBhdXRob3Igb2YgdGhlIFNwcmVhZHNoZWV0OjpXcml0ZUV4Y2VsIG1vZHVsZSBpcyBKb2huIE1jTmFtYXJhCi8vICogIDxqbWNuYW1hcmFAY3Bhbi5vcmc+Ci8vICoKLy8gKiAgSSBfRE9fIG1haW50YWluIHRoaXMgY29kZSwgYW5kIEpvaG4gTWNOYW1hcmEgaGFzIG5vdGhpbmcgdG8gZG8gd2l0aCB0aGUKLy8gKiAgcG9ydGluZyBvZiB0aGlzIGNvZGUgdG8gUEhQLiAgQW55IHF1ZXN0aW9ucyBkaXJlY3RseSByZWxhdGVkIHRvIHRoaXMKLy8gKiAgY2xhc3MgbGlicmFyeSBzaG91bGQgYmUgZGlyZWN0ZWQgdG8gbWUuCi8vICoKLy8gKiAgTGljZW5zZSBJbmZvcm1hdGlvbjoKLy8gKgovLyAqICAgIFNwcmVhZHNoZWV0X0V4Y2VsX1dyaXRlcjogIEEgbGlicmFyeSBmb3IgZ2VuZXJhdGluZyBFeGNlbCBTcHJlYWRzaGVldHMKLy8gKiAgICBDb3B5cmlnaHQgKGMpIDIwMDItMjAwMyBYYXZpZXIgTm9ndWVyIHhub2d1ZXJAcmV6ZWJyYS5jb20KLy8gKgovLyAqICAgIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKLy8gKiAgICBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCi8vICogICAgTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyCi8vICogICAgdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCi8vICoKLy8gKiAgICBUaGlzIGxpYnJhcnkgaXMgZGlzdHJpYnV0ZWQgaW4gdGhlIGhvcGUgdGhhdCBpdCB3aWxsIGJlIHVzZWZ1bCwKLy8gKiAgICBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgovLyAqICAgIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VCi8vICogICAgTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KLy8gKgovLyAqICAgIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKLy8gKiAgICBMaWNlbnNlIGFsb25nIHdpdGggdGhpcyBsaWJyYXJ5OyBpZiBub3QsIHdyaXRlIHRvIHRoZSBGcmVlIFNvZnR3YXJlCi8vICogICAgRm91bmRhdGlvbiwgSW5jLiwgNTkgVGVtcGxlIFBsYWNlLCBTdWl0ZSAzMzAsIEJvc3RvbiwgTUEgIDAyMTExLTEzMDcgIFVTQQovLyAqLwpjbGFzcyBQSFBFeGNlbF9Xcml0ZXJfRXhjZWw1X1dvcmtib29rIGV4dGVuZHMgUEhQRXhjZWxfV3JpdGVyX0V4Y2VsNV9CSUZGd3JpdGVyCnsKICAgIC8qKgogICAgICogRm9ybXVsYSBwYXJzZXIKICAgICAqCiAgICAgKiBAdmFyIFBIUEV4Y2VsX1dyaXRlcl9FeGNlbDVfUGFyc2VyCiAgICAgKi8KICAgIHByaXZhdGUgJHBhcnNlcjsKCiAgICAvKioKICAgICAqIFRoZSBCSUZGIGZpbGUgc2l6ZSBmb3IgdGhlIHdvcmtib29rLgogICAgICogQHZhciBpbnRlZ2VyCiAgICAgKiBAc2VlIGNhbGNTaGVldE9mZnNldHMoKQogICAgICovCiAgICBwcml2YXRlICRiaWZmU2l6ZTsKCiAgICAvKioKICAgICAqIFhGIFdyaXRlcnMKICAgICAqIEB2YXIgUEhQRXhjZWxfV3JpdGVyX0V4Y2VsNV9YZltdCiAgICAgKi8KICAgIHByaXZhdGUgJHhmV3JpdGVycyA9IGFycmF5KCk7CgogICAgLyoqCiAgICAgKiBBcnJheSBjb250YWluaW5nIHRoZSBjb2xvdXIgcGFsZXR0ZQogICAgICogQHZhciBhcnJheQogICAgICovCiAgICBwcml2YXRlICRwYWxldHRlOwoKICAgIC8qKgogICAgICogVGhlIGNvZGVwYWdlIGluZGljYXRlcyB0aGUgdGV4dCBlbmNvZGluZyB1c2VkIGZvciBzdHJpbmdzCiAgICAgKiBAdmFyIGludGVnZXIKICAgICAqLwogICAgcHJpdmF0ZSAkY29kZXBhZ2U7CgogICAgLyoqCiAgICAgKiBUaGUgY291bnRyeSBjb2RlIHVzZWQgZm9yIGxvY2FsaXphdGlvbgogICAgICogQHZhciBpbnRlZ2VyCiAgICAgKi8KICAgIHByaXZhdGUgJGNvdW50cnlDb2RlOwoKICAgIC8qKgogICAgICogV29ya2Jvb2sKICAgICAqIEB2YXIgUEhQRXhjZWwKICAgICAqLwogICAgcHJpdmF0ZSAkcGhwRXhjZWw7CgogICAgLyoqCiAgICAgKiBGb250cyB3cml0ZXJzCiAgICAgKgogICAgICogQHZhciBQSFBFeGNlbF9Xcml0ZXJfRXhjZWw1X0ZvbnRbXQogICAgICovCiAgICBwcml2YXRlICRmb250V3JpdGVycyA9IGFycmF5KCk7CgogICAgLyoqCiAgICAgKiBBZGRlZCBmb250cy4gTWFwcyBmcm9tIGZvbnQncyBoYXNoID0+IGluZGV4IGluIHdvcmtib29rCiAgICAgKgogICAgICogQHZhciBhcnJheQogICAgICovCiAgICBwcml2YXRlICRhZGRlZEZvbnRzID0gYXJyYXkoKTsKCiAgICAvKioKICAgICAqIFNoYXJlZCBudW1iZXIgZm9ybWF0cwogICAgICoKICAgICAqIEB2YXIgYXJyYXkKICAgICAqLwogICAgcHJpdmF0ZSAkbnVtYmVyRm9ybWF0cyA9IGFycmF5KCk7CgogICAgLyoqCiAgICAgKiBBZGRlZCBudW1iZXIgZm9ybWF0cy4gTWFwcyBmcm9tIG51bWJlckZvcm1hdCdzIGhhc2ggPT4gaW5kZXggaW4gd29ya2Jvb2sKICAgICAqCiAgICAgKiBAdmFyIGFycmF5CiAgICAgKi8KICAgIHByaXZhdGUgJGFkZGVkTnVtYmVyRm9ybWF0cyA9IGFycmF5KCk7CgogICAgLyoqCiAgICAgKiBTaXplcyBvZiB0aGUgYmluYXJ5IHdvcmtzaGVldCBzdHJlYW1zCiAgICAgKgogICAgICogQHZhciBhcnJheQogICAgICovCiAgICBwcml2YXRlICR3b3Jrc2hlZXRTaXplcyA9IGFycmF5KCk7CgogICAgLyoqCiAgICAgKiBPZmZzZXRzIG9mIHRoZSBiaW5hcnkgd29ya3NoZWV0IHN0cmVhbXMgcmVsYXRpdmUgdG8gdGhlIHN0YXJ0IG9mIHRoZSBnbG9iYWwgd29ya2Jvb2sgc3RyZWFtCiAgICAgKgogICAgICogQHZhciBhcnJheQogICAgICovCiAgICBwcml2YXRlICR3b3Jrc2hlZXRPZmZzZXRzID0gYXJyYXkoKTsKCiAgICAvKioKICAgICAqIFRvdGFsIG51bWJlciBvZiBzaGFyZWQgc3RyaW5ncyBpbiB3b3JrYm9vawogICAgICoKICAgICAqIEB2YXIgaW50CiAgICAgKi8KICAgIHByaXZhdGUgJHN0cmluZ1RvdGFsOwoKICAgIC8qKgogICAgICogTnVtYmVyIG9mIHVuaXF1ZSBzaGFyZWQgc3RyaW5ncyBpbiB3b3JrYm9vawogICAgICoKICAgICAqIEB2YXIgaW50CiAgICAgKi8KICAgIHByaXZhdGUgJHN0cmluZ1VuaXF1ZTsKCiAgICAvKioKICAgICAqIEFycmF5IG9mIHVuaXF1ZSBzaGFyZWQgc3RyaW5ncyBpbiB3b3JrYm9vawogICAgICoKICAgICAqIEB2YXIgYXJyYXkKICAgICAqLwogICAgcHJpdmF0ZSAkc3RyaW5nVGFibGU7CgogICAgLyoqCiAgICAgKiBDb2xvciBjYWNoZQogICAgICovCiAgICBwcml2YXRlICRjb2xvcnM7CgogICAgLyoqCiAgICAgKiBFc2NoZXIgb2JqZWN0IGNvcnJlc3BvbmRpbmcgdG8gTVNPRFJBV0lOR0dST1VQCiAgICAgKgogICAgICogQHZhciBQSFBFeGNlbF9TaGFyZWRfRXNjaGVyCiAgICAgKi8KICAgIHByaXZhdGUgJGVzY2hlcjsKCgogICAgLyoqCiAgICAgKiBDbGFzcyBjb25zdHJ1Y3RvcgogICAgICoKICAgICAqIEBwYXJhbSBQSFBFeGNlbCAgICAkcGhwRXhjZWwgICAgICAgIFRoZSBXb3JrYm9vawogICAgICogQHBhcmFtIGludCAgICAgICAgJiRzdHJfdG90YWwgICAgICAgIFRvdGFsIG51bWJlciBvZiBzdHJpbmdzCiAgICAgKiBAcGFyYW0gaW50ICAgICAgICAmJHN0cl91bmlxdWUgICAgVG90YWwgbnVtYmVyIG9mIHVuaXF1ZSBzdHJpbmdzCiAgICAgKiBAcGFyYW0gYXJyYXkgICAgICAgICYkc3RyX3RhYmxlICAgICAgICBTdHJpbmcgVGFibGUKICAgICAqIEBwYXJhbSBhcnJheSAgICAgICAgJiRjb2xvcnMgICAgICAgIENvbG91ciBUYWJsZQogICAgICogQHBhcmFtIG1peGVkICAgICAgICAkcGFyc2VyICAgICAgICAgICAgVGhlIGZvcm11bGEgcGFyc2VyIGNyZWF0ZWQgZm9yIHRoZSBXb3JrYm9vawogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gX19jb25zdHJ1Y3QoUEhQRXhjZWwgJHBocEV4Y2VsID0gbnVsbCwgJiRzdHJfdG90YWwsICYkc3RyX3VuaXF1ZSwgJiRzdHJfdGFibGUsICYkY29sb3JzLCAkcGFyc2VyKQogICAgewogICAgICAgIC8vIEl0IG5lZWRzIHRvIGNhbGwgaXRzIHBhcmVudCdzIGNvbnN0cnVjdG9yIGV4cGxpY2l0bHkKICAgICAgICBwYXJlbnQ6Ol9fY29uc3RydWN0KCk7CgogICAgICAgICR0aGlzLT5wYXJzZXIgICAgICAgID0gJHBhcnNlcjsKICAgICAgICAkdGhpcy0+YmlmZlNpemUgICAgID0gMDsKICAgICAgICAkdGhpcy0+cGFsZXR0ZSAgICAgID0gYXJyYXkoKTsKICAgICAgICAkdGhpcy0+Y291bnRyeUNvZGUgPSAtMTsKCiAgICAgICAgJHRoaXMtPnN0cmluZ1RvdGFsICAgICAgPSAmJHN0cl90b3RhbDsKICAgICAgICAkdGhpcy0+c3RyaW5nVW5pcXVlICAgICA9ICYkc3RyX3VuaXF1ZTsKICAgICAgICAkdGhpcy0+c3RyaW5nVGFibGUgICAgICA9ICYkc3RyX3RhYmxlOwogICAgICAgICR0aGlzLT5jb2xvcnMgICAgICAgID0gJiRjb2xvcnM7CiAgICAgICAgJHRoaXMtPnNldFBhbGV0dGVYbDk3KCk7CgogICAgICAgICR0aGlzLT5waHBFeGNlbCA9ICRwaHBFeGNlbDsKCiAgICAgICAgLy8gc2V0IEJJRkZ3cml0ZXIgbGltaXQgZm9yIENPTlRJTlVFIHJlY29yZHMKICAgICAgICAvLyAgICAgICAgJHRoaXMtPl9saW1pdCA9IDgyMjQ7CiAgICAgICAgJHRoaXMtPmNvZGVwYWdlID0gMHgwNEIwOwoKICAgICAgICAvLyBBZGQgZW1wdHkgc2hlZXRzIGFuZCBCdWlsZCBjb2xvciBjYWNoZQogICAgICAgICRjb3VudFNoZWV0cyA9ICRwaHBFeGNlbC0+Z2V0U2hlZXRDb3VudCgpOwogICAgICAgIGZvciAoJGkgPSAwOyAkaSA8ICRjb3VudFNoZWV0czsgKyskaSkgewogICAgICAgICAgICAkcGhwU2hlZXQgPSAkcGhwRXhjZWwtPmdldFNoZWV0KCRpKTsKCiAgICAgICAgICAgICR0aGlzLT5wYXJzZXItPnNldEV4dFNoZWV0KCRwaHBTaGVldC0+Z2V0VGl0bGUoKSwgJGkpOyAgLy8gUmVnaXN0ZXIgd29ya3NoZWV0IG5hbWUgd2l0aCBwYXJzZXIKCiAgICAgICAgICAgICRzdXBib29rX2luZGV4ID0gMHgwMDsKICAgICAgICAgICAgJHJlZiA9IHBhY2soJ3Z2dicsICRzdXBib29rX2luZGV4LCAkaSwgJGkpOwogICAgICAgICAgICAkdGhpcy0+cGFyc2VyLT5yZWZlcmVuY2VzW10gPSAkcmVmOyAgLy8gUmVnaXN0ZXIgcmVmZXJlbmNlIHdpdGggcGFyc2VyCgogICAgICAgICAgICAvLyBTaGVldCB0YWIgY29sb3JzPwogICAgICAgICAgICBpZiAoJHBocFNoZWV0LT5pc1RhYkNvbG9yU2V0KCkpIHsKICAgICAgICAgICAgICAgICR0aGlzLT5hZGRDb2xvcigkcGhwU2hlZXQtPmdldFRhYkNvbG9yKCktPmdldFJHQigpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICB9CgogICAgLyoqCiAgICAgKiBBZGQgYSBuZXcgWEYgd3JpdGVyCiAgICAgKgogICAgICogQHBhcmFtIFBIUEV4Y2VsX1N0eWxlCiAgICAgKiBAcGFyYW0gYm9vbGVhbiBJcyBpdCBhIHN0eWxlIFhGPwogICAgICogQHJldHVybiBpbnQgSW5kZXggdG8gWEYgcmVjb3JkCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBhZGRYZldyaXRlcigkc3R5bGUsICRpc1N0eWxlWGYgPSBmYWxzZSkKICAgIHsKICAgICAgICAkeGZXcml0ZXIgPSBuZXcgUEhQRXhjZWxfV3JpdGVyX0V4Y2VsNV9YZigkc3R5bGUpOwogICAgICAgICR4ZldyaXRlci0+c2V0SXNTdHlsZVhmKCRpc1N0eWxlWGYpOwoKICAgICAgICAvLyBBZGQgdGhlIGZvbnQgaWYgbm90IGFscmVhZHkgYWRkZWQKICAgICAgICAkZm9udEluZGV4ID0gJHRoaXMtPmFkZEZvbnQoJHN0eWxlLT5nZXRGb250KCkpOwoKICAgICAgICAvLyBBc3NpZ24gdGhlIGZvbnQgaW5kZXggdG8gdGhlIHhmIHJlY29yZAogICAgICAgICR4ZldyaXRlci0+c2V0Rm9udEluZGV4KCRmb250SW5kZXgpOwoKICAgICAgICAvLyBCYWNrZ3JvdW5kIGNvbG9ycywgYmVzdCB0byB0cmVhdCB0aGVzZSBhZnRlciB0aGUgZm9udCBzbyBibGFjayB3aWxsIGNvbWUgYWZ0ZXIgd2hpdGUgaW4gY3VzdG9tIHBhbGV0dGUKICAgICAgICAkeGZXcml0ZXItPnNldEZnQ29sb3IoJHRoaXMtPmFkZENvbG9yKCRzdHlsZS0+Z2V0RmlsbCgpLT5nZXRTdGFydENvbG9yKCktPmdldFJHQigpKSk7CiAgICAgICAgJHhmV3JpdGVyLT5zZXRCZ0NvbG9yKCR0aGlzLT5hZGRDb2xvcigkc3R5bGUtPmdldEZpbGwoKS0+Z2V0RW5kQ29sb3IoKS0+Z2V0UkdCKCkpKTsKICAgICAgICAkeGZXcml0ZXItPnNldEJvdHRvbUNvbG9yKCR0aGlzLT5hZGRDb2xvcigkc3R5bGUtPmdldEJvcmRlcnMoKS0+Z2V0Qm90dG9tKCktPmdldENvbG9yKCktPmdldFJHQigpKSk7CiAgICAgICAgJHhmV3JpdGVyLT5zZXRUb3BDb2xvcigkdGhpcy0+YWRkQ29sb3IoJHN0eWxlLT5nZXRCb3JkZXJzKCktPmdldFRvcCgpLT5nZXRDb2xvcigpLT5nZXRSR0IoKSkpOwogICAgICAgICR4ZldyaXRlci0+c2V0UmlnaHRDb2xvcigkdGhpcy0+YWRkQ29sb3IoJHN0eWxlLT5nZXRCb3JkZXJzKCktPmdldFJpZ2h0KCktPmdldENvbG9yKCktPmdldFJHQigpKSk7CiAgICAgICAgJHhmV3JpdGVyLT5zZXRMZWZ0Q29sb3IoJHRoaXMtPmFkZENvbG9yKCRzdHlsZS0+Z2V0Qm9yZGVycygpLT5nZXRMZWZ0KCktPmdldENvbG9yKCktPmdldFJHQigpKSk7CiAgICAgICAgJHhmV3JpdGVyLT5zZXREaWFnQ29sb3IoJHRoaXMtPmFkZENvbG9yKCRzdHlsZS0+Z2V0Qm9yZGVycygpLT5nZXREaWFnb25hbCgpLT5nZXRDb2xvcigpLT5nZXRSR0IoKSkpOwoKICAgICAgICAvLyBBZGQgdGhlIG51bWJlciBmb3JtYXQgaWYgaXQgaXMgbm90IGEgYnVpbHQtaW4gb25lIGFuZCBub3QgYWxyZWFkeSBhZGRlZAogICAgICAgIGlmICgkc3R5bGUtPmdldE51bWJlckZvcm1hdCgpLT5nZXRCdWlsdEluRm9ybWF0Q29kZSgpID09PSBmYWxzZSkgewogICAgICAgICAgICAkbnVtYmVyRm9ybWF0SGFzaENvZGUgPSAkc3R5bGUtPmdldE51bWJlckZvcm1hdCgpLT5nZXRIYXNoQ29kZSgpOwoKICAgICAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5hZGRlZE51bWJlckZvcm1hdHNbJG51bWJlckZvcm1hdEhhc2hDb2RlXSkpIHsKICAgICAgICAgICAgICAgICRudW1iZXJGb3JtYXRJbmRleCA9ICR0aGlzLT5hZGRlZE51bWJlckZvcm1hdHNbJG51bWJlckZvcm1hdEhhc2hDb2RlXTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICRudW1iZXJGb3JtYXRJbmRleCA9IDE2NCArIGNvdW50KCR0aGlzLT5udW1iZXJGb3JtYXRzKTsKICAgICAgICAgICAgICAgICR0aGlzLT5udW1iZXJGb3JtYXRzWyRudW1iZXJGb3JtYXRJbmRleF0gPSAkc3R5bGUtPmdldE51bWJlckZvcm1hdCgpOwogICAgICAgICAgICAgICAgJHRoaXMtPmFkZGVkTnVtYmVyRm9ybWF0c1skbnVtYmVyRm9ybWF0SGFzaENvZGVdID0gJG51bWJlckZvcm1hdEluZGV4OwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgJG51bWJlckZvcm1hdEluZGV4ID0gKGludCkgJHN0eWxlLT5nZXROdW1iZXJGb3JtYXQoKS0+Z2V0QnVpbHRJbkZvcm1hdENvZGUoKTsKICAgICAgICB9CgogICAgICAgIC8vIEFzc2lnbiB0aGUgbnVtYmVyIGZvcm1hdCBpbmRleCB0byB4ZiByZWNvcmQKICAgICAgICAkeGZXcml0ZXItPnNldE51bWJlckZvcm1hdEluZGV4KCRudW1iZXJGb3JtYXRJbmRleCk7CgogICAgICAgICR0aGlzLT54ZldyaXRlcnNbXSA9ICR4ZldyaXRlcjsKCiAgICAgICAgJHhmSW5kZXggPSBjb3VudCgkdGhpcy0+eGZXcml0ZXJzKSAtIDE7CiAgICAgICAgcmV0dXJuICR4ZkluZGV4OwogICAgfQoKICAgIC8qKgogICAgICogQWRkIGEgZm9udCB0byBhZGRlZCBmb250cwogICAgICoKICAgICAqIEBwYXJhbSBQSFBFeGNlbF9TdHlsZV9Gb250ICRmb250CiAgICAgKiBAcmV0dXJuIGludCBJbmRleCB0byBGT05UIHJlY29yZAogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gYWRkRm9udChQSFBFeGNlbF9TdHlsZV9Gb250ICRmb250KQogICAgewogICAgICAgICRmb250SGFzaENvZGUgPSAkZm9udC0+Z2V0SGFzaENvZGUoKTsKICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPmFkZGVkRm9udHNbJGZvbnRIYXNoQ29kZV0pKSB7CiAgICAgICAgICAgICRmb250SW5kZXggPSAkdGhpcy0+YWRkZWRGb250c1skZm9udEhhc2hDb2RlXTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkY291bnRGb250cyA9IGNvdW50KCR0aGlzLT5mb250V3JpdGVycyk7CiAgICAgICAgICAgICRmb250SW5kZXggPSAoJGNvdW50Rm9udHMgPCA0KSA\/ICRjb3VudEZvbnRzIDogJGNvdW50Rm9udHMgKyAxOwoKICAgICAgICAgICAgJGZvbnRXcml0ZXIgPSBuZXcgUEhQRXhjZWxfV3JpdGVyX0V4Y2VsNV9Gb250KCRmb250KTsKICAgICAgICAgICAgJGZvbnRXcml0ZXItPnNldENvbG9ySW5kZXgoJHRoaXMtPmFkZENvbG9yKCRmb250LT5nZXRDb2xvcigpLT5nZXRSR0IoKSkpOwogICAgICAgICAgICAkdGhpcy0+Zm9udFdyaXRlcnNbXSA9ICRmb250V3JpdGVyOwoKICAgICAgICAgICAgJHRoaXMtPmFkZGVkRm9udHNbJGZvbnRIYXNoQ29kZV0gPSAkZm9udEluZGV4OwogICAgICAgIH0KICAgICAgICByZXR1cm4gJGZvbnRJbmRleDsKICAgIH0KCiAgICAvKioKICAgICAqIEFsdGVyIGNvbG9yIHBhbGV0dGUgYWRkaW5nIGEgY3VzdG9tIGNvbG9yCiAgICAgKgogICAgICogQHBhcmFtIHN0cmluZyAkcmdiIEUuZy4gJ0ZGMDBBQScKICAgICAqIEByZXR1cm4gaW50IENvbG9yIGluZGV4CiAgICAgKi8KICAgIHByaXZhdGUgZnVuY3Rpb24gYWRkQ29sb3IoJHJnYikKICAgIHsKICAgICAgICBpZiAoIWlzc2V0KCR0aGlzLT5jb2xvcnNbJHJnYl0pKSB7CiAgICAgICAgICAgIGlmIChjb3VudCgkdGhpcy0+Y29sb3JzKSA8IDU3KSB7CiAgICAgICAgICAgICAgICAvLyB0aGVuIHdlIGFkZCBhIGN1c3RvbSBjb2xvciBhbHRlcmluZyB0aGUgcGFsZXR0ZQogICAgICAgICAgICAgICAgJGNvbG9ySW5kZXggPSA4ICsgY291bnQoJHRoaXMtPmNvbG9ycyk7CiAgICAgICAgICAgICAgICAkdGhpcy0+cGFsZXR0ZVskY29sb3JJbmRleF0gPQogICAgICAgICAgICAgICAgICAgIGFycmF5KAogICAgICAgICAgICAgICAgICAgICAgICBoZXhkZWMoc3Vic3RyKCRyZ2IsIDAsIDIpKSwKICAgICAgICAgICAgICAgICAgICAgICAgaGV4ZGVjKHN1YnN0cigkcmdiLCAyLCAyKSksCiAgICAgICAgICAgICAgICAgICAgICAgIGhleGRlYyhzdWJzdHIoJHJnYiwgNCkpLAogICAgICAgICAgICAgICAgICAgICAgICAwCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICR0aGlzLT5jb2xvcnNbJHJnYl0gPSAkY29sb3JJbmRleDsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIG5vIHJvb20gZm9yIG1vcmUgY3VzdG9tIGNvbG9ycywganVzdCBtYXAgdG8gYmxhY2sKICAgICAgICAgICAgICAgICRjb2xvckluZGV4ID0gMDsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIGZldGNoIGFscmVhZHkgYWRkZWQgY3VzdG9tIGNvbG9yCiAgICAgICAgICAgICRjb2xvckluZGV4ID0gJHRoaXMtPmNvbG9yc1skcmdiXTsKICAgICAgICB9CgogICAgICAgIHJldHVybiAkY29sb3JJbmRleDsKICAgIH0KCiAgICAvKioKICAgICAqIFNldHMgdGhlIGNvbG91ciBwYWxldHRlIHRvIHRoZSBFeGNlbCA5NysgZGVmYXVsdC4KICAgICAqCiAgICAgKiBAYWNjZXNzIHByaXZhdGUKICAgICAqLwogICAgcHJpdmF0ZSBmdW5jdGlvbiBzZXRQYWxldHRlWGw5NygpCiAgICB7CiAgICAgICAgJHRoaXMtPnBhbGV0dGUgPSBhcnJheSgKICAgICAgICAgICAgMHgwOCA9PiBhcnJheSgweDAwLCAweDAwLCAweDAwLCAweDAwKSwKICAgICAgICAgICAgMHgwOSA9PiBhcnJheSgweGZmLCAweGZmLCAweGZmLCAweDAwKSwKICAgICAgICAgICAgMHgwQSA9PiBhcnJheSgweGZmLCAweDAwLCAweDAwLCAweDAwKSwKICAgICAgICAgICAgMHgwQiA9PiBhcnJheSgweDAwLCAweGZmLCAweDAwLCAweDAwKSwKICAgICAgICAgICAgMHgwQyA9PiBhcnJheSgweDAwLCAweDAwLCAweGZmLCAweDAwKSwKICAgICAgICAgICAgMHgwRCA9PiBhcnJheSgweGZmLCAweGZmLCAweDAwLCAweDAwKSwKICAgICAgICAgICAgMHgwRSA9PiBhcnJheSgweGZmLCAweDAwLCAweGZmLCAweDAwKSwKICAgICAgICAgICAgMHgwRiA9PiBhcnJheSgweDAwLCAweGZmLCAweGZmLCAweDAwKSwKICAgICAgICAgICAgMHgxMCA9PiBhcnJheSgweDgwLCAweDAwLCAweDAwLCAweDAwKSwKICAgICAgICAgICAgMHgxMSA9PiBhcnJheSgweDAwLCAweDgwLCAweDAwLCAweDAwKSwKICAgICAgICAgICAgMHgxMiA9PiBhcnJheSgweDAwLCAweDAwLCAweDgwLCAweDAwKSwKICAgICAgICAgICAgMHgxMyA9PiBhcnJheSgweDgwLCAweDgwLCAweDAwLCAweDAwKSwKICAgICAgICAgICAgMHgxNCA9PiBhcnJheSgweDgwLCAweDAwLCAweDgwLCAweDAwKSwKICAgICAgICAgICAgMHgxNSA9PiBhcnJheSgweDAwLCAweDgwLCAweDgwLCAweDAwKSwKICAgICAgICAgICAgMHgxNiA9PiBhcnJheSgweGMwLCAweGMwLCAweGMwLCAweDAwKSwKICAgICAgICAgICAgMHgxNyA9PiBhcnJheSgweDgwLCAweDgwLCAweDgwLCAweDAwKSwKICAgICAgICAgICAgMHgxOCA9PiBhcnJheSgweDk5LCAweDk5LCAweGZmLCAweDAwKSwKICAgICAgICAgICAgMHgxOSA9PiBhcnJheSgweDk5LCAweDMzLCAweDY2LCAweDAwKSwKICAgICAgICAgICAgMHgxQSA9PiBhcnJheSgweGZmLCAweGZmLCAweGNjLCAweDAwKSwKICAgICAgICAgICAgMHgxQiA9PiBhcnJheSgweGNjLCAweGZmLCAweGZmLCAweDAwKSwKICAgICAgICAgICAgMHgxQyA9PiBhcnJheSgweDY2LCAweDAwLCAweDY2LCAweDAwKSwKICAgICAgICAgICAgMHgxRCA9PiBhcnJheSgweGZmLCAweDgwLCAweDgwLCAweDAwKSwKICAgICAgICAgICAgMHgxRSA9PiBhcnJheSgweDAwLCAweDY2LCAweGNjLCAweDAwKSwKICAgICAgICAgICAgMHgxRiA9PiBhcnJheSgweGNjLCAweGNjLCAweGZmLCAweDAwKSwKICAgICAgICAgICAgMHgyMCA9PiBhcnJheSgweDAwLCAweDAwLCAweDgwLCAweDAwKSwKICAgICAgICAgICAgMHgyMSA9PiBhcnJheSgweGZmLCAweDAwLCAweGZmLCAweDAwKSwKICAgICAgICAgICAgMHgyMiA9PiBhcnJheSgweGZmLCAweGZmLCAweDAwLCAweDAwKSwKICAgICAgICAgICAgMHgyMyA9PiBhcnJheSgweDAwLCAweGZmLCAweGZmLCAweDAwKSwKICAgICAgICAgICAgMHgyNCA9PiBhcnJheSgweDgwLCAweDAwLCAweDgwLCAweDAwKSwKICAgICAgICAgICAgMHgyNSA9PiBhcnJheSgweDgwLCAweDAwLCAweDAwLCAweDAwKSwKICAgICAgICAgICAgMHgyNiA9PiBhcnJheSgweDAwLCAweDgwLCAweDgwLCAweDAwKSwKICAgICAgICAgICAgMHgyNyA9PiBhcnJheSgweDAwLCAweDAwLCAweGZmLCAweDAwKSwKICAgICAgICAgICAgMHgyOCA9PiBhcnJheSgweDAwLCAweGNjLCAweGZmLCAweDAwKSwKICAgICAgICAgICAgMHgyOSA9PiBhcnJheSgweGNjLCAweGZmLCAweGZmLCAweDAwKSwKICAgICAgICAgICAgMHgyQSA9PiBhcnJheSgweGNjLCAweGZmLCAweGNjLCAweDAwKSwKICAgICAgICAgICAgMHgyQiA9PiBhcnJheSgweGZmLCAweGZmLCAweDk5LCAweDAwKSwKICAgICAgICAgICAgMHgyQyA9PiBhcnJheSgweDk5LCAweGNjLCAweGZmLCAweDAwKSwKICAgICAgICAgICAgMHgyRCA9PiBhcnJheSgweGZmLCAweDk5LCAweGNjLCAweDAwKSwKICAgICAgICAgICAgMHgyRSA9PiBhcnJheSgweGNjLCAweDk5LCAweGZmLCAweDAwKSwKICAgICAgICAgICAgMHgyRiA9PiBhcnJheSgweGZmLCAweGNjLCAweDk5LCAweDAwKSwKICAgICAgICAgICAgMHgzMCA9PiBhcnJheSgweDMzLCAweDY2LCAweGZmLCAweDAwKSwKICAgICAgICAgICAgMHgzMSA9PiBhcnJheSgweDMzLCAweGNjLCAweGNjLCAweDAwKSwKICAgICAgICAgICAgMHgzMiA9PiBhcnJheSgweDk5LCAweGNjLCAweDAwLCAweDAwKSwKICAgICAgICAgICAgMHgzMyA9PiBhcnJheSgweGZmLCAweGNjLCAweDAwLCAweDAwKSwKICAgICAgICAgICAgMHgzNCA9PiBhcnJheSgweGZmLCAweDk5LCAweDAwLCAweDAwKSwKICAgICAgICAgICAgMHgzNSA9PiBhcnJheSgweGZmLCAweDY2LCAweDAwLCAweDAwKSwKICAgICAgICAgICAgMHgzNiA9PiBhcnJheSgweDY2LCAweDY2LCAweDk5LCAweDAwKSwKICAgICAgICAgICAgMHgzNyA9PiBhcnJheSgweDk2LCAweDk2LCAweDk2LCAweDAwKSwKICAgICAgICAgICAgMHgzOCA9PiBhcnJheSgweDAwLCAweDMzLCAweDY2LCAweDAwKSwKICAgICAgICAgICAgMHgzOSA9PiBhcnJheSgweDMzLCAweDk5LCAweDY2LCAweDAwKSwKICAgICAgICAgICAgMHgzQSA9PiBhcnJheSgweDAwLCAweDMzLCAweDAwLCAweDAwKSwKICAgICAgICAgICAgMHgzQiA9PiBhcnJheSgweDMzLCAweDMzLCAweDAwLCAweDAwKSwKICAgICAgICAgICAgMHgzQyA9PiBhcnJheSgweDk5LCAweDMzLCAweDAwLCAweDAwKSwKICAgICAgICAgICAgMHgzRCA9PiBhcnJheSgweDk5LCAweDMzLCAweDY2LCAweDAwKSwKICAgICAgICAgICAgMHgzRSA9PiBhcnJheSgweDMzLCAweDMzLCAweDk5LCAweDAwKSwKICAgICAgICAgICAgMHgzRiA9PiBhcnJheSgweDMzLCAweDMzLCAweDMzLCAweDAwKSwKICAgICAgICApOwogICAgfQoKICAgIC8qKgogICAgICogQXNzZW1ibGUgd29ya3NoZWV0cyBpbnRvIGEgd29ya2Jvb2sgYW5kIHNlbmQgdGhlIEJJRkYgZGF0YSB0byBhbiBPTEUKICAgICAqIHN0b3JhZ2UuCiAgICAgKgogICAgICogQHBhcmFtICAgIGFycmF5ICAgICRwV29ya3NoZWV0U2l6ZXMgICAgVGhlIHNpemVzIGluIGJ5dGVzIG9mIHRoZSBiaW5hcnkgd29ya3NoZWV0IHN0cmVhbXMKICAgICAqIEByZXR1cm4gICAgc3RyaW5nICAgIEJpbmFyeSBkYXRhIGZvciB3b3JrYm9vayBzdHJlYW0KICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIHdyaXRlV29ya2Jvb2soJHBXb3Jrc2hlZXRTaXplcyA9IG51bGwpCiAgICB7CiAgICAgICAgJHRoaXMtPndvcmtzaGVldFNpemVzID0gJHBXb3Jrc2hlZXRTaXplczsKCiAgICAgICAgLy8gQ2FsY3VsYXRlIHRoZSBudW1iZXIgb2Ygc2VsZWN0ZWQgd29ya3NoZWV0IHRhYnMgYW5kIGNhbGwgdGhlIGZpbmFsaXphdGlvbgogICAgICAgIC8vIG1ldGhvZHMgZm9yIGVhY2ggd29ya3NoZWV0CiAgICAgICAgJHRvdGFsX3dvcmtzaGVldHMgPSAkdGhpcy0+cGhwRXhjZWwtPmdldFNoZWV0Q291bnQoKTsKCiAgICAgICAgLy8gQWRkIHBhcnQgMSBvZiB0aGUgV29ya2Jvb2sgZ2xvYmFscywgd2hhdCBnb2VzIGJlZm9yZSB0aGUgU0hFRVQgcmVjb3JkcwogICAgICAgICR0aGlzLT5zdG9yZUJvZigweDAwMDUpOwogICAgICAgICR0aGlzLT53cml0ZUNvZGVwYWdlKCk7CiAgICAgICAgJHRoaXMtPndyaXRlV2luZG93MSgpOwoKICAgICAgICAkdGhpcy0+d3JpdGVEYXRlTW9kZSgpOwogICAgICAgICR0aGlzLT53cml0ZUFsbEZvbnRzKCk7CiAgICAgICAgJHRoaXMtPndyaXRlQWxsTnVtYmVyRm9ybWF0cygpOwogICAgICAgICR0aGlzLT53cml0ZUFsbFhmcygpOwogICAgICAgICR0aGlzLT53cml0ZUFsbFN0eWxlcygpOwogICAgICAgICR0aGlzLT53cml0ZVBhbGV0dGUoKTsKCiAgICAgICAgLy8gUHJlcGFyZSBwYXJ0IDMgb2YgdGhlIHdvcmtib29rIGdsb2JhbCBzdHJlYW0sIHdoYXQgZ29lcyBhZnRlciB0aGUgU0hFRVQgcmVjb3JkcwogICAgICAgICRwYXJ0MyA9ICcnOwogICAgICAgIGlmICgkdGhpcy0+Y291bnRyeUNvZGUgIT0gLTEpIHsKICAgICAgICAgICAgJHBhcnQzIC49ICR0aGlzLT53cml0ZUNvdW50cnkoKTsKICAgICAgICB9CiAgICAgICAgJHBhcnQzIC49ICR0aGlzLT53cml0ZVJlY2FsY0lkKCk7CgogICAgICAgICRwYXJ0MyAuPSAkdGhpcy0+d3JpdGVTdXBib29rSW50ZXJuYWwoKTsKICAgICAgICAvKiBUT0RPOiBzdG9yZSBleHRlcm5hbCBTVVBCT09LIHJlY29yZHMgYW5kIFhDVCBhbmQgQ1JOIHJlY29yZHMKICAgICAgICBpbiBjYXNlIG9mIGV4dGVybmFsIHJlZmVyZW5jZXMgZm9yIEJJRkY4ICovCiAgICAgICAgJHBhcnQzIC49ICR0aGlzLT53cml0ZUV4dGVybmFsc2hlZXRCaWZmOCgpOwogICAgICAgICRwYXJ0MyAuPSAkdGhpcy0+d3JpdGVBbGxEZWZpbmVkTmFtZXNCaWZmOCgpOwogICAgICAgICRwYXJ0MyAuPSAkdGhpcy0+d3JpdGVNc29EcmF3aW5nR3JvdXAoKTsKICAgICAgICAkcGFydDMgLj0gJHRoaXMtPndyaXRlU2hhcmVkU3RyaW5nc1RhYmxlKCk7CgogICAgICAgICRwYXJ0MyAuPSAkdGhpcy0+d3JpdGVFb2YoKTsKCiAgICAgICAgLy8gQWRkIHBhcnQgMiBvZiB0aGUgV29ya2Jvb2sgZ2xvYmFscywgdGhlIFNIRUVUIHJlY29yZHMKICAgICAgICAkdGhpcy0+Y2FsY1NoZWV0T2Zmc2V0cygpOwogICAgICAgIGZvciAoJGkgPSAwOyAkaSA8ICR0b3RhbF93b3Jrc2hlZXRzOyArKyRpKSB7CiAgICAgICAgICAgICR0aGlzLT53cml0ZUJvdW5kU2hlZXQoJHRoaXMtPnBocEV4Y2VsLT5nZXRTaGVldCgkaSksICR0aGlzLT53b3Jrc2hlZXRPZmZzZXRzWyRpXSk7CiAgICAgICAgfQoKICAgICAgICAvLyBBZGQgcGFydCAzIG9mIHRoZSBXb3JrYm9vayBnbG9iYWxzCiAgICAgICAgJHRoaXMtPl9kYXRhIC49ICRwYXJ0MzsKCiAgICAgICAgcmV0dXJuICR0aGlzLT5fZGF0YTsKICAgIH0KCiAgICAvKioKICAgICAqIENhbGN1bGF0ZSBvZmZzZXRzIGZvciBXb3Jrc2hlZXQgQk9GIHJlY29yZHMuCiAgICAgKgogICAgICogQGFjY2VzcyBwcml2YXRlCiAgICAgKi8KICAgIHByaXZhdGUgZnVuY3Rpb24gY2FsY1NoZWV0T2Zmc2V0cygpCiAgICB7CiAgICAgICAgJGJvdW5kc2hlZXRfbGVuZ3RoID0gMTA7ICAvLyBmaXhlZCBsZW5ndGggZm9yIGEgQk9VTkRTSEVFVCByZWNvcmQKCiAgICAgICAgLy8gc2l6ZSBvZiBXb3JrYm9vayBnbG9iYWxzIHBhcnQgMSArIDMKICAgICAgICAkb2Zmc2V0ICAgICAgICAgICAgPSAkdGhpcy0+X2RhdGFzaXplOwoKICAgICAgICAvLyBhZGQgc2l6ZSBvZiBXb3JrYm9vayBnbG9iYWxzIHBhcnQgMiwgdGhlIGxlbmd0aCBvZiB0aGUgU0hFRVQgcmVjb3JkcwogICAgICAgICR0b3RhbF93b3Jrc2hlZXRzID0gY291bnQoJHRoaXMtPnBocEV4Y2VsLT5nZXRBbGxTaGVldHMoKSk7CiAgICAgICAgZm9yZWFjaCAoJHRoaXMtPnBocEV4Y2VsLT5nZXRXb3Jrc2hlZXRJdGVyYXRvcigpIGFzICRzaGVldCkgewogICAgICAgICAgICAkb2Zmc2V0ICs9ICRib3VuZHNoZWV0X2xlbmd0aCArIHN0cmxlbihQSFBFeGNlbF9TaGFyZWRfU3RyaW5nOjpVVEY4dG9CSUZGOFVuaWNvZGVTaG9ydCgkc2hlZXQtPmdldFRpdGxlKCkpKTsKICAgICAgICB9CgogICAgICAgIC8vIGFkZCB0aGUgc2l6ZXMgb2YgZWFjaCBvZiB0aGUgU2hlZXQgc3Vic3RyZWFtcywgcmVzcGVjdGl2ZWx5CiAgICAgICAgZm9yICgkaSA9IDA7ICRpIDwgJHRvdGFsX3dvcmtzaGVldHM7ICsrJGkpIHsKICAgICAgICAgICAgJHRoaXMtPndvcmtzaGVldE9mZnNldHNbJGldID0gJG9mZnNldDsKICAgICAgICAgICAgJG9mZnNldCArPSAkdGhpcy0+d29ya3NoZWV0U2l6ZXNbJGldOwogICAgICAgIH0KICAgICAgICAkdGhpcy0+YmlmZlNpemUgPSAkb2Zmc2V0OwogICAgfQoKICAgIC8qKgogICAgICogU3RvcmUgdGhlIEV4Y2VsIEZPTlQgcmVjb3Jkcy4KICAgICAqLwogICAgcHJpdmF0ZSBmdW5jdGlvbiB3cml0ZUFsbEZvbnRzKCkKICAgIHsKICAgICAgICBmb3JlYWNoICgkdGhpcy0+Zm9udFdyaXRlcnMgYXMgJGZvbnRXcml0ZXIpIHsKICAgICAgICAgICAgJHRoaXMtPmFwcGVuZCgkZm9udFdyaXRlci0+d3JpdGVGb250KCkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFN0b3JlIHVzZXIgZGVmaW5lZCBudW1lcmljYWwgZm9ybWF0cyBpLmUuIEZPUk1BVCByZWNvcmRzCiAgICAgKi8KICAgIHByaXZhdGUgZnVuY3Rpb24gd3JpdGVBbGxOdW1iZXJGb3JtYXRzKCkKICAgIHsKICAgICAgICBmb3JlYWNoICgkdGhpcy0+bnVtYmVyRm9ybWF0cyBhcyAkbnVtYmVyRm9ybWF0SW5kZXggPT4gJG51bWJlckZvcm1hdCkgewogICAgICAgICAgICAkdGhpcy0+d3JpdGVOdW1iZXJGb3JtYXQoJG51bWJlckZvcm1hdC0+Z2V0Rm9ybWF0Q29kZSgpLCAkbnVtYmVyRm9ybWF0SW5kZXgpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFdyaXRlIGFsbCBYRiByZWNvcmRzLgogICAgICovCiAgICBwcml2YXRlIGZ1bmN0aW9uIHdyaXRlQWxsWGZzKCkKICAgIHsKICAgICAgICBmb3JlYWNoICgkdGhpcy0+eGZXcml0ZXJzIGFzICR4ZldyaXRlcikgewogICAgICAgICAgICAkdGhpcy0+YXBwZW5kKCR4ZldyaXRlci0+d3JpdGVYZigpKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBXcml0ZSBhbGwgU1RZTEUgcmVjb3Jkcy4KICAgICAqLwogICAgcHJpdmF0ZSBmdW5jdGlvbiB3cml0ZUFsbFN0eWxlcygpCiAgICB7CiAgICAgICAgJHRoaXMtPndyaXRlU3R5bGUoKTsKICAgIH0KCiAgICAvKioKICAgICAqIFdyaXRlIHRoZSBFWFRFUk5DT1VOVCBhbmQgRVhURVJOU0hFRVQgcmVjb3Jkcy4gVGhlc2UgYXJlIHVzZWQgYXMgaW5kZXhlcyBmb3IKICAgICAqIHRoZSBOQU1FIHJlY29yZHMuCiAgICAgKi8KICAgIHByaXZhdGUgZnVuY3Rpb24gd3JpdGVFeHRlcm5hbHMoKQogICAgewogICAgICAgICRjb3VudFNoZWV0cyA9ICR0aGlzLT5waHBFeGNlbC0+Z2V0U2hlZXRDb3VudCgpOwogICAgICAgIC8vIENyZWF0ZSBFWFRFUk5DT1VOVCB3aXRoIG51bWJlciBvZiB3b3Jrc2hlZXRzCiAgICAgICAgJHRoaXMtPndyaXRlRXh0ZXJuYWxDb3VudCgkY291bnRTaGVldHMpOwoKICAgICAgICAvLyBDcmVhdGUgRVhURVJOU0hFRVQgZm9yIGVhY2ggd29ya3NoZWV0CiAgICAgICAgZm9yICgkaSA9IDA7ICRpIDwgJGNvdW50U2hlZXRzOyArKyRpKSB7CiAgICAgICAgICAgICR0aGlzLT53cml0ZUV4dGVybmFsU2hlZXQoJHRoaXMtPnBocEV4Y2VsLT5nZXRTaGVldCgkaSktPmdldFRpdGxlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFdyaXRlIHRoZSBOQU1FIHJlY29yZCB0byBkZWZpbmUgdGhlIHByaW50IGFyZWEgYW5kIHRoZSByZXBlYXQgcm93cyBhbmQgY29scy4KICAgICAqLwogICAgcHJpdmF0ZSBmdW5jdGlvbiB3cml0ZU5hbWVzKCkKICAgIHsKICAgICAgICAvLyB0b3RhbCBudW1iZXIgb2Ygc2hlZXRzCiAgICAgICAgJHRvdGFsX3dvcmtzaGVldHMgPSAkdGhpcy0+cGhwRXhjZWwtPmdldFNoZWV0Q291bnQoKTsKCiAgICAgICAgLy8gQ3JlYXRlIHRoZSBwcmludCBhcmVhIE5BTUUgcmVjb3JkcwogICAgICAgIGZvciAoJGkgPSAwOyAkaSA8ICR0b3RhbF93b3Jrc2hlZXRzOyArKyRpKSB7CiAgICAgICAgICAgICRzaGVldFNldHVwID0gJHRoaXMtPnBocEV4Y2VsLT5nZXRTaGVldCgkaSktPmdldFBhZ2VTZXR1cCgpOwogICAgICAgICAgICAvLyBXcml0ZSBhIE5hbWUgcmVjb3JkIGlmIHRoZSBwcmludCBhcmVhIGhhcyBiZWVuIGRlZmluZWQKICAgICAgICAgICAgaWYgKCRzaGVldFNldHVwLT5pc1ByaW50QXJlYVNldCgpKSB7CiAgICAgICAgICAgICAgICAvLyBQcmludCBhcmVhCiAgICAgICAgICAgICAgICAkcHJpbnRBcmVhID0gUEhQRXhjZWxfQ2VsbDo6c3BsaXRSYW5nZSgkc2hlZXRTZXR1cC0+Z2V0UHJpbnRBcmVhKCkpOwogICAgICAgICAgICAgICAgJHByaW50QXJlYSA9ICRwcmludEFyZWFbMF07CiAgICAgICAgICAgICAgICAkcHJpbnRBcmVhWzBdID0gUEhQRXhjZWxfQ2VsbDo6Y29vcmRpbmF0ZUZyb21TdHJpbmcoJHByaW50QXJlYVswXSk7CiAgICAgICAgICAgICAgICAkcHJpbnRBcmVhWzFdID0gUEhQRXhjZWxfQ2VsbDo6Y29vcmRpbmF0ZUZyb21TdHJpbmcoJHByaW50QXJlYVsxXSk7CgogICAgICAgICAgICAgICAgJHByaW50X3Jvd21pbiA9ICRwcmludEFyZWFbMF1bMV0gLSAxOwogICAgICAgICAgICAgICAgJHByaW50X3Jvd21heCA9ICRwcmludEFyZWFbMV1bMV0gLSAxOwogICAgICAgICAgICAgICAgJHByaW50X2NvbG1pbiA9IFBIUEV4Y2VsX0NlbGw6OmNvbHVtbkluZGV4RnJvbVN0cmluZygkcHJpbnRBcmVhWzBdWzBdKSAtIDE7CiAgICAgICAgICAgICAgICAkcHJpbnRfY29sbWF4ID0gUEhQRXhjZWxfQ2VsbDo6Y29sdW1uSW5kZXhGcm9tU3RyaW5nKCRwcmludEFyZWFbMV1bMF0pIC0gMTsKCiAgICAgICAgICAgICAgICAkdGhpcy0+d3JpdGVOYW1lU2hvcnQoCiAgICAgICAgICAgICAgICAgICAgJGksIC8vIHNoZWV0IGluZGV4CiAgICAgICAgICAgICAgICAgICAgMHgwNiwgLy8gTkFNRSB0eXBlCiAgICAgICAgICAgICAgICAgICAgJHByaW50X3Jvd21pbiwKICAgICAgICAgICAgICAgICAgICAkcHJpbnRfcm93bWF4LAogICAgICAgICAgICAgICAgICAgICRwcmludF9jb2xtaW4sCiAgICAgICAgICAgICAgICAgICAgJHByaW50X2NvbG1heAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gQ3JlYXRlIHRoZSBwcmludCB0aXRsZSBOQU1FIHJlY29yZHMKICAgICAgICBmb3IgKCRpID0gMDsgJGkgPCAkdG90YWxfd29ya3NoZWV0czsgKyskaSkgewogICAgICAgICAgICAkc2hlZXRTZXR1cCA9ICR0aGlzLT5waHBFeGNlbC0+Z2V0U2hlZXQoJGkpLT5nZXRQYWdlU2V0dXAoKTsKCiAgICAgICAgICAgIC8vIHNpbXVsdGFuZW91cyByZXBlYXRDb2x1bW5zIHJlcGVhdFJvd3MKICAgICAgICAgICAgaWYgKCRzaGVldFNldHVwLT5pc0NvbHVtbnNUb1JlcGVhdEF0TGVmdFNldCgpICYmICRzaGVldFNldHVwLT5pc1Jvd3NUb1JlcGVhdEF0VG9wU2V0KCkpIHsKICAgICAgICAgICAgICAgICRyZXBlYXQgPSAkc2hlZXRTZXR1cC0+Z2V0Q29sdW1uc1RvUmVwZWF0QXRMZWZ0KCk7CiAgICAgICAgICAgICAgICAkY29sbWluID0gUEhQRXhjZWxfQ2VsbDo6Y29sdW1uSW5kZXhGcm9tU3RyaW5nKCRyZXBlYXRbMF0pIC0gMTsKICAgICAgICAgICAgICAgICRjb2xtYXggPSBQSFBFeGNlbF9DZWxsOjpjb2x1bW5JbmRleEZyb21TdHJpbmcoJHJlcGVhdFsxXSkgLSAxOwoKICAgICAgICAgICAgICAgICRyZXBlYXQgPSAkc2hlZXRTZXR1cC0+Z2V0Um93c1RvUmVwZWF0QXRUb3AoKTsKICAgICAgICAgICAgICAgICRyb3dtaW4gPSAkcmVwZWF0WzBdIC0gMTsKICAgICAgICAgICAgICAgICRyb3dtYXggPSAkcmVwZWF0WzFdIC0gMTsKCiAgICAgICAgICAgICAgICAkdGhpcy0+d3JpdGVOYW1lTG9uZygKICAgICAgICAgICAgICAgICAgICAkaSwgLy8gc2hlZXQgaW5kZXgKICAgICAgICAgICAgICAgICAgICAweDA3LCAvLyBOQU1FIHR5cGUKICAgICAgICAgICAgICAgICAgICAkcm93bWluLAogICAgICAgICAgICAgICAgICAgICRyb3dtYXgsCiAgICAgICAgICAgICAgICAgICAgJGNvbG1pbiwKICAgICAgICAgICAgICAgICAgICAkY29sbWF4CiAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgLy8gKGV4Y2x1c2l2ZSkgZWl0aGVyIHJlcGVhdENvbHVtbnMgb3IgcmVwZWF0Um93cwogICAgICAgICAgICB9IGVsc2VpZiAoJHNoZWV0U2V0dXAtPmlzQ29sdW1uc1RvUmVwZWF0QXRMZWZ0U2V0KCkgfHwgJHNoZWV0U2V0dXAtPmlzUm93c1RvUmVwZWF0QXRUb3BTZXQoKSkgewogICAgICAgICAgICAgICAgLy8gQ29sdW1ucyB0byByZXBlYXQKICAgICAgICAgICAgICAgIGlmICgkc2hlZXRTZXR1cC0+aXNDb2x1bW5zVG9SZXBlYXRBdExlZnRTZXQoKSkgewogICAgICAgICAgICAgICAgICAgICRyZXBlYXQgPSAkc2hlZXRTZXR1cC0+Z2V0Q29sdW1uc1RvUmVwZWF0QXRMZWZ0KCk7CiAgICAgICAgICAgICAgICAgICAgJGNvbG1pbiA9IFBIUEV4Y2VsX0NlbGw6OmNvbHVtbkluZGV4RnJvbVN0cmluZygkcmVwZWF0WzBdKSAtIDE7CiAgICAgICAgICAgICAgICAgICAgJGNvbG1heCA9IFBIUEV4Y2VsX0NlbGw6OmNvbHVtbkluZGV4RnJvbVN0cmluZygkcmVwZWF0WzFdKSAtIDE7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICRjb2xtaW4gPSAwOwogICAgICAgICAgICAgICAgICAgICRjb2xtYXggPSAyNTU7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gUm93cyB0byByZXBlYXQKICAgICAgICAgICAgICAgIGlmICgkc2hlZXRTZXR1cC0+aXNSb3dzVG9SZXBlYXRBdFRvcFNldCgpKSB7CiAgICAgICAgICAgICAgICAgICAgJHJlcGVhdCA9ICRzaGVldFNldHVwLT5nZXRSb3dzVG9SZXBlYXRBdFRvcCgpOwogICAgICAgICAgICAgICAgICAgICRyb3dtaW4gPSAkcmVwZWF0WzBdIC0gMTsKICAgICAgICAgICAgICAgICAgICAkcm93bWF4ID0gJHJlcGVhdFsxXSAtIDE7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICRyb3dtaW4gPSAwOwogICAgICAgICAgICAgICAgICAgICRyb3dtYXggPSA2NTUzNTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkdGhpcy0+d3JpdGVOYW1lU2hvcnQoCiAgICAgICAgICAgICAgICAgICAgJGksIC8vIHNoZWV0IGluZGV4CiAgICAgICAgICAgICAgICAgICAgMHgwNywgLy8gTkFNRSB0eXBlCiAgICAgICAgICAgICAgICAgICAgJHJvd21pbiwKICAgICAgICAgICAgICAgICAgICAkcm93bWF4LAogICAgICAgICAgICAgICAgICAgICRjb2xtaW4sCiAgICAgICAgICAgICAgICAgICAgJGNvbG1heAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFdyaXRlcyBhbGwgdGhlIERFRklORUROQU1FIHJlY29yZHMgKEJJRkY4KS4KICAgICAqIFNvIGZhciB0aGlzIGlzIG9ubHkgdXNlZCBmb3IgcmVwZWF0aW5nIHJvd3MvY29sdW1ucyAocHJpbnQgdGl0bGVzKSBhbmQgcHJpbnQgYXJlYXMKICAgICAqLwogICAgcHJpdmF0ZSBmdW5jdGlvbiB3cml0ZUFsbERlZmluZWROYW1lc0JpZmY4KCkKICAgIHsKICAgICAgICAkY2h1bmsgPSAnJzsKCiAgICAgICAgLy8gTmFtZWQgcmFuZ2VzCiAgICAgICAgaWYgKGNvdW50KCR0aGlzLT5waHBFeGNlbC0+Z2V0TmFtZWRSYW5nZXMoKSkgPiAwKSB7CiAgICAgICAgICAgIC8vIExvb3AgbmFtZWQgcmFuZ2VzCiAgICAgICAgICAgICRuYW1lZFJhbmdlcyA9ICR0aGlzLT5waHBFeGNlbC0+Z2V0TmFtZWRSYW5nZXMoKTsKICAgICAgICAgICAgZm9yZWFjaCAoJG5hbWVkUmFuZ2VzIGFzICRuYW1lZFJhbmdlKSB7CiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgYWJzb2x1dGUgY29vcmRpbmF0ZQogICAgICAgICAgICAgICAgJHJhbmdlID0gUEhQRXhjZWxfQ2VsbDo6c3BsaXRSYW5nZSgkbmFtZWRSYW5nZS0+Z2V0UmFuZ2UoKSk7CiAgICAgICAgICAgICAgICBmb3IgKCRpID0gMDsgJGkgPCBjb3VudCgkcmFuZ2UpOyAkaSsrKSB7CiAgICAgICAgICAgICAgICAgICAgJHJhbmdlWyRpXVswXSA9ICdcJycgLiBzdHJfcmVwbGFjZSgiJyIsICInJyIsICRuYW1lZFJhbmdlLT5nZXRXb3Jrc2hlZXQoKS0+Z2V0VGl0bGUoKSkgLiAnXCchJyAuIFBIUEV4Y2VsX0NlbGw6OmFic29sdXRlQ29vcmRpbmF0ZSgkcmFuZ2VbJGldWzBdKTsKICAgICAgICAgICAgICAgICAgICBpZiAoaXNzZXQoJHJhbmdlWyRpXVsxXSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHJhbmdlWyRpXVsxXSA9IFBIUEV4Y2VsX0NlbGw6OmFic29sdXRlQ29vcmRpbmF0ZSgkcmFuZ2VbJGldWzFdKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkcmFuZ2UgPSBQSFBFeGNlbF9DZWxsOjpidWlsZFJhbmdlKCRyYW5nZSk7IC8vIGUuZy4gU2hlZXQxISRBJDE6JEIkMgoKICAgICAgICAgICAgICAgIC8vIHBhcnNlIGZvcm11bGEKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgICAgJGVycm9yID0gJHRoaXMtPnBhcnNlci0+cGFyc2UoJHJhbmdlKTsKICAgICAgICAgICAgICAgICAgICAkZm9ybXVsYURhdGEgPSAkdGhpcy0+cGFyc2VyLT50b1JldmVyc2VQb2xpc2goKTsKCiAgICAgICAgICAgICAgICAgICAgLy8gbWFrZSBzdXJlIHRSZWYzZCBpcyBvZiB0eXBlIHRSZWYzZFIgKDB4M0EpCiAgICAgICAgICAgICAgICAgICAgaWYgKGlzc2V0KCRmb3JtdWxhRGF0YXswfSkgYW5kICgkZm9ybXVsYURhdGF7MH0gPT0gIlx4N0EiIG9yICRmb3JtdWxhRGF0YXswfSA9PSAiXHg1QSIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRmb3JtdWxhRGF0YSA9ICJceDNBIiAuIHN1YnN0cigkZm9ybXVsYURhdGEsIDEpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKCRuYW1lZFJhbmdlLT5nZXRMb2NhbE9ubHkoKSkgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBsb2NhbCBzY29wZQogICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUgPSAkdGhpcy0+cGhwRXhjZWwtPmdldEluZGV4KCRuYW1lZFJhbmdlLT5nZXRTY29wZSgpKSArIDE7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gZ2xvYmFsIHNjb3BlCiAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZSA9IDA7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICRjaHVuayAuPSAkdGhpcy0+d3JpdGVEYXRhKCR0aGlzLT53cml0ZURlZmluZWROYW1lQmlmZjgoJG5hbWVkUmFuZ2UtPmdldE5hbWUoKSwgJGZvcm11bGFEYXRhLCAkc2NvcGUsIGZhbHNlKSk7CgogICAgICAgICAgICAgICAgfSBjYXRjaCAoUEhQRXhjZWxfRXhjZXB0aW9uICRlKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gZG8gbm90aGluZwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyB0b3RhbCBudW1iZXIgb2Ygc2hlZXRzCiAgICAgICAgJHRvdGFsX3dvcmtzaGVldHMgPSAkdGhpcy0+cGhwRXhjZWwtPmdldFNoZWV0Q291bnQoKTsKCiAgICAgICAgLy8gd3JpdGUgdGhlIHByaW50IHRpdGxlcyAocmVwZWF0aW5nIHJvd3MsIGNvbHVtbnMpLCBpZiBhbnkKICAgICAgICBmb3IgKCRpID0gMDsgJGkgPCAkdG90YWxfd29ya3NoZWV0czsgKyskaSkgewogICAgICAgICAgICAkc2hlZXRTZXR1cCA9ICR0aGlzLT5waHBFeGNlbC0+Z2V0U2hlZXQoJGkpLT5nZXRQYWdlU2V0dXAoKTsKICAgICAgICAgICAgLy8gc2ltdWx0YW5lb3VzIHJlcGVhdENvbHVtbnMgcmVwZWF0Um93cwogICAgICAgICAgICBpZiAoJHNoZWV0U2V0dXAtPmlzQ29sdW1uc1RvUmVwZWF0QXRMZWZ0U2V0KCkgJiYgJHNoZWV0U2V0dXAtPmlzUm93c1RvUmVwZWF0QXRUb3BTZXQoKSkgewogICAgICAgICAgICAgICAgJHJlcGVhdCA9ICRzaGVldFNldHVwLT5nZXRDb2x1bW5zVG9SZXBlYXRBdExlZnQoKTsKICAgICAgICAgICAgICAgICRjb2xtaW4gPSBQSFBFeGNlbF9DZWxsOjpjb2x1bW5JbmRleEZyb21TdHJpbmcoJHJlcGVhdFswXSkgLSAxOwogICAgICAgICAgICAgICAgJGNvbG1heCA9IFBIUEV4Y2VsX0NlbGw6OmNvbHVtbkluZGV4RnJvbVN0cmluZygkcmVwZWF0WzFdKSAtIDE7CgogICAgICAgICAgICAgICAgJHJlcGVhdCA9ICRzaGVldFNldHVwLT5nZXRSb3dzVG9SZXBlYXRBdFRvcCgpOwogICAgICAgICAgICAgICAgJHJvd21pbiA9ICRyZXBlYXRbMF0gLSAxOwogICAgICAgICAgICAgICAgJHJvd21heCA9ICRyZXBlYXRbMV0gLSAxOwoKICAgICAgICAgICAgICAgIC8vIGNvbnN0cnVjdCBmb3JtdWxhIGRhdGEgbWFudWFsbHkKICAgICAgICAgICAgICAgICRmb3JtdWxhRGF0YSA9IHBhY2soJ0N2JywgMHgyOSwgMHgxNyk7IC8vIHRNZW1GdW5jCiAgICAgICAgICAgICAgICAkZm9ybXVsYURhdGEgLj0gcGFjaygnQ3Z2dnZ2JywgMHgzQiwgJGksIDAsIDY1NTM1LCAkY29sbWluLCAkY29sbWF4KTsgLy8gdEFyZWEzZAogICAgICAgICAgICAgICAgJGZvcm11bGFEYXRhIC49IHBhY2soJ0N2dnZ2dicsIDB4M0IsICRpLCAkcm93bWluLCAkcm93bWF4LCAwLCAyNTUpOyAvLyB0QXJlYTNkCiAgICAgICAgICAgICAgICAkZm9ybXVsYURhdGEgLj0gcGFjaygnQycsIDB4MTApOyAvLyB0TGlzdAoKICAgICAgICAgICAgICAgIC8vIHN0b3JlIHRoZSBERUZJTkVETkFNRSByZWNvcmQKICAgICAgICAgICAgICAgICRjaHVuayAuPSAkdGhpcy0+d3JpdGVEYXRhKCR0aGlzLT53cml0ZURlZmluZWROYW1lQmlmZjgocGFjaygnQycsIDB4MDcpLCAkZm9ybXVsYURhdGEsICRpICsgMSwgdHJ1ZSkpOwoKICAgICAgICAgICAgLy8gKGV4Y2x1c2l2ZSkgZWl0aGVyIHJlcGVhdENvbHVtbnMgb3IgcmVwZWF0Um93cwogICAgICAgICAgICB9IGVsc2VpZiAoJHNoZWV0U2V0dXAtPmlzQ29sdW1uc1RvUmVwZWF0QXRMZWZ0U2V0KCkgfHwgJHNoZWV0U2V0dXAtPmlzUm93c1RvUmVwZWF0QXRUb3BTZXQoKSkgewogICAgICAgICAgICAgICAgLy8gQ29sdW1ucyB0byByZXBlYXQKICAgICAgICAgICAgICAgIGlmICgkc2hlZXRTZXR1cC0+aXNDb2x1bW5zVG9SZXBlYXRBdExlZnRTZXQoKSkgewogICAgICAgICAgICAgICAgICAgICRyZXBlYXQgPSAkc2hlZXRTZXR1cC0+Z2V0Q29sdW1uc1RvUmVwZWF0QXRMZWZ0KCk7CiAgICAgICAgICAgICAgICAgICAgJGNvbG1pbiA9IFBIUEV4Y2VsX0NlbGw6OmNvbHVtbkluZGV4RnJvbVN0cmluZygkcmVwZWF0WzBdKSAtIDE7CiAgICAgICAgICAgICAgICAgICAgJGNvbG1heCA9IFBIUEV4Y2VsX0NlbGw6OmNvbHVtbkluZGV4RnJvbVN0cmluZygkcmVwZWF0WzFdKSAtIDE7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICRjb2xtaW4gPSAwOwogICAgICAgICAgICAgICAgICAgICRjb2xtYXggPSAyNTU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvLyBSb3dzIHRvIHJlcGVhdAogICAgICAgICAgICAgICAgaWYgKCRzaGVldFNldHVwLT5pc1Jvd3NUb1JlcGVhdEF0VG9wU2V0KCkpIHsKICAgICAgICAgICAgICAgICAgICAkcmVwZWF0ID0gJHNoZWV0U2V0dXAtPmdldFJvd3NUb1JlcGVhdEF0VG9wKCk7CiAgICAgICAgICAgICAgICAgICAgJHJvd21pbiA9ICRyZXBlYXRbMF0gLSAxOwogICAgICAgICAgICAgICAgICAgICRyb3dtYXggPSAkcmVwZWF0WzFdIC0gMTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJHJvd21pbiA9IDA7CiAgICAgICAgICAgICAgICAgICAgJHJvd21heCA9IDY1NTM1OwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIGNvbnN0cnVjdCBmb3JtdWxhIGRhdGEgbWFudWFsbHkgYmVjYXVzZSBwYXJzZXIgZG9lcyBub3QgcmVjb2duaXplIGFic29sdXRlIDNkIGNlbGwgcmVmZXJlbmNlcwogICAgICAgICAgICAgICAgJGZvcm11bGFEYXRhID0gcGFjaygnQ3Z2dnZ2JywgMHgzQiwgJGksICRyb3dtaW4sICRyb3dtYXgsICRjb2xtaW4sICRjb2xtYXgpOwoKICAgICAgICAgICAgICAgIC8vIHN0b3JlIHRoZSBERUZJTkVETkFNRSByZWNvcmQKICAgICAgICAgICAgICAgICRjaHVuayAuPSAkdGhpcy0+d3JpdGVEYXRhKCR0aGlzLT53cml0ZURlZmluZWROYW1lQmlmZjgocGFjaygnQycsIDB4MDcpLCAkZm9ybXVsYURhdGEsICRpICsgMSwgdHJ1ZSkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyB3cml0ZSB0aGUgcHJpbnQgYXJlYXMsIGlmIGFueQogICAgICAgIGZvciAoJGkgPSAwOyAkaSA8ICR0b3RhbF93b3Jrc2hlZXRzOyArKyRpKSB7CiAgICAgICAgICAgICRzaGVldFNldHVwID0gJHRoaXMtPnBocEV4Y2VsLT5nZXRTaGVldCgkaSktPmdldFBhZ2VTZXR1cCgpOwogICAgICAgICAgICBpZiAoJHNoZWV0U2V0dXAtPmlzUHJpbnRBcmVhU2V0KCkpIHsKICAgICAgICAgICAgICAgIC8vIFByaW50IGFyZWEsIGUuZy4gQTM6SjYsSDE6WDIwCiAgICAgICAgICAgICAgICAkcHJpbnRBcmVhID0gUEhQRXhjZWxfQ2VsbDo6c3BsaXRSYW5nZSgkc2hlZXRTZXR1cC0+Z2V0UHJpbnRBcmVhKCkpOwogICAgICAgICAgICAgICAgJGNvdW50UHJpbnRBcmVhID0gY291bnQoJHByaW50QXJlYSk7CgogICAgICAgICAgICAgICAgJGZvcm11bGFEYXRhID0gJyc7CiAgICAgICAgICAgICAgICBmb3IgKCRqID0gMDsgJGogPCAkY291bnRQcmludEFyZWE7ICsrJGopIHsKICAgICAgICAgICAgICAgICAgICAkcHJpbnRBcmVhUmVjdCA9ICRwcmludEFyZWFbJGpdOyAvLyBlLmcuIEEzOko2CiAgICAgICAgICAgICAgICAgICAgJHByaW50QXJlYVJlY3RbMF0gPSBQSFBFeGNlbF9DZWxsOjpjb29yZGluYXRlRnJvbVN0cmluZygkcHJpbnRBcmVhUmVjdFswXSk7CiAgICAgICAgICAgICAgICAgICAgJHByaW50QXJlYVJlY3RbMV0gPSBQSFBFeGNlbF9DZWxsOjpjb29yZGluYXRlRnJvbVN0cmluZygkcHJpbnRBcmVhUmVjdFsxXSk7CgogICAgICAgICAgICAgICAgICAgICRwcmludF9yb3dtaW4gPSAkcHJpbnRBcmVhUmVjdFswXVsxXSAtIDE7CiAgICAgICAgICAgICAgICAgICAgJHByaW50X3Jvd21heCA9ICRwcmludEFyZWFSZWN0WzFdWzFdIC0gMTsKICAgICAgICAgICAgICAgICAgICAkcHJpbnRfY29sbWluID0gUEhQRXhjZWxfQ2VsbDo6Y29sdW1uSW5kZXhGcm9tU3RyaW5nKCRwcmludEFyZWFSZWN0WzBdWzBdKSAtIDE7CiAgICAgICAgICAgICAgICAgICAgJHByaW50X2NvbG1heCA9IFBIUEV4Y2VsX0NlbGw6OmNvbHVtbkluZGV4RnJvbVN0cmluZygkcHJpbnRBcmVhUmVjdFsxXVswXSkgLSAxOwoKICAgICAgICAgICAgICAgICAgICAvLyBjb25zdHJ1Y3QgZm9ybXVsYSBkYXRhIG1hbnVhbGx5IGJlY2F1c2UgcGFyc2VyIGRvZXMgbm90IHJlY29nbml6ZSBhYnNvbHV0ZSAzZCBjZWxsIHJlZmVyZW5jZXMKICAgICAgICAgICAgICAgICAgICAkZm9ybXVsYURhdGEgLj0gcGFjaygnQ3Z2dnZ2JywgMHgzQiwgJGksICRwcmludF9yb3dtaW4sICRwcmludF9yb3dtYXgsICRwcmludF9jb2xtaW4sICRwcmludF9jb2xtYXgpOwoKICAgICAgICAgICAgICAgICAgICBpZiAoJGogPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRmb3JtdWxhRGF0YSAuPSBwYWNrKCdDJywgMHgxMCk7IC8vIGxpc3Qgb3BlcmF0b3IgdG9rZW4gJywnCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIC8vIHN0b3JlIHRoZSBERUZJTkVETkFNRSByZWNvcmQKICAgICAgICAgICAgICAgICRjaHVuayAuPSAkdGhpcy0+d3JpdGVEYXRhKCR0aGlzLT53cml0ZURlZmluZWROYW1lQmlmZjgocGFjaygnQycsIDB4MDYpLCAkZm9ybXVsYURhdGEsICRpICsgMSwgdHJ1ZSkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyB3cml0ZSBhdXRvZmlsdGVycywgaWYgYW55CiAgICAgICAgZm9yICgkaSA9IDA7ICRpIDwgJHRvdGFsX3dvcmtzaGVldHM7ICsrJGkpIHsKICAgICAgICAgICAgJHNoZWV0QXV0b0ZpbHRlciA9ICR0aGlzLT5waHBFeGNlbC0+Z2V0U2hlZXQoJGkpLT5nZXRBdXRvRmlsdGVyKCk7CiAgICAgICAgICAgICRhdXRvRmlsdGVyUmFuZ2UgPSAkc2hlZXRBdXRvRmlsdGVyLT5nZXRSYW5nZSgpOwogICAgICAgICAgICBpZiAoIWVtcHR5KCRhdXRvRmlsdGVyUmFuZ2UpKSB7CiAgICAgICAgICAgICAgICAkcmFuZ2VCb3VuZHMgPSBQSFBFeGNlbF9DZWxsOjpyYW5nZUJvdW5kYXJpZXMoJGF1dG9GaWx0ZXJSYW5nZSk7CgogICAgICAgICAgICAgICAgLy9BdXRvZmlsdGVyIGJ1aWx0IGluIG5hbWUKICAgICAgICAgICAgICAgICRuYW1lID0gcGFjaygnQycsIDB4MEQpOwoKICAgICAgICAgICAgICAgICRjaHVuayAuPSAkdGhpcy0+d3JpdGVEYXRhKCR0aGlzLT53cml0ZVNob3J0TmFtZUJpZmY4KCRuYW1lLCAkaSArIDEsICRyYW5nZUJvdW5kcywgdHJ1ZSkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gJGNodW5rOwogICAgfQoKICAgIC8qKgogICAgICogV3JpdGUgYSBERUZJTkVETkFNRSByZWNvcmQgZm9yIEJJRkY4IHVzaW5nIGV4cGxpY2l0IGJpbmFyeSBmb3JtdWxhIGRhdGEKICAgICAqCiAgICAgKiBAcGFyYW0gICAgc3RyaW5nICAgICAgICAkbmFtZSAgICAgICAgICAgIFRoZSBuYW1lIGluIFVURi04CiAgICAgKiBAcGFyYW0gICAgc3RyaW5nICAgICAgICAkZm9ybXVsYURhdGEgICAgVGhlIGJpbmFyeSBmb3JtdWxhIGRhdGEKICAgICAqIEBwYXJhbSAgICBzdHJpbmcgICAgICAgICRzaGVldEluZGV4ICAgICAgICAxLWJhc2VkIHNoZWV0IGluZGV4IHRoZSBkZWZpbmVkIG5hbWUgYXBwbGllcyB0by4gMCA9IGdsb2JhbAogICAgICogQHBhcmFtICAgIGJvb2xlYW4gICAgICAgICRpc0J1aWx0SW4gICAgICAgIEJ1aWx0LWluIG5hbWU\/CiAgICAgKiBAcmV0dXJuICAgIHN0cmluZyAgICBDb21wbGV0ZSBiaW5hcnkgcmVjb3JkIGRhdGEKICAgICAqLwogICAgcHJpdmF0ZSBmdW5jdGlvbiB3cml0ZURlZmluZWROYW1lQmlmZjgoJG5hbWUsICRmb3JtdWxhRGF0YSwgJHNoZWV0SW5kZXggPSAwLCAkaXNCdWlsdEluID0gZmFsc2UpCiAgICB7CiAgICAgICAgJHJlY29yZCA9IDB4MDAxODsKCiAgICAgICAgLy8gb3B0aW9uIGZsYWdzCiAgICAgICAgJG9wdGlvbnMgPSAkaXNCdWlsdEluID8gMHgyMCA6IDB4MDA7CgogICAgICAgIC8vIGxlbmd0aCBvZiB0aGUgbmFtZSwgY2hhcmFjdGVyIGNvdW50CiAgICAgICAgJG5sZW4gPSBQSFBFeGNlbF9TaGFyZWRfU3RyaW5nOjpDb3VudENoYXJhY3RlcnMoJG5hbWUpOwoKICAgICAgICAvLyBuYW1lIHdpdGggc3RyaXBwZWQgbGVuZ3RoIGZpZWxkCiAgICAgICAgJG5hbWUgPSBzdWJzdHIoUEhQRXhjZWxfU2hhcmVkX1N0cmluZzo6VVRGOHRvQklGRjhVbmljb2RlTG9uZygkbmFtZSksIDIpOwoKICAgICAgICAvLyBzaXplIG9mIHRoZSBmb3JtdWxhIChpbiBieXRlcykKICAgICAgICAkc3ogPSBzdHJsZW4oJGZvcm11bGFEYXRhKTsKCiAgICAgICAgLy8gY29tYmluZSB0aGUgcGFydHMKICAgICAgICAkZGF0YSA9IHBhY2soJ3ZDQ3Z2dkNDQ0MnLCAkb3B0aW9ucywgMCwgJG5sZW4sICRzeiwgMCwgJHNoZWV0SW5kZXgsIDAsIDAsIDAsIDApCiAgICAgICAgICAgIC4gJG5hbWUgLiAkZm9ybXVsYURhdGE7CiAgICAgICAgJGxlbmd0aCA9IHN0cmxlbigkZGF0YSk7CgogICAgICAgICRoZWFkZXIgPSBwYWNrKCd2dicsICRyZWNvcmQsICRsZW5ndGgpOwoKICAgICAgICByZXR1cm4gJGhlYWRlciAuICRkYXRhOwogICAgfQoKICAgIC8qKgogICAgICogV3JpdGUgYSBzaG9ydCBOQU1FIHJlY29yZAogICAgICoKICAgICAqIEBwYXJhbSAgICBzdHJpbmcgICAgICAgICAkbmFtZQogICAgICogQHBhcmFtICAgIHN0cmluZyAgICAgICAgICRzaGVldEluZGV4ICAgICAgICAxLWJhc2VkIHNoZWV0IGluZGV4IHRoZSBkZWZpbmVkIG5hbWUgYXBwbGllcyB0by4gMCA9IGdsb2JhbAogICAgICogQHBhcmFtICAgIGludGVnZXJbXVtdICAkcmFuZ2VCb3VuZHMgICAgcmFuZ2UgYm91bmRhcmllcwogICAgICogQHBhcmFtICAgIGJvb2xlYW4gICAgICAkaXNIaWRkZW4KICAgICAqIEByZXR1cm4gICAgc3RyaW5nICAgIENvbXBsZXRlIGJpbmFyeSByZWNvcmQgZGF0YQogICAgICogKi8KICAgIHByaXZhdGUgZnVuY3Rpb24gd3JpdGVTaG9ydE5hbWVCaWZmOCgkbmFtZSwgJHNoZWV0SW5kZXggPSAwLCAkcmFuZ2VCb3VuZHMsICRpc0hpZGRlbiA9IGZhbHNlKQogICAgewogICAgICAgICRyZWNvcmQgPSAweDAwMTg7CgogICAgICAgIC8vIG9wdGlvbiBmbGFncwogICAgICAgICRvcHRpb25zID0gKCRpc0hpZGRlbiAgPyAweDIxIDogMHgwMCk7CgogICAgICAgICRleHRyYSAgPSBwYWNrKAogICAgICAgICAgICAnQ3Z2dnZ2JywKICAgICAgICAgICAgMHgzQiwKICAgICAgICAgICAgJHNoZWV0SW5kZXggLSAxLAogICAgICAgICAgICAkcmFuZ2VCb3VuZHNbMF1bMV0gLSAxLAogICAgICAgICAgICAkcmFuZ2VCb3VuZHNbMV1bMV0gLSAxLAogICAgICAgICAgICAkcmFuZ2VCb3VuZHNbMF1bMF0gLSAxLAogICAgICAgICAgICAkcmFuZ2VCb3VuZHNbMV1bMF0gLSAxCiAgICAgICAgKTsKCiAgICAgICAgLy8gc2l6ZSBvZiB0aGUgZm9ybXVsYSAoaW4gYnl0ZXMpCiAgICAgICAgJHN6ID0gc3RybGVuKCRleHRyYSk7CgogICAgICAgIC8vIGNvbWJpbmUgdGhlIHBhcnRzCiAgICAgICAgJGRhdGEgPSBwYWNrKCd2Q0N2dnZDQ0NDQycsICRvcHRpb25zLCAwLCAxLCAkc3osIDAsICRzaGVldEluZGV4LCAwLCAwLCAwLCAwLCAwKQogICAgICAgICAgICAuICRuYW1lIC4gJGV4dHJhOwogICAgICAgICRsZW5ndGggPSBzdHJsZW4oJGRhdGEpOwoKICAgICAgICAkaGVhZGVyID0gcGFjaygndnYnLCAkcmVjb3JkLCAkbGVuZ3RoKTsKCiAgICAgICAgcmV0dXJuICRoZWFkZXIgLiAkZGF0YTsKICAgIH0KCiAgICAvKioKICAgICAqIFN0b3JlcyB0aGUgQ09ERVBBR0UgYmlmZiByZWNvcmQuCiAgICAgKi8KICAgIHByaXZhdGUgZnVuY3Rpb24gd3JpdGVDb2RlcGFnZSgpCiAgICB7CiAgICAgICAgJHJlY29yZCA9IDB4MDA0MjsgICAgICAgICAgICAgLy8gUmVjb3JkIGlkZW50aWZpZXIKICAgICAgICAkbGVuZ3RoID0gMHgwMDAyOyAgICAgICAgICAgICAvLyBOdW1iZXIgb2YgYnl0ZXMgdG8gZm9sbG93CiAgICAgICAgJGN2ICA9ICR0aGlzLT5jb2RlcGFnZTsgICAvLyBUaGUgY29kZSBwYWdlCgogICAgICAgICRoZWFkZXIgPSBwYWNrKCd2dicsICRyZWNvcmQsICRsZW5ndGgpOwogICAgICAgICRkYXRhICAgPSBwYWNrKCd2JywgJGN2KTsKCiAgICAgICAgJHRoaXMtPmFwcGVuZCgkaGVhZGVyIC4gJGRhdGEpOwogICAgfQoKICAgIC8qKgogICAgICogV3JpdGUgRXhjZWwgQklGRiBXSU5ET1cxIHJlY29yZC4KICAgICAqLwogICAgcHJpdmF0ZSBmdW5jdGlvbiB3cml0ZVdpbmRvdzEoKQogICAgewogICAgICAgICRyZWNvcmQgPSAweDAwM0Q7ICAgLy8gUmVjb3JkIGlkZW50aWZpZXIKICAgICAgICAkbGVuZ3RoID0gMHgwMDEyOyAgIC8vIE51bWJlciBvZiBieXRlcyB0byBmb2xsb3cKCiAgICAgICAgJHhXbiAgPSAweDAwMDA7ICAgICAvLyBIb3Jpem9udGFsIHBvc2l0aW9uIG9mIHdpbmRvdwogICAgICAgICR5V24gID0gMHgwMDAwOyAgICAgLy8gVmVydGljYWwgcG9zaXRpb24gb2Ygd2luZG93CiAgICAgICAgJGR4V24gPSAweDI1QkM7ICAgICAvLyBXaWR0aCBvZiB3aW5kb3cKICAgICAgICAkZHlXbiA9IDB4MTU3MjsgICAgIC8vIEhlaWdodCBvZiB3aW5kb3cKCiAgICAgICAgJGdyYml0ID0gMHgwMDM4OyAgICAvLyBPcHRpb24gZmxhZ3MKCiAgICAgICAgLy8gbm90IHN1cHBvcnRlZCBieSBQSFBFeGNlbCwgc28gdGhlcmUgaXMgb25seSBvbmUgc2VsZWN0ZWQgc2hlZXQsIHRoZSBhY3RpdmUKICAgICAgICAkY3RhYnNlbCA9IDE7ICAgICAgIC8vIE51bWJlciBvZiB3b3JrYm9vayB0YWJzIHNlbGVjdGVkCgogICAgICAgICR3VGFiUmF0aW8gPSAweDAyNTg7ICAgIC8vIFRhYiB0byBzY3JvbGxiYXIgcmF0aW8KCiAgICAgICAgLy8gbm90IHN1cHBvcnRlZCBieSBQSFBFeGNlbCwgc2V0IHRvIDAKICAgICAgICAkaXRhYkZpcnN0ID0gMDsgICAgIC8vIDFzdCBkaXNwbGF5ZWQgd29ya3NoZWV0CiAgICAgICAgJGl0YWJDdXIgICA9ICR0aGlzLT5waHBFeGNlbC0+Z2V0QWN0aXZlU2hlZXRJbmRleCgpOyAgICAvLyBBY3RpdmUgd29ya3NoZWV0CgogICAgICAgICRoZWFkZXIgPSBwYWNrKCJ2diIsICRyZWNvcmQsICRsZW5ndGgpOwogICAgICAgICRkYXRhICAgPSBwYWNrKCJ2dnZ2dnZ2dnYiLCAkeFduLCAkeVduLCAkZHhXbiwgJGR5V24sICRncmJpdCwgJGl0YWJDdXIsICRpdGFiRmlyc3QsICRjdGFic2VsLCAkd1RhYlJhdGlvKTsKICAgICAgICAkdGhpcy0+YXBwZW5kKCRoZWFkZXIgLiAkZGF0YSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBXcml0ZXMgRXhjZWwgQklGRiBCT1VORFNIRUVUIHJlY29yZC4KICAgICAqCiAgICAgKiBAcGFyYW0gUEhQRXhjZWxfV29ya3NoZWV0ICAkc2hlZXQgV29ya3NoZWV0IG5hbWUKICAgICAqIEBwYXJhbSBpbnRlZ2VyICRvZmZzZXQgICAgTG9jYXRpb24gb2Ygd29ya3NoZWV0IEJPRgogICAgICovCiAgICBwcml2YXRlIGZ1bmN0aW9uIHdyaXRlQm91bmRTaGVldCgkc2hlZXQsICRvZmZzZXQpCiAgICB7CiAgICAgICAgJHNoZWV0bmFtZSA9ICRzaGVldC0+Z2V0VGl0bGUoKTsKICAgICAgICAkcmVjb3JkICAgID0gMHgwMDg1OyAgICAgICAgICAgICAgICAgICAgLy8gUmVjb3JkIGlkZW50aWZpZXIKCiAgICAgICAgLy8gc2hlZXQgc3RhdGUKICAgICAgICBzd2l0Y2ggKCRzaGVldC0+Z2V0U2hlZXRTdGF0ZSgpKSB7CiAgICAgICAgICAgIGNhc2UgUEhQRXhjZWxfV29ya3NoZWV0OjpTSEVFVFNUQVRFX1ZJU0lCTEU6CiAgICAgICAgICAgICAgICAkc3MgPSAweDAwOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgUEhQRXhjZWxfV29ya3NoZWV0OjpTSEVFVFNUQVRFX0hJRERFTjoKICAgICAgICAgICAgICAgICRzcyA9IDB4MDE7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBQSFBFeGNlbF9Xb3Jrc2hlZXQ6OlNIRUVUU1RBVEVfVkVSWUhJRERFTjoKICAgICAgICAgICAgICAgICRzcyA9IDB4MDI7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICRzcyA9IDB4MDA7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIC8vIHNoZWV0IHR5cGUKICAgICAgICAkc3QgPSAweDAwOwoKICAgICAgICAkZ3JiaXQgPSAweDAwMDA7ICAgICAgICAgICAgICAgICAgICAvLyBWaXNpYmlsaXR5IGFuZCBzaGVldCB0eXBlCgogICAgICAgICRkYXRhID0gcGFjaygiVkNDIiwgJG9mZnNldCwgJHNzLCAkc3QpOwogICAgICAgICRkYXRhIC49IFBIUEV4Y2VsX1NoYXJlZF9TdHJpbmc6OlVURjh0b0JJRkY4VW5pY29kZVNob3J0KCRzaGVldG5hbWUpOwoKICAgICAgICAkbGVuZ3RoID0gc3RybGVuKCRkYXRhKTsKICAgICAgICAkaGVhZGVyID0gcGFjaygidnYiLCAkcmVjb3JkLCAkbGVuZ3RoKTsKICAgICAgICAkdGhpcy0+YXBwZW5kKCRoZWFkZXIgLiAkZGF0YSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBXcml0ZSBJbnRlcm5hbCBTVVBCT09LIHJlY29yZAogICAgICovCiAgICBwcml2YXRlIGZ1bmN0aW9uIHdyaXRlU3VwYm9va0ludGVybmFsKCkKICAgIHsKICAgICAgICAkcmVjb3JkICAgID0gMHgwMUFFOyAgIC8vIFJlY29yZCBpZGVudGlmaWVyCiAgICAgICAgJGxlbmd0aCAgICA9IDB4MDAwNDsgICAvLyBCeXRlcyB0byBmb2xsb3cKCiAgICAgICAgJGhlYWRlciAgICA9IHBhY2soInZ2IiwgJHJlY29yZCwgJGxlbmd0aCk7CiAgICAgICAgJGRhdGEgICAgICA9IHBhY2soInZ2IiwgJHRoaXMtPnBocEV4Y2VsLT5nZXRTaGVldENvdW50KCksIDB4MDQwMSk7CiAgICAgICAgcmV0dXJuICR0aGlzLT53cml0ZURhdGEoJGhlYWRlciAuICRkYXRhKTsKICAgIH0KCiAgICAvKioKICAgICAqIFdyaXRlcyB0aGUgRXhjZWwgQklGRiBFWFRFUk5TSEVFVCByZWNvcmQuIFRoZXNlIHJlZmVyZW5jZXMgYXJlIHVzZWQgYnkKICAgICAqIGZvcm11bGFzLgogICAgICoKICAgICAqLwogICAgcHJpdmF0ZSBmdW5jdGlvbiB3cml0ZUV4dGVybmFsc2hlZXRCaWZmOCgpCiAgICB7CiAgICAgICAgJHRvdGFsUmVmZXJlbmNlcyA9IGNvdW50KCR0aGlzLT5wYXJzZXItPnJlZmVyZW5jZXMpOwogICAgICAgICRyZWNvcmQgPSAweDAwMTc7ICAgICAgICAgICAgICAgICAgICAgLy8gUmVjb3JkIGlkZW50aWZpZXIKICAgICAgICAkbGVuZ3RoID0gMiArIDYgKiAkdG90YWxSZWZlcmVuY2VzOyAgLy8gTnVtYmVyIG9mIGJ5dGVzIHRvIGZvbGxvdwoKICAgICAgICAkc3VwYm9va19pbmRleCA9IDA7ICAgICAgICAgICAvLyBGSVhNRTogb25seSB1c2luZyBpbnRlcm5hbCBTVVBCT09LIHJlY29yZAogICAgICAgICRoZWFkZXIgPSBwYWNrKCJ2diIsICRyZWNvcmQsICRsZW5ndGgpOwogICAgICAgICRkYXRhICAgPSBwYWNrKCd2JywgJHRvdGFsUmVmZXJlbmNlcyk7CiAgICAgICAgZm9yICgkaSA9IDA7ICRpIDwgJHRvdGFsUmVmZXJlbmNlczsgKyskaSkgewogICAgICAgICAgICAkZGF0YSAuPSAkdGhpcy0+cGFyc2VyLT5yZWZlcmVuY2VzWyRpXTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICR0aGlzLT53cml0ZURhdGEoJGhlYWRlciAuICRkYXRhKTsKICAgIH0KCiAgICAvKioKICAgICAqIFdyaXRlIEV4Y2VsIEJJRkYgU1RZTEUgcmVjb3Jkcy4KICAgICAqLwogICAgcHJpdmF0ZSBmdW5jdGlvbiB3cml0ZVN0eWxlKCkKICAgIHsKICAgICAgICAkcmVjb3JkID0gMHgwMjkzOyAgIC8vIFJlY29yZCBpZGVudGlmaWVyCiAgICAgICAgJGxlbmd0aCA9IDB4MDAwNDsgICAvLyBCeXRlcyB0byBmb2xsb3cKCiAgICAgICAgJGl4ZmUgICAgPSAweDgwMDA7ICAvLyBJbmRleCB0byBjZWxsIHN0eWxlIFhGCiAgICAgICAgJEJ1aWx0SW4gPSAweDAwOyAgICAgLy8gQnVpbHQtaW4gc3R5bGUKICAgICAgICAkaUxldmVsICA9IDB4ZmY7ICAgICAvLyBPdXRsaW5lIHN0eWxlIGxldmVsCgogICAgICAgICRoZWFkZXIgPSBwYWNrKCJ2diIsICRyZWNvcmQsICRsZW5ndGgpOwogICAgICAgICRkYXRhICAgPSBwYWNrKCJ2Q0MiLCAkaXhmZSwgJEJ1aWx0SW4sICRpTGV2ZWwpOwogICAgICAgICR0aGlzLT5hcHBlbmQoJGhlYWRlciAuICRkYXRhKTsKICAgIH0KCiAgICAvKioKICAgICAqIFdyaXRlcyBFeGNlbCBGT1JNQVQgcmVjb3JkIGZvciBub24gImJ1aWx0LWluIiBudW1lcmljYWwgZm9ybWF0cy4KICAgICAqCiAgICAgKiBAcGFyYW0gc3RyaW5nICAkZm9ybWF0IEN1c3RvbSBmb3JtYXQgc3RyaW5nCiAgICAgKiBAcGFyYW0gaW50ZWdlciAkaWZtdCAgIEZvcm1hdCBpbmRleCBjb2RlCiAgICAgKi8KICAgIHByaXZhdGUgZnVuY3Rpb24gd3JpdGVOdW1iZXJGb3JtYXQoJGZvcm1hdCwgJGlmbXQpCiAgICB7CiAgICAgICAgJHJlY29yZCA9IDB4MDQxRTsgICAgLy8gUmVjb3JkIGlkZW50aWZpZXIKCiAgICAgICAgJG51bWJlckZvcm1hdFN0cmluZyA9IFBIUEV4Y2VsX1NoYXJlZF9TdHJpbmc6OlVURjh0b0JJRkY4VW5pY29kZUxvbmcoJGZvcm1hdCk7CiAgICAgICAgJGxlbmd0aCA9IDIgKyBzdHJsZW4oJG51bWJlckZvcm1hdFN0cmluZyk7ICAgIC8vIE51bWJlciBvZiBieXRlcyB0byBmb2xsb3cKCgogICAgICAgICRoZWFkZXIgPSBwYWNrKCJ2diIsICRyZWNvcmQsICRsZW5ndGgpOwogICAgICAgICRkYXRhICAgPSBwYWNrKCJ2IiwgJGlmbXQpIC4gICRudW1iZXJGb3JtYXRTdHJpbmc7CiAgICAgICAgJHRoaXMtPmFwcGVuZCgkaGVhZGVyIC4gJGRhdGEpOwogICAgfQoKICAgIC8qKgogICAgICogV3JpdGUgREFURU1PREUgcmVjb3JkIHRvIGluZGljYXRlIHRoZSBkYXRlIHN5c3RlbSBpbiB1c2UgKDE5MDQgb3IgMTkwMCkuCiAgICAgKi8KICAgIHByaXZhdGUgZnVuY3Rpb24gd3JpdGVEYXRlTW9kZSgpCiAgICB7CiAgICAgICAgJHJlY29yZCA9IDB4MDAyMjsgICAvLyBSZWNvcmQgaWRlbnRpZmllcgogICAgICAgICRsZW5ndGggPSAweDAwMDI7ICAgLy8gQnl0ZXMgdG8gZm9sbG93CgogICAgICAgICRmMTkwNCAgPSAoUEhQRXhjZWxfU2hhcmVkX0RhdGU6OmdldEV4Y2VsQ2FsZW5kYXIoKSA9PSBQSFBFeGNlbF9TaGFyZWRfRGF0ZTo6Q0FMRU5EQVJfTUFDXzE5MDQpCiAgICAgICAgICAgID8gMQogICAgICAgICAgICA6IDA7ICAgLy8gRmxhZyBmb3IgMTkwNCBkYXRlIHN5c3RlbQoKICAgICAgICAkaGVhZGVyID0gcGFjaygidnYiLCAkcmVjb3JkLCAkbGVuZ3RoKTsKICAgICAgICAkZGF0YSAgID0gcGFjaygidiIsICRmMTkwNCk7CiAgICAgICAgJHRoaXMtPmFwcGVuZCgkaGVhZGVyIC4gJGRhdGEpOwogICAgfQoKICAgIC8qKgogICAgICogV3JpdGUgQklGRiByZWNvcmQgRVhURVJOQ09VTlQgdG8gaW5kaWNhdGUgdGhlIG51bWJlciBvZiBleHRlcm5hbCBzaGVldAogICAgICogcmVmZXJlbmNlcyBpbiB0aGUgd29ya2Jvb2suCiAgICAgKgogICAgICogRXhjZWwgb25seSBzdG9yZXMgcmVmZXJlbmNlcyB0byBleHRlcm5hbCBzaGVldHMgdGhhdCBhcmUgdXNlZCBpbiBOQU1FLgogICAgICogVGhlIHdvcmtib29rIE5BTUUgcmVjb3JkIGlzIHJlcXVpcmVkIHRvIGRlZmluZSB0aGUgcHJpbnQgYXJlYSBhbmQgdGhlIHJlcGVhdAogICAgICogcm93cyBhbmQgY29sdW1ucy4KICAgICAqCiAgICAgKiBBIHNpbWlsYXIgbWV0aG9kIGlzIHVzZWQgaW4gV29ya3NoZWV0LnBocCBmb3IgYSBzbGlnaHRseSBkaWZmZXJlbnQgcHVycG9zZS4KICAgICAqCiAgICAgKiBAcGFyYW0gaW50ZWdlciAkY3hhbHMgTnVtYmVyIG9mIGV4dGVybmFsIHJlZmVyZW5jZXMKICAgICAqLwogICAgcHJpdmF0ZSBmdW5jdGlvbiB3cml0ZUV4dGVybmFsQ291bnQoJGN4YWxzKQogICAgewogICAgICAgICRyZWNvcmQgPSAweDAwMTY7ICAgLy8gUmVjb3JkIGlkZW50aWZpZXIKICAgICAgICAkbGVuZ3RoID0gMHgwMDAyOyAgIC8vIE51bWJlciBvZiBieXRlcyB0byBmb2xsb3cKCiAgICAgICAgJGhlYWRlciA9IHBhY2soInZ2IiwgJHJlY29yZCwgJGxlbmd0aCk7CiAgICAgICAgJGRhdGEgICA9IHBhY2soInYiLCAkY3hhbHMpOwogICAgICAgICR0aGlzLT5hcHBlbmQoJGhlYWRlciAuICRkYXRhKTsKICAgIH0KCiAgICAvKioKICAgICAqIFdyaXRlcyB0aGUgRXhjZWwgQklGRiBFWFRFUk5TSEVFVCByZWNvcmQuIFRoZXNlIHJlZmVyZW5jZXMgYXJlIHVzZWQgYnkKICAgICAqIGZvcm11bGFzLiBOQU1FIHJlY29yZCBpcyByZXF1aXJlZCB0byBkZWZpbmUgdGhlIHByaW50IGFyZWEgYW5kIHRoZSByZXBlYXQKICAgICAqIHJvd3MgYW5kIGNvbHVtbnMuCiAgICAgKgogICAgICogQSBzaW1pbGFyIG1ldGhvZCBpcyB1c2VkIGluIFdvcmtzaGVldC5waHAgZm9yIGEgc2xpZ2h0bHkgZGlmZmVyZW50IHB1cnBvc2UuCiAgICAgKgogICAgICogQHBhcmFtIHN0cmluZyAkc2hlZXRuYW1lIFdvcmtzaGVldCBuYW1lCiAgICAgKi8KICAgIHByaXZhdGUgZnVuY3Rpb24gd3JpdGVFeHRlcm5hbFNoZWV0KCRzaGVldG5hbWUpCiAgICB7CiAgICAgICAgJHJlY29yZCA9IDB4MDAxNzsgICAgICAgICAgICAgICAgICAgICAvLyBSZWNvcmQgaWRlbnRpZmllcgogICAgICAgICRsZW5ndGggPSAweDAyICsgc3RybGVuKCRzaGVldG5hbWUpOyAgLy8gTnVtYmVyIG9mIGJ5dGVzIHRvIGZvbGxvdwoKICAgICAgICAkY2NoICAgID0gc3RybGVuKCRzaGVldG5hbWUpOyAgICAgICAgIC8vIExlbmd0aCBvZiBzaGVldCBuYW1lCiAgICAgICAgJHJnY2ggICA9IDB4MDM7ICAgICAgICAgICAgICAgICAgICAgICAvLyBGaWxlbmFtZSBlbmNvZGluZwoKICAgICAgICAkaGVhZGVyID0gcGFjaygidnYiLCAkcmVjb3JkLCAkbGVuZ3RoKTsKICAgICAgICAkZGF0YSAgID0gcGFjaygiQ0MiLCAkY2NoLCAkcmdjaCk7CiAgICAgICAgJHRoaXMtPmFwcGVuZCgkaGVhZGVyIC4gJGRhdGEgLiAkc2hlZXRuYW1lKTsKICAgIH0KCiAgICAvKioKICAgICAqIFN0b3JlIHRoZSBOQU1FIHJlY29yZCBpbiB0aGUgc2hvcnQgZm9ybWF0IHRoYXQgaXMgdXNlZCBmb3Igc3RvcmluZyB0aGUgcHJpbnQKICAgICAqIGFyZWEsIHJlcGVhdCByb3dzIG9ubHkgYW5kIHJlcGVhdCBjb2x1bW5zIG9ubHkuCiAgICAgKgogICAgICogQHBhcmFtIGludGVnZXIgJGluZGV4ICBTaGVldCBpbmRleAogICAgICogQHBhcmFtIGludGVnZXIgJHR5cGUgICBCdWlsdC1pbiBuYW1lIHR5cGUKICAgICAqIEBwYXJhbSBpbnRlZ2VyICRyb3dtaW4gU3RhcnQgcm93CiAgICAgKiBAcGFyYW0gaW50ZWdlciAkcm93bWF4IEVuZCByb3cKICAgICAqIEBwYXJhbSBpbnRlZ2VyICRjb2xtaW4gU3RhcnQgY29sdW0KICAgICAqIEBwYXJhbSBpbnRlZ2VyICRjb2xtYXggRW5kIGNvbHVtbgogICAgICovCiAgICBwcml2YXRlIGZ1bmN0aW9uIHdyaXRlTmFtZVNob3J0KCRpbmRleCwgJHR5cGUsICRyb3dtaW4sICRyb3dtYXgsICRjb2xtaW4sICRjb2xtYXgpCiAgICB7CiAgICAgICAgJHJlY29yZCA9IDB4MDAxODsgICAgICAgLy8gUmVjb3JkIGlkZW50aWZpZXIKICAgICAgICAkbGVuZ3RoID0gMHgwMDI0OyAgICAgICAvLyBOdW1iZXIgb2YgYnl0ZXMgdG8gZm9sbG93CgogICAgICAgICRncmJpdCAgPSAweDAwMjA7ICAgICAgIC8vIE9wdGlvbiBmbGFncwogICAgICAgICRjaEtleSAgPSAweDAwOyAgICAgICAgIC8vIEtleWJvYXJkIHNob3J0Y3V0CiAgICAgICAgJGNjaCAgICA9IDB4MDE7ICAgICAgICAgLy8gTGVuZ3RoIG9mIHRleHQgbmFtZQogICAgICAgICRjY2UgICAgPSAweDAwMTU7ICAgICAgIC8vIExlbmd0aCBvZiB0ZXh0IGRlZmluaXRpb24KICAgICAgICAkaXhhbHMgID0gJGluZGV4ICsgMTsgICAvLyBTaGVldCBpbmRleAogICAgICAgICRpdGFiICAgPSAkaXhhbHM7ICAgICAgIC8vIEVxdWFsIHRvIGl4YWxzCiAgICAgICAgJGNjaEN1c3RNZW51ICAgID0gMHgwMDsgICAgICAgICAvLyBMZW5ndGggb2YgY3VzdCBtZW51IHRleHQKICAgICAgICAkY2NoRGVzY3JpcHRpb24gPSAweDAwOyAgICAgICAgIC8vIExlbmd0aCBvZiBkZXNjcmlwdGlvbiB0ZXh0CiAgICAgICAgJGNjaEhlbHB0b3BpYyAgID0gMHgwMDsgICAgICAgICAvLyBMZW5ndGggb2YgaGVscCB0b3BpYyB0ZXh0CiAgICAgICAgJGNjaFN0YXR1c3RleHQgID0gMHgwMDsgICAgICAgICAvLyBMZW5ndGggb2Ygc3RhdHVzIGJhciB0ZXh0CiAgICAgICAgJHJnY2ggICAgICAgICAgID0gJHR5cGU7ICAgICAgICAvLyBCdWlsdC1pbiBuYW1lIHR5cGUKCiAgICAgICAgJHVua25vd24wMyA9IDB4M2I7CiAgICAgICAgJHVua25vd24wNCA9IDB4ZmZmZiAtICRpbmRleDsKICAgICAgICAkdW5rbm93bjA1ID0gMHgwMDAwOwogICAgICAgICR1bmtub3duMDYgPSAweDAwMDA7CiAgICAgICAgJHVua25vd24wNyA9IDB4MTA4NzsKICAgICAgICAkdW5rbm93bjA4ID0gMHg4MDA1OwoKICAgICAgICAkaGVhZGVyID0gcGFjaygidnYiLCAkcmVjb3JkLCAkbGVuZ3RoKTsKICAgICAgICAkZGF0YSA9IHBhY2soInYiLCAkZ3JiaXQpOwogICAgICAgICRkYXRhIC49IHBhY2soIkMiLCAkY2hLZXkpOwogICAgICAgICRkYXRhIC49IHBhY2soIkMiLCAkY2NoKTsKICAgICAgICAkZGF0YSAuPSBwYWNrKCJ2IiwgJGNjZSk7CiAgICAgICAgJGRhdGEgLj0gcGFjaygidiIsICRpeGFscyk7CiAgICAgICAgJGRhdGEgLj0gcGFjaygidiIsICRpdGFiKTsKICAgICAgICAkZGF0YSAuPSBwYWNrKCJDIiwgJGNjaEN1c3RNZW51KTsKICAgICAgICAkZGF0YSAuPSBwYWNrKCJDIiwgJGNjaERlc2NyaXB0aW9uKTsKICAgICAgICAkZGF0YSAuPSBwYWNrKCJDIiwgJGNjaEhlbHB0b3BpYyk7CiAgICAgICAgJGRhdGEgLj0gcGFjaygiQyIsICRjY2hTdGF0dXN0ZXh0KTsKICAgICAgICAkZGF0YSAuPSBwYWNrKCJDIiwgJHJnY2gpOwogICAgICAgICRkYXRhIC49IHBhY2soIkMiLCAkdW5rbm93bjAzKTsKICAgICAgICAkZGF0YSAuPSBwYWNrKCJ2IiwgJHVua25vd24wNCk7CiAgICAgICAgJGRhdGEgLj0gcGFjaygidiIsICR1bmtub3duMDUpOwogICAgICAgICRkYXRhIC49IHBhY2soInYiLCAkdW5rbm93bjA2KTsKICAgICAgICAkZGF0YSAuPSBwYWNrKCJ2IiwgJHVua25vd24wNyk7CiAgICAgICAgJGRhdGEgLj0gcGFjaygidiIsICR1bmtub3duMDgpOwogICAgICAgICRkYXRhIC49IHBhY2soInYiLCAkaW5kZXgpOwogICAgICAgICRkYXRhIC49IHBhY2soInYiLCAkaW5kZXgpOwogICAgICAgICRkYXRhIC49IHBhY2soInYiLCAkcm93bWluKTsKICAgICAgICAkZGF0YSAuPSBwYWNrKCJ2IiwgJHJvd21heCk7CiAgICAgICAgJGRhdGEgLj0gcGFjaygiQyIsICRjb2xtaW4pOwogICAgICAgICRkYXRhIC49IHBhY2soIkMiLCAkY29sbWF4KTsKICAgICAgICAkdGhpcy0+YXBwZW5kKCRoZWFkZXIgLiAkZGF0YSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTdG9yZSB0aGUgTkFNRSByZWNvcmQgaW4gdGhlIGxvbmcgZm9ybWF0IHRoYXQgaXMgdXNlZCBmb3Igc3RvcmluZyB0aGUgcmVwZWF0CiAgICAgKiByb3dzIGFuZCBjb2x1bW5zIHdoZW4gYm90aCBhcmUgc3BlY2lmaWVkLiBUaGlzIHNoYXJlcyBhIGxvdCBvZiBjb2RlIHdpdGgKICAgICAqIHdyaXRlTmFtZVNob3J0KCkgYnV0IHdlIHVzZSBhIHNlcGFyYXRlIG1ldGhvZCB0byBrZWVwIHRoZSBjb2RlIGNsZWFuLgogICAgICogQ29kZSBhYnN0cmFjdGlvbiBmb3IgcmV1c2UgY2FuIGJlIGNhcnJpZWQgdG9vIGZhciwgYW5kIEkgc2hvdWxkIGtub3cuIDstKQogICAgICoKICAgICAqIEBwYXJhbSBpbnRlZ2VyICRpbmRleCBTaGVldCBpbmRleAogICAgICogQHBhcmFtIGludGVnZXIgJHR5cGUgIEJ1aWx0LWluIG5hbWUgdHlwZQogICAgICogQHBhcmFtIGludGVnZXIgJHJvd21pbiBTdGFydCByb3cKICAgICAqIEBwYXJhbSBpbnRlZ2VyICRyb3dtYXggRW5kIHJvdwogICAgICogQHBhcmFtIGludGVnZXIgJGNvbG1pbiBTdGFydCBjb2x1bQogICAgICogQHBhcmFtIGludGVnZXIgJGNvbG1heCBFbmQgY29sdW1uCiAgICAgKi8KICAgIHByaXZhdGUgZnVuY3Rpb24gd3JpdGVOYW1lTG9uZygkaW5kZXgsICR0eXBlLCAkcm93bWluLCAkcm93bWF4LCAkY29sbWluLCAkY29sbWF4KQogICAgewogICAgICAgICRyZWNvcmQgICAgICAgICAgPSAweDAwMTg7ICAgICAgIC8vIFJlY29yZCBpZGVudGlmaWVyCiAgICAgICAgJGxlbmd0aCAgICAgICAgICA9IDB4MDAzZDsgICAgICAgLy8gTnVtYmVyIG9mIGJ5dGVzIHRvIGZvbGxvdwogICAgICAgICRncmJpdCAgICAgICAgICAgPSAweDAwMjA7ICAgICAgIC8vIE9wdGlvbiBmbGFncwogICAgICAgICRjaEtleSAgICAgICAgICAgPSAweDAwOyAgICAgICAgIC8vIEtleWJvYXJkIHNob3J0Y3V0CiAgICAgICAgJGNjaCAgICAgICAgICAgICA9IDB4MDE7ICAgICAgICAgLy8gTGVuZ3RoIG9mIHRleHQgbmFtZQogICAgICAgICRjY2UgICAgICAgICAgICAgPSAweDAwMmU7ICAgICAgIC8vIExlbmd0aCBvZiB0ZXh0IGRlZmluaXRpb24KICAgICAgICAkaXhhbHMgICAgICAgICAgID0gJGluZGV4ICsgMTsgICAvLyBTaGVldCBpbmRleAogICAgICAgICRpdGFiICAgICAgICAgICAgPSAkaXhhbHM7ICAgICAgIC8vIEVxdWFsIHRvIGl4YWxzCiAgICAgICAgJGNjaEN1c3RNZW51ICAgICA9IDB4MDA7ICAgICAgICAgLy8gTGVuZ3RoIG9mIGN1c3QgbWVudSB0ZXh0CiAgICAgICAgJGNjaERlc2NyaXB0aW9uICA9IDB4MDA7ICAgICAgICAgLy8gTGVuZ3RoIG9mIGRlc2NyaXB0aW9uIHRleHQKICAgICAgICAkY2NoSGVscHRvcGljICAgID0gMHgwMDsgICAgICAgICAvLyBMZW5ndGggb2YgaGVscCB0b3BpYyB0ZXh0CiAgICAgICAgJGNjaFN0YXR1c3RleHQgICA9IDB4MDA7ICAgICAgICAgLy8gTGVuZ3RoIG9mIHN0YXR1cyBiYXIgdGV4dAogICAgICAgICRyZ2NoICAgICAgICAgICAgPSAkdHlwZTsgICAgICAgIC8vIEJ1aWx0LWluIG5hbWUgdHlwZQoKICAgICAgICAkdW5rbm93bjAxICAgICAgID0gMHgyOTsKICAgICAgICAkdW5rbm93bjAyICAgICAgID0gMHgwMDJiOwogICAgICAgICR1bmtub3duMDMgICAgICAgPSAweDNiOwogICAgICAgICR1bmtub3duMDQgICAgICAgPSAweGZmZmYtJGluZGV4OwogICAgICAgICR1bmtub3duMDUgICAgICAgPSAweDAwMDA7CiAgICAgICAgJHVua25vd24wNiAgICAgICA9IDB4MDAwMDsKICAgICAgICAkdW5rbm93bjA3ICAgICAgID0gMHgxMDg3OwogICAgICAgICR1bmtub3duMDggICAgICAgPSAweDgwMDg7CgogICAgICAgICRoZWFkZXIgPSBwYWNrKCJ2diIsICRyZWNvcmQsICRsZW5ndGgpOwogICAgICAgICRkYXRhID0gcGFjaygidiIsICRncmJpdCk7CiAgICAgICAgJGRhdGEgLj0gcGFjaygiQyIsICRjaEtleSk7CiAgICAgICAgJGRhdGEgLj0gcGFjaygiQyIsICRjY2gpOwogICAgICAgICRkYXRhIC49IHBhY2soInYiLCAkY2NlKTsKICAgICAgICAkZGF0YSAuPSBwYWNrKCJ2IiwgJGl4YWxzKTsKICAgICAgICAkZGF0YSAuPSBwYWNrKCJ2IiwgJGl0YWIpOwogICAgICAgICRkYXRhIC49IHBhY2soIkMiLCAkY2NoQ3VzdE1lbnUpOwogICAgICAgICRkYXRhIC49IHBhY2soIkMiLCAkY2NoRGVzY3JpcHRpb24pOwogICAgICAgICRkYXRhIC49IHBhY2soIkMiLCAkY2NoSGVscHRvcGljKTsKICAgICAgICAkZGF0YSAuPSBwYWNrKCJDIiwgJGNjaFN0YXR1c3RleHQpOwogICAgICAgICRkYXRhIC49IHBhY2soIkMiLCAkcmdjaCk7CiAgICAgICAgJGRhdGEgLj0gcGFjaygiQyIsICR1bmtub3duMDEpOwogICAgICAgICRkYXRhIC49IHBhY2soInYiLCAkdW5rbm93bjAyKTsKICAgICAgICAvLyBDb2x1bW4gZGVmaW5pdGlvbgogICAgICAgICRkYXRhIC49IHBhY2soIkMiLCAkdW5rbm93bjAzKTsKICAgICAgICAkZGF0YSAuPSBwYWNrKCJ2IiwgJHVua25vd24wNCk7CiAgICAgICAgJGRhdGEgLj0gcGFjaygidiIsICR1bmtub3duMDUpOwogICAgICAgICRkYXRhIC49IHBhY2soInYiLCAkdW5rbm93bjA2KTsKICAgICAgICAkZGF0YSAuPSBwYWNrKCJ2IiwgJHVua25vd24wNyk7CiAgICAgICAgJGRhdGEgLj0gcGFjaygidiIsICR1bmtub3duMDgpOwogICAgICAgICRkYXRhIC49IHBhY2soInYiLCAkaW5kZXgpOwogICAgICAgICRkYXRhIC49IHBhY2soInYiLCAkaW5kZXgpOwogICAgICAgICRkYXRhIC49IHBhY2soInYiLCAweDAwMDApOwogICAgICAgICRkYXRhIC49IHBhY2soInYiLCAweDNmZmYpOwogICAgICAgICRkYXRhIC49IHBhY2soIkMiLCAkY29sbWluKTsKICAgICAgICAkZGF0YSAuPSBwYWNrKCJDIiwgJGNvbG1heCk7CiAgICAgICAgLy8gUm93IGRlZmluaXRpb24KICAgICAgICAkZGF0YSAuPSBwYWNrKCJDIiwgJHVua25vd24wMyk7CiAgICAgICAgJGRhdGEgLj0gcGFjaygidiIsICR1bmtub3duMDQpOwogICAgICAgICRkYXRhIC49IHBhY2soInYiLCAkdW5rbm93bjA1KTsKICAgICAgICAkZGF0YSAuPSBwYWNrKCJ2IiwgJHVua25vd24wNik7CiAgICAgICAgJGRhdGEgLj0gcGFjaygidiIsICR1bmtub3duMDcpOwogICAgICAgICRkYXRhIC49IHBhY2soInYiLCAkdW5rbm93bjA4KTsKICAgICAgICAkZGF0YSAuPSBwYWNrKCJ2IiwgJGluZGV4KTsKICAgICAgICAkZGF0YSAuPSBwYWNrKCJ2IiwgJGluZGV4KTsKICAgICAgICAkZGF0YSAuPSBwYWNrKCJ2IiwgJHJvd21pbik7CiAgICAgICAgJGRhdGEgLj0gcGFjaygidiIsICRyb3dtYXgpOwogICAgICAgICRkYXRhIC49IHBhY2soIkMiLCAweDAwKTsKICAgICAgICAkZGF0YSAuPSBwYWNrKCJDIiwgMHhmZik7CiAgICAgICAgLy8gRW5kIG9mIGRhdGEKICAgICAgICAkZGF0YSAuPSBwYWNrKCJDIiwgMHgxMCk7CiAgICAgICAgJHRoaXMtPmFwcGVuZCgkaGVhZGVyIC4gJGRhdGEpOwogICAgfQoKICAgIC8qKgogICAgICogU3RvcmVzIHRoZSBDT1VOVFJZIHJlY29yZCBmb3IgbG9jYWxpemF0aW9uCiAgICAgKgogICAgICogQHJldHVybiBzdHJpbmcKICAgICAqLwogICAgcHJpdmF0ZSBmdW5jdGlvbiB3cml0ZUNvdW50cnkoKQogICAgewogICAgICAgICRyZWNvcmQgPSAweDAwOEM7ICAgIC8vIFJlY29yZCBpZGVudGlmaWVyCiAgICAgICAgJGxlbmd0aCA9IDQ7ICAgICAgICAgLy8gTnVtYmVyIG9mIGJ5dGVzIHRvIGZvbGxvdwoKICAgICAgICAkaGVhZGVyID0gcGFjaygndnYnLCAkcmVjb3JkLCAkbGVuZ3RoKTsKICAgICAgICAvKiB1c2luZyB0aGUgc2FtZSBjb3VudHJ5IGNvZGUgYWx3YXlzIGZvciBzaW1wbGljaXR5ICovCiAgICAgICAgJGRhdGEgPSBwYWNrKCd2dicsICR0aGlzLT5jb3VudHJ5Q29kZSwgJHRoaXMtPmNvdW50cnlDb2RlKTsKICAgICAgICAvLyR0aGlzLT5hcHBlbmQoJGhlYWRlciAuICRkYXRhKTsKICAgICAgICByZXR1cm4gJHRoaXMtPndyaXRlRGF0YSgkaGVhZGVyIC4gJGRhdGEpOwogICAgfQoKICAgIC8qKgogICAgICogV3JpdGUgdGhlIFJFQ0FMQ0lEIHJlY29yZAogICAgICoKICAgICAqIEByZXR1cm4gc3RyaW5nCiAgICAgKi8KICAgIHByaXZhdGUgZnVuY3Rpb24gd3JpdGVSZWNhbGNJZCgpCiAgICB7CiAgICAgICAgJHJlY29yZCA9IDB4MDFDMTsgICAgLy8gUmVjb3JkIGlkZW50aWZpZXIKICAgICAgICAkbGVuZ3RoID0gODsgICAgICAgICAvLyBOdW1iZXIgb2YgYnl0ZXMgdG8gZm9sbG93CgogICAgICAgICRoZWFkZXIgPSBwYWNrKCd2dicsICRyZWNvcmQsICRsZW5ndGgpOwoKICAgICAgICAvLyBieSBpbnNwZWN0aW9uIG9mIHJlYWwgRXhjZWwgZmlsZXMsIE1TIE9mZmljZSBFeGNlbCAyMDA3IHdyaXRlcyB0aGlzCiAgICAgICAgJGRhdGEgPSBwYWNrKCdWVicsIDB4MDAwMDAxQzEsIDB4MDAwMDFFNjY3KTsKCiAgICAgICAgcmV0dXJuICR0aGlzLT53cml0ZURhdGEoJGhlYWRlciAuICRkYXRhKTsKICAgIH0KCiAgICAvKioKICAgICAqIFN0b3JlcyB0aGUgUEFMRVRURSBiaWZmIHJlY29yZC4KICAgICAqLwogICAgcHJpdmF0ZSBmdW5jdGlvbiB3cml0ZVBhbGV0dGUoKQogICAgewogICAgICAgICRhcmVmID0gJHRoaXMtPnBhbGV0dGU7CgogICAgICAgICRyZWNvcmQgPSAweDAwOTI7ICAgICAgICAgICAgICAgIC8vIFJlY29yZCBpZGVudGlmaWVyCiAgICAgICAgJGxlbmd0aCA9IDIgKyA0ICogY291bnQoJGFyZWYpOyAgLy8gTnVtYmVyIG9mIGJ5dGVzIHRvIGZvbGxvdwogICAgICAgICRjY3YgICAgPSBjb3VudCgkYXJlZik7ICAgICAgICAgIC8vIE51bWJlciBvZiBSR0IgdmFsdWVzIHRvIGZvbGxvdwogICAgICAgICRkYXRhID0gJyc7ICAgICAgICAgICAgICAgICAgICAgIC8vIFRoZSBSR0IgZGF0YQoKICAgICAgICAvLyBQYWNrIHRoZSBSR0IgZGF0YQogICAgICAgIGZvcmVhY2ggKCRhcmVmIGFzICRjb2xvcikgewogICAgICAgICAgICBmb3JlYWNoICgkY29sb3IgYXMgJGJ5dGUpIHsKICAgICAgICAgICAgICAgICRkYXRhIC49IHBhY2soIkMiLCAkYnl0ZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICRoZWFkZXIgPSBwYWNrKCJ2dnYiLCAkcmVjb3JkLCAkbGVuZ3RoLCAkY2N2KTsKICAgICAgICAkdGhpcy0+YXBwZW5kKCRoZWFkZXIgLiAkZGF0YSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBIYW5kbGluZyBvZiB0aGUgU1NUIGNvbnRpbnVlIGJsb2NrcyBpcyBjb21wbGljYXRlZCBieSB0aGUgbmVlZCB0byBpbmNsdWRlIGFuCiAgICAgKiBhZGRpdGlvbmFsIGNvbnRpbnVhdGlvbiBieXRlIGRlcGVuZGluZyBvbiB3aGV0aGVyIHRoZSBzdHJpbmcgaXMgc3BsaXQgYmV0d2VlbgogICAgICogYmxvY2tzIG9yIHdoZXRoZXIgaXQgc3RhcnRzIGF0IHRoZSBiZWdpbm5pbmcgb2YgdGhlIGJsb2NrLiAoVGhlcmUgYXJlIGFsc28KICAgICAqIGFkZGl0aW9uYWwgY29tcGxpY2F0aW9ucyB0aGF0IHdpbGwgYXJpc2UgbGF0ZXIgd2hlbi9pZiBSaWNoIFN0cmluZ3MgYXJlCiAgICAgKiBzdXBwb3J0ZWQpLgogICAgICoKICAgICAqIFRoZSBFeGNlbCBkb2N1bWVudGF0aW9uIHNheXMgdGhhdCB0aGUgU1NUIHJlY29yZCBzaG91bGQgYmUgZm9sbG93ZWQgYnkgYW4KICAgICAqIEVYVFNTVCByZWNvcmQuIFRoZSBFWFRTU1QgcmVjb3JkIGlzIGEgaGFzaCB0YWJsZSB0aGF0IGlzIHVzZWQgdG8gb3B0aW1pc2UKICAgICAqIGFjY2VzcyB0byBTU1QuIEhvd2V2ZXIsIGRlc3BpdGUgdGhlIGRvY3VtZW50YXRpb24gaXQgZG9lc24ndCBzZWVtIHRvIGJlCiAgICAgKiByZXF1aXJlZCBzbyB3ZSB3aWxsIGlnbm9yZSBpdC4KICAgICAqCiAgICAgKiBAcmV0dXJuIHN0cmluZyBCaW5hcnkgZGF0YQogICAgICovCiAgICBwcml2YXRlIGZ1bmN0aW9uIHdyaXRlU2hhcmVkU3RyaW5nc1RhYmxlKCkKICAgIHsKICAgICAgICAvLyBtYXhpbXVtIHNpemUgb2YgcmVjb3JkIGRhdGEgKGV4Y2x1ZGluZyByZWNvcmQgaGVhZGVyKQogICAgICAgICRjb250aW51ZV9saW1pdCA9IDgyMjQ7CgogICAgICAgIC8vIGluaXRpYWxpemUgYXJyYXkgb2YgcmVjb3JkIGRhdGEgYmxvY2tzCiAgICAgICAgJHJlY29yZERhdGFzID0gYXJyYXkoKTsKCiAgICAgICAgLy8gc3RhcnQgU1NUIHJlY29yZCBkYXRhIGJsb2NrIHdpdGggdG90YWwgbnVtYmVyIG9mIHN0cmluZ3MsIHRvdGFsIG51bWJlciBvZiB1bmlxdWUgc3RyaW5ncwogICAgICAgICRyZWNvcmREYXRhID0gcGFjaygiVlYiLCAkdGhpcy0+c3RyaW5nVG90YWwsICR0aGlzLT5zdHJpbmdVbmlxdWUpOwoKICAgICAgICAvLyBsb29wIHRocm91Z2ggYWxsICh1bmlxdWUpIHN0cmluZ3MgaW4gc2hhcmVkIHN0cmluZ3MgdGFibGUKICAgICAgICBmb3JlYWNoIChhcnJheV9rZXlzKCR0aGlzLT5zdHJpbmdUYWJsZSkgYXMgJHN0cmluZykgewogICAgICAgICAgICAvLyBoZXJlICRzdHJpbmcgaXMgYSBCSUZGOCBlbmNvZGVkIHN0cmluZwoKICAgICAgICAgICAgLy8gbGVuZ3RoID0gY2hhcmFjdGVyIGNvdW50CiAgICAgICAgICAgICRoZWFkZXJpbmZvID0gdW5wYWNrKCJ2bGVuZ3RoL0NlbmNvZGluZyIsICRzdHJpbmcpOwoKICAgICAgICAgICAgLy8gY3VycmVudGx5LCB0aGlzIGlzIGFsd2F5cyAxID0gdW5jb21wcmVzc2VkCiAgICAgICAgICAgICRlbmNvZGluZyA9ICRoZWFkZXJpbmZvWyJlbmNvZGluZyJdOwoKICAgICAgICAgICAgLy8gaW5pdGlhbGl6ZSBmaW5pc2hlZCB3cml0aW5nIGN1cnJlbnQgJHN0cmluZwogICAgICAgICAgICAkZmluaXNoZWQgPSBmYWxzZTsKCiAgICAgICAgICAgIHdoaWxlICgkZmluaXNoZWQgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgICAvLyBub3JtYWxseSwgdGhlcmUgd2lsbCBiZSBvbmx5IG9uZSBjeWNsZSwgYnV0IGlmIHN0cmluZyBjYW5ub3QgaW1tZWRpYXRlbHkgYmUgd3JpdHRlbiBhcyBpcwogICAgICAgICAgICAgICAgLy8gdGhlcmUgd2lsbCBiZSBuZWVkIGZvciBtb3JlIHRoYW4gb25lIGN5bGNsZSwgaWYgc3RyaW5nIGxvbmdlciB0aGFuIG9uZSByZWNvcmQgZGF0YSBibG9jaywgdGhlcmUKICAgICAgICAgICAgICAgIC8vIG1heSBiZSBuZWVkIGZvciBldmVuIG1vcmUgY3ljbGVzCgogICAgICAgICAgICAgICAgaWYgKHN0cmxlbigkcmVjb3JkRGF0YSkgKyBzdHJsZW4oJHN0cmluZykgPD0gJGNvbnRpbnVlX2xpbWl0KSB7CiAgICAgICAgICAgICAgICAgICAgLy8gdGhlbiB3ZSBjYW4gd3JpdGUgdGhlIHN0cmluZyAob3IgcmVtYWluZGVyIG9mIHN0cmluZykgd2l0aG91dCBhbnkgcHJvYmxlbXMKICAgICAgICAgICAgICAgICAgICAkcmVjb3JkRGF0YSAuPSAkc3RyaW5nOwoKICAgICAgICAgICAgICAgICAgICBpZiAoc3RybGVuKCRyZWNvcmREYXRhKSArIHN0cmxlbigkc3RyaW5nKSA9PSAkY29udGludWVfbGltaXQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2UgY2xvc2UgdGhlIHJlY29yZCBkYXRhIGJsb2NrLCBhbmQgaW5pdGlhbGl6ZSBhIG5ldyBvbmUKICAgICAgICAgICAgICAgICAgICAgICAgJHJlY29yZERhdGFzW10gPSAkcmVjb3JkRGF0YTsKICAgICAgICAgICAgICAgICAgICAgICAgJHJlY29yZERhdGEgPSAnJzsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIC8vIHdlIGFyZSBmaW5pc2hlZCB3cml0aW5nIHRoaXMgc3RyaW5nCiAgICAgICAgICAgICAgICAgICAgJGZpbmlzaGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgLy8gc3BlY2lhbCB0cmVhdG1lbnQgd3JpdGluZyB0aGUgc3RyaW5nIChvciByZW1haW5kZXIgb2YgdGhlIHN0cmluZykKICAgICAgICAgICAgICAgICAgICAvLyBJZiB0aGUgc3RyaW5nIGlzIHZlcnkgbG9uZyBpdCBtYXkgbmVlZCB0byBiZSB3cml0dGVuIGluIG1vcmUgdGhhbiBvbmUgQ09OVElOVUUgcmVjb3JkLgoKICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBob3cgbWFueSBieXRlcyBtb3JlIHRoZXJlIGlzIHJvb20gZm9yIGluIHRoZSBjdXJyZW50IHJlY29yZAogICAgICAgICAgICAgICAgICAgICRzcGFjZV9yZW1haW5pbmcgPSAkY29udGludWVfbGltaXQgLSBzdHJsZW4oJHJlY29yZERhdGEpOwoKICAgICAgICAgICAgICAgICAgICAvLyBtaW5pbXVtIHNwYWNlIG5lZWRlZAogICAgICAgICAgICAgICAgICAgIC8vIHVuY29tcHJlc3NlZDogMiBieXRlIHN0cmluZyBsZW5ndGggbGVuZ3RoIGZpZWxkICsgMSBieXRlIG9wdGlvbiBmbGFncyArIDIgYnl0ZSBjaGFyYWN0ZXIKICAgICAgICAgICAgICAgICAgICAvLyBjb21wcmVzc2VkOiAgIDIgYnl0ZSBzdHJpbmcgbGVuZ3RoIGxlbmd0aCBmaWVsZCArIDEgYnl0ZSBvcHRpb24gZmxhZ3MgKyAxIGJ5dGUgY2hhcmFjdGVyCiAgICAgICAgICAgICAgICAgICAgJG1pbl9zcGFjZV9uZWVkZWQgPSAoJGVuY29kaW5nID09IDEpID8gNSA6IDQ7CgogICAgICAgICAgICAgICAgICAgIC8vIFdlIGhhdmUgdHdvIGNhc2VzCiAgICAgICAgICAgICAgICAgICAgLy8gMS4gc3BhY2UgcmVtYWluaW5nIGlzIGxlc3MgdGhhbiBtaW5pbXVtIHNwYWNlIG5lZWRlZAogICAgICAgICAgICAgICAgICAgIC8vICAgICAgICBoZXJlIHdlIG11c3Qgd2FzdGUgdGhlIHNwYWNlIHJlbWFpbmluZyBhbmQgbW92ZSB0byBuZXh0IHJlY29yZCBkYXRhIGJsb2NrCiAgICAgICAgICAgICAgICAgICAgLy8gMi4gc3BhY2UgcmVtYWluaW5nIGlzIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byBtaW5pbXVtIHNwYWNlIG5lZWRlZAogICAgICAgICAgICAgICAgICAgIC8vICAgICAgICBoZXJlIHdlIHdyaXRlIGFzIG11Y2ggYXMgd2UgY2FuIGluIHRoZSBjdXJyZW50IGJsb2NrLCB0aGVuIG1vdmUgdG8gbmV4dCByZWNvcmQgZGF0YSBibG9jawoKICAgICAgICAgICAgICAgICAgICAvLyAxLiBzcGFjZSByZW1haW5pbmcgaXMgbGVzcyB0aGFuIG1pbmltdW0gc3BhY2UgbmVlZGVkCiAgICAgICAgICAgICAgICAgICAgaWYgKCRzcGFjZV9yZW1haW5pbmcgPCAkbWluX3NwYWNlX25lZWRlZCkgewogICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSBjbG9zZSB0aGUgYmxvY2ssIHN0b3JlIHRoZSBibG9jayBkYXRhCiAgICAgICAgICAgICAgICAgICAgICAgICRyZWNvcmREYXRhc1tdID0gJHJlY29yZERhdGE7CgogICAgICAgICAgICAgICAgICAgICAgICAvLyBhbmQgc3RhcnQgbmV3IHJlY29yZCBkYXRhIGJsb2NrIHdoZXJlIHdlIHN0YXJ0IHdyaXRpbmcgdGhlIHN0cmluZwogICAgICAgICAgICAgICAgICAgICAgICAkcmVjb3JkRGF0YSA9ICcnOwoKICAgICAgICAgICAgICAgICAgICAvLyAyLiBzcGFjZSByZW1haW5pbmcgaXMgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIG1pbmltdW0gc3BhY2UgbmVlZGVkCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gaW5pdGlhbGl6ZSBlZmZlY3RpdmUgcmVtYWluaW5nIHNwYWNlLCBmb3IgVW5pY29kZSBzdHJpbmdzIHRoaXMgbWF5IG5lZWQgdG8gYmUgcmVkdWNlZCBieSAxLCBzZWUgYmVsb3cKICAgICAgICAgICAgICAgICAgICAgICAgJGVmZmVjdGl2ZV9zcGFjZV9yZW1haW5pbmcgPSAkc3BhY2VfcmVtYWluaW5nOwoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gZm9yIHVuY29tcHJlc3NlZCBzdHJpbmdzLCBzb21ldGltZXMgZWZmZWN0aXZlIHNwYWNlIHJlbWFpbmluZyBpcyByZWR1Y2VkIGJ5IDEKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRlbmNvZGluZyA9PSAxICYmIChzdHJsZW4oJHN0cmluZykgLSAkc3BhY2VfcmVtYWluaW5nKSAlIDIgPT0gMSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLS0kZWZmZWN0aXZlX3NwYWNlX3JlbWFpbmluZzsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gb25lIGJsb2NrIGZpbmluc2hlZCwgc3RvcmUgdGhlIGJsb2NrIGRhdGEKICAgICAgICAgICAgICAgICAgICAgICAgJHJlY29yZERhdGEgLj0gc3Vic3RyKCRzdHJpbmcsIDAsICRlZmZlY3RpdmVfc3BhY2VfcmVtYWluaW5nKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICRzdHJpbmcgPSBzdWJzdHIoJHN0cmluZywgJGVmZmVjdGl2ZV9zcGFjZV9yZW1haW5pbmcpOyAvLyBmb3IgbmV4dCBjeWNsZSBpbiB3aGlsZSBsb29wCiAgICAgICAgICAgICAgICAgICAgICAgICRyZWNvcmREYXRhc1tdID0gJHJlY29yZERhdGE7CgogICAgICAgICAgICAgICAgICAgICAgICAvLyBzdGFydCBuZXcgcmVjb3JkIGRhdGEgYmxvY2sgd2l0aCB0aGUgcmVwZWF0ZWQgb3B0aW9uIGZsYWdzCiAgICAgICAgICAgICAgICAgICAgICAgICRyZWNvcmREYXRhID0gcGFjaygnQycsICRlbmNvZGluZyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBTdG9yZSB0aGUgbGFzdCByZWNvcmQgZGF0YSBibG9jayB1bmxlc3MgaXQgaXMgZW1wdHkKICAgICAgICAvLyBpZiB0aGVyZSB3YXMgbm8gbmVlZCBmb3IgYW55IGNvbnRpbnVlIHJlY29yZHMsIHRoaXMgd2lsbCBiZSB0aGUgZm9yIFNTVCByZWNvcmQgZGF0YSBibG9jayBpdHNlbGYKICAgICAgICBpZiAoc3RybGVuKCRyZWNvcmREYXRhKSA+IDApIHsKICAgICAgICAgICAgJHJlY29yZERhdGFzW10gPSAkcmVjb3JkRGF0YTsKICAgICAgICB9CgogICAgICAgIC8vIGNvbWJpbmUgaW50byBvbmUgY2h1bmsgd2l0aCBhbGwgdGhlIGJsb2NrcyBTU1QsIENPTlRJTlVFLC4uLgogICAgICAgICRjaHVuayA9ICcnOwogICAgICAgIGZvcmVhY2ggKCRyZWNvcmREYXRhcyBhcyAkaSA9PiAkcmVjb3JkRGF0YSkgewogICAgICAgICAgICAvLyBmaXJzdCBibG9jayBzaG91bGQgaGF2ZSB0aGUgU1NUIHJlY29yZCBoZWFkZXIsIHJlbWFpbmcgc2hvdWxkIGhhdmUgQ09OVElOVUUgaGVhZGVyCiAgICAgICAgICAgICRyZWNvcmQgPSAoJGkgPT0gMCkgPyAweDAwRkMgOiAweDAwM0M7CgogICAgICAgICAgICAkaGVhZGVyID0gcGFjaygidnYiLCAkcmVjb3JkLCBzdHJsZW4oJHJlY29yZERhdGEpKTsKICAgICAgICAgICAgJGRhdGEgPSAkaGVhZGVyIC4gJHJlY29yZERhdGE7CgogICAgICAgICAgICAkY2h1bmsgLj0gJHRoaXMtPndyaXRlRGF0YSgkZGF0YSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gJGNodW5rOwogICAgfQoKICAgIC8qKgogICAgICogV3JpdGVzIHRoZSBNU09EUkFXSU5HR1JPVVAgcmVjb3JkIGlmIG5lZWRlZC4gUG9zc2libHkgc3BsaXQgdXNpbmcgQ09OVElOVUUgcmVjb3Jkcy4KICAgICAqLwogICAgcHJpdmF0ZSBmdW5jdGlvbiB3cml0ZU1zb0RyYXdpbmdHcm91cCgpCiAgICB7CiAgICAgICAgLy8gd3JpdGUgdGhlIEVzY2hlciBzdHJlYW0gaWYgbmVjZXNzYXJ5CiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5lc2NoZXIpKSB7CiAgICAgICAgICAgICR3cml0ZXIgPSBuZXcgUEhQRXhjZWxfV3JpdGVyX0V4Y2VsNV9Fc2NoZXIoJHRoaXMtPmVzY2hlcik7CiAgICAgICAgICAgICRkYXRhID0gJHdyaXRlci0+Y2xvc2UoKTsKCiAgICAgICAgICAgICRyZWNvcmQgPSAweDAwRUI7CiAgICAgICAgICAgICRsZW5ndGggPSBzdHJsZW4oJGRhdGEpOwogICAgICAgICAgICAkaGVhZGVyID0gcGFjaygidnYiLCAkcmVjb3JkLCAkbGVuZ3RoKTsKCiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+d3JpdGVEYXRhKCRoZWFkZXIgLiAkZGF0YSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuICcnOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIEdldCBFc2NoZXIgb2JqZWN0CiAgICAgKgogICAgICogQHJldHVybiBQSFBFeGNlbF9TaGFyZWRfRXNjaGVyCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBnZXRFc2NoZXIoKQogICAgewogICAgICAgIHJldHVybiAkdGhpcy0+ZXNjaGVyOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IEVzY2hlciBvYmplY3QKICAgICAqCiAgICAgKiBAcGFyYW0gUEhQRXhjZWxfU2hhcmVkX0VzY2hlciAkcFZhbHVlCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBzZXRFc2NoZXIoUEhQRXhjZWxfU2hhcmVkX0VzY2hlciAkcFZhbHVlID0gbnVsbCkKICAgIHsKICAgICAgICAkdGhpcy0+ZXNjaGVyID0gJHBWYWx1ZTsKICAgIH0KfQo=",
    "size": "53237"
}