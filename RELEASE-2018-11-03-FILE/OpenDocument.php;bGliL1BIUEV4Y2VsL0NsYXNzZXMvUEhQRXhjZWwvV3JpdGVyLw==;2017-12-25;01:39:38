{
    "namaFile": "lib\/PHPExcel\/Classes\/PHPExcel\/Writer\/OpenDocument.php",
    "lastUpdate": "2017-12-25+01:39:38.00",
    "contentFile": "PD9waHAKCi8qKgogKiBQSFBFeGNlbF9Xcml0ZXJfT3BlbkRvY3VtZW50CiAqCiAqIENvcHlyaWdodCAoYykgMjAwNiAtIDIwMTUgUEhQRXhjZWwKICoKICogVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgogKiBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCiAqIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlcgogKiB2ZXJzaW9uIDIuMSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KICoKICogVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCiAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCiAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VCiAqIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCiAqCiAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKICogTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZQogKiBGb3VuZGF0aW9uLCBJbmMuLCA1MSBGcmFua2xpbiBTdHJlZXQsIEZpZnRoIEZsb29yLCBCb3N0b24sIE1BICAwMjExMC0xMzAxICBVU0EKICoKICogQGNhdGVnb3J5ICAgUEhQRXhjZWwKICogQHBhY2thZ2UgICAgUEhQRXhjZWxfV3JpdGVyX09wZW5Eb2N1bWVudAogKiBAY29weXJpZ2h0ICBDb3B5cmlnaHQgKGMpIDIwMDYgLSAyMDE1IFBIUEV4Y2VsIChodHRwOi8vd3d3LmNvZGVwbGV4LmNvbS9QSFBFeGNlbCkKICogQGxpY2Vuc2UgICAgaHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL29sZC1saWNlbnNlcy9sZ3BsLTIuMS50eHQgICAgTEdQTAogKiBAdmVyc2lvbiAgICAjI1ZFUlNJT04jIywgIyNEQVRFIyMKICovCmNsYXNzIFBIUEV4Y2VsX1dyaXRlcl9PcGVuRG9jdW1lbnQgZXh0ZW5kcyBQSFBFeGNlbF9Xcml0ZXJfQWJzdHJhY3QgaW1wbGVtZW50cyBQSFBFeGNlbF9Xcml0ZXJfSVdyaXRlcgp7CiAgICAvKioKICAgICAqIFByaXZhdGUgd3JpdGVyIHBhcnRzCiAgICAgKgogICAgICogQHZhciBQSFBFeGNlbF9Xcml0ZXJfT3BlbkRvY3VtZW50X1dyaXRlclBhcnRbXQogICAgICovCiAgICBwcml2YXRlICR3cml0ZXJQYXJ0cyA9IGFycmF5KCk7CgogICAgLyoqCiAgICAgKiBQcml2YXRlIFBIUEV4Y2VsCiAgICAgKgogICAgICogQHZhciBQSFBFeGNlbAogICAgICovCiAgICBwcml2YXRlICRzcHJlYWRTaGVldDsKCiAgICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyBQSFBFeGNlbF9Xcml0ZXJfT3BlbkRvY3VtZW50CiAgICAgKgogICAgICogQHBhcmFtIFBIUEV4Y2VsICRwUEhQRXhjZWwKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KFBIUEV4Y2VsICRwUEhQRXhjZWwgPSBudWxsKQogICAgewogICAgICAgICR0aGlzLT5zZXRQSFBFeGNlbCgkcFBIUEV4Y2VsKTsKCiAgICAgICAgJHdyaXRlclBhcnRzQXJyYXkgPSBhcnJheSgKICAgICAgICAgICAgJ2NvbnRlbnQnICAgID0+ICdQSFBFeGNlbF9Xcml0ZXJfT3BlbkRvY3VtZW50X0NvbnRlbnQnLAogICAgICAgICAgICAnbWV0YScgICAgICAgPT4gJ1BIUEV4Y2VsX1dyaXRlcl9PcGVuRG9jdW1lbnRfTWV0YScsCiAgICAgICAgICAgICdtZXRhX2luZicgICA9PiAnUEhQRXhjZWxfV3JpdGVyX09wZW5Eb2N1bWVudF9NZXRhSW5mJywKICAgICAgICAgICAgJ21pbWV0eXBlJyAgID0+ICdQSFBFeGNlbF9Xcml0ZXJfT3BlbkRvY3VtZW50X01pbWV0eXBlJywKICAgICAgICAgICAgJ3NldHRpbmdzJyAgID0+ICdQSFBFeGNlbF9Xcml0ZXJfT3BlbkRvY3VtZW50X1NldHRpbmdzJywKICAgICAgICAgICAgJ3N0eWxlcycgICAgID0+ICdQSFBFeGNlbF9Xcml0ZXJfT3BlbkRvY3VtZW50X1N0eWxlcycsCiAgICAgICAgICAgICd0aHVtYm5haWxzJyA9PiAnUEhQRXhjZWxfV3JpdGVyX09wZW5Eb2N1bWVudF9UaHVtYm5haWxzJwogICAgICAgICk7CgogICAgICAgIGZvcmVhY2ggKCR3cml0ZXJQYXJ0c0FycmF5IGFzICR3cml0ZXIgPT4gJGNsYXNzKSB7CiAgICAgICAgICAgICR0aGlzLT53cml0ZXJQYXJ0c1skd3JpdGVyXSA9IG5ldyAkY2xhc3MoJHRoaXMpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIEdldCB3cml0ZXIgcGFydAogICAgICoKICAgICAqIEBwYXJhbSAgc3RyaW5nICAkcFBhcnROYW1lICBXcml0ZXIgcGFydCBuYW1lCiAgICAgKiBAcmV0dXJuIFBIUEV4Y2VsX1dyaXRlcl9FeGNlbDIwMDdfV3JpdGVyUGFydAogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gZ2V0V3JpdGVyUGFydCgkcFBhcnROYW1lID0gJycpCiAgICB7CiAgICAgICAgaWYgKCRwUGFydE5hbWUgIT0gJycgJiYgaXNzZXQoJHRoaXMtPndyaXRlclBhcnRzW3N0cnRvbG93ZXIoJHBQYXJ0TmFtZSldKSkgewogICAgICAgICAgICByZXR1cm4gJHRoaXMtPndyaXRlclBhcnRzW3N0cnRvbG93ZXIoJHBQYXJ0TmFtZSldOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFNhdmUgUEhQRXhjZWwgdG8gZmlsZQogICAgICoKICAgICAqIEBwYXJhbSAgc3RyaW5nICAkcEZpbGVuYW1lCiAgICAgKiBAdGhyb3dzIFBIUEV4Y2VsX1dyaXRlcl9FeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIHNhdmUoJHBGaWxlbmFtZSA9IG51bGwpCiAgICB7CiAgICAgICAgaWYgKCEkdGhpcy0+c3ByZWFkU2hlZXQpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFBIUEV4Y2VsX1dyaXRlcl9FeGNlcHRpb24oJ1BIUEV4Y2VsIG9iamVjdCB1bmFzc2lnbmVkLicpOwogICAgICAgIH0KCiAgICAgICAgLy8gZ2FyYmFnZSBjb2xsZWN0CiAgICAgICAgJHRoaXMtPnNwcmVhZFNoZWV0LT5nYXJiYWdlQ29sbGVjdCgpOwoKICAgICAgICAvLyBJZiAkcEZpbGVuYW1lIGlzIHBocDovL291dHB1dCBvciBwaHA6Ly9zdGRvdXQsIG1ha2UgaXQgYSB0ZW1wb3JhcnkgZmlsZS4uLgogICAgICAgICRvcmlnaW5hbEZpbGVuYW1lID0gJHBGaWxlbmFtZTsKICAgICAgICBpZiAoc3RydG9sb3dlcigkcEZpbGVuYW1lKSA9PSAncGhwOi8vb3V0cHV0JyB8fCBzdHJ0b2xvd2VyKCRwRmlsZW5hbWUpID09ICdwaHA6Ly9zdGRvdXQnKSB7CiAgICAgICAgICAgICRwRmlsZW5hbWUgPSBAdGVtcG5hbShQSFBFeGNlbF9TaGFyZWRfRmlsZTo6c3lzX2dldF90ZW1wX2RpcigpLCAncGhweGx0bXAnKTsKICAgICAgICAgICAgaWYgKCRwRmlsZW5hbWUgPT0gJycpIHsKICAgICAgICAgICAgICAgICRwRmlsZW5hbWUgPSAkb3JpZ2luYWxGaWxlbmFtZTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgJG9ialppcCA9ICR0aGlzLT5jcmVhdGVaaXAoJHBGaWxlbmFtZSk7CgogICAgICAgICRvYmpaaXAtPmFkZEZyb21TdHJpbmcoJ01FVEEtSU5GL21hbmlmZXN0LnhtbCcsICR0aGlzLT5nZXRXcml0ZXJQYXJ0KCdtZXRhX2luZicpLT53cml0ZU1hbmlmZXN0KCkpOwogICAgICAgICRvYmpaaXAtPmFkZEZyb21TdHJpbmcoJ1RodW1ibmFpbHMvdGh1bWJuYWlsLnBuZycsICR0aGlzLT5nZXRXcml0ZXJQYXJ0KCd0aHVtYm5haWxzJyktPndyaXRlVGh1bWJuYWlsKCkpOwogICAgICAgICRvYmpaaXAtPmFkZEZyb21TdHJpbmcoJ2NvbnRlbnQueG1sJywgJHRoaXMtPmdldFdyaXRlclBhcnQoJ2NvbnRlbnQnKS0+d3JpdGUoKSk7CiAgICAgICAgJG9ialppcC0+YWRkRnJvbVN0cmluZygnbWV0YS54bWwnLCAkdGhpcy0+Z2V0V3JpdGVyUGFydCgnbWV0YScpLT53cml0ZSgpKTsKICAgICAgICAkb2JqWmlwLT5hZGRGcm9tU3RyaW5nKCdtaW1ldHlwZScsICR0aGlzLT5nZXRXcml0ZXJQYXJ0KCdtaW1ldHlwZScpLT53cml0ZSgpKTsKICAgICAgICAkb2JqWmlwLT5hZGRGcm9tU3RyaW5nKCdzZXR0aW5ncy54bWwnLCAkdGhpcy0+Z2V0V3JpdGVyUGFydCgnc2V0dGluZ3MnKS0+d3JpdGUoKSk7CiAgICAgICAgJG9ialppcC0+YWRkRnJvbVN0cmluZygnc3R5bGVzLnhtbCcsICR0aGlzLT5nZXRXcml0ZXJQYXJ0KCdzdHlsZXMnKS0+d3JpdGUoKSk7CgogICAgICAgIC8vIENsb3NlIGZpbGUKICAgICAgICBpZiAoJG9ialppcC0+Y2xvc2UoKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFBIUEV4Y2VsX1dyaXRlcl9FeGNlcHRpb24oIkNvdWxkIG5vdCBjbG9zZSB6aXAgZmlsZSAkcEZpbGVuYW1lLiIpOwogICAgICAgIH0KCiAgICAgICAgLy8gSWYgYSB0ZW1wb3JhcnkgZmlsZSB3YXMgdXNlZCwgY29weSBpdCB0byB0aGUgY29ycmVjdCBmaWxlIHN0cmVhbQogICAgICAgIGlmICgkb3JpZ2luYWxGaWxlbmFtZSAhPSAkcEZpbGVuYW1lKSB7CiAgICAgICAgICAgIGlmIChjb3B5KCRwRmlsZW5hbWUsICRvcmlnaW5hbEZpbGVuYW1lKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBQSFBFeGNlbF9Xcml0ZXJfRXhjZXB0aW9uKCJDb3VsZCBub3QgY29weSB0ZW1wb3JhcnkgemlwIGZpbGUgJHBGaWxlbmFtZSB0byAkb3JpZ2luYWxGaWxlbmFtZS4iKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBAdW5saW5rKCRwRmlsZW5hbWUpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSB6aXAgb2JqZWN0CiAgICAgKgogICAgICogQHBhcmFtIHN0cmluZyAkcEZpbGVuYW1lCiAgICAgKiBAdGhyb3dzIFBIUEV4Y2VsX1dyaXRlcl9FeGNlcHRpb24KICAgICAqIEByZXR1cm4gWmlwQXJjaGl2ZQogICAgICovCiAgICBwcml2YXRlIGZ1bmN0aW9uIGNyZWF0ZVppcCgkcEZpbGVuYW1lKQogICAgewogICAgICAgIC8vIENyZWF0ZSBuZXcgWklQIGZpbGUgYW5kIG9wZW4gaXQgZm9yIHdyaXRpbmcKICAgICAgICAkemlwQ2xhc3MgPSBQSFBFeGNlbF9TZXR0aW5nczo6Z2V0WmlwQ2xhc3MoKTsKICAgICAgICAkb2JqWmlwID0gbmV3ICR6aXBDbGFzcygpOwoKICAgICAgICAvLyBSZXRyaWV2ZSBPVkVSV1JJVEUgYW5kIENSRUFURSBjb25zdGFudHMgZnJvbSB0aGUgaW5zdGFudGlhdGVkIHppcCBjbGFzcwogICAgICAgIC8vIFRoaXMgbWV0aG9kIG9mIGFjY2Vzc2luZyBjb25zdGFudCB2YWx1ZXMgZnJvbSBhIGR5bmFtaWMgY2xhc3Mgc2hvdWxkIHdvcmsgd2l0aCBhbGwgYXBwcm9wcmlhdGUgdmVyc2lvbnMgb2YgUEhQCiAgICAgICAgJHJvID0gbmV3IFJlZmxlY3Rpb25PYmplY3QoJG9ialppcCk7CiAgICAgICAgJHppcE92ZXJXcml0ZSA9ICRyby0+Z2V0Q29uc3RhbnQoJ09WRVJXUklURScpOwogICAgICAgICR6aXBDcmVhdGUgPSAkcm8tPmdldENvbnN0YW50KCdDUkVBVEUnKTsKCiAgICAgICAgaWYgKGZpbGVfZXhpc3RzKCRwRmlsZW5hbWUpKSB7CiAgICAgICAgICAgIHVubGluaygkcEZpbGVuYW1lKTsKICAgICAgICB9CiAgICAgICAgLy8gVHJ5IG9wZW5pbmcgdGhlIFpJUCBmaWxlCiAgICAgICAgaWYgKCRvYmpaaXAtPm9wZW4oJHBGaWxlbmFtZSwgJHppcE92ZXJXcml0ZSkgIT09IHRydWUpIHsKICAgICAgICAgICAgaWYgKCRvYmpaaXAtPm9wZW4oJHBGaWxlbmFtZSwgJHppcENyZWF0ZSkgIT09IHRydWUpIHsKICAgICAgICAgICAgICAgIHRocm93IG5ldyBQSFBFeGNlbF9Xcml0ZXJfRXhjZXB0aW9uKCJDb3VsZCBub3Qgb3BlbiAkcEZpbGVuYW1lIGZvciB3cml0aW5nLiIpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gJG9ialppcDsKICAgIH0KCiAgICAvKioKICAgICAqIEdldCBQSFBFeGNlbCBvYmplY3QKICAgICAqCiAgICAgKiBAcmV0dXJuIFBIUEV4Y2VsCiAgICAgKiBAdGhyb3dzIFBIUEV4Y2VsX1dyaXRlcl9FeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIGdldFBIUEV4Y2VsKCkKICAgIHsKICAgICAgICBpZiAoJHRoaXMtPnNwcmVhZFNoZWV0ICE9PSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+c3ByZWFkU2hlZXQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFBIUEV4Y2VsX1dyaXRlcl9FeGNlcHRpb24oJ05vIFBIUEV4Y2VsIGFzc2lnbmVkLicpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFNldCBQSFBFeGNlbCBvYmplY3QKICAgICAqCiAgICAgKiBAcGFyYW0gIFBIUEV4Y2VsICAkcFBIUEV4Y2VsICBQSFBFeGNlbCBvYmplY3QKICAgICAqIEB0aHJvd3MgUEhQRXhjZWxfV3JpdGVyX0V4Y2VwdGlvbgogICAgICogQHJldHVybiBQSFBFeGNlbF9Xcml0ZXJfRXhjZWwyMDA3CiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBzZXRQSFBFeGNlbChQSFBFeGNlbCAkcFBIUEV4Y2VsID0gbnVsbCkKICAgIHsKICAgICAgICAkdGhpcy0+c3ByZWFkU2hlZXQgPSAkcFBIUEV4Y2VsOwogICAgICAgIHJldHVybiAkdGhpczsKICAgIH0KfQo=",
    "size": "6542"
}