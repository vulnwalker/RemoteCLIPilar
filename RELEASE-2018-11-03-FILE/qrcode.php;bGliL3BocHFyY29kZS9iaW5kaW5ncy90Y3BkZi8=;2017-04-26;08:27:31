{
    "namaFile": "lib\/phpqrcode\/bindings\/tcpdf\/qrcode.php",
    "lastUpdate": "2017-04-26+08:27:31.60",
    "contentFile": "PD9waHAKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0rCi8vIEZpbGUgbmFtZSAgIDogcXJjb2RlLnBocAovLyBCZWdpbiAgICAgICA6IDIwMTAtMDMtMjIKLy8gTGFzdCBVcGRhdGUgOiAyMDEwLTAzLTI5Ci8vIFZlcnNpb24gICAgIDogMS4wLjAwMgovLyBMaWNlbnNlICAgICA6IEdOVSBMR1BMIHYuMyAoaHR0cDovL3d3dy5nbnUub3JnL2NvcHlsZWZ0L2xlc3Nlci5odG1sKQovLyAJLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLwovLyAJVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgovLyAJbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYwovLyAJTGljZW5zZSBhcyBwdWJsaXNoZWQgYnkgdGhlIEZyZWUgU29mdHdhcmUgRm91bmRhdGlvbjsgZWl0aGVyCi8vIAl2ZXJzaW9uIDMgb2YgdGhlIExpY2Vuc2UsIG9yIGFueSBsYXRlciB2ZXJzaW9uLgovLwovLyAJVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCi8vIAlidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgovLyAJTUVSQ0hBTlRBQklMSVRZIG9yIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFLiBTZWUgdGhlIEdOVQovLyAJTGVzc2VyIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgZm9yIG1vcmUgZGV0YWlscy4KLy8KLy8gCVlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKLy8gCUxpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgd3JpdGUgdG8gdGhlIEZyZWUgU29mdHdhcmUKLy8gCUZvdW5kYXRpb24sIEluYy4sIDUxIEZyYW5rbGluIFN0LCBGaWZ0aCBGbG9vciwgQm9zdG9uLCBNQSAwMjExMC0xMzAxIFVTQQovLyAgb3IgYnJvd3NlIGh0dHA6Ly93d3cuZ251Lm9yZy9jb3B5bGVmdC9sZXNzZXIuaHRtbAovLwovLyAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQovLwovLyBERVNDUklQVElPTiA6Ci8vCi8vIENsYXNzIHRvIGNyZWF0ZSBRUi1jb2RlIGFycmF5cyBmb3IgVENQREYgY2xhc3MuCi8vIFFSIENvZGUgc3ltYm9sIGlzIGEgMkQgYmFyY29kZSB0aGF0IGNhbiBiZSBzY2FubmVkIGJ5Ci8vIGhhbmR5IHRlcm1pbmFscyBzdWNoIGFzIGEgbW9iaWxlIHBob25lIHdpdGggQ0NELgovLyBUaGUgY2FwYWNpdHkgb2YgUVIgQ29kZSBpcyB1cCB0byA3MDAwIGRpZ2l0cyBvciA0MDAwCi8vIGNoYXJhY3RlcnMsIGFuZCBoYXMgaGlnaCByb2J1c3RuZXNzLgovLyBUaGlzIGNsYXNzIHN1cHBvcnRzIFFSIENvZGUgbW9kZWwgMiwgZGVzY3JpYmVkIGluCi8vIEpJUyAoSmFwYW5lc2UgSW5kdXN0cmlhbCBTdGFuZGFyZHMpIFgwNTEwOjIwMDQKLy8gb3IgSVNPL0lFQyAxODAwNC4KLy8gQ3VycmVudGx5IHRoZSBmb2xsb3dpbmcgZmVhdHVyZXMgYXJlIG5vdCBzdXBwb3J0ZWQ6Ci8vIEVDSSBhbmQgRk5DMSBtb2RlLCBNaWNybyBRUiBDb2RlLCBRUiBDb2RlIG1vZGVsIDEsCi8vIFN0cnVjdHVyZWQgbW9kZS4KLy8KLy8gVGhpcyBjbGFzcyBpcyBkZXJpdmVkIGZyb20gdGhlIGZvbGxvd2luZyBwcm9qZWN0czoKLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vICJQSFAgUVIgQ29kZSBlbmNvZGVyIgovLyBMaWNlbnNlOiBHTlUtTEdQTHYzCi8vIENvcHlyaWdodCAoQykgMjAxMCBieSBEb21pbmlrIER6aWVuaWEgPGRlbHRhbGFiIGF0IHBvY3p0YSBkb3QgZm0+Ci8vIGh0dHA6Ly9waHBxcmNvZGUuc291cmNlZm9yZ2UubmV0LwovLyBodHRwczovL3NvdXJjZWZvcmdlLm5ldC9wcm9qZWN0cy9waHBxcmNvZGUvCi8vCi8vIFRoZSAiUEhQIFFSIENvZGUgZW5jb2RlciIgaXMgYmFzZWQgb24KLy8gIkMgbGlicXJlbmNvZGUgbGlicmFyeSIgKHZlci4gMy4xLjEpCi8vIExpY2Vuc2U6IEdOVS1MR1BMIDIuMQovLyBDb3B5cmlnaHQgKEMpIDIwMDYtMjAxMCBieSBLZW50YXJvIEZ1a3VjaGkKLy8gaHR0cDovL21lZ2F1aS5uZXQvZnVrdWNoaS93b3Jrcy9xcmVuY29kZS9pbmRleC5lbi5odG1sCi8vCi8vIFJlZWQtU29sb21vbiBjb2RlIGVuY29kZXIgaXMgd3JpdHRlbiBieSBQaGlsIEthcm4sIEtBOVEuCi8vIENvcHlyaWdodCAoQykgMjAwMi0yMDA2IFBoaWwgS2FybiwgS0E5UQovLwovLyBRUiBDb2RlIGlzIHJlZ2lzdGVyZWQgdHJhZGVtYXJrIG9mIERFTlNPIFdBVkUgSU5DT1JQT1JBVEVECi8vIGh0dHA6Ly93d3cuZGVuc28td2F2ZS5jb20vcXJjb2RlL2luZGV4LWUuaHRtbAovLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KLy8KLy8gQXV0aG9yOiBOaWNvbGEgQXN1bmkKLy8KLy8gKGMpIENvcHlyaWdodCAyMDEwOgovLyAgICAgICAgICAgICAgIE5pY29sYSBBc3VuaQovLyAgICAgICAgICAgICAgIFRlY25pY2suY29tIFMuci5sLgovLyAgICAgICAgICAgICAgIFZpYSBkZWxsYSBQYWNlLCAxMQovLyAgICAgICAgICAgICAgIDA5MDQ0IFF1YXJ0dWNjaXUgKENBKQovLyAgICAgICAgICAgICAgIElUQUxZCi8vICAgICAgICAgICAgICAgd3d3LnRlY25pY2suY29tCi8vICAgICAgICAgICAgICAgaW5mb0B0ZWNuaWNrLmNvbQovLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSsKCi8qKgogKiBDbGFzcyB0byBjcmVhdGUgUVItY29kZSBhcnJheXMgZm9yIFRDUERGIGNsYXNzLgogKiBRUiBDb2RlIHN5bWJvbCBpcyBhIDJEIGJhcmNvZGUgdGhhdCBjYW4gYmUgc2Nhbm5lZCBieSBoYW5keSB0ZXJtaW5hbHMgc3VjaCBhcyBhIG1vYmlsZSBwaG9uZSB3aXRoIENDRC4KICogVGhlIGNhcGFjaXR5IG9mIFFSIENvZGUgaXMgdXAgdG8gNzAwMCBkaWdpdHMgb3IgNDAwMCBjaGFyYWN0ZXJzLCBhbmQgaGFzIGhpZ2ggcm9idXN0bmVzcy4KICogVGhpcyBjbGFzcyBzdXBwb3J0cyBRUiBDb2RlIG1vZGVsIDIsIGRlc2NyaWJlZCBpbiBKSVMgKEphcGFuZXNlIEluZHVzdHJpYWwgU3RhbmRhcmRzKSBYMDUxMDoyMDA0IG9yIElTTy9JRUMgMTgwMDQuCiAqIEN1cnJlbnRseSB0aGUgZm9sbG93aW5nIGZlYXR1cmVzIGFyZSBub3Qgc3VwcG9ydGVkOiBFQ0kgYW5kIEZOQzEgbW9kZSwgTWljcm8gUVIgQ29kZSwgUVIgQ29kZSBtb2RlbCAxLCBTdHJ1Y3R1cmVkIG1vZGUuCiAqCiAqIFRoaXMgY2xhc3MgaXMgZGVyaXZlZCBmcm9tICJQSFAgUVIgQ29kZSBlbmNvZGVyIiBieSBEb21pbmlrIER6aWVuaWEgKGh0dHA6Ly9waHBxcmNvZGUuc291cmNlZm9yZ2UubmV0LykgYmFzZWQgb24gImxpYnFyZW5jb2RlIEMgbGlicmFyeSAzLjEuMS4iIGJ5IEtlbnRhcm8gRnVrdWNoaSAoaHR0cDovL21lZ2F1aS5uZXQvZnVrdWNoaS93b3Jrcy9xcmVuY29kZS9pbmRleC5lbi5odG1sKSwgY29udGFpbnMgUmVlZC1Tb2xvbW9uIGNvZGUgd3JpdHRlbiBieSBQaGlsIEthcm4sIEtBOVEuIFFSIENvZGUgaXMgcmVnaXN0ZXJlZCB0cmFkZW1hcmsgb2YgREVOU08gV0FWRSBJTkNPUlBPUkFURUQgKGh0dHA6Ly93d3cuZGVuc28td2F2ZS5jb20vcXJjb2RlL2luZGV4LWUuaHRtbCkuCiAqIFBsZWFzZSByZWFkIGNvbW1lbnRzIG9uIHRoaXMgY2xhc3Mgc291cmNlIGZpbGUgZm9yIGZ1bGwgY29weXJpZ2h0IGFuZCBsaWNlbnNlIGluZm9ybWF0aW9uLgogKgogKiBAcGFja2FnZSBjb20udGVjbmljay50Y3BkZgogKiBAYWJzdHJhY3QgQ2xhc3MgZm9yIGdlbmVyYXRpbmcgUVItY29kZSBhcnJheSBmb3IgVENQREYuCiAqIEBhdXRob3IgTmljb2xhIEFzdW5pCiAqIEBjb3B5cmlnaHQgMjAxMCBOaWNvbGEgQXN1bmkgLSBUZWNuaWNrLmNvbSBTLnIubCAod3d3LnRlY25pY2suY29tKSBWaWEgRGVsbGEgUGFjZSwgMTEgLSAwOTA0NCAtIFF1YXJ0dWNjaXUgKENBKSAtIElUQUxZIC0gd3d3LnRlY25pY2suY29tIC0gaW5mb0B0ZWNuaWNrLmNvbQogKiBAbGluayBodHRwOi8vd3d3LnRjcGRmLm9yZwogKiBAbGljZW5zZSBodHRwOi8vd3d3LmdudS5vcmcvY29weWxlZnQvbGVzc2VyLmh0bWwgTEdQTAogKiBAdmVyc2lvbiAxLjAuMDAyCiAqLwoKLy8gZGVmaW5pdGlvbnMKaWYgKCFkZWZpbmVkKCdRUkNPREVERUZTJykpIHsKCgkvKioKCSAqIEluZGljYXRlIHRoYXQgZGVmaW5pdGlvbnMgZm9yIHRoaXMgY2xhc3MgYXJlIHNldAoJICovCglkZWZpbmUoJ1FSQ09ERURFRlMnLCB0cnVlKTsKCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKCS8vIEVuY29kaW5nIG1vZGVzIChjaGFyYWN0ZXJzIHdoaWNoIGNhbiBiZSBlbmNvZGVkIGluIFFSY29kZSkKCgkvKioKCSAqIEVuY29kaW5nIG1vZGUKCSAqLwoJZGVmaW5lKCdRUl9NT0RFX05MJywgLTEpOwoKCS8qKgoJICogRW5jb2RpbmcgbW9kZSBudW1lcmljICgwLTkpLiAzIGNoYXJhY3RlcnMgYXJlIGVuY29kZWQgdG8gMTBiaXQgbGVuZ3RoLiBJbiB0aGVvcnksIDcwODkgY2hhcmFjdGVycyBvciBsZXNzIGNhbiBiZSBzdG9yZWQgaW4gYSBRUmNvZGUuCgkgKi8KCWRlZmluZSgnUVJfTU9ERV9OTScsIDApOwoKCS8qKgoJICogRW5jb2RpbmcgbW9kZSBhbHBoYW51bWVyaWMgKDAtOUEtWiAkJSorLS4vOikgNDVjaGFyYWN0ZXJzLiAyIGNoYXJhY3RlcnMgYXJlIGVuY29kZWQgdG8gMTFiaXQgbGVuZ3RoLiBJbiB0aGVvcnksIDQyOTYgY2hhcmFjdGVycyBvciBsZXNzIGNhbiBiZSBzdG9yZWQgaW4gYSBRUmNvZGUuCgkgKi8KCWRlZmluZSgnUVJfTU9ERV9BTicsIDEpOwoKCS8qKgoJICogRW5jb2RpbmcgbW9kZSA4Yml0IGJ5dGUgZGF0YS4gSW4gdGhlb3J5LCAyOTUzIGNoYXJhY3RlcnMgb3IgbGVzcyBjYW4gYmUgc3RvcmVkIGluIGEgUVJjb2RlLgoJICovCglkZWZpbmUoJ1FSX01PREVfOEInLCAyKTsKCgkvKioKCSAqIEVuY29kaW5nIG1vZGUgS0FOSkkuIEEgS0FOSkkgY2hhcmFjdGVyIChtdWx0aWJ5dGUgY2hhcmFjdGVyKSBpcyBlbmNvZGVkIHRvIDEzYml0IGxlbmd0aC4gSW4gdGhlb3J5LCAxODE3IGNoYXJhY3RlcnMgb3IgbGVzcyBjYW4gYmUgc3RvcmVkIGluIGEgUVJjb2RlLgoJICovCglkZWZpbmUoJ1FSX01PREVfS0onLCAzKTsKCgkvKioKCSAqIEVuY29kaW5nIG1vZGUgU1RSVUNUVVJFRCAoY3VycmVudGx5IHVuc3VwcG9ydGVkKQoJICovCglkZWZpbmUoJ1FSX01PREVfU1QnLCA0KTsKCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKCS8vIExldmVscyBvZiBlcnJvciBjb3JyZWN0aW9uLgoJLy8gUVJjb2RlIGhhcyBhIGZ1bmN0aW9uIG9mIGFuIGVycm9yIGNvcnJlY3RpbmcgZm9yIG1pc3MgcmVhZGluZyB0aGF0IHdoaXRlIGlzIGJsYWNrLgoJLy8gRXJyb3IgY29ycmVjdGluZyBpcyBkZWZpbmVkIGluIDQgbGV2ZWwgYXMgYmVsb3cuCgoJLyoqCgkgKiBFcnJvciBjb3JyZWN0aW9uIGxldmVsIEwgOiBBYm91dCA3JSBvciBsZXNzIGVycm9ycyBjYW4gYmUgY29ycmVjdGVkLgoJICovCglkZWZpbmUoJ1FSX0VDTEVWRUxfTCcsIDApOwoKCS8qKgoJICogRXJyb3IgY29ycmVjdGlvbiBsZXZlbCBNIDogQWJvdXQgMTUlIG9yIGxlc3MgZXJyb3JzIGNhbiBiZSBjb3JyZWN0ZWQuCgkgKi8KCWRlZmluZSgnUVJfRUNMRVZFTF9NJywgMSk7CgoJLyoqCgkgKiBFcnJvciBjb3JyZWN0aW9uIGxldmVsIFEgOiBBYm91dCAyNSUgb3IgbGVzcyBlcnJvcnMgY2FuIGJlIGNvcnJlY3RlZC4KCSAqLwoJZGVmaW5lKCdRUl9FQ0xFVkVMX1EnLCAyKTsKCgkvKioKCSAqIEVycm9yIGNvcnJlY3Rpb24gbGV2ZWwgSCA6IEFib3V0IDMwJSBvciBsZXNzIGVycm9ycyBjYW4gYmUgY29ycmVjdGVkLgoJICovCglkZWZpbmUoJ1FSX0VDTEVWRUxfSCcsIDMpOwoKCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgoJLy8gVmVyc2lvbi4gU2l6ZSBvZiBRUmNvZGUgaXMgZGVmaW5lZCBhcyB2ZXJzaW9uLgoJLy8gVmVyc2lvbiBpcyBmcm9tIDEgdG8gNDAuCgkvLyBWZXJzaW9uIDEgaXMgMjEqMjEgbWF0cml4LiBBbmQgNCBtb2R1bGVzIGluY3JlYXNlcyB3aGVuZXZlciAxIHZlcnNpb24gaW5jcmVhc2VzLgoJLy8gU28gdmVyc2lvbiA0MCBpcyAxNzcqMTc3IG1hdHJpeC4KCgkvKioKCSAqIE1heGltdW0gUVIgQ29kZSB2ZXJzaW9uLgoJICovCglkZWZpbmUoJ1FSU1BFQ19WRVJTSU9OX01BWCcsIDQwKTsKCgkvKioKCSAqIE1heGltdW0gbWF0cml4IHNpemUgZm9yIG1heGltdW0gdmVyc2lvbiAodmVyc2lvbiA0MCBpcyAxNzcqMTc3IG1hdHJpeCkuCgkgKi8KICAgIGRlZmluZSgnUVJTUEVDX1dJRFRIX01BWCcsIDE3Nyk7CgoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgkvKioKCSAqIE1hdHJpeCBpbmRleCB0byBnZXQgd2lkdGggZnJvbSAkY2FwYWNpdHkgYXJyYXkuCgkgKi8KICAgIGRlZmluZSgnUVJDQVBfV0lEVEgnLCAgICAwKTsKCiAgICAvKioKCSAqIE1hdHJpeCBpbmRleCB0byBnZXQgbnVtYmVyIG9mIHdvcmRzIGZyb20gJGNhcGFjaXR5IGFycmF5LgoJICovCiAgICBkZWZpbmUoJ1FSQ0FQX1dPUkRTJywgICAgMSk7CgogICAgLyoqCgkgKiBNYXRyaXggaW5kZXggdG8gZ2V0IHJlbWFpbmRlciBmcm9tICRjYXBhY2l0eSBhcnJheS4KCSAqLwogICAgZGVmaW5lKCdRUkNBUF9SRU1JTkRFUicsIDIpOwoKICAgIC8qKgoJICogTWF0cml4IGluZGV4IHRvIGdldCBlcnJvciBjb3JyZWN0aW9uIGxldmVsIGZyb20gJGNhcGFjaXR5IGFycmF5LgoJICovCiAgICBkZWZpbmUoJ1FSQ0FQX0VDJywgICAgICAgMyk7CgoJLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCgkvLyBTdHJ1Y3R1cmUgKGN1cnJlbnRseSB1c3VwcG9ydGVkKQoKCS8qKgoJICogTnVtYmVyIG9mIGhlYWRlciBiaXRzIGZvciBzdHJ1Y3R1cmVkIG1vZGUKCSAqLwogICAgZGVmaW5lKCdTVFJVQ1RVUkVfSEVBREVSX0JJVFMnLCAgMjApOwoKICAgIC8qKgoJICogTWF4IG51bWJlciBvZiBzeW1ib2xzIGZvciBzdHJ1Y3R1cmVkIG1vZGUKCSAqLwogICAgZGVmaW5lKCdNQVhfU1RSVUNUVVJFRF9TWU1CT0xTJywgMTYpOwoKCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgogICAgLy8gTWFza3MKCiAgICAvKioKCSAqIERvd24gcG9pbnQgYmFzZSB2YWx1ZSBmb3IgY2FzZSAxIG1hc2sgcGF0dGVybiAoY29uY2F0ZW5hdGlvbiBvZiBzYW1lIGNvbG9yIGluIGEgbGluZSBvciBhIGNvbHVtbikKCSAqLwogICAgZGVmaW5lKCdOMScsICAzKTsKCiAgICAvKioKCSAqIERvd24gcG9pbnQgYmFzZSB2YWx1ZSBmb3IgY2FzZSAyIG1hc2sgcGF0dGVybiAobW9kdWxlIGJsb2NrIG9mIHNhbWUgY29sb3IpCgkgKi8KCWRlZmluZSgnTjInLCAgMyk7CgogICAgLyoqCgkgKiBEb3duIHBvaW50IGJhc2UgdmFsdWUgZm9yIGNhc2UgMyBtYXNrIHBhdHRlcm4gKDE6MTozOjE6MShkYXJrOmJyaWdodDpkYXJrOmJyaWdodDpkYXJrKXBhdHRlcm4gaW4gYSBsaW5lIG9yIGEgY29sdW1uKQoJICovCglkZWZpbmUoJ04zJywgNDApOwoKICAgIC8qKgoJICogRG93biBwb2ludCBiYXNlIHZhbHVlIGZvciBjYXNlIDQgbWFzayBwYXR0ZXJuIChyYXRpb24gb2YgZGFyayBtb2R1bGVzIGluIHdob2xlKQoJICovCglkZWZpbmUoJ040JywgMTApOwoKCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgoJLy8gT3B0aW1pemF0aW9uIHNldHRpbmdzCgoJLyoqCgkgKiBpZiB0cnVlLCBlc3RpbWF0ZXMgYmVzdCBtYXNrIChzcGVjLiBkZWZhdWx0LCBidXQgZXh0cmVtYWxseSBzbG93OyBzZXQgdG8gZmFsc2UgdG8gc2lnbmlmaWNhbnQgcGVyZm9ybWFuY2UgYm9vc3QgYnV0IChwcm9wYWJseSkgd29yc3QgcXVhbGl0eSBjb2RlCgkgKi8KCWRlZmluZSgnUVJfRklORF9CRVNUX01BU0snLCB0cnVlKTsKCgkvKioKCSAqIGlmIGZhbHNlLCBjaGVja3MgYWxsIG1hc2tzIGF2YWlsYWJsZSwgb3RoZXJ3aXNlIHZhbHVlIHRlbGxzIGNvdW50IG9mIG1hc2tzIG5lZWQgdG8gYmUgY2hlY2tlZCwgbWFzayBpZCBhcmUgZ290IHJhbmRvbWx5CgkgKi8KCWRlZmluZSgnUVJfRklORF9GUk9NX1JBTkRPTScsIDIpOwoKCS8qKgoJICogd2hlbiBRUl9GSU5EX0JFU1RfTUFTSyA9PT0gZmFsc2UKCSAqLwoJZGVmaW5lKCdRUl9ERUZBVUxUX01BU0snLCAyKTsKCgkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoKfSAvLyBlbmQgb2YgZGVmaW5pdGlvbnMKCi8vICMqIyojKiMqIyojKiMqIyojKiMqIyojKiMqIyojKiMqIyojKiMqIyojKiMqIyojKiMqIyojKiMqIwoKaWYgKCFjbGFzc19leGlzdHMoJ1FSY29kZScsIGZhbHNlKSkgewoKCS8vIGZvciBjb21wYWliaWxpdHkgd2l0aCBQSFA0CglpZiAoIWZ1bmN0aW9uX2V4aXN0cygnc3RyX3NwbGl0JykpIHsKICAgIAkvKioKICAgIAkgKiBDb252ZXJ0IGEgc3RyaW5nIHRvIGFuIGFycmF5IChuZWVkZWQgZm9yIFBIUDQgY29tcGF0aWJpbGl0eSkKICAgIAkgKiBAcGFyYW0gc3RyaW5nICRzdHJpbmcgVGhlIGlucHV0IHN0cmluZy4KICAgIAkgKiBAcGFyYW0gaW50ICRzcGxpdF9sZW5ndGggTWF4aW11bSBsZW5ndGggb2YgdGhlIGNodW5rLgogICAgCSAqIEByZXR1cm4gIElmIHRoZSBvcHRpb25hbCBzcGxpdF9sZW5ndGggIHBhcmFtZXRlciBpcyBzcGVjaWZpZWQsIHRoZSByZXR1cm5lZCBhcnJheSB3aWxsIGJlIGJyb2tlbiBkb3duIGludG8gY2h1bmtzIHdpdGggZWFjaCBiZWluZyBzcGxpdF9sZW5ndGggIGluIGxlbmd0aCwgb3RoZXJ3aXNlIGVhY2ggY2h1bmsgd2lsbCBiZSBvbmUgY2hhcmFjdGVyIGluIGxlbmd0aC4gRkFMU0UgaXMgcmV0dXJuZWQgaWYgc3BsaXRfbGVuZ3RoIGlzIGxlc3MgdGhhbiAxLiBJZiB0aGUgc3BsaXRfbGVuZ3RoIGxlbmd0aCBleGNlZWRzIHRoZSBsZW5ndGggb2Ygc3RyaW5nICwgdGhlIGVudGlyZSBzdHJpbmcgaXMgcmV0dXJuZWQgYXMgdGhlIGZpcnN0IChhbmQgb25seSkgYXJyYXkgZWxlbWVudC4KICAgIAkgKi8KCQlmdW5jdGlvbiBzdHJfc3BsaXQoJHN0cmluZywgJHNwbGl0X2xlbmd0aD0xKSB7CgkJCWlmICgoc3RybGVuKCRzdHJpbmcpID4gJHNwbGl0X2xlbmd0aCkgT1IgKCEkc3BsaXRfbGVuZ3RoKSkgewoJCQkJZG8gewoJCQkJCSRjID0gc3RybGVuKCRzdHJpbmcpOwoJCQkJCSRwYXJ0c1tdID0gc3Vic3RyKCRzdHJpbmcsIDAsICRzcGxpdF9sZW5ndGgpOwoJCQkJCSRzdHJpbmcgPSBzdWJzdHIoJHN0cmluZywgJHNwbGl0X2xlbmd0aCk7CgkJCQl9IHdoaWxlICgkc3RyaW5nICE9PSBmYWxzZSk7CgkJCX0gZWxzZSB7CgkJCQkkcGFydHMgPSBhcnJheSgkc3RyaW5nKTsKCQkJfQoJCQlyZXR1cm4gJHBhcnRzOwoJCX0KCX0KCgkvLyAjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIwoKCS8qKgoJICogQ2xhc3MgdG8gY3JlYXRlIFFSLWNvZGUgYXJyYXlzIGZvciBUQ1BERiBjbGFzcy4KCSAqIFFSIENvZGUgc3ltYm9sIGlzIGEgMkQgYmFyY29kZSB0aGF0IGNhbiBiZSBzY2FubmVkIGJ5IGhhbmR5IHRlcm1pbmFscyBzdWNoIGFzIGEgbW9iaWxlIHBob25lIHdpdGggQ0NELgoJICogVGhlIGNhcGFjaXR5IG9mIFFSIENvZGUgaXMgdXAgdG8gNzAwMCBkaWdpdHMgb3IgNDAwMCBjaGFyYWN0ZXJzLCBhbmQgaGFzIGhpZ2ggcm9idXN0bmVzcy4KCSAqIFRoaXMgY2xhc3Mgc3VwcG9ydHMgUVIgQ29kZSBtb2RlbCAyLCBkZXNjcmliZWQgaW4gSklTIChKYXBhbmVzZSBJbmR1c3RyaWFsIFN0YW5kYXJkcykgWDA1MTA6MjAwNCBvciBJU08vSUVDIDE4MDA0LgoJICogQ3VycmVudGx5IHRoZSBmb2xsb3dpbmcgZmVhdHVyZXMgYXJlIG5vdCBzdXBwb3J0ZWQ6IEVDSSBhbmQgRk5DMSBtb2RlLCBNaWNybyBRUiBDb2RlLCBRUiBDb2RlIG1vZGVsIDEsIFN0cnVjdHVyZWQgbW9kZS4KCSAqCgkgKiBUaGlzIGNsYXNzIGlzIGRlcml2ZWQgZnJvbSAiUEhQIFFSIENvZGUgZW5jb2RlciIgYnkgRG9taW5payBEemllbmlhIChodHRwOi8vcGhwcXJjb2RlLnNvdXJjZWZvcmdlLm5ldC8pIGJhc2VkIG9uICJsaWJxcmVuY29kZSBDIGxpYnJhcnkgMy4xLjEuIiBieSBLZW50YXJvIEZ1a3VjaGkgKGh0dHA6Ly9tZWdhdWkubmV0L2Z1a3VjaGkvd29ya3MvcXJlbmNvZGUvaW5kZXguZW4uaHRtbCksIGNvbnRhaW5zIFJlZWQtU29sb21vbiBjb2RlIHdyaXR0ZW4gYnkgUGhpbCBLYXJuLCBLQTlRLiBRUiBDb2RlIGlzIHJlZ2lzdGVyZWQgdHJhZGVtYXJrIG9mIERFTlNPIFdBVkUgSU5DT1JQT1JBVEVEIChodHRwOi8vd3d3LmRlbnNvLXdhdmUuY29tL3FyY29kZS9pbmRleC1lLmh0bWwpLgoJICogUGxlYXNlIHJlYWQgY29tbWVudHMgb24gdGhpcyBjbGFzcyBzb3VyY2UgZmlsZSBmb3IgZnVsbCBjb3B5cmlnaHQgYW5kIGxpY2Vuc2UgaW5mb3JtYXRpb24uCgkgKgoJICogQG5hbWUgUVJjb2RlCgkgKiBAcGFja2FnZSBjb20udGVjbmljay50Y3BkZgoJICogQGFic3RyYWN0IENsYXNzIGZvciBnZW5lcmF0aW5nIFFSLWNvZGUgYXJyYXkgZm9yIFRDUERGLgoJICogQGF1dGhvciBOaWNvbGEgQXN1bmkKCSAqIEBjb3B5cmlnaHQgMjAxMCBOaWNvbGEgQXN1bmkgLSBUZWNuaWNrLmNvbSBTLnIubCAod3d3LnRlY25pY2suY29tKSBWaWEgRGVsbGEgUGFjZSwgMTEgLSAwOTA0NCAtIFF1YXJ0dWNjaXUgKENBKSAtIElUQUxZIC0gd3d3LnRlY25pY2suY29tIC0gaW5mb0B0ZWNuaWNrLmNvbQoJICogQGxpbmsgaHR0cDovL3d3dy50Y3BkZi5vcmcKCSAqIEBsaWNlbnNlIGh0dHA6Ly93d3cuZ251Lm9yZy9jb3B5bGVmdC9sZXNzZXIuaHRtbCBMR1BMCgkgKiBAdmVyc2lvbiAxLjAuMDAyCgkgKi8KCWNsYXNzIFFSY29kZSB7CgoJCS8qKgoJCSAqIEB2YXIgYmFyY29kZSBhcnJheSB0byBiZSByZXR1cm5lZCB3aGljaCBpcyByZWFkYWJsZSBieSBUQ1BERgoJCSAqIEBhY2Nlc3MgcHJvdGVjdGVkCgkJICovCgkJcHJvdGVjdGVkICRiYXJjb2RlX2FycmF5ID0gYXJyYXkoKTsKCgkJLyoqCgkJICogQHZhciBRUiBjb2RlIHZlcnNpb24uIFNpemUgb2YgUVJjb2RlIGlzIGRlZmluZWQgYXMgdmVyc2lvbi4gVmVyc2lvbiBpcyBmcm9tIDEgdG8gNDAuIFZlcnNpb24gMSBpcyAyMSoyMSBtYXRyaXguIEFuZCA0IG1vZHVsZXMgaW5jcmVhc2VzIHdoZW5ldmVyIDEgdmVyc2lvbiBpbmNyZWFzZXMuIFNvIHZlcnNpb24gNDAgaXMgMTc3KjE3NyBtYXRyaXguCgkJICogQGFjY2VzcyBwcm90ZWN0ZWQKCQkgKi8KCQlwcm90ZWN0ZWQgJHZlcnNpb24gPSAwOwoKCQkvKioKCQkgKiBAdmFyIExldmVscyBvZiBlcnJvciBjb3JyZWN0aW9uLiBTZWUgZGVmaW5pdGlvbnMgZm9yIHBvc3NpYmxlIHZhbHVlcy4KCQkgKiBAYWNjZXNzIHByb3RlY3RlZAoJCSAqLwoJCXByb3RlY3RlZCAkbGV2ZWwgPSBRUl9FQ0xFVkVMX0w7CgoJCS8qKgoJCSAqIEB2YXIgRW5jb2RpbmcgbW9kZQoJCSAqIEBhY2Nlc3MgcHJvdGVjdGVkCgkJICovCgkJcHJvdGVjdGVkICRoaW50ID0gUVJfTU9ERV84QjsKCgkJLyoqCgkJICogQHZhciBpZiB0cnVlIHRoZSBpbnB1dCBzdHJpbmcgd2lsbCBiZSBjb252ZXJ0ZWQgdG8gdXBwZXJjYXNlCgkJICogQGFjY2VzcyBwcm90ZWN0ZWQKCQkgKi8KCQlwcm90ZWN0ZWQgJGNhc2VzZW5zaXRpdmUgPSB0cnVlOwoKCQkvKioKCQkgKiBAdmFyIHN0cnVjdHVyZWQgUVIgY29kZSAobm90IHN1cHBvcnRlZCB5ZXQpCgkJICogQGFjY2VzcyBwcm90ZWN0ZWQKCQkgKi8KCQlwcm90ZWN0ZWQgJHN0cnVjdHVyZWQgPSAwOwoKCQkvKioKCQkgKiBAdmFyIG1hc2sgZGF0YQoJCSAqIEBhY2Nlc3MgcHJvdGVjdGVkCgkJICovCgkJcHJvdGVjdGVkICRkYXRhOwoKCQkvLyBGcmFtZUZpbGxlcgoKCQkvKioKCQkgKiBAdmFyIHdpZHRoCgkJICogQGFjY2VzcyBwcm90ZWN0ZWQKCQkgKi8KCQlwcm90ZWN0ZWQgJHdpZHRoOwoKCQkvKioKCQkgKiBAdmFyIGZyYW1lCgkJICogQGFjY2VzcyBwcm90ZWN0ZWQKCQkgKi8KCQlwcm90ZWN0ZWQgJGZyYW1lOwoKCQkvKioKCQkgKiBAdmFyIFggcG9zaXRpb24gb2YgYml0CgkJICogQGFjY2VzcyBwcm90ZWN0ZWQKCQkgKi8KCQlwcm90ZWN0ZWQgJHg7CgoJCS8qKgoJCSAqIEB2YXIgWSBwb3NpdGlvbiBvZiBiaXQKCQkgKiBAYWNjZXNzIHByb3RlY3RlZAoJCSAqLwoJCXByb3RlY3RlZCAkeTsKCgkJLyoqCgkJICogQHZhciBkaXJlY3Rpb24KCQkgKiBAYWNjZXNzIHByb3RlY3RlZAoJCSAqLwoJCXByb3RlY3RlZCAkZGlyOwoKCQkvKioKCQkgKiBAdmFyIHNpbmdsZSBiaXQKCQkgKiBAYWNjZXNzIHByb3RlY3RlZAoJCSAqLwoJCXByb3RlY3RlZCAkYml0OwoKCQkvLyAtLS0tIFFScmF3Y29kZSAtLS0tCgoJCS8qKgoJCSAqIEB2YXIgZGF0YSBjb2RlCgkJICogQGFjY2VzcyBwcm90ZWN0ZWQKCQkgKi8KCQlwcm90ZWN0ZWQgJGRhdGFjb2RlID0gYXJyYXkoKTsKCgkJLyoqCgkJICogQHZhciBlcnJvciBjb3JyZWN0aW9uIGNvZGUKCQkgKiBAYWNjZXNzIHByb3RlY3RlZAoJCSAqLwoJCXByb3RlY3RlZCAkZWNjY29kZSA9IGFycmF5KCk7CgoJCS8qKgoJCSAqIEB2YXIgYmxvY2tzCgkJICogQGFjY2VzcyBwcm90ZWN0ZWQKCQkgKi8KCQlwcm90ZWN0ZWQgJGJsb2NrczsKCgkJLyoqCgkJICogQHZhciBSZWVkLVNvbG9tb24gYmxvY2tzCgkJICogQGFjY2VzcyBwcm90ZWN0ZWQKCQkgKi8KCQlwcm90ZWN0ZWQgJHJzYmxvY2tzID0gYXJyYXkoKTsgLy9vZiBSU2Jsb2NrCgoJCS8qKgoJCSAqIEB2YXIgY291bnRlcgoJCSAqIEBhY2Nlc3MgcHJvdGVjdGVkCgkJICovCgkJcHJvdGVjdGVkICRjb3VudDsKCgkJLyoqCgkJICogQHZhciBkYXRhIGxlbmd0aAoJCSAqIEBhY2Nlc3MgcHJvdGVjdGVkCgkJICovCgkJcHJvdGVjdGVkICRkYXRhTGVuZ3RoOwoKCQkvKioKCQkgKiBAdmFyIGVycm9yIGNvcnJlY3Rpb24gbGVuZ3RoCgkJICogQGFjY2VzcyBwcm90ZWN0ZWQKCQkgKi8KCQlwcm90ZWN0ZWQgJGVjY0xlbmd0aDsKCgkJLyoqCgkJICogQHZhciBiMQoJCSAqIEBhY2Nlc3MgcHJvdGVjdGVkCgkJICovCgkJcHJvdGVjdGVkICRiMTsKCgkJLy8gLS0tLSBRUm1hc2sgLS0tLQoKCQkvKioKCQkgKiBAdmFyIHJ1biBsZW5ndGgKCQkgKiBAYWNjZXNzIHByb3RlY3RlZAoJCSAqLwoJCXByb3RlY3RlZCAkcnVuTGVuZ3RoID0gYXJyYXkoKTsKCgkJLy8gLS0tLSBRUnNwbGl0IC0tLS0KCgkJLyoqCgkJICogQHZhciBpbnB1dCBkYXRhIHN0cmluZwoJCSAqIEBhY2Nlc3MgcHJvdGVjdGVkCgkJICovCgkJcHJvdGVjdGVkICRkYXRhU3RyID0gJyc7CgoJCS8qKgoJCSAqIEB2YXIgaW5wdXQgaXRlbXMKCQkgKiBAYWNjZXNzIHByb3RlY3RlZAoJCSAqLwoJCXByb3RlY3RlZCAkaXRlbXM7CgoJCS8vIFJlZWQtU29sb21vbiBpdGVtcwoKCQkvKioKCQkgKiBAdmFyIFJlZWQtU29sb21vbiBpdGVtcwoJCSAqIEBhY2Nlc3MgcHJvdGVjdGVkCgkJICovCgkJcHJvdGVjdGVkICRyc2l0ZW1zID0gYXJyYXkoKTsKCgkJLyoqCgkJICogQHZhciBhcnJheSBvZiBmcmFtZXMKCQkgKiBAYWNjZXNzIHByb3RlY3RlZAoJCSAqLwoJCXByb3RlY3RlZCAkZnJhbWVzID0gYXJyYXkoKTsKCgkJLyoqCgkJICogQHZhciBhbHBoYWJldC1udW1lcmljIGNvbnZlc2lvbiB0YWJsZQoJCSAqIEBhY2Nlc3MgcHJvdGVjdGVkCgkJICovCgkJcHJvdGVjdGVkICRhblRhYmxlID0gYXJyYXkoCgkJCS0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAvLwoJCQktMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLy8KCQkJMzYsIC0xLCAtMSwgLTEsIDM3LCAzOCwgLTEsIC0xLCAtMSwgLTEsIDM5LCA0MCwgLTEsIDQxLCA0MiwgNDMsIC8vCgkJCSAwLCAgMSwgIDIsICAzLCAgNCwgIDUsICA2LCAgNywgIDgsICA5LCA0NCwgLTEsIC0xLCAtMSwgLTEsIC0xLCAvLwoJCQktMSwgMTAsIDExLCAxMiwgMTMsIDE0LCAxNSwgMTYsIDE3LCAxOCwgMTksIDIwLCAyMSwgMjIsIDIzLCAyNCwgLy8KCQkJMjUsIDI2LCAyNywgMjgsIDI5LCAzMCwgMzEsIDMyLCAzMywgMzQsIDM1LCAtMSwgLTEsIC0xLCAtMSwgLTEsIC8vCgkJCS0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAvLwoJCQktMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSwgLTEsIC0xLCAtMSAgLy8KCQkJKTsKCgkJLyoqCgkJICogQHZhciBhcnJheSBUYWJsZSBvZiB0aGUgY2FwYWNpdHkgb2Ygc3ltYm9scwoJCSAqIFNlZSBUYWJsZSAxIChwcC4xMykgYW5kIFRhYmxlIDEyLTE2IChwcC4zMC0zNiksIEpJUyBYMDUxMDoyMDA0LgoJCSAqIEBhY2Nlc3MgcHJvdGVjdGVkCgkJICovCgkJcHJvdGVjdGVkICRjYXBhY2l0eSA9IGFycmF5KAoJCQlhcnJheSggIDAsICAgIDAsIDAsIGFycmF5KCAgIDAsICAgIDAsICAgIDAsICAgIDApKSwgLy8KCQkJYXJyYXkoIDIxLCAgIDI2LCAwLCBhcnJheSggICA3LCAgIDEwLCAgIDEzLCAgIDE3KSksIC8vICAxCgkJCWFycmF5KCAyNSwgICA0NCwgNywgYXJyYXkoICAxMCwgICAxNiwgICAyMiwgICAyOCkpLCAvLwoJCQlhcnJheSggMjksICAgNzAsIDcsIGFycmF5KCAgMTUsICAgMjYsICAgMzYsICAgNDQpKSwgLy8KCQkJYXJyYXkoIDMzLCAgMTAwLCA3LCBhcnJheSggIDIwLCAgIDM2LCAgIDUyLCAgIDY0KSksIC8vCgkJCWFycmF5KCAzNywgIDEzNCwgNywgYXJyYXkoICAyNiwgICA0OCwgICA3MiwgICA4OCkpLCAvLyAgNQoJCQlhcnJheSggNDEsICAxNzIsIDcsIGFycmF5KCAgMzYsICAgNjQsICAgOTYsICAxMTIpKSwgLy8KCQkJYXJyYXkoIDQ1LCAgMTk2LCAwLCBhcnJheSggIDQwLCAgIDcyLCAgMTA4LCAgMTMwKSksIC8vCgkJCWFycmF5KCA0OSwgIDI0MiwgMCwgYXJyYXkoICA0OCwgICA4OCwgIDEzMiwgIDE1NikpLCAvLwoJCQlhcnJheSggNTMsICAyOTIsIDAsIGFycmF5KCAgNjAsICAxMTAsICAxNjAsICAxOTIpKSwgLy8KCQkJYXJyYXkoIDU3LCAgMzQ2LCAwLCBhcnJheSggIDcyLCAgMTMwLCAgMTkyLCAgMjI0KSksIC8vIDEwCgkJCWFycmF5KCA2MSwgIDQwNCwgMCwgYXJyYXkoICA4MCwgIDE1MCwgIDIyNCwgIDI2NCkpLCAvLwoJCQlhcnJheSggNjUsICA0NjYsIDAsIGFycmF5KCAgOTYsICAxNzYsICAyNjAsICAzMDgpKSwgLy8KCQkJYXJyYXkoIDY5LCAgNTMyLCAwLCBhcnJheSggMTA0LCAgMTk4LCAgMjg4LCAgMzUyKSksIC8vCgkJCWFycmF5KCA3MywgIDU4MSwgMywgYXJyYXkoIDEyMCwgIDIxNiwgIDMyMCwgIDM4NCkpLCAvLwoJCQlhcnJheSggNzcsICA2NTUsIDMsIGFycmF5KCAxMzIsICAyNDAsICAzNjAsICA0MzIpKSwgLy8gMTUKCQkJYXJyYXkoIDgxLCAgNzMzLCAzLCBhcnJheSggMTQ0LCAgMjgwLCAgNDA4LCAgNDgwKSksIC8vCgkJCWFycmF5KCA4NSwgIDgxNSwgMywgYXJyYXkoIDE2OCwgIDMwOCwgIDQ0OCwgIDUzMikpLCAvLwoJCQlhcnJheSggODksICA5MDEsIDMsIGFycmF5KCAxODAsICAzMzgsICA1MDQsICA1ODgpKSwgLy8KCQkJYXJyYXkoIDkzLCAgOTkxLCAzLCBhcnJheSggMTk2LCAgMzY0LCAgNTQ2LCAgNjUwKSksIC8vCgkJCWFycmF5KCA5NywgMTA4NSwgMywgYXJyYXkoIDIyNCwgIDQxNiwgIDYwMCwgIDcwMCkpLCAvLyAyMAoJCQlhcnJheSgxMDEsIDExNTYsIDQsIGFycmF5KCAyMjQsICA0NDIsICA2NDQsICA3NTApKSwgLy8KCQkJYXJyYXkoMTA1LCAxMjU4LCA0LCBhcnJheSggMjUyLCAgNDc2LCAgNjkwLCAgODE2KSksIC8vCgkJCWFycmF5KDEwOSwgMTM2NCwgNCwgYXJyYXkoIDI3MCwgIDUwNCwgIDc1MCwgIDkwMCkpLCAvLwoJCQlhcnJheSgxMTMsIDE0NzQsIDQsIGFycmF5KCAzMDAsICA1NjAsICA4MTAsICA5NjApKSwgLy8KCQkJYXJyYXkoMTE3LCAxNTg4LCA0LCBhcnJheSggMzEyLCAgNTg4LCAgODcwLCAxMDUwKSksIC8vIDI1CgkJCWFycmF5KDEyMSwgMTcwNiwgNCwgYXJyYXkoIDMzNiwgIDY0NCwgIDk1MiwgMTExMCkpLCAvLwoJCQlhcnJheSgxMjUsIDE4MjgsIDQsIGFycmF5KCAzNjAsICA3MDAsIDEwMjAsIDEyMDApKSwgLy8KCQkJYXJyYXkoMTI5LCAxOTIxLCAzLCBhcnJheSggMzkwLCAgNzI4LCAxMDUwLCAxMjYwKSksIC8vCgkJCWFycmF5KDEzMywgMjA1MSwgMywgYXJyYXkoIDQyMCwgIDc4NCwgMTE0MCwgMTM1MCkpLCAvLwoJCQlhcnJheSgxMzcsIDIxODUsIDMsIGFycmF5KCA0NTAsICA4MTIsIDEyMDAsIDE0NDApKSwgLy8gMzAKCQkJYXJyYXkoMTQxLCAyMzIzLCAzLCBhcnJheSggNDgwLCAgODY4LCAxMjkwLCAxNTMwKSksIC8vCgkJCWFycmF5KDE0NSwgMjQ2NSwgMywgYXJyYXkoIDUxMCwgIDkyNCwgMTM1MCwgMTYyMCkpLCAvLwoJCQlhcnJheSgxNDksIDI2MTEsIDMsIGFycmF5KCA1NDAsICA5ODAsIDE0NDAsIDE3MTApKSwgLy8KCQkJYXJyYXkoMTUzLCAyNzYxLCAzLCBhcnJheSggNTcwLCAxMDM2LCAxNTMwLCAxODAwKSksIC8vCgkJCWFycmF5KDE1NywgMjg3NiwgMCwgYXJyYXkoIDU3MCwgMTA2NCwgMTU5MCwgMTg5MCkpLCAvLyAzNQoJCQlhcnJheSgxNjEsIDMwMzQsIDAsIGFycmF5KCA2MDAsIDExMjAsIDE2ODAsIDE5ODApKSwgLy8KCQkJYXJyYXkoMTY1LCAzMTk2LCAwLCBhcnJheSggNjMwLCAxMjA0LCAxNzcwLCAyMTAwKSksIC8vCgkJCWFycmF5KDE2OSwgMzM2MiwgMCwgYXJyYXkoIDY2MCwgMTI2MCwgMTg2MCwgMjIyMCkpLCAvLwoJCQlhcnJheSgxNzMsIDM1MzIsIDAsIGFycmF5KCA3MjAsIDEzMTYsIDE5NTAsIDIzMTApKSwgLy8KCQkJYXJyYXkoMTc3LCAzNzA2LCAwLCBhcnJheSggNzUwLCAxMzcyLCAyMDQwLCAyNDMwKSkgIC8vIDQwCgkJKTsKCgkJLyoqCgkJICogQHZhciBhcnJheSBMZW5ndGggaW5kaWNhdG9yCgkJICogQGFjY2VzcyBwcm90ZWN0ZWQKCQkgKi8KCQlwcm90ZWN0ZWQgJGxlbmd0aFRhYmxlQml0cyA9IGFycmF5KAoJCQlhcnJheSgxMCwgMTIsIDE0KSwKCQkJYXJyYXkoIDksIDExLCAxMyksCgkJCWFycmF5KCA4LCAxNiwgMTYpLAoJCQlhcnJheSggOCwgMTAsIDEyKQoJCSk7CgoJCS8qKgoJCSAqIEB2YXIgYXJyYXkgVGFibGUgb2YgdGhlIGVycm9yIGNvcnJlY3Rpb24gY29kZSAoUmVlZC1Tb2xvbW9uIGJsb2NrKQoJCSAqIFNlZSBUYWJsZSAxMi0xNiAocHAuMzAtMzYpLCBKSVMgWDA1MTA6MjAwNC4KCQkgKiBAYWNjZXNzIHByb3RlY3RlZAoJCSAqLwoJCXByb3RlY3RlZCAkZWNjVGFibGUgPSBhcnJheSgKCQkJYXJyYXkoYXJyYXkoIDAsICAwKSwgYXJyYXkoIDAsICAwKSwgYXJyYXkoIDAsICAwKSwgYXJyYXkoIDAsICAwKSksIC8vCgkJCWFycmF5KGFycmF5KCAxLCAgMCksIGFycmF5KCAxLCAgMCksIGFycmF5KCAxLCAgMCksIGFycmF5KCAxLCAgMCkpLCAvLyAgMQoJCQlhcnJheShhcnJheSggMSwgIDApLCBhcnJheSggMSwgIDApLCBhcnJheSggMSwgIDApLCBhcnJheSggMSwgIDApKSwgLy8KCQkJYXJyYXkoYXJyYXkoIDEsICAwKSwgYXJyYXkoIDEsICAwKSwgYXJyYXkoIDIsICAwKSwgYXJyYXkoIDIsICAwKSksIC8vCgkJCWFycmF5KGFycmF5KCAxLCAgMCksIGFycmF5KCAyLCAgMCksIGFycmF5KCAyLCAgMCksIGFycmF5KCA0LCAgMCkpLCAvLwoJCQlhcnJheShhcnJheSggMSwgIDApLCBhcnJheSggMiwgIDApLCBhcnJheSggMiwgIDIpLCBhcnJheSggMiwgIDIpKSwgLy8gIDUKCQkJYXJyYXkoYXJyYXkoIDIsICAwKSwgYXJyYXkoIDQsICAwKSwgYXJyYXkoIDQsICAwKSwgYXJyYXkoIDQsICAwKSksIC8vCgkJCWFycmF5KGFycmF5KCAyLCAgMCksIGFycmF5KCA0LCAgMCksIGFycmF5KCAyLCAgNCksIGFycmF5KCA0LCAgMSkpLCAvLwoJCQlhcnJheShhcnJheSggMiwgIDApLCBhcnJheSggMiwgIDIpLCBhcnJheSggNCwgIDIpLCBhcnJheSggNCwgIDIpKSwgLy8KCQkJYXJyYXkoYXJyYXkoIDIsICAwKSwgYXJyYXkoIDMsICAyKSwgYXJyYXkoIDQsICA0KSwgYXJyYXkoIDQsICA0KSksIC8vCgkJCWFycmF5KGFycmF5KCAyLCAgMiksIGFycmF5KCA0LCAgMSksIGFycmF5KCA2LCAgMiksIGFycmF5KCA2LCAgMikpLCAvLyAxMAoJCQlhcnJheShhcnJheSggNCwgIDApLCBhcnJheSggMSwgIDQpLCBhcnJheSggNCwgIDQpLCBhcnJheSggMywgIDgpKSwgLy8KCQkJYXJyYXkoYXJyYXkoIDIsICAyKSwgYXJyYXkoIDYsICAyKSwgYXJyYXkoIDQsICA2KSwgYXJyYXkoIDcsICA0KSksIC8vCgkJCWFycmF5KGFycmF5KCA0LCAgMCksIGFycmF5KCA4LCAgMSksIGFycmF5KCA4LCAgNCksIGFycmF5KDEyLCAgNCkpLCAvLwoJCQlhcnJheShhcnJheSggMywgIDEpLCBhcnJheSggNCwgIDUpLCBhcnJheSgxMSwgIDUpLCBhcnJheSgxMSwgIDUpKSwgLy8KCQkJYXJyYXkoYXJyYXkoIDUsICAxKSwgYXJyYXkoIDUsICA1KSwgYXJyYXkoIDUsICA3KSwgYXJyYXkoMTEsICA3KSksIC8vIDE1CgkJCWFycmF5KGFycmF5KCA1LCAgMSksIGFycmF5KCA3LCAgMyksIGFycmF5KDE1LCAgMiksIGFycmF5KCAzLCAxMykpLCAvLwoJCQlhcnJheShhcnJheSggMSwgIDUpLCBhcnJheSgxMCwgIDEpLCBhcnJheSggMSwgMTUpLCBhcnJheSggMiwgMTcpKSwgLy8KCQkJYXJyYXkoYXJyYXkoIDUsICAxKSwgYXJyYXkoIDksICA0KSwgYXJyYXkoMTcsICAxKSwgYXJyYXkoIDIsIDE5KSksIC8vCgkJCWFycmF5KGFycmF5KCAzLCAgNCksIGFycmF5KCAzLCAxMSksIGFycmF5KDE3LCAgNCksIGFycmF5KCA5LCAxNikpLCAvLwoJCQlhcnJheShhcnJheSggMywgIDUpLCBhcnJheSggMywgMTMpLCBhcnJheSgxNSwgIDUpLCBhcnJheSgxNSwgMTApKSwgLy8gMjAKCQkJYXJyYXkoYXJyYXkoIDQsICA0KSwgYXJyYXkoMTcsICAwKSwgYXJyYXkoMTcsICA2KSwgYXJyYXkoMTksICA2KSksIC8vCgkJCWFycmF5KGFycmF5KCAyLCAgNyksIGFycmF5KDE3LCAgMCksIGFycmF5KCA3LCAxNiksIGFycmF5KDM0LCAgMCkpLCAvLwoJCQlhcnJheShhcnJheSggNCwgIDUpLCBhcnJheSggNCwgMTQpLCBhcnJheSgxMSwgMTQpLCBhcnJheSgxNiwgMTQpKSwgLy8KCQkJYXJyYXkoYXJyYXkoIDYsICA0KSwgYXJyYXkoIDYsIDE0KSwgYXJyYXkoMTEsIDE2KSwgYXJyYXkoMzAsICAyKSksIC8vCgkJCWFycmF5KGFycmF5KCA4LCAgNCksIGFycmF5KCA4LCAxMyksIGFycmF5KCA3LCAyMiksIGFycmF5KDIyLCAxMykpLCAvLyAyNQoJCQlhcnJheShhcnJheSgxMCwgIDIpLCBhcnJheSgxOSwgIDQpLCBhcnJheSgyOCwgIDYpLCBhcnJheSgzMywgIDQpKSwgLy8KCQkJYXJyYXkoYXJyYXkoIDgsICA0KSwgYXJyYXkoMjIsICAzKSwgYXJyYXkoIDgsIDI2KSwgYXJyYXkoMTIsIDI4KSksIC8vCgkJCWFycmF5KGFycmF5KCAzLCAxMCksIGFycmF5KCAzLCAyMyksIGFycmF5KCA0LCAzMSksIGFycmF5KDExLCAzMSkpLCAvLwoJCQlhcnJheShhcnJheSggNywgIDcpLCBhcnJheSgyMSwgIDcpLCBhcnJheSggMSwgMzcpLCBhcnJheSgxOSwgMjYpKSwgLy8KCQkJYXJyYXkoYXJyYXkoIDUsIDEwKSwgYXJyYXkoMTksIDEwKSwgYXJyYXkoMTUsIDI1KSwgYXJyYXkoMjMsIDI1KSksIC8vIDMwCgkJCWFycmF5KGFycmF5KDEzLCAgMyksIGFycmF5KCAyLCAyOSksIGFycmF5KDQyLCAgMSksIGFycmF5KDIzLCAyOCkpLCAvLwoJCQlhcnJheShhcnJheSgxNywgIDApLCBhcnJheSgxMCwgMjMpLCBhcnJheSgxMCwgMzUpLCBhcnJheSgxOSwgMzUpKSwgLy8KCQkJYXJyYXkoYXJyYXkoMTcsICAxKSwgYXJyYXkoMTQsIDIxKSwgYXJyYXkoMjksIDE5KSwgYXJyYXkoMTEsIDQ2KSksIC8vCgkJCWFycmF5KGFycmF5KDEzLCAgNiksIGFycmF5KDE0LCAyMyksIGFycmF5KDQ0LCAgNyksIGFycmF5KDU5LCAgMSkpLCAvLwoJCQlhcnJheShhcnJheSgxMiwgIDcpLCBhcnJheSgxMiwgMjYpLCBhcnJheSgzOSwgMTQpLCBhcnJheSgyMiwgNDEpKSwgLy8gMzUKCQkJYXJyYXkoYXJyYXkoIDYsIDE0KSwgYXJyYXkoIDYsIDM0KSwgYXJyYXkoNDYsIDEwKSwgYXJyYXkoIDIsIDY0KSksIC8vCgkJCWFycmF5KGFycmF5KDE3LCAgNCksIGFycmF5KDI5LCAxNCksIGFycmF5KDQ5LCAxMCksIGFycmF5KDI0LCA0NikpLCAvLwoJCQlhcnJheShhcnJheSggNCwgMTgpLCBhcnJheSgxMywgMzIpLCBhcnJheSg0OCwgMTQpLCBhcnJheSg0MiwgMzIpKSwgLy8KCQkJYXJyYXkoYXJyYXkoMjAsICA0KSwgYXJyYXkoNDAsICA3KSwgYXJyYXkoNDMsIDIyKSwgYXJyYXkoMTAsIDY3KSksIC8vCgkJCWFycmF5KGFycmF5KDE5LCAgNiksIGFycmF5KDE4LCAzMSksIGFycmF5KDM0LCAzNCksIGFycmF5KDIwLCA2MSkpICAvLyA0MAoJCSk7CgoJCS8qKgoJCSAqIEB2YXIgYXJyYXkgUG9zaXRpb25zIG9mIGFsaWdubWVudCBwYXR0ZXJucy4KCQkgKiBUaGlzIGFycmF5IGluY2x1ZGVzIG9ubHkgdGhlIHNlY29uZCBhbmQgdGhlIHRoaXJkIHBvc2l0aW9uIG9mIHRoZSBhbGlnbm1lbnQgcGF0dGVybnMuIFJlc3Qgb2YgdGhlbSBjYW4gYmUgY2FsY3VsYXRlZCBmcm9tIHRoZSBkaXN0YW5jZSBiZXR3ZWVuIHRoZW0uCgkJICogU2VlIFRhYmxlIDEgaW4gQXBwZW5kaXggRSAocHAuNzEpIG9mIEpJUyBYMDUxMDoyMDA0LgoJCSAqIEBhY2Nlc3MgcHJvdGVjdGVkCgkJICovCgkJcHJvdGVjdGVkICRhbGlnbm1lbnRQYXR0ZXJuID0gYXJyYXkoCgkJCWFycmF5KCAwLCAgMCksCgkJCWFycmF5KCAwLCAgMCksIGFycmF5KDE4LCAgMCksIGFycmF5KDIyLCAgMCksIGFycmF5KDI2LCAgMCksIGFycmF5KDMwLCAgMCksIC8vICAxLSA1CgkJCWFycmF5KDM0LCAgMCksIGFycmF5KDIyLCAzOCksIGFycmF5KDI0LCA0MiksIGFycmF5KDI2LCA0NiksIGFycmF5KDI4LCA1MCksIC8vICA2LTEwCgkJCWFycmF5KDMwLCA1NCksIGFycmF5KDMyLCA1OCksIGFycmF5KDM0LCA2MiksIGFycmF5KDI2LCA0NiksIGFycmF5KDI2LCA0OCksIC8vIDExLTE1CgkJCWFycmF5KDI2LCA1MCksIGFycmF5KDMwLCA1NCksIGFycmF5KDMwLCA1NiksIGFycmF5KDMwLCA1OCksIGFycmF5KDM0LCA2MiksIC8vIDE2LTIwCgkJCWFycmF5KDI4LCA1MCksIGFycmF5KDI2LCA1MCksIGFycmF5KDMwLCA1NCksIGFycmF5KDI4LCA1NCksIGFycmF5KDMyLCA1OCksIC8vIDIxLTI1CgkJCWFycmF5KDMwLCA1OCksIGFycmF5KDM0LCA2MiksIGFycmF5KDI2LCA1MCksIGFycmF5KDMwLCA1NCksIGFycmF5KDI2LCA1MiksIC8vIDI2LTMwCgkJCWFycmF5KDMwLCA1NiksIGFycmF5KDM0LCA2MCksIGFycmF5KDMwLCA1OCksIGFycmF5KDM0LCA2MiksIGFycmF5KDMwLCA1NCksIC8vIDMxLTM1CgkJCWFycmF5KDI0LCA1MCksIGFycmF5KDI4LCA1NCksIGFycmF5KDMyLCA1OCksIGFycmF5KDI2LCA1NCksIGFycmF5KDMwLCA1OCkgIC8vIDM1LTQwCgkJKTsKCgkJLyoqCgkJICogQHZhciBhcnJheSBWZXJzaW9uIGluZm9ybWF0aW9uIHBhdHRlcm4gKEJDSCBjb2RlZCkuCgkJICogU2VlIFRhYmxlIDEgaW4gQXBwZW5kaXggRCAocHAuNjgpIG9mIEpJUyBYMDUxMDoyMDA0LgoJCSAqIHNpemU6IFtRUlNQRUNfVkVSU0lPTl9NQVggLSA2XQoJCSAqIEBhY2Nlc3MgcHJvdGVjdGVkCgkJICovCgkJcHJvdGVjdGVkICR2ZXJzaW9uUGF0dGVybiA9IGFycmF5KAoJCQkweDA3Yzk0LCAweDA4NWJjLCAweDA5YTk5LCAweDBhNGQzLCAweDBiYmY2LCAweDBjNzYyLCAweDBkODQ3LCAweDBlNjBkLCAvLwoJCQkweDBmOTI4LCAweDEwYjc4LCAweDExNDVkLCAweDEyYTE3LCAweDEzNTMyLCAweDE0OWE2LCAweDE1NjgzLCAweDE2OGM5LCAvLwoJCQkweDE3N2VjLCAweDE4ZWM0LCAweDE5MWUxLCAweDFhZmFiLCAweDFiMDhlLCAweDFjYzFhLCAweDFkMzNmLCAweDFlZDc1LCAvLwoJCQkweDFmMjUwLCAweDIwOWQ1LCAweDIxNmYwLCAweDIyOGJhLCAweDIzNzlmLCAweDI0YjBiLCAweDI1NDJlLCAweDI2YTY0LCAvLwoJCQkweDI3NTQxLCAweDI4YzY5CgkJKTsKCgkJLyoqCgkJICogQHZhciBhcnJheSBGb3JtYXQgaW5mb3JtYXRpb24KCQkgKiBAYWNjZXNzIHByb3RlY3RlZAoJCSAqLwoJCXByb3RlY3RlZCAkZm9ybWF0SW5mbyA9IGFycmF5KAoJCQlhcnJheSgweDc3YzQsIDB4NzJmMywgMHg3ZGFhLCAweDc4OWQsIDB4NjYyZiwgMHg2MzE4LCAweDZjNDEsIDB4Njk3NiksIC8vCgkJCWFycmF5KDB4NTQxMiwgMHg1MTI1LCAweDVlN2MsIDB4NWI0YiwgMHg0NWY5LCAweDQwY2UsIDB4NGY5NywgMHg0YWEwKSwgLy8KCQkJYXJyYXkoMHgzNTVmLCAweDMwNjgsIDB4M2YzMSwgMHgzYTA2LCAweDI0YjQsIDB4MjE4MywgMHgyZWRhLCAweDJiZWQpLCAvLwoJCQlhcnJheSgweDE2ODksIDB4MTNiZSwgMHgxY2U3LCAweDE5ZDAsIDB4MDc2MiwgMHgwMjU1LCAweDBkMGMsIDB4MDgzYikgIC8vCgkJKTsKCgoJCS8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KCQkvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCgoKCQkvKioKCQkgKiBUaGlzIGlzIHRoZSBjbGFzcyBjb25zdHJ1Y3Rvci4KCQkgKiBDcmVhdGVzIGEgUVJjb2RlIG9iamVjdAoJCSAqIEBwYXJhbSBzdHJpbmcgJGNvZGUgY29kZSB0byByZXByZXNlbnQgdXNpbmcgUVJjb2RlCgkJICogQHBhcmFtIHN0cmluZyAkZWNsZXZlbCBlcnJvciBsZXZlbDogPHVsPjxsaT5MIDogQWJvdXQgNyUgb3IgbGVzcyBlcnJvcnMgY2FuIGJlIGNvcnJlY3RlZC48L2xpPjxsaT5NIDogQWJvdXQgMTUlIG9yIGxlc3MgZXJyb3JzIGNhbiBiZSBjb3JyZWN0ZWQuPC9saT48bGk+USA6IEFib3V0IDI1JSBvciBsZXNzIGVycm9ycyBjYW4gYmUgY29ycmVjdGVkLjwvbGk+PGxpPkggOiBBYm91dCAzMCUgb3IgbGVzcyBlcnJvcnMgY2FuIGJlIGNvcnJlY3RlZC48L2xpPjwvdWw+CgkJICogQGFjY2VzcyBwdWJsaWMKCQkgKiBAc2luY2UgMS4wLjAwMAoJCSAqLwoJCXB1YmxpYyBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkY29kZSwgJGVjbGV2ZWwgPSAnTCcpIHsKCQkJJGJhcmNvZGVfYXJyYXkgPSBhcnJheSgpOwoJCQlpZiAoKGlzX251bGwoJGNvZGUpKSBPUiAoJGNvZGUgPT0gJ1wwJykgT1IgKCRjb2RlID09ICcnKSkgewoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgkJCS8vIHNldCBlcnJvciBjb3JyZWN0aW9uIGxldmVsCgkJCSR0aGlzLT5sZXZlbCA9IGFycmF5X3NlYXJjaCgkZWNsZXZlbCwgYXJyYXkoJ0wnLCAnTScsICdRJywgJ0gnKSk7CgkJCWlmICgkdGhpcy0+bGV2ZWwgPT09IGZhbHNlKSB7CgkJCQkkdGhpcy0+bGV2ZWwgPSBRUl9FQ0xFVkVMX0w7CgkJCX0KCQkJaWYgKCgkdGhpcy0+aGludCAhPSBRUl9NT0RFXzhCKSBBTkQgKCR0aGlzLT5oaW50ICE9IFFSX01PREVfS0opKSB7CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0KCQkJaWYgKCgkdGhpcy0+dmVyc2lvbiA8IDApIE9SICgkdGhpcy0+dmVyc2lvbiA+IFFSU1BFQ19WRVJTSU9OX01BWCkpIHsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoJCQkkdGhpcy0+aXRlbXMgPSBhcnJheSgpOwoJCQkkdGhpcy0+ZW5jb2RlU3RyaW5nKCRjb2RlKTsKCQkJJHFyVGFiID0gJHRoaXMtPmJpbmFyaXplKCR0aGlzLT5kYXRhKTsKCQkJJHNpemUgPSBjb3VudCgkcXJUYWIpOwoJCQkkYmFyY29kZV9hcnJheVsnbnVtX3Jvd3MnXSA9ICRzaXplOwoJCQkkYmFyY29kZV9hcnJheVsnbnVtX2NvbHMnXSA9ICRzaXplOwoJCQkkYmFyY29kZV9hcnJheVsnYmNvZGUnXSA9IGFycmF5KCk7CgkJCWZvcmVhY2ggKCRxclRhYiBhcyAkbGluZSkgewoJCQkJJGFyckFkZCA9IGFycmF5KCk7CgkJCQlmb3JlYWNoIChzdHJfc3BsaXQoJGxpbmUpIGFzICRjaGFyKSB7CgkJCQkJJGFyckFkZFtdID0gKCRjaGFyPT0nMScpPzE6MDsKCQkJCX0KCQkJCSRiYXJjb2RlX2FycmF5WydiY29kZSddW10gPSAkYXJyQWRkOwoJCQl9CgkJCSR0aGlzLT5iYXJjb2RlX2FycmF5ID0gJGJhcmNvZGVfYXJyYXk7CgkJfQoKCQkvKioKCQkgKiBSZXR1cm5zIGEgYmFyY29kZSBhcnJheSB3aGljaCBpcyByZWFkYWJsZSBieSBUQ1BERgoJCSAqIEByZXR1cm4gYXJyYXkgYmFyY29kZSBhcnJheSByZWFkYWJsZSBieSBUQ1BERjsKCQkgKiBAYWNjZXNzIHB1YmxpYwoJCSAqLwoJCXB1YmxpYyBmdW5jdGlvbiBnZXRCYXJjb2RlQXJyYXkoKSB7CgkJCXJldHVybiAkdGhpcy0+YmFyY29kZV9hcnJheTsKCQl9CgoJCS8qKgoJCSAqIENvbnZlcnQgdGhlIGZyYW1lIGluIGJpbmFyeSBmb3JtCgkJICogQHBhcmFtIGFycmF5ICRmcmFtZSBhcnJheSB0byBiaW5hcml6ZQoJCSAqIEByZXR1cm4gYXJyYXkgZnJhbWUgaW4gYmluYXJ5IGZvcm0KCQkgKi8KCQlwcm90ZWN0ZWQgZnVuY3Rpb24gYmluYXJpemUoJGZyYW1lKSB7CgkJCSRsZW4gPSBjb3VudCgkZnJhbWUpOwoJCQkvLyB0aGUgZnJhbWUgaXMgc3F1YXJlICh3aWR0aCA9IGhlaWdodCkKCQkJZm9yZWFjaCAoJGZyYW1lIGFzICYkZnJhbWVMaW5lKSB7CgkJCQlmb3IgKCRpPTA7ICRpPCRsZW47ICRpKyspIHsKCQkJCQkkZnJhbWVMaW5lWyRpXSA9IChvcmQoJGZyYW1lTGluZVskaV0pJjEpPycxJzonMCc7CgkJCQl9CgkJCX0KCQkJcmV0dXJuICRmcmFtZTsKCQl9CgoJCS8qKgoJCSAqIEVuY29kZSB0aGUgaW5wdXQgc3RyaW5nIHRvIFFSIGNvZGUKCQkgKiBAcGFyYW0gc3RyaW5nICRzdHJpbmcgaW5wdXQgc3RyaW5nIHRvIGVuY29kZQoJCSAqLwoJCXByb3RlY3RlZCBmdW5jdGlvbiBlbmNvZGVTdHJpbmcoJHN0cmluZykgewoJCQkkdGhpcy0+ZGF0YVN0ciA9ICRzdHJpbmc7CgkJCWlmICghJHRoaXMtPmNhc2VzZW5zaXRpdmUpIHsKCQkJCSR0aGlzLT50b1VwcGVyKCk7CgkJCX0KCQkJJHJldCA9ICR0aGlzLT5zcGxpdFN0cmluZygpOwoJCQlpZiAoJHJldCA8IDApIHsKCQkJCXJldHVybiBOVUxMOwoJCQl9CgkJCSR0aGlzLT5lbmNvZGVNYXNrKC0xKTsKCQl9CgoJCS8qKgoJCSAqIEVuY29kZSBtYXNrCgkJICogQHBhcmFtIGludCAkbWFzayBtYXNraW5nIG1vZGUKCQkgKi8KCQlwcm90ZWN0ZWQgZnVuY3Rpb24gZW5jb2RlTWFzaygkbWFzaykgewoJCQkkc3BlYyA9IGFycmF5KDAsIDAsIDAsIDAsIDApOwoJCQkkdGhpcy0+ZGF0YWNvZGUgPSAkdGhpcy0+Z2V0Qnl0ZVN0cmVhbSgkdGhpcy0+aXRlbXMpOwoJCQlpZiAoaXNfbnVsbCgkdGhpcy0+ZGF0YWNvZGUpKSB7CgkJCQlyZXR1cm4gTlVMTDsKCQkJfQoJCQkkc3BlYyA9ICR0aGlzLT5nZXRFY2NTcGVjKCR0aGlzLT52ZXJzaW9uLCAkdGhpcy0+bGV2ZWwsICRzcGVjKTsKCQkJJHRoaXMtPmIxID0gJHRoaXMtPnJzQmxvY2tOdW0xKCRzcGVjKTsKCQkJJHRoaXMtPmRhdGFMZW5ndGggPSAkdGhpcy0+cnNEYXRhTGVuZ3RoKCRzcGVjKTsKCQkJJHRoaXMtPmVjY0xlbmd0aCA9ICR0aGlzLT5yc0VjY0xlbmd0aCgkc3BlYyk7CgkJCSR0aGlzLT5lY2Njb2RlID0gYXJyYXlfZmlsbCgwLCAkdGhpcy0+ZWNjTGVuZ3RoLCAwKTsKCQkJJHRoaXMtPmJsb2NrcyA9ICR0aGlzLT5yc0Jsb2NrTnVtKCRzcGVjKTsKCQkJJHJldCA9ICR0aGlzLT5pbml0KCRzcGVjKTsKCQkJaWYgKCRyZXQgPCAwKSB7CgkJCQlyZXR1cm4gTlVMTDsKCQkJfQoJCQkkdGhpcy0+Y291bnQgPSAwOwoJCQkkdGhpcy0+d2lkdGggPSAkdGhpcy0+Z2V0V2lkdGgoJHRoaXMtPnZlcnNpb24pOwoJCQkkdGhpcy0+ZnJhbWUgPSAkdGhpcy0+bmV3RnJhbWUoJHRoaXMtPnZlcnNpb24pOwoJCQkkdGhpcy0+eCA9ICR0aGlzLT53aWR0aCAtIDE7CgkJCSR0aGlzLT55ID0gJHRoaXMtPndpZHRoIC0gMTsKCQkJJHRoaXMtPmRpciA9IC0xOwoJCQkkdGhpcy0+Yml0ID0gLTE7CgkJCS8vIGludGVsZWF2ZWQgZGF0YSBhbmQgZWNjIGNvZGVzCgkJCWZvciAoJGk9MDsgJGkgPCAoJHRoaXMtPmRhdGFMZW5ndGggKyAkdGhpcy0+ZWNjTGVuZ3RoKTsgJGkrKykgewoJCQkJJGNvZGUgPSAkdGhpcy0+Z2V0Q29kZSgpOwoJCQkJJGJpdCA9IDB4ODA7CgkJCQlmb3IgKCRqPTA7ICRqPDg7ICRqKyspIHsKCQkJCQkkYWRkciA9ICR0aGlzLT5nZXROZXh0UG9zaXRpb24oKTsKCQkJCQkkdGhpcy0+c2V0RnJhbWVBdCgkYWRkciwgMHgwMiB8ICgoJGJpdCAmICRjb2RlKSAhPSAwKSk7CgkJCQkJJGJpdCA9ICRiaXQgPj4gMTsKCQkJCX0KCQkJfQoJCQkvLyByZW1haW5kZXIgYml0cwoJCQkkaiA9ICR0aGlzLT5nZXRSZW1haW5kZXIoJHRoaXMtPnZlcnNpb24pOwoJCQlmb3IgKCRpPTA7ICRpPCRqOyAkaSsrKSB7CgkJCQkkYWRkciA9ICR0aGlzLT5nZXROZXh0UG9zaXRpb24oKTsKCQkJCSR0aGlzLT5zZXRGcmFtZUF0KCRhZGRyLCAweDAyKTsKCQkJfQoJCQkvLyBtYXNraW5nCgkJCSR0aGlzLT5ydW5MZW5ndGggPSBhcnJheV9maWxsKDAsIFFSU1BFQ19XSURUSF9NQVggKyAxLCAwKTsKCQkJaWYgKCRtYXNrIDwgMCkgewoJCQkJaWYgKFFSX0ZJTkRfQkVTVF9NQVNLKSB7CgkJCQkJJG1hc2tlZCA9ICR0aGlzLT5tYXNrKCR0aGlzLT53aWR0aCwgJHRoaXMtPmZyYW1lLCAkdGhpcy0+bGV2ZWwpOwoJCQkJfSBlbHNlIHsKCQkJCQkkbWFza2VkID0gJHRoaXMtPm1ha2VNYXNrKCR0aGlzLT53aWR0aCwgJHRoaXMtPmZyYW1lLCAoaW50dmFsKFFSX0RFRkFVTFRfTUFTSykgJSA4KSwgJHRoaXMtPmxldmVsKTsKCQkJCX0KCQkJfSBlbHNlIHsKCQkJCSRtYXNrZWQgPSAkdGhpcy0+bWFrZU1hc2soJHRoaXMtPndpZHRoLCAkdGhpcy0+ZnJhbWUsICRtYXNrLCAkdGhpcy0+bGV2ZWwpOwoJCQl9CgkJCWlmICgkbWFza2VkID09IE5VTEwpIHsKCQkJCXJldHVybiBOVUxMOwoJCQl9CgkJCSR0aGlzLT5kYXRhID0gJG1hc2tlZDsKCQl9CgoJCS8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0KCgkJLy8gRnJhbWVGaWxsZXIKCgkJLyoqCgkJICogU2V0IGZyYW1lIHZhbHVlIGF0IHNwZWNpZmllZCBwb3NpdGlvbgoJCSAqIEBwYXJhbSBhcnJheSAkYXQgeCx5IHBvc2l0aW9uCgkJICogQHBhcmFtIGludCAkdmFsIHZhbHVlIG9mIHRoZSBjaGFyYWN0ZXIgdG8gc2V0CgkJICovCgkJcHJvdGVjdGVkIGZ1bmN0aW9uIHNldEZyYW1lQXQoJGF0LCAkdmFsKSB7CgkJCSR0aGlzLT5mcmFtZVskYXRbJ3knXV1bJGF0Wyd4J11dID0gY2hyKCR2YWwpOwoJCX0KCgkJLyoqCgkJICogR2V0IGZyYW1lIHZhbHVlIGF0IHNwZWNpZmllZCBwb3NpdGlvbgoJCSAqIEBwYXJhbSBhcnJheSAkYXQgeCx5IHBvc2l0aW9uCgkJICogQHJldHVybiB2YWx1ZSBhdCBzcGVjaWZpZWQgcG9zaXRpb24KCQkgKi8KCQlwcm90ZWN0ZWQgZnVuY3Rpb24gZ2V0RnJhbWVBdCgkYXQpIHsKCQkJcmV0dXJuIG9yZCgkdGhpcy0+ZnJhbWVbJGF0Wyd5J11dWyRhdFsneCddXSk7CgkJfQoKCQkvKioKCQkgKiBSZXR1cm4gdGhlIG5leHQgZnJhbWUgcG9zaXRpb24KCQkgKiBAcmV0dXJuIGFycmF5IG9mIHgseSBjb29yZGluYXRlcwoJCSAqLwoJCXByb3RlY3RlZCBmdW5jdGlvbiBnZXROZXh0UG9zaXRpb24oKSB7CgkJCWRvIHsKCQkJCWlmICgkdGhpcy0+Yml0ID09IC0xKSB7CgkJCQkJJHRoaXMtPmJpdCA9IDA7CgkJCQkJcmV0dXJuIGFycmF5KCd4Jz0+JHRoaXMtPngsICd5Jz0+JHRoaXMtPnkpOwoJCQkJfQoJCQkJJHggPSAkdGhpcy0+eDsKCQkJCSR5ID0gJHRoaXMtPnk7CgkJCQkkdyA9ICR0aGlzLT53aWR0aDsKCQkJCWlmICgkdGhpcy0+Yml0ID09IDApIHsKCQkJCQkkeC0tOwoJCQkJCSR0aGlzLT5iaXQrKzsKCQkJCX0gZWxzZSB7CgkJCQkJJHgrKzsKCQkJCQkkeSArPSAkdGhpcy0+ZGlyOwoJCQkJCSR0aGlzLT5iaXQtLTsKCQkJCX0KCQkJCWlmICgkdGhpcy0+ZGlyIDwgMCkgewoJCQkJCWlmICgkeSA8IDApIHsKCQkJCQkJJHkgPSAwOwoJCQkJCQkkeCAtPSAyOwoJCQkJCQkkdGhpcy0+ZGlyID0gMTsKCQkJCQkJaWYgKCR4ID09IDYpIHsKCQkJCQkJCSR4LS07CgkJCQkJCQkkeSA9IDk7CgkJCQkJCX0KCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCWlmICgkeSA9PSAkdykgewoJCQkJCQkkeSA9ICR3IC0gMTsKCQkJCQkJJHggLT0gMjsKCQkJCQkJJHRoaXMtPmRpciA9IC0xOwoJCQkJCQlpZiAoJHggPT0gNikgewoJCQkJCQkJJHgtLTsKCQkJCQkJCSR5IC09IDg7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCQlpZiAoKCR4IDwgMCkgT1IgKCR5IDwgMCkpIHsKCQkJCQlyZXR1cm4gTlVMTDsKCQkJCX0KCQkJCSR0aGlzLT54ID0gJHg7CgkJCQkkdGhpcy0+eSA9ICR5OwoJCQl9IHdoaWxlKG9yZCgkdGhpcy0+ZnJhbWVbJHldWyR4XSkgJiAweDgwKTsKCQkJcmV0dXJuIGFycmF5KCd4Jz0+JHgsICd5Jz0+JHkpOwoJCX0KCgkJLy8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLQoKCQkvLyBRUnJhd2NvZGUKCgkJLyoqCgkJICogSW5pdGlhbGl6ZSBjb2RlLgoJCSAqIEBwYXJhbSBhcnJheSAkc3BlYyBhcnJheSBvZiBFQ0Mgc3BlY2lmaWNhdGlvbgoJCSAqIEByZXR1cm4gMCBpbiBjYXNlIG9mIHN1Y2Nlc3MsIC0xIGluIGNhc2Ugb2YgZXJyb3IKCQkgKi8KCQlwcm90ZWN0ZWQgZnVuY3Rpb24gaW5pdCgkc3BlYykgewoJCQkkZGwgPSAkdGhpcy0+cnNEYXRhQ29kZXMxKCRzcGVjKTsKCQkJJGVsID0gJHRoaXMtPnJzRWNjQ29kZXMxKCRzcGVjKTsKCQkJJHJzID0gJHRoaXMtPmluaXRfcnMoOCwgMHgxMWQsIDAsIDEsICRlbCwgMjU1IC0gJGRsIC0gJGVsKTsKCQkJJGJsb2NrTm8gPSAwOwoJCQkkZGF0YVBvcyA9IDA7CgkJCSRlY2NQb3MgPSAwOwoJCQkkZW5kZm9yID0gJHRoaXMtPnJzQmxvY2tOdW0xKCRzcGVjKTsKCQkJZm9yICgkaT0wOyAkaSA8ICRlbmRmb3I7ICsrJGkpIHsKCQkJCSRlY2MgPSBhcnJheV9zbGljZSgkdGhpcy0+ZWNjY29kZSwgJGVjY1Bvcyk7CgkJCQkkdGhpcy0+cnNibG9ja3NbJGJsb2NrTm9dID0gYXJyYXkoKTsKCQkJCSR0aGlzLT5yc2Jsb2Nrc1skYmxvY2tOb11bJ2RhdGFMZW5ndGgnXSA9ICRkbDsKCQkJCSR0aGlzLT5yc2Jsb2Nrc1skYmxvY2tOb11bJ2RhdGEnXSA9IGFycmF5X3NsaWNlKCR0aGlzLT5kYXRhY29kZSwgJGRhdGFQb3MpOwoJCQkJJHRoaXMtPnJzYmxvY2tzWyRibG9ja05vXVsnZWNjTGVuZ3RoJ10gPSAkZWw7CgkJCQkkZWNjID0gJHRoaXMtPmVuY29kZV9yc19jaGFyKCRycywgJHRoaXMtPnJzYmxvY2tzWyRibG9ja05vXVsnZGF0YSddLCAkZWNjKTsKCQkJCSR0aGlzLT5yc2Jsb2Nrc1skYmxvY2tOb11bJ2VjYyddID0gJGVjYzsKCQkJCSR0aGlzLT5lY2Njb2RlID0gYXJyYXlfbWVyZ2UoYXJyYXlfc2xpY2UoJHRoaXMtPmVjY2NvZGUsMCwgJGVjY1BvcyksICRlY2MpOwoJCQkJJGRhdGFQb3MgKz0gJGRsOwoJCQkJJGVjY1BvcyArPSAkZWw7CgkJCQkkYmxvY2tObysrOwoJCQl9CgkJCWlmICgkdGhpcy0+cnNCbG9ja051bTIoJHNwZWMpID09IDApIHsKCQkJCXJldHVybiAwOwoJCQl9CgkJCSRkbCA9ICR0aGlzLT5yc0RhdGFDb2RlczIoJHNwZWMpOwoJCQkkZWwgPSAkdGhpcy0+cnNFY2NDb2RlczIoJHNwZWMpOwoJCQkkcnMgPSAkdGhpcy0+aW5pdF9ycyg4LCAweDExZCwgMCwgMSwgJGVsLCAyNTUgLSAkZGwgLSAkZWwpOwoJCQlpZiAoJHJzID09IE5VTEwpIHsKCQkJCXJldHVybiAtMTsKCQkJfQoJCQkkZW5kZm9yID0gJHRoaXMtPnJzQmxvY2tOdW0yKCRzcGVjKTsKCQkJZm9yICgkaT0wOyAkaSA8ICRlbmRmb3I7ICsrJGkpIHsKCQkJCSRlY2MgPSBhcnJheV9zbGljZSgkdGhpcy0+ZWNjY29kZSwgJGVjY1Bvcyk7CgkJCQkkdGhpcy0+cnNibG9ja3NbJGJsb2NrTm9dID0gYXJyYXkoKTsKCQkJCSR0aGlzLT5yc2Jsb2Nrc1skYmxvY2tOb11bJ2RhdGFMZW5ndGgnXSA9ICRkbDsKCQkJCSR0aGlzLT5yc2Jsb2Nrc1skYmxvY2tOb11bJ2RhdGEnXSA9IGFycmF5X3NsaWNlKCR0aGlzLT5kYXRhY29kZSwgJGRhdGFQb3MpOwoJCQkJJHRoaXMtPnJzYmxvY2tzWyRibG9ja05vXVsnZWNjTGVuZ3RoJ10gPSAkZWw7CgkJCQkkZWNjID0gJHRoaXMtPmVuY29kZV9yc19jaGFyKCRycywgJHRoaXMtPnJzYmxvY2tzWyRibG9ja05vXVsnZGF0YSddLCAkZWNjKTsKCQkJCSR0aGlzLT5yc2Jsb2Nrc1skYmxvY2tOb11bJ2VjYyddID0gJGVjYzsKCQkJCSR0aGlzLT5lY2Njb2RlID0gYXJyYXlfbWVyZ2UoYXJyYXlfc2xpY2UoJHRoaXMtPmVjY2NvZGUsIDAsICRlY2NQb3MpLCAkZWNjKTsKCQkJCSRkYXRhUG9zICs9ICRkbDsKCQkJCSRlY2NQb3MgKz0gJGVsOwoJCQkJJGJsb2NrTm8rKzsKCQkJfQoJCQlyZXR1cm4gMDsKCQl9CgoJCS8qKgoJCSAqIFJldHVybiBSZWVkLVNvbG9tb24gYmxvY2sgY29kZS4KCQkgKiBAcmV0dXJuIGFycmF5IHJzYmxvY2tzCgkJICovCgkJcHJvdGVjdGVkIGZ1bmN0aW9uIGdldENvZGUoKSB7CgkJCWlmICgkdGhpcy0+Y291bnQgPCAkdGhpcy0+ZGF0YUxlbmd0aCkgewoJCQkJJHJvdyA9ICR0aGlzLT5jb3VudCAlICR0aGlzLT5ibG9ja3M7CgkJCQkkY29sID0gJHRoaXMtPmNvdW50IC8gJHRoaXMtPmJsb2NrczsKCQkJCWlmICgkY29sID49ICR0aGlzLT5yc2Jsb2Nrc1swXVsnZGF0YUxlbmd0aCddKSB7CgkJCQkJJHJvdyArPSAkdGhpcy0+YjE7CgkJCQl9CgkJCQkkcmV0ID0gJHRoaXMtPnJzYmxvY2tzWyRyb3ddWydkYXRhJ11bJGNvbF07CgkJCX0gZWxzZWlmICgkdGhpcy0+Y291bnQgPCAkdGhpcy0+ZGF0YUxlbmd0aCArICR0aGlzLT5lY2NMZW5ndGgpIHsKCQkJCSRyb3cgPSAoJHRoaXMtPmNvdW50IC0gJHRoaXMtPmRhdGFMZW5ndGgpICUgJHRoaXMtPmJsb2NrczsKCQkJCSRjb2wgPSAoJHRoaXMtPmNvdW50IC0gJHRoaXMtPmRhdGFMZW5ndGgpIC8gJHRoaXMtPmJsb2NrczsKCQkJCSRyZXQgPSAkdGhpcy0+cnNibG9ja3NbJHJvd11bJ2VjYyddWyRjb2xdOwoJCQl9IGVsc2UgewoJCQkJcmV0dXJuIDA7CgkJCX0KCQkJJHRoaXMtPmNvdW50Kys7CgkJCXJldHVybiAkcmV0OwoJCX0KCgkJLy8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLQoKCQkvLyBRUm1hc2sKCgkJLyoqCgkJICogV3JpdGUgRm9ybWF0IEluZm9ybWF0aW9uIG9uIGZyYW1lIGFuZCByZXR1cm5zIHRoZSBudW1iZXIgb2YgYmxhY2sgYml0cwoJCSAqIEBwYXJhbSBpbnQgJHdpZHRoIGZyYW1lIHdpZHRoCgkJICogQHBhcmFtIGFycmF5ICRmcmFtZSBmcmFtZQoJCSAqIEBwYXJhbSBhcnJheSAkbWFzayBtYXNraW5nIG1vZGUKCQkgKiBAcGFyYW0gaW50ICRsZXZlbCBlcnJvciBjb3JyZWN0aW9uIGxldmVsCgkJICogQHJldHVybiBpbnQgYmxhY2tzCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiB3cml0ZUZvcm1hdEluZm9ybWF0aW9uKCR3aWR0aCwgJiRmcmFtZSwgJG1hc2ssICRsZXZlbCkgewoJCQkkYmxhY2tzID0gMDsKCQkJJGZvcm1hdCA9ICAkdGhpcy0+Z2V0Rm9ybWF0SW5mbygkbWFzaywgJGxldmVsKTsKCQkJZm9yICgkaT0wOyAkaTw4OyArKyRpKSB7CgkJCQlpZiAoJGZvcm1hdCAmIDEpIHsKCQkJCQkkYmxhY2tzICs9IDI7CgkJCQkJJHYgPSAweDg1OwoJCQkJfSBlbHNlIHsKCQkJCQkkdiA9IDB4ODQ7CgkJCQl9CgkJCQkkZnJhbWVbOF1bJHdpZHRoIC0gMSAtICRpXSA9IGNocigkdik7CgkJCQlpZiAoJGkgPCA2KSB7CgkJCQkJJGZyYW1lWyRpXVs4XSA9IGNocigkdik7CgkJCQl9IGVsc2UgewoJCQkJCSRmcmFtZVskaSArIDFdWzhdID0gY2hyKCR2KTsKCQkJCX0KCQkJCSRmb3JtYXQgPSAkZm9ybWF0ID4+IDE7CgkJCX0KCQkJZm9yICgkaT0wOyAkaTw3OyArKyRpKSB7CgkJCWlmICgkZm9ybWF0ICYgMSkgewoJCQkJJGJsYWNrcyArPSAyOwoJCQkJJHYgPSAweDg1OwoJCQl9IGVsc2UgewoJCQkJJHYgPSAweDg0OwoJCQl9CgkJCSRmcmFtZVskd2lkdGggLSA3ICsgJGldWzhdID0gY2hyKCR2KTsKCQkJaWYgKCRpID09IDApIHsKCQkJCSRmcmFtZVs4XVs3XSA9IGNocigkdik7CgkJCX0gZWxzZSB7CgkJCQkkZnJhbWVbOF1bNiAtICRpXSA9IGNocigkdik7CgkJCX0KCQkJJGZvcm1hdCA9ICRmb3JtYXQgPj4gMTsKCQkJfQoJCQlyZXR1cm4gJGJsYWNrczsKCQl9CgoJCS8qKgoJCSAqIG1hc2swCgkJICogQHBhcmFtIGludCAkeCBYIHBvc2l0aW9uCgkJICogQHBhcmFtIGludCAkeSBZIHBvc2l0aW9uCgkJICogQHJldHVybiBpbnQgbWFzawoJCSAqLwoJCSBwcm90ZWN0ZWQgZnVuY3Rpb24gbWFzazAoJHgsICR5KSB7CgkJCXJldHVybiAoJHggKyAkeSkgJiAxOwoJCX0KCgkJLyoqCgkJICogbWFzazEKCQkgKiBAcGFyYW0gaW50ICR4IFggcG9zaXRpb24KCQkgKiBAcGFyYW0gaW50ICR5IFkgcG9zaXRpb24KCQkgKiBAcmV0dXJuIGludCBtYXNrCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiBtYXNrMSgkeCwgJHkpIHsKCQkJcmV0dXJuICgkeSAmIDEpOwoJCX0KCgkJLyoqCgkJICogbWFzazIKCQkgKiBAcGFyYW0gaW50ICR4IFggcG9zaXRpb24KCQkgKiBAcGFyYW0gaW50ICR5IFkgcG9zaXRpb24KCQkgKiBAcmV0dXJuIGludCBtYXNrCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiBtYXNrMigkeCwgJHkpIHsKCQkJcmV0dXJuICgkeCAlIDMpOwoJCX0KCgkJLyoqCgkJICogbWFzazMKCQkgKiBAcGFyYW0gaW50ICR4IFggcG9zaXRpb24KCQkgKiBAcGFyYW0gaW50ICR5IFkgcG9zaXRpb24KCQkgKiBAcmV0dXJuIGludCBtYXNrCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiBtYXNrMygkeCwgJHkpIHsKCQkJcmV0dXJuICgkeCArICR5KSAlIDM7CgkJfQoKCQkvKioKCQkgKiBtYXNrNAoJCSAqIEBwYXJhbSBpbnQgJHggWCBwb3NpdGlvbgoJCSAqIEBwYXJhbSBpbnQgJHkgWSBwb3NpdGlvbgoJCSAqIEByZXR1cm4gaW50IG1hc2sKCQkgKi8KCQkgcHJvdGVjdGVkIGZ1bmN0aW9uIG1hc2s0KCR4LCAkeSkgewoJCQlyZXR1cm4gKCgoaW50KSgkeSAvIDIpKSArICgoaW50KSgkeCAvIDMpKSkgJiAxOwoJCX0KCgkJLyoqCgkJICogbWFzazUKCQkgKiBAcGFyYW0gaW50ICR4IFggcG9zaXRpb24KCQkgKiBAcGFyYW0gaW50ICR5IFkgcG9zaXRpb24KCQkgKiBAcmV0dXJuIGludCBtYXNrCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiBtYXNrNSgkeCwgJHkpIHsKCQkJcmV0dXJuICgoJHggKiAkeSkgJiAxKSArICgkeCAqICR5KSAlIDM7CgkJfQoKCQkvKioKCQkgKiBtYXNrNgoJCSAqIEBwYXJhbSBpbnQgJHggWCBwb3NpdGlvbgoJCSAqIEBwYXJhbSBpbnQgJHkgWSBwb3NpdGlvbgoJCSAqIEByZXR1cm4gaW50IG1hc2sKCQkgKi8KCQkgcHJvdGVjdGVkIGZ1bmN0aW9uIG1hc2s2KCR4LCAkeSkgewoJCQlyZXR1cm4gKCgoJHggKiAkeSkgJiAxKSArICgkeCAqICR5KSAlIDMpICYgMTsKCQl9CgoJCS8qKgoJCSAqIG1hc2s3CgkJICogQHBhcmFtIGludCAkeCBYIHBvc2l0aW9uCgkJICogQHBhcmFtIGludCAkeSBZIHBvc2l0aW9uCgkJICogQHJldHVybiBpbnQgbWFzawoJCSAqLwoJCSBwcm90ZWN0ZWQgZnVuY3Rpb24gbWFzazcoJHgsICR5KSB7CgkJCXJldHVybiAoKCgkeCAqICR5KSAlIDMpICsgKCgkeCArICR5KSAmIDEpKSAmIDE7CgkJfQoKCQkvKioKCQkgKiBSZXR1cm4gYml0bWFzawoJCSAqIEBwYXJhbSBpbnQgJG1hc2tObyBtYXNrIG51bWJlcgoJCSAqIEBwYXJhbSBpbnQgJHdpZHRoIHdpZHRoCgkJICogQHBhcmFtIGFycmF5ICRmcmFtZSBmcmFtZQoJCSAqIEByZXR1cm4gYXJyYXkgYml0bWFzawoJCSAqLwoJCXByb3RlY3RlZCBmdW5jdGlvbiBnZW5lcmF0ZU1hc2tObygkbWFza05vLCAkd2lkdGgsICRmcmFtZSkgewoJCQkkYml0TWFzayA9IGFycmF5X2ZpbGwoMCwgJHdpZHRoLCBhcnJheV9maWxsKDAsICR3aWR0aCwgMCkpOwoJCQlmb3IgKCR5PTA7ICR5PCR3aWR0aDsgKyskeSkgewoJCQkJZm9yICgkeD0wOyAkeDwkd2lkdGg7ICsrJHgpIHsKCQkJCQlpZiAob3JkKCRmcmFtZVskeV1bJHhdKSAmIDB4ODApIHsKCQkJCQkJJGJpdE1hc2tbJHldWyR4XSA9IDA7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJG1hc2tGdW5jID0gY2FsbF91c2VyX2Z1bmMoYXJyYXkoJHRoaXMsICdtYXNrJy4kbWFza05vKSwgJHgsICR5KTsKCQkJCQkJJGJpdE1hc2tbJHldWyR4XSA9ICgkbWFza0Z1bmMgPT0gMCk\/MTowOwoJCQkJCX0KCQkJCX0KCQkJfQoJCQlyZXR1cm4gJGJpdE1hc2s7CgkJfQoKCQkvKioKCQkgKiBtYWtlTWFza05vCgkJICogQHBhcmFtIGludCAkbWFza05vCgkJICogQHBhcmFtIGludCAkd2lkdGgKCQkgKiBAcGFyYW0gaW50ICRzCgkJICogQHBhcmFtIGludCAkZAoJCSAqIEBwYXJhbSBib29sZWFuICRtYXNrR2VuT25seQoJCSAqIEByZXR1cm4gaW50IGIKCQkgKi8KCQkgcHJvdGVjdGVkIGZ1bmN0aW9uIG1ha2VNYXNrTm8oJG1hc2tObywgJHdpZHRoLCAkcywgJiRkLCAkbWFza0dlbk9ubHk9ZmFsc2UpIHsKCQkJJGIgPSAwOwoJCQkkYml0TWFzayA9IGFycmF5KCk7CgkJCSRiaXRNYXNrID0gJHRoaXMtPmdlbmVyYXRlTWFza05vKCRtYXNrTm8sICR3aWR0aCwgJHMsICRkKTsKCQkJaWYgKCRtYXNrR2VuT25seSkgewoJCQkJcmV0dXJuOwoJCQl9CgkJCSRkID0gJHM7CgkJCWZvciAoJHk9MDsgJHk8JHdpZHRoOyArKyR5KSB7CgkJCQlmb3IgKCR4PTA7ICR4PCR3aWR0aDsgKyskeCkgewoJCQkJCWlmICgkYml0TWFza1skeV1bJHhdID09IDEpIHsKCQkJCQkJJGRbJHldWyR4XSA9IGNocihvcmQoJHNbJHldWyR4XSkgXiAoaW50KSRiaXRNYXNrWyR5XVskeF0pOwoJCQkJCX0KCQkJCQkkYiArPSAoaW50KShvcmQoJGRbJHldWyR4XSkgJiAxKTsKCQkJCX0KCQkJfQoJCQlyZXR1cm4gJGI7CgkJfQoKCQkvKioKCQkgKiBtYWtlTWFzawoJCSAqIEBwYXJhbSBpbnQgJHdpZHRoCgkJICogQHBhcmFtIGFycmF5ICRmcmFtZQoJCSAqIEBwYXJhbSBpbnQgJG1hc2tObwoJCSAqIEBwYXJhbSBpbnQgJGxldmVsCgkJICogQHJldHVybiBhcnJheSBtYXNrCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiBtYWtlTWFzaygkd2lkdGgsICRmcmFtZSwgJG1hc2tObywgJGxldmVsKSB7CgkJCSRtYXNrZWQgPSBhcnJheV9maWxsKDAsICR3aWR0aCwgc3RyX3JlcGVhdCgiXDAiLCAkd2lkdGgpKTsKCQkJJHRoaXMtPm1ha2VNYXNrTm8oJG1hc2tObywgJHdpZHRoLCAkZnJhbWUsICRtYXNrZWQpOwoJCQkkdGhpcy0+d3JpdGVGb3JtYXRJbmZvcm1hdGlvbigkd2lkdGgsICRtYXNrZWQsICRtYXNrTm8sICRsZXZlbCk7CgkJCXJldHVybiAkbWFza2VkOwoJCX0KCgkJLyoqCgkJICogY2FsY04xTjMKCQkgKiBAcGFyYW0gaW50ICRsZW5ndGgKCQkgKiBAcmV0dXJuIGludCBkZW1lcml0CgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiBjYWxjTjFOMygkbGVuZ3RoKSB7CgkJCSRkZW1lcml0ID0gMDsKCQkJZm9yICgkaT0wOyAkaTwkbGVuZ3RoOyArKyRpKSB7CgkJCQlpZiAoJHRoaXMtPnJ1bkxlbmd0aFskaV0gPj0gNSkgewoJCQkJCSRkZW1lcml0ICs9IChOMSArICgkdGhpcy0+cnVuTGVuZ3RoWyRpXSAtIDUpKTsKCQkJCX0KCQkJCWlmICgkaSAmIDEpIHsKCQkJCQlpZiAoKCRpID49IDMpIEFORCAoJGkgPCAoJGxlbmd0aC0yKSkgQU5EICgkdGhpcy0+cnVuTGVuZ3RoWyRpXSAlIDMgPT0gMCkpIHsKCQkJCQkJJGZhY3QgPSAoaW50KSgkdGhpcy0+cnVuTGVuZ3RoWyRpXSAvIDMpOwoJCQkJCQlpZiAoKCR0aGlzLT5ydW5MZW5ndGhbJGktMl0gPT0gJGZhY3QpCgkJCQkJCQlBTkQgKCR0aGlzLT5ydW5MZW5ndGhbJGktMV0gPT0gJGZhY3QpCgkJCQkJCQlBTkQgKCR0aGlzLT5ydW5MZW5ndGhbJGkrMV0gPT0gJGZhY3QpCgkJCQkJCQlBTkQgKCR0aGlzLT5ydW5MZW5ndGhbJGkrMl0gPT0gJGZhY3QpKSB7CgkJCQkJCQlpZiAoKCR0aGlzLT5ydW5MZW5ndGhbJGktM10gPCAwKSBPUiAoJHRoaXMtPnJ1bkxlbmd0aFskaS0zXSA+PSAoNCAqICRmYWN0KSkpIHsKCQkJCQkJCQkkZGVtZXJpdCArPSBOMzsKCQkJCQkJCX0gZWxzZWlmICgoKCRpKzMpID49ICRsZW5ndGgpIE9SICgkdGhpcy0+cnVuTGVuZ3RoWyRpKzNdID49ICg0ICogJGZhY3QpKSkgewoJCQkJCQkJCSRkZW1lcml0ICs9IE4zOwoJCQkJCQkJfQoJCQkJCQl9CgkJCQkJfQoJCQkJfQoJCQl9CgkJCXJldHVybiAkZGVtZXJpdDsKCQl9CgoJCS8qKgoJCSAqIGV2YWx1YXRlU3ltYm9sCgkJICogQHBhcmFtIGludCAkd2lkdGgKCQkgKiBAcGFyYW0gYXJyYXkgJGZyYW1lCgkJICogQHJldHVybiBpbnQgZGVtZXJpdAoJCSAqLwoJCSBwcm90ZWN0ZWQgZnVuY3Rpb24gZXZhbHVhdGVTeW1ib2woJHdpZHRoLCAkZnJhbWUpIHsKCQkJJGhlYWQgPSAwOwoJCQkkZGVtZXJpdCA9IDA7CgkJCWZvciAoJHk9MDsgJHk8JHdpZHRoOyArKyR5KSB7CgkJCQkkaGVhZCA9IDA7CgkJCQkkdGhpcy0+cnVuTGVuZ3RoWzBdID0gMTsKCQkJCSRmcmFtZVkgPSAkZnJhbWVbJHldOwoJCQkJaWYgKCR5ID4gMCkgewoJCQkJCSRmcmFtZVlNID0gJGZyYW1lWyR5LTFdOwoJCQkJfQoJCQkJZm9yICgkeD0wOyAkeDwkd2lkdGg7ICsrJHgpIHsKCQkJCQlpZiAoKCR4ID4gMCkgQU5EICgkeSA+IDApKSB7CgkJCQkJCSRiMjIgPSBvcmQoJGZyYW1lWVskeF0pICYgb3JkKCRmcmFtZVlbJHgtMV0pICYgb3JkKCRmcmFtZVlNWyR4XSkgJiBvcmQoJGZyYW1lWU1bJHgtMV0pOwoJCQkJCQkkdzIyID0gb3JkKCRmcmFtZVlbJHhdKSB8IG9yZCgkZnJhbWVZWyR4LTFdKSB8IG9yZCgkZnJhbWVZTVskeF0pIHwgb3JkKCRmcmFtZVlNWyR4LTFdKTsKCQkJCQkJaWYgKCgkYjIyIHwgKCR3MjIgXiAxKSkgJiAxKSB7CgkJCQkJCQkkZGVtZXJpdCArPSBOMjsKCQkJCQkJfQoJCQkJCX0KCQkJCQlpZiAoKCR4ID09IDApIEFORCAob3JkKCRmcmFtZVlbJHhdKSAmIDEpKSB7CgkJCQkJCSR0aGlzLT5ydW5MZW5ndGhbMF0gPSAtMTsKCQkJCQkJJGhlYWQgPSAxOwoJCQkJCQkkdGhpcy0+cnVuTGVuZ3RoWyRoZWFkXSA9IDE7CgkJCQkJfSBlbHNlaWYgKCR4ID4gMCkgewoJCQkJCQlpZiAoKG9yZCgkZnJhbWVZWyR4XSkgXiBvcmQoJGZyYW1lWVskeC0xXSkpICYgMSkgewoJCQkJCQkJJGhlYWQrKzsKCQkJCQkJCSR0aGlzLT5ydW5MZW5ndGhbJGhlYWRdID0gMTsKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCSR0aGlzLT5ydW5MZW5ndGhbJGhlYWRdKys7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCQkkZGVtZXJpdCArPSAkdGhpcy0+Y2FsY04xTjMoJGhlYWQrMSk7CgkJCX0KCQkJZm9yICgkeD0wOyAkeDwkd2lkdGg7ICsrJHgpIHsKCQkJCSRoZWFkID0gMDsKCQkJCSR0aGlzLT5ydW5MZW5ndGhbMF0gPSAxOwoJCQkJZm9yICgkeT0wOyAkeTwkd2lkdGg7ICsrJHkpIHsKCQkJCQlpZiAoKCR5ID09IDApIEFORCAob3JkKCRmcmFtZVskeV1bJHhdKSAmIDEpKSB7CgkJCQkJCSR0aGlzLT5ydW5MZW5ndGhbMF0gPSAtMTsKCQkJCQkJJGhlYWQgPSAxOwoJCQkJCQkkdGhpcy0+cnVuTGVuZ3RoWyRoZWFkXSA9IDE7CgkJCQkJfSBlbHNlaWYgKCR5ID4gMCkgewoJCQkJCQlpZiAoKG9yZCgkZnJhbWVbJHldWyR4XSkgXiBvcmQoJGZyYW1lWyR5LTFdWyR4XSkpICYgMSkgewoJCQkJCQkJJGhlYWQrKzsKCQkJCQkJCSR0aGlzLT5ydW5MZW5ndGhbJGhlYWRdID0gMTsKCQkJCQkJfSBlbHNlIHsKCQkJCQkJCSR0aGlzLT5ydW5MZW5ndGhbJGhlYWRdKys7CgkJCQkJCX0KCQkJCQl9CgkJCQl9CgkJCQkkZGVtZXJpdCArPSAkdGhpcy0+Y2FsY04xTjMoJGhlYWQrMSk7CgkJCX0KCQkJcmV0dXJuICRkZW1lcml0OwoJCX0KCgkJLyoqCgkJICogbWFzawoJCSAqIEBwYXJhbSBpbnQgJHdpZHRoCgkJICogQHBhcmFtIGFycmF5ICRmcmFtZQoJCSAqIEBwYXJhbSBpbnQgJGxldmVsCgkJICogQHJldHVybiBhcnJheSBiZXN0IG1hc2sKCQkgKi8KCQkgcHJvdGVjdGVkIGZ1bmN0aW9uIG1hc2soJHdpZHRoLCAkZnJhbWUsICRsZXZlbCkgewoJCQkkbWluRGVtZXJpdCA9IFBIUF9JTlRfTUFYOwoJCQkkYmVzdE1hc2tOdW0gPSAwOwoJCQkkYmVzdE1hc2sgPSBhcnJheSgpOwoJCQkkY2hlY2tlZF9tYXNrcyA9IGFycmF5KDAsIDEsIDIsIDMsIDQsIDUsIDYsIDcpOwoJCQlpZiAoUVJfRklORF9GUk9NX1JBTkRPTSAhPT0gZmFsc2UpIHsKCQkJCSRob3dNYW51T3V0ID0gOCAtIChRUl9GSU5EX0ZST01fUkFORE9NICUgOSk7CgkJCQlmb3IgKCRpID0gMDsgJGkgPCAgJGhvd01hbnVPdXQ7ICsrJGkpIHsKCQkJCQkkcmVtUG9zID0gcmFuZCAoMCwgY291bnQoJGNoZWNrZWRfbWFza3MpLTEpOwoJCQkJCXVuc2V0KCRjaGVja2VkX21hc2tzWyRyZW1Qb3NdKTsKCQkJCQkkY2hlY2tlZF9tYXNrcyA9IGFycmF5X3ZhbHVlcygkY2hlY2tlZF9tYXNrcyk7CgkJCQl9CgkJCX0KCQkJJGJlc3RNYXNrID0gJGZyYW1lOwoJCQlmb3JlYWNoICgkY2hlY2tlZF9tYXNrcyBhcyAkaSkgewoJCQkJJG1hc2sgPSBhcnJheV9maWxsKDAsICR3aWR0aCwgc3RyX3JlcGVhdCgiXDAiLCAkd2lkdGgpKTsKCQkJCSRkZW1lcml0ID0gMDsKCQkJCSRibGFja3MgPSAwOwoJCQkJJGJsYWNrcyAgPSAkdGhpcy0+bWFrZU1hc2tObygkaSwgJHdpZHRoLCAkZnJhbWUsICRtYXNrKTsKCQkJCSRibGFja3MgKz0gJHRoaXMtPndyaXRlRm9ybWF0SW5mb3JtYXRpb24oJHdpZHRoLCAkbWFzaywgJGksICRsZXZlbCk7CgkJCQkkYmxhY2tzICA9IChpbnQpKDEwMCAqICRibGFja3MgLyAoJHdpZHRoICogJHdpZHRoKSk7CgkJCQkkZGVtZXJpdCA9IChpbnQpKChpbnQpKGFicygkYmxhY2tzIC0gNTApIC8gNSkgKiBONCk7CgkJCQkkZGVtZXJpdCArPSAkdGhpcy0+ZXZhbHVhdGVTeW1ib2woJHdpZHRoLCAkbWFzayk7CgkJCQlpZiAoJGRlbWVyaXQgPCAkbWluRGVtZXJpdCkgewoJCQkJCSRtaW5EZW1lcml0ID0gJGRlbWVyaXQ7CgkJCQkJJGJlc3RNYXNrID0gJG1hc2s7CgkJCQkJJGJlc3RNYXNrTnVtID0gJGk7CgkJCQl9CgkJCX0KCQkJcmV0dXJuICRiZXN0TWFzazsKCQl9CgoJCS8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0KCgkJLy8gUVJzcGxpdAoKCQkvKioKCQkgKiBSZXR1cm4gdHJ1ZSBpZiB0aGUgY2hhcmFjdGVyIGF0IHNwZWNpZmllZCBwb3NpdGlvbiBpcyBhIG51bWJlcgoJCSAqIEBwYXJhbSBzdHJpbmcgJHN0ciBzdHJpbmcKCQkgKiBAcGFyYW0gaW50ICRwb3MgY2hhcmFjdGVkIHBvc2l0aW9uCgkJICogQHJldHVybiBib29sZWFuIHRydWUgb2YgZmFsc2UKCQkgKi8KCQkgcHJvdGVjdGVkIGZ1bmN0aW9uIGlzZGlnaXRhdCgkc3RyLCAkcG9zKSB7CgkJCWlmICgkcG9zID49IHN0cmxlbigkc3RyKSkgewoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgkJCXJldHVybiAoKG9yZCgkc3RyWyRwb3NdKSA+PSBvcmQoJzAnKSkmJihvcmQoJHN0clskcG9zXSkgPD0gb3JkKCc5JykpKTsKCQl9CgoJCS8qKgoJCSAqIFJldHVybiB0cnVlIGlmIHRoZSBjaGFyYWN0ZXIgYXQgc3BlY2lmaWVkIHBvc2l0aW9uIGlzIGFuIGFscGhhbnVtZXJpYyBjaGFyYWN0ZXIKCQkgKiBAcGFyYW0gc3RyaW5nICRzdHIgc3RyaW5nCgkJICogQHBhcmFtIGludCAkcG9zIGNoYXJhY3RlZCBwb3NpdGlvbgoJCSAqIEByZXR1cm4gYm9vbGVhbiB0cnVlIG9mIGZhbHNlCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiBpc2FsbnVtYXQoJHN0ciwgJHBvcykgewoJCQlpZiAoJHBvcyA+PSBzdHJsZW4oJHN0cikpIHsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoJCQlyZXR1cm4gKCR0aGlzLT5sb29rQW5UYWJsZShvcmQoJHN0clskcG9zXSkpID49IDApOwoJCX0KCgkJLyoqCgkJICogaWRlbnRpZnlNb2RlCgkJICogQHBhcmFtIGludCAkcG9zCgkJICogQHJldHVybiBpbnQgbW9kZQoJCSAqLwoJCSBwcm90ZWN0ZWQgZnVuY3Rpb24gaWRlbnRpZnlNb2RlKCRwb3MpIHsKCQkJaWYgKCRwb3MgPj0gc3RybGVuKCR0aGlzLT5kYXRhU3RyKSkgewoJCQkJcmV0dXJuIFFSX01PREVfTkw7CgkJCX0KCQkJJGMgPSAkdGhpcy0+ZGF0YVN0clskcG9zXTsKCQkJaWYgKCR0aGlzLT5pc2RpZ2l0YXQoJHRoaXMtPmRhdGFTdHIsICRwb3MpKSB7CgkJCQlyZXR1cm4gUVJfTU9ERV9OTTsKCQkJfSBlbHNlaWYgKCR0aGlzLT5pc2FsbnVtYXQoJHRoaXMtPmRhdGFTdHIsICRwb3MpKSB7CgkJCQlyZXR1cm4gUVJfTU9ERV9BTjsKCQkJfSBlbHNlaWYgKCR0aGlzLT5oaW50ID09IFFSX01PREVfS0opIHsKCQkJCWlmICgkcG9zKzEgPCBzdHJsZW4oJHRoaXMtPmRhdGFTdHIpKSB7CgkJCQkJJGQgPSAkdGhpcy0+ZGF0YVN0clskcG9zKzFdOwoJCQkJCSR3b3JkID0gKG9yZCgkYykgPDwgOCkgfCBvcmQoJGQpOwoJCQkJCWlmICgoJHdvcmQgPj0gMHg4MTQwICYmICR3b3JkIDw9IDB4OWZmYykgT1IgKCR3b3JkID49IDB4ZTA0MCAmJiAkd29yZCA8PSAweGViYmYpKSB7CgkJCQkJCXJldHVybiBRUl9NT0RFX0tKOwoJCQkJCX0KCQkJCX0KCQkJfQoJCQlyZXR1cm4gUVJfTU9ERV84QjsKCQl9CgoJCS8qKgoJCSAqIGVhdE51bQoJCSAqIEByZXR1cm4gaW50IHJ1bgoJCSAqLwoJCSBwcm90ZWN0ZWQgZnVuY3Rpb24gZWF0TnVtKCkgewoJCQkkbG4gPSAkdGhpcy0+bGVuZ3RoSW5kaWNhdG9yKFFSX01PREVfTk0sICR0aGlzLT52ZXJzaW9uKTsKCQkJJHAgPSAwOwoJCQl3aGlsZSgkdGhpcy0+aXNkaWdpdGF0KCR0aGlzLT5kYXRhU3RyLCAkcCkpIHsKCQkJCSRwKys7CgkJCX0KCQkJJHJ1biA9ICRwOwoJCQkkbW9kZSA9ICR0aGlzLT5pZGVudGlmeU1vZGUoJHApOwoJCQlpZiAoJG1vZGUgPT0gUVJfTU9ERV84QikgewoJCQkJJGRpZiA9ICR0aGlzLT5lc3RpbWF0ZUJpdHNNb2RlTnVtKCRydW4pICsgNCArICRsbgoJCQkJKyAkdGhpcy0+ZXN0aW1hdGVCaXRzTW9kZTgoMSkgICAgICAgICAvLyArIDQgKyBsOAoJCQkJLSAkdGhpcy0+ZXN0aW1hdGVCaXRzTW9kZTgoJHJ1biArIDEpOyAvLyAtIDQgLSBsOAoJCQkJaWYgKCRkaWYgPiAwKSB7CgkJCQkJcmV0dXJuICR0aGlzLT5lYXQ4KCk7CgkJCQl9CgkJCX0KCQkJaWYgKCRtb2RlID09IFFSX01PREVfQU4pIHsKCQkJCSRkaWYgPSAkdGhpcy0+ZXN0aW1hdGVCaXRzTW9kZU51bSgkcnVuKSArIDQgKyAkbG4KCQkJCSsgJHRoaXMtPmVzdGltYXRlQml0c01vZGVBbigxKSAgICAgICAgLy8gKyA0ICsgbGEKCQkJCS0gJHRoaXMtPmVzdGltYXRlQml0c01vZGVBbigkcnVuICsgMSk7Ly8gLSA0IC0gbGEKCQkJCWlmICgkZGlmID4gMCkgewoJCQkJCXJldHVybiAkdGhpcy0+ZWF0QW4oKTsKCQkJCX0KCQkJfQoJCQkkdGhpcy0+aXRlbXMgPSAkdGhpcy0+YXBwZW5kTmV3SW5wdXRJdGVtKCR0aGlzLT5pdGVtcywgUVJfTU9ERV9OTSwgJHJ1biwgc3RyX3NwbGl0KCR0aGlzLT5kYXRhU3RyKSk7CgkJCXJldHVybiAkcnVuOwoJCX0KCgkJLyoqCgkJICogZWF0QW4KCQkgKiBAcmV0dXJuIGludCBydW4KCQkgKi8KCQkgcHJvdGVjdGVkIGZ1bmN0aW9uIGVhdEFuKCkgewoJCQkkbGEgPSAkdGhpcy0+bGVuZ3RoSW5kaWNhdG9yKFFSX01PREVfQU4sICAkdGhpcy0+dmVyc2lvbik7CgkJCSRsbiA9ICR0aGlzLT5sZW5ndGhJbmRpY2F0b3IoUVJfTU9ERV9OTSwgJHRoaXMtPnZlcnNpb24pOwoJCQkkcCA9IDA7CgkJCXdoaWxlKCR0aGlzLT5pc2FsbnVtYXQoJHRoaXMtPmRhdGFTdHIsICRwKSkgewoJCQkJaWYgKCR0aGlzLT5pc2RpZ2l0YXQoJHRoaXMtPmRhdGFTdHIsICRwKSkgewoJCQkJCSRxID0gJHA7CgkJCQkJd2hpbGUoJHRoaXMtPmlzZGlnaXRhdCgkdGhpcy0+ZGF0YVN0ciwgJHEpKSB7CgkJCQkJCSRxKys7CgkJCQkJfQoJCQkJCSRkaWYgPSAkdGhpcy0+ZXN0aW1hdGVCaXRzTW9kZUFuKCRwKSAvLyArIDQgKyBsYQoJCQkJCSsgJHRoaXMtPmVzdGltYXRlQml0c01vZGVOdW0oJHEgLSAkcCkgKyA0ICsgJGxuCgkJCQkJLSAkdGhpcy0+ZXN0aW1hdGVCaXRzTW9kZUFuKCRxKTsgLy8gLSA0IC0gbGEKCQkJCQlpZiAoJGRpZiA8IDApIHsKCQkJCQkJYnJlYWs7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJHAgPSAkcTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCSRwKys7CgkJCQl9CgkJCX0KCQkJJHJ1biA9ICRwOwoJCQlpZiAoISR0aGlzLT5pc2FsbnVtYXQoJHRoaXMtPmRhdGFTdHIsICRwKSkgewoJCQkJJGRpZiA9ICR0aGlzLT5lc3RpbWF0ZUJpdHNNb2RlQW4oJHJ1bikgKyA0ICsgJGxhCgkJCQkrICR0aGlzLT5lc3RpbWF0ZUJpdHNNb2RlOCgxKSAvLyArIDQgKyBsOAoJCQkJLSAkdGhpcy0+ZXN0aW1hdGVCaXRzTW9kZTgoJHJ1biArIDEpOyAvLyAtIDQgLSBsOAoJCQkJaWYgKCRkaWYgPiAwKSB7CgkJCQkJcmV0dXJuICR0aGlzLT5lYXQ4KCk7CgkJCQl9CgkJCX0KCQkJJHRoaXMtPml0ZW1zID0gJHRoaXMtPmFwcGVuZE5ld0lucHV0SXRlbSgkdGhpcy0+aXRlbXMsIFFSX01PREVfQU4sICRydW4sIHN0cl9zcGxpdCgkdGhpcy0+ZGF0YVN0cikpOwoJCQlyZXR1cm4gJHJ1bjsKCQl9CgoJCS8qKgoJCSAqIGVhdEthbmppCgkJICogQHJldHVybiBpbnQgcnVuCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiBlYXRLYW5qaSgpIHsKCQkJJHAgPSAwOwoJCQl3aGlsZSgkdGhpcy0+aWRlbnRpZnlNb2RlKCRwKSA9PSBRUl9NT0RFX0tKKSB7CgkJCQkkcCArPSAyOwoJCQl9CgkJCSR0aGlzLT5pdGVtcyA9ICR0aGlzLT5hcHBlbmROZXdJbnB1dEl0ZW0oJHRoaXMtPml0ZW1zLCBRUl9NT0RFX0tKLCAkcCwgc3RyX3NwbGl0KCR0aGlzLT5kYXRhU3RyKSk7CgkJCXJldHVybiAkcnVuOwoJCX0KCgkJLyoqCgkJICogZWF0OAoJCSAqIEByZXR1cm4gaW50IHJ1bgoJCSAqLwoJCSBwcm90ZWN0ZWQgZnVuY3Rpb24gZWF0OCgpIHsKCQkJJGxhID0gJHRoaXMtPmxlbmd0aEluZGljYXRvcihRUl9NT0RFX0FOLCAkdGhpcy0+dmVyc2lvbik7CgkJCSRsbiA9ICR0aGlzLT5sZW5ndGhJbmRpY2F0b3IoUVJfTU9ERV9OTSwgJHRoaXMtPnZlcnNpb24pOwoJCQkkcCA9IDE7CgkJCSRkYXRhU3RyTGVuID0gc3RybGVuKCR0aGlzLT5kYXRhU3RyKTsKCQkJd2hpbGUoJHAgPCAkZGF0YVN0ckxlbikgewoJCQkJJG1vZGUgPSAkdGhpcy0+aWRlbnRpZnlNb2RlKCRwKTsKCQkJCWlmICgkbW9kZSA9PSBRUl9NT0RFX0tKKSB7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQlpZiAoJG1vZGUgPT0gUVJfTU9ERV9OTSkgewoJCQkJCSRxID0gJHA7CgkJCQkJd2hpbGUoJHRoaXMtPmlzZGlnaXRhdCgkdGhpcy0+ZGF0YVN0ciwgJHEpKSB7CgkJCQkJCSRxKys7CgkJCQkJfQoJCQkJCSRkaWYgPSAkdGhpcy0+ZXN0aW1hdGVCaXRzTW9kZTgoJHApIC8vICsgNCArIGw4CgkJCQkJKyAkdGhpcy0+ZXN0aW1hdGVCaXRzTW9kZU51bSgkcSAtICRwKSArIDQgKyAkbG4KCQkJCQktICR0aGlzLT5lc3RpbWF0ZUJpdHNNb2RlOCgkcSk7IC8vIC0gNCAtIGw4CgkJCQkJaWYgKCRkaWYgPCAwKSB7CgkJCQkJCWJyZWFrOwoJCQkJCX0gZWxzZSB7CgkJCQkJCSRwID0gJHE7CgkJCQkJfQoJCQkJfSBlbHNlaWYgKCRtb2RlID09IFFSX01PREVfQU4pIHsKCQkJCQkkcSA9ICRwOwoJCQkJCXdoaWxlKCR0aGlzLT5pc2FsbnVtYXQoJHRoaXMtPmRhdGFTdHIsICRxKSkgewoJCQkJCQkkcSsrOwoJCQkJCX0KCQkJCQkkZGlmID0gJHRoaXMtPmVzdGltYXRlQml0c01vZGU4KCRwKSAgLy8gKyA0ICsgbDgKCQkJCQkrICR0aGlzLT5lc3RpbWF0ZUJpdHNNb2RlQW4oJHEgLSAkcCkgKyA0ICsgJGxhCgkJCQkJLSAkdGhpcy0+ZXN0aW1hdGVCaXRzTW9kZTgoJHEpOyAvLyAtIDQgLSBsOAoJCQkJCWlmICgkZGlmIDwgMCkgewoJCQkJCQlicmVhazsKCQkJCQl9IGVsc2UgewoJCQkJCQkkcCA9ICRxOwoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJJHArKzsKCQkJCX0KCQkJfQoJCQkkcnVuID0gJHA7CgkJCSR0aGlzLT5pdGVtcyA9ICR0aGlzLT5hcHBlbmROZXdJbnB1dEl0ZW0oJHRoaXMtPml0ZW1zLCBRUl9NT0RFXzhCLCAkcnVuLCBzdHJfc3BsaXQoJHRoaXMtPmRhdGFTdHIpKTsKCQkJcmV0dXJuICRydW47CgkJfQoKCQkvKioKCQkgKiBzcGxpdFN0cmluZwoJCSAqLwoJCSBwcm90ZWN0ZWQgZnVuY3Rpb24gc3BsaXRTdHJpbmcoKSB7CgkJCXdoaWxlIChzdHJsZW4oJHRoaXMtPmRhdGFTdHIpID4gMCkgewoJCQkJaWYgKCR0aGlzLT5kYXRhU3RyID09ICcnKSB7CgkJCQkJcmV0dXJuIDA7CgkJCQl9CgkJCQkkbW9kZSA9ICR0aGlzLT5pZGVudGlmeU1vZGUoMCk7CgkJCQlzd2l0Y2ggKCRtb2RlKSB7CgkJCQkJY2FzZSBRUl9NT0RFX05NOiB7CgkJCQkJCSRsZW5ndGggPSAkdGhpcy0+ZWF0TnVtKCk7CgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCQljYXNlIFFSX01PREVfQU46IHsKCQkJCQkJJGxlbmd0aCA9ICR0aGlzLT5lYXRBbigpOwoJCQkJCQlicmVhazsKCQkJCQl9CgkJCQkJY2FzZSBRUl9NT0RFX0tKOiB7CgkJCQkJCWlmICgkaGludCA9PSBRUl9NT0RFX0tKKSB7CgkJCQkJCQkkbGVuZ3RoID0gJHRoaXMtPmVhdEthbmppKCk7CgkJCQkJCX0gZWxzZSB7CgkJCQkJCQkkbGVuZ3RoID0gJHRoaXMtPmVhdDgoKTsKCQkJCQkJfQoJCQkJCQlicmVhazsKCQkJCQl9CgkJCQkJZGVmYXVsdDogewoJCQkJCQkkbGVuZ3RoID0gJHRoaXMtPmVhdDgoKTsKCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJfQoJCQkJaWYgKCRsZW5ndGggPT0gMCkgewoJCQkJCXJldHVybiAwOwoJCQkJfQoJCQkJaWYgKCRsZW5ndGggPCAwKSB7CgkJCQkJcmV0dXJuIC0xOwoJCQkJfQoJCQkJJHRoaXMtPmRhdGFTdHIgPSBzdWJzdHIoJHRoaXMtPmRhdGFTdHIsICRsZW5ndGgpOwoJCQl9CgkJfQoKCQkvKioKCQkgKiB0b1VwcGVyCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiB0b1VwcGVyKCkgewoJCQkkc3RyaW5nTGVuID0gc3RybGVuKCR0aGlzLT5kYXRhU3RyKTsKCQkJJHAgPSAwOwoJCQl3aGlsZSAoJHAgPCAkc3RyaW5nTGVuKSB7CgkJCQkkbW9kZSA9ICR0aGlzLT5pZGVudGlmeU1vZGUoc3Vic3RyKCR0aGlzLT5kYXRhU3RyLCAkcCksICR0aGlzLT5oaW50KTsKCQkJCWlmICgkbW9kZSA9PSBRUl9NT0RFX0tKKSB7CgkJCQkJJHAgKz0gMjsKCQkJCX0gZWxzZSB7CgkJCQkJaWYgKChvcmQoJHRoaXMtPmRhdGFTdHJbJHBdKSA+PSBvcmQoJ2EnKSkgQU5EIChvcmQoJHRoaXMtPmRhdGFTdHJbJHBdKSA8PSBvcmQoJ3onKSkpIHsKCQkJCQkJJHRoaXMtPmRhdGFTdHJbJHBdID0gY2hyKG9yZCgkdGhpcy0+ZGF0YVN0clskcF0pIC0gMzIpOwoJCQkJCX0KCQkJCQkkcCsrOwoJCQkJfQoJCQl9CgkJCXJldHVybiAkdGhpcy0+ZGF0YVN0cjsKCQl9CgoJCS8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0KCgkJLy8gUVJpbnB1dEl0ZW0KCgkJLyoqCgkJICogbmV3SW5wdXRJdGVtCgkJICogQHBhcmFtIGludCAkbW9kZQoJCSAqIEBwYXJhbSBpbnQgJHNpemUKCQkgKiBAcGFyYW0gYXJyYXkgJGRhdGEKCQkgKiBAcGFyYW0gYXJyYXkgJGJzdHJlYW0KCQkgKiBAcmV0dXJuIGFycmF5IGlucHV0IGl0ZW0KCQkgKi8KCQkgcHJvdGVjdGVkIGZ1bmN0aW9uIG5ld0lucHV0SXRlbSgkbW9kZSwgJHNpemUsICRkYXRhLCAkYnN0cmVhbT1udWxsKSB7CgkJCSRzZXREYXRhID0gYXJyYXlfc2xpY2UoJGRhdGEsIDAsICRzaXplKTsKCQkJaWYgKGNvdW50KCRzZXREYXRhKSA8ICRzaXplKSB7CgkJCQkkc2V0RGF0YSA9IGFycmF5X21lcmdlKCRzZXREYXRhLCBhcnJheV9maWxsKDAsICgkc2l6ZSAtIGNvdW50KCRzZXREYXRhKSksIDApKTsKCQkJfQoJCQlpZiAoISR0aGlzLT5jaGVjaygkbW9kZSwgJHNpemUsICRzZXREYXRhKSkgewoJCQkJcmV0dXJuIE5VTEw7CgkJCX0KCQkJJGlucHV0aXRlbSA9IGFycmF5KCk7CgkJCSRpbnB1dGl0ZW1bJ21vZGUnXSA9ICRtb2RlOwoJCQkkaW5wdXRpdGVtWydzaXplJ10gPSAkc2l6ZTsKCQkJJGlucHV0aXRlbVsnZGF0YSddID0gJHNldERhdGE7CgkJCSRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSA9ICRic3RyZWFtOwoJCQlyZXR1cm4gJGlucHV0aXRlbTsKCQl9CgoJCS8qKgoJCSAqIGVuY29kZU1vZGVOdW0KCQkgKiBAcGFyYW0gYXJyYXkgJGlucHV0aXRlbQoJCSAqIEBwYXJhbSBpbnQgJHZlcnNpb24KCQkgKiBAcmV0dXJuIGFycmF5IGlucHV0IGl0ZW0KCQkgKi8KCQkgcHJvdGVjdGVkIGZ1bmN0aW9uIGVuY29kZU1vZGVOdW0oJGlucHV0aXRlbSwgJHZlcnNpb24pIHsKCQkJJHdvcmRzID0gKGludCkoJGlucHV0aXRlbVsnc2l6ZSddIC8gMyk7CgkJCSRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSA9IGFycmF5KCk7CgkJCSR2YWwgPSAweDE7CgkJCSRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSA9ICR0aGlzLT5hcHBlbmROdW0oJGlucHV0aXRlbVsnYnN0cmVhbSddLCA0LCAkdmFsKTsKCQkJJGlucHV0aXRlbVsnYnN0cmVhbSddID0gJHRoaXMtPmFwcGVuZE51bSgkaW5wdXRpdGVtWydic3RyZWFtJ10sICR0aGlzLT5sZW5ndGhJbmRpY2F0b3IoUVJfTU9ERV9OTSwgJHZlcnNpb24pLCAkaW5wdXRpdGVtWydzaXplJ10pOwoJCQlmb3IgKCRpPTA7ICRpIDwgJHdvcmRzOyArKyRpKSB7CgkJCQkkdmFsICA9IChvcmQoJGlucHV0aXRlbVsnZGF0YSddWyRpKjMgIF0pIC0gb3JkKCcwJykpICogMTAwOwoJCQkJJHZhbCArPSAob3JkKCRpbnB1dGl0ZW1bJ2RhdGEnXVskaSozKzFdKSAtIG9yZCgnMCcpKSAqIDEwOwoJCQkJJHZhbCArPSAob3JkKCRpbnB1dGl0ZW1bJ2RhdGEnXVskaSozKzJdKSAtIG9yZCgnMCcpKTsKCQkJCSRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSA9ICR0aGlzLT5hcHBlbmROdW0oJGlucHV0aXRlbVsnYnN0cmVhbSddLCAxMCwgJHZhbCk7CgkJCX0KCQkJaWYgKCRpbnB1dGl0ZW1bJ3NpemUnXSAtICR3b3JkcyAqIDMgPT0gMSkgewoJCQkJJHZhbCA9IG9yZCgkaW5wdXRpdGVtWydkYXRhJ11bJHdvcmRzKjNdKSAtIG9yZCgnMCcpOwoJCQkJJGlucHV0aXRlbVsnYnN0cmVhbSddID0gJHRoaXMtPmFwcGVuZE51bSgkaW5wdXRpdGVtWydic3RyZWFtJ10sIDQsICR2YWwpOwoJCQl9IGVsc2VpZiAoKCRpbnB1dGl0ZW1bJ3NpemUnXSAtICgkd29yZHMgKiAzKSkgPT0gMikgewoJCQkJJHZhbCAgPSAob3JkKCRpbnB1dGl0ZW1bJ2RhdGEnXVskd29yZHMqMyAgXSkgLSBvcmQoJzAnKSkgKiAxMDsKCQkJCSR2YWwgKz0gKG9yZCgkaW5wdXRpdGVtWydkYXRhJ11bJHdvcmRzKjMrMV0pIC0gb3JkKCcwJykpOwoJCQkJJGlucHV0aXRlbVsnYnN0cmVhbSddID0gJHRoaXMtPmFwcGVuZE51bSgkaW5wdXRpdGVtWydic3RyZWFtJ10sIDcsICR2YWwpOwoJCQl9CgkJCXJldHVybiAkaW5wdXRpdGVtOwoJCX0KCgkJLyoqCgkJICogZW5jb2RlTW9kZUFuCgkJICogQHBhcmFtIGFycmF5ICRpbnB1dGl0ZW0KCQkgKiBAcGFyYW0gaW50ICR2ZXJzaW9uCgkJICogQHJldHVybiBhcnJheSBpbnB1dCBpdGVtCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiBlbmNvZGVNb2RlQW4oJGlucHV0aXRlbSwgJHZlcnNpb24pIHsKCQkJJHdvcmRzID0gKGludCkoJGlucHV0aXRlbVsnc2l6ZSddIC8gMik7CgkJCSRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSA9IGFycmF5KCk7CgkJCSRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSA9ICR0aGlzLT5hcHBlbmROdW0oJGlucHV0aXRlbVsnYnN0cmVhbSddLCA0LCAweDAyKTsKCQkJJGlucHV0aXRlbVsnYnN0cmVhbSddID0gJHRoaXMtPmFwcGVuZE51bSh2LCAkdGhpcy0+bGVuZ3RoSW5kaWNhdG9yKFFSX01PREVfQU4sICR2ZXJzaW9uKSwgJGlucHV0aXRlbVsnc2l6ZSddKTsKCQkJZm9yICgkaT0wOyAkaSA8ICR3b3JkczsgKyskaSkgewoJCQkJJHZhbCAgPSAoaW50KSR0aGlzLT5sb29rQW5UYWJsZShvcmQoJGlucHV0aXRlbVsnZGF0YSddWyRpKjIgIF0pKSAqIDQ1OwoJCQkJJHZhbCArPSAoaW50KSR0aGlzLT5sb29rQW5UYWJsZShvcmQoJGlucHV0aXRlbVsnZGF0YSddWyRpKjIrMV0pKTsKCQkJCSRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSA9ICR0aGlzLT5hcHBlbmROdW0oJGlucHV0aXRlbVsnYnN0cmVhbSddLCAxMSwgJHZhbCk7CgkJCX0KCQkJaWYgKCRpbnB1dGl0ZW1bJ3NpemUnXSAmIDEpIHsKCQkJCSR2YWwgPSAkdGhpcy0+bG9va0FuVGFibGUob3JkKCRpbnB1dGl0ZW1bJ2RhdGEnXVsoJHdvcmRzICogMildKSk7CgkJCQkkaW5wdXRpdGVtWydic3RyZWFtJ10gPSAkdGhpcy0+YXBwZW5kTnVtKCRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSwgNiwgJHZhbCk7CgkJCX0KCQkJcmV0dXJuICRpbnB1dGl0ZW07CgkJfQoKCQkvKioKCQkgKiBlbmNvZGVNb2RlOAoJCSAqIEBwYXJhbSBhcnJheSAkaW5wdXRpdGVtCgkJICogQHBhcmFtIGludCAkdmVyc2lvbgoJCSAqIEByZXR1cm4gYXJyYXkgaW5wdXQgaXRlbQoJCSAqLwoJCSBwcm90ZWN0ZWQgZnVuY3Rpb24gZW5jb2RlTW9kZTgoJGlucHV0aXRlbSwgJHZlcnNpb24pIHsKCQkJJGlucHV0aXRlbVsnYnN0cmVhbSddID0gYXJyYXkoKTsKCQkJJGlucHV0aXRlbVsnYnN0cmVhbSddID0gJHRoaXMtPmFwcGVuZE51bSgkaW5wdXRpdGVtWydic3RyZWFtJ10sIDQsIDB4NCk7CgkJCSRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSA9ICR0aGlzLT5hcHBlbmROdW0oJGlucHV0aXRlbVsnYnN0cmVhbSddLCAkdGhpcy0+bGVuZ3RoSW5kaWNhdG9yKFFSX01PREVfOEIsICR2ZXJzaW9uKSwgJGlucHV0aXRlbVsnc2l6ZSddKTsKCQkJZm9yICgkaT0wOyAkaSA8ICRpbnB1dGl0ZW1bJ3NpemUnXTsgKyskaSkgewoJCQkJJGlucHV0aXRlbVsnYnN0cmVhbSddID0gJHRoaXMtPmFwcGVuZE51bSgkaW5wdXRpdGVtWydic3RyZWFtJ10sIDgsIG9yZCgkaW5wdXRpdGVtWydkYXRhJ11bJGldKSk7CgkJCX0KCQkJcmV0dXJuICRpbnB1dGl0ZW07CgkJfQoKCQkvKioKCQkgKiBlbmNvZGVNb2RlS2FuamkKCQkgKiBAcGFyYW0gYXJyYXkgJGlucHV0aXRlbQoJCSAqIEBwYXJhbSBpbnQgJHZlcnNpb24KCQkgKiBAcmV0dXJuIGFycmF5IGlucHV0IGl0ZW0KCQkgKi8KCQkgcHJvdGVjdGVkIGZ1bmN0aW9uIGVuY29kZU1vZGVLYW5qaSgkaW5wdXRpdGVtLCAkdmVyc2lvbikgewoJCQkkaW5wdXRpdGVtWydic3RyZWFtJ10gPSBhcnJheSgpOwoJCQkkaW5wdXRpdGVtWydic3RyZWFtJ10gPSAkdGhpcy0+YXBwZW5kTnVtKCRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSwgNCwgMHg4KTsKCQkJJGlucHV0aXRlbVsnYnN0cmVhbSddID0gJHRoaXMtPmFwcGVuZE51bSgkaW5wdXRpdGVtWydic3RyZWFtJ10sICR0aGlzLT5sZW5ndGhJbmRpY2F0b3IoUVJfTU9ERV9LSiwgJHZlcnNpb24pLCAoaW50KSgkaW5wdXRpdGVtWydzaXplJ10gLyAyKSk7CgkJCWZvciAoJGk9MDsgJGk8JGlucHV0aXRlbVsnc2l6ZSddOyAkaSs9MikgewoJCQkJJHZhbCA9IChvcmQoJGlucHV0aXRlbVsnZGF0YSddWyRpXSkgPDwgOCkgfCBvcmQoJGlucHV0aXRlbVsnZGF0YSddWyRpKzFdKTsKCQkJCWlmICgkdmFsIDw9IDB4OWZmYykgewoJCQkJCSR2YWwgLT0gMHg4MTQwOwoJCQkJfSBlbHNlIHsKCQkJCQkkdmFsIC09IDB4YzE0MDsKCQkJCX0KCQkJCSRoID0gKCR2YWwgPj4gOCkgKiAweGMwOwoJCQkJJHZhbCA9ICgkdmFsICYgMHhmZikgKyAkaDsKCQkJCSRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSA9ICR0aGlzLT5hcHBlbmROdW0oJGlucHV0aXRlbVsnYnN0cmVhbSddLCAxMywgJHZhbCk7CgkJCX0KCQkJcmV0dXJuICRpbnB1dGl0ZW07CgkJfQoKCQkvKioKCQkgKiBlbmNvZGVNb2RlU3RydWN0dXJlCgkJICogQHBhcmFtIGFycmF5ICRpbnB1dGl0ZW0KCQkgKiBAcmV0dXJuIGFycmF5IGlucHV0IGl0ZW0KCQkgKi8KCQkgcHJvdGVjdGVkIGZ1bmN0aW9uIGVuY29kZU1vZGVTdHJ1Y3R1cmUoJGlucHV0aXRlbSkgewoJCQkkaW5wdXRpdGVtWydic3RyZWFtJ10gPSBhcnJheSgpOwoJCQkkaW5wdXRpdGVtWydic3RyZWFtJ10gPSAkdGhpcy0+YXBwZW5kTnVtKCRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSwgNCwgMHgwMyk7CgkJCSRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSA9ICR0aGlzLT5hcHBlbmROdW0oJGlucHV0aXRlbVsnYnN0cmVhbSddLCA0LCBvcmQoJGlucHV0aXRlbVsnZGF0YSddWzFdKSAtIDEpOwoJCQkkaW5wdXRpdGVtWydic3RyZWFtJ10gPSAkdGhpcy0+YXBwZW5kTnVtKCRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSwgNCwgb3JkKCRpbnB1dGl0ZW1bJ2RhdGEnXVswXSkgLSAxKTsKCQkJJGlucHV0aXRlbVsnYnN0cmVhbSddID0gJHRoaXMtPmFwcGVuZE51bSgkaW5wdXRpdGVtWydic3RyZWFtJ10sIDgsIG9yZCgkaW5wdXRpdGVtWydkYXRhJ11bMl0pKTsKCQkJcmV0dXJuICRpbnB1dGl0ZW07CgkJfQoKCQkvKioKCQkgKiBlbmNvZGVCaXRTdHJlYW0KCQkgKiBAcGFyYW0gYXJyYXkgJGlucHV0aXRlbQoJCSAqIEBwYXJhbSBpbnQgJHZlcnNpb24KCQkgKiBAcmV0dXJuIGFycmF5IGlucHV0IGl0ZW0KCQkgKi8KCQkgcHJvdGVjdGVkIGZ1bmN0aW9uIGVuY29kZUJpdFN0cmVhbSgkaW5wdXRpdGVtLCAkdmVyc2lvbikgewoJCQkkaW5wdXRpdGVtWydic3RyZWFtJ10gPSBhcnJheSgpOwoJCQkkd29yZHMgPSAkdGhpcy0+bWF4aW11bVdvcmRzKCRpbnB1dGl0ZW1bJ21vZGUnXSwgJHZlcnNpb24pOwoJCQlpZiAoJGlucHV0aXRlbVsnc2l6ZSddID4gJHdvcmRzKSB7CgkJCQkkc3QxID0gJHRoaXMtPm5ld0lucHV0SXRlbSgkaW5wdXRpdGVtWydtb2RlJ10sICR3b3JkcywgJGlucHV0aXRlbVsnZGF0YSddKTsKCQkJCSRzdDIgPSAkdGhpcy0+bmV3SW5wdXRJdGVtKCRpbnB1dGl0ZW1bJ21vZGUnXSwgJGlucHV0aXRlbVsnc2l6ZSddIC0gJHdvcmRzLCBhcnJheV9zbGljZSgkaW5wdXRpdGVtWydkYXRhJ10sICR3b3JkcykpOwoJCQkJJHN0MSA9ICR0aGlzLT5lbmNvZGVCaXRTdHJlYW0oJHN0MSwgJHZlcnNpb24pOwoJCQkJJHN0MiA9ICR0aGlzLT5lbmNvZGVCaXRTdHJlYW0oJHN0MiwgJHZlcnNpb24pOwoJCQkJJGlucHV0aXRlbVsnYnN0cmVhbSddID0gYXJyYXkoKTsKCQkJCSRpbnB1dGl0ZW1bJ2JzdHJlYW0nXSA9ICR0aGlzLT5hcHBlbmRCaXRzdHJlYW0oJGlucHV0aXRlbVsnYnN0cmVhbSddLCAkc3QxWydic3RyZWFtJ10pOwoJCQkJJGlucHV0aXRlbVsnYnN0cmVhbSddID0gJHRoaXMtPmFwcGVuZEJpdHN0cmVhbSgkaW5wdXRpdGVtWydic3RyZWFtJ10sICRzdDJbJ2JzdHJlYW0nXSk7CgkJCX0gZWxzZSB7CgkJCQlzd2l0Y2goJGlucHV0aXRlbVsnbW9kZSddKSB7CgkJCQkJY2FzZSBRUl9NT0RFX05NOiB7CgkJCQkJCSRpbnB1dGl0ZW0gPSAkdGhpcy0+ZW5jb2RlTW9kZU51bSgkaW5wdXRpdGVtLCAkdmVyc2lvbik7CgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCQljYXNlIFFSX01PREVfQU46IHsKCQkJCQkJJGlucHV0aXRlbSA9ICR0aGlzLT5lbmNvZGVNb2RlQW4oJGlucHV0aXRlbSwgJHZlcnNpb24pOwoJCQkJCQlicmVhazsKCQkJCQl9CgkJCQkJY2FzZSBRUl9NT0RFXzhCOiB7CgkJCQkJCSRpbnB1dGl0ZW0gPSAkdGhpcy0+ZW5jb2RlTW9kZTgoJGlucHV0aXRlbSwgJHZlcnNpb24pOwoJCQkJCQlicmVhazsKCQkJCQl9CgkJCQkJY2FzZSBRUl9NT0RFX0tKOiB7CgkJCQkJCSRpbnB1dGl0ZW0gPSAkdGhpcy0+ZW5jb2RlTW9kZUthbmppKCRpbnB1dGl0ZW0sICR2ZXJzaW9uKTsKCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJCWNhc2UgUVJfTU9ERV9TVDogewoJCQkJCQkkaW5wdXRpdGVtID0gJHRoaXMtPmVuY29kZU1vZGVTdHJ1Y3R1cmUoJGlucHV0aXRlbSk7CgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCQlkZWZhdWx0OiB7CgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCX0KCQkJfQoJCQlyZXR1cm4gJGlucHV0aXRlbTsKCQl9CgoJCS8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0KCgkJLy8gUVJpbnB1dAoKCQkvKioKCQkgKiBBcHBlbmQgZGF0YSB0byBhbiBpbnB1dCBvYmplY3QuCgkJICogVGhlIGRhdGEgaXMgY29waWVkIGFuZCBhcHBlbmRlZCB0byB0aGUgaW5wdXQgb2JqZWN0LgoJCSAqIEBwYXJhbSBhcnJheSBpdGVtcyBpbnB1dCBpdGVtcwoJCSAqIEBwYXJhbSBpbnQgJG1vZGUgZW5jb2RpbmcgbW9kZS4KCQkgKiBAcGFyYW0gaW50ICRzaXplIHNpemUgb2YgZGF0YSAoYnl0ZSkuCgkJICogQHBhcmFtIGFycmF5ICRkYXRhIGFycmF5IG9mIGlucHV0IGRhdGEuCgkJICogQHJldHVybiBpdGVtcwoJCSAqCgkJICovCgkJcHJvdGVjdGVkIGZ1bmN0aW9uIGFwcGVuZE5ld0lucHV0SXRlbSgkaXRlbXMsICRtb2RlLCAkc2l6ZSwgJGRhdGEpIHsKCQkJJGl0ZW1zW10gPSAkdGhpcy0+bmV3SW5wdXRJdGVtKCRtb2RlLCAkc2l6ZSwgJGRhdGEpOwoJCQlyZXR1cm4gJGl0ZW1zOwoJCX0KCgkJLyoqCgkJICogaW5zZXJ0U3RydWN0dXJlZEFwcGVuZEhlYWRlcgoJCSAqIEBwYXJhbSBhcnJheSAkaXRlbXMKCQkgKiBAcGFyYW0gaW50ICRzaXplCgkJICogQHBhcmFtIGludCAkaW5kZXgKCQkgKiBAcGFyYW0gaW50ICRwYXJpdHkKCQkgKiBAcmV0dXJuIGFycmF5IGl0ZW1zCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiBpbnNlcnRTdHJ1Y3R1cmVkQXBwZW5kSGVhZGVyKCRpdGVtcywgJHNpemUsICRpbmRleCwgJHBhcml0eSkgewoJCQlpZiAoJHNpemUgPiBNQVhfU1RSVUNUVVJFRF9TWU1CT0xTKSB7CgkJCQlyZXR1cm4gLTE7CgkJCX0KCQkJaWYgKCgkaW5kZXggPD0gMCkgT1IgKCRpbmRleCA+IE1BWF9TVFJVQ1RVUkVEX1NZTUJPTFMpKSB7CgkJCQlyZXR1cm4gLTE7CgkJCX0KCQkJJGJ1ZiA9IGFycmF5KCRzaXplLCAkaW5kZXgsICRwYXJpdHkpOwoJCQkkZW50cnkgPSAkdGhpcy0+bmV3SW5wdXRJdGVtKFFSX01PREVfU1QsIDMsIGJ1Zik7CgkJCWFycmF5X3Vuc2hpZnQoJGl0ZW1zLCAkZW50cnkpOwoJCQlyZXR1cm4gJGl0ZW1zOwoJCX0KCgkJLyoqCgkJICogY2FsY1Bhcml0eQoJCSAqIEBwYXJhbSBhcnJheSAkaXRlbXMKCQkgKiBAcmV0dXJuIGludCBwYXJpdHkKCQkgKi8KCQkgcHJvdGVjdGVkIGZ1bmN0aW9uIGNhbGNQYXJpdHkoJGl0ZW1zKSB7CgkJCSRwYXJpdHkgPSAwOwoJCQlmb3JlYWNoICgkaXRlbXMgYXMgJGl0ZW0pIHsKCQkJCWlmICgkaXRlbVsnbW9kZSddICE9IFFSX01PREVfU1QpIHsKCQkJCQlmb3IgKCRpPSRpdGVtWydzaXplJ10tMTsgJGk+PTA7IC0tJGkpIHsKCQkJCQkJJHBhcml0eSBePSAkaXRlbVsnZGF0YSddWyRpXTsKCQkJCQl9CgkJCQl9CgkJCX0KCQkJcmV0dXJuICRwYXJpdHk7CgkJfQoKCQkvKioKCQkgKiBjaGVja01vZGVOdW0KCQkgKiBAcGFyYW0gaW50ICRzaXplCgkJICogQHBhcmFtIGFycmF5ICRkYXRhCgkJICogQHJldHVybiBib29sZWFuIHRydWUgb3IgZmFsc2UKCQkgKi8KCQkgcHJvdGVjdGVkIGZ1bmN0aW9uIGNoZWNrTW9kZU51bSgkc2l6ZSwgJGRhdGEpIHsKCQkJZm9yICgkaT0wOyAkaTwkc2l6ZTsgKyskaSkgewoJCQkJaWYgKChvcmQoJGRhdGFbJGldKSA8IG9yZCgnMCcpKSBPUiAob3JkKCRkYXRhWyRpXSkgPiBvcmQoJzknKSkpewoJCQkJCXJldHVybiBmYWxzZTsKCQkJCX0KCQkJfQoJCQlyZXR1cm4gdHJ1ZTsKCQl9CgoJCS8qKgoJCSAqIGVzdGltYXRlQml0c01vZGVOdW0KCQkgKiBAcGFyYW0gaW50ICRzaXplCgkJICogQHJldHVybiBpbnQgbnVtYmVyIG9mIGJpdHMKCQkgKi8KCQkgcHJvdGVjdGVkIGZ1bmN0aW9uIGVzdGltYXRlQml0c01vZGVOdW0oJHNpemUpIHsKCQkJJHcgPSAoaW50KSRzaXplIC8gMzsKCQkJJGJpdHMgPSAkdyAqIDEwOwoJCQlzd2l0Y2goJHNpemUgLSAkdyAqIDMpIHsKCQkJCWNhc2UgMTogewoJCQkJCSRiaXRzICs9IDQ7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQljYXNlIDI6IHsKCQkJCQkkYml0cyArPSA3OwoJCQkJCWJyZWFrOwoJCQkJfQoJCQkJZGVmYXVsdDogewoJCQkJCWJyZWFrOwoJCQkJfQoJCQl9CgkJCXJldHVybiAkYml0czsKCQl9CgoJCS8qKgoJCSAqIExvb2sgdXAgdGhlIGFscGhhYmV0LW51bWVyaWMgY29udmVzaW9uIHRhYmxlIChzZWUgSklTIFgwNTEwOjIwMDQsIHBwLjE5KS4KCQkgKiBAcGFyYW0gaW50ICRjIGNoYXJhY3RlciB2YWx1ZQoJCSAqIEByZXR1cm4gdmFsdWUKCQkgKi8KCQlwcm90ZWN0ZWQgZnVuY3Rpb24gbG9va0FuVGFibGUoJGMpIHsKCQkJcmV0dXJuICgoJGMgPiAxMjcpPy0xOiR0aGlzLT5hblRhYmxlWyRjXSk7CgkJfQoKCQkvKioKCQkgKiBjaGVja01vZGVBbgoJCSAqIEBwYXJhbSBpbnQgJHNpemUKCQkgKiBAcGFyYW0gYXJyYXkgJGRhdGEKCQkgKiBAcmV0dXJuIGJvb2xlYW4gdHJ1ZSBvciBmYWxzZQoJCSAqLwoJCSBwcm90ZWN0ZWQgZnVuY3Rpb24gY2hlY2tNb2RlQW4oJHNpemUsICRkYXRhKSB7CgkJCWZvciAoJGk9MDsgJGk8JHNpemU7ICsrJGkpIHsKCQkJCWlmICgkdGhpcy0+bG9va0FuVGFibGUob3JkKCRkYXRhWyRpXSkpID09IC0xKSB7CgkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJfQoJCQl9CgkJCXJldHVybiB0cnVlOwoJCX0KCgkJLyoqCgkJICogZXN0aW1hdGVCaXRzTW9kZUFuCgkJICogQHBhcmFtIGludCAkc2l6ZQoJCSAqIEByZXR1cm4gaW50IG51bWJlciBvZiBiaXRzCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiBlc3RpbWF0ZUJpdHNNb2RlQW4oJHNpemUpIHsKCQkJJHcgPSAoaW50KSgkc2l6ZSAvIDIpOwoJCQkkYml0cyA9ICR3ICogMTE7CgkJCWlmICgkc2l6ZSAmIDEpIHsKCQkJCSRiaXRzICs9IDY7CgkJCX0KCQkJcmV0dXJuICRiaXRzOwoJCX0KCgkJLyoqCgkJICogZXN0aW1hdGVCaXRzTW9kZTgKCQkgKiBAcGFyYW0gaW50ICRzaXplCgkJICogQHJldHVybiBpbnQgbnVtYmVyIG9mIGJpdHMKCQkgKi8KCQkgcHJvdGVjdGVkIGZ1bmN0aW9uIGVzdGltYXRlQml0c01vZGU4KCRzaXplKSB7CgkJCXJldHVybiAkc2l6ZSAqIDg7CgkJfQoKCQkvKioKCQkgKiBlc3RpbWF0ZUJpdHNNb2RlS2FuamkKCQkgKiBAcGFyYW0gaW50ICRzaXplCgkJICogQHJldHVybiBpbnQgbnVtYmVyIG9mIGJpdHMKCQkgKi8KCQkgcHJvdGVjdGVkIGZ1bmN0aW9uIGVzdGltYXRlQml0c01vZGVLYW5qaSgkc2l6ZSkgewoJCQlyZXR1cm4gKGludCkoKCRzaXplIC8gMikgKiAxMyk7CgkJfQoKCQkvKioKCQkgKiBjaGVja01vZGVLYW5qaQoJCSAqIEBwYXJhbSBpbnQgJHNpemUKCQkgKiBAcGFyYW0gYXJyYXkgJGRhdGEKCQkgKiBAcmV0dXJuIGJvb2xlYW4gdHJ1ZSBvciBmYWxzZQoJCSAqLwoJCSBwcm90ZWN0ZWQgZnVuY3Rpb24gY2hlY2tNb2RlS2FuamkoJHNpemUsICRkYXRhKSB7CgkJCWlmICgkc2l6ZSAmIDEpIHsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoJCQlmb3IgKCRpPTA7ICRpPCRzaXplOyAkaSs9MikgewoJCQkJJHZhbCA9IChvcmQoJGRhdGFbJGldKSA8PCA4KSB8IG9yZCgkZGF0YVskaSsxXSk7CgkJCQlpZiAoKCR2YWwgPCAweDgxNDApIE9SICgoJHZhbCA+IDB4OWZmYykgQU5EICgkdmFsIDwgMHhlMDQwKSkgT1IgKCR2YWwgPiAweGViYmYpKSB7CgkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJfQoJCQl9CgkJCXJldHVybiB0cnVlOwoJCX0KCgkJLyoqCgkJICogVmFsaWRhdGUgdGhlIGlucHV0IGRhdGEuCgkJICogQHBhcmFtIGludCAkbW9kZSBlbmNvZGluZyBtb2RlLgoJCSAqIEBwYXJhbSBpbnQgJHNpemUgc2l6ZSBvZiBkYXRhIChieXRlKS4KCQkgKiBAcGFyYW0gYXJyYXkgZGF0YSBkYXRhIHRvIHZhbGlkYXRlCgkJICogQHJldHVybiBib29sZWFuIHRydWUgaW4gY2FzZSBvZiB2YWxpZCBkYXRhLCBmYWxzZSBvdGhlcndpc2UKCQkgKi8KCQlwcm90ZWN0ZWQgZnVuY3Rpb24gY2hlY2soJG1vZGUsICRzaXplLCAkZGF0YSkgewoJCQlpZiAoJHNpemUgPD0gMCkgewoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgkJCXN3aXRjaCgkbW9kZSkgewoJCQkJY2FzZSBRUl9NT0RFX05NOiB7CgkJCQkJcmV0dXJuICR0aGlzLT5jaGVja01vZGVOdW0oJHNpemUsICRkYXRhKTsKCQkJCX0KCQkJCWNhc2UgUVJfTU9ERV9BTjogewoJCQkJCXJldHVybiAkdGhpcy0+Y2hlY2tNb2RlQW4oJHNpemUsICRkYXRhKTsKCQkJCX0KCQkJCWNhc2UgUVJfTU9ERV9LSjogewoJCQkJCXJldHVybiAkdGhpcy0+Y2hlY2tNb2RlS2FuamkoJHNpemUsICRkYXRhKTsKCQkJCX0KCQkJCWNhc2UgUVJfTU9ERV84QjogewoJCQkJCXJldHVybiB0cnVlOwoJCQkJfQoJCQkJY2FzZSBRUl9NT0RFX1NUOiB7CgkJCQkJcmV0dXJuIHRydWU7CgkJCQl9CgkJCQlkZWZhdWx0OiB7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCX0KCQkJcmV0dXJuIGZhbHNlOwoJCX0KCgkJLyoqCgkJICogZXN0aW1hdGVCaXRTdHJlYW1TaXplCgkJICogQHBhcmFtIGFycmF5ICRpdGVtcwoJCSAqIEBwYXJhbSBpbnQgJHZlcnNpb24KCQkgKiBAcmV0dXJuIGludCBiaXRzCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiBlc3RpbWF0ZUJpdFN0cmVhbVNpemUoJGl0ZW1zLCAkdmVyc2lvbikgewoJCQkkYml0cyA9IDA7CgkJCWlmICgkdmVyc2lvbiA9PSAwKSB7CgkJCQkkdmVyc2lvbiA9IDE7CgkJCX0KCQkJZm9yZWFjaCAoJGl0ZW1zIGFzICRpdGVtKSB7CgkJCQlzd2l0Y2goJGl0ZW1bJ21vZGUnXSkgewoJCQkJCWNhc2UgUVJfTU9ERV9OTTogewoJCQkJCQkkYml0cyA9ICR0aGlzLT5lc3RpbWF0ZUJpdHNNb2RlTnVtKCRpdGVtWydzaXplJ10pOwoJCQkJCQlicmVhazsKCQkJCQl9CgkJCQkJY2FzZSBRUl9NT0RFX0FOOiB7CgkJCQkJCSRiaXRzID0gJHRoaXMtPmVzdGltYXRlQml0c01vZGVBbigkaXRlbVsnc2l6ZSddKTsKCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJCWNhc2UgUVJfTU9ERV84QjogewoJCQkJCQkkYml0cyA9ICR0aGlzLT5lc3RpbWF0ZUJpdHNNb2RlOCgkaXRlbVsnc2l6ZSddKTsKCQkJCQkJYnJlYWs7CgkJCQkJfQoJCQkJCWNhc2UgUVJfTU9ERV9LSjogewoJCQkJCQkkYml0cyA9ICR0aGlzLT5lc3RpbWF0ZUJpdHNNb2RlS2FuamkoJGl0ZW1bJ3NpemUnXSk7CgkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCQljYXNlIFFSX01PREVfU1Q6IHsKCQkJCQkJcmV0dXJuIFNUUlVDVFVSRV9IRUFERVJfQklUUzsKCQkJCQl9CgkJCQkJZGVmYXVsdDogewoJCQkJCQlyZXR1cm4gMDsKCQkJCQl9CgkJCQl9CgkJCQkkbCA9ICR0aGlzLT5sZW5ndGhJbmRpY2F0b3IoJGl0ZW1bJ21vZGUnXSwgJHZlcnNpb24pOwoJCQkJJG0gPSAxIDw8ICRsOwoJCQkJJG51bSA9IChpbnQpKCgkaXRlbVsnc2l6ZSddICsgJG0gLSAxKSAvICRtKTsKCQkJCSRiaXRzICs9ICRudW0gKiAoNCArICRsKTsKCQkJfQoJCQlyZXR1cm4gJGJpdHM7CgkJfQoKCQkvKioKCQkgKiBlc3RpbWF0ZVZlcnNpb24KCQkgKiBAcGFyYW0gYXJyYXkgJGl0ZW1zCgkJICogQHJldHVybiBpbnQgdmVyc2lvbgoJCSAqLwoJCSBwcm90ZWN0ZWQgZnVuY3Rpb24gZXN0aW1hdGVWZXJzaW9uKCRpdGVtcykgewoJCQkkdmVyc2lvbiA9IDA7CgkJCSRwcmV2ID0gMDsKCQkJZG8gewoJCQkJJHByZXYgPSAkdmVyc2lvbjsKCQkJCSRiaXRzID0gJHRoaXMtPmVzdGltYXRlQml0U3RyZWFtU2l6ZSgkaXRlbXMsICRwcmV2KTsKCQkJCSR2ZXJzaW9uID0gJHRoaXMtPmdldE1pbmltdW1WZXJzaW9uKChpbnQpKCgkYml0cyArIDcpIC8gOCksICR0aGlzLT5sZXZlbCk7CgkJCQlpZiAoJHZlcnNpb24gPCAwKSB7CgkJCQkJcmV0dXJuIC0xOwoJCQkJfQoJCQl9IHdoaWxlICgkdmVyc2lvbiA+ICRwcmV2KTsKCQkJcmV0dXJuICR2ZXJzaW9uOwoJCX0KCgkJLyoqCgkJICogbGVuZ3RoT2ZDb2RlCgkJICogQHBhcmFtIGludCAkbW9kZQoJCSAqIEBwYXJhbSBpbnQgJHZlcnNpb24KCQkgKiBAcGFyYW0gaW50ICRiaXRzCgkJICogQHJldHVybiBpbnQgc2l6ZQoJCSAqLwoJCSBwcm90ZWN0ZWQgZnVuY3Rpb24gbGVuZ3RoT2ZDb2RlKCRtb2RlLCAkdmVyc2lvbiwgJGJpdHMpIHsKCQkJJHBheWxvYWQgPSAkYml0cyAtIDQgLSAkdGhpcy0+bGVuZ3RoSW5kaWNhdG9yKCRtb2RlLCAkdmVyc2lvbik7CgkJCXN3aXRjaCgkbW9kZSkgewoJCQkJY2FzZSBRUl9NT0RFX05NOiB7CgkJCQkJJGNodW5rcyA9IChpbnQpKCRwYXlsb2FkIC8gMTApOwoJCQkJCSRyZW1haW4gPSAkcGF5bG9hZCAtICRjaHVua3MgKiAxMDsKCQkJCQkkc2l6ZSA9ICRjaHVua3MgKiAzOwoJCQkJCWlmICgkcmVtYWluID49IDcpIHsKCQkJCQkJJHNpemUgKz0gMjsKCQkJCQl9IGVsc2VpZiAoJHJlbWFpbiA+PSA0KSB7CgkJCQkJCSRzaXplICs9IDE7CgkJCQkJfQoJCQkJCWJyZWFrOwoJCQkJfQoJCQkJY2FzZSBRUl9NT0RFX0FOOiB7CgkJCQkJJGNodW5rcyA9IChpbnQpKCRwYXlsb2FkIC8gMTEpOwoJCQkJCSRyZW1haW4gPSAkcGF5bG9hZCAtICRjaHVua3MgKiAxMTsKCQkJCQkkc2l6ZSA9ICRjaHVua3MgKiAyOwoJCQkJCWlmICgkcmVtYWluID49IDYpIHsKCQkJCQkJKyskc2l6ZTsKCQkJCQl9CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQljYXNlIFFSX01PREVfOEI6IHsKCQkJCQkkc2l6ZSA9IChpbnQpKCRwYXlsb2FkIC8gOCk7CgkJCQkJYnJlYWs7CgkJCQl9CgkJCQljYXNlIFFSX01PREVfS0o6IHsKCQkJCQkkc2l6ZSA9IChpbnQpKCgkcGF5bG9hZCAvIDEzKSAqIDIpOwoJCQkJCWJyZWFrOwoJCQkJfQoJCQkJY2FzZSBRUl9NT0RFX1NUOiB7CgkJCQkJJHNpemUgPSAoaW50KSgkcGF5bG9hZCAvIDgpOwoJCQkJCWJyZWFrOwoJCQkJfQoJCQkJZGVmYXVsdDogewoJCQkJCSRzaXplID0gMDsKCQkJCQlicmVhazsKCQkJCX0KCQkJfQoJCQkkbWF4c2l6ZSA9ICR0aGlzLT5tYXhpbXVtV29yZHMoJG1vZGUsICR2ZXJzaW9uKTsKCQkJaWYgKCRzaXplIDwgMCkgewoJCQkJJHNpemUgPSAwOwoJCQl9CgkJCWlmICgkc2l6ZSA+ICRtYXhzaXplKSB7CgkJCQkkc2l6ZSA9ICRtYXhzaXplOwoJCQl9CgkJCXJldHVybiAkc2l6ZTsKCQl9CgoJCS8qKgoJCSAqIGNyZWF0ZUJpdFN0cmVhbQoJCSAqIEBwYXJhbSBhcnJheSAkaXRlbXMKCQkgKiBAcmV0dXJuIGFycmF5IG9mIGl0ZW1zIGFuZCB0b3RhbCBiaXRzCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiBjcmVhdGVCaXRTdHJlYW0oJGl0ZW1zKSB7CgkJCSR0b3RhbCA9IDA7CgkJCWZvcmVhY2ggKCRpdGVtcyBhcyAka2V5ID0+ICRpdGVtKSB7CgkJCQkkaXRlbXNbJGtleV0gPSAkdGhpcy0+ZW5jb2RlQml0U3RyZWFtKCRpdGVtLCAkdGhpcy0+dmVyc2lvbik7CgkJCQkkYml0cyA9IGNvdW50KCRpdGVtc1ska2V5XVsnYnN0cmVhbSddKTsKCQkJCSR0b3RhbCArPSAkYml0czsKCQkJfQoJCQlyZXR1cm4gYXJyYXkoJGl0ZW1zLCAkdG90YWwpOwoJCX0KCgkJLyoqCgkJICogY29udmVydERhdGEKCQkgKiBAcGFyYW0gYXJyYXkgJGl0ZW1zCgkJICogQHJldHVybiBhcnJheSBpdGVtcwoJCSAqLwoJCSBwcm90ZWN0ZWQgZnVuY3Rpb24gY29udmVydERhdGEoJGl0ZW1zKSB7CgkJCSR2ZXIgPSAkdGhpcy0+ZXN0aW1hdGVWZXJzaW9uKCRpdGVtcyk7CgkJCWlmICgkdmVyID4gJHRoaXMtPnZlcnNpb24pIHsKCQkJCSR0aGlzLT52ZXJzaW9uID0gJHZlcjsKCQkJfQoJCQlmb3IgKDs7KSB7CgkJCQkkY2JzID0gJHRoaXMtPmNyZWF0ZUJpdFN0cmVhbSgkaXRlbXMpOwoJCQkJJGl0ZW1zID0gJGNic1swXTsKCQkJCSRiaXRzID0gJGNic1sxXTsKCQkJCWlmICgkYml0cyA8IDApIHsKCQkJCQlyZXR1cm4gLTE7CgkJCQl9CgkJCQkkdmVyID0gJHRoaXMtPmdldE1pbmltdW1WZXJzaW9uKChpbnQpKCgkYml0cyArIDcpIC8gOCksICR0aGlzLT5sZXZlbCk7CgkJCQlpZiAoJHZlciA8IDApIHsKCQkJCQlyZXR1cm4gLTE7CgkJCQl9IGVsc2VpZiAoJHZlciA+ICR0aGlzLT52ZXJzaW9uKSB7CgkJCQkJJHRoaXMtPnZlcnNpb24gPSAkdmVyOwoJCQkJfSBlbHNlIHsKCQkJCQlicmVhazsKCQkJCX0KCQkJfQoJCQlyZXR1cm4gJGl0ZW1zOwoJCX0KCgkJLyoqCgkJICogQXBwZW5kIFBhZGRpbmcgQml0IHRvIGJpdHN0cmVhbQoJCSAqIEBwYXJhbSBhcnJheSAkYnN0cmVhbQoJCSAqIEByZXR1cm4gYXJyYXkgYml0c3RyZWFtCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiBhcHBlbmRQYWRkaW5nQml0KCRic3RyZWFtKSB7CgkJCSRiaXRzID0gY291bnQoJGJzdHJlYW0pOwoJCQkkbWF4d29yZHMgPSAkdGhpcy0+Z2V0RGF0YUxlbmd0aCgkdGhpcy0+dmVyc2lvbiwgJHRoaXMtPmxldmVsKTsKCQkJJG1heGJpdHMgPSAkbWF4d29yZHMgKiA4OwoJCQlpZiAoJG1heGJpdHMgPT0gJGJpdHMpIHsKCQkJCXJldHVybiAwOwoJCQl9CgkJCWlmICgkbWF4Yml0cyAtICRiaXRzIDwgNSkgewoJCQkJcmV0dXJuICR0aGlzLT5hcHBlbmROdW0oJGJzdHJlYW0sICRtYXhiaXRzIC0gJGJpdHMsIDApOwoJCQl9CgkJCSRiaXRzICs9IDQ7CgkJCSR3b3JkcyA9IChpbnQpKCgkYml0cyArIDcpIC8gOCk7CgkJCSRwYWRkaW5nID0gYXJyYXkoKTsKCQkJJHBhZGRpbmcgPSAkdGhpcy0+YXBwZW5kTnVtKCRwYWRkaW5nLCAkd29yZHMgKiA4IC0gJGJpdHMgKyA0LCAwKTsKCQkJJHBhZGxlbiA9ICRtYXh3b3JkcyAtICR3b3JkczsKCQkJaWYgKCRwYWRsZW4gPiAwKSB7CgkJCQkkcGFkYnVmID0gYXJyYXkoKTsKCQkJCWZvciAoJGk9MDsgJGk8JHBhZGxlbjsgKyskaSkgewoJCQkJCSRwYWRidWZbJGldID0gKCRpJjEpPzB4MTE6MHhlYzsKCQkJCX0KCQkJCSRwYWRkaW5nID0gJHRoaXMtPmFwcGVuZEJ5dGVzKCRwYWRkaW5nLCAkcGFkbGVuLCAkcGFkYnVmKTsKCQkJfQoJCQlyZXR1cm4gJHRoaXMtPmFwcGVuZEJpdHN0cmVhbSgkYnN0cmVhbSwgJHBhZGRpbmcpOwoJCX0KCgkJLyoqCgkJICogbWVyZ2VCaXRTdHJlYW0KCQkgKiBAcGFyYW0gYXJyYXkgJGJzdHJlYW0KCQkgKiBAcmV0dXJuIGFycmF5IGJpdHN0cmVhbQoJCSAqLwoJCSBwcm90ZWN0ZWQgZnVuY3Rpb24gbWVyZ2VCaXRTdHJlYW0oJGl0ZW1zKSB7CgkJCSRpdGVtcyA9ICR0aGlzLT5jb252ZXJ0RGF0YSgkaXRlbXMpOwoJCQkkYnN0cmVhbSA9IGFycmF5KCk7CgkJCWZvcmVhY2ggKCRpdGVtcyBhcyAkaXRlbSkgewoJCQkJJGJzdHJlYW0gPSAkdGhpcy0+YXBwZW5kQml0c3RyZWFtKCRic3RyZWFtLCAkaXRlbVsnYnN0cmVhbSddKTsKCQkJfQoJCQlyZXR1cm4gJGJzdHJlYW07CgkJfQoKCQkvKioKCQkgKiBSZXR1cm5zIGEgc3RyZWFtIG9mIGJpdHMuCgkJICogQHBhcmFtIGludCAkaXRlbXMKCQkgKiBAcmV0dXJuIGFycmF5IHBhZGRlZCBtZXJnZWQgYnl0ZSBzdHJlYW0KCQkgKi8KCQlwcm90ZWN0ZWQgZnVuY3Rpb24gZ2V0Qml0U3RyZWFtKCRpdGVtcykgewoJCQkkYnN0cmVhbSA9ICR0aGlzLT5tZXJnZUJpdFN0cmVhbSgkaXRlbXMpOwoJCQlyZXR1cm4gJHRoaXMtPmFwcGVuZFBhZGRpbmdCaXQoJGJzdHJlYW0pOwoJCX0KCgkJLyoqCgkJICogUGFjayBhbGwgYml0IHN0cmVhbXMgcGFkZGluZyBiaXRzIGludG8gYSBieXRlIGFycmF5LgoJCSAqIEBwYXJhbSBpbnQgJGl0ZW1zCgkJICogQHJldHVybiBhcnJheSBwYWRkZWQgbWVyZ2VkIGJ5dGUgc3RyZWFtCgkJICovCgkJcHJvdGVjdGVkIGZ1bmN0aW9uIGdldEJ5dGVTdHJlYW0oJGl0ZW1zKSB7CgkJCSRic3RyZWFtID0gJHRoaXMtPmdldEJpdFN0cmVhbSgkaXRlbXMpOwoJCQlyZXR1cm4gJHRoaXMtPmJpdHN0cmVhbVRvQnl0ZSgkYnN0cmVhbSk7CgkJfQoKCQkvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtCgoJCS8vIFFSYml0c3RyZWFtCgoJCS8qKgoJCSAqIFJldHVybiBhbiBhcnJheSB3aXRoIHplcm9zCgkJICogQHBhcmFtIGludCAkc2V0TGVuZ3RoIGFycmF5IHNpemUKCQkgKiBAcmV0dXJuIGFycmF5CgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiBhbGxvY2F0ZSgkc2V0TGVuZ3RoKSB7CgkJCXJldHVybiBhcnJheV9maWxsKDAsICRzZXRMZW5ndGgsIDApOwoJCX0KCgkJLyoqCgkJICogUmV0dXJuIG5ldyBiaXRzdHJlYW0gZnJvbSBudW1iZXIKCQkgKiBAcGFyYW0gaW50ICRiaXRzIG51bWJlciBvZiBiaXRzCgkJICogQHBhcmFtIGludCAkbnVtIG51bWJlcgoJCSAqIEByZXR1cm4gYXJyYXkgYml0c3RyZWFtCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiBuZXdGcm9tTnVtKCRiaXRzLCAkbnVtKSB7CgkJCSRic3RyZWFtID0gJHRoaXMtPmFsbG9jYXRlKCRiaXRzKTsKCQkJJG1hc2sgPSAxIDw8ICgkYml0cyAtIDEpOwoJCQlmb3IgKCRpPTA7ICRpPCRiaXRzOyArKyRpKSB7CgkJCQlpZiAoJG51bSAmICRtYXNrKSB7CgkJCQkJJGJzdHJlYW1bJGldID0gMTsKCQkJCX0gZWxzZSB7CgkJCQkJJGJzdHJlYW1bJGldID0gMDsKCQkJCX0KCQkJCSRtYXNrID0gJG1hc2sgPj4gMTsKCQkJfQoJCQlyZXR1cm4gJGJzdHJlYW07CgkJfQoKCQkvKioKCQkgKiBSZXR1cm4gbmV3IGJpdHN0cmVhbSBmcm9tIGJ5dGVzCgkJICogQHBhcmFtIGludCAkc2l6ZSBzaXplCgkJICogQHBhcmFtIGFycmF5ICRkYXRhIGJ5dGVzCgkJICogQHJldHVybiBhcnJheSBiaXRzdHJlYW0KCQkgKi8KCQkgcHJvdGVjdGVkIGZ1bmN0aW9uIG5ld0Zyb21CeXRlcygkc2l6ZSwgJGRhdGEpIHsKCQkJJGJzdHJlYW0gPSAkdGhpcy0+YWxsb2NhdGUoJHNpemUgKiA4KTsKCQkJJHA9MDsKCQkJZm9yICgkaT0wOyAkaTwkc2l6ZTsgKyskaSkgewoJCQkJJG1hc2sgPSAweDgwOwoJCQkJZm9yICgkaj0wOyAkajw4OyArKyRqKSB7CgkJCQkJaWYgKCRkYXRhWyRpXSAmICRtYXNrKSB7CgkJCQkJCSRic3RyZWFtWyRwXSA9IDE7CgkJCQkJfSBlbHNlIHsKCQkJCQkJJGJzdHJlYW1bJHBdID0gMDsKCQkJCQl9CgkJCQkJJHArKzsKCQkJCQkkbWFzayA9ICRtYXNrID4+IDE7CgkJCQl9CgkJCX0KCQkJcmV0dXJuICRic3RyZWFtOwoJCX0KCgkJLyoqCgkJICogQXBwZW5kIG9uZSBiaXRzdHJlYW0gdG8gYW5vdGhlcgoJCSAqIEBwYXJhbSBhcnJheSAkYml0c3RyZWFtIG9yaWdpbmFsIGJpdHN0cmVhbQoJCSAqIEBwYXJhbSBhcnJheSAkYXBwZW5kIGJpdHN0cmVhbSB0byBhcHBlbmQKCQkgKiBAcmV0dXJuIGFycmF5IGJpdHN0cmVhbQoJCSAqLwoJCSBwcm90ZWN0ZWQgZnVuY3Rpb24gYXBwZW5kQml0c3RyZWFtKCRiaXRzdHJlYW0sICRhcHBlbmQpIHsKCQkJaWYgKCghaXNfYXJyYXkoJGFwcGVuZCkpIE9SIChjb3VudCgkYXBwZW5kKSA9PSAwKSkgewoJCQkJcmV0dXJuICRiaXRzdHJlYW07CgkJCX0KCQkJaWYgKGNvdW50KCRiaXRzdHJlYW0pID09IDApIHsKCQkJCXJldHVybiAkYXBwZW5kOwoJCQl9CgkJCXJldHVybiBhcnJheV92YWx1ZXMoYXJyYXlfbWVyZ2UoJGJpdHN0cmVhbSwgJGFwcGVuZCkpOwoJCX0KCgkJLyoqCgkJICogQXBwZW5kIG9uZSBiaXRzdHJlYW0gY3JlYXRlZCBmcm9tIG51bWJlciB0byBhbm90aGVyCgkJICogQHBhcmFtIGFycmF5ICRiaXRzdHJlYW0gb3JpZ2luYWwgYml0c3RyZWFtCgkJICogQHBhcmFtIGludCAkYml0cyBudW1iZXIgb2YgYml0cwoJCSAqIEBwYXJhbSBpbnQgJG51bSBudW1iZXIKCQkgKiBAcmV0dXJuIGFycmF5IGJpdHN0cmVhbQoJCSAqLwoJCSBwcm90ZWN0ZWQgZnVuY3Rpb24gYXBwZW5kTnVtKCRiaXRzdHJlYW0sICRiaXRzLCAkbnVtKSB7CgkJCWlmICgkYml0cyA9PSAwKSB7CgkJCQlyZXR1cm4gMDsKCQkJfQoJCQkkYiA9ICR0aGlzLT5uZXdGcm9tTnVtKCRiaXRzLCAkbnVtKTsKCQkJcmV0dXJuICR0aGlzLT5hcHBlbmRCaXRzdHJlYW0oJGJpdHN0cmVhbSwgJGIpOwoJCX0KCgkJLyoqCgkJICogQXBwZW5kIG9uZSBiaXRzdHJlYW0gY3JlYXRlZCBmcm9tIGJ5dGVzIHRvIGFub3RoZXIKCQkgKiBAcGFyYW0gYXJyYXkgJGJpdHN0cmVhbSBvcmlnaW5hbCBiaXRzdHJlYW0KCQkgKiBAcGFyYW0gaW50ICRzaXplIHNpemUKCQkgKiBAcGFyYW0gYXJyYXkgJGRhdGEgYnl0ZXMKCQkgKiBAcmV0dXJuIGFycmF5IGJpdHN0cmVhbQoJCSAqLwoJCSBwcm90ZWN0ZWQgZnVuY3Rpb24gYXBwZW5kQnl0ZXMoJGJpdHN0cmVhbSwgJHNpemUsICRkYXRhKSB7CgkJCWlmICgkc2l6ZSA9PSAwKSB7CgkJCQlyZXR1cm4gMDsKCQkJfQoJCQkkYiA9ICR0aGlzLT5uZXdGcm9tQnl0ZXMoJHNpemUsICRkYXRhKTsKCQkJcmV0dXJuICR0aGlzLT5hcHBlbmRCaXRzdHJlYW0oJGJpdHN0cmVhbSwgJGIpOwoJCX0KCgkJLyoqCgkJICogQ29udmVydCBiaXRzdHJlYW0gdG8gYnl0ZXMKCQkgKiBAcGFyYW0gYXJyYXkgJGJpdHN0cmVhbSBvcmlnaW5hbCBiaXRzdHJlYW0KCQkgKiBAcmV0dXJuIGFycmF5IG9mIGJ5dGVzCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiBiaXRzdHJlYW1Ub0J5dGUoJGJzdHJlYW0pIHsKCQkJJHNpemUgPSBjb3VudCgkYnN0cmVhbSk7CgkJCWlmICgkc2l6ZSA9PSAwKSB7CgkJCQlyZXR1cm4gYXJyYXkoKTsKCQkJfQoJCQkkZGF0YSA9IGFycmF5X2ZpbGwoMCwgKGludCkoKCRzaXplICsgNykgLyA4KSwgMCk7CgkJCSRieXRlcyA9IChpbnQpKCRzaXplIC8gOCk7CgkJCSRwID0gMDsKCQkJZm9yICgkaT0wOyAkaTwkYnl0ZXM7ICRpKyspIHsKCQkJCSR2ID0gMDsKCQkJCWZvciAoJGo9MDsgJGo8ODsgJGorKykgewoJCQkJCSR2ID0gJHYgPDwgMTsKCQkJCQkkdiB8PSAkYnN0cmVhbVskcF07CgkJCQkJJHArKzsKCQkJCX0KCQkJCSRkYXRhWyRpXSA9ICR2OwoJCQl9CgkJCWlmICgkc2l6ZSAmIDcpIHsKCQkJCSR2ID0gMDsKCQkJCWZvciAoJGo9MDsgJGo8KCRzaXplICYgNyk7ICRqKyspIHsKCQkJCQkkdiA9ICR2IDw8IDE7CgkJCQkJJHYgfD0gJGJzdHJlYW1bJHBdOwoJCQkJCSRwKys7CgkJCQl9CgkJCQkkZGF0YVskYnl0ZXNdID0gJHY7CgkJCX0KCQkJcmV0dXJuICRkYXRhOwoJCX0KCgkJLy8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLQoKCQkvLyBRUnNwZWMKCgkJLyoqCgkJICogUmVwbGFjZSBhIHZhbHVlIG9uIHRoZSBhcnJheSBhdCB0aGUgc3BlY2lmaWVkIHBvc2l0aW9uCgkJICogQHBhcmFtIGFycmF5ICRzcmN0YWIKCQkgKiBAcGFyYW0gaW50ICR4IFggcG9zaXRpb24KCQkgKiBAcGFyYW0gaW50ICR5IFkgcG9zaXRpb24KCQkgKiBAcGFyYW0gc3RyaW5nICRyZXBsIHZhbHVlIHRvIHJlcGxhY2UKCQkgKiBAcGFyYW0gaW50ICRyZXBsTGVuIGxlbmd0aCBvZiB0aGUgcmVwbCBzdHJpbmcKCQkgKiBAcmV0dXJuIGFycmF5IHNyY3RhYgoJCSAqLwoJCSBwcm90ZWN0ZWQgZnVuY3Rpb24gcXJzdHJzZXQoJHNyY3RhYiwgJHgsICR5LCAkcmVwbCwgJHJlcGxMZW49ZmFsc2UpIHsKCQkJJHNyY3RhYlskeV0gPSBzdWJzdHJfcmVwbGFjZSgkc3JjdGFiWyR5XSwgKCRyZXBsTGVuICE9PSBmYWxzZSk\/c3Vic3RyKCRyZXBsLDAsJHJlcGxMZW4pOiRyZXBsLCAkeCwgKCRyZXBsTGVuICE9PSBmYWxzZSk\/JHJlcGxMZW46c3RybGVuKCRyZXBsKSk7CgkJCXJldHVybiAkc3JjdGFiOwoJCX0KCgkJLyoqCgkJICogUmV0dXJuIG1heGltdW0gZGF0YSBjb2RlIGxlbmd0aCAoYnl0ZXMpIGZvciB0aGUgdmVyc2lvbi4KCQkgKiBAcGFyYW0gaW50ICR2ZXJzaW9uIHZlcnNpb24KCQkgKiBAcGFyYW0gaW50ICRsZXZlbCBlcnJvciBjb3JyZWN0aW9uIGxldmVsCgkJICogQHJldHVybiBpbnQgbWF4aW11bSBzaXplIChieXRlcykKCQkgKi8KCQlwcm90ZWN0ZWQgZnVuY3Rpb24gZ2V0RGF0YUxlbmd0aCgkdmVyc2lvbiwgJGxldmVsKSB7CgkJCXJldHVybiAkdGhpcy0+Y2FwYWNpdHlbJHZlcnNpb25dW1FSQ0FQX1dPUkRTXSAtICR0aGlzLT5jYXBhY2l0eVskdmVyc2lvbl1bUVJDQVBfRUNdWyRsZXZlbF07CgkJfQoKCQkvKioKCQkgKiBSZXR1cm4gbWF4aW11bSBlcnJvciBjb3JyZWN0aW9uIGNvZGUgbGVuZ3RoIChieXRlcykgZm9yIHRoZSB2ZXJzaW9uLgoJCSAqIEBwYXJhbSBpbnQgJHZlcnNpb24gdmVyc2lvbgoJCSAqIEBwYXJhbSBpbnQgJGxldmVsIGVycm9yIGNvcnJlY3Rpb24gbGV2ZWwKCQkgKiBAcmV0dXJuIGludCBFQ0Mgc2l6ZSAoYnl0ZXMpCgkJICovCgkJcHJvdGVjdGVkIGZ1bmN0aW9uIGdldEVDQ0xlbmd0aCgkdmVyc2lvbiwgJGxldmVsKXsKCQkJcmV0dXJuICR0aGlzLT5jYXBhY2l0eVskdmVyc2lvbl1bUVJDQVBfRUNdWyRsZXZlbF07CgkJfQoKCQkvKioKCQkgKiBSZXR1cm4gdGhlIHdpZHRoIG9mIHRoZSBzeW1ib2wgZm9yIHRoZSB2ZXJzaW9uLgoJCSAqIEBwYXJhbSBpbnQgJHZlcnNpb24gdmVyc2lvbgoJCSAqIEByZXR1cm4gaW50IHdpZHRoCgkJICovCgkJcHJvdGVjdGVkIGZ1bmN0aW9uIGdldFdpZHRoKCR2ZXJzaW9uKSB7CgkJCXJldHVybiAkdGhpcy0+Y2FwYWNpdHlbJHZlcnNpb25dW1FSQ0FQX1dJRFRIXTsKCQl9CgoJCS8qKgoJCSAqIFJldHVybiB0aGUgbnVtZXIgb2YgcmVtYWluZGVyIGJpdHMuCgkJICogQHBhcmFtIGludCAkdmVyc2lvbiB2ZXJzaW9uCgkJICogQHJldHVybiBpbnQgbnVtYmVyIG9mIHJlbWFpbmRlciBiaXRzCgkJICovCgkJcHJvdGVjdGVkIGZ1bmN0aW9uIGdldFJlbWFpbmRlcigkdmVyc2lvbikgewoJCQlyZXR1cm4gJHRoaXMtPmNhcGFjaXR5WyR2ZXJzaW9uXVtRUkNBUF9SRU1JTkRFUl07CgkJfQoKCQkvKioKCQkgKiBSZXR1cm4gYSB2ZXJzaW9uIG51bWJlciB0aGF0IHNhdGlzZmllcyB0aGUgaW5wdXQgY29kZSBsZW5ndGguCgkJICogQHBhcmFtIGludCAkc2l6ZSBpbnB1dCBjb2RlIGxlbmd0aCAoYnl0ZSkKCQkgKiBAcGFyYW0gaW50ICRsZXZlbCBlcnJvciBjb3JyZWN0aW9uIGxldmVsCgkJICogQHJldHVybiBpbnQgdmVyc2lvbiBudW1iZXIKCQkgKi8KCQlwcm90ZWN0ZWQgZnVuY3Rpb24gZ2V0TWluaW11bVZlcnNpb24oJHNpemUsICRsZXZlbCkgewoJCQlmb3IgKCRpPTE7ICRpIDw9IFFSU1BFQ19WRVJTSU9OX01BWDsgKyskaSkgewoJCQkJJHdvcmRzICA9ICR0aGlzLT5jYXBhY2l0eVskaV1bUVJDQVBfV09SRFNdIC0gJHRoaXMtPmNhcGFjaXR5WyRpXVtRUkNBUF9FQ11bJGxldmVsXTsKCQkJCWlmICgkd29yZHMgPj0gJHNpemUpIHsKCQkJCQlyZXR1cm4gJGk7CgkJCQl9CgkJCX0KCQkJcmV0dXJuIC0xOwoJCX0KCgkJLyoqCgkJICogUmV0dXJuIHRoZSBzaXplIG9mIGxlbmd0aCBpbmRpY2F0b3IgZm9yIHRoZSBtb2RlIGFuZCB2ZXJzaW9uLgoJCSAqIEBwYXJhbSBpbnQgJG1vZGUgZW5jb2RpbmcgbW9kZQoJCSAqIEBwYXJhbSBpbnQgJHZlcnNpb24gdmVyc2lvbgoJCSAqIEByZXR1cm4gaW50IHRoZSBzaXplIG9mIHRoZSBhcHByb3ByaWF0ZSBsZW5ndGggaW5kaWNhdG9yIChiaXRzKS4KCQkgKi8KCQlwcm90ZWN0ZWQgZnVuY3Rpb24gbGVuZ3RoSW5kaWNhdG9yKCRtb2RlLCAkdmVyc2lvbikgewoJCQlpZiAoJG1vZGUgPT0gUVJfTU9ERV9TVCkgewoJCQkJcmV0dXJuIDA7CgkJCX0KCQkJaWYgKCR2ZXJzaW9uIDw9IDkpIHsKCQkJCSRsID0gMDsKCQkJfSBlbHNlaWYgKCR2ZXJzaW9uIDw9IDI2KSB7CgkJCQkkbCA9IDE7CgkJCX0gZWxzZSB7CgkJCQkkbCA9IDI7CgkJCX0KCQkJcmV0dXJuICR0aGlzLT5sZW5ndGhUYWJsZUJpdHNbJG1vZGVdWyRsXTsKCQl9CgoJCS8qKgoJCSAqIFJldHVybiB0aGUgbWF4aW11bSBsZW5ndGggZm9yIHRoZSBtb2RlIGFuZCB2ZXJzaW9uLgoJCSAqIEBwYXJhbSBpbnQgJG1vZGUgZW5jb2RpbmcgbW9kZQoJCSAqIEBwYXJhbSBpbnQgJHZlcnNpb24gdmVyc2lvbgoJCSAqIEByZXR1cm4gaW50IHRoZSBtYXhpbXVtIGxlbmd0aCAoYnl0ZXMpCgkJICovCgkJcHJvdGVjdGVkIGZ1bmN0aW9uIG1heGltdW1Xb3JkcygkbW9kZSwgJHZlcnNpb24pIHsKCQkJaWYgKCRtb2RlID09IFFSX01PREVfU1QpIHsKCQkJCXJldHVybiAzOwoJCQl9CgkJCWlmICgkdmVyc2lvbiA8PSA5KSB7CgkJCQkkbCA9IDA7CgkJCX0gZWxzZSBpZiAoJHZlcnNpb24gPD0gMjYpIHsKCQkJCSRsID0gMTsKCQkJfSBlbHNlIHsKCQkJCSRsID0gMjsKCQkJfQoJCQkkYml0cyA9ICR0aGlzLT5sZW5ndGhUYWJsZUJpdHNbJG1vZGVdWyRsXTsKCQkJJHdvcmRzID0gKDEgPDwgJGJpdHMpIC0gMTsKCQkJaWYgKCRtb2RlID09IFFSX01PREVfS0opIHsKCQkJCSR3b3JkcyAqPSAyOyAvLyB0aGUgbnVtYmVyIG9mIGJ5dGVzIGlzIHJlcXVpcmVkCgkJCX0KCQkJcmV0dXJuICR3b3JkczsKCQl9CgoJCS8qKgoJCSAqIFJldHVybiBhbiBhcnJheSBvZiBFQ0Mgc3BlY2lmaWNhdGlvbi4KCQkgKiBAcGFyYW0gaW50ICR2ZXJzaW9uIHZlcnNpb24KCQkgKiBAcGFyYW0gaW50ICRsZXZlbCBlcnJvciBjb3JyZWN0aW9uIGxldmVsCgkJICogQHBhcmFtIGFycmF5ICRzcGVjIGFuIGFycmF5IG9mIEVDQyBzcGVjaWZpY2F0aW9uIGNvbnRhaW5zIGFzIGZvbGxvd2luZzogeyMgb2YgdHlwZTEgYmxvY2tzLCAjIG9mIGRhdGEgY29kZSwgIyBvZiBlY2MgY29kZSwgIyBvZiB0eXBlMiBibG9ja3MsICMgb2YgZGF0YSBjb2RlfQoJCSAqIEByZXR1cm4gYXJyYXkgc3BlYwoJCSAqLwoJCXByb3RlY3RlZCBmdW5jdGlvbiBnZXRFY2NTcGVjKCR2ZXJzaW9uLCAkbGV2ZWwsICRzcGVjKSB7CgkJCWlmIChjb3VudCgkc3BlYykgPCA1KSB7CgkJCQkkc3BlYyA9IGFycmF5KDAsIDAsIDAsIDAsIDApOwoJCQl9CgkJCSRiMSA9ICR0aGlzLT5lY2NUYWJsZVskdmVyc2lvbl1bJGxldmVsXVswXTsKCQkJJGIyID0gJHRoaXMtPmVjY1RhYmxlWyR2ZXJzaW9uXVskbGV2ZWxdWzFdOwoJCQkkZGF0YSA9ICR0aGlzLT5nZXREYXRhTGVuZ3RoKCR2ZXJzaW9uLCAkbGV2ZWwpOwoJCQkkZWNjID0gJHRoaXMtPmdldEVDQ0xlbmd0aCgkdmVyc2lvbiwgJGxldmVsKTsKCQkJaWYgKCRiMiA9PSAwKSB7CgkJCQkkc3BlY1swXSA9ICRiMTsKCQkJCSRzcGVjWzFdID0gKGludCkoJGRhdGEgLyAkYjEpOwoJCQkJJHNwZWNbMl0gPSAoaW50KSgkZWNjIC8gJGIxKTsKCQkJCSRzcGVjWzNdID0gMDsKCQkJCSRzcGVjWzRdID0gMDsKCQkJfSBlbHNlIHsKCQkJCSRzcGVjWzBdID0gJGIxOwoJCQkJJHNwZWNbMV0gPSAoaW50KSgkZGF0YSAvICgkYjEgKyAkYjIpKTsKCQkJCSRzcGVjWzJdID0gKGludCkoJGVjYyAgLyAoJGIxICsgJGIyKSk7CgkJCQkkc3BlY1szXSA9ICRiMjsKCQkJCSRzcGVjWzRdID0gJHNwZWNbMV0gKyAxOwoJCQl9CgkJCXJldHVybiAkc3BlYzsKCQl9CgoJCS8qKgoJCSAqIFB1dCBhbiBhbGlnbm1lbnQgbWFya2VyLgoJCSAqIEBwYXJhbSBhcnJheSAkZnJhbWUgZnJhbWUKCQkgKiBAcGFyYW0gaW50ICR3aWR0aCB3aWR0aAoJCSAqIEBwYXJhbSBpbnQgJG94IFggY2VudGVyIGNvb3JkaW5hdGUgb2YgdGhlIHBhdHRlcm4KCQkgKiBAcGFyYW0gaW50ICRveSBZIGNlbnRlciBjb29yZGluYXRlIG9mIHRoZSBwYXR0ZXJuCgkJICogQHJldHVybiBhcnJheSBmcmFtZQoJCSAqLwoJCXByb3RlY3RlZCBmdW5jdGlvbiBwdXRBbGlnbm1lbnRNYXJrZXIoJGZyYW1lLCAkb3gsICRveSkgewoJCQkkZmluZGVyID0gYXJyYXkoCgkJCQkiXHhhMVx4YTFceGExXHhhMVx4YTEiLAoJCQkJIlx4YTFceGEwXHhhMFx4YTBceGExIiwKCQkJCSJceGExXHhhMFx4YTFceGEwXHhhMSIsCgkJCQkiXHhhMVx4YTBceGEwXHhhMFx4YTEiLAoJCQkJIlx4YTFceGExXHhhMVx4YTFceGExIgoJCQkJKTsKCQkJJHlTdGFydCA9ICRveSAtIDI7CgkJCSR4U3RhcnQgPSAkb3ggLSAyOwoJCQlmb3IgKCR5PTA7ICR5IDwgNTsgJHkrKykgewoJCQkJJGZyYW1lID0gJHRoaXMtPnFyc3Ryc2V0KCRmcmFtZSwgJHhTdGFydCwgJHlTdGFydCskeSwgJGZpbmRlclskeV0pOwoJCQl9CgkJCXJldHVybiAkZnJhbWU7CgkJfQoKCQkvKioKCQkgKiBQdXQgYW4gYWxpZ25tZW50IHBhdHRlcm4uCgkJICogQHBhcmFtIGludCAkdmVyc2lvbiB2ZXJzaW9uCgkJICogQHBhcmFtIGFycmF5ICRmcmFtIGZyYW1lCgkJICogQHBhcmFtIGludCAkd2lkdGggd2lkdGgKCQkgKiBAcmV0dXJuIGFycmF5IGZyYW1lCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiBwdXRBbGlnbm1lbnRQYXR0ZXJuKCR2ZXJzaW9uLCAkZnJhbWUsICR3aWR0aCkgewoJCQlpZiAoJHZlcnNpb24gPCAyKSB7CgkJCQlyZXR1cm4gJGZyYW1lOwoJCQl9CgkJCSRkID0gJHRoaXMtPmFsaWdubWVudFBhdHRlcm5bJHZlcnNpb25dWzFdIC0gJHRoaXMtPmFsaWdubWVudFBhdHRlcm5bJHZlcnNpb25dWzBdOwoJCQlpZiAoJGQgPCAwKSB7CgkJCQkkdyA9IDI7CgkJCX0gZWxzZSB7CgkJCQkkdyA9IChpbnQpKCgkd2lkdGggLSAkdGhpcy0+YWxpZ25tZW50UGF0dGVyblskdmVyc2lvbl1bMF0pIC8gJGQgKyAyKTsKCQkJfQoJCQlpZiAoJHcgKiAkdyAtIDMgPT0gMSkgewoJCQkJJHggPSAkdGhpcy0+YWxpZ25tZW50UGF0dGVyblskdmVyc2lvbl1bMF07CgkJCQkkeSA9ICR0aGlzLT5hbGlnbm1lbnRQYXR0ZXJuWyR2ZXJzaW9uXVswXTsKCQkJCSRmcmFtZSA9ICR0aGlzLT5wdXRBbGlnbm1lbnRNYXJrZXIoJGZyYW1lLCAkeCwgJHkpOwoJCQkJcmV0dXJuICRmcmFtZTsKCQkJfQoJCQkkY3ggPSAkdGhpcy0+YWxpZ25tZW50UGF0dGVyblskdmVyc2lvbl1bMF07CgkJCSR3byA9ICR3IC0gMTsKCQkJZm9yICgkeD0xOyAkeCA8ICR3bzsgKyskeCkgewoJCQkJJGZyYW1lID0gJHRoaXMtPnB1dEFsaWdubWVudE1hcmtlcigkZnJhbWUsIDYsICRjeCk7CgkJCQkkZnJhbWUgPSAkdGhpcy0+cHV0QWxpZ25tZW50TWFya2VyKCRmcmFtZSwgJGN4LCAgNik7CgkJCQkkY3ggKz0gJGQ7CgkJCX0KCQkJJGN5ID0gJHRoaXMtPmFsaWdubWVudFBhdHRlcm5bJHZlcnNpb25dWzBdOwoJCQlmb3IgKCR5PTA7ICR5IDwgJHdvOyArKyR5KSB7CgkJCQkkY3ggPSAkdGhpcy0+YWxpZ25tZW50UGF0dGVyblskdmVyc2lvbl1bMF07CgkJCQlmb3IgKCR4PTA7ICR4IDwgJHdvOyArKyR4KSB7CgkJCQkJJGZyYW1lID0gJHRoaXMtPnB1dEFsaWdubWVudE1hcmtlcigkZnJhbWUsICRjeCwgJGN5KTsKCQkJCQkkY3ggKz0gJGQ7CgkJCQl9CgkJCQkkY3kgKz0gJGQ7CgkJCX0KCQkJcmV0dXJuICRmcmFtZTsKCQl9CgoJCS8qKgoJCSAqIFJldHVybiBCQ0ggZW5jb2RlZCB2ZXJzaW9uIGluZm9ybWF0aW9uIHBhdHRlcm4gdGhhdCBpcyB1c2VkIGZvciB0aGUgc3ltYm9sIG9mIHZlcnNpb24gNyBvciBncmVhdGVyLiBVc2UgbG93ZXIgMTggYml0cy4KCQkgKiBAcGFyYW0gaW50ICR2ZXJzaW9uIHZlcnNpb24KCQkgKiBAcmV0dXJuIEJDSCBlbmNvZGVkIHZlcnNpb24gaW5mb3JtYXRpb24gcGF0dGVybgoJCSAqLwoJCXByb3RlY3RlZCBmdW5jdGlvbiBnZXRWZXJzaW9uUGF0dGVybigkdmVyc2lvbikgewoJCQlpZiAoKCR2ZXJzaW9uIDwgNykgT1IgKCR2ZXJzaW9uID4gUVJTUEVDX1ZFUlNJT05fTUFYKSkgewoJCQkJcmV0dXJuIDA7CgkJCX0KCQkJcmV0dXJuICR0aGlzLT52ZXJzaW9uUGF0dGVyblsoJHZlcnNpb24gLSA3KV07CgkJfQoKCQkvKioKCQkgKiBSZXR1cm4gQkNIIGVuY29kZWQgZm9ybWF0IGluZm9ybWF0aW9uIHBhdHRlcm4uCgkJICogQHBhcmFtIGFycmF5ICRtYXNrCgkJICogQHBhcmFtIGludCAkbGV2ZWwgZXJyb3IgY29ycmVjdGlvbiBsZXZlbAoJCSAqIEByZXR1cm4gQkNIIGVuY29kZWQgZm9ybWF0IGluZm9ybWF0aW9uIHBhdHRlcm4KCQkgKi8KCQlwcm90ZWN0ZWQgZnVuY3Rpb24gZ2V0Rm9ybWF0SW5mbygkbWFzaywgJGxldmVsKSB7CgkJCWlmICgoJG1hc2sgPCAwKSBPUiAoJG1hc2sgPiA3KSkgewoJCQkJcmV0dXJuIDA7CgkJCX0KCQkJaWYgKCgkbGV2ZWwgPCAwKSBPUiAoJGxldmVsID4gMykpIHsKCQkJCXJldHVybiAwOwoJCQl9CgkJCXJldHVybiAkdGhpcy0+Zm9ybWF0SW5mb1skbGV2ZWxdWyRtYXNrXTsKCQl9CgoJCS8qKgoJCSAqIFB1dCBhIGZpbmRlciBwYXR0ZXJuLgoJCSAqIEBwYXJhbSBhcnJheSAkZnJhbWUgZnJhbWUKCQkgKiBAcGFyYW0gaW50ICR3aWR0aCB3aWR0aAoJCSAqIEBwYXJhbSBpbnQgJG94IFggY2VudGVyIGNvb3JkaW5hdGUgb2YgdGhlIHBhdHRlcm4KCQkgKiBAcGFyYW0gaW50ICRveSBZIGNlbnRlciBjb29yZGluYXRlIG9mIHRoZSBwYXR0ZXJuCgkJICogQHJldHVybiBhcnJheSBmcmFtZQoJCSAqLwoJCXByb3RlY3RlZCBmdW5jdGlvbiBwdXRGaW5kZXJQYXR0ZXJuKCRmcmFtZSwgJG94LCAkb3kpIHsKCQkJJGZpbmRlciA9IGFycmF5KAoJCQkiXHhjMVx4YzFceGMxXHhjMVx4YzFceGMxXHhjMSIsCgkJCSJceGMxXHhjMFx4YzBceGMwXHhjMFx4YzBceGMxIiwKCQkJIlx4YzFceGMwXHhjMVx4YzFceGMxXHhjMFx4YzEiLAoJCQkiXHhjMVx4YzBceGMxXHhjMVx4YzFceGMwXHhjMSIsCgkJCSJceGMxXHhjMFx4YzFceGMxXHhjMVx4YzBceGMxIiwKCQkJIlx4YzFceGMwXHhjMFx4YzBceGMwXHhjMFx4YzEiLAoJCQkiXHhjMVx4YzFceGMxXHhjMVx4YzFceGMxXHhjMSIKCQkJKTsKCQkJZm9yICgkeT0wOyAkeSA8IDc7ICR5KyspIHsKCQkJCSRmcmFtZSA9ICR0aGlzLT5xcnN0cnNldCgkZnJhbWUsICRveCwgKCRveSArICR5KSwgJGZpbmRlclskeV0pOwoJCQl9CgkJCXJldHVybiAkZnJhbWU7CgkJfQoKCQkvKioKCQkgKiBSZXR1cm4gYSBjb3B5IG9mIGluaXRpYWxpemVkIGZyYW1lLgoJCSAqIEBwYXJhbSBpbnQgJHZlcnNpb24gdmVyc2lvbgoJCSAqIEByZXR1cm4gQXJyYXkgb2YgdW5zaWduZWQgY2hhci4KCQkgKi8KCQlwcm90ZWN0ZWQgZnVuY3Rpb24gY3JlYXRlRnJhbWUoJHZlcnNpb24pIHsKCQkJJHdpZHRoID0gJHRoaXMtPmNhcGFjaXR5WyR2ZXJzaW9uXVtRUkNBUF9XSURUSF07CgkJCSRmcmFtZUxpbmUgPSBzdHJfcmVwZWF0ICgiXDAiLCAkd2lkdGgpOwoJCQkkZnJhbWUgPSBhcnJheV9maWxsKDAsICR3aWR0aCwgJGZyYW1lTGluZSk7CgkJCS8vIEZpbmRlciBwYXR0ZXJuCgkJCSRmcmFtZSA9ICR0aGlzLT5wdXRGaW5kZXJQYXR0ZXJuKCRmcmFtZSwgMCwgMCk7CgkJCSRmcmFtZSA9ICR0aGlzLT5wdXRGaW5kZXJQYXR0ZXJuKCRmcmFtZSwgJHdpZHRoIC0gNywgMCk7CgkJCSRmcmFtZSA9ICR0aGlzLT5wdXRGaW5kZXJQYXR0ZXJuKCRmcmFtZSwgMCwgJHdpZHRoIC0gNyk7CgkJCS8vIFNlcGFyYXRvcgoJCQkkeU9mZnNldCA9ICR3aWR0aCAtIDc7CgkJCWZvciAoJHk9MDsgJHkgPCA3OyArKyR5KSB7CgkJCQkkZnJhbWVbJHldWzddID0gIlx4YzAiOwoJCQkJJGZyYW1lWyR5XVskd2lkdGggLSA4XSA9ICJceGMwIjsKCQkJCSRmcmFtZVskeU9mZnNldF1bN10gPSAiXHhjMCI7CgkJCQkrKyR5T2Zmc2V0OwoJCQl9CgkJCSRzZXRQYXR0ZXJuID0gc3RyX3JlcGVhdCgiXHhjMCIsIDgpOwoJCQkkZnJhbWUgPSAkdGhpcy0+cXJzdHJzZXQoJGZyYW1lLCAwLCA3LCAkc2V0UGF0dGVybik7CgkJCSRmcmFtZSA9ICR0aGlzLT5xcnN0cnNldCgkZnJhbWUsICR3aWR0aC04LCA3LCAkc2V0UGF0dGVybik7CgkJCSRmcmFtZSA9ICR0aGlzLT5xcnN0cnNldCgkZnJhbWUsIDAsICR3aWR0aCAtIDgsICRzZXRQYXR0ZXJuKTsKCQkJLy8gRm9ybWF0IGluZm8KCQkJJHNldFBhdHRlcm4gPSBzdHJfcmVwZWF0KCJceDg0IiwgOSk7CgkJCSRmcmFtZSA9ICR0aGlzLT5xcnN0cnNldCgkZnJhbWUsIDAsIDgsICRzZXRQYXR0ZXJuKTsKCQkJJGZyYW1lID0gJHRoaXMtPnFyc3Ryc2V0KCRmcmFtZSwgJHdpZHRoIC0gOCwgOCwgJHNldFBhdHRlcm4sIDgpOwoJCQkkeU9mZnNldCA9ICR3aWR0aCAtIDg7CgkJCWZvciAoJHk9MDsgJHkgPCA4OyArKyR5LCsrJHlPZmZzZXQpIHsKCQkJCSRmcmFtZVskeV1bOF0gPSAiXHg4NCI7CgkJCQkkZnJhbWVbJHlPZmZzZXRdWzhdID0gIlx4ODQiOwoJCQl9CgkJCS8vIFRpbWluZyBwYXR0ZXJuCgkJCSR3byA9ICR3aWR0aCAtIDE1OwoJCQlmb3IgKCRpPTE7ICRpIDwgJHdvOyArKyRpKSB7CgkJCQkkZnJhbWVbNl1bNyskaV0gPSBjaHIoMHg5MCB8ICgkaSAmIDEpKTsKCQkJCSRmcmFtZVs3KyRpXVs2XSA9IGNocigweDkwIHwgKCRpICYgMSkpOwoJCQl9CgkJCS8vIEFsaWdubWVudCBwYXR0ZXJuCgkJCSRmcmFtZSA9ICR0aGlzLT5wdXRBbGlnbm1lbnRQYXR0ZXJuKCR2ZXJzaW9uLCAkZnJhbWUsICR3aWR0aCk7CgkJCS8vIFZlcnNpb24gaW5mb3JtYXRpb24KCQkJaWYgKCR2ZXJzaW9uID49IDcpIHsKCQkJCSR2aW5mID0gJHRoaXMtPmdldFZlcnNpb25QYXR0ZXJuKCR2ZXJzaW9uKTsKCQkJCSR2ID0gJHZpbmY7CgkJCQlmb3IgKCR4PTA7ICR4PDY7ICsrJHgpIHsKCQkJCQlmb3IgKCR5PTA7ICR5PDM7ICsrJHkpIHsKCQkJCQkJJGZyYW1lWygkd2lkdGggLSAxMSkrJHldWyR4XSA9IGNocigweDg4IHwgKCR2ICYgMSkpOwoJCQkJCQkkdiA9ICR2ID4+IDE7CgkJCQkJfQoJCQkJfQoJCQkJJHYgPSAkdmluZjsKCQkJCWZvciAoJHk9MDsgJHk8NjsgKyskeSkgewoJCQkJCWZvciAoJHg9MDsgJHg8MzsgKyskeCkgewoJCQkJCQkkZnJhbWVbJHldWyR4Kygkd2lkdGggLSAxMSldID0gY2hyKDB4ODggfCAoJHYgJiAxKSk7CgkJCQkJCSR2ID0gJHYgPj4gMTsKCQkJCQl9CgkJCQl9CgkJCX0KCQkJLy8gYW5kIGEgbGl0dGxlIGJpdC4uLgoJCQkkZnJhbWVbJHdpZHRoIC0gOF1bOF0gPSAiXHg4MSI7CgkJCXJldHVybiAkZnJhbWU7CgkJfQoKCQkvKioKCQkgKiBTZXQgbmV3IGZyYW1lIGZvciB0aGUgc3BlY2lmaWVkIHZlcnNpb24uCgkJICogQHBhcmFtIGludCAkdmVyc2lvbiB2ZXJzaW9uCgkJICogQHJldHVybiBBcnJheSBvZiB1bnNpZ25lZCBjaGFyLgoJCSAqLwoJCXByb3RlY3RlZCBmdW5jdGlvbiBuZXdGcmFtZSgkdmVyc2lvbikgewoJCQlpZiAoKCR2ZXJzaW9uIDwgMSkgT1IgKCR2ZXJzaW9uID4gUVJTUEVDX1ZFUlNJT05fTUFYKSkgewoJCQkJcmV0dXJuIE5VTEw7CgkJCX0KCQkJaWYgKCFpc3NldCgkdGhpcy0+ZnJhbWVzWyR2ZXJzaW9uXSkpIHsKCQkJCSR0aGlzLT5mcmFtZXNbJHZlcnNpb25dID0gJHRoaXMtPmNyZWF0ZUZyYW1lKCR2ZXJzaW9uKTsKCQkJfQoJCQlpZiAoaXNfbnVsbCgkdGhpcy0+ZnJhbWVzWyR2ZXJzaW9uXSkpIHsKCQkJCXJldHVybiBOVUxMOwoJCQl9CgkJCXJldHVybiAkdGhpcy0+ZnJhbWVzWyR2ZXJzaW9uXTsKCQl9CgoJCS8qKgoJCSAqIFJldHVybiBibG9jayBudW1iZXIgMAoJCSAqIEBwYXJhbSBhcnJheSAkc3BlYwoJCSAqIEByZXR1cm4gaW50IHZhbHVlCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiByc0Jsb2NrTnVtKCRzcGVjKSB7CgkJCXJldHVybiAoJHNwZWNbMF0gKyAkc3BlY1szXSk7CgkJfQoKCQkvKioKCQkqIFJldHVybiBibG9jayBudW1iZXIgMQoJCSAqIEBwYXJhbSBhcnJheSAkc3BlYwoJCSAqIEByZXR1cm4gaW50IHZhbHVlCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiByc0Jsb2NrTnVtMSgkc3BlYykgewoJCQlyZXR1cm4gJHNwZWNbMF07CgkJfQoKCQkvKioKCQkgKiBSZXR1cm4gZGF0YSBjb2RlcyAxCgkJICogQHBhcmFtIGFycmF5ICRzcGVjCgkJICogQHJldHVybiBpbnQgdmFsdWUKCQkgKi8KCQkgcHJvdGVjdGVkIGZ1bmN0aW9uIHJzRGF0YUNvZGVzMSgkc3BlYykgewoJCQlyZXR1cm4gJHNwZWNbMV07CgkJfQoKCQkvKioKCQkgKiBSZXR1cm4gZWNjIGNvZGVzIDEKCQkgKiBAcGFyYW0gYXJyYXkgJHNwZWMKCQkgKiBAcmV0dXJuIGludCB2YWx1ZQoJCSAqLwoJCSBwcm90ZWN0ZWQgZnVuY3Rpb24gcnNFY2NDb2RlczEoJHNwZWMpIHsKCQkJcmV0dXJuICRzcGVjWzJdOwoJCX0KCgkJLyoqCgkJICogUmV0dXJuIGJsb2NrIG51bWJlciAyCgkJICogQHBhcmFtIGFycmF5ICRzcGVjCgkJICogQHJldHVybiBpbnQgdmFsdWUKCQkgKi8KCQkgcHJvdGVjdGVkIGZ1bmN0aW9uIHJzQmxvY2tOdW0yKCRzcGVjKSB7CgkJCXJldHVybiAkc3BlY1szXTsKCQl9CgoJCS8qKgoJCSAqIFJldHVybiBkYXRhIGNvZGVzIDIKCQkgKiBAcGFyYW0gYXJyYXkgJHNwZWMKCQkgKiBAcmV0dXJuIGludCB2YWx1ZQoJCSAqLwoJCSBwcm90ZWN0ZWQgZnVuY3Rpb24gcnNEYXRhQ29kZXMyKCRzcGVjKSB7CgkJCXJldHVybiAkc3BlY1s0XTsKCQl9CgoJCS8qKgoJCSAqIFJldHVybiBlY2MgY29kZXMgMgoJCSAqIEBwYXJhbSBhcnJheSAkc3BlYwoJCSAqIEByZXR1cm4gaW50IHZhbHVlCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiByc0VjY0NvZGVzMigkc3BlYykgewoJCQlyZXR1cm4gJHNwZWNbMl07CgkJfQoKCQkvKioKCQkgKiBSZXR1cm4gZGF0YSBsZW5ndGgKCQkgKiBAcGFyYW0gYXJyYXkgJHNwZWMKCQkgKiBAcmV0dXJuIGludCB2YWx1ZQoJCSAqLwoJCSBwcm90ZWN0ZWQgZnVuY3Rpb24gcnNEYXRhTGVuZ3RoKCRzcGVjKSB7CgkJCXJldHVybiAoJHNwZWNbMF0gKiAkc3BlY1sxXSkgKyAoJHNwZWNbM10gKiAkc3BlY1s0XSk7CgkJfQoKCQkvKioKCQkgKiBSZXR1cm4gZWNjIGxlbmd0aAoJCSAqIEBwYXJhbSBhcnJheSAkc3BlYwoJCSAqIEByZXR1cm4gaW50IHZhbHVlCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiByc0VjY0xlbmd0aCgkc3BlYykgewoJCQlyZXR1cm4gKCRzcGVjWzBdICsgJHNwZWNbM10pICogJHNwZWNbMl07CgkJfQoKCQkvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtCgoJCS8vIFFScnMKCgkJLyoqCgkJICogSW5pdGlhbGl6ZSBhIFJlZWQtU29sb21vbiBjb2RlYyBhbmQgYWRkIGl0IHRvIGV4aXN0aW5nIHJzaXRlbXMKCQkgKiBAcGFyYW0gaW50ICRzeW1zaXplIHN5bWJvbCBzaXplLCBiaXRzCgkJICogQHBhcmFtIGludCAkZ2Zwb2x5ICBGaWVsZCBnZW5lcmF0b3IgcG9seW5vbWlhbCBjb2VmZmljaWVudHMKCQkgKiBAcGFyYW0gaW50ICRmY3IgIGZpcnN0IHJvb3Qgb2YgUlMgY29kZSBnZW5lcmF0b3IgcG9seW5vbWlhbCwgaW5kZXggZm9ybQoJCSAqIEBwYXJhbSBpbnQgJHByaW0gIHByaW1pdGl2ZSBlbGVtZW50IHRvIGdlbmVyYXRlIHBvbHlub21pYWwgcm9vdHMKCQkgKiBAcGFyYW0gaW50ICRucm9vdHMgUlMgY29kZSBnZW5lcmF0b3IgcG9seW5vbWlhbCBkZWdyZWUgKG51bWJlciBvZiByb290cykKCQkgKiBAcGFyYW0gaW50ICRwYWQgIHBhZGRpbmcgYnl0ZXMgYXQgZnJvbnQgb2Ygc2hvcnRlbmVkIGJsb2NrCgkJICogQHJldHVybiBhcnJheSBBcnJheSBvZiBSUyB2YWx1ZXM6PHVsPjxsaT5tbSA9IEJpdHMgcGVyIHN5bWJvbDs8L2xpPjxsaT5ubiA9IFN5bWJvbHMgcGVyIGJsb2NrOzwvbGk+PGxpPmFscGhhX3RvID0gbG9nIGxvb2t1cCB0YWJsZSBhcnJheTs8L2xpPjxsaT5pbmRleF9vZiA9IEFudGlsb2cgbG9va3VwIHRhYmxlIGFycmF5OzwvbGk+PGxpPmdlbnBvbHkgPSBHZW5lcmF0b3IgcG9seW5vbWlhbCBhcnJheTs8L2xpPjxsaT5ucm9vdHMgPSBOdW1iZXIgb2YgZ2VuZXJhdG9yOzwvbGk+PGxpPnJvb3RzID0gbnVtYmVyIG9mIHBhcml0eSBzeW1ib2xzOzwvbGk+PGxpPmZjciA9IEZpcnN0IGNvbnNlY3V0aXZlIHJvb3QsIGluZGV4IGZvcm07PC9saT48bGk+cHJpbSA9IFByaW1pdGl2ZSBlbGVtZW50LCBpbmRleCBmb3JtOzwvbGk+PGxpPmlwcmltID0gcHJpbS10aCByb290IG9mIDEsIGluZGV4IGZvcm07PC9saT48bGk+cGFkID0gUGFkZGluZyBieXRlcyBpbiBzaG9ydGVuZWQgYmxvY2s7PC9saT48bGk+Z2Zwb2x5PC91bD4uCgkJICovCgkJIHByb3RlY3RlZCBmdW5jdGlvbiBpbml0X3JzKCRzeW1zaXplLCAkZ2Zwb2x5LCAkZmNyLCAkcHJpbSwgJG5yb290cywgJHBhZCkgewoJCQlmb3JlYWNoICgkdGhpcy0+cnNpdGVtcyBhcyAkcnMpIHsKCQkJCWlmICgoJHJzWydwYWQnXSAhPSAkcGFkKSBPUiAoJHJzWyducm9vdHMnXSAhPSAkbnJvb3RzKSBPUiAoJHJzWydtbSddICE9ICRzeW1zaXplKQoJCQkJCU9SICgkcnNbJ2dmcG9seSddICE9ICRnZnBvbHkpIE9SICgkcnNbJ2ZjciddICE9ICRmY3IpIE9SICgkcnNbJ3ByaW0nXSAhPSAkcHJpbSkpIHsKCQkJCQljb250aW51ZTsKCQkJCX0KCQkJCXJldHVybiAkcnM7CgkJCX0KCQkJJHJzID0gJHRoaXMtPmluaXRfcnNfY2hhcigkc3ltc2l6ZSwgJGdmcG9seSwgJGZjciwgJHByaW0sICRucm9vdHMsICRwYWQpOwoJCQlhcnJheV91bnNoaWZ0KCR0aGlzLT5yc2l0ZW1zLCAkcnMpOwoJCQlyZXR1cm4gJHJzOwoJCX0KCgkJLy8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLQoKCQkvLyBRUnJzSXRlbQoKCQkvKioKCQkgKiBtb2RubgoJCSAqIEBwYXJhbSBhcnJheSBSUyB2YWx1ZXMKCQkgKiBAcGFyYW0gaW50ICR4IFggcG9zaXRpb24KCQkgKiBAcmV0dXJuIGludCBYIG9zaXRpb24KCQkgKi8KCQkgcHJvdGVjdGVkIGZ1bmN0aW9uIG1vZG5uKCRycywgJHgpIHsKCQkJd2hpbGUgKCR4ID49ICRyc1snbm4nXSkgewoJCQkJJHggLT0gJHJzWydubiddOwoJCQkJJHggPSAoJHggPj4gJHJzWydtbSddKSArICgkeCAmICRyc1snbm4nXSk7CgkJCX0KCQkJcmV0dXJuICR4OwoJCX0KCgkJLyoqCgkJICogSW5pdGlhbGl6ZSBhIFJlZWQtU29sb21vbiBjb2RlYyBhbmQgcmV0dXJucyBhbiBhcnJheSBvZiB2YWx1ZXMuCgkJICogQHBhcmFtIGludCAkc3ltc2l6ZSBzeW1ib2wgc2l6ZSwgYml0cwoJCSAqIEBwYXJhbSBpbnQgJGdmcG9seSAgRmllbGQgZ2VuZXJhdG9yIHBvbHlub21pYWwgY29lZmZpY2llbnRzCgkJICogQHBhcmFtIGludCAkZmNyICBmaXJzdCByb290IG9mIFJTIGNvZGUgZ2VuZXJhdG9yIHBvbHlub21pYWwsIGluZGV4IGZvcm0KCQkgKiBAcGFyYW0gaW50ICRwcmltICBwcmltaXRpdmUgZWxlbWVudCB0byBnZW5lcmF0ZSBwb2x5bm9taWFsIHJvb3RzCgkJICogQHBhcmFtIGludCAkbnJvb3RzIFJTIGNvZGUgZ2VuZXJhdG9yIHBvbHlub21pYWwgZGVncmVlIChudW1iZXIgb2Ygcm9vdHMpCgkJICogQHBhcmFtIGludCAkcGFkICBwYWRkaW5nIGJ5dGVzIGF0IGZyb250IG9mIHNob3J0ZW5lZCBibG9jawoJCSAqIEByZXR1cm4gYXJyYXkgQXJyYXkgb2YgUlMgdmFsdWVzOjx1bD48bGk+bW0gPSBCaXRzIHBlciBzeW1ib2w7PC9saT48bGk+bm4gPSBTeW1ib2xzIHBlciBibG9jazs8L2xpPjxsaT5hbHBoYV90byA9IGxvZyBsb29rdXAgdGFibGUgYXJyYXk7PC9saT48bGk+aW5kZXhfb2YgPSBBbnRpbG9nIGxvb2t1cCB0YWJsZSBhcnJheTs8L2xpPjxsaT5nZW5wb2x5ID0gR2VuZXJhdG9yIHBvbHlub21pYWwgYXJyYXk7PC9saT48bGk+bnJvb3RzID0gTnVtYmVyIG9mIGdlbmVyYXRvcjs8L2xpPjxsaT5yb290cyA9IG51bWJlciBvZiBwYXJpdHkgc3ltYm9sczs8L2xpPjxsaT5mY3IgPSBGaXJzdCBjb25zZWN1dGl2ZSByb290LCBpbmRleCBmb3JtOzwvbGk+PGxpPnByaW0gPSBQcmltaXRpdmUgZWxlbWVudCwgaW5kZXggZm9ybTs8L2xpPjxsaT5pcHJpbSA9IHByaW0tdGggcm9vdCBvZiAxLCBpbmRleCBmb3JtOzwvbGk+PGxpPnBhZCA9IFBhZGRpbmcgYnl0ZXMgaW4gc2hvcnRlbmVkIGJsb2NrOzwvbGk+PGxpPmdmcG9seTwvdWw+LgoJCSAqLwoJCXByb3RlY3RlZCBmdW5jdGlvbiBpbml0X3JzX2NoYXIoJHN5bXNpemUsICRnZnBvbHksICRmY3IsICRwcmltLCAkbnJvb3RzLCAkcGFkKSB7CgkJCS8vIEJhc2VkIG9uIFJlZWQgc29sb21vbiBlbmNvZGVyIGJ5IFBoaWwgS2FybiwgS0E5USAoR05VLUxHUEx2MikKCQkJJHJzID0gbnVsbDsKCQkJLy8gQ2hlY2sgcGFyYW1ldGVyIHJhbmdlcwoJCQlpZiAoKCRzeW1zaXplIDwgMCkgT1IgKCRzeW1zaXplID4gOCkpIHsKCQkJCXJldHVybiAkcnM7CgkJCX0KCQkJaWYgKCgkZmNyIDwgMCkgT1IgKCRmY3IgPj0gKDE8PCRzeW1zaXplKSkpIHsKCQkJCXJldHVybiAkcnM7CgkJCX0KCQkJaWYgKCgkcHJpbSA8PSAwKSBPUiAoJHByaW0gPj0gKDE8PCRzeW1zaXplKSkpIHsKCQkJCXJldHVybiAkcnM7CgkJCX0KCQkJaWYgKCgkbnJvb3RzIDwgMCkgT1IgKCRucm9vdHMgPj0gKDE8PCRzeW1zaXplKSkpIHsKCQkJCXJldHVybiAkcnM7CgkJCX0KCQkJaWYgKCgkcGFkIDwgMCkgT1IgKCRwYWQgPj0gKCgxPDwkc3ltc2l6ZSkgLTEgLSAkbnJvb3RzKSkpIHsKCQkJCXJldHVybiAkcnM7CgkJCX0KCQkJJHJzID0gYXJyYXkoKTsKCQkJJHJzWydtbSddID0gJHN5bXNpemU7CgkJCSRyc1snbm4nXSA9ICgxIDw8ICRzeW1zaXplKSAtIDE7CgkJCSRyc1sncGFkJ10gPSAkcGFkOwoJCQkkcnNbJ2FscGhhX3RvJ10gPSBhcnJheV9maWxsKDAsICgkcnNbJ25uJ10gKyAxKSwgMCk7CgkJCSRyc1snaW5kZXhfb2YnXSA9IGFycmF5X2ZpbGwoMCwgKCRyc1snbm4nXSArIDEpLCAwKTsKCQkJLy8gUEhQIHN0eWxlIG1hY3JvIHJlcGxhY2VtZW50IDspCgkJCSROTiA9JiAkcnNbJ25uJ107CgkJCSRBMCA9JiAkTk47CgkJCS8vIEdlbmVyYXRlIEdhbG9pcyBmaWVsZCBsb29rdXAgdGFibGVzCgkJCSRyc1snaW5kZXhfb2YnXVswXSA9ICRBMDsgLy8gbG9nKHplcm8pID0gLWluZgoJCQkkcnNbJ2FscGhhX3RvJ11bJEEwXSA9IDA7IC8vIGFscGhhKiotaW5mID0gMAoJCQkkc3IgPSAxOwoJCQlmb3IgKCRpPTA7ICRpPCRyc1snbm4nXTsgKyskaSkgewoJCQkJJHJzWydpbmRleF9vZiddWyRzcl0gPSAkaTsKCQkJCSRyc1snYWxwaGFfdG8nXVskaV0gPSAkc3I7CgkJCQkkc3IgPDw9IDE7CgkJCQlpZiAoJHNyICYgKDEgPDwgJHN5bXNpemUpKSB7CgkJCQkJJHNyIF49ICRnZnBvbHk7CgkJCQl9CgkJCQkkc3IgJj0gJHJzWydubiddOwoJCQl9CgkJCWlmICgkc3IgIT0gMSkgewoJCQkJLy8gZmllbGQgZ2VuZXJhdG9yIHBvbHlub21pYWwgaXMgbm90IHByaW1pdGl2ZSEKCQkJCXJldHVybiBOVUxMOwoJCQl9CgkJCS8vIEZvcm0gUlMgY29kZSBnZW5lcmF0b3IgcG9seW5vbWlhbCBmcm9tIGl0cyByb290cwoJCQkkcnNbJ2dlbnBvbHknXSA9IGFycmF5X2ZpbGwoMCwgKCRucm9vdHMgKyAxKSwgMCk7CgkJCSRyc1snZmNyJ10gPSAkZmNyOwoJCQkkcnNbJ3ByaW0nXSA9ICRwcmltOwoJCQkkcnNbJ25yb290cyddID0gJG5yb290czsKCQkJJHJzWydnZnBvbHknXSA9ICRnZnBvbHk7CgkJCS8vIEZpbmQgcHJpbS10aCByb290IG9mIDEsIHVzZWQgaW4gZGVjb2RpbmcKCQkJZm9yICgkaXByaW09MTsgKCRpcHJpbSAlICRwcmltKSAhPSAwOyAkaXByaW0gKz0gJHJzWydubiddKSB7CgkJCQk7IC8vIGludGVudGlvbmFsIGVtcHR5LWJvZHkgbG9vcCEKCQkJfQoJCQkkcnNbJ2lwcmltJ10gPSAoaW50KSgkaXByaW0gLyAkcHJpbSk7CgkJCSRyc1snZ2VucG9seSddWzBdID0gMTsKCgoJCQlmb3IgKCRpID0gMCwkcm9vdD0kZmNyKiRwcmltOyAkaSA8ICRucm9vdHM7ICRpKyssICRyb290ICs9ICRwcmltKSB7CgkJCQkkcnNbJ2dlbnBvbHknXVskaSsxXSA9IDE7CgkJCQkvLyBNdWx0aXBseSBycy0+Z2VucG9seVtdIGJ5ICBAKioocm9vdCArIHgpCgkJCQlmb3IgKCRqID0gJGk7ICRqID4gMDsgLS0kaikgewoJCQkJCWlmICgkcnNbJ2dlbnBvbHknXVskal0gIT0gMCkgewoJCQkJCQkkcnNbJ2dlbnBvbHknXVskal0gPSAkcnNbJ2dlbnBvbHknXVskai0xXSBeICRyc1snYWxwaGFfdG8nXVskdGhpcy0+bW9kbm4oJHJzLCAkcnNbJ2luZGV4X29mJ11bJHJzWydnZW5wb2x5J11bJGpdXSArICRyb290KV07CgkJCQkJfSBlbHNlIHsKCQkJCQkJJHJzWydnZW5wb2x5J11bJGpdID0gJHJzWydnZW5wb2x5J11bJGotMV07CgkJCQkJfQoJCQkJfQoJCQkJLy8gcnMtPmdlbnBvbHlbMF0gY2FuIG5ldmVyIGJlIHplcm8KCQkJCSRyc1snZ2VucG9seSddWzBdID0gJHJzWydhbHBoYV90byddWyR0aGlzLT5tb2RubigkcnMsICRyc1snaW5kZXhfb2YnXVskcnNbJ2dlbnBvbHknXVswXV0gKyAkcm9vdCldOwoJCQl9CgkJCS8vIGNvbnZlcnQgcnMtPmdlbnBvbHlbXSB0byBpbmRleCBmb3JtIGZvciBxdWlja2VyIGVuY29kaW5nCgkJCWZvciAoJGkgPSAwOyAkaSA8PSAkbnJvb3RzOyArKyRpKSB7CgkJCQkkcnNbJ2dlbnBvbHknXVskaV0gPSAkcnNbJ2luZGV4X29mJ11bJHJzWydnZW5wb2x5J11bJGldXTsKCQkJfQoJCQlyZXR1cm4gJHJzOwoJCX0KCgkJLyoqCgkJICogRW5jb2RlIGEgUmVlZC1Tb2xvbW9uIGNvZGVjIGFuZCByZXR1cm5zIHRoZSBwYXJpdHkgYXJyYXkKCQkgKiBAcGFyYW0gYXJyYXkgJHJzIFJTIHZhbHVlcwoJCSAqIEBwYXJhbSBhcnJheSAkZGF0YSBkYXRhCgkJICogQHBhcmFtIGFycmF5ICRwYXJpdHkgcGFyaXR5CgkJICogQHJldHVybiBwYXJpdHkgYXJyYXkKCQkgKi8KCQkgcHJvdGVjdGVkIGZ1bmN0aW9uIGVuY29kZV9yc19jaGFyKCRycywgJGRhdGEsICRwYXJpdHkpIHsKCQkJJE1NICAgICAgID0mICRyc1snbW0nXTsgLy8gYml0cyBwZXIgc3ltYm9sCgkJCSROTiAgICAgICA9JiAkcnNbJ25uJ107IC8vIHRoZSB0b3RhbCBudW1iZXIgb2Ygc3ltYm9scyBpbiBhIFJTIGJsb2NrCgkJCSRBTFBIQV9UTyA9JiAkcnNbJ2FscGhhX3RvJ107IC8vIHRoZSBhZGRyZXNzIG9mIGFuIGFycmF5IG9mIE5OIGVsZW1lbnRzIHRvIGNvbnZlcnQgR2Fsb2lzIGZpZWxkIGVsZW1lbnRzIGluIGluZGV4IChsb2cpIGZvcm0gdG8gcG9seW5vbWlhbCBmb3JtCgkJCSRJTkRFWF9PRiA9JiAkcnNbJ2luZGV4X29mJ107IC8vIHRoZSBhZGRyZXNzIG9mIGFuIGFycmF5IG9mIE5OIGVsZW1lbnRzIHRvIGNvbnZlcnQgR2Fsb2lzIGZpZWxkIGVsZW1lbnRzIGluIHBvbHlub21pYWwgZm9ybSB0byBpbmRleCAobG9nKSBmb3JtCgkJCSRHRU5QT0xZICA9JiAkcnNbJ2dlbnBvbHknXTsgLy8gYW4gYXJyYXkgb2YgTlJPT1RTKzEgZWxlbWVudHMgY29udGFpbmluZyB0aGUgZ2VuZXJhdG9yIHBvbHlub21pYWwgaW4gaW5kZXggZm9ybQoJCQkkTlJPT1RTICAgPSYgJHJzWyducm9vdHMnXTsgLy8gdGhlIG51bWJlciBvZiByb290cyBpbiB0aGUgUlMgY29kZSBnZW5lcmF0b3IgcG9seW5vbWlhbCwgd2hpY2ggaXMgdGhlIHNhbWUgYXMgdGhlIG51bWJlciBvZiBwYXJpdHkgc3ltYm9scyBpbiBhIGJsb2NrCgkJCSRGQ1IgICAgICA9JiAkcnNbJ2ZjciddOyAvLyBmaXJzdCBjb25zZWN1dGl2ZSByb290LCBpbmRleCBmb3JtCgkJCSRQUklNICAgICA9JiAkcnNbJ3ByaW0nXTsgLy8gcHJpbWl0aXZlIGVsZW1lbnQsIGluZGV4IGZvcm0KCQkJJElQUklNICAgID0mICRyc1snaXByaW0nXTsgLy8gcHJpbS10aCByb290IG9mIDEsIGluZGV4IGZvcm0KCQkJJFBBRCAgICAgID0mICRyc1sncGFkJ107IC8vIHRoZSBudW1iZXIgb2YgcGFkIHN5bWJvbHMgaW4gYSBibG9jawoJCQkkQTAgICAgICAgPSYgJE5OOwoJCQkkcGFyaXR5ID0gYXJyYXlfZmlsbCgwLCAkTlJPT1RTLCAwKTsKCQkJZm9yICgkaT0wOyAkaSA8ICgkTk4gLSAkTlJPT1RTIC0gJFBBRCk7ICRpKyspIHsKCQkJCSRmZWVkYmFjayA9ICRJTkRFWF9PRlskZGF0YVskaV0gXiAkcGFyaXR5WzBdXTsKCQkJCWlmICgkZmVlZGJhY2sgIT0gJEEwKSB7CgkJCQkJLy8gZmVlZGJhY2sgdGVybSBpcyBub24temVybwoJCQkJCS8vIFRoaXMgbGluZSBpcyB1bm5lY2Vzc2FyeSB3aGVuIEdFTlBPTFlbTlJPT1RTXSBpcyB1bml0eSwgYXMgaXQgbXVzdAoJCQkJCS8vIGFsd2F5cyBiZSBmb3IgdGhlIHBvbHlub21pYWxzIGNvbnN0cnVjdGVkIGJ5IGluaXRfcnMoKQoJCQkJCSRmZWVkYmFjayA9ICR0aGlzLT5tb2RubigkcnMsICROTiAtICRHRU5QT0xZWyROUk9PVFNdICsgJGZlZWRiYWNrKTsKCQkJCQlmb3IgKCRqPTE7ICRqIDwgJE5ST09UUzsgKyskaikgewoJCQkJCSRwYXJpdHlbJGpdIF49ICRBTFBIQV9UT1skdGhpcy0+bW9kbm4oJHJzLCAkZmVlZGJhY2sgKyAkR0VOUE9MWVsoJE5ST09UUyAtICRqKV0pXTsKCQkJCQl9CgkJCQl9CgkJCQkvLyBTaGlmdAoJCQkJYXJyYXlfc2hpZnQoJHBhcml0eSk7CgkJCQlpZiAoJGZlZWRiYWNrICE9ICRBMCkgewoJCQkJCWFycmF5X3B1c2goJHBhcml0eSwgJEFMUEhBX1RPWyR0aGlzLT5tb2RubigkcnMsICRmZWVkYmFjayArICRHRU5QT0xZWzBdKV0pOwoJCQkJfSBlbHNlIHsKCQkJCQlhcnJheV9wdXNoKCRwYXJpdHksIDApOwoJCQkJfQoJCQl9CgkJCXJldHVybiAkcGFyaXR5OwoJCX0KCgl9IC8vIGVuZCBRUmNvZGUgY2xhc3MKCn0gLy8gRU5EIE9GICJjbGFzc19leGlzdHMgUVJjb2RlIgo\/Pgo=",
    "size": "82952"
}