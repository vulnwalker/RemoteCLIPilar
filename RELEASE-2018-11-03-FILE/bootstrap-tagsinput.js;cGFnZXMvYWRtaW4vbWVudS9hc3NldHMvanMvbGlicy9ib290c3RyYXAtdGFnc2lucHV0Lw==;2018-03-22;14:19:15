{
    "namaFile": "pages\/admin\/menu\/assets\/js\/libs\/bootstrap-tagsinput\/bootstrap-tagsinput.js",
    "lastUpdate": "2018-03-22+14:19:15.94",
    "contentFile": "KGZ1bmN0aW9uICgkKSB7CiAgInVzZSBzdHJpY3QiOwoKICB2YXIgZGVmYXVsdE9wdGlvbnMgPSB7CiAgICB0YWdDbGFzczogZnVuY3Rpb24oaXRlbSkgewogICAgICByZXR1cm4gJ2xhYmVsIGxhYmVsLWluZm8nOwogICAgfSwKICAgIGl0ZW1WYWx1ZTogZnVuY3Rpb24oaXRlbSkgewogICAgICByZXR1cm4gaXRlbSA\/IGl0ZW0udG9TdHJpbmcoKSA6IGl0ZW07CiAgICB9LAogICAgaXRlbVRleHQ6IGZ1bmN0aW9uKGl0ZW0pIHsKICAgICAgcmV0dXJuIHRoaXMuaXRlbVZhbHVlKGl0ZW0pOwogICAgfSwKICAgIGZyZWVJbnB1dDogdHJ1ZSwKICAgIGFkZE9uQmx1cjogdHJ1ZSwKICAgIG1heFRhZ3M6IHVuZGVmaW5lZCwKICAgIG1heENoYXJzOiB1bmRlZmluZWQsCiAgICBjb25maXJtS2V5czogWzEzLCA0NF0sCiAgICBvblRhZ0V4aXN0czogZnVuY3Rpb24oaXRlbSwgJHRhZykgewogICAgICAkdGFnLmhpZGUoKS5mYWRlSW4oKTsKICAgIH0sCiAgICB0cmltVmFsdWU6IGZhbHNlLAogICAgYWxsb3dEdXBsaWNhdGVzOiBmYWxzZQogIH07CgogIC8qKgogICAqIENvbnN0cnVjdG9yIGZ1bmN0aW9uCiAgICovCiAgZnVuY3Rpb24gVGFnc0lucHV0KGVsZW1lbnQsIG9wdGlvbnMpIHsKICAgIHRoaXMuaXRlbXNBcnJheSA9IFtdOwoKICAgIHRoaXMuJGVsZW1lbnQgPSAkKGVsZW1lbnQpOwogICAgdGhpcy4kZWxlbWVudC5oaWRlKCk7CgogICAgdGhpcy5pc1NlbGVjdCA9IChlbGVtZW50LnRhZ05hbWUgPT09ICdTRUxFQ1QnKTsKICAgIHRoaXMubXVsdGlwbGUgPSAodGhpcy5pc1NlbGVjdCAmJiBlbGVtZW50Lmhhc0F0dHJpYnV0ZSgnbXVsdGlwbGUnKSk7CiAgICB0aGlzLm9iamVjdEl0ZW1zID0gb3B0aW9ucyAmJiBvcHRpb25zLml0ZW1WYWx1ZTsKICAgIHRoaXMucGxhY2Vob2xkZXJUZXh0ID0gZWxlbWVudC5oYXNBdHRyaWJ1dGUoJ3BsYWNlaG9sZGVyJykgPyB0aGlzLiRlbGVtZW50LmF0dHIoJ3BsYWNlaG9sZGVyJykgOiAnJzsKICAgIHRoaXMuaW5wdXRTaXplID0gTWF0aC5tYXgoMSwgdGhpcy5wbGFjZWhvbGRlclRleHQubGVuZ3RoKTsKCiAgICB0aGlzLiRjb250YWluZXIgPSAkKCc8ZGl2IGNsYXNzPSJib290c3RyYXAtdGFnc2lucHV0Ij48L2Rpdj4nKTsKICAgIHRoaXMuJGlucHV0ID0gJCgnPGlucHV0IHR5cGU9InRleHQiIHBsYWNlaG9sZGVyPSInICsgdGhpcy5wbGFjZWhvbGRlclRleHQgKyAnIi8+JykuYXBwZW5kVG8odGhpcy4kY29udGFpbmVyKTsKCiAgICB0aGlzLiRlbGVtZW50LmFmdGVyKHRoaXMuJGNvbnRhaW5lcik7CgogICAgdmFyIGlucHV0V2lkdGggPSAodGhpcy5pbnB1dFNpemUgPCAzID8gMyA6IHRoaXMuaW5wdXRTaXplKSArICJlbSI7CiAgICB0aGlzLiRpbnB1dC5nZXQoMCkuc3R5bGUuY3NzVGV4dCA9ICJ3aWR0aDogIiArIGlucHV0V2lkdGggKyAiICFpbXBvcnRhbnQ7IjsKICAgIHRoaXMuYnVpbGQob3B0aW9ucyk7CiAgfQoKICBUYWdzSW5wdXQucHJvdG90eXBlID0gewogICAgY29uc3RydWN0b3I6IFRhZ3NJbnB1dCwKCiAgICAvKioKICAgICAqIEFkZHMgdGhlIGdpdmVuIGl0ZW0gYXMgYSBuZXcgdGFnLiBQYXNzIHRydWUgdG8gZG9udFB1c2hWYWwgdG8gcHJldmVudAogICAgICogdXBkYXRpbmcgdGhlIGVsZW1lbnRzIHZhbCgpCiAgICAgKi8KICAgIGFkZDogZnVuY3Rpb24oaXRlbSwgZG9udFB1c2hWYWwpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwoKICAgICAgaWYgKHNlbGYub3B0aW9ucy5tYXhUYWdzICYmIHNlbGYuaXRlbXNBcnJheS5sZW5ndGggPj0gc2VsZi5vcHRpb25zLm1heFRhZ3MpCiAgICAgICAgcmV0dXJuOwoKICAgICAgLy8gSWdub3JlIGZhbHNleSB2YWx1ZXMsIGV4Y2VwdCBmYWxzZQogICAgICBpZiAoaXRlbSAhPT0gZmFsc2UgJiYgIWl0ZW0pCiAgICAgICAgcmV0dXJuOwoKICAgICAgLy8gVHJpbSB2YWx1ZQogICAgICBpZiAodHlwZW9mIGl0ZW0gPT09ICJzdHJpbmciICYmIHNlbGYub3B0aW9ucy50cmltVmFsdWUpIHsKICAgICAgICBpdGVtID0gJC50cmltKGl0ZW0pOwogICAgICB9CgogICAgICAvLyBUaHJvdyBhbiBlcnJvciB3aGVuIHRyeWluZyB0byBhZGQgYW4gb2JqZWN0IHdoaWxlIHRoZSBpdGVtVmFsdWUgb3B0aW9uIHdhcyBub3Qgc2V0CiAgICAgIGlmICh0eXBlb2YgaXRlbSA9PT0gIm9iamVjdCIgJiYgIXNlbGYub2JqZWN0SXRlbXMpCiAgICAgICAgdGhyb3coIkNhbid0IGFkZCBvYmplY3RzIHdoZW4gaXRlbVZhbHVlIG9wdGlvbiBpcyBub3Qgc2V0Iik7CgogICAgICAvLyBJZ25vcmUgc3RyaW5ncyBvbmx5IGNvbnRhaW5nIHdoaXRlc3BhY2UKICAgICAgaWYgKGl0ZW0udG9TdHJpbmcoKS5tYXRjaCgvXlxzKiQvKSkKICAgICAgICByZXR1cm47CgogICAgICAvLyBJZiBTRUxFQ1QgYnV0IG5vdCBtdWx0aXBsZSwgcmVtb3ZlIGN1cnJlbnQgdGFnCiAgICAgIGlmIChzZWxmLmlzU2VsZWN0ICYmICFzZWxmLm11bHRpcGxlICYmIHNlbGYuaXRlbXNBcnJheS5sZW5ndGggPiAwKQogICAgICAgIHNlbGYucmVtb3ZlKHNlbGYuaXRlbXNBcnJheVswXSk7CgogICAgICBpZiAodHlwZW9mIGl0ZW0gPT09ICJzdHJpbmciICYmIHRoaXMuJGVsZW1lbnRbMF0udGFnTmFtZSA9PT0gJ0lOUFVUJykgewogICAgICAgIHZhciBpdGVtcyA9IGl0ZW0uc3BsaXQoJywnKTsKICAgICAgICBpZiAoaXRlbXMubGVuZ3RoID4gMSkgewogICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB0aGlzLmFkZChpdGVtc1tpXSwgdHJ1ZSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFkb250UHVzaFZhbCkKICAgICAgICAgICAgc2VsZi5wdXNoVmFsKCk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgaXRlbVZhbHVlID0gc2VsZi5vcHRpb25zLml0ZW1WYWx1ZShpdGVtKSwKICAgICAgICAgIGl0ZW1UZXh0ID0gc2VsZi5vcHRpb25zLml0ZW1UZXh0KGl0ZW0pLAogICAgICAgICAgdGFnQ2xhc3MgPSBzZWxmLm9wdGlvbnMudGFnQ2xhc3MoaXRlbSk7CgogICAgICAvLyBJZ25vcmUgaXRlbXMgYWxscmVhZHkgYWRkZWQKICAgICAgdmFyIGV4aXN0aW5nID0gJC5ncmVwKHNlbGYuaXRlbXNBcnJheSwgZnVuY3Rpb24oaXRlbSkgeyByZXR1cm4gc2VsZi5vcHRpb25zLml0ZW1WYWx1ZShpdGVtKSA9PT0gaXRlbVZhbHVlOyB9IClbMF07CiAgICAgIGlmIChleGlzdGluZyAmJiAhc2VsZi5vcHRpb25zLmFsbG93RHVwbGljYXRlcykgewogICAgICAgIC8vIEludm9rZSBvblRhZ0V4aXN0cwogICAgICAgIGlmIChzZWxmLm9wdGlvbnMub25UYWdFeGlzdHMpIHsKICAgICAgICAgIHZhciAkZXhpc3RpbmdUYWcgPSAkKCIudGFnIiwgc2VsZi4kY29udGFpbmVyKS5maWx0ZXIoZnVuY3Rpb24oKSB7IHJldHVybiAkKHRoaXMpLmRhdGEoIml0ZW0iKSA9PT0gZXhpc3Rpbmc7IH0pOwogICAgICAgICAgc2VsZi5vcHRpb25zLm9uVGFnRXhpc3RzKGl0ZW0sICRleGlzdGluZ1RhZyk7CiAgICAgICAgfQogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgLy8gaWYgbGVuZ3RoIGdyZWF0ZXIgdGhhbiBsaW1pdAogICAgICBpZiAoc2VsZi5pdGVtcygpLnRvU3RyaW5nKCkubGVuZ3RoICsgaXRlbS5sZW5ndGggKyAxID4gc2VsZi5vcHRpb25zLm1heElucHV0TGVuZ3RoKQogICAgICAgIHJldHVybjsKCiAgICAgIC8vIHJhaXNlIGJlZm9yZUl0ZW1BZGQgYXJnCiAgICAgIHZhciBiZWZvcmVJdGVtQWRkRXZlbnQgPSAkLkV2ZW50KCdiZWZvcmVJdGVtQWRkJywgeyBpdGVtOiBpdGVtLCBjYW5jZWw6IGZhbHNlIH0pOwogICAgICBzZWxmLiRlbGVtZW50LnRyaWdnZXIoYmVmb3JlSXRlbUFkZEV2ZW50KTsKICAgICAgaWYgKGJlZm9yZUl0ZW1BZGRFdmVudC5jYW5jZWwpCiAgICAgICAgcmV0dXJuOwoKICAgICAgLy8gcmVnaXN0ZXIgaXRlbSBpbiBpbnRlcm5hbCBhcnJheSBhbmQgbWFwCiAgICAgIHNlbGYuaXRlbXNBcnJheS5wdXNoKGl0ZW0pOwoKICAgICAgLy8gYWRkIGEgdGFnIGVsZW1lbnQKICAgICAgdmFyICR0YWcgPSAkKCc8c3BhbiBjbGFzcz0idGFnICcgKyBodG1sRW5jb2RlKHRhZ0NsYXNzKSArICciPicgKyBodG1sRW5jb2RlKGl0ZW1UZXh0KSArICc8c3BhbiBkYXRhLXJvbGU9InJlbW92ZSI+PC9zcGFuPjwvc3Bhbj4nKTsKICAgICAgJHRhZy5kYXRhKCdpdGVtJywgaXRlbSk7CiAgICAgIHNlbGYuZmluZElucHV0V3JhcHBlcigpLmJlZm9yZSgkdGFnKTsKICAgICAgJHRhZy5hZnRlcignICcpOwoKICAgICAgLy8gYWRkIDxvcHRpb24gLz4gaWYgaXRlbSByZXByZXNlbnRzIGEgdmFsdWUgbm90IHByZXNlbnQgaW4gb25lIG9mIHRoZSA8c2VsZWN0IC8+J3Mgb3B0aW9ucwogICAgICBpZiAoc2VsZi5pc1NlbGVjdCAmJiAhJCgnb3B0aW9uW3ZhbHVlPSInICsgZW5jb2RlVVJJQ29tcG9uZW50KGl0ZW1WYWx1ZSkgKyAnIl0nLHNlbGYuJGVsZW1lbnQpWzBdKSB7CiAgICAgICAgdmFyICRvcHRpb24gPSAkKCc8b3B0aW9uIHNlbGVjdGVkPicgKyBodG1sRW5jb2RlKGl0ZW1UZXh0KSArICc8L29wdGlvbj4nKTsKICAgICAgICAkb3B0aW9uLmRhdGEoJ2l0ZW0nLCBpdGVtKTsKICAgICAgICAkb3B0aW9uLmF0dHIoJ3ZhbHVlJywgaXRlbVZhbHVlKTsKICAgICAgICBzZWxmLiRlbGVtZW50LmFwcGVuZCgkb3B0aW9uKTsKICAgICAgfQoKICAgICAgaWYgKCFkb250UHVzaFZhbCkKICAgICAgICBzZWxmLnB1c2hWYWwoKTsKCiAgICAgIC8vIEFkZCBjbGFzcyB3aGVuIHJlYWNoZWQgbWF4VGFncwogICAgICBpZiAoc2VsZi5vcHRpb25zLm1heFRhZ3MgPT09IHNlbGYuaXRlbXNBcnJheS5sZW5ndGggfHwgc2VsZi5pdGVtcygpLnRvU3RyaW5nKCkubGVuZ3RoID09PSBzZWxmLm9wdGlvbnMubWF4SW5wdXRMZW5ndGgpCiAgICAgICAgc2VsZi4kY29udGFpbmVyLmFkZENsYXNzKCdib290c3RyYXAtdGFnc2lucHV0LW1heCcpOwoKICAgICAgc2VsZi4kZWxlbWVudC50cmlnZ2VyKCQuRXZlbnQoJ2l0ZW1BZGRlZCcsIHsgaXRlbTogaXRlbSB9KSk7CiAgICB9LAoKICAgIC8qKgogICAgICogUmVtb3ZlcyB0aGUgZ2l2ZW4gaXRlbS4gUGFzcyB0cnVlIHRvIGRvbnRQdXNoVmFsIHRvIHByZXZlbnQgdXBkYXRpbmcgdGhlCiAgICAgKiBlbGVtZW50cyB2YWwoKQogICAgICovCiAgICByZW1vdmU6IGZ1bmN0aW9uKGl0ZW0sIGRvbnRQdXNoVmFsKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKCiAgICAgIGlmIChzZWxmLm9iamVjdEl0ZW1zKSB7CiAgICAgICAgaWYgKHR5cGVvZiBpdGVtID09PSAib2JqZWN0IikKICAgICAgICAgIGl0ZW0gPSAkLmdyZXAoc2VsZi5pdGVtc0FycmF5LCBmdW5jdGlvbihvdGhlcikgeyByZXR1cm4gc2VsZi5vcHRpb25zLml0ZW1WYWx1ZShvdGhlcikgPT0gIHNlbGYub3B0aW9ucy5pdGVtVmFsdWUoaXRlbSk7IH0gKTsKICAgICAgICBlbHNlCiAgICAgICAgICBpdGVtID0gJC5ncmVwKHNlbGYuaXRlbXNBcnJheSwgZnVuY3Rpb24ob3RoZXIpIHsgcmV0dXJuIHNlbGYub3B0aW9ucy5pdGVtVmFsdWUob3RoZXIpID09ICBpdGVtOyB9ICk7CgogICAgICAgIGl0ZW0gPSBpdGVtW2l0ZW0ubGVuZ3RoLTFdOwogICAgICB9CgogICAgICBpZiAoaXRlbSkgewogICAgICAgIHZhciBiZWZvcmVJdGVtUmVtb3ZlRXZlbnQgPSAkLkV2ZW50KCdiZWZvcmVJdGVtUmVtb3ZlJywgeyBpdGVtOiBpdGVtLCBjYW5jZWw6IGZhbHNlIH0pOwogICAgICAgIHNlbGYuJGVsZW1lbnQudHJpZ2dlcihiZWZvcmVJdGVtUmVtb3ZlRXZlbnQpOwogICAgICAgIGlmIChiZWZvcmVJdGVtUmVtb3ZlRXZlbnQuY2FuY2VsKQogICAgICAgICAgcmV0dXJuOwoKICAgICAgICAkKCcudGFnJywgc2VsZi4kY29udGFpbmVyKS5maWx0ZXIoZnVuY3Rpb24oKSB7IHJldHVybiAkKHRoaXMpLmRhdGEoJ2l0ZW0nKSA9PT0gaXRlbTsgfSkucmVtb3ZlKCk7CiAgICAgICAgJCgnb3B0aW9uJywgc2VsZi4kZWxlbWVudCkuZmlsdGVyKGZ1bmN0aW9uKCkgeyByZXR1cm4gJCh0aGlzKS5kYXRhKCdpdGVtJykgPT09IGl0ZW07IH0pLnJlbW92ZSgpOwogICAgICAgIGlmKCQuaW5BcnJheShpdGVtLCBzZWxmLml0ZW1zQXJyYXkpICE9PSAtMSkKICAgICAgICAgIHNlbGYuaXRlbXNBcnJheS5zcGxpY2UoJC5pbkFycmF5KGl0ZW0sIHNlbGYuaXRlbXNBcnJheSksIDEpOwogICAgICB9CgogICAgICBpZiAoIWRvbnRQdXNoVmFsKQogICAgICAgIHNlbGYucHVzaFZhbCgpOwoKICAgICAgLy8gUmVtb3ZlIGNsYXNzIHdoZW4gcmVhY2hlZCBtYXhUYWdzCiAgICAgIGlmIChzZWxmLm9wdGlvbnMubWF4VGFncyA+IHNlbGYuaXRlbXNBcnJheS5sZW5ndGgpCiAgICAgICAgc2VsZi4kY29udGFpbmVyLnJlbW92ZUNsYXNzKCdib290c3RyYXAtdGFnc2lucHV0LW1heCcpOwoKICAgICAgc2VsZi4kZWxlbWVudC50cmlnZ2VyKCQuRXZlbnQoJ2l0ZW1SZW1vdmVkJywgIHsgaXRlbTogaXRlbSB9KSk7CiAgICB9LAoKICAgIC8qKgogICAgICogUmVtb3ZlcyBhbGwgaXRlbXMKICAgICAqLwogICAgcmVtb3ZlQWxsOiBmdW5jdGlvbigpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwoKICAgICAgJCgnLnRhZycsIHNlbGYuJGNvbnRhaW5lcikucmVtb3ZlKCk7CiAgICAgICQoJ29wdGlvbicsIHNlbGYuJGVsZW1lbnQpLnJlbW92ZSgpOwoKICAgICAgd2hpbGUoc2VsZi5pdGVtc0FycmF5Lmxlbmd0aCA+IDApCiAgICAgICAgc2VsZi5pdGVtc0FycmF5LnBvcCgpOwoKICAgICAgc2VsZi5wdXNoVmFsKCk7CiAgICB9LAoKICAgIC8qKgogICAgICogUmVmcmVzaGVzIHRoZSB0YWdzIHNvIHRoZXkgbWF0Y2ggdGhlIHRleHQvdmFsdWUgb2YgdGhlaXIgY29ycmVzcG9uZGluZwogICAgICogaXRlbS4KICAgICAqLwogICAgcmVmcmVzaDogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgJCgnLnRhZycsIHNlbGYuJGNvbnRhaW5lcikuZWFjaChmdW5jdGlvbigpIHsKICAgICAgICB2YXIgJHRhZyA9ICQodGhpcyksCiAgICAgICAgICAgIGl0ZW0gPSAkdGFnLmRhdGEoJ2l0ZW0nKSwKICAgICAgICAgICAgaXRlbVZhbHVlID0gc2VsZi5vcHRpb25zLml0ZW1WYWx1ZShpdGVtKSwKICAgICAgICAgICAgaXRlbVRleHQgPSBzZWxmLm9wdGlvbnMuaXRlbVRleHQoaXRlbSksCiAgICAgICAgICAgIHRhZ0NsYXNzID0gc2VsZi5vcHRpb25zLnRhZ0NsYXNzKGl0ZW0pOwoKICAgICAgICAgIC8vIFVwZGF0ZSB0YWcncyBjbGFzcyBhbmQgaW5uZXIgdGV4dAogICAgICAgICAgJHRhZy5hdHRyKCdjbGFzcycsIG51bGwpOwogICAgICAgICAgJHRhZy5hZGRDbGFzcygndGFnICcgKyBodG1sRW5jb2RlKHRhZ0NsYXNzKSk7CiAgICAgICAgICAkdGFnLmNvbnRlbnRzKCkuZmlsdGVyKGZ1bmN0aW9uKCkgewogICAgICAgICAgICByZXR1cm4gdGhpcy5ub2RlVHlwZSA9PSAzOwogICAgICAgICAgfSlbMF0ubm9kZVZhbHVlID0gaHRtbEVuY29kZShpdGVtVGV4dCk7CgogICAgICAgICAgaWYgKHNlbGYuaXNTZWxlY3QpIHsKICAgICAgICAgICAgdmFyIG9wdGlvbiA9ICQoJ29wdGlvbicsIHNlbGYuJGVsZW1lbnQpLmZpbHRlcihmdW5jdGlvbigpIHsgcmV0dXJuICQodGhpcykuZGF0YSgnaXRlbScpID09PSBpdGVtOyB9KTsKICAgICAgICAgICAgb3B0aW9uLmF0dHIoJ3ZhbHVlJywgaXRlbVZhbHVlKTsKICAgICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIC8qKgogICAgICogUmV0dXJucyB0aGUgaXRlbXMgYWRkZWQgYXMgdGFncwogICAgICovCiAgICBpdGVtczogZnVuY3Rpb24oKSB7CiAgICAgIHJldHVybiB0aGlzLml0ZW1zQXJyYXk7CiAgICB9LAoKICAgIC8qKgogICAgICogQXNzZW1ibHkgdmFsdWUgYnkgcmV0cmlldmluZyB0aGUgdmFsdWUgb2YgZWFjaCBpdGVtLCBhbmQgc2V0IGl0IG9uIHRoZQogICAgICogZWxlbWVudC4KICAgICAqLwogICAgcHVzaFZhbDogZnVuY3Rpb24oKSB7CiAgICAgIHZhciBzZWxmID0gdGhpcywKICAgICAgICAgIHZhbCA9ICQubWFwKHNlbGYuaXRlbXMoKSwgZnVuY3Rpb24oaXRlbSkgewogICAgICAgICAgICByZXR1cm4gc2VsZi5vcHRpb25zLml0ZW1WYWx1ZShpdGVtKS50b1N0cmluZygpOwogICAgICAgICAgfSk7CgogICAgICBzZWxmLiRlbGVtZW50LnZhbCh2YWwsIHRydWUpLnRyaWdnZXIoJ2NoYW5nZScpOwogICAgfSwKCiAgICAvKioKICAgICAqIEluaXRpYWxpemVzIHRoZSB0YWdzIGlucHV0IGJlaGF2aW91ciBvbiB0aGUgZWxlbWVudAogICAgICovCiAgICBidWlsZDogZnVuY3Rpb24ob3B0aW9ucykgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CgogICAgICBzZWxmLm9wdGlvbnMgPSAkLmV4dGVuZCh7fSwgZGVmYXVsdE9wdGlvbnMsIG9wdGlvbnMpOwogICAgICAvLyBXaGVuIGl0ZW1WYWx1ZSBpcyBzZXQsIGZyZWVJbnB1dCBzaG91bGQgYWx3YXlzIGJlIGZhbHNlCiAgICAgIGlmIChzZWxmLm9iamVjdEl0ZW1zKQogICAgICAgIHNlbGYub3B0aW9ucy5mcmVlSW5wdXQgPSBmYWxzZTsKCiAgICAgIG1ha2VPcHRpb25JdGVtRnVuY3Rpb24oc2VsZi5vcHRpb25zLCAnaXRlbVZhbHVlJyk7CiAgICAgIG1ha2VPcHRpb25JdGVtRnVuY3Rpb24oc2VsZi5vcHRpb25zLCAnaXRlbVRleHQnKTsKICAgICAgbWFrZU9wdGlvbkZ1bmN0aW9uKHNlbGYub3B0aW9ucywgJ3RhZ0NsYXNzJyk7CiAgICAgIAogICAgICAvLyBUeXBlYWhlYWQgQm9vdHN0cmFwIHZlcnNpb24gMi4zLjIKICAgICAgaWYgKHNlbGYub3B0aW9ucy50eXBlYWhlYWQpIHsKICAgICAgICB2YXIgdHlwZWFoZWFkID0gc2VsZi5vcHRpb25zLnR5cGVhaGVhZCB8fCB7fTsKCiAgICAgICAgbWFrZU9wdGlvbkZ1bmN0aW9uKHR5cGVhaGVhZCwgJ3NvdXJjZScpOwoKICAgICAgICBzZWxmLiRpbnB1dC50eXBlYWhlYWQoJC5leHRlbmQoe30sIHR5cGVhaGVhZCwgewogICAgICAgICAgc291cmNlOiBmdW5jdGlvbiAocXVlcnksIHByb2Nlc3MpIHsKICAgICAgICAgICAgZnVuY3Rpb24gcHJvY2Vzc0l0ZW1zKGl0ZW1zKSB7CiAgICAgICAgICAgICAgdmFyIHRleHRzID0gW107CgogICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gc2VsZi5vcHRpb25zLml0ZW1UZXh0KGl0ZW1zW2ldKTsKICAgICAgICAgICAgICAgIG1hcFt0ZXh0XSA9IGl0ZW1zW2ldOwogICAgICAgICAgICAgICAgdGV4dHMucHVzaCh0ZXh0KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgcHJvY2Vzcyh0ZXh0cyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMubWFwID0ge307CiAgICAgICAgICAgIHZhciBtYXAgPSB0aGlzLm1hcCwKICAgICAgICAgICAgICAgIGRhdGEgPSB0eXBlYWhlYWQuc291cmNlKHF1ZXJ5KTsKCiAgICAgICAgICAgIGlmICgkLmlzRnVuY3Rpb24oZGF0YS5zdWNjZXNzKSkgewogICAgICAgICAgICAgIC8vIHN1cHBvcnQgZm9yIEFuZ3VsYXIgY2FsbGJhY2tzCiAgICAgICAgICAgICAgZGF0YS5zdWNjZXNzKHByb2Nlc3NJdGVtcyk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoJC5pc0Z1bmN0aW9uKGRhdGEudGhlbikpIHsKICAgICAgICAgICAgICAvLyBzdXBwb3J0IGZvciBBbmd1bGFyIHByb21pc2VzCiAgICAgICAgICAgICAgZGF0YS50aGVuKHByb2Nlc3NJdGVtcyk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8gc3VwcG9ydCBmb3IgZnVuY3Rpb25zIGFuZCBqcXVlcnkgcHJvbWlzZXMKICAgICAgICAgICAgICAkLndoZW4oZGF0YSkKICAgICAgICAgICAgICAgLnRoZW4ocHJvY2Vzc0l0ZW1zKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSwKICAgICAgICAgIHVwZGF0ZXI6IGZ1bmN0aW9uICh0ZXh0KSB7CiAgICAgICAgICAgIHNlbGYuYWRkKHRoaXMubWFwW3RleHRdKTsKICAgICAgICAgIH0sCiAgICAgICAgICBtYXRjaGVyOiBmdW5jdGlvbiAodGV4dCkgewogICAgICAgICAgICByZXR1cm4gKHRleHQudG9Mb3dlckNhc2UoKS5pbmRleE9mKHRoaXMucXVlcnkudHJpbSgpLnRvTG93ZXJDYXNlKCkpICE9PSAtMSk7CiAgICAgICAgICB9LAogICAgICAgICAgc29ydGVyOiBmdW5jdGlvbiAodGV4dHMpIHsKICAgICAgICAgICAgcmV0dXJuIHRleHRzLnNvcnQoKTsKICAgICAgICAgIH0sCiAgICAgICAgICBoaWdobGlnaHRlcjogZnVuY3Rpb24gKHRleHQpIHsKICAgICAgICAgICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cCggJygnICsgdGhpcy5xdWVyeSArICcpJywgJ2dpJyApOwogICAgICAgICAgICByZXR1cm4gdGV4dC5yZXBsYWNlKCByZWdleCwgIjxzdHJvbmc+JDE8L3N0cm9uZz4iICk7CiAgICAgICAgICB9CiAgICAgICAgfSkpOwogICAgICB9CgogICAgICAvLyB0eXBlYWhlYWQuanMKICAgICAgaWYgKHNlbGYub3B0aW9ucy50eXBlYWhlYWRqcykgewogICAgICAgICAgdmFyIHR5cGVhaGVhZGpzID0gc2VsZi5vcHRpb25zLnR5cGVhaGVhZGpzIHx8IHt9OwogICAgICAgICAgCiAgICAgICAgICBzZWxmLiRpbnB1dC50eXBlYWhlYWQobnVsbCwgdHlwZWFoZWFkanMpLm9uKCd0eXBlYWhlYWQ6c2VsZWN0ZWQnLCAkLnByb3h5KGZ1bmN0aW9uIChvYmosIGRhdHVtKSB7CiAgICAgICAgICAgIGlmICh0eXBlYWhlYWRqcy52YWx1ZUtleSkKICAgICAgICAgICAgICBzZWxmLmFkZChkYXR1bVt0eXBlYWhlYWRqcy52YWx1ZUtleV0pOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgc2VsZi5hZGQoZGF0dW0pOwogICAgICAgICAgICBzZWxmLiRpbnB1dC50eXBlYWhlYWQoJ3ZhbCcsICcnKTsKICAgICAgICAgIH0sIHNlbGYpKTsKICAgICAgfQoKICAgICAgc2VsZi4kY29udGFpbmVyLm9uKCdjbGljaycsICQucHJveHkoZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICBpZiAoISBzZWxmLiRlbGVtZW50LmF0dHIoJ2Rpc2FibGVkJykpIHsKICAgICAgICAgIHNlbGYuJGlucHV0LnJlbW92ZUF0dHIoJ2Rpc2FibGVkJyk7CiAgICAgICAgfQogICAgICAgIHNlbGYuJGlucHV0LmZvY3VzKCk7CiAgICAgIH0sIHNlbGYpKTsKCiAgICAgICAgaWYgKHNlbGYub3B0aW9ucy5hZGRPbkJsdXIgJiYgc2VsZi5vcHRpb25zLmZyZWVJbnB1dCkgewogICAgICAgICAgc2VsZi4kaW5wdXQub24oJ2ZvY3Vzb3V0JywgJC5wcm94eShmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICAgIC8vIEhBQ0s6IG9ubHkgcHJvY2VzcyBvbiBmb2N1c291dCB3aGVuIG5vIHR5cGVhaGVhZCBvcGVuZWQsIHRvCiAgICAgICAgICAgICAgLy8gICAgICAgYXZvaWQgYWRkaW5nIHRoZSB0eXBlYWhlYWQgdGV4dCBhcyB0YWcKICAgICAgICAgICAgICBpZiAoJCgnLnR5cGVhaGVhZCwgLnR3aXR0ZXItdHlwZWFoZWFkJywgc2VsZi4kY29udGFpbmVyKS5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgICAgIHNlbGYuYWRkKHNlbGYuJGlucHV0LnZhbCgpKTsKICAgICAgICAgICAgICAgIHNlbGYuJGlucHV0LnZhbCgnJyk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgfSwgc2VsZikpOwogICAgICAgIH0KICAgICAgICAKCiAgICAgIHNlbGYuJGNvbnRhaW5lci5vbigna2V5ZG93bicsICdpbnB1dCcsICQucHJveHkoZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICB2YXIgJGlucHV0ID0gJChldmVudC50YXJnZXQpLAogICAgICAgICAgICAkaW5wdXRXcmFwcGVyID0gc2VsZi5maW5kSW5wdXRXcmFwcGVyKCk7CgogICAgICAgIGlmIChzZWxmLiRlbGVtZW50LmF0dHIoJ2Rpc2FibGVkJykpIHsKICAgICAgICAgIHNlbGYuJGlucHV0LmF0dHIoJ2Rpc2FibGVkJywgJ2Rpc2FibGVkJyk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBzd2l0Y2ggKGV2ZW50LndoaWNoKSB7CiAgICAgICAgICAvLyBCQUNLU1BBQ0UKICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgaWYgKGRvR2V0Q2FyZXRQb3NpdGlvbigkaW5wdXRbMF0pID09PSAwKSB7CiAgICAgICAgICAgICAgdmFyIHByZXYgPSAkaW5wdXRXcmFwcGVyLnByZXYoKTsKICAgICAgICAgICAgICBpZiAocHJldikgewogICAgICAgICAgICAgICAgc2VsZi5yZW1vdmUocHJldi5kYXRhKCdpdGVtJykpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAvLyBERUxFVEUKICAgICAgICAgIGNhc2UgNDY6CiAgICAgICAgICAgIGlmIChkb0dldENhcmV0UG9zaXRpb24oJGlucHV0WzBdKSA9PT0gMCkgewogICAgICAgICAgICAgIHZhciBuZXh0ID0gJGlucHV0V3JhcHBlci5uZXh0KCk7CiAgICAgICAgICAgICAgaWYgKG5leHQpIHsKICAgICAgICAgICAgICAgIHNlbGYucmVtb3ZlKG5leHQuZGF0YSgnaXRlbScpKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgLy8gTEVGVCBBUlJPVwogICAgICAgICAgY2FzZSAzNzoKICAgICAgICAgICAgLy8gVHJ5IHRvIG1vdmUgdGhlIGlucHV0IGJlZm9yZSB0aGUgcHJldmlvdXMgdGFnCiAgICAgICAgICAgIHZhciAkcHJldlRhZyA9ICRpbnB1dFdyYXBwZXIucHJldigpOwogICAgICAgICAgICBpZiAoJGlucHV0LnZhbCgpLmxlbmd0aCA9PT0gMCAmJiAkcHJldlRhZ1swXSkgewogICAgICAgICAgICAgICRwcmV2VGFnLmJlZm9yZSgkaW5wdXRXcmFwcGVyKTsKICAgICAgICAgICAgICAkaW5wdXQuZm9jdXMoKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIC8vIFJJR0hUIEFSUk9XCiAgICAgICAgICBjYXNlIDM5OgogICAgICAgICAgICAvLyBUcnkgdG8gbW92ZSB0aGUgaW5wdXQgYWZ0ZXIgdGhlIG5leHQgdGFnCiAgICAgICAgICAgIHZhciAkbmV4dFRhZyA9ICRpbnB1dFdyYXBwZXIubmV4dCgpOwogICAgICAgICAgICBpZiAoJGlucHV0LnZhbCgpLmxlbmd0aCA9PT0gMCAmJiAkbmV4dFRhZ1swXSkgewogICAgICAgICAgICAgICRuZXh0VGFnLmFmdGVyKCRpbnB1dFdyYXBwZXIpOwogICAgICAgICAgICAgICRpbnB1dC5mb2N1cygpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgLy8gaWdub3JlCiAgICAgICAgIH0KCiAgICAgICAgLy8gUmVzZXQgaW50ZXJuYWwgaW5wdXQncyBzaXplCiAgICAgICAgdmFyIHRleHRMZW5ndGggPSAkaW5wdXQudmFsKCkubGVuZ3RoLAogICAgICAgICAgICB3b3JkU3BhY2UgPSBNYXRoLmNlaWwodGV4dExlbmd0aCAvIDUpLAogICAgICAgICAgICBzaXplID0gdGV4dExlbmd0aCArIHdvcmRTcGFjZSArIDE7CiAgICAgICAgJGlucHV0LmF0dHIoJ3NpemUnLCBNYXRoLm1heCh0aGlzLmlucHV0U2l6ZSwgJGlucHV0LnZhbCgpLmxlbmd0aCkpOwogICAgICB9LCBzZWxmKSk7CgogICAgICBzZWxmLiRjb250YWluZXIub24oJ2tleXByZXNzJywgJ2lucHV0JywgJC5wcm94eShmdW5jdGlvbihldmVudCkgewogICAgICAgICB2YXIgJGlucHV0ID0gJChldmVudC50YXJnZXQpOwoKICAgICAgICAgaWYgKHNlbGYuJGVsZW1lbnQuYXR0cignZGlzYWJsZWQnKSkgewogICAgICAgICAgICBzZWxmLiRpbnB1dC5hdHRyKCdkaXNhYmxlZCcsICdkaXNhYmxlZCcpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgIH0KCiAgICAgICAgIHZhciB0ZXh0ID0gJGlucHV0LnZhbCgpLAogICAgICAgICBtYXhMZW5ndGhSZWFjaGVkID0gc2VsZi5vcHRpb25zLm1heENoYXJzICYmIHRleHQubGVuZ3RoID49IHNlbGYub3B0aW9ucy5tYXhDaGFyczsKICAgICAgICAgaWYgKHNlbGYub3B0aW9ucy5mcmVlSW5wdXQgJiYgKGtleUNvbWJpbmF0aW9uSW5MaXN0KGV2ZW50LCBzZWxmLm9wdGlvbnMuY29uZmlybUtleXMpIHx8IG1heExlbmd0aFJlYWNoZWQpKSB7CiAgICAgICAgICAgIHNlbGYuYWRkKG1heExlbmd0aFJlYWNoZWQgPyB0ZXh0LnN1YnN0cigwLCBzZWxmLm9wdGlvbnMubWF4Q2hhcnMpIDogdGV4dCk7CiAgICAgICAgICAgICRpbnB1dC52YWwoJycpOwogICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgICB9CgogICAgICAgICAvLyBSZXNldCBpbnRlcm5hbCBpbnB1dCdzIHNpemUKICAgICAgICAgdmFyIHRleHRMZW5ndGggPSAkaW5wdXQudmFsKCkubGVuZ3RoLAogICAgICAgICAgICB3b3JkU3BhY2UgPSBNYXRoLmNlaWwodGV4dExlbmd0aCAvIDUpLAogICAgICAgICAgICBzaXplID0gdGV4dExlbmd0aCArIHdvcmRTcGFjZSArIDE7CiAgICAgICAgICRpbnB1dC5hdHRyKCdzaXplJywgTWF0aC5tYXgodGhpcy5pbnB1dFNpemUsICRpbnB1dC52YWwoKS5sZW5ndGgpKTsKICAgICAgfSwgc2VsZikpOwoKICAgICAgLy8gUmVtb3ZlIGljb24gY2xpY2tlZAogICAgICBzZWxmLiRjb250YWluZXIub24oJ2NsaWNrJywgJ1tkYXRhLXJvbGU9cmVtb3ZlXScsICQucHJveHkoZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICBpZiAoc2VsZi4kZWxlbWVudC5hdHRyKCdkaXNhYmxlZCcpKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHNlbGYucmVtb3ZlKCQoZXZlbnQudGFyZ2V0KS5jbG9zZXN0KCcudGFnJykuZGF0YSgnaXRlbScpKTsKICAgICAgfSwgc2VsZikpOwoKICAgICAgLy8gT25seSBhZGQgZXhpc3RpbmcgdmFsdWUgYXMgdGFncyB3aGVuIHVzaW5nIHN0cmluZ3MgYXMgdGFncwogICAgICBpZiAoc2VsZi5vcHRpb25zLml0ZW1WYWx1ZSA9PT0gZGVmYXVsdE9wdGlvbnMuaXRlbVZhbHVlKSB7CiAgICAgICAgaWYgKHNlbGYuJGVsZW1lbnRbMF0udGFnTmFtZSA9PT0gJ0lOUFVUJykgewogICAgICAgICAgICBzZWxmLmFkZChzZWxmLiRlbGVtZW50LnZhbCgpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgJCgnb3B0aW9uJywgc2VsZi4kZWxlbWVudCkuZWFjaChmdW5jdGlvbigpIHsKICAgICAgICAgICAgc2VsZi5hZGQoJCh0aGlzKS5hdHRyKCd2YWx1ZScpLCB0cnVlKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICAvKioKICAgICAqIFJlbW92ZXMgYWxsIHRhZ3NpbnB1dCBiZWhhdmlvdXIgYW5kIHVucmVnc2l0ZXIgYWxsIGV2ZW50IGhhbmRsZXJzCiAgICAgKi8KICAgIGRlc3Ryb3k6IGZ1bmN0aW9uKCkgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CgogICAgICAvLyBVbmJpbmQgZXZlbnRzCiAgICAgIHNlbGYuJGNvbnRhaW5lci5vZmYoJ2tleXByZXNzJywgJ2lucHV0Jyk7CiAgICAgIHNlbGYuJGNvbnRhaW5lci5vZmYoJ2NsaWNrJywgJ1tyb2xlPXJlbW92ZV0nKTsKCiAgICAgIHNlbGYuJGNvbnRhaW5lci5yZW1vdmUoKTsKICAgICAgc2VsZi4kZWxlbWVudC5yZW1vdmVEYXRhKCd0YWdzaW5wdXQnKTsKICAgICAgc2VsZi4kZWxlbWVudC5zaG93KCk7CiAgICB9LAoKICAgIC8qKgogICAgICogU2V0cyBmb2N1cyBvbiB0aGUgdGFnc2lucHV0CiAgICAgKi8KICAgIGZvY3VzOiBmdW5jdGlvbigpIHsKICAgICAgdGhpcy4kaW5wdXQuZm9jdXMoKTsKICAgIH0sCgogICAgLyoqCiAgICAgKiBSZXR1cm5zIHRoZSBpbnRlcm5hbCBpbnB1dCBlbGVtZW50CiAgICAgKi8KICAgIGlucHV0OiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuJGlucHV0OwogICAgfSwKCiAgICAvKioKICAgICAqIFJldHVybnMgdGhlIGVsZW1lbnQgd2hpY2ggaXMgd3JhcHBlZCBhcm91bmQgdGhlIGludGVybmFsIGlucHV0LiBUaGlzCiAgICAgKiBpcyBub3JtYWxseSB0aGUgJGNvbnRhaW5lciwgYnV0IHR5cGVhaGVhZC5qcyBtb3ZlcyB0aGUgJGlucHV0IGVsZW1lbnQuCiAgICAgKi8KICAgIGZpbmRJbnB1dFdyYXBwZXI6IGZ1bmN0aW9uKCkgewogICAgICB2YXIgZWx0ID0gdGhpcy4kaW5wdXRbMF0sCiAgICAgICAgICBjb250YWluZXIgPSB0aGlzLiRjb250YWluZXJbMF07CiAgICAgIHdoaWxlKGVsdCAmJiBlbHQucGFyZW50Tm9kZSAhPT0gY29udGFpbmVyKQogICAgICAgIGVsdCA9IGVsdC5wYXJlbnROb2RlOwoKICAgICAgcmV0dXJuICQoZWx0KTsKICAgIH0KICB9OwoKICAvKioKICAgKiBSZWdpc3RlciBKUXVlcnkgcGx1Z2luCiAgICovCiAgJC5mbi50YWdzaW5wdXQgPSBmdW5jdGlvbihhcmcxLCBhcmcyKSB7CiAgICB2YXIgcmVzdWx0cyA9IFtdOwoKICAgIHRoaXMuZWFjaChmdW5jdGlvbigpIHsKICAgICAgdmFyIHRhZ3NpbnB1dCA9ICQodGhpcykuZGF0YSgndGFnc2lucHV0Jyk7CiAgICAgIC8vIEluaXRpYWxpemUgYSBuZXcgdGFncyBpbnB1dAogICAgICBpZiAoIXRhZ3NpbnB1dCkgewogICAgICAgICAgdGFnc2lucHV0ID0gbmV3IFRhZ3NJbnB1dCh0aGlzLCBhcmcxKTsKICAgICAgICAgICQodGhpcykuZGF0YSgndGFnc2lucHV0JywgdGFnc2lucHV0KTsKICAgICAgICAgIHJlc3VsdHMucHVzaCh0YWdzaW5wdXQpOwoKICAgICAgICAgIGlmICh0aGlzLnRhZ05hbWUgPT09ICdTRUxFQ1QnKSB7CiAgICAgICAgICAgICAgJCgnb3B0aW9uJywgJCh0aGlzKSkuYXR0cignc2VsZWN0ZWQnLCAnc2VsZWN0ZWQnKTsKICAgICAgICAgIH0KCiAgICAgICAgICAvLyBJbml0IHRhZ3MgZnJvbSAkKHRoaXMpLnZhbCgpCiAgICAgICAgICAkKHRoaXMpLnZhbCgkKHRoaXMpLnZhbCgpKTsKICAgICAgfSBlbHNlIGlmICghYXJnMSAmJiAhYXJnMikgewogICAgICAgICAgLy8gdGFnc2lucHV0IGFscmVhZHkgZXhpc3RzCiAgICAgICAgICAvLyBubyBmdW5jdGlvbiwgdHJ5aW5nIHRvIGluaXQKICAgICAgICAgIHJlc3VsdHMucHVzaCh0YWdzaW5wdXQpOwogICAgICB9IGVsc2UgaWYodGFnc2lucHV0W2FyZzFdICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIC8vIEludm9rZSBmdW5jdGlvbiBvbiBleGlzdGluZyB0YWdzIGlucHV0CiAgICAgICAgICB2YXIgcmV0VmFsID0gdGFnc2lucHV0W2FyZzFdKGFyZzIpOwogICAgICAgICAgaWYgKHJldFZhbCAhPT0gdW5kZWZpbmVkKQogICAgICAgICAgICAgIHJlc3VsdHMucHVzaChyZXRWYWwpOwogICAgICB9CiAgICB9KTsKCiAgICBpZiAoIHR5cGVvZiBhcmcxID09ICdzdHJpbmcnKSB7CiAgICAgIC8vIFJldHVybiB0aGUgcmVzdWx0cyBmcm9tIHRoZSBpbnZva2VkIGZ1bmN0aW9uIGNhbGxzCiAgICAgIHJldHVybiByZXN1bHRzLmxlbmd0aCA+IDEgPyByZXN1bHRzIDogcmVzdWx0c1swXTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiByZXN1bHRzOwogICAgfQogIH07CgogICQuZm4udGFnc2lucHV0LkNvbnN0cnVjdG9yID0gVGFnc0lucHV0OwoKICAvKioKICAgKiBNb3N0IG9wdGlvbnMgc3VwcG9ydCBib3RoIGEgc3RyaW5nIG9yIG51bWJlciBhcyB3ZWxsIGFzIGEgZnVuY3Rpb24gYXMKICAgKiBvcHRpb24gdmFsdWUuIFRoaXMgZnVuY3Rpb24gbWFrZXMgc3VyZSB0aGF0IHRoZSBvcHRpb24gd2l0aCB0aGUgZ2l2ZW4KICAgKiBrZXkgaW4gdGhlIGdpdmVuIG9wdGlvbnMgaXMgd3JhcHBlZCBpbiBhIGZ1bmN0aW9uCiAgICovCiAgZnVuY3Rpb24gbWFrZU9wdGlvbkl0ZW1GdW5jdGlvbihvcHRpb25zLCBrZXkpIHsKICAgIGlmICh0eXBlb2Ygb3B0aW9uc1trZXldICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgIHZhciBwcm9wZXJ0eU5hbWUgPSBvcHRpb25zW2tleV07CiAgICAgIG9wdGlvbnNba2V5XSA9IGZ1bmN0aW9uKGl0ZW0pIHsgcmV0dXJuIGl0ZW1bcHJvcGVydHlOYW1lXTsgfTsKICAgIH0KICB9CiAgZnVuY3Rpb24gbWFrZU9wdGlvbkZ1bmN0aW9uKG9wdGlvbnMsIGtleSkgewogICAgaWYgKHR5cGVvZiBvcHRpb25zW2tleV0gIT09ICdmdW5jdGlvbicpIHsKICAgICAgdmFyIHZhbHVlID0gb3B0aW9uc1trZXldOwogICAgICBvcHRpb25zW2tleV0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHZhbHVlOyB9OwogICAgfQogIH0KICAvKioKICAgKiBIdG1sRW5jb2RlcyB0aGUgZ2l2ZW4gdmFsdWUKICAgKi8KICB2YXIgaHRtbEVuY29kZUNvbnRhaW5lciA9ICQoJzxkaXYgLz4nKTsKICBmdW5jdGlvbiBodG1sRW5jb2RlKHZhbHVlKSB7CiAgICBpZiAodmFsdWUpIHsKICAgICAgcmV0dXJuIGh0bWxFbmNvZGVDb250YWluZXIudGV4dCh2YWx1ZSkuaHRtbCgpOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuICcnOwogICAgfQogIH0KCiAgLyoqCiAgICogUmV0dXJucyB0aGUgcG9zaXRpb24gb2YgdGhlIGNhcmV0IGluIHRoZSBnaXZlbiBpbnB1dCBmaWVsZAogICAqIGh0dHA6Ly9mbGlnaHRzY2hvb2wuYWN5bHQuY29tL2Rldm5vdGVzL2NhcmV0LXBvc2l0aW9uLXdvZXMvCiAgICovCiAgZnVuY3Rpb24gZG9HZXRDYXJldFBvc2l0aW9uKG9GaWVsZCkgewogICAgdmFyIGlDYXJldFBvcyA9IDA7CiAgICBpZiAoZG9jdW1lbnQuc2VsZWN0aW9uKSB7CiAgICAgIG9GaWVsZC5mb2N1cyAoKTsKICAgICAgdmFyIG9TZWwgPSBkb2N1bWVudC5zZWxlY3Rpb24uY3JlYXRlUmFuZ2UoKTsKICAgICAgb1NlbC5tb3ZlU3RhcnQgKCdjaGFyYWN0ZXInLCAtb0ZpZWxkLnZhbHVlLmxlbmd0aCk7CiAgICAgIGlDYXJldFBvcyA9IG9TZWwudGV4dC5sZW5ndGg7CiAgICB9IGVsc2UgaWYgKG9GaWVsZC5zZWxlY3Rpb25TdGFydCB8fCBvRmllbGQuc2VsZWN0aW9uU3RhcnQgPT0gJzAnKSB7CiAgICAgIGlDYXJldFBvcyA9IG9GaWVsZC5zZWxlY3Rpb25TdGFydDsKICAgIH0KICAgIHJldHVybiAoaUNhcmV0UG9zKTsKICB9CgogIC8qKgogICAgKiBSZXR1cm5zIGJvb2xlYW4gaW5kaWNhdGVzIHdoZXRoZXIgdXNlciBoYXMgcHJlc3NlZCBhbiBleHBlY3RlZCBrZXkgY29tYmluYXRpb24uIAogICAgKiBAcGFyYW0gb2JqZWN0IGtleVByZXNzRXZlbnQ6IEphdmFTY3JpcHQgZXZlbnQgb2JqZWN0LCByZWZlcgogICAgKiAgICAgaHR0cDovL3d3dy53My5vcmcvVFIvMjAwMy9XRC1ET00tTGV2ZWwtMy1FdmVudHMtMjAwMzAzMzEvZWNtYS1zY3JpcHQtYmluZGluZy5odG1sCiAgICAqIEBwYXJhbSBvYmplY3QgbG9va3VwTGlzdDogZXhwZWN0ZWQga2V5IGNvbWJpbmF0aW9ucywgYXMgaW46CiAgICAqICAgICBbMTMsIHt3aGljaDogMTg4LCBzaGlmdEtleTogdHJ1ZX1dCiAgICAqLwogIGZ1bmN0aW9uIGtleUNvbWJpbmF0aW9uSW5MaXN0KGtleVByZXNzRXZlbnQsIGxvb2t1cExpc3QpIHsKICAgICAgdmFyIGZvdW5kID0gZmFsc2U7CiAgICAgICQuZWFjaChsb29rdXBMaXN0LCBmdW5jdGlvbiAoaW5kZXgsIGtleUNvbWJpbmF0aW9uKSB7CiAgICAgICAgICBpZiAodHlwZW9mIChrZXlDb21iaW5hdGlvbikgPT09ICdudW1iZXInICYmIGtleVByZXNzRXZlbnQud2hpY2ggPT09IGtleUNvbWJpbmF0aW9uKSB7CiAgICAgICAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoa2V5UHJlc3NFdmVudC53aGljaCA9PT0ga2V5Q29tYmluYXRpb24ud2hpY2gpIHsKICAgICAgICAgICAgICB2YXIgYWx0ID0gIWtleUNvbWJpbmF0aW9uLmhhc093blByb3BlcnR5KCdhbHRLZXknKSB8fCBrZXlQcmVzc0V2ZW50LmFsdEtleSA9PT0ga2V5Q29tYmluYXRpb24uYWx0S2V5LAogICAgICAgICAgICAgICAgICBzaGlmdCA9ICFrZXlDb21iaW5hdGlvbi5oYXNPd25Qcm9wZXJ0eSgnc2hpZnRLZXknKSB8fCBrZXlQcmVzc0V2ZW50LnNoaWZ0S2V5ID09PSBrZXlDb21iaW5hdGlvbi5zaGlmdEtleSwKICAgICAgICAgICAgICAgICAgY3RybCA9ICFrZXlDb21iaW5hdGlvbi5oYXNPd25Qcm9wZXJ0eSgnY3RybEtleScpIHx8IGtleVByZXNzRXZlbnQuY3RybEtleSA9PT0ga2V5Q29tYmluYXRpb24uY3RybEtleTsKICAgICAgICAgICAgICBpZiAoYWx0ICYmIHNoaWZ0ICYmIGN0cmwpIHsKICAgICAgICAgICAgICAgICAgZm91bmQgPSB0cnVlOwogICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICB9KTsKCiAgICAgIHJldHVybiBmb3VuZDsKICB9CgogIC8qKgogICAqIEluaXRpYWxpemUgdGFnc2lucHV0IGJlaGF2aW91ciBvbiBpbnB1dHMgYW5kIHNlbGVjdHMgd2hpY2ggaGF2ZQogICAqIGRhdGEtcm9sZT10YWdzaW5wdXQKICAgKi8KICAkKGZ1bmN0aW9uKCkgewogICAgJCgiaW5wdXRbZGF0YS1yb2xlPXRhZ3NpbnB1dF0sIHNlbGVjdFttdWx0aXBsZV1bZGF0YS1yb2xlPXRhZ3NpbnB1dF0iKS50YWdzaW5wdXQoKTsKICB9KTsKfSkod2luZG93LmpRdWVyeSk7Cg==",
    "size": "19924"
}