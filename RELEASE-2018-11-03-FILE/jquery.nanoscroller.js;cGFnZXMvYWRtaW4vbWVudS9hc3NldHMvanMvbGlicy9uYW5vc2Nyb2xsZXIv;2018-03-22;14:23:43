{
    "namaFile": "pages\/admin\/menu\/assets\/js\/libs\/nanoscroller\/jquery.nanoscroller.js",
    "lastUpdate": "2018-03-22+14:23:43.07",
    "contentFile": "LyohIG5hbm9TY3JvbGxlckpTIC0gdjAuOC40IC0gMjAxNAoqIGh0dHA6Ly9qYW1lc2Zsb3JlbnRpbm8uZ2l0aHViLmNvbS9uYW5vU2Nyb2xsZXJKUy8KKiBDb3B5cmlnaHQgKGMpIDIwMTQgSmFtZXMgRmxvcmVudGlubzsgTGljZW5zZWQgTUlUICovCihmdW5jdGlvbihmYWN0b3J5KSB7CiAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkgewogICAgcmV0dXJuIGRlZmluZShbJ2pxdWVyeSddLCBmdW5jdGlvbigkKSB7CiAgICAgIHJldHVybiBmYWN0b3J5KCQsIHdpbmRvdywgZG9jdW1lbnQpOwogICAgfSk7CiAgfSBlbHNlIHsKICAgIHJldHVybiBmYWN0b3J5KGpRdWVyeSwgd2luZG93LCBkb2N1bWVudCk7CiAgfQp9KShmdW5jdGlvbigkLCB3aW5kb3csIGRvY3VtZW50KSB7CiAgInVzZSBzdHJpY3QiOwogIHZhciBCUk9XU0VSX0lTX0lFNywgQlJPV1NFUl9TQ1JPTExCQVJfV0lEVEgsIERPTVNDUk9MTCwgRE9XTiwgRFJBRywgRU5URVIsIEtFWURPV04sIEtFWVVQLCBNT1VTRURPV04sIE1PVVNFRU5URVIsIE1PVVNFTU9WRSwgTU9VU0VVUCwgTU9VU0VXSEVFTCwgTmFub1Njcm9sbCwgUEFORURPV04sIFJFU0laRSwgU0NST0xMLCBTQ1JPTExCQVIsIFRPVUNITU9WRSwgVVAsIFdIRUVMLCBjQUYsIGRlZmF1bHRzLCBnZXRCcm93c2VyU2Nyb2xsYmFyV2lkdGgsIGhhc1RyYW5zZm9ybSwgaXNGRldpdGhCdWdneVNjcm9sbGJhciwgckFGLCB0cmFuc2Zvcm0sIF9lbGVtZW50U3R5bGUsIF9wcmVmaXhTdHlsZSwgX3ZlbmRvcjsKICBkZWZhdWx0cyA9IHsKCiAgICAvKioKICAgICAgYSBjbGFzc25hbWUgZm9yIHRoZSBwYW5lIGVsZW1lbnQuCiAgICAgIEBwcm9wZXJ0eSBwYW5lQ2xhc3MKICAgICAgQHR5cGUgU3RyaW5nCiAgICAgIEBkZWZhdWx0ICduYW5vLXBhbmUnCiAgICAgKi8KICAgIHBhbmVDbGFzczogJ25hbm8tcGFuZScsCgogICAgLyoqCiAgICAgIGEgY2xhc3NuYW1lIGZvciB0aGUgc2xpZGVyIGVsZW1lbnQuCiAgICAgIEBwcm9wZXJ0eSBzbGlkZXJDbGFzcwogICAgICBAdHlwZSBTdHJpbmcKICAgICAgQGRlZmF1bHQgJ25hbm8tc2xpZGVyJwogICAgICovCiAgICBzbGlkZXJDbGFzczogJ25hbm8tc2xpZGVyJywKCiAgICAvKioKICAgICAgYSBjbGFzc25hbWUgZm9yIHRoZSBjb250ZW50IGVsZW1lbnQuCiAgICAgIEBwcm9wZXJ0eSBjb250ZW50Q2xhc3MKICAgICAgQHR5cGUgU3RyaW5nCiAgICAgIEBkZWZhdWx0ICduYW5vLWNvbnRlbnQnCiAgICAgKi8KICAgIGNvbnRlbnRDbGFzczogJ25hbm8tY29udGVudCcsCgogICAgLyoqCiAgICAgIGEgc2V0dGluZyB0byBlbmFibGUgbmF0aXZlIHNjcm9sbGluZyBpbiBpT1MgZGV2aWNlcy4KICAgICAgQHByb3BlcnR5IGlPU05hdGl2ZVNjcm9sbGluZwogICAgICBAdHlwZSBCb29sZWFuCiAgICAgIEBkZWZhdWx0IGZhbHNlCiAgICAgKi8KICAgIGlPU05hdGl2ZVNjcm9sbGluZzogZmFsc2UsCgogICAgLyoqCiAgICAgIGEgc2V0dGluZyB0byBwcmV2ZW50IHRoZSByZXN0IG9mIHRoZSBwYWdlIGJlaW5nCiAgICAgIHNjcm9sbGVkIHdoZW4gdXNlciBzY3JvbGxzIHRoZSBgLmNvbnRlbnRgIGVsZW1lbnQuCiAgICAgIEBwcm9wZXJ0eSBwcmV2ZW50UGFnZVNjcm9sbGluZwogICAgICBAdHlwZSBCb29sZWFuCiAgICAgIEBkZWZhdWx0IGZhbHNlCiAgICAgKi8KICAgIHByZXZlbnRQYWdlU2Nyb2xsaW5nOiBmYWxzZSwKCiAgICAvKioKICAgICAgYSBzZXR0aW5nIHRvIGRpc2FibGUgYmluZGluZyB0byB0aGUgcmVzaXplIGV2ZW50LgogICAgICBAcHJvcGVydHkgZGlzYWJsZVJlc2l6ZQogICAgICBAdHlwZSBCb29sZWFuCiAgICAgIEBkZWZhdWx0IGZhbHNlCiAgICAgKi8KICAgIGRpc2FibGVSZXNpemU6IGZhbHNlLAoKICAgIC8qKgogICAgICBhIHNldHRpbmcgdG8gbWFrZSB0aGUgc2Nyb2xsYmFyIGFsd2F5cyB2aXNpYmxlLgogICAgICBAcHJvcGVydHkgYWx3YXlzVmlzaWJsZQogICAgICBAdHlwZSBCb29sZWFuCiAgICAgIEBkZWZhdWx0IGZhbHNlCiAgICAgKi8KICAgIGFsd2F5c1Zpc2libGU6IGZhbHNlLAoKICAgIC8qKgogICAgICBhIGRlZmF1bHQgdGltZW91dCBmb3IgdGhlIGBmbGFzaCgpYCBtZXRob2QuCiAgICAgIEBwcm9wZXJ0eSBmbGFzaERlbGF5CiAgICAgIEB0eXBlIE51bWJlcgogICAgICBAZGVmYXVsdCAxNTAwCiAgICAgKi8KICAgIGZsYXNoRGVsYXk6IDE1MDAsCgogICAgLyoqCiAgICAgIGEgbWluaW11bSBoZWlnaHQgZm9yIHRoZSBgLnNsaWRlcmAgZWxlbWVudC4KICAgICAgQHByb3BlcnR5IHNsaWRlck1pbkhlaWdodAogICAgICBAdHlwZSBOdW1iZXIKICAgICAgQGRlZmF1bHQgMjAKICAgICAqLwogICAgc2xpZGVyTWluSGVpZ2h0OiAyMCwKCiAgICAvKioKICAgICAgYSBtYXhpbXVtIGhlaWdodCBmb3IgdGhlIGAuc2xpZGVyYCBlbGVtZW50LgogICAgICBAcHJvcGVydHkgc2xpZGVyTWF4SGVpZ2h0CiAgICAgIEB0eXBlIE51bWJlcgogICAgICBAZGVmYXVsdCBudWxsCiAgICAgKi8KICAgIHNsaWRlck1heEhlaWdodDogbnVsbCwKCiAgICAvKioKICAgICAgYW4gYWx0ZXJuYXRlIGRvY3VtZW50IGNvbnRleHQuCiAgICAgIEBwcm9wZXJ0eSBkb2N1bWVudENvbnRleHQKICAgICAgQHR5cGUgRG9jdW1lbnQKICAgICAgQGRlZmF1bHQgbnVsbAogICAgICovCiAgICBkb2N1bWVudENvbnRleHQ6IG51bGwsCgogICAgLyoqCiAgICAgIGFuIGFsdGVybmF0ZSB3aW5kb3cgY29udGV4dC4KICAgICAgQHByb3BlcnR5IHdpbmRvd0NvbnRleHQKICAgICAgQHR5cGUgV2luZG93CiAgICAgIEBkZWZhdWx0IG51bGwKICAgICAqLwogICAgd2luZG93Q29udGV4dDogbnVsbAogIH07CgogIC8qKgogICAgQHByb3BlcnR5IFNDUk9MTEJBUgogICAgQHR5cGUgU3RyaW5nCiAgICBAc3RhdGljCiAgICBAZmluYWwKICAgIEBwcml2YXRlCiAgICovCiAgU0NST0xMQkFSID0gJ3Njcm9sbGJhcic7CgogIC8qKgogICAgQHByb3BlcnR5IFNDUk9MTAogICAgQHR5cGUgU3RyaW5nCiAgICBAc3RhdGljCiAgICBAZmluYWwKICAgIEBwcml2YXRlCiAgICovCiAgU0NST0xMID0gJ3Njcm9sbCc7CgogIC8qKgogICAgQHByb3BlcnR5IE1PVVNFRE9XTgogICAgQHR5cGUgU3RyaW5nCiAgICBAZmluYWwKICAgIEBwcml2YXRlCiAgICovCiAgTU9VU0VET1dOID0gJ21vdXNlZG93bic7CgogIC8qKgogICAgQHByb3BlcnR5IE1PVVNFRU5URVIKICAgIEB0eXBlIFN0cmluZwogICAgQGZpbmFsCiAgICBAcHJpdmF0ZQogICAqLwogIE1PVVNFRU5URVIgPSAnbW91c2VlbnRlcic7CgogIC8qKgogICAgQHByb3BlcnR5IE1PVVNFTU9WRQogICAgQHR5cGUgU3RyaW5nCiAgICBAc3RhdGljCiAgICBAZmluYWwKICAgIEBwcml2YXRlCiAgICovCiAgTU9VU0VNT1ZFID0gJ21vdXNlbW92ZSc7CgogIC8qKgogICAgQHByb3BlcnR5IE1PVVNFV0hFRUwKICAgIEB0eXBlIFN0cmluZwogICAgQGZpbmFsCiAgICBAcHJpdmF0ZQogICAqLwogIE1PVVNFV0hFRUwgPSAnbW91c2V3aGVlbCc7CgogIC8qKgogICAgQHByb3BlcnR5IE1PVVNFVVAKICAgIEB0eXBlIFN0cmluZwogICAgQHN0YXRpYwogICAgQGZpbmFsCiAgICBAcHJpdmF0ZQogICAqLwogIE1PVVNFVVAgPSAnbW91c2V1cCc7CgogIC8qKgogICAgQHByb3BlcnR5IFJFU0laRQogICAgQHR5cGUgU3RyaW5nCiAgICBAZmluYWwKICAgIEBwcml2YXRlCiAgICovCiAgUkVTSVpFID0gJ3Jlc2l6ZSc7CgogIC8qKgogICAgQHByb3BlcnR5IERSQUcKICAgIEB0eXBlIFN0cmluZwogICAgQHN0YXRpYwogICAgQGZpbmFsCiAgICBAcHJpdmF0ZQogICAqLwogIERSQUcgPSAnZHJhZyc7CgogIC8qKgogICAgQHByb3BlcnR5IEVOVEVSCiAgICBAdHlwZSBTdHJpbmcKICAgIEBzdGF0aWMKICAgIEBmaW5hbAogICAgQHByaXZhdGUKICAgKi8KICBFTlRFUiA9ICdlbnRlcic7CgogIC8qKgogICAgQHByb3BlcnR5IFVQCiAgICBAdHlwZSBTdHJpbmcKICAgIEBzdGF0aWMKICAgIEBmaW5hbAogICAgQHByaXZhdGUKICAgKi8KICBVUCA9ICd1cCc7CgogIC8qKgogICAgQHByb3BlcnR5IFBBTkVET1dOCiAgICBAdHlwZSBTdHJpbmcKICAgIEBzdGF0aWMKICAgIEBmaW5hbAogICAgQHByaXZhdGUKICAgKi8KICBQQU5FRE9XTiA9ICdwYW5lZG93bic7CgogIC8qKgogICAgQHByb3BlcnR5IERPTVNDUk9MTAogICAgQHR5cGUgU3RyaW5nCiAgICBAc3RhdGljCiAgICBAZmluYWwKICAgIEBwcml2YXRlCiAgICovCiAgRE9NU0NST0xMID0gJ0RPTU1vdXNlU2Nyb2xsJzsKCiAgLyoqCiAgICBAcHJvcGVydHkgRE9XTgogICAgQHR5cGUgU3RyaW5nCiAgICBAc3RhdGljCiAgICBAZmluYWwKICAgIEBwcml2YXRlCiAgICovCiAgRE9XTiA9ICdkb3duJzsKCiAgLyoqCiAgICBAcHJvcGVydHkgV0hFRUwKICAgIEB0eXBlIFN0cmluZwogICAgQHN0YXRpYwogICAgQGZpbmFsCiAgICBAcHJpdmF0ZQogICAqLwogIFdIRUVMID0gJ3doZWVsJzsKCiAgLyoqCiAgICBAcHJvcGVydHkgS0VZRE9XTgogICAgQHR5cGUgU3RyaW5nCiAgICBAc3RhdGljCiAgICBAZmluYWwKICAgIEBwcml2YXRlCiAgICovCiAgS0VZRE9XTiA9ICdrZXlkb3duJzsKCiAgLyoqCiAgICBAcHJvcGVydHkgS0VZVVAKICAgIEB0eXBlIFN0cmluZwogICAgQHN0YXRpYwogICAgQGZpbmFsCiAgICBAcHJpdmF0ZQogICAqLwogIEtFWVVQID0gJ2tleXVwJzsKCiAgLyoqCiAgICBAcHJvcGVydHkgVE9VQ0hNT1ZFCiAgICBAdHlwZSBTdHJpbmcKICAgIEBzdGF0aWMKICAgIEBmaW5hbAogICAgQHByaXZhdGUKICAgKi8KICBUT1VDSE1PVkUgPSAndG91Y2htb3ZlJzsKCiAgLyoqCiAgICBAcHJvcGVydHkgQlJPV1NFUl9JU19JRTcKICAgIEB0eXBlIEJvb2xlYW4KICAgIEBzdGF0aWMKICAgIEBmaW5hbAogICAgQHByaXZhdGUKICAgKi8KICBCUk9XU0VSX0lTX0lFNyA9IHdpbmRvdy5uYXZpZ2F0b3IuYXBwTmFtZSA9PT0gJ01pY3Jvc29mdCBJbnRlcm5ldCBFeHBsb3JlcicgJiYgL21zaWUgNy4vaS50ZXN0KHdpbmRvdy5uYXZpZ2F0b3IuYXBwVmVyc2lvbikgJiYgd2luZG93LkFjdGl2ZVhPYmplY3Q7CgogIC8qKgogICAgQHByb3BlcnR5IEJST1dTRVJfU0NST0xMQkFSX1dJRFRICiAgICBAdHlwZSBOdW1iZXIKICAgIEBzdGF0aWMKICAgIEBkZWZhdWx0IG51bGwKICAgIEBwcml2YXRlCiAgICovCiAgQlJPV1NFUl9TQ1JPTExCQVJfV0lEVEggPSBudWxsOwogIHJBRiA9IHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWU7CiAgY0FGID0gd2luZG93LmNhbmNlbEFuaW1hdGlvbkZyYW1lOwogIF9lbGVtZW50U3R5bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKS5zdHlsZTsKICBfdmVuZG9yID0gKGZ1bmN0aW9uKCkgewogICAgdmFyIGksIHRyYW5zZm9ybSwgdmVuZG9yLCB2ZW5kb3JzLCBfaSwgX2xlbjsKICAgIHZlbmRvcnMgPSBbJ3QnLCAnd2Via2l0VCcsICdNb3pUJywgJ21zVCcsICdPVCddOwogICAgZm9yIChpID0gX2kgPSAwLCBfbGVuID0gdmVuZG9ycy5sZW5ndGg7IF9pIDwgX2xlbjsgaSA9ICsrX2kpIHsKICAgICAgdmVuZG9yID0gdmVuZG9yc1tpXTsKICAgICAgdHJhbnNmb3JtID0gdmVuZG9yc1tpXSArICdyYW5zZm9ybSc7CiAgICAgIGlmICh0cmFuc2Zvcm0gaW4gX2VsZW1lbnRTdHlsZSkgewogICAgICAgIHJldHVybiB2ZW5kb3JzW2ldLnN1YnN0cigwLCB2ZW5kb3JzW2ldLmxlbmd0aCAtIDEpOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gZmFsc2U7CiAgfSkoKTsKICBfcHJlZml4U3R5bGUgPSBmdW5jdGlvbihzdHlsZSkgewogICAgaWYgKF92ZW5kb3IgPT09IGZhbHNlKSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIGlmIChfdmVuZG9yID09PSAnJykgewogICAgICByZXR1cm4gc3R5bGU7CiAgICB9CiAgICByZXR1cm4gX3ZlbmRvciArIHN0eWxlLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgc3R5bGUuc3Vic3RyKDEpOwogIH07CiAgdHJhbnNmb3JtID0gX3ByZWZpeFN0eWxlKCd0cmFuc2Zvcm0nKTsKICBoYXNUcmFuc2Zvcm0gPSB0cmFuc2Zvcm0gIT09IGZhbHNlOwoKICAvKioKICAgIFJldHVybnMgYnJvd3NlcidzIG5hdGl2ZSBzY3JvbGxiYXIgd2lkdGgKICAgIEBtZXRob2QgZ2V0QnJvd3NlclNjcm9sbGJhcldpZHRoCiAgICBAcmV0dXJuIHtOdW1iZXJ9IHRoZSBzY3JvbGxiYXIgd2lkdGggaW4gcGl4ZWxzCiAgICBAc3RhdGljCiAgICBAcHJpdmF0ZQogICAqLwogIGdldEJyb3dzZXJTY3JvbGxiYXJXaWR0aCA9IGZ1bmN0aW9uKCkgewogICAgdmFyIG91dGVyLCBvdXRlclN0eWxlLCBzY3JvbGxiYXJXaWR0aDsKICAgIG91dGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICBvdXRlclN0eWxlID0gb3V0ZXIuc3R5bGU7CiAgICBvdXRlclN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJzsKICAgIG91dGVyU3R5bGUud2lkdGggPSAnMTAwcHgnOwogICAgb3V0ZXJTdHlsZS5oZWlnaHQgPSAnMTAwcHgnOwogICAgb3V0ZXJTdHlsZS5vdmVyZmxvdyA9IFNDUk9MTDsKICAgIG91dGVyU3R5bGUudG9wID0gJy05OTk5cHgnOwogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChvdXRlcik7CiAgICBzY3JvbGxiYXJXaWR0aCA9IG91dGVyLm9mZnNldFdpZHRoIC0gb3V0ZXIuY2xpZW50V2lkdGg7CiAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKG91dGVyKTsKICAgIHJldHVybiBzY3JvbGxiYXJXaWR0aDsKICB9OwogIGlzRkZXaXRoQnVnZ3lTY3JvbGxiYXIgPSBmdW5jdGlvbigpIHsKICAgIHZhciBpc09TWEZGLCB1YSwgdmVyc2lvbjsKICAgIHVhID0gd2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQ7CiAgICBpc09TWEZGID0gLyg\/PS4rTWFjIE9TIFgpKD89LitGaXJlZm94KS8udGVzdCh1YSk7CiAgICBpZiAoIWlzT1NYRkYpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgdmVyc2lvbiA9IC9GaXJlZm94XC9cZHsyfVwuLy5leGVjKHVhKTsKICAgIGlmICh2ZXJzaW9uKSB7CiAgICAgIHZlcnNpb24gPSB2ZXJzaW9uWzBdLnJlcGxhY2UoL1xEKy9nLCAnJyk7CiAgICB9CiAgICByZXR1cm4gaXNPU1hGRiAmJiArdmVyc2lvbiA+IDIzOwogIH07CgogIC8qKgogICAgQGNsYXNzIE5hbm9TY3JvbGwKICAgIEBwYXJhbSBlbGVtZW50IHtIVE1MRWxlbWVudHxOb2RlfSB0aGUgbWFpbiBlbGVtZW50CiAgICBAcGFyYW0gb3B0aW9ucyB7T2JqZWN0fSBuYW5vU2Nyb2xsZXIncyBvcHRpb25zCiAgICBAY29uc3RydWN0b3IKICAgKi8KICBOYW5vU2Nyb2xsID0gKGZ1bmN0aW9uKCkgewogICAgZnVuY3Rpb24gTmFub1Njcm9sbChlbCwgb3B0aW9ucykgewogICAgICB0aGlzLmVsID0gZWw7CiAgICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnM7CiAgICAgIEJST1dTRVJfU0NST0xMQkFSX1dJRFRIIHx8IChCUk9XU0VSX1NDUk9MTEJBUl9XSURUSCA9IGdldEJyb3dzZXJTY3JvbGxiYXJXaWR0aCgpKTsKICAgICAgdGhpcy4kZWwgPSAkKHRoaXMuZWwpOwogICAgICB0aGlzLmRvYyA9ICQodGhpcy5vcHRpb25zLmRvY3VtZW50Q29udGV4dCB8fCBkb2N1bWVudCk7CiAgICAgIHRoaXMud2luID0gJCh0aGlzLm9wdGlvbnMud2luZG93Q29udGV4dCB8fCB3aW5kb3cpOwogICAgICB0aGlzLmJvZHkgPSB0aGlzLmRvYy5maW5kKCdib2R5Jyk7CiAgICAgIHRoaXMuJGNvbnRlbnQgPSB0aGlzLiRlbC5jaGlsZHJlbigiLiIgKyBvcHRpb25zLmNvbnRlbnRDbGFzcyk7CiAgICAgIHRoaXMuJGNvbnRlbnQuYXR0cigndGFiaW5kZXgnLCB0aGlzLm9wdGlvbnMudGFiSW5kZXggfHwgMCk7CiAgICAgIHRoaXMuY29udGVudCA9IHRoaXMuJGNvbnRlbnRbMF07CiAgICAgIHRoaXMucHJldmlvdXNQb3NpdGlvbiA9IDA7CiAgICAgIGlmICh0aGlzLm9wdGlvbnMuaU9TTmF0aXZlU2Nyb2xsaW5nICYmICh0aGlzLmVsLnN0eWxlLldlYmtpdE92ZXJmbG93U2Nyb2xsaW5nICE9IG51bGwpKSB7CiAgICAgICAgdGhpcy5uYXRpdmVTY3JvbGxpbmcoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmdlbmVyYXRlKCk7CiAgICAgIH0KICAgICAgdGhpcy5jcmVhdGVFdmVudHMoKTsKICAgICAgdGhpcy5hZGRFdmVudHMoKTsKICAgICAgdGhpcy5yZXNldCgpOwogICAgfQoKCiAgICAvKioKICAgICAgUHJldmVudHMgdGhlIHJlc3Qgb2YgdGhlIHBhZ2UgYmVpbmcgc2Nyb2xsZWQKICAgICAgd2hlbiB1c2VyIHNjcm9sbHMgdGhlIGAubmFuby1jb250ZW50YCBlbGVtZW50LgogICAgICBAbWV0aG9kIHByZXZlbnRTY3JvbGxpbmcKICAgICAgQHBhcmFtIGV2ZW50IHtFdmVudH0KICAgICAgQHBhcmFtIGRpcmVjdGlvbiB7U3RyaW5nfSBTY3JvbGwgZGlyZWN0aW9uICh1cCBvciBkb3duKQogICAgICBAcHJpdmF0ZQogICAgICovCgogICAgTmFub1Njcm9sbC5wcm90b3R5cGUucHJldmVudFNjcm9sbGluZyA9IGZ1bmN0aW9uKGUsIGRpcmVjdGlvbikgewogICAgICBpZiAoIXRoaXMuaXNBY3RpdmUpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKGUudHlwZSA9PT0gRE9NU0NST0xMKSB7CiAgICAgICAgaWYgKGRpcmVjdGlvbiA9PT0gRE9XTiAmJiBlLm9yaWdpbmFsRXZlbnQuZGV0YWlsID4gMCB8fCBkaXJlY3Rpb24gPT09IFVQICYmIGUub3JpZ2luYWxFdmVudC5kZXRhaWwgPCAwKSB7CiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKGUudHlwZSA9PT0gTU9VU0VXSEVFTCkgewogICAgICAgIGlmICghZS5vcmlnaW5hbEV2ZW50IHx8ICFlLm9yaWdpbmFsRXZlbnQud2hlZWxEZWx0YSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAoZGlyZWN0aW9uID09PSBET1dOICYmIGUub3JpZ2luYWxFdmVudC53aGVlbERlbHRhIDwgMCB8fCBkaXJlY3Rpb24gPT09IFVQICYmIGUub3JpZ2luYWxFdmVudC53aGVlbERlbHRhID4gMCkgewogICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCgogICAgLyoqCiAgICAgIEVuYWJsZSBpT1MgbmF0aXZlIHNjcm9sbGluZwogICAgICBAbWV0aG9kIG5hdGl2ZVNjcm9sbGluZwogICAgICBAcHJpdmF0ZQogICAgICovCgogICAgTmFub1Njcm9sbC5wcm90b3R5cGUubmF0aXZlU2Nyb2xsaW5nID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuJGNvbnRlbnQuY3NzKHsKICAgICAgICBXZWJraXRPdmVyZmxvd1Njcm9sbGluZzogJ3RvdWNoJwogICAgICB9KTsKICAgICAgdGhpcy5pT1NOYXRpdmVTY3JvbGxpbmcgPSB0cnVlOwogICAgICB0aGlzLmlzQWN0aXZlID0gdHJ1ZTsKICAgIH07CgoKICAgIC8qKgogICAgICBVcGRhdGVzIHRob3NlIG5hbm9TY3JvbGxlciBwcm9wZXJ0aWVzIHRoYXQKICAgICAgYXJlIHJlbGF0ZWQgdG8gY3VycmVudCBzY3JvbGxiYXIgcG9zaXRpb24uCiAgICAgIEBtZXRob2QgdXBkYXRlU2Nyb2xsVmFsdWVzCiAgICAgIEBwcml2YXRlCiAgICAgKi8KCiAgICBOYW5vU2Nyb2xsLnByb3RvdHlwZS51cGRhdGVTY3JvbGxWYWx1ZXMgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGNvbnRlbnQsIGRpcmVjdGlvbjsKICAgICAgY29udGVudCA9IHRoaXMuY29udGVudDsKICAgICAgdGhpcy5tYXhTY3JvbGxUb3AgPSBjb250ZW50LnNjcm9sbEhlaWdodCAtIGNvbnRlbnQuY2xpZW50SGVpZ2h0OwogICAgICB0aGlzLnByZXZTY3JvbGxUb3AgPSB0aGlzLmNvbnRlbnRTY3JvbGxUb3AgfHwgMDsKICAgICAgdGhpcy5jb250ZW50U2Nyb2xsVG9wID0gY29udGVudC5zY3JvbGxUb3A7CiAgICAgIGRpcmVjdGlvbiA9IHRoaXMuY29udGVudFNjcm9sbFRvcCA+IHRoaXMucHJldmlvdXNQb3NpdGlvbiA\/ICJkb3duIiA6IHRoaXMuY29udGVudFNjcm9sbFRvcCA8IHRoaXMucHJldmlvdXNQb3NpdGlvbiA\/ICJ1cCIgOiAic2FtZSI7CiAgICAgIHRoaXMucHJldmlvdXNQb3NpdGlvbiA9IHRoaXMuY29udGVudFNjcm9sbFRvcDsKICAgICAgaWYgKGRpcmVjdGlvbiAhPT0gInNhbWUiKSB7CiAgICAgICAgdGhpcy4kZWwudHJpZ2dlcigndXBkYXRlJywgewogICAgICAgICAgcG9zaXRpb246IHRoaXMuY29udGVudFNjcm9sbFRvcCwKICAgICAgICAgIG1heGltdW06IHRoaXMubWF4U2Nyb2xsVG9wLAogICAgICAgICAgZGlyZWN0aW9uOiBkaXJlY3Rpb24KICAgICAgICB9KTsKICAgICAgfQogICAgICBpZiAoIXRoaXMuaU9TTmF0aXZlU2Nyb2xsaW5nKSB7CiAgICAgICAgdGhpcy5tYXhTbGlkZXJUb3AgPSB0aGlzLnBhbmVIZWlnaHQgLSB0aGlzLnNsaWRlckhlaWdodDsKICAgICAgICB0aGlzLnNsaWRlclRvcCA9IHRoaXMubWF4U2Nyb2xsVG9wID09PSAwID8gMCA6IHRoaXMuY29udGVudFNjcm9sbFRvcCAqIHRoaXMubWF4U2xpZGVyVG9wIC8gdGhpcy5tYXhTY3JvbGxUb3A7CiAgICAgIH0KICAgIH07CgoKICAgIC8qKgogICAgICBVcGRhdGVzIENTUyBzdHlsZXMgZm9yIGN1cnJlbnQgc2Nyb2xsIHBvc2l0aW9uLgogICAgICBVc2VzIENTUyAyZCB0cmFuc2Zyb21zIGFuZCBgd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZWAgaWYgYXZhaWxhYmxlLgogICAgICBAbWV0aG9kIHNldE9uU2Nyb2xsU3R5bGVzCiAgICAgIEBwcml2YXRlCiAgICAgKi8KCiAgICBOYW5vU2Nyb2xsLnByb3RvdHlwZS5zZXRPblNjcm9sbFN0eWxlcyA9IGZ1bmN0aW9uKCkgewogICAgICB2YXIgY3NzVmFsdWU7CiAgICAgIGlmIChoYXNUcmFuc2Zvcm0pIHsKICAgICAgICBjc3NWYWx1ZSA9IHt9OwogICAgICAgIGNzc1ZhbHVlW3RyYW5zZm9ybV0gPSAidHJhbnNsYXRlKDAsICIgKyB0aGlzLnNsaWRlclRvcCArICJweCkiOwogICAgICB9IGVsc2UgewogICAgICAgIGNzc1ZhbHVlID0gewogICAgICAgICAgdG9wOiB0aGlzLnNsaWRlclRvcAogICAgICAgIH07CiAgICAgIH0KICAgICAgaWYgKHJBRikgewogICAgICAgIGlmIChjQUYgJiYgdGhpcy5zY3JvbGxSQUYpIHsKICAgICAgICAgIGNBRih0aGlzLnNjcm9sbFJBRik7CiAgICAgICAgfQogICAgICAgIHRoaXMuc2Nyb2xsUkFGID0gckFGKChmdW5jdGlvbihfdGhpcykgewogICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkgewogICAgICAgICAgICBfdGhpcy5zY3JvbGxSQUYgPSBudWxsOwogICAgICAgICAgICByZXR1cm4gX3RoaXMuc2xpZGVyLmNzcyhjc3NWYWx1ZSk7CiAgICAgICAgICB9OwogICAgICAgIH0pKHRoaXMpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNsaWRlci5jc3MoY3NzVmFsdWUpOwogICAgICB9CiAgICB9OwoKCiAgICAvKioKICAgICAgQ3JlYXRlcyBldmVudCByZWxhdGVkIG1ldGhvZHMKICAgICAgQG1ldGhvZCBjcmVhdGVFdmVudHMKICAgICAgQHByaXZhdGUKICAgICAqLwoKICAgIE5hbm9TY3JvbGwucHJvdG90eXBlLmNyZWF0ZUV2ZW50cyA9IGZ1bmN0aW9uKCkgewogICAgICB0aGlzLmV2ZW50cyA9IHsKICAgICAgICBkb3duOiAoZnVuY3Rpb24oX3RoaXMpIHsKICAgICAgICAgIHJldHVybiBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgIF90aGlzLmlzQmVpbmdEcmFnZ2VkID0gdHJ1ZTsKICAgICAgICAgICAgX3RoaXMub2Zmc2V0WSA9IGUucGFnZVkgLSBfdGhpcy5zbGlkZXIub2Zmc2V0KCkudG9wOwogICAgICAgICAgICBpZiAoIV90aGlzLnNsaWRlci5pcyhlLnRhcmdldCkpIHsKICAgICAgICAgICAgICBfdGhpcy5vZmZzZXRZID0gMDsKICAgICAgICAgICAgfQogICAgICAgICAgICBfdGhpcy5wYW5lLmFkZENsYXNzKCdhY3RpdmUnKTsKICAgICAgICAgICAgX3RoaXMuZG9jLmJpbmQoTU9VU0VNT1ZFLCBfdGhpcy5ldmVudHNbRFJBR10pLmJpbmQoTU9VU0VVUCwgX3RoaXMuZXZlbnRzW1VQXSk7CiAgICAgICAgICAgIF90aGlzLmJvZHkuYmluZChNT1VTRUVOVEVSLCBfdGhpcy5ldmVudHNbRU5URVJdKTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfTsKICAgICAgICB9KSh0aGlzKSwKICAgICAgICBkcmFnOiAoZnVuY3Rpb24oX3RoaXMpIHsKICAgICAgICAgIHJldHVybiBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgIF90aGlzLnNsaWRlclkgPSBlLnBhZ2VZIC0gX3RoaXMuJGVsLm9mZnNldCgpLnRvcCAtIF90aGlzLnBhbmVUb3AgLSAoX3RoaXMub2Zmc2V0WSB8fCBfdGhpcy5zbGlkZXJIZWlnaHQgKiAwLjUpOwogICAgICAgICAgICBfdGhpcy5zY3JvbGwoKTsKICAgICAgICAgICAgaWYgKF90aGlzLmNvbnRlbnRTY3JvbGxUb3AgPj0gX3RoaXMubWF4U2Nyb2xsVG9wICYmIF90aGlzLnByZXZTY3JvbGxUb3AgIT09IF90aGlzLm1heFNjcm9sbFRvcCkgewogICAgICAgICAgICAgIF90aGlzLiRlbC50cmlnZ2VyKCdzY3JvbGxlbmQnKTsKICAgICAgICAgICAgfSBlbHNlIGlmIChfdGhpcy5jb250ZW50U2Nyb2xsVG9wID09PSAwICYmIF90aGlzLnByZXZTY3JvbGxUb3AgIT09IDApIHsKICAgICAgICAgICAgICBfdGhpcy4kZWwudHJpZ2dlcignc2Nyb2xsdG9wJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfTsKICAgICAgICB9KSh0aGlzKSwKICAgICAgICB1cDogKGZ1bmN0aW9uKF90aGlzKSB7CiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSkgewogICAgICAgICAgICBfdGhpcy5pc0JlaW5nRHJhZ2dlZCA9IGZhbHNlOwogICAgICAgICAgICBfdGhpcy5wYW5lLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTsKICAgICAgICAgICAgX3RoaXMuZG9jLnVuYmluZChNT1VTRU1PVkUsIF90aGlzLmV2ZW50c1tEUkFHXSkudW5iaW5kKE1PVVNFVVAsIF90aGlzLmV2ZW50c1tVUF0pOwogICAgICAgICAgICBfdGhpcy5ib2R5LnVuYmluZChNT1VTRUVOVEVSLCBfdGhpcy5ldmVudHNbRU5URVJdKTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfTsKICAgICAgICB9KSh0aGlzKSwKICAgICAgICByZXNpemU6IChmdW5jdGlvbihfdGhpcykgewogICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgX3RoaXMucmVzZXQoKTsKICAgICAgICAgIH07CiAgICAgICAgfSkodGhpcyksCiAgICAgICAgcGFuZWRvd246IChmdW5jdGlvbihfdGhpcykgewogICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgX3RoaXMuc2xpZGVyWSA9IChlLm9mZnNldFkgfHwgZS5vcmlnaW5hbEV2ZW50LmxheWVyWSkgLSAoX3RoaXMuc2xpZGVySGVpZ2h0ICogMC41KTsKICAgICAgICAgICAgX3RoaXMuc2Nyb2xsKCk7CiAgICAgICAgICAgIF90aGlzLmV2ZW50cy5kb3duKGUpOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9OwogICAgICAgIH0pKHRoaXMpLAogICAgICAgIHNjcm9sbDogKGZ1bmN0aW9uKF90aGlzKSB7CiAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oZSkgewogICAgICAgICAgICBfdGhpcy51cGRhdGVTY3JvbGxWYWx1ZXMoKTsKICAgICAgICAgICAgaWYgKF90aGlzLmlzQmVpbmdEcmFnZ2VkKSB7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghX3RoaXMuaU9TTmF0aXZlU2Nyb2xsaW5nKSB7CiAgICAgICAgICAgICAgX3RoaXMuc2xpZGVyWSA9IF90aGlzLnNsaWRlclRvcDsKICAgICAgICAgICAgICBfdGhpcy5zZXRPblNjcm9sbFN0eWxlcygpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChlID09IG51bGwpIHsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKF90aGlzLmNvbnRlbnRTY3JvbGxUb3AgPj0gX3RoaXMubWF4U2Nyb2xsVG9wKSB7CiAgICAgICAgICAgICAgaWYgKF90aGlzLm9wdGlvbnMucHJldmVudFBhZ2VTY3JvbGxpbmcpIHsKICAgICAgICAgICAgICAgIF90aGlzLnByZXZlbnRTY3JvbGxpbmcoZSwgRE9XTik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmIChfdGhpcy5wcmV2U2Nyb2xsVG9wICE9PSBfdGhpcy5tYXhTY3JvbGxUb3ApIHsKICAgICAgICAgICAgICAgIF90aGlzLiRlbC50cmlnZ2VyKCdzY3JvbGxlbmQnKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAoX3RoaXMuY29udGVudFNjcm9sbFRvcCA9PT0gMCkgewogICAgICAgICAgICAgIGlmIChfdGhpcy5vcHRpb25zLnByZXZlbnRQYWdlU2Nyb2xsaW5nKSB7CiAgICAgICAgICAgICAgICBfdGhpcy5wcmV2ZW50U2Nyb2xsaW5nKGUsIFVQKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKF90aGlzLnByZXZTY3JvbGxUb3AgIT09IDApIHsKICAgICAgICAgICAgICAgIF90aGlzLiRlbC50cmlnZ2VyKCdzY3JvbGx0b3AnKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH07CiAgICAgICAgfSkodGhpcyksCiAgICAgICAgd2hlZWw6IChmdW5jdGlvbihfdGhpcykgewogICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgdmFyIGRlbHRhOwogICAgICAgICAgICBpZiAoZSA9PSBudWxsKSB7CiAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGRlbHRhID0gZS5kZWx0YSB8fCBlLndoZWVsRGVsdGEgfHwgKGUub3JpZ2luYWxFdmVudCAmJiBlLm9yaWdpbmFsRXZlbnQud2hlZWxEZWx0YSkgfHwgLWUuZGV0YWlsIHx8IChlLm9yaWdpbmFsRXZlbnQgJiYgLWUub3JpZ2luYWxFdmVudC5kZXRhaWwpOwogICAgICAgICAgICBpZiAoZGVsdGEpIHsKICAgICAgICAgICAgICBfdGhpcy5zbGlkZXJZICs9IC1kZWx0YSAvIDM7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgX3RoaXMuc2Nyb2xsKCk7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH07CiAgICAgICAgfSkodGhpcyksCiAgICAgICAgZW50ZXI6IChmdW5jdGlvbihfdGhpcykgewogICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgdmFyIF9yZWY7CiAgICAgICAgICAgIGlmICghX3RoaXMuaXNCZWluZ0RyYWdnZWQpIHsKICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKChlLmJ1dHRvbnMgfHwgZS53aGljaCkgIT09IDEpIHsKICAgICAgICAgICAgICByZXR1cm4gKF9yZWYgPSBfdGhpcy5ldmVudHMpW1VQXS5hcHBseShfcmVmLCBhcmd1bWVudHMpOwogICAgICAgICAgICB9CiAgICAgICAgICB9OwogICAgICAgIH0pKHRoaXMpCiAgICAgIH07CiAgICB9OwoKCiAgICAvKioKICAgICAgQWRkcyBldmVudCBsaXN0ZW5lcnMgd2l0aCBqUXVlcnkuCiAgICAgIEBtZXRob2QgYWRkRXZlbnRzCiAgICAgIEBwcml2YXRlCiAgICAgKi8KCiAgICBOYW5vU2Nyb2xsLnByb3RvdHlwZS5hZGRFdmVudHMgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGV2ZW50czsKICAgICAgdGhpcy5yZW1vdmVFdmVudHMoKTsKICAgICAgZXZlbnRzID0gdGhpcy5ldmVudHM7CiAgICAgIGlmICghdGhpcy5vcHRpb25zLmRpc2FibGVSZXNpemUpIHsKICAgICAgICB0aGlzLndpbi5iaW5kKFJFU0laRSwgZXZlbnRzW1JFU0laRV0pOwogICAgICB9CiAgICAgIGlmICghdGhpcy5pT1NOYXRpdmVTY3JvbGxpbmcpIHsKICAgICAgICB0aGlzLnNsaWRlci5iaW5kKE1PVVNFRE9XTiwgZXZlbnRzW0RPV05dKTsKICAgICAgICB0aGlzLnBhbmUuYmluZChNT1VTRURPV04sIGV2ZW50c1tQQU5FRE9XTl0pLmJpbmQoIiIgKyBNT1VTRVdIRUVMICsgIiAiICsgRE9NU0NST0xMLCBldmVudHNbV0hFRUxdKTsKICAgICAgfQogICAgICB0aGlzLiRjb250ZW50LmJpbmQoIiIgKyBTQ1JPTEwgKyAiICIgKyBNT1VTRVdIRUVMICsgIiAiICsgRE9NU0NST0xMICsgIiAiICsgVE9VQ0hNT1ZFLCBldmVudHNbU0NST0xMXSk7CiAgICB9OwoKCiAgICAvKioKICAgICAgUmVtb3ZlcyBldmVudCBsaXN0ZW5lcnMgd2l0aCBqUXVlcnkuCiAgICAgIEBtZXRob2QgcmVtb3ZlRXZlbnRzCiAgICAgIEBwcml2YXRlCiAgICAgKi8KCiAgICBOYW5vU2Nyb2xsLnByb3RvdHlwZS5yZW1vdmVFdmVudHMgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGV2ZW50czsKICAgICAgZXZlbnRzID0gdGhpcy5ldmVudHM7CiAgICAgIHRoaXMud2luLnVuYmluZChSRVNJWkUsIGV2ZW50c1tSRVNJWkVdKTsKICAgICAgaWYgKCF0aGlzLmlPU05hdGl2ZVNjcm9sbGluZykgewogICAgICAgIHRoaXMuc2xpZGVyLnVuYmluZCgpOwogICAgICAgIHRoaXMucGFuZS51bmJpbmQoKTsKICAgICAgfQogICAgICB0aGlzLiRjb250ZW50LnVuYmluZCgiIiArIFNDUk9MTCArICIgIiArIE1PVVNFV0hFRUwgKyAiICIgKyBET01TQ1JPTEwgKyAiICIgKyBUT1VDSE1PVkUsIGV2ZW50c1tTQ1JPTExdKTsKICAgIH07CgoKICAgIC8qKgogICAgICBHZW5lcmF0ZXMgbmFub1Njcm9sbGVyJ3Mgc2Nyb2xsYmFyIGFuZCBlbGVtZW50cyBmb3IgaXQuCiAgICAgIEBtZXRob2QgZ2VuZXJhdGUKICAgICAgQGNoYWluYWJsZQogICAgICBAcHJpdmF0ZQogICAgICovCgogICAgTmFub1Njcm9sbC5wcm90b3R5cGUuZ2VuZXJhdGUgPSBmdW5jdGlvbigpIHsKICAgICAgdmFyIGNvbnRlbnRDbGFzcywgY3NzUnVsZSwgY3VycmVudFBhZGRpbmcsIG9wdGlvbnMsIHBhbmUsIHBhbmVDbGFzcywgc2xpZGVyQ2xhc3M7CiAgICAgIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnM7CiAgICAgIHBhbmVDbGFzcyA9IG9wdGlvbnMucGFuZUNsYXNzLCBzbGlkZXJDbGFzcyA9IG9wdGlvbnMuc2xpZGVyQ2xhc3MsIGNvbnRlbnRDbGFzcyA9IG9wdGlvbnMuY29udGVudENsYXNzOwogICAgICBpZiAoIShwYW5lID0gdGhpcy4kZWwuY2hpbGRyZW4oIi4iICsgcGFuZUNsYXNzKSkubGVuZ3RoICYmICFwYW5lLmNoaWxkcmVuKCIuIiArIHNsaWRlckNsYXNzKS5sZW5ndGgpIHsKICAgICAgICB0aGlzLiRlbC5hcHBlbmQoIjxkaXYgY2xhc3M9XCIiICsgcGFuZUNsYXNzICsgIlwiPjxkaXYgY2xhc3M9XCIiICsgc2xpZGVyQ2xhc3MgKyAiXCIgLz48L2Rpdj4iKTsKICAgICAgfQogICAgICB0aGlzLnBhbmUgPSB0aGlzLiRlbC5jaGlsZHJlbigiLiIgKyBwYW5lQ2xhc3MpOwogICAgICB0aGlzLnNsaWRlciA9IHRoaXMucGFuZS5maW5kKCIuIiArIHNsaWRlckNsYXNzKTsKICAgICAgaWYgKEJST1dTRVJfU0NST0xMQkFSX1dJRFRIID09PSAwICYmIGlzRkZXaXRoQnVnZ3lTY3JvbGxiYXIoKSkgewogICAgICAgIGN1cnJlbnRQYWRkaW5nID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodGhpcy5jb250ZW50LCBudWxsKS5nZXRQcm9wZXJ0eVZhbHVlKCdwYWRkaW5nLXJpZ2h0JykucmVwbGFjZSgvW14wLTkuXSsvZywgJycpOwogICAgICAgIGNzc1J1bGUgPSB7CiAgICAgICAgICByaWdodDogLTE0LAogICAgICAgICAgcGFkZGluZ1JpZ2h0OiArY3VycmVudFBhZGRpbmcgKyAxNAogICAgICAgIH07CiAgICAgIH0gZWxzZSBpZiAoQlJPV1NFUl9TQ1JPTExCQVJfV0lEVEgpIHsKICAgICAgICBjc3NSdWxlID0gewogICAgICAgICAgcmlnaHQ6IC1CUk9XU0VSX1NDUk9MTEJBUl9XSURUSAogICAgICAgIH07CiAgICAgICAgdGhpcy4kZWwuYWRkQ2xhc3MoJ2hhcy1zY3JvbGxiYXInKTsKICAgICAgfQogICAgICBpZiAoY3NzUnVsZSAhPSBudWxsKSB7CiAgICAgICAgdGhpcy4kY29udGVudC5jc3MoY3NzUnVsZSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXM7CiAgICB9OwoKCiAgICAvKioKICAgICAgQG1ldGhvZCByZXN0b3JlCiAgICAgIEBwcml2YXRlCiAgICAgKi8KCiAgICBOYW5vU2Nyb2xsLnByb3RvdHlwZS5yZXN0b3JlID0gZnVuY3Rpb24oKSB7CiAgICAgIHRoaXMuc3RvcHBlZCA9IGZhbHNlOwogICAgICBpZiAoIXRoaXMuaU9TTmF0aXZlU2Nyb2xsaW5nKSB7CiAgICAgICAgdGhpcy5wYW5lLnNob3coKTsKICAgICAgfQogICAgICB0aGlzLmFkZEV2ZW50cygpOwogICAgfTsKCgogICAgLyoqCiAgICAgIFJlc2V0cyBuYW5vU2Nyb2xsZXIncyBzY3JvbGxiYXIuCiAgICAgIEBtZXRob2QgcmVzZXQKICAgICAgQGNoYWluYWJsZQogICAgICBAZXhhbXBsZQogICAgICAgICAgJCgiLm5hbm8iKS5uYW5vU2Nyb2xsZXIoKTsKICAgICAqLwoKICAgIE5hbm9TY3JvbGwucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oKSB7CiAgICAgIHZhciBjb250ZW50LCBjb250ZW50SGVpZ2h0LCBjb250ZW50UG9zaXRpb24sIGNvbnRlbnRTdHlsZSwgY29udGVudFN0eWxlT3ZlcmZsb3dZLCBwYW5lQm90dG9tLCBwYW5lSGVpZ2h0LCBwYW5lT3V0ZXJIZWlnaHQsIHBhbmVUb3AsIHBhcmVudE1heEhlaWdodCwgcmlnaHQsIHNsaWRlckhlaWdodDsKICAgICAgaWYgKHRoaXMuaU9TTmF0aXZlU2Nyb2xsaW5nKSB7CiAgICAgICAgdGhpcy5jb250ZW50SGVpZ2h0ID0gdGhpcy5jb250ZW50LnNjcm9sbEhlaWdodDsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKCF0aGlzLiRlbC5maW5kKCIuIiArIHRoaXMub3B0aW9ucy5wYW5lQ2xhc3MpLmxlbmd0aCkgewogICAgICAgIHRoaXMuZ2VuZXJhdGUoKS5zdG9wKCk7CiAgICAgIH0KICAgICAgaWYgKHRoaXMuc3RvcHBlZCkgewogICAgICAgIHRoaXMucmVzdG9yZSgpOwogICAgICB9CiAgICAgIGNvbnRlbnQgPSB0aGlzLmNvbnRlbnQ7CiAgICAgIGNvbnRlbnRTdHlsZSA9IGNvbnRlbnQuc3R5bGU7CiAgICAgIGNvbnRlbnRTdHlsZU92ZXJmbG93WSA9IGNvbnRlbnRTdHlsZS5vdmVyZmxvd1k7CiAgICAgIGlmIChCUk9XU0VSX0lTX0lFNykgewogICAgICAgIHRoaXMuJGNvbnRlbnQuY3NzKHsKICAgICAgICAgIGhlaWdodDogdGhpcy4kY29udGVudC5oZWlnaHQoKQogICAgICAgIH0pOwogICAgICB9CiAgICAgIGNvbnRlbnRIZWlnaHQgPSBjb250ZW50LnNjcm9sbEhlaWdodCArIEJST1dTRVJfU0NST0xMQkFSX1dJRFRIOwogICAgICBwYXJlbnRNYXhIZWlnaHQgPSBwYXJzZUludCh0aGlzLiRlbC5jc3MoIm1heC1oZWlnaHQiKSwgMTApOwogICAgICBpZiAocGFyZW50TWF4SGVpZ2h0ID4gMCkgewogICAgICAgIHRoaXMuJGVsLmhlaWdodCgiIik7CiAgICAgICAgdGhpcy4kZWwuaGVpZ2h0KGNvbnRlbnQuc2Nyb2xsSGVpZ2h0ID4gcGFyZW50TWF4SGVpZ2h0ID8gcGFyZW50TWF4SGVpZ2h0IDogY29udGVudC5zY3JvbGxIZWlnaHQpOwogICAgICB9CiAgICAgIHBhbmVIZWlnaHQgPSB0aGlzLnBhbmUub3V0ZXJIZWlnaHQoZmFsc2UpOwogICAgICBwYW5lVG9wID0gcGFyc2VJbnQodGhpcy5wYW5lLmNzcygndG9wJyksIDEwKTsKICAgICAgcGFuZUJvdHRvbSA9IHBhcnNlSW50KHRoaXMucGFuZS5jc3MoJ2JvdHRvbScpLCAxMCk7CiAgICAgIHBhbmVPdXRlckhlaWdodCA9IHBhbmVIZWlnaHQgKyBwYW5lVG9wICsgcGFuZUJvdHRvbTsKICAgICAgc2xpZGVySGVpZ2h0ID0gTWF0aC5yb3VuZChwYW5lT3V0ZXJIZWlnaHQgLyBjb250ZW50SGVpZ2h0ICogcGFuZU91dGVySGVpZ2h0KTsKICAgICAgaWYgKHNsaWRlckhlaWdodCA8IHRoaXMub3B0aW9ucy5zbGlkZXJNaW5IZWlnaHQpIHsKICAgICAgICBzbGlkZXJIZWlnaHQgPSB0aGlzLm9wdGlvbnMuc2xpZGVyTWluSGVpZ2h0OwogICAgICB9IGVsc2UgaWYgKCh0aGlzLm9wdGlvbnMuc2xpZGVyTWF4SGVpZ2h0ICE9IG51bGwpICYmIHNsaWRlckhlaWdodCA+IHRoaXMub3B0aW9ucy5zbGlkZXJNYXhIZWlnaHQpIHsKICAgICAgICBzbGlkZXJIZWlnaHQgPSB0aGlzLm9wdGlvbnMuc2xpZGVyTWF4SGVpZ2h0OwogICAgICB9CiAgICAgIGlmIChjb250ZW50U3R5bGVPdmVyZmxvd1kgPT09IFNDUk9MTCAmJiBjb250ZW50U3R5bGUub3ZlcmZsb3dYICE9PSBTQ1JPTEwpIHsKICAgICAgICBzbGlkZXJIZWlnaHQgKz0gQlJPV1NFUl9TQ1JPTExCQVJfV0lEVEg7CiAgICAgIH0KICAgICAgdGhpcy5tYXhTbGlkZXJUb3AgPSBwYW5lT3V0ZXJIZWlnaHQgLSBzbGlkZXJIZWlnaHQ7CiAgICAgIHRoaXMuY29udGVudEhlaWdodCA9IGNvbnRlbnRIZWlnaHQ7CiAgICAgIHRoaXMucGFuZUhlaWdodCA9IHBhbmVIZWlnaHQ7CiAgICAgIHRoaXMucGFuZU91dGVySGVpZ2h0ID0gcGFuZU91dGVySGVpZ2h0OwogICAgICB0aGlzLnNsaWRlckhlaWdodCA9IHNsaWRlckhlaWdodDsKICAgICAgdGhpcy5wYW5lVG9wID0gcGFuZVRvcDsKICAgICAgdGhpcy5zbGlkZXIuaGVpZ2h0KHNsaWRlckhlaWdodCk7CiAgICAgIHRoaXMuZXZlbnRzLnNjcm9sbCgpOwogICAgICB0aGlzLnBhbmUuc2hvdygpOwogICAgICB0aGlzLmlzQWN0aXZlID0gdHJ1ZTsKICAgICAgaWYgKChjb250ZW50LnNjcm9sbEhlaWdodCA9PT0gY29udGVudC5jbGllbnRIZWlnaHQpIHx8ICh0aGlzLnBhbmUub3V0ZXJIZWlnaHQodHJ1ZSkgPj0gY29udGVudC5zY3JvbGxIZWlnaHQgJiYgY29udGVudFN0eWxlT3ZlcmZsb3dZICE9PSBTQ1JPTEwpKSB7CiAgICAgICAgdGhpcy5wYW5lLmhpZGUoKTsKICAgICAgICB0aGlzLmlzQWN0aXZlID0gZmFsc2U7CiAgICAgIH0gZWxzZSBpZiAodGhpcy5lbC5jbGllbnRIZWlnaHQgPT09IGNvbnRlbnQuc2Nyb2xsSGVpZ2h0ICYmIGNvbnRlbnRTdHlsZU92ZXJmbG93WSA9PT0gU0NST0xMKSB7CiAgICAgICAgdGhpcy5zbGlkZXIuaGlkZSgpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuc2xpZGVyLnNob3coKTsKICAgICAgfQogICAgICB0aGlzLnBhbmUuY3NzKHsKICAgICAgICBvcGFjaXR5OiAodGhpcy5vcHRpb25zLmFsd2F5c1Zpc2libGUgPyAxIDogJycpLAogICAgICAgIHZpc2liaWxpdHk6ICh0aGlzLm9wdGlvbnMuYWx3YXlzVmlzaWJsZSA\/ICd2aXNpYmxlJyA6ICcnKQogICAgICB9KTsKICAgICAgY29udGVudFBvc2l0aW9uID0gdGhpcy4kY29udGVudC5jc3MoJ3Bvc2l0aW9uJyk7CiAgICAgIGlmIChjb250ZW50UG9zaXRpb24gPT09ICdzdGF0aWMnIHx8IGNvbnRlbnRQb3NpdGlvbiA9PT0gJ3JlbGF0aXZlJykgewogICAgICAgIHJpZ2h0ID0gcGFyc2VJbnQodGhpcy4kY29udGVudC5jc3MoJ3JpZ2h0JyksIDEwKTsKICAgICAgICBpZiAocmlnaHQpIHsKICAgICAgICAgIHRoaXMuJGNvbnRlbnQuY3NzKHsKICAgICAgICAgICAgcmlnaHQ6ICcnLAogICAgICAgICAgICBtYXJnaW5SaWdodDogcmlnaHQKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdGhpczsKICAgIH07CgoKICAgIC8qKgogICAgICBAbWV0aG9kIHNjcm9sbAogICAgICBAcHJpdmF0ZQogICAgICBAZXhhbXBsZQogICAgICAgICAgJCgiLm5hbm8iKS5uYW5vU2Nyb2xsZXIoeyBzY3JvbGw6ICd0b3AnIH0pOwogICAgICovCgogICAgTmFub1Njcm9sbC5wcm90b3R5cGUuc2Nyb2xsID0gZnVuY3Rpb24oKSB7CiAgICAgIGlmICghdGhpcy5pc0FjdGl2ZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLnNsaWRlclkgPSBNYXRoLm1heCgwLCB0aGlzLnNsaWRlclkpOwogICAgICB0aGlzLnNsaWRlclkgPSBNYXRoLm1pbih0aGlzLm1heFNsaWRlclRvcCwgdGhpcy5zbGlkZXJZKTsKICAgICAgdGhpcy4kY29udGVudC5zY3JvbGxUb3AodGhpcy5tYXhTY3JvbGxUb3AgKiB0aGlzLnNsaWRlclkgLyB0aGlzLm1heFNsaWRlclRvcCk7CiAgICAgIGlmICghdGhpcy5pT1NOYXRpdmVTY3JvbGxpbmcpIHsKICAgICAgICB0aGlzLnVwZGF0ZVNjcm9sbFZhbHVlcygpOwogICAgICAgIHRoaXMuc2V0T25TY3JvbGxTdHlsZXMoKTsKICAgICAgfQogICAgICByZXR1cm4gdGhpczsKICAgIH07CgoKICAgIC8qKgogICAgICBTY3JvbGwgYXQgdGhlIGJvdHRvbSB3aXRoIGFuIG9mZnNldCB2YWx1ZQogICAgICBAbWV0aG9kIHNjcm9sbEJvdHRvbQogICAgICBAcGFyYW0gb2Zmc2V0WSB7TnVtYmVyfQogICAgICBAY2hhaW5hYmxlCiAgICAgIEBleGFtcGxlCiAgICAgICAgICAkKCIubmFubyIpLm5hbm9TY3JvbGxlcih7IHNjcm9sbEJvdHRvbTogdmFsdWUgfSk7CiAgICAgKi8KCiAgICBOYW5vU2Nyb2xsLnByb3RvdHlwZS5zY3JvbGxCb3R0b20gPSBmdW5jdGlvbihvZmZzZXRZKSB7CiAgICAgIGlmICghdGhpcy5pc0FjdGl2ZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLiRjb250ZW50LnNjcm9sbFRvcCh0aGlzLmNvbnRlbnRIZWlnaHQgLSB0aGlzLiRjb250ZW50LmhlaWdodCgpIC0gb2Zmc2V0WSkudHJpZ2dlcihNT1VTRVdIRUVMKTsKICAgICAgdGhpcy5zdG9wKCkucmVzdG9yZSgpOwogICAgICByZXR1cm4gdGhpczsKICAgIH07CgoKICAgIC8qKgogICAgICBTY3JvbGwgYXQgdGhlIHRvcCB3aXRoIGFuIG9mZnNldCB2YWx1ZQogICAgICBAbWV0aG9kIHNjcm9sbFRvcAogICAgICBAcGFyYW0gb2Zmc2V0WSB7TnVtYmVyfQogICAgICBAY2hhaW5hYmxlCiAgICAgIEBleGFtcGxlCiAgICAgICAgICAkKCIubmFubyIpLm5hbm9TY3JvbGxlcih7IHNjcm9sbFRvcDogdmFsdWUgfSk7CiAgICAgKi8KCiAgICBOYW5vU2Nyb2xsLnByb3RvdHlwZS5zY3JvbGxUb3AgPSBmdW5jdGlvbihvZmZzZXRZKSB7CiAgICAgIGlmICghdGhpcy5pc0FjdGl2ZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLiRjb250ZW50LnNjcm9sbFRvcCgrb2Zmc2V0WSkudHJpZ2dlcihNT1VTRVdIRUVMKTsKICAgICAgdGhpcy5zdG9wKCkucmVzdG9yZSgpOwogICAgICByZXR1cm4gdGhpczsKICAgIH07CgoKICAgIC8qKgogICAgICBTY3JvbGwgdG8gYW4gZWxlbWVudAogICAgICBAbWV0aG9kIHNjcm9sbFRvCiAgICAgIEBwYXJhbSBub2RlIHtOb2RlfSBBIG5vZGUgdG8gc2Nyb2xsIHRvLgogICAgICBAY2hhaW5hYmxlCiAgICAgIEBleGFtcGxlCiAgICAgICAgICAkKCIubmFubyIpLm5hbm9TY3JvbGxlcih7IHNjcm9sbFRvOiAkKCcjYV9ub2RlJykgfSk7CiAgICAgKi8KCiAgICBOYW5vU2Nyb2xsLnByb3RvdHlwZS5zY3JvbGxUbyA9IGZ1bmN0aW9uKG5vZGUpIHsKICAgICAgaWYgKCF0aGlzLmlzQWN0aXZlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMuc2Nyb2xsVG9wKHRoaXMuJGVsLmZpbmQobm9kZSkuZ2V0KDApLm9mZnNldFRvcCk7CiAgICAgIHJldHVybiB0aGlzOwogICAgfTsKCgogICAgLyoqCiAgICAgIFRvIHN0b3AgdGhlIG9wZXJhdGlvbi4KICAgICAgVGhpcyBvcHRpb24gd2lsbCB0ZWxsIHRoZSBwbHVnaW4gdG8gZGlzYWJsZSBhbGwgZXZlbnQgYmluZGluZ3MgYW5kIGhpZGUgdGhlIGdhZGdldCBzY3JvbGxiYXIgZnJvbSB0aGUgVUkuCiAgICAgIEBtZXRob2Qgc3RvcAogICAgICBAY2hhaW5hYmxlCiAgICAgIEBleGFtcGxlCiAgICAgICAgICAkKCIubmFubyIpLm5hbm9TY3JvbGxlcih7IHN0b3A6IHRydWUgfSk7CiAgICAgKi8KCiAgICBOYW5vU2Nyb2xsLnByb3RvdHlwZS5zdG9wID0gZnVuY3Rpb24oKSB7CiAgICAgIGlmIChjQUYgJiYgdGhpcy5zY3JvbGxSQUYpIHsKICAgICAgICBjQUYodGhpcy5zY3JvbGxSQUYpOwogICAgICAgIHRoaXMuc2Nyb2xsUkFGID0gbnVsbDsKICAgICAgfQogICAgICB0aGlzLnN0b3BwZWQgPSB0cnVlOwogICAgICB0aGlzLnJlbW92ZUV2ZW50cygpOwogICAgICBpZiAoIXRoaXMuaU9TTmF0aXZlU2Nyb2xsaW5nKSB7CiAgICAgICAgdGhpcy5wYW5lLmhpZGUoKTsKICAgICAgfQogICAgICByZXR1cm4gdGhpczsKICAgIH07CgoKICAgIC8qKgogICAgICBEZXN0cm95cyBuYW5vU2Nyb2xsZXIgYW5kIHJlc3RvcmVzIGJyb3dzZXIncyBuYXRpdmUgc2Nyb2xsYmFyLgogICAgICBAbWV0aG9kIGRlc3Ryb3kKICAgICAgQGNoYWluYWJsZQogICAgICBAZXhhbXBsZQogICAgICAgICAgJCgiLm5hbm8iKS5uYW5vU2Nyb2xsZXIoeyBkZXN0cm95OiB0cnVlIH0pOwogICAgICovCgogICAgTmFub1Njcm9sbC5wcm90b3R5cGUuZGVzdHJveSA9IGZ1bmN0aW9uKCkgewogICAgICBpZiAoIXRoaXMuc3RvcHBlZCkgewogICAgICAgIHRoaXMuc3RvcCgpOwogICAgICB9CiAgICAgIGlmICghdGhpcy5pT1NOYXRpdmVTY3JvbGxpbmcgJiYgdGhpcy5wYW5lLmxlbmd0aCkgewogICAgICAgIHRoaXMucGFuZS5yZW1vdmUoKTsKICAgICAgfQogICAgICBpZiAoQlJPV1NFUl9JU19JRTcpIHsKICAgICAgICB0aGlzLiRjb250ZW50LmhlaWdodCgnJyk7CiAgICAgIH0KICAgICAgdGhpcy4kY29udGVudC5yZW1vdmVBdHRyKCd0YWJpbmRleCcpOwogICAgICBpZiAodGhpcy4kZWwuaGFzQ2xhc3MoJ2hhcy1zY3JvbGxiYXInKSkgewogICAgICAgIHRoaXMuJGVsLnJlbW92ZUNsYXNzKCdoYXMtc2Nyb2xsYmFyJyk7CiAgICAgICAgdGhpcy4kY29udGVudC5jc3MoewogICAgICAgICAgcmlnaHQ6ICcnCiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHRoaXM7CiAgICB9OwoKCiAgICAvKioKICAgICAgVG8gZmxhc2ggdGhlIHNjcm9sbGJhciBnYWRnZXQgZm9yIGFuIGFtb3VudCBvZiB0aW1lIGRlZmluZWQgaW4gcGx1Z2luIHNldHRpbmdzIChkZWZhdWx0cyB0byAxLDVzKS4KICAgICAgVXNlZnVsIGlmIHlvdSB3YW50IHRvIHNob3cgdGhlIHVzZXIgKGUuZy4gb24gcGFnZWxvYWQpIHRoYXQgdGhlcmUgaXMgbW9yZSBjb250ZW50IHdhaXRpbmcgZm9yIGhpbS4KICAgICAgQG1ldGhvZCBmbGFzaAogICAgICBAY2hhaW5hYmxlCiAgICAgIEBleGFtcGxlCiAgICAgICAgICAkKCIubmFubyIpLm5hbm9TY3JvbGxlcih7IGZsYXNoOiB0cnVlIH0pOwogICAgICovCgogICAgTmFub1Njcm9sbC5wcm90b3R5cGUuZmxhc2ggPSBmdW5jdGlvbigpIHsKICAgICAgaWYgKHRoaXMuaU9TTmF0aXZlU2Nyb2xsaW5nKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmICghdGhpcy5pc0FjdGl2ZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLnJlc2V0KCk7CiAgICAgIHRoaXMucGFuZS5hZGRDbGFzcygnZmxhc2hlZCcpOwogICAgICBzZXRUaW1lb3V0KChmdW5jdGlvbihfdGhpcykgewogICAgICAgIHJldHVybiBmdW5jdGlvbigpIHsKICAgICAgICAgIF90aGlzLnBhbmUucmVtb3ZlQ2xhc3MoJ2ZsYXNoZWQnKTsKICAgICAgICB9OwogICAgICB9KSh0aGlzKSwgdGhpcy5vcHRpb25zLmZsYXNoRGVsYXkpOwogICAgICByZXR1cm4gdGhpczsKICAgIH07CgogICAgcmV0dXJuIE5hbm9TY3JvbGw7CgogIH0pKCk7CiAgJC5mbi5uYW5vU2Nyb2xsZXIgPSBmdW5jdGlvbihzZXR0aW5ncykgewogICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpIHsKICAgICAgdmFyIG9wdGlvbnMsIHNjcm9sbGJhcjsKICAgICAgaWYgKCEoc2Nyb2xsYmFyID0gdGhpcy5uYW5vc2Nyb2xsZXIpKSB7CiAgICAgICAgb3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCBkZWZhdWx0cywgc2V0dGluZ3MpOwogICAgICAgIHRoaXMubmFub3Njcm9sbGVyID0gc2Nyb2xsYmFyID0gbmV3IE5hbm9TY3JvbGwodGhpcywgb3B0aW9ucyk7CiAgICAgIH0KICAgICAgaWYgKHNldHRpbmdzICYmIHR5cGVvZiBzZXR0aW5ncyA9PT0gIm9iamVjdCIpIHsKICAgICAgICAkLmV4dGVuZChzY3JvbGxiYXIub3B0aW9ucywgc2V0dGluZ3MpOwogICAgICAgIGlmIChzZXR0aW5ncy5zY3JvbGxCb3R0b20gIT0gbnVsbCkgewogICAgICAgICAgcmV0dXJuIHNjcm9sbGJhci5zY3JvbGxCb3R0b20oc2V0dGluZ3Muc2Nyb2xsQm90dG9tKTsKICAgICAgICB9CiAgICAgICAgaWYgKHNldHRpbmdzLnNjcm9sbFRvcCAhPSBudWxsKSB7CiAgICAgICAgICByZXR1cm4gc2Nyb2xsYmFyLnNjcm9sbFRvcChzZXR0aW5ncy5zY3JvbGxUb3ApOwogICAgICAgIH0KICAgICAgICBpZiAoc2V0dGluZ3Muc2Nyb2xsVG8pIHsKICAgICAgICAgIHJldHVybiBzY3JvbGxiYXIuc2Nyb2xsVG8oc2V0dGluZ3Muc2Nyb2xsVG8pOwogICAgICAgIH0KICAgICAgICBpZiAoc2V0dGluZ3Muc2Nyb2xsID09PSAnYm90dG9tJykgewogICAgICAgICAgcmV0dXJuIHNjcm9sbGJhci5zY3JvbGxCb3R0b20oMCk7CiAgICAgICAgfQogICAgICAgIGlmIChzZXR0aW5ncy5zY3JvbGwgPT09ICd0b3AnKSB7CiAgICAgICAgICByZXR1cm4gc2Nyb2xsYmFyLnNjcm9sbFRvcCgwKTsKICAgICAgICB9CiAgICAgICAgaWYgKHNldHRpbmdzLnNjcm9sbCAmJiBzZXR0aW5ncy5zY3JvbGwgaW5zdGFuY2VvZiAkKSB7CiAgICAgICAgICByZXR1cm4gc2Nyb2xsYmFyLnNjcm9sbFRvKHNldHRpbmdzLnNjcm9sbCk7CiAgICAgICAgfQogICAgICAgIGlmIChzZXR0aW5ncy5zdG9wKSB7CiAgICAgICAgICByZXR1cm4gc2Nyb2xsYmFyLnN0b3AoKTsKICAgICAgICB9CiAgICAgICAgaWYgKHNldHRpbmdzLmRlc3Ryb3kpIHsKICAgICAgICAgIHJldHVybiBzY3JvbGxiYXIuZGVzdHJveSgpOwogICAgICAgIH0KICAgICAgICBpZiAoc2V0dGluZ3MuZmxhc2gpIHsKICAgICAgICAgIHJldHVybiBzY3JvbGxiYXIuZmxhc2goKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHNjcm9sbGJhci5yZXNldCgpOwogICAgfSk7CiAgfTsKICAkLmZuLm5hbm9TY3JvbGxlci5Db25zdHJ1Y3RvciA9IE5hbm9TY3JvbGw7Cn0pOwoKLy8jIHNvdXJjZU1hcHBpbmdVUkw9anF1ZXJ5Lm5hbm9zY3JvbGxlci5qcy5tYXAK",
    "size": "26211"
}