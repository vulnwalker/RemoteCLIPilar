{
    "namaFile": "pages\/admin\/menu\/assets\/js\/libs\/bootstrap-datepicker\/bootstrap-datepicker.js",
    "lastUpdate": "2018-03-22+14:18:54.70",
    "contentFile": "LyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAqIGJvb3RzdHJhcC1kYXRlcGlja2VyLmpzCiAqIFJlcG86IGh0dHBzOi8vZ2l0aHViLmNvbS9ldGVybmljb2RlL2Jvb3RzdHJhcC1kYXRlcGlja2VyLwogKiBEZW1vOiBodHRwOi8vZXRlcm5pY29kZS5naXRodWIuaW8vYm9vdHN0cmFwLWRhdGVwaWNrZXIvCiAqIERvY3M6IGh0dHA6Ly9ib290c3RyYXAtZGF0ZXBpY2tlci5yZWFkdGhlZG9jcy5vcmcvCiAqIEZvcmtlZCBmcm9tIGh0dHA6Ly93d3cuZXllY29uLnJvL2Jvb3RzdHJhcC1kYXRlcGlja2VyCiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogKiBTdGFydGVkIGJ5IFN0ZWZhbiBQZXRyZTsgaW1wcm92ZW1lbnRzIGJ5IEFuZHJldyBSb3dscyArIGNvbnRyaWJ1dG9ycwogKgogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsKICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICoKICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAqCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUKICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLwoKKGZ1bmN0aW9uKCQsIHVuZGVmaW5lZCl7CgoJdmFyICR3aW5kb3cgPSAkKHdpbmRvdyk7CgoJZnVuY3Rpb24gVVRDRGF0ZSgpewoJCXJldHVybiBuZXcgRGF0ZShEYXRlLlVUQy5hcHBseShEYXRlLCBhcmd1bWVudHMpKTsKCX0KCWZ1bmN0aW9uIFVUQ1RvZGF5KCl7CgkJdmFyIHRvZGF5ID0gbmV3IERhdGUoKTsKCQlyZXR1cm4gVVRDRGF0ZSh0b2RheS5nZXRGdWxsWWVhcigpLCB0b2RheS5nZXRNb250aCgpLCB0b2RheS5nZXREYXRlKCkpOwoJfQoJZnVuY3Rpb24gYWxpYXMobWV0aG9kKXsKCQlyZXR1cm4gZnVuY3Rpb24oKXsKCQkJcmV0dXJuIHRoaXNbbWV0aG9kXS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoJCX07Cgl9CgoJdmFyIERhdGVBcnJheSA9IChmdW5jdGlvbigpewoJCXZhciBleHRyYXMgPSB7CgkJCWdldDogZnVuY3Rpb24oaSl7CgkJCQlyZXR1cm4gdGhpcy5zbGljZShpKVswXTsKCQkJfSwKCQkJY29udGFpbnM6IGZ1bmN0aW9uKGQpewoJCQkJLy8gQXJyYXkuaW5kZXhPZiBpcyBub3QgY3Jvc3MtYnJvd3NlcjsKCQkJCS8vICQuaW5BcnJheSBkb2Vzbid0IHdvcmsgd2l0aCBEYXRlcwoJCQkJdmFyIHZhbCA9IGQgJiYgZC52YWx1ZU9mKCk7CgkJCQlmb3IgKHZhciBpPTAsIGw9dGhpcy5sZW5ndGg7IGkgPCBsOyBpKyspCgkJCQkJaWYgKHRoaXNbaV0udmFsdWVPZigpID09PSB2YWwpCgkJCQkJCXJldHVybiBpOwoJCQkJcmV0dXJuIC0xOwoJCQl9LAoJCQlyZW1vdmU6IGZ1bmN0aW9uKGkpewoJCQkJdGhpcy5zcGxpY2UoaSwxKTsKCQkJfSwKCQkJcmVwbGFjZTogZnVuY3Rpb24obmV3X2FycmF5KXsKCQkJCWlmICghbmV3X2FycmF5KQoJCQkJCXJldHVybjsKCQkJCWlmICghJC5pc0FycmF5KG5ld19hcnJheSkpCgkJCQkJbmV3X2FycmF5ID0gW25ld19hcnJheV07CgkJCQl0aGlzLmNsZWFyKCk7CgkJCQl0aGlzLnB1c2guYXBwbHkodGhpcywgbmV3X2FycmF5KTsKCQkJfSwKCQkJY2xlYXI6IGZ1bmN0aW9uKCl7CgkJCQl0aGlzLmxlbmd0aCA9IDA7CgkJCX0sCgkJCWNvcHk6IGZ1bmN0aW9uKCl7CgkJCQl2YXIgYSA9IG5ldyBEYXRlQXJyYXkoKTsKCQkJCWEucmVwbGFjZSh0aGlzKTsKCQkJCXJldHVybiBhOwoJCQl9CgkJfTsKCgkJcmV0dXJuIGZ1bmN0aW9uKCl7CgkJCXZhciBhID0gW107CgkJCWEucHVzaC5hcHBseShhLCBhcmd1bWVudHMpOwoJCQkkLmV4dGVuZChhLCBleHRyYXMpOwoJCQlyZXR1cm4gYTsKCQl9OwoJfSkoKTsKCgoJLy8gUGlja2VyIG9iamVjdAoKCXZhciBEYXRlcGlja2VyID0gZnVuY3Rpb24oZWxlbWVudCwgb3B0aW9ucyl7CgkJdGhpcy5kYXRlcyA9IG5ldyBEYXRlQXJyYXkoKTsKCQl0aGlzLnZpZXdEYXRlID0gVVRDVG9kYXkoKTsKCQl0aGlzLmZvY3VzRGF0ZSA9IG51bGw7CgoJCXRoaXMuX3Byb2Nlc3Nfb3B0aW9ucyhvcHRpb25zKTsKCgkJdGhpcy5lbGVtZW50ID0gJChlbGVtZW50KTsKCQl0aGlzLmlzSW5saW5lID0gZmFsc2U7CgkJdGhpcy5pc0lucHV0ID0gdGhpcy5lbGVtZW50LmlzKCdpbnB1dCcpOwoJCXRoaXMuY29tcG9uZW50ID0gdGhpcy5lbGVtZW50LmlzKCcuZGF0ZScpID8gdGhpcy5lbGVtZW50LmZpbmQoJy5hZGQtb24sIC5pbnB1dC1ncm91cC1hZGRvbiwgLmJ0bicpIDogZmFsc2U7CgkJdGhpcy5oYXNJbnB1dCA9IHRoaXMuY29tcG9uZW50ICYmIHRoaXMuZWxlbWVudC5maW5kKCdpbnB1dCcpLmxlbmd0aDsKCQlpZiAodGhpcy5jb21wb25lbnQgJiYgdGhpcy5jb21wb25lbnQubGVuZ3RoID09PSAwKQoJCQl0aGlzLmNvbXBvbmVudCA9IGZhbHNlOwoKCQl0aGlzLnBpY2tlciA9ICQoRFBHbG9iYWwudGVtcGxhdGUpOwoJCXRoaXMuX2J1aWxkRXZlbnRzKCk7CgkJdGhpcy5fYXR0YWNoRXZlbnRzKCk7CgoJCWlmICh0aGlzLmlzSW5saW5lKXsKCQkJdGhpcy5waWNrZXIuYWRkQ2xhc3MoJ2RhdGVwaWNrZXItaW5saW5lJykuYXBwZW5kVG8odGhpcy5lbGVtZW50KTsKCQl9CgkJZWxzZSB7CgkJCXRoaXMucGlja2VyLmFkZENsYXNzKCdkYXRlcGlja2VyLWRyb3Bkb3duIGRyb3Bkb3duLW1lbnUnKTsKCQl9CgoJCWlmICh0aGlzLm8ucnRsKXsKCQkJdGhpcy5waWNrZXIuYWRkQ2xhc3MoJ2RhdGVwaWNrZXItcnRsJyk7CgkJfQoKCQl0aGlzLnZpZXdNb2RlID0gdGhpcy5vLnN0YXJ0VmlldzsKCgkJaWYgKHRoaXMuby5jYWxlbmRhcldlZWtzKQoJCQl0aGlzLnBpY2tlci5maW5kKCd0Zm9vdCB0aC50b2RheSwgdGZvb3QgdGguY2xlYXInKQoJCQkJCQkuYXR0cignY29sc3BhbicsIGZ1bmN0aW9uKGksIHZhbCl7CgkJCQkJCQlyZXR1cm4gcGFyc2VJbnQodmFsKSArIDE7CgkJCQkJCX0pOwoKCQl0aGlzLl9hbGxvd191cGRhdGUgPSBmYWxzZTsKCgkJdGhpcy5zZXRTdGFydERhdGUodGhpcy5fby5zdGFydERhdGUpOwoJCXRoaXMuc2V0RW5kRGF0ZSh0aGlzLl9vLmVuZERhdGUpOwoJCXRoaXMuc2V0RGF5c09mV2Vla0Rpc2FibGVkKHRoaXMuby5kYXlzT2ZXZWVrRGlzYWJsZWQpOwoKCQl0aGlzLmZpbGxEb3coKTsKCQl0aGlzLmZpbGxNb250aHMoKTsKCgkJdGhpcy5fYWxsb3dfdXBkYXRlID0gdHJ1ZTsKCgkJdGhpcy51cGRhdGUoKTsKCQl0aGlzLnNob3dNb2RlKCk7CgoJCWlmICh0aGlzLmlzSW5saW5lKXsKCQkJdGhpcy5zaG93KCk7CgkJfQoJfTsKCglEYXRlcGlja2VyLnByb3RvdHlwZSA9IHsKCQljb25zdHJ1Y3RvcjogRGF0ZXBpY2tlciwKCgkJX3Byb2Nlc3Nfb3B0aW9uczogZnVuY3Rpb24ob3B0cyl7CgkJCS8vIFN0b3JlIHJhdyBvcHRpb25zIGZvciByZWZlcmVuY2UKCQkJdGhpcy5fbyA9ICQuZXh0ZW5kKHt9LCB0aGlzLl9vLCBvcHRzKTsKCQkJLy8gUHJvY2Vzc2VkIG9wdGlvbnMKCQkJdmFyIG8gPSB0aGlzLm8gPSAkLmV4dGVuZCh7fSwgdGhpcy5fbyk7CgoJCQkvLyBDaGVjayBpZiAiZGUtREUiIHN0eWxlIGRhdGUgaXMgYXZhaWxhYmxlLCBpZiBub3QgbGFuZ3VhZ2Ugc2hvdWxkCgkJCS8vIGZhbGxiYWNrIHRvIDIgbGV0dGVyIGNvZGUgZWcgImRlIgoJCQl2YXIgbGFuZyA9IG8ubGFuZ3VhZ2U7CgkJCWlmICghZGF0ZXNbbGFuZ10pewoJCQkJbGFuZyA9IGxhbmcuc3BsaXQoJy0nKVswXTsKCQkJCWlmICghZGF0ZXNbbGFuZ10pCgkJCQkJbGFuZyA9IGRlZmF1bHRzLmxhbmd1YWdlOwoJCQl9CgkJCW8ubGFuZ3VhZ2UgPSBsYW5nOwoKCQkJc3dpdGNoIChvLnN0YXJ0Vmlldyl7CgkJCQljYXNlIDI6CgkJCQljYXNlICdkZWNhZGUnOgoJCQkJCW8uc3RhcnRWaWV3ID0gMjsKCQkJCQlicmVhazsKCQkJCWNhc2UgMToKCQkJCWNhc2UgJ3llYXInOgoJCQkJCW8uc3RhcnRWaWV3ID0gMTsKCQkJCQlicmVhazsKCQkJCWRlZmF1bHQ6CgkJCQkJby5zdGFydFZpZXcgPSAwOwoJCQl9CgoJCQlzd2l0Y2ggKG8ubWluVmlld01vZGUpewoJCQkJY2FzZSAxOgoJCQkJY2FzZSAnbW9udGhzJzoKCQkJCQlvLm1pblZpZXdNb2RlID0gMTsKCQkJCQlicmVhazsKCQkJCWNhc2UgMjoKCQkJCWNhc2UgJ3llYXJzJzoKCQkJCQlvLm1pblZpZXdNb2RlID0gMjsKCQkJCQlicmVhazsKCQkJCWRlZmF1bHQ6CgkJCQkJby5taW5WaWV3TW9kZSA9IDA7CgkJCX0KCgkJCW8uc3RhcnRWaWV3ID0gTWF0aC5tYXgoby5zdGFydFZpZXcsIG8ubWluVmlld01vZGUpOwoKCQkJLy8gdHJ1ZSwgZmFsc2UsIG9yIE51bWJlciA+IDAKCQkJaWYgKG8ubXVsdGlkYXRlICE9PSB0cnVlKXsKCQkJCW8ubXVsdGlkYXRlID0gTnVtYmVyKG8ubXVsdGlkYXRlKSB8fCBmYWxzZTsKCQkJCWlmIChvLm11bHRpZGF0ZSAhPT0gZmFsc2UpCgkJCQkJby5tdWx0aWRhdGUgPSBNYXRoLm1heCgwLCBvLm11bHRpZGF0ZSk7CgkJCQllbHNlCgkJCQkJby5tdWx0aWRhdGUgPSAxOwoJCQl9CgkJCW8ubXVsdGlkYXRlU2VwYXJhdG9yID0gU3RyaW5nKG8ubXVsdGlkYXRlU2VwYXJhdG9yKTsKCgkJCW8ud2Vla1N0YXJ0ICU9IDc7CgkJCW8ud2Vla0VuZCA9ICgoby53ZWVrU3RhcnQgKyA2KSAlIDcpOwoKCQkJdmFyIGZvcm1hdCA9IERQR2xvYmFsLnBhcnNlRm9ybWF0KG8uZm9ybWF0KTsKCQkJaWYgKG8uc3RhcnREYXRlICE9PSAtSW5maW5pdHkpewoJCQkJaWYgKCEhby5zdGFydERhdGUpewoJCQkJCWlmIChvLnN0YXJ0RGF0ZSBpbnN0YW5jZW9mIERhdGUpCgkJCQkJCW8uc3RhcnREYXRlID0gdGhpcy5fbG9jYWxfdG9fdXRjKHRoaXMuX3plcm9fdGltZShvLnN0YXJ0RGF0ZSkpOwoJCQkJCWVsc2UKCQkJCQkJby5zdGFydERhdGUgPSBEUEdsb2JhbC5wYXJzZURhdGUoby5zdGFydERhdGUsIGZvcm1hdCwgby5sYW5ndWFnZSk7CgkJCQl9CgkJCQllbHNlIHsKCQkJCQlvLnN0YXJ0RGF0ZSA9IC1JbmZpbml0eTsKCQkJCX0KCQkJfQoJCQlpZiAoby5lbmREYXRlICE9PSBJbmZpbml0eSl7CgkJCQlpZiAoISFvLmVuZERhdGUpewoJCQkJCWlmIChvLmVuZERhdGUgaW5zdGFuY2VvZiBEYXRlKQoJCQkJCQlvLmVuZERhdGUgPSB0aGlzLl9sb2NhbF90b191dGModGhpcy5femVyb190aW1lKG8uZW5kRGF0ZSkpOwoJCQkJCWVsc2UKCQkJCQkJby5lbmREYXRlID0gRFBHbG9iYWwucGFyc2VEYXRlKG8uZW5kRGF0ZSwgZm9ybWF0LCBvLmxhbmd1YWdlKTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCW8uZW5kRGF0ZSA9IEluZmluaXR5OwoJCQkJfQoJCQl9CgoJCQlvLmRheXNPZldlZWtEaXNhYmxlZCA9IG8uZGF5c09mV2Vla0Rpc2FibGVkfHxbXTsKCQkJaWYgKCEkLmlzQXJyYXkoby5kYXlzT2ZXZWVrRGlzYWJsZWQpKQoJCQkJby5kYXlzT2ZXZWVrRGlzYWJsZWQgPSBvLmRheXNPZldlZWtEaXNhYmxlZC5zcGxpdCgvWyxcc10qLyk7CgkJCW8uZGF5c09mV2Vla0Rpc2FibGVkID0gJC5tYXAoby5kYXlzT2ZXZWVrRGlzYWJsZWQsIGZ1bmN0aW9uKGQpewoJCQkJcmV0dXJuIHBhcnNlSW50KGQsIDEwKTsKCQkJfSk7CgoJCQl2YXIgcGxjID0gU3RyaW5nKG8ub3JpZW50YXRpb24pLnRvTG93ZXJDYXNlKCkuc3BsaXQoL1xzKy9nKSwKCQkJCV9wbGMgPSBvLm9yaWVudGF0aW9uLnRvTG93ZXJDYXNlKCk7CgkJCXBsYyA9ICQuZ3JlcChwbGMsIGZ1bmN0aW9uKHdvcmQpewoJCQkJcmV0dXJuICgvXmF1dG98bGVmdHxyaWdodHx0b3B8Ym90dG9tJC8pLnRlc3Qod29yZCk7CgkJCX0pOwoJCQlvLm9yaWVudGF0aW9uID0ge3g6ICdhdXRvJywgeTogJ2F1dG8nfTsKCQkJaWYgKCFfcGxjIHx8IF9wbGMgPT09ICdhdXRvJykKCQkJCTsgLy8gbm8gYWN0aW9uCgkJCWVsc2UgaWYgKHBsYy5sZW5ndGggPT09IDEpewoJCQkJc3dpdGNoIChwbGNbMF0pewoJCQkJCWNhc2UgJ3RvcCc6CgkJCQkJY2FzZSAnYm90dG9tJzoKCQkJCQkJby5vcmllbnRhdGlvbi55ID0gcGxjWzBdOwoJCQkJCQlicmVhazsKCQkJCQljYXNlICdsZWZ0JzoKCQkJCQljYXNlICdyaWdodCc6CgkJCQkJCW8ub3JpZW50YXRpb24ueCA9IHBsY1swXTsKCQkJCQkJYnJlYWs7CgkJCQl9CgkJCX0KCQkJZWxzZSB7CgkJCQlfcGxjID0gJC5ncmVwKHBsYywgZnVuY3Rpb24od29yZCl7CgkJCQkJcmV0dXJuICgvXmxlZnR8cmlnaHQkLykudGVzdCh3b3JkKTsKCQkJCX0pOwoJCQkJby5vcmllbnRhdGlvbi54ID0gX3BsY1swXSB8fCAnYXV0byc7CgoJCQkJX3BsYyA9ICQuZ3JlcChwbGMsIGZ1bmN0aW9uKHdvcmQpewoJCQkJCXJldHVybiAoL150b3B8Ym90dG9tJC8pLnRlc3Qod29yZCk7CgkJCQl9KTsKCQkJCW8ub3JpZW50YXRpb24ueSA9IF9wbGNbMF0gfHwgJ2F1dG8nOwoJCQl9CgkJfSwKCQlfZXZlbnRzOiBbXSwKCQlfc2Vjb25kYXJ5RXZlbnRzOiBbXSwKCQlfYXBwbHlFdmVudHM6IGZ1bmN0aW9uKGV2cyl7CgkJCWZvciAodmFyIGk9MCwgZWwsIGNoLCBldjsgaSA8IGV2cy5sZW5ndGg7IGkrKyl7CgkJCQllbCA9IGV2c1tpXVswXTsKCQkJCWlmIChldnNbaV0ubGVuZ3RoID09PSAyKXsKCQkJCQljaCA9IHVuZGVmaW5lZDsKCQkJCQlldiA9IGV2c1tpXVsxXTsKCQkJCX0KCQkJCWVsc2UgaWYgKGV2c1tpXS5sZW5ndGggPT09IDMpewoJCQkJCWNoID0gZXZzW2ldWzFdOwoJCQkJCWV2ID0gZXZzW2ldWzJdOwoJCQkJfQoJCQkJZWwub24oZXYsIGNoKTsKCQkJfQoJCX0sCgkJX3VuYXBwbHlFdmVudHM6IGZ1bmN0aW9uKGV2cyl7CgkJCWZvciAodmFyIGk9MCwgZWwsIGV2LCBjaDsgaSA8IGV2cy5sZW5ndGg7IGkrKyl7CgkJCQllbCA9IGV2c1tpXVswXTsKCQkJCWlmIChldnNbaV0ubGVuZ3RoID09PSAyKXsKCQkJCQljaCA9IHVuZGVmaW5lZDsKCQkJCQlldiA9IGV2c1tpXVsxXTsKCQkJCX0KCQkJCWVsc2UgaWYgKGV2c1tpXS5sZW5ndGggPT09IDMpewoJCQkJCWNoID0gZXZzW2ldWzFdOwoJCQkJCWV2ID0gZXZzW2ldWzJdOwoJCQkJfQoJCQkJZWwub2ZmKGV2LCBjaCk7CgkJCX0KCQl9LAoJCV9idWlsZEV2ZW50czogZnVuY3Rpb24oKXsKCQkJaWYgKHRoaXMuaXNJbnB1dCl7IC8vIHNpbmdsZSBpbnB1dAoJCQkJdGhpcy5fZXZlbnRzID0gWwoJCQkJCVt0aGlzLmVsZW1lbnQsIHsKCQkJCQkJZm9jdXM6ICQucHJveHkodGhpcy5zaG93LCB0aGlzKSwKCQkJCQkJa2V5dXA6ICQucHJveHkoZnVuY3Rpb24oZSl7CgkJCQkJCQlpZiAoJC5pbkFycmF5KGUua2V5Q29kZSwgWzI3LDM3LDM5LDM4LDQwLDMyLDEzLDldKSA9PT0gLTEpCgkJCQkJCQkJdGhpcy51cGRhdGUoKTsKCQkJCQkJfSwgdGhpcyksCgkJCQkJCWtleWRvd246ICQucHJveHkodGhpcy5rZXlkb3duLCB0aGlzKQoJCQkJCX1dCgkJCQldOwoJCQl9CgkJCWVsc2UgaWYgKHRoaXMuY29tcG9uZW50ICYmIHRoaXMuaGFzSW5wdXQpeyAvLyBjb21wb25lbnQ6IGlucHV0ICsgYnV0dG9uCgkJCQl0aGlzLl9ldmVudHMgPSBbCgkJCQkJLy8gRm9yIGNvbXBvbmVudHMgdGhhdCBhcmUgbm90IHJlYWRvbmx5LCBhbGxvdyBrZXlib2FyZCBuYXYKCQkJCQlbdGhpcy5lbGVtZW50LmZpbmQoJ2lucHV0JyksIHsKCQkJCQkJZm9jdXM6ICQucHJveHkodGhpcy5zaG93LCB0aGlzKSwKCQkJCQkJa2V5dXA6ICQucHJveHkoZnVuY3Rpb24oZSl7CgkJCQkJCQlpZiAoJC5pbkFycmF5KGUua2V5Q29kZSwgWzI3LDM3LDM5LDM4LDQwLDMyLDEzLDldKSA9PT0gLTEpCgkJCQkJCQkJdGhpcy51cGRhdGUoKTsKCQkJCQkJfSwgdGhpcyksCgkJCQkJCWtleWRvd246ICQucHJveHkodGhpcy5rZXlkb3duLCB0aGlzKQoJCQkJCX1dLAoJCQkJCVt0aGlzLmNvbXBvbmVudCwgewoJCQkJCQljbGljazogJC5wcm94eSh0aGlzLnNob3csIHRoaXMpCgkJCQkJfV0KCQkJCV07CgkJCX0KCQkJZWxzZSBpZiAodGhpcy5lbGVtZW50LmlzKCdkaXYnKSl7ICAvLyBpbmxpbmUgZGF0ZXBpY2tlcgoJCQkJdGhpcy5pc0lubGluZSA9IHRydWU7CgkJCX0KCQkJZWxzZSB7CgkJCQl0aGlzLl9ldmVudHMgPSBbCgkJCQkJW3RoaXMuZWxlbWVudCwgewoJCQkJCQljbGljazogJC5wcm94eSh0aGlzLnNob3csIHRoaXMpCgkJCQkJfV0KCQkJCV07CgkJCX0KCQkJdGhpcy5fZXZlbnRzLnB1c2goCgkJCQkvLyBDb21wb25lbnQ6IGxpc3RlbiBmb3IgYmx1ciBvbiBlbGVtZW50IGRlc2NlbmRhbnRzCgkJCQlbdGhpcy5lbGVtZW50LCAnKicsIHsKCQkJCQlibHVyOiAkLnByb3h5KGZ1bmN0aW9uKGUpewoJCQkJCQl0aGlzLl9mb2N1c2VkX2Zyb20gPSBlLnRhcmdldDsKCQkJCQl9LCB0aGlzKQoJCQkJfV0sCgkJCQkvLyBJbnB1dDogbGlzdGVuIGZvciBibHVyIG9uIGVsZW1lbnQKCQkJCVt0aGlzLmVsZW1lbnQsIHsKCQkJCQlibHVyOiAkLnByb3h5KGZ1bmN0aW9uKGUpewoJCQkJCQl0aGlzLl9mb2N1c2VkX2Zyb20gPSBlLnRhcmdldDsKCQkJCQl9LCB0aGlzKQoJCQkJfV0KCQkJKTsKCgkJCXRoaXMuX3NlY29uZGFyeUV2ZW50cyA9IFsKCQkJCVt0aGlzLnBpY2tlciwgewoJCQkJCWNsaWNrOiAkLnByb3h5KHRoaXMuY2xpY2ssIHRoaXMpCgkJCQl9XSwKCQkJCVskKHdpbmRvdyksIHsKCQkJCQlyZXNpemU6ICQucHJveHkodGhpcy5wbGFjZSwgdGhpcykKCQkJCX1dLAoJCQkJWyQoZG9jdW1lbnQpLCB7CgkJCQkJJ21vdXNlZG93biB0b3VjaHN0YXJ0JzogJC5wcm94eShmdW5jdGlvbihlKXsKCQkJCQkJLy8gQ2xpY2tlZCBvdXRzaWRlIHRoZSBkYXRlcGlja2VyLCBoaWRlIGl0CgkJCQkJCWlmICghKAoJCQkJCQkJdGhpcy5lbGVtZW50LmlzKGUudGFyZ2V0KSB8fAoJCQkJCQkJdGhpcy5lbGVtZW50LmZpbmQoZS50YXJnZXQpLmxlbmd0aCB8fAoJCQkJCQkJdGhpcy5waWNrZXIuaXMoZS50YXJnZXQpIHx8CgkJCQkJCQl0aGlzLnBpY2tlci5maW5kKGUudGFyZ2V0KS5sZW5ndGgKCQkJCQkJKSl7CgkJCQkJCQl0aGlzLmhpZGUoKTsKCQkJCQkJfQoJCQkJCX0sIHRoaXMpCgkJCQl9XQoJCQldOwoJCX0sCgkJX2F0dGFjaEV2ZW50czogZnVuY3Rpb24oKXsKCQkJdGhpcy5fZGV0YWNoRXZlbnRzKCk7CgkJCXRoaXMuX2FwcGx5RXZlbnRzKHRoaXMuX2V2ZW50cyk7CgkJfSwKCQlfZGV0YWNoRXZlbnRzOiBmdW5jdGlvbigpewoJCQl0aGlzLl91bmFwcGx5RXZlbnRzKHRoaXMuX2V2ZW50cyk7CgkJfSwKCQlfYXR0YWNoU2Vjb25kYXJ5RXZlbnRzOiBmdW5jdGlvbigpewoJCQl0aGlzLl9kZXRhY2hTZWNvbmRhcnlFdmVudHMoKTsKCQkJdGhpcy5fYXBwbHlFdmVudHModGhpcy5fc2Vjb25kYXJ5RXZlbnRzKTsKCQl9LAoJCV9kZXRhY2hTZWNvbmRhcnlFdmVudHM6IGZ1bmN0aW9uKCl7CgkJCXRoaXMuX3VuYXBwbHlFdmVudHModGhpcy5fc2Vjb25kYXJ5RXZlbnRzKTsKCQl9LAoJCV90cmlnZ2VyOiBmdW5jdGlvbihldmVudCwgYWx0ZGF0ZSl7CgkJCXZhciBkYXRlID0gYWx0ZGF0ZSB8fCB0aGlzLmRhdGVzLmdldCgtMSksCgkJCQlsb2NhbF9kYXRlID0gdGhpcy5fdXRjX3RvX2xvY2FsKGRhdGUpOwoKCQkJdGhpcy5lbGVtZW50LnRyaWdnZXIoewoJCQkJdHlwZTogZXZlbnQsCgkJCQlkYXRlOiBsb2NhbF9kYXRlLAoJCQkJZGF0ZXM6ICQubWFwKHRoaXMuZGF0ZXMsIHRoaXMuX3V0Y190b19sb2NhbCksCgkJCQlmb3JtYXQ6ICQucHJveHkoZnVuY3Rpb24oaXgsIGZvcm1hdCl7CgkJCQkJaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDApewoJCQkJCQlpeCA9IHRoaXMuZGF0ZXMubGVuZ3RoIC0gMTsKCQkJCQkJZm9ybWF0ID0gdGhpcy5vLmZvcm1hdDsKCQkJCQl9CgkJCQkJZWxzZSBpZiAodHlwZW9mIGl4ID09PSAnc3RyaW5nJyl7CgkJCQkJCWZvcm1hdCA9IGl4OwoJCQkJCQlpeCA9IHRoaXMuZGF0ZXMubGVuZ3RoIC0gMTsKCQkJCQl9CgkJCQkJZm9ybWF0ID0gZm9ybWF0IHx8IHRoaXMuby5mb3JtYXQ7CgkJCQkJdmFyIGRhdGUgPSB0aGlzLmRhdGVzLmdldChpeCk7CgkJCQkJcmV0dXJuIERQR2xvYmFsLmZvcm1hdERhdGUoZGF0ZSwgZm9ybWF0LCB0aGlzLm8ubGFuZ3VhZ2UpOwoJCQkJfSwgdGhpcykKCQkJfSk7CgkJfSwKCgkJc2hvdzogZnVuY3Rpb24oKXsKCQkJaWYgKCF0aGlzLmlzSW5saW5lKQoJCQkJdGhpcy5waWNrZXIuYXBwZW5kVG8oJ2JvZHknKTsKCQkJdGhpcy5waWNrZXIuc2hvdygpOwoJCQl0aGlzLnBsYWNlKCk7CgkJCXRoaXMuX2F0dGFjaFNlY29uZGFyeUV2ZW50cygpOwoJCQl0aGlzLl90cmlnZ2VyKCdzaG93Jyk7CgkJfSwKCgkJaGlkZTogZnVuY3Rpb24oKXsKCQkJaWYgKHRoaXMuaXNJbmxpbmUpCgkJCQlyZXR1cm47CgkJCWlmICghdGhpcy5waWNrZXIuaXMoJzp2aXNpYmxlJykpCgkJCQlyZXR1cm47CgkJCXRoaXMuZm9jdXNEYXRlID0gbnVsbDsKCQkJdGhpcy5waWNrZXIuaGlkZSgpLmRldGFjaCgpOwoJCQl0aGlzLl9kZXRhY2hTZWNvbmRhcnlFdmVudHMoKTsKCQkJdGhpcy52aWV3TW9kZSA9IHRoaXMuby5zdGFydFZpZXc7CgkJCXRoaXMuc2hvd01vZGUoKTsKCgkJCWlmICgKCQkJCXRoaXMuby5mb3JjZVBhcnNlICYmCgkJCQkoCgkJCQkJdGhpcy5pc0lucHV0ICYmIHRoaXMuZWxlbWVudC52YWwoKSB8fAoJCQkJCXRoaXMuaGFzSW5wdXQgJiYgdGhpcy5lbGVtZW50LmZpbmQoJ2lucHV0JykudmFsKCkKCQkJCSkKCQkJKQoJCQkJdGhpcy5zZXRWYWx1ZSgpOwoJCQl0aGlzLl90cmlnZ2VyKCdoaWRlJyk7CgkJfSwKCgkJcmVtb3ZlOiBmdW5jdGlvbigpewoJCQl0aGlzLmhpZGUoKTsKCQkJdGhpcy5fZGV0YWNoRXZlbnRzKCk7CgkJCXRoaXMuX2RldGFjaFNlY29uZGFyeUV2ZW50cygpOwoJCQl0aGlzLnBpY2tlci5yZW1vdmUoKTsKCQkJZGVsZXRlIHRoaXMuZWxlbWVudC5kYXRhKCkuZGF0ZXBpY2tlcjsKCQkJaWYgKCF0aGlzLmlzSW5wdXQpewoJCQkJZGVsZXRlIHRoaXMuZWxlbWVudC5kYXRhKCkuZGF0ZTsKCQkJfQoJCX0sCgoJCV91dGNfdG9fbG9jYWw6IGZ1bmN0aW9uKHV0Yyl7CgkJCXJldHVybiB1dGMgJiYgbmV3IERhdGUodXRjLmdldFRpbWUoKSArICh1dGMuZ2V0VGltZXpvbmVPZmZzZXQoKSo2MDAwMCkpOwoJCX0sCgkJX2xvY2FsX3RvX3V0YzogZnVuY3Rpb24obG9jYWwpewoJCQlyZXR1cm4gbG9jYWwgJiYgbmV3IERhdGUobG9jYWwuZ2V0VGltZSgpIC0gKGxvY2FsLmdldFRpbWV6b25lT2Zmc2V0KCkqNjAwMDApKTsKCQl9LAoJCV96ZXJvX3RpbWU6IGZ1bmN0aW9uKGxvY2FsKXsKCQkJcmV0dXJuIGxvY2FsICYmIG5ldyBEYXRlKGxvY2FsLmdldEZ1bGxZZWFyKCksIGxvY2FsLmdldE1vbnRoKCksIGxvY2FsLmdldERhdGUoKSk7CgkJfSwKCQlfemVyb191dGNfdGltZTogZnVuY3Rpb24odXRjKXsKCQkJcmV0dXJuIHV0YyAmJiBuZXcgRGF0ZShEYXRlLlVUQyh1dGMuZ2V0VVRDRnVsbFllYXIoKSwgdXRjLmdldFVUQ01vbnRoKCksIHV0Yy5nZXRVVENEYXRlKCkpKTsKCQl9LAoKCQlnZXREYXRlczogZnVuY3Rpb24oKXsKCQkJcmV0dXJuICQubWFwKHRoaXMuZGF0ZXMsIHRoaXMuX3V0Y190b19sb2NhbCk7CgkJfSwKCgkJZ2V0VVRDRGF0ZXM6IGZ1bmN0aW9uKCl7CgkJCXJldHVybiAkLm1hcCh0aGlzLmRhdGVzLCBmdW5jdGlvbihkKXsKCQkJCXJldHVybiBuZXcgRGF0ZShkKTsKCQkJfSk7CgkJfSwKCgkJZ2V0RGF0ZTogZnVuY3Rpb24oKXsKCQkJcmV0dXJuIHRoaXMuX3V0Y190b19sb2NhbCh0aGlzLmdldFVUQ0RhdGUoKSk7CgkJfSwKCgkJZ2V0VVRDRGF0ZTogZnVuY3Rpb24oKXsKCQkJcmV0dXJuIG5ldyBEYXRlKHRoaXMuZGF0ZXMuZ2V0KC0xKSk7CgkJfSwKCgkJc2V0RGF0ZXM6IGZ1bmN0aW9uKCl7CgkJCXZhciBhcmdzID0gJC5pc0FycmF5KGFyZ3VtZW50c1swXSkgPyBhcmd1bWVudHNbMF0gOiBhcmd1bWVudHM7CgkJCXRoaXMudXBkYXRlLmFwcGx5KHRoaXMsIGFyZ3MpOwoJCQl0aGlzLl90cmlnZ2VyKCdjaGFuZ2VEYXRlJyk7CgkJCXRoaXMuc2V0VmFsdWUoKTsKCQl9LAoKCQlzZXRVVENEYXRlczogZnVuY3Rpb24oKXsKCQkJdmFyIGFyZ3MgPSAkLmlzQXJyYXkoYXJndW1lbnRzWzBdKSA\/IGFyZ3VtZW50c1swXSA6IGFyZ3VtZW50czsKCQkJdGhpcy51cGRhdGUuYXBwbHkodGhpcywgJC5tYXAoYXJncywgdGhpcy5fdXRjX3RvX2xvY2FsKSk7CgkJCXRoaXMuX3RyaWdnZXIoJ2NoYW5nZURhdGUnKTsKCQkJdGhpcy5zZXRWYWx1ZSgpOwoJCX0sCgoJCXNldERhdGU6IGFsaWFzKCdzZXREYXRlcycpLAoJCXNldFVUQ0RhdGU6IGFsaWFzKCdzZXRVVENEYXRlcycpLAoKCQlzZXRWYWx1ZTogZnVuY3Rpb24oKXsKCQkJdmFyIGZvcm1hdHRlZCA9IHRoaXMuZ2V0Rm9ybWF0dGVkRGF0ZSgpOwoJCQlpZiAoIXRoaXMuaXNJbnB1dCl7CgkJCQlpZiAodGhpcy5jb21wb25lbnQpewoJCQkJCXRoaXMuZWxlbWVudC5maW5kKCdpbnB1dCcpLnZhbChmb3JtYXR0ZWQpLmNoYW5nZSgpOwoJCQkJfQoJCQl9CgkJCWVsc2UgewoJCQkJdGhpcy5lbGVtZW50LnZhbChmb3JtYXR0ZWQpLmNoYW5nZSgpOwoJCQl9CgkJfSwKCgkJZ2V0Rm9ybWF0dGVkRGF0ZTogZnVuY3Rpb24oZm9ybWF0KXsKCQkJaWYgKGZvcm1hdCA9PT0gdW5kZWZpbmVkKQoJCQkJZm9ybWF0ID0gdGhpcy5vLmZvcm1hdDsKCgkJCXZhciBsYW5nID0gdGhpcy5vLmxhbmd1YWdlOwoJCQlyZXR1cm4gJC5tYXAodGhpcy5kYXRlcywgZnVuY3Rpb24oZCl7CgkJCQlyZXR1cm4gRFBHbG9iYWwuZm9ybWF0RGF0ZShkLCBmb3JtYXQsIGxhbmcpOwoJCQl9KS5qb2luKHRoaXMuby5tdWx0aWRhdGVTZXBhcmF0b3IpOwoJCX0sCgoJCXNldFN0YXJ0RGF0ZTogZnVuY3Rpb24oc3RhcnREYXRlKXsKCQkJdGhpcy5fcHJvY2Vzc19vcHRpb25zKHtzdGFydERhdGU6IHN0YXJ0RGF0ZX0pOwoJCQl0aGlzLnVwZGF0ZSgpOwoJCQl0aGlzLnVwZGF0ZU5hdkFycm93cygpOwoJCX0sCgoJCXNldEVuZERhdGU6IGZ1bmN0aW9uKGVuZERhdGUpewoJCQl0aGlzLl9wcm9jZXNzX29wdGlvbnMoe2VuZERhdGU6IGVuZERhdGV9KTsKCQkJdGhpcy51cGRhdGUoKTsKCQkJdGhpcy51cGRhdGVOYXZBcnJvd3MoKTsKCQl9LAoKCQlzZXREYXlzT2ZXZWVrRGlzYWJsZWQ6IGZ1bmN0aW9uKGRheXNPZldlZWtEaXNhYmxlZCl7CgkJCXRoaXMuX3Byb2Nlc3Nfb3B0aW9ucyh7ZGF5c09mV2Vla0Rpc2FibGVkOiBkYXlzT2ZXZWVrRGlzYWJsZWR9KTsKCQkJdGhpcy51cGRhdGUoKTsKCQkJdGhpcy51cGRhdGVOYXZBcnJvd3MoKTsKCQl9LAoKCQlwbGFjZTogZnVuY3Rpb24oKXsKCQkJaWYgKHRoaXMuaXNJbmxpbmUpCgkJCQlyZXR1cm47CgkJCXZhciBjYWxlbmRhcldpZHRoID0gdGhpcy5waWNrZXIub3V0ZXJXaWR0aCgpLAoJCQkJY2FsZW5kYXJIZWlnaHQgPSB0aGlzLnBpY2tlci5vdXRlckhlaWdodCgpLAoJCQkJdmlzdWFsUGFkZGluZyA9IDEwLAoJCQkJd2luZG93V2lkdGggPSAkd2luZG93LndpZHRoKCksCgkJCQl3aW5kb3dIZWlnaHQgPSAkd2luZG93LmhlaWdodCgpLAoJCQkJc2Nyb2xsVG9wID0gJHdpbmRvdy5zY3JvbGxUb3AoKTsKCgkJCXZhciBwYXJlbnRzWmluZGV4ID0gW107CgkJCXRoaXMuZWxlbWVudC5wYXJlbnRzKCkuZWFjaChmdW5jdGlvbigpIHsKCQkJCXZhciBpdGVtWkluZGV4ID0gJCh0aGlzKS5jc3MoJ3otaW5kZXgnKTsKCQkJCWlmICggaXRlbVpJbmRleCAhPT0gJ2F1dG8nICYmIGl0ZW1aSW5kZXggIT09IDAgKSBwYXJlbnRzWmluZGV4LnB1c2goIHBhcnNlSW50KCBpdGVtWkluZGV4ICkgKTsKCQkJfSk7CgkJCXZhciB6SW5kZXggPSBNYXRoLm1heC5hcHBseSggTWF0aCwgcGFyZW50c1ppbmRleCApICsgMTA7CgkJCXZhciBvZmZzZXQgPSB0aGlzLmNvbXBvbmVudCA\/IHRoaXMuY29tcG9uZW50LnBhcmVudCgpLm9mZnNldCgpIDogdGhpcy5lbGVtZW50Lm9mZnNldCgpOwoJCQl2YXIgaGVpZ2h0ID0gdGhpcy5jb21wb25lbnQgPyB0aGlzLmNvbXBvbmVudC5vdXRlckhlaWdodCh0cnVlKSA6IHRoaXMuZWxlbWVudC5vdXRlckhlaWdodChmYWxzZSk7CgkJCXZhciB3aWR0aCA9IHRoaXMuY29tcG9uZW50ID8gdGhpcy5jb21wb25lbnQub3V0ZXJXaWR0aCh0cnVlKSA6IHRoaXMuZWxlbWVudC5vdXRlcldpZHRoKGZhbHNlKTsKCQkJdmFyIGxlZnQgPSBvZmZzZXQubGVmdCwKCQkJCXRvcCA9IG9mZnNldC50b3A7CgoJCQl0aGlzLnBpY2tlci5yZW1vdmVDbGFzcygKCQkJCSdkYXRlcGlja2VyLW9yaWVudC10b3AgZGF0ZXBpY2tlci1vcmllbnQtYm90dG9tICcrCgkJCQknZGF0ZXBpY2tlci1vcmllbnQtcmlnaHQgZGF0ZXBpY2tlci1vcmllbnQtbGVmdCcKCQkJKTsKCgkJCWlmICh0aGlzLm8ub3JpZW50YXRpb24ueCAhPT0gJ2F1dG8nKXsKCQkJCXRoaXMucGlja2VyLmFkZENsYXNzKCdkYXRlcGlja2VyLW9yaWVudC0nICsgdGhpcy5vLm9yaWVudGF0aW9uLngpOwoJCQkJaWYgKHRoaXMuby5vcmllbnRhdGlvbi54ID09PSAncmlnaHQnKQoJCQkJCWxlZnQgLT0gY2FsZW5kYXJXaWR0aCAtIHdpZHRoOwoJCQl9CgkJCS8vIGF1dG8geCBvcmllbnRhdGlvbiBpcyBiZXN0LXBsYWNlbWVudDogaWYgaXQgY3Jvc3NlcyBhIHdpbmRvdwoJCQkvLyBlZGdlLCBmdWRnZSBpdCBzaWRld2F5cwoJCQllbHNlIHsKCQkJCS8vIERlZmF1bHQgdG8gbGVmdAoJCQkJdGhpcy5waWNrZXIuYWRkQ2xhc3MoJ2RhdGVwaWNrZXItb3JpZW50LWxlZnQnKTsKCQkJCWlmIChvZmZzZXQubGVmdCA8IDApCgkJCQkJbGVmdCAtPSBvZmZzZXQubGVmdCAtIHZpc3VhbFBhZGRpbmc7CgkJCQllbHNlIGlmIChvZmZzZXQubGVmdCArIGNhbGVuZGFyV2lkdGggPiB3aW5kb3dXaWR0aCkKCQkJCQlsZWZ0ID0gd2luZG93V2lkdGggLSBjYWxlbmRhcldpZHRoIC0gdmlzdWFsUGFkZGluZzsKCQkJfQoKCQkJLy8gYXV0byB5IG9yaWVudGF0aW9uIGlzIGJlc3Qtc2l0dWF0aW9uOiB0b3Agb3IgYm90dG9tLCBubyBmdWRnaW5nLAoJCQkvLyBkZWNpc2lvbiBiYXNlZCBvbiB3aGljaCBzaG93cyBtb3JlIG9mIHRoZSBjYWxlbmRhcgoJCQl2YXIgeW9yaWVudCA9IHRoaXMuby5vcmllbnRhdGlvbi55LAoJCQkJdG9wX292ZXJmbG93LCBib3R0b21fb3ZlcmZsb3c7CgkJCWlmICh5b3JpZW50ID09PSAnYXV0bycpewoJCQkJdG9wX292ZXJmbG93ID0gLXNjcm9sbFRvcCArIG9mZnNldC50b3AgLSBjYWxlbmRhckhlaWdodDsKCQkJCWJvdHRvbV9vdmVyZmxvdyA9IHNjcm9sbFRvcCArIHdpbmRvd0hlaWdodCAtIChvZmZzZXQudG9wICsgaGVpZ2h0ICsgY2FsZW5kYXJIZWlnaHQpOwoJCQkJaWYgKE1hdGgubWF4KHRvcF9vdmVyZmxvdywgYm90dG9tX292ZXJmbG93KSA9PT0gYm90dG9tX292ZXJmbG93KQoJCQkJCXlvcmllbnQgPSAndG9wJzsKCQkJCWVsc2UKCQkJCQl5b3JpZW50ID0gJ2JvdHRvbSc7CgkJCX0KCQkJdGhpcy5waWNrZXIuYWRkQ2xhc3MoJ2RhdGVwaWNrZXItb3JpZW50LScgKyB5b3JpZW50KTsKCQkJaWYgKHlvcmllbnQgPT09ICd0b3AnKQoJCQkJdG9wICs9IGhlaWdodDsKCQkJZWxzZQoJCQkJdG9wIC09IGNhbGVuZGFySGVpZ2h0ICsgcGFyc2VJbnQodGhpcy5waWNrZXIuY3NzKCdwYWRkaW5nLXRvcCcpKTsKCgkJCXRoaXMucGlja2VyLmNzcyh7CgkJCQl0b3A6IHRvcCwKCQkJCWxlZnQ6IGxlZnQsCgkJCQl6SW5kZXg6IHpJbmRleAoJCQl9KTsKCQl9LAoKCQlfYWxsb3dfdXBkYXRlOiB0cnVlLAoJCXVwZGF0ZTogZnVuY3Rpb24oKXsKCQkJaWYgKCF0aGlzLl9hbGxvd191cGRhdGUpCgkJCQlyZXR1cm47CgoJCQl2YXIgb2xkRGF0ZXMgPSB0aGlzLmRhdGVzLmNvcHkoKSwKCQkJCWRhdGVzID0gW10sCgkJCQlmcm9tQXJncyA9IGZhbHNlOwoJCQlpZiAoYXJndW1lbnRzLmxlbmd0aCl7CgkJCQkkLmVhY2goYXJndW1lbnRzLCAkLnByb3h5KGZ1bmN0aW9uKGksIGRhdGUpewoJCQkJCWlmIChkYXRlIGluc3RhbmNlb2YgRGF0ZSkKCQkJCQkJZGF0ZSA9IHRoaXMuX2xvY2FsX3RvX3V0YyhkYXRlKTsKCQkJCQlkYXRlcy5wdXNoKGRhdGUpOwoJCQkJfSwgdGhpcykpOwoJCQkJZnJvbUFyZ3MgPSB0cnVlOwoJCQl9CgkJCWVsc2UgewoJCQkJZGF0ZXMgPSB0aGlzLmlzSW5wdXQKCQkJCQkJPyB0aGlzLmVsZW1lbnQudmFsKCkKCQkJCQkJOiB0aGlzLmVsZW1lbnQuZGF0YSgnZGF0ZScpIHx8IHRoaXMuZWxlbWVudC5maW5kKCdpbnB1dCcpLnZhbCgpOwoJCQkJaWYgKGRhdGVzICYmIHRoaXMuby5tdWx0aWRhdGUpCgkJCQkJZGF0ZXMgPSBkYXRlcy5zcGxpdCh0aGlzLm8ubXVsdGlkYXRlU2VwYXJhdG9yKTsKCQkJCWVsc2UKCQkJCQlkYXRlcyA9IFtkYXRlc107CgkJCQlkZWxldGUgdGhpcy5lbGVtZW50LmRhdGEoKS5kYXRlOwoJCQl9CgoJCQlkYXRlcyA9ICQubWFwKGRhdGVzLCAkLnByb3h5KGZ1bmN0aW9uKGRhdGUpewoJCQkJcmV0dXJuIERQR2xvYmFsLnBhcnNlRGF0ZShkYXRlLCB0aGlzLm8uZm9ybWF0LCB0aGlzLm8ubGFuZ3VhZ2UpOwoJCQl9LCB0aGlzKSk7CgkJCWRhdGVzID0gJC5ncmVwKGRhdGVzLCAkLnByb3h5KGZ1bmN0aW9uKGRhdGUpewoJCQkJcmV0dXJuICgKCQkJCQlkYXRlIDwgdGhpcy5vLnN0YXJ0RGF0ZSB8fAoJCQkJCWRhdGUgPiB0aGlzLm8uZW5kRGF0ZSB8fAoJCQkJCSFkYXRlCgkJCQkpOwoJCQl9LCB0aGlzKSwgdHJ1ZSk7CgkJCXRoaXMuZGF0ZXMucmVwbGFjZShkYXRlcyk7CgoJCQlpZiAodGhpcy5kYXRlcy5sZW5ndGgpCgkJCQl0aGlzLnZpZXdEYXRlID0gbmV3IERhdGUodGhpcy5kYXRlcy5nZXQoLTEpKTsKCQkJZWxzZSBpZiAodGhpcy52aWV3RGF0ZSA8IHRoaXMuby5zdGFydERhdGUpCgkJCQl0aGlzLnZpZXdEYXRlID0gbmV3IERhdGUodGhpcy5vLnN0YXJ0RGF0ZSk7CgkJCWVsc2UgaWYgKHRoaXMudmlld0RhdGUgPiB0aGlzLm8uZW5kRGF0ZSkKCQkJCXRoaXMudmlld0RhdGUgPSBuZXcgRGF0ZSh0aGlzLm8uZW5kRGF0ZSk7CgoJCQlpZiAoZnJvbUFyZ3MpewoJCQkJLy8gc2V0dGluZyBkYXRlIGJ5IGNsaWNraW5nCgkJCQl0aGlzLnNldFZhbHVlKCk7CgkJCX0KCQkJZWxzZSBpZiAoZGF0ZXMubGVuZ3RoKXsKCQkJCS8vIHNldHRpbmcgZGF0ZSBieSB0eXBpbmcKCQkJCWlmIChTdHJpbmcob2xkRGF0ZXMpICE9PSBTdHJpbmcodGhpcy5kYXRlcykpCgkJCQkJdGhpcy5fdHJpZ2dlcignY2hhbmdlRGF0ZScpOwoJCQl9CgkJCWlmICghdGhpcy5kYXRlcy5sZW5ndGggJiYgb2xkRGF0ZXMubGVuZ3RoKQoJCQkJdGhpcy5fdHJpZ2dlcignY2xlYXJEYXRlJyk7CgoJCQl0aGlzLmZpbGwoKTsKCQl9LAoKCQlmaWxsRG93OiBmdW5jdGlvbigpewoJCQl2YXIgZG93Q250ID0gdGhpcy5vLndlZWtTdGFydCwKCQkJCWh0bWwgPSAnPHRyPic7CgkJCWlmICh0aGlzLm8uY2FsZW5kYXJXZWVrcyl7CgkJCQl2YXIgY2VsbCA9ICc8dGggY2xhc3M9ImN3Ij4mbmJzcDs8L3RoPic7CgkJCQlodG1sICs9IGNlbGw7CgkJCQl0aGlzLnBpY2tlci5maW5kKCcuZGF0ZXBpY2tlci1kYXlzIHRoZWFkIHRyOmZpcnN0LWNoaWxkJykucHJlcGVuZChjZWxsKTsKCQkJfQoJCQl3aGlsZSAoZG93Q250IDwgdGhpcy5vLndlZWtTdGFydCArIDcpewoJCQkJaHRtbCArPSAnPHRoIGNsYXNzPSJkb3ciPicrZGF0ZXNbdGhpcy5vLmxhbmd1YWdlXS5kYXlzTWluWyhkb3dDbnQrKyklN10rJzwvdGg+JzsKCQkJfQoJCQlodG1sICs9ICc8L3RyPic7CgkJCXRoaXMucGlja2VyLmZpbmQoJy5kYXRlcGlja2VyLWRheXMgdGhlYWQnKS5hcHBlbmQoaHRtbCk7CgkJfSwKCgkJZmlsbE1vbnRoczogZnVuY3Rpb24oKXsKCQkJdmFyIGh0bWwgPSAnJywKCQkJaSA9IDA7CgkJCXdoaWxlIChpIDwgMTIpewoJCQkJaHRtbCArPSAnPHNwYW4gY2xhc3M9Im1vbnRoIj4nK2RhdGVzW3RoaXMuby5sYW5ndWFnZV0ubW9udGhzU2hvcnRbaSsrXSsnPC9zcGFuPic7CgkJCX0KCQkJdGhpcy5waWNrZXIuZmluZCgnLmRhdGVwaWNrZXItbW9udGhzIHRkJykuaHRtbChodG1sKTsKCQl9LAoKCQlzZXRSYW5nZTogZnVuY3Rpb24ocmFuZ2UpewoJCQlpZiAoIXJhbmdlIHx8ICFyYW5nZS5sZW5ndGgpCgkJCQlkZWxldGUgdGhpcy5yYW5nZTsKCQkJZWxzZQoJCQkJdGhpcy5yYW5nZSA9ICQubWFwKHJhbmdlLCBmdW5jdGlvbihkKXsKCQkJCQlyZXR1cm4gZC52YWx1ZU9mKCk7CgkJCQl9KTsKCQkJdGhpcy5maWxsKCk7CgkJfSwKCgkJZ2V0Q2xhc3NOYW1lczogZnVuY3Rpb24oZGF0ZSl7CgkJCXZhciBjbHMgPSBbXSwKCQkJCXllYXIgPSB0aGlzLnZpZXdEYXRlLmdldFVUQ0Z1bGxZZWFyKCksCgkJCQltb250aCA9IHRoaXMudmlld0RhdGUuZ2V0VVRDTW9udGgoKSwKCQkJCXRvZGF5ID0gbmV3IERhdGUoKTsKCQkJaWYgKGRhdGUuZ2V0VVRDRnVsbFllYXIoKSA8IHllYXIgfHwgKGRhdGUuZ2V0VVRDRnVsbFllYXIoKSA9PT0geWVhciAmJiBkYXRlLmdldFVUQ01vbnRoKCkgPCBtb250aCkpewoJCQkJY2xzLnB1c2goJ29sZCcpOwoJCQl9CgkJCWVsc2UgaWYgKGRhdGUuZ2V0VVRDRnVsbFllYXIoKSA+IHllYXIgfHwgKGRhdGUuZ2V0VVRDRnVsbFllYXIoKSA9PT0geWVhciAmJiBkYXRlLmdldFVUQ01vbnRoKCkgPiBtb250aCkpewoJCQkJY2xzLnB1c2goJ25ldycpOwoJCQl9CgkJCWlmICh0aGlzLmZvY3VzRGF0ZSAmJiBkYXRlLnZhbHVlT2YoKSA9PT0gdGhpcy5mb2N1c0RhdGUudmFsdWVPZigpKQoJCQkJY2xzLnB1c2goJ2ZvY3VzZWQnKTsKCQkJLy8gQ29tcGFyZSBpbnRlcm5hbCBVVEMgZGF0ZSB3aXRoIGxvY2FsIHRvZGF5LCBub3QgVVRDIHRvZGF5CgkJCWlmICh0aGlzLm8udG9kYXlIaWdobGlnaHQgJiYKCQkJCWRhdGUuZ2V0VVRDRnVsbFllYXIoKSA9PT0gdG9kYXkuZ2V0RnVsbFllYXIoKSAmJgoJCQkJZGF0ZS5nZXRVVENNb250aCgpID09PSB0b2RheS5nZXRNb250aCgpICYmCgkJCQlkYXRlLmdldFVUQ0RhdGUoKSA9PT0gdG9kYXkuZ2V0RGF0ZSgpKXsKCQkJCWNscy5wdXNoKCd0b2RheScpOwoJCQl9CgkJCWlmICh0aGlzLmRhdGVzLmNvbnRhaW5zKGRhdGUpICE9PSAtMSkKCQkJCWNscy5wdXNoKCdhY3RpdmUnKTsKCQkJaWYgKGRhdGUudmFsdWVPZigpIDwgdGhpcy5vLnN0YXJ0RGF0ZSB8fCBkYXRlLnZhbHVlT2YoKSA+IHRoaXMuby5lbmREYXRlIHx8CgkJCQkkLmluQXJyYXkoZGF0ZS5nZXRVVENEYXkoKSwgdGhpcy5vLmRheXNPZldlZWtEaXNhYmxlZCkgIT09IC0xKXsKCQkJCWNscy5wdXNoKCdkaXNhYmxlZCcpOwoJCQl9CgkJCWlmICh0aGlzLnJhbmdlKXsKCQkJCWlmIChkYXRlID4gdGhpcy5yYW5nZVswXSAmJiBkYXRlIDwgdGhpcy5yYW5nZVt0aGlzLnJhbmdlLmxlbmd0aC0xXSl7CgkJCQkJY2xzLnB1c2goJ3JhbmdlJyk7CgkJCQl9CgkJCQlpZiAoJC5pbkFycmF5KGRhdGUudmFsdWVPZigpLCB0aGlzLnJhbmdlKSAhPT0gLTEpewoJCQkJCWNscy5wdXNoKCdzZWxlY3RlZCcpOwoJCQkJfQoJCQl9CgkJCXJldHVybiBjbHM7CgkJfSwKCgkJZmlsbDogZnVuY3Rpb24oKXsKCQkJdmFyIGQgPSBuZXcgRGF0ZSh0aGlzLnZpZXdEYXRlKSwKCQkJCXllYXIgPSBkLmdldFVUQ0Z1bGxZZWFyKCksCgkJCQltb250aCA9IGQuZ2V0VVRDTW9udGgoKSwKCQkJCXN0YXJ0WWVhciA9IHRoaXMuby5zdGFydERhdGUgIT09IC1JbmZpbml0eSA\/IHRoaXMuby5zdGFydERhdGUuZ2V0VVRDRnVsbFllYXIoKSA6IC1JbmZpbml0eSwKCQkJCXN0YXJ0TW9udGggPSB0aGlzLm8uc3RhcnREYXRlICE9PSAtSW5maW5pdHkgPyB0aGlzLm8uc3RhcnREYXRlLmdldFVUQ01vbnRoKCkgOiAtSW5maW5pdHksCgkJCQllbmRZZWFyID0gdGhpcy5vLmVuZERhdGUgIT09IEluZmluaXR5ID8gdGhpcy5vLmVuZERhdGUuZ2V0VVRDRnVsbFllYXIoKSA6IEluZmluaXR5LAoJCQkJZW5kTW9udGggPSB0aGlzLm8uZW5kRGF0ZSAhPT0gSW5maW5pdHkgPyB0aGlzLm8uZW5kRGF0ZS5nZXRVVENNb250aCgpIDogSW5maW5pdHksCgkJCQl0b2RheXR4dCA9IGRhdGVzW3RoaXMuby5sYW5ndWFnZV0udG9kYXkgfHwgZGF0ZXNbJ2VuJ10udG9kYXkgfHwgJycsCgkJCQljbGVhcnR4dCA9IGRhdGVzW3RoaXMuby5sYW5ndWFnZV0uY2xlYXIgfHwgZGF0ZXNbJ2VuJ10uY2xlYXIgfHwgJycsCgkJCQl0b29sdGlwOwoJCQlpZiAoaXNOYU4oeWVhcikgfHwgaXNOYU4obW9udGgpKSByZXR1cm47CgkJCXRoaXMucGlja2VyLmZpbmQoJy5kYXRlcGlja2VyLWRheXMgdGhlYWQgdGguZGF0ZXBpY2tlci1zd2l0Y2gnKQoJCQkJCQkudGV4dChkYXRlc1t0aGlzLm8ubGFuZ3VhZ2VdLm1vbnRoc1ttb250aF0rJyAnK3llYXIpOwoJCQl0aGlzLnBpY2tlci5maW5kKCd0Zm9vdCB0aC50b2RheScpCgkJCQkJCS50ZXh0KHRvZGF5dHh0KQoJCQkJCQkudG9nZ2xlKHRoaXMuby50b2RheUJ0biAhPT0gZmFsc2UpOwoJCQl0aGlzLnBpY2tlci5maW5kKCd0Zm9vdCB0aC5jbGVhcicpCgkJCQkJCS50ZXh0KGNsZWFydHh0KQoJCQkJCQkudG9nZ2xlKHRoaXMuby5jbGVhckJ0biAhPT0gZmFsc2UpOwoJCQl0aGlzLnVwZGF0ZU5hdkFycm93cygpOwoJCQl0aGlzLmZpbGxNb250aHMoKTsKCQkJdmFyIHByZXZNb250aCA9IFVUQ0RhdGUoeWVhciwgbW9udGgtMSwgMjgpLAoJCQkJZGF5ID0gRFBHbG9iYWwuZ2V0RGF5c0luTW9udGgocHJldk1vbnRoLmdldFVUQ0Z1bGxZZWFyKCksIHByZXZNb250aC5nZXRVVENNb250aCgpKTsKCQkJcHJldk1vbnRoLnNldFVUQ0RhdGUoZGF5KTsKCQkJcHJldk1vbnRoLnNldFVUQ0RhdGUoZGF5IC0gKHByZXZNb250aC5nZXRVVENEYXkoKSAtIHRoaXMuby53ZWVrU3RhcnQgKyA3KSU3KTsKCQkJdmFyIG5leHRNb250aCA9IG5ldyBEYXRlKHByZXZNb250aCk7CgkJCW5leHRNb250aC5zZXRVVENEYXRlKG5leHRNb250aC5nZXRVVENEYXRlKCkgKyA0Mik7CgkJCW5leHRNb250aCA9IG5leHRNb250aC52YWx1ZU9mKCk7CgkJCXZhciBodG1sID0gW107CgkJCXZhciBjbHNOYW1lOwoJCQl3aGlsZSAocHJldk1vbnRoLnZhbHVlT2YoKSA8IG5leHRNb250aCl7CgkJCQlpZiAocHJldk1vbnRoLmdldFVUQ0RheSgpID09PSB0aGlzLm8ud2Vla1N0YXJ0KXsKCQkJCQlodG1sLnB1c2goJzx0cj4nKTsKCQkJCQlpZiAodGhpcy5vLmNhbGVuZGFyV2Vla3MpewoJCQkJCQkvLyBJU08gODYwMTogRmlyc3Qgd2VlayBjb250YWlucyBmaXJzdCB0aHVyc2RheS4KCQkJCQkJLy8gSVNPIGFsc28gc3RhdGVzIHdlZWsgc3RhcnRzIG9uIE1vbmRheSwgYnV0IHdlIGNhbiBiZSBtb3JlIGFic3RyYWN0IGhlcmUuCgkJCQkJCXZhcgoJCQkJCQkJLy8gU3RhcnQgb2YgY3VycmVudCB3ZWVrOiBiYXNlZCBvbiB3ZWVrc3RhcnQvY3VycmVudCBkYXRlCgkJCQkJCQl3cyA9IG5ldyBEYXRlKCtwcmV2TW9udGggKyAodGhpcy5vLndlZWtTdGFydCAtIHByZXZNb250aC5nZXRVVENEYXkoKSAtIDcpICUgNyAqIDg2NGU1KSwKCQkJCQkJCS8vIFRodXJzZGF5IG9mIHRoaXMgd2VlawoJCQkJCQkJdGggPSBuZXcgRGF0ZShOdW1iZXIod3MpICsgKDcgKyA0IC0gd3MuZ2V0VVRDRGF5KCkpICUgNyAqIDg2NGU1KSwKCQkJCQkJCS8vIEZpcnN0IFRodXJzZGF5IG9mIHllYXIsIHllYXIgZnJvbSB0aHVyc2RheQoJCQkJCQkJeXRoID0gbmV3IERhdGUoTnVtYmVyKHl0aCA9IFVUQ0RhdGUodGguZ2V0VVRDRnVsbFllYXIoKSwgMCwgMSkpICsgKDcgKyA0IC0geXRoLmdldFVUQ0RheSgpKSU3Kjg2NGU1KSwKCQkJCQkJCS8vIENhbGVuZGFyIHdlZWs6IG1zIGJldHdlZW4gdGh1cnNkYXlzLCBkaXYgbXMgcGVyIGRheSwgZGl2IDcgZGF5cwoJCQkJCQkJY2FsV2VlayA9ICAodGggLSB5dGgpIC8gODY0ZTUgLyA3ICsgMTsKCQkJCQkJaHRtbC5wdXNoKCc8dGQgY2xhc3M9ImN3Ij4nKyBjYWxXZWVrICsnPC90ZD4nKTsKCgkJCQkJfQoJCQkJfQoJCQkJY2xzTmFtZSA9IHRoaXMuZ2V0Q2xhc3NOYW1lcyhwcmV2TW9udGgpOwoJCQkJY2xzTmFtZS5wdXNoKCdkYXknKTsKCgkJCQlpZiAodGhpcy5vLmJlZm9yZVNob3dEYXkgIT09ICQubm9vcCl7CgkJCQkJdmFyIGJlZm9yZSA9IHRoaXMuby5iZWZvcmVTaG93RGF5KHRoaXMuX3V0Y190b19sb2NhbChwcmV2TW9udGgpKTsKCQkJCQlpZiAoYmVmb3JlID09PSB1bmRlZmluZWQpCgkJCQkJCWJlZm9yZSA9IHt9OwoJCQkJCWVsc2UgaWYgKHR5cGVvZihiZWZvcmUpID09PSAnYm9vbGVhbicpCgkJCQkJCWJlZm9yZSA9IHtlbmFibGVkOiBiZWZvcmV9OwoJCQkJCWVsc2UgaWYgKHR5cGVvZihiZWZvcmUpID09PSAnc3RyaW5nJykKCQkJCQkJYmVmb3JlID0ge2NsYXNzZXM6IGJlZm9yZX07CgkJCQkJaWYgKGJlZm9yZS5lbmFibGVkID09PSBmYWxzZSkKCQkJCQkJY2xzTmFtZS5wdXNoKCdkaXNhYmxlZCcpOwoJCQkJCWlmIChiZWZvcmUuY2xhc3NlcykKCQkJCQkJY2xzTmFtZSA9IGNsc05hbWUuY29uY2F0KGJlZm9yZS5jbGFzc2VzLnNwbGl0KC9ccysvKSk7CgkJCQkJaWYgKGJlZm9yZS50b29sdGlwKQoJCQkJCQl0b29sdGlwID0gYmVmb3JlLnRvb2x0aXA7CgkJCQl9CgoJCQkJY2xzTmFtZSA9ICQudW5pcXVlKGNsc05hbWUpOwoJCQkJaHRtbC5wdXNoKCc8dGQgY2xhc3M9IicrY2xzTmFtZS5qb2luKCcgJykrJyInICsgKHRvb2x0aXAgPyAnIHRpdGxlPSInK3Rvb2x0aXArJyInIDogJycpICsgJz4nK3ByZXZNb250aC5nZXRVVENEYXRlKCkgKyAnPC90ZD4nKTsKCQkJCXRvb2x0aXAgPSBudWxsOwoJCQkJaWYgKHByZXZNb250aC5nZXRVVENEYXkoKSA9PT0gdGhpcy5vLndlZWtFbmQpewoJCQkJCWh0bWwucHVzaCgnPC90cj4nKTsKCQkJCX0KCQkJCXByZXZNb250aC5zZXRVVENEYXRlKHByZXZNb250aC5nZXRVVENEYXRlKCkrMSk7CgkJCX0KCQkJdGhpcy5waWNrZXIuZmluZCgnLmRhdGVwaWNrZXItZGF5cyB0Ym9keScpLmVtcHR5KCkuYXBwZW5kKGh0bWwuam9pbignJykpOwoKCQkJdmFyIG1vbnRocyA9IHRoaXMucGlja2VyLmZpbmQoJy5kYXRlcGlja2VyLW1vbnRocycpCgkJCQkJCS5maW5kKCd0aDplcSgxKScpCgkJCQkJCQkudGV4dCh5ZWFyKQoJCQkJCQkJLmVuZCgpCgkJCQkJCS5maW5kKCdzcGFuJykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpOwoKCQkJJC5lYWNoKHRoaXMuZGF0ZXMsIGZ1bmN0aW9uKGksIGQpewoJCQkJaWYgKGQuZ2V0VVRDRnVsbFllYXIoKSA9PT0geWVhcikKCQkJCQltb250aHMuZXEoZC5nZXRVVENNb250aCgpKS5hZGRDbGFzcygnYWN0aXZlJyk7CgkJCX0pOwoKCQkJaWYgKHllYXIgPCBzdGFydFllYXIgfHwgeWVhciA+IGVuZFllYXIpewoJCQkJbW9udGhzLmFkZENsYXNzKCdkaXNhYmxlZCcpOwoJCQl9CgkJCWlmICh5ZWFyID09PSBzdGFydFllYXIpewoJCQkJbW9udGhzLnNsaWNlKDAsIHN0YXJ0TW9udGgpLmFkZENsYXNzKCdkaXNhYmxlZCcpOwoJCQl9CgkJCWlmICh5ZWFyID09PSBlbmRZZWFyKXsKCQkJCW1vbnRocy5zbGljZShlbmRNb250aCsxKS5hZGRDbGFzcygnZGlzYWJsZWQnKTsKCQkJfQoKCQkJaHRtbCA9ICcnOwoJCQl5ZWFyID0gcGFyc2VJbnQoeWVhci8xMCwgMTApICogMTA7CgkJCXZhciB5ZWFyQ29udCA9IHRoaXMucGlja2VyLmZpbmQoJy5kYXRlcGlja2VyLXllYXJzJykKCQkJCQkJCQkuZmluZCgndGg6ZXEoMSknKQoJCQkJCQkJCQkudGV4dCh5ZWFyICsgJy0nICsgKHllYXIgKyA5KSkKCQkJCQkJCQkJLmVuZCgpCgkJCQkJCQkJLmZpbmQoJ3RkJyk7CgkJCXllYXIgLT0gMTsKCQkJdmFyIHllYXJzID0gJC5tYXAodGhpcy5kYXRlcywgZnVuY3Rpb24oZCl7CgkJCQkJcmV0dXJuIGQuZ2V0VVRDRnVsbFllYXIoKTsKCQkJCX0pLAoJCQkJY2xhc3NlczsKCQkJZm9yICh2YXIgaSA9IC0xOyBpIDwgMTE7IGkrKyl7CgkJCQljbGFzc2VzID0gWyd5ZWFyJ107CgkJCQlpZiAoaSA9PT0gLTEpCgkJCQkJY2xhc3Nlcy5wdXNoKCdvbGQnKTsKCQkJCWVsc2UgaWYgKGkgPT09IDEwKQoJCQkJCWNsYXNzZXMucHVzaCgnbmV3Jyk7CgkJCQlpZiAoJC5pbkFycmF5KHllYXIsIHllYXJzKSAhPT0gLTEpCgkJCQkJY2xhc3Nlcy5wdXNoKCdhY3RpdmUnKTsKCQkJCWlmICh5ZWFyIDwgc3RhcnRZZWFyIHx8IHllYXIgPiBlbmRZZWFyKQoJCQkJCWNsYXNzZXMucHVzaCgnZGlzYWJsZWQnKTsKCQkJCWh0bWwgKz0gJzxzcGFuIGNsYXNzPSInICsgY2xhc3Nlcy5qb2luKCcgJykgKyAnIj4nK3llYXIrJzwvc3Bhbj4nOwoJCQkJeWVhciArPSAxOwoJCQl9CgkJCXllYXJDb250Lmh0bWwoaHRtbCk7CgkJfSwKCgkJdXBkYXRlTmF2QXJyb3dzOiBmdW5jdGlvbigpewoJCQlpZiAoIXRoaXMuX2FsbG93X3VwZGF0ZSkKCQkJCXJldHVybjsKCgkJCXZhciBkID0gbmV3IERhdGUodGhpcy52aWV3RGF0ZSksCgkJCQl5ZWFyID0gZC5nZXRVVENGdWxsWWVhcigpLAoJCQkJbW9udGggPSBkLmdldFVUQ01vbnRoKCk7CgkJCXN3aXRjaCAodGhpcy52aWV3TW9kZSl7CgkJCQljYXNlIDA6CgkJCQkJaWYgKHRoaXMuby5zdGFydERhdGUgIT09IC1JbmZpbml0eSAmJiB5ZWFyIDw9IHRoaXMuby5zdGFydERhdGUuZ2V0VVRDRnVsbFllYXIoKSAmJiBtb250aCA8PSB0aGlzLm8uc3RhcnREYXRlLmdldFVUQ01vbnRoKCkpewoJCQkJCQl0aGlzLnBpY2tlci5maW5kKCcucHJldicpLmNzcyh7dmlzaWJpbGl0eTogJ2hpZGRlbid9KTsKCQkJCQl9CgkJCQkJZWxzZSB7CgkJCQkJCXRoaXMucGlja2VyLmZpbmQoJy5wcmV2JykuY3NzKHt2aXNpYmlsaXR5OiAndmlzaWJsZSd9KTsKCQkJCQl9CgkJCQkJaWYgKHRoaXMuby5lbmREYXRlICE9PSBJbmZpbml0eSAmJiB5ZWFyID49IHRoaXMuby5lbmREYXRlLmdldFVUQ0Z1bGxZZWFyKCkgJiYgbW9udGggPj0gdGhpcy5vLmVuZERhdGUuZ2V0VVRDTW9udGgoKSl7CgkJCQkJCXRoaXMucGlja2VyLmZpbmQoJy5uZXh0JykuY3NzKHt2aXNpYmlsaXR5OiAnaGlkZGVuJ30pOwoJCQkJCX0KCQkJCQllbHNlIHsKCQkJCQkJdGhpcy5waWNrZXIuZmluZCgnLm5leHQnKS5jc3Moe3Zpc2liaWxpdHk6ICd2aXNpYmxlJ30pOwoJCQkJCX0KCQkJCQlicmVhazsKCQkJCWNhc2UgMToKCQkJCWNhc2UgMjoKCQkJCQlpZiAodGhpcy5vLnN0YXJ0RGF0ZSAhPT0gLUluZmluaXR5ICYmIHllYXIgPD0gdGhpcy5vLnN0YXJ0RGF0ZS5nZXRVVENGdWxsWWVhcigpKXsKCQkJCQkJdGhpcy5waWNrZXIuZmluZCgnLnByZXYnKS5jc3Moe3Zpc2liaWxpdHk6ICdoaWRkZW4nfSk7CgkJCQkJfQoJCQkJCWVsc2UgewoJCQkJCQl0aGlzLnBpY2tlci5maW5kKCcucHJldicpLmNzcyh7dmlzaWJpbGl0eTogJ3Zpc2libGUnfSk7CgkJCQkJfQoJCQkJCWlmICh0aGlzLm8uZW5kRGF0ZSAhPT0gSW5maW5pdHkgJiYgeWVhciA+PSB0aGlzLm8uZW5kRGF0ZS5nZXRVVENGdWxsWWVhcigpKXsKCQkJCQkJdGhpcy5waWNrZXIuZmluZCgnLm5leHQnKS5jc3Moe3Zpc2liaWxpdHk6ICdoaWRkZW4nfSk7CgkJCQkJfQoJCQkJCWVsc2UgewoJCQkJCQl0aGlzLnBpY2tlci5maW5kKCcubmV4dCcpLmNzcyh7dmlzaWJpbGl0eTogJ3Zpc2libGUnfSk7CgkJCQkJfQoJCQkJCWJyZWFrOwoJCQl9CgkJfSwKCgkJY2xpY2s6IGZ1bmN0aW9uKGUpewoJCQllLnByZXZlbnREZWZhdWx0KCk7CgkJCXZhciB0YXJnZXQgPSAkKGUudGFyZ2V0KS5jbG9zZXN0KCdzcGFuLCB0ZCwgdGgnKSwKCQkJCXllYXIsIG1vbnRoLCBkYXk7CgkJCWlmICh0YXJnZXQubGVuZ3RoID09PSAxKXsKCQkJCXN3aXRjaCAodGFyZ2V0WzBdLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpewoJCQkJCWNhc2UgJ3RoJzoKCQkJCQkJc3dpdGNoICh0YXJnZXRbMF0uY2xhc3NOYW1lKXsKCQkJCQkJCWNhc2UgJ2RhdGVwaWNrZXItc3dpdGNoJzoKCQkJCQkJCQl0aGlzLnNob3dNb2RlKDEpOwoJCQkJCQkJCWJyZWFrOwoJCQkJCQkJY2FzZSAncHJldic6CgkJCQkJCQljYXNlICduZXh0JzoKCQkJCQkJCQl2YXIgZGlyID0gRFBHbG9iYWwubW9kZXNbdGhpcy52aWV3TW9kZV0ubmF2U3RlcCAqICh0YXJnZXRbMF0uY2xhc3NOYW1lID09PSAncHJldicgPyAtMSA6IDEpOwoJCQkJCQkJCXN3aXRjaCAodGhpcy52aWV3TW9kZSl7CgkJCQkJCQkJCWNhc2UgMDoKCQkJCQkJCQkJCXRoaXMudmlld0RhdGUgPSB0aGlzLm1vdmVNb250aCh0aGlzLnZpZXdEYXRlLCBkaXIpOwoJCQkJCQkJCQkJdGhpcy5fdHJpZ2dlcignY2hhbmdlTW9udGgnLCB0aGlzLnZpZXdEYXRlKTsKCQkJCQkJCQkJCWJyZWFrOwoJCQkJCQkJCQljYXNlIDE6CgkJCQkJCQkJCWNhc2UgMjoKCQkJCQkJCQkJCXRoaXMudmlld0RhdGUgPSB0aGlzLm1vdmVZZWFyKHRoaXMudmlld0RhdGUsIGRpcik7CgkJCQkJCQkJCQlpZiAodGhpcy52aWV3TW9kZSA9PT0gMSkKCQkJCQkJCQkJCQl0aGlzLl90cmlnZ2VyKCdjaGFuZ2VZZWFyJywgdGhpcy52aWV3RGF0ZSk7CgkJCQkJCQkJCQlicmVhazsKCQkJCQkJCQl9CgkJCQkJCQkJdGhpcy5maWxsKCk7CgkJCQkJCQkJYnJlYWs7CgkJCQkJCQljYXNlICd0b2RheSc6CgkJCQkJCQkJdmFyIGRhdGUgPSBuZXcgRGF0ZSgpOwoJCQkJCQkJCWRhdGUgPSBVVENEYXRlKGRhdGUuZ2V0RnVsbFllYXIoKSwgZGF0ZS5nZXRNb250aCgpLCBkYXRlLmdldERhdGUoKSwgMCwgMCwgMCk7CgoJCQkJCQkJCXRoaXMuc2hvd01vZGUoLTIpOwoJCQkJCQkJCXZhciB3aGljaCA9IHRoaXMuby50b2RheUJ0biA9PT0gJ2xpbmtlZCcgPyBudWxsIDogJ3ZpZXcnOwoJCQkJCQkJCXRoaXMuX3NldERhdGUoZGF0ZSwgd2hpY2gpOwoJCQkJCQkJCWJyZWFrOwoJCQkJCQkJY2FzZSAnY2xlYXInOgoJCQkJCQkJCXZhciBlbGVtZW50OwoJCQkJCQkJCWlmICh0aGlzLmlzSW5wdXQpCgkJCQkJCQkJCWVsZW1lbnQgPSB0aGlzLmVsZW1lbnQ7CgkJCQkJCQkJZWxzZSBpZiAodGhpcy5jb21wb25lbnQpCgkJCQkJCQkJCWVsZW1lbnQgPSB0aGlzLmVsZW1lbnQuZmluZCgnaW5wdXQnKTsKCQkJCQkJCQlpZiAoZWxlbWVudCkKCQkJCQkJCQkJZWxlbWVudC52YWwoIiIpLmNoYW5nZSgpOwoJCQkJCQkJCXRoaXMudXBkYXRlKCk7CgkJCQkJCQkJdGhpcy5fdHJpZ2dlcignY2hhbmdlRGF0ZScpOwoJCQkJCQkJCWlmICh0aGlzLm8uYXV0b2Nsb3NlKQoJCQkJCQkJCQl0aGlzLmhpZGUoKTsKCQkJCQkJCQlicmVhazsKCQkJCQkJfQoJCQkJCQlicmVhazsKCQkJCQljYXNlICdzcGFuJzoKCQkJCQkJaWYgKCF0YXJnZXQuaXMoJy5kaXNhYmxlZCcpKXsKCQkJCQkJCXRoaXMudmlld0RhdGUuc2V0VVRDRGF0ZSgxKTsKCQkJCQkJCWlmICh0YXJnZXQuaXMoJy5tb250aCcpKXsKCQkJCQkJCQlkYXkgPSAxOwoJCQkJCQkJCW1vbnRoID0gdGFyZ2V0LnBhcmVudCgpLmZpbmQoJ3NwYW4nKS5pbmRleCh0YXJnZXQpOwoJCQkJCQkJCXllYXIgPSB0aGlzLnZpZXdEYXRlLmdldFVUQ0Z1bGxZZWFyKCk7CgkJCQkJCQkJdGhpcy52aWV3RGF0ZS5zZXRVVENNb250aChtb250aCk7CgkJCQkJCQkJdGhpcy5fdHJpZ2dlcignY2hhbmdlTW9udGgnLCB0aGlzLnZpZXdEYXRlKTsKCQkJCQkJCQlpZiAodGhpcy5vLm1pblZpZXdNb2RlID09PSAxKXsKCQkJCQkJCQkJdGhpcy5fc2V0RGF0ZShVVENEYXRlKHllYXIsIG1vbnRoLCBkYXkpKTsKCQkJCQkJCQl9CgkJCQkJCQl9CgkJCQkJCQllbHNlIHsKCQkJCQkJCQlkYXkgPSAxOwoJCQkJCQkJCW1vbnRoID0gMDsKCQkJCQkJCQl5ZWFyID0gcGFyc2VJbnQodGFyZ2V0LnRleHQoKSwgMTApfHwwOwoJCQkJCQkJCXRoaXMudmlld0RhdGUuc2V0VVRDRnVsbFllYXIoeWVhcik7CgkJCQkJCQkJdGhpcy5fdHJpZ2dlcignY2hhbmdlWWVhcicsIHRoaXMudmlld0RhdGUpOwoJCQkJCQkJCWlmICh0aGlzLm8ubWluVmlld01vZGUgPT09IDIpewoJCQkJCQkJCQl0aGlzLl9zZXREYXRlKFVUQ0RhdGUoeWVhciwgbW9udGgsIGRheSkpOwoJCQkJCQkJCX0KCQkJCQkJCX0KCQkJCQkJCXRoaXMuc2hvd01vZGUoLTEpOwoJCQkJCQkJdGhpcy5maWxsKCk7CgkJCQkJCX0KCQkJCQkJYnJlYWs7CgkJCQkJY2FzZSAndGQnOgoJCQkJCQlpZiAodGFyZ2V0LmlzKCcuZGF5JykgJiYgIXRhcmdldC5pcygnLmRpc2FibGVkJykpewoJCQkJCQkJZGF5ID0gcGFyc2VJbnQodGFyZ2V0LnRleHQoKSwgMTApfHwxOwoJCQkJCQkJeWVhciA9IHRoaXMudmlld0RhdGUuZ2V0VVRDRnVsbFllYXIoKTsKCQkJCQkJCW1vbnRoID0gdGhpcy52aWV3RGF0ZS5nZXRVVENNb250aCgpOwoJCQkJCQkJaWYgKHRhcmdldC5pcygnLm9sZCcpKXsKCQkJCQkJCQlpZiAobW9udGggPT09IDApewoJCQkJCQkJCQltb250aCA9IDExOwoJCQkJCQkJCQl5ZWFyIC09IDE7CgkJCQkJCQkJfQoJCQkJCQkJCWVsc2UgewoJCQkJCQkJCQltb250aCAtPSAxOwoJCQkJCQkJCX0KCQkJCQkJCX0KCQkJCQkJCWVsc2UgaWYgKHRhcmdldC5pcygnLm5ldycpKXsKCQkJCQkJCQlpZiAobW9udGggPT09IDExKXsKCQkJCQkJCQkJbW9udGggPSAwOwoJCQkJCQkJCQl5ZWFyICs9IDE7CgkJCQkJCQkJfQoJCQkJCQkJCWVsc2UgewoJCQkJCQkJCQltb250aCArPSAxOwoJCQkJCQkJCX0KCQkJCQkJCX0KCQkJCQkJCXRoaXMuX3NldERhdGUoVVRDRGF0ZSh5ZWFyLCBtb250aCwgZGF5KSk7CgkJCQkJCX0KCQkJCQkJYnJlYWs7CgkJCQl9CgkJCX0KCQkJaWYgKHRoaXMucGlja2VyLmlzKCc6dmlzaWJsZScpICYmIHRoaXMuX2ZvY3VzZWRfZnJvbSl7CgkJCQkkKHRoaXMuX2ZvY3VzZWRfZnJvbSkuZm9jdXMoKTsKCQkJfQoJCQlkZWxldGUgdGhpcy5fZm9jdXNlZF9mcm9tOwoJCX0sCgoJCV90b2dnbGVfbXVsdGlkYXRlOiBmdW5jdGlvbihkYXRlKXsKCQkJdmFyIGl4ID0gdGhpcy5kYXRlcy5jb250YWlucyhkYXRlKTsKCQkJaWYgKCFkYXRlKXsKCQkJCXRoaXMuZGF0ZXMuY2xlYXIoKTsKCQkJfQoJCQlpZiAodGhpcy5vLm11bHRpZGF0ZSA9PT0gMSAmJiBpeCA9PT0gMCl7CiAgICAgICAgICAgICAgICAvLyBzaW5nbGUgZGF0ZXBpY2tlciwgZG9uJ3QgcmVtb3ZlIHNlbGVjdGVkIGRhdGUKICAgICAgICAgICAgfQoJCQllbHNlIGlmIChpeCAhPT0gLTEpewoJCQkJdGhpcy5kYXRlcy5yZW1vdmUoaXgpOwoJCQl9CgkJCWVsc2UgewoJCQkJdGhpcy5kYXRlcy5wdXNoKGRhdGUpOwoJCQl9CgkJCWlmICh0eXBlb2YgdGhpcy5vLm11bHRpZGF0ZSA9PT0gJ251bWJlcicpCgkJCQl3aGlsZSAodGhpcy5kYXRlcy5sZW5ndGggPiB0aGlzLm8ubXVsdGlkYXRlKQoJCQkJCXRoaXMuZGF0ZXMucmVtb3ZlKDApOwoJCX0sCgoJCV9zZXREYXRlOiBmdW5jdGlvbihkYXRlLCB3aGljaCl7CgkJCWlmICghd2hpY2ggfHwgd2hpY2ggPT09ICdkYXRlJykKCQkJCXRoaXMuX3RvZ2dsZV9tdWx0aWRhdGUoZGF0ZSAmJiBuZXcgRGF0ZShkYXRlKSk7CgkJCWlmICghd2hpY2ggfHwgd2hpY2ggID09PSAndmlldycpCgkJCQl0aGlzLnZpZXdEYXRlID0gZGF0ZSAmJiBuZXcgRGF0ZShkYXRlKTsKCgkJCXRoaXMuZmlsbCgpOwoJCQl0aGlzLnNldFZhbHVlKCk7CgkJCXRoaXMuX3RyaWdnZXIoJ2NoYW5nZURhdGUnKTsKCQkJdmFyIGVsZW1lbnQ7CgkJCWlmICh0aGlzLmlzSW5wdXQpewoJCQkJZWxlbWVudCA9IHRoaXMuZWxlbWVudDsKCQkJfQoJCQllbHNlIGlmICh0aGlzLmNvbXBvbmVudCl7CgkJCQllbGVtZW50ID0gdGhpcy5lbGVtZW50LmZpbmQoJ2lucHV0Jyk7CgkJCX0KCQkJaWYgKGVsZW1lbnQpewoJCQkJZWxlbWVudC5jaGFuZ2UoKTsKCQkJfQoJCQlpZiAodGhpcy5vLmF1dG9jbG9zZSAmJiAoIXdoaWNoIHx8IHdoaWNoID09PSAnZGF0ZScpKXsKCQkJCXRoaXMuaGlkZSgpOwoJCQl9CgkJfSwKCgkJbW92ZU1vbnRoOiBmdW5jdGlvbihkYXRlLCBkaXIpewoJCQlpZiAoIWRhdGUpCgkJCQlyZXR1cm4gdW5kZWZpbmVkOwoJCQlpZiAoIWRpcikKCQkJCXJldHVybiBkYXRlOwoJCQl2YXIgbmV3X2RhdGUgPSBuZXcgRGF0ZShkYXRlLnZhbHVlT2YoKSksCgkJCQlkYXkgPSBuZXdfZGF0ZS5nZXRVVENEYXRlKCksCgkJCQltb250aCA9IG5ld19kYXRlLmdldFVUQ01vbnRoKCksCgkJCQltYWcgPSBNYXRoLmFicyhkaXIpLAoJCQkJbmV3X21vbnRoLCB0ZXN0OwoJCQlkaXIgPSBkaXIgPiAwID8gMSA6IC0xOwoJCQlpZiAobWFnID09PSAxKXsKCQkJCXRlc3QgPSBkaXIgPT09IC0xCgkJCQkJLy8gSWYgZ29pbmcgYmFjayBvbmUgbW9udGgsIG1ha2Ugc3VyZSBtb250aCBpcyBub3QgY3VycmVudCBtb250aAoJCQkJCS8vIChlZywgTWFyIDMxIC0+IEZlYiAzMSA9PSBGZWIgMjgsIG5vdCBNYXIgMDIpCgkJCQkJPyBmdW5jdGlvbigpewoJCQkJCQlyZXR1cm4gbmV3X2RhdGUuZ2V0VVRDTW9udGgoKSA9PT0gbW9udGg7CgkJCQkJfQoJCQkJCS8vIElmIGdvaW5nIGZvcndhcmQgb25lIG1vbnRoLCBtYWtlIHN1cmUgbW9udGggaXMgYXMgZXhwZWN0ZWQKCQkJCQkvLyAoZWcsIEphbiAzMSAtPiBGZWIgMzEgPT0gRmViIDI4LCBub3QgTWFyIDAyKQoJCQkJCTogZnVuY3Rpb24oKXsKCQkJCQkJcmV0dXJuIG5ld19kYXRlLmdldFVUQ01vbnRoKCkgIT09IG5ld19tb250aDsKCQkJCQl9OwoJCQkJbmV3X21vbnRoID0gbW9udGggKyBkaXI7CgkJCQluZXdfZGF0ZS5zZXRVVENNb250aChuZXdfbW9udGgpOwoJCQkJLy8gRGVjIC0+IEphbiAoMTIpIG9yIEphbiAtPiBEZWMgKC0xKSAtLSBsaW1pdCBleHBlY3RlZCBkYXRlIHRvIDAtMTEKCQkJCWlmIChuZXdfbW9udGggPCAwIHx8IG5ld19tb250aCA+IDExKQoJCQkJCW5ld19tb250aCA9IChuZXdfbW9udGggKyAxMikgJSAxMjsKCQkJfQoJCQllbHNlIHsKCQkJCS8vIEZvciBtYWduaXR1ZGVzID4xLCBtb3ZlIG9uZSBtb250aCBhdCBhIHRpbWUuLi4KCQkJCWZvciAodmFyIGk9MDsgaSA8IG1hZzsgaSsrKQoJCQkJCS8vIC4uLndoaWNoIG1pZ2h0IGRlY3JlYXNlIHRoZSBkYXkgKGVnLCBKYW4gMzEgdG8gRmViIDI4LCBldGMpLi4uCgkJCQkJbmV3X2RhdGUgPSB0aGlzLm1vdmVNb250aChuZXdfZGF0ZSwgZGlyKTsKCQkJCS8vIC4uLnRoZW4gcmVzZXQgdGhlIGRheSwga2VlcGluZyBpdCBpbiB0aGUgbmV3IG1vbnRoCgkJCQluZXdfbW9udGggPSBuZXdfZGF0ZS5nZXRVVENNb250aCgpOwoJCQkJbmV3X2RhdGUuc2V0VVRDRGF0ZShkYXkpOwoJCQkJdGVzdCA9IGZ1bmN0aW9uKCl7CgkJCQkJcmV0dXJuIG5ld19tb250aCAhPT0gbmV3X2RhdGUuZ2V0VVRDTW9udGgoKTsKCQkJCX07CgkJCX0KCQkJLy8gQ29tbW9uIGRhdGUtcmVzZXR0aW5nIGxvb3AgLS0gaWYgZGF0ZSBpcyBiZXlvbmQgZW5kIG9mIG1vbnRoLCBtYWtlIGl0CgkJCS8vIGVuZCBvZiBtb250aAoJCQl3aGlsZSAodGVzdCgpKXsKCQkJCW5ld19kYXRlLnNldFVUQ0RhdGUoLS1kYXkpOwoJCQkJbmV3X2RhdGUuc2V0VVRDTW9udGgobmV3X21vbnRoKTsKCQkJfQoJCQlyZXR1cm4gbmV3X2RhdGU7CgkJfSwKCgkJbW92ZVllYXI6IGZ1bmN0aW9uKGRhdGUsIGRpcil7CgkJCXJldHVybiB0aGlzLm1vdmVNb250aChkYXRlLCBkaXIqMTIpOwoJCX0sCgoJCWRhdGVXaXRoaW5SYW5nZTogZnVuY3Rpb24oZGF0ZSl7CgkJCXJldHVybiBkYXRlID49IHRoaXMuby5zdGFydERhdGUgJiYgZGF0ZSA8PSB0aGlzLm8uZW5kRGF0ZTsKCQl9LAoKCQlrZXlkb3duOiBmdW5jdGlvbihlKXsKCQkJaWYgKHRoaXMucGlja2VyLmlzKCc6bm90KDp2aXNpYmxlKScpKXsKCQkJCWlmIChlLmtleUNvZGUgPT09IDI3KSAvLyBhbGxvdyBlc2NhcGUgdG8gaGlkZSBhbmQgcmUtc2hvdyBwaWNrZXIKCQkJCQl0aGlzLnNob3coKTsKCQkJCXJldHVybjsKCQkJfQoJCQl2YXIgZGF0ZUNoYW5nZWQgPSBmYWxzZSwKCQkJCWRpciwgbmV3RGF0ZSwgbmV3Vmlld0RhdGUsCgkJCQlmb2N1c0RhdGUgPSB0aGlzLmZvY3VzRGF0ZSB8fCB0aGlzLnZpZXdEYXRlOwoJCQlzd2l0Y2ggKGUua2V5Q29kZSl7CgkJCQljYXNlIDI3OiAvLyBlc2NhcGUKCQkJCQlpZiAodGhpcy5mb2N1c0RhdGUpewoJCQkJCQl0aGlzLmZvY3VzRGF0ZSA9IG51bGw7CgkJCQkJCXRoaXMudmlld0RhdGUgPSB0aGlzLmRhdGVzLmdldCgtMSkgfHwgdGhpcy52aWV3RGF0ZTsKCQkJCQkJdGhpcy5maWxsKCk7CgkJCQkJfQoJCQkJCWVsc2UKCQkJCQkJdGhpcy5oaWRlKCk7CgkJCQkJZS5wcmV2ZW50RGVmYXVsdCgpOwoJCQkJCWJyZWFrOwoJCQkJY2FzZSAzNzogLy8gbGVmdAoJCQkJY2FzZSAzOTogLy8gcmlnaHQKCQkJCQlpZiAoIXRoaXMuby5rZXlib2FyZE5hdmlnYXRpb24pCgkJCQkJCWJyZWFrOwoJCQkJCWRpciA9IGUua2V5Q29kZSA9PT0gMzcgPyAtMSA6IDE7CgkJCQkJaWYgKGUuY3RybEtleSl7CgkJCQkJCW5ld0RhdGUgPSB0aGlzLm1vdmVZZWFyKHRoaXMuZGF0ZXMuZ2V0KC0xKSB8fCBVVENUb2RheSgpLCBkaXIpOwoJCQkJCQluZXdWaWV3RGF0ZSA9IHRoaXMubW92ZVllYXIoZm9jdXNEYXRlLCBkaXIpOwoJCQkJCQl0aGlzLl90cmlnZ2VyKCdjaGFuZ2VZZWFyJywgdGhpcy52aWV3RGF0ZSk7CgkJCQkJfQoJCQkJCWVsc2UgaWYgKGUuc2hpZnRLZXkpewoJCQkJCQluZXdEYXRlID0gdGhpcy5tb3ZlTW9udGgodGhpcy5kYXRlcy5nZXQoLTEpIHx8IFVUQ1RvZGF5KCksIGRpcik7CgkJCQkJCW5ld1ZpZXdEYXRlID0gdGhpcy5tb3ZlTW9udGgoZm9jdXNEYXRlLCBkaXIpOwoJCQkJCQl0aGlzLl90cmlnZ2VyKCdjaGFuZ2VNb250aCcsIHRoaXMudmlld0RhdGUpOwoJCQkJCX0KCQkJCQllbHNlIHsKCQkJCQkJbmV3RGF0ZSA9IG5ldyBEYXRlKHRoaXMuZGF0ZXMuZ2V0KC0xKSB8fCBVVENUb2RheSgpKTsKCQkJCQkJbmV3RGF0ZS5zZXRVVENEYXRlKG5ld0RhdGUuZ2V0VVRDRGF0ZSgpICsgZGlyKTsKCQkJCQkJbmV3Vmlld0RhdGUgPSBuZXcgRGF0ZShmb2N1c0RhdGUpOwoJCQkJCQluZXdWaWV3RGF0ZS5zZXRVVENEYXRlKGZvY3VzRGF0ZS5nZXRVVENEYXRlKCkgKyBkaXIpOwoJCQkJCX0KCQkJCQlpZiAodGhpcy5kYXRlV2l0aGluUmFuZ2UobmV3RGF0ZSkpewoJCQkJCQl0aGlzLmZvY3VzRGF0ZSA9IHRoaXMudmlld0RhdGUgPSBuZXdWaWV3RGF0ZTsKCQkJCQkJdGhpcy5zZXRWYWx1ZSgpOwoJCQkJCQl0aGlzLmZpbGwoKTsKCQkJCQkJZS5wcmV2ZW50RGVmYXVsdCgpOwoJCQkJCX0KCQkJCQlicmVhazsKCQkJCWNhc2UgMzg6IC8vIHVwCgkJCQljYXNlIDQwOiAvLyBkb3duCgkJCQkJaWYgKCF0aGlzLm8ua2V5Ym9hcmROYXZpZ2F0aW9uKQoJCQkJCQlicmVhazsKCQkJCQlkaXIgPSBlLmtleUNvZGUgPT09IDM4ID8gLTEgOiAxOwoJCQkJCWlmIChlLmN0cmxLZXkpewoJCQkJCQluZXdEYXRlID0gdGhpcy5tb3ZlWWVhcih0aGlzLmRhdGVzLmdldCgtMSkgfHwgVVRDVG9kYXkoKSwgZGlyKTsKCQkJCQkJbmV3Vmlld0RhdGUgPSB0aGlzLm1vdmVZZWFyKGZvY3VzRGF0ZSwgZGlyKTsKCQkJCQkJdGhpcy5fdHJpZ2dlcignY2hhbmdlWWVhcicsIHRoaXMudmlld0RhdGUpOwoJCQkJCX0KCQkJCQllbHNlIGlmIChlLnNoaWZ0S2V5KXsKCQkJCQkJbmV3RGF0ZSA9IHRoaXMubW92ZU1vbnRoKHRoaXMuZGF0ZXMuZ2V0KC0xKSB8fCBVVENUb2RheSgpLCBkaXIpOwoJCQkJCQluZXdWaWV3RGF0ZSA9IHRoaXMubW92ZU1vbnRoKGZvY3VzRGF0ZSwgZGlyKTsKCQkJCQkJdGhpcy5fdHJpZ2dlcignY2hhbmdlTW9udGgnLCB0aGlzLnZpZXdEYXRlKTsKCQkJCQl9CgkJCQkJZWxzZSB7CgkJCQkJCW5ld0RhdGUgPSBuZXcgRGF0ZSh0aGlzLmRhdGVzLmdldCgtMSkgfHwgVVRDVG9kYXkoKSk7CgkJCQkJCW5ld0RhdGUuc2V0VVRDRGF0ZShuZXdEYXRlLmdldFVUQ0RhdGUoKSArIGRpciAqIDcpOwoJCQkJCQluZXdWaWV3RGF0ZSA9IG5ldyBEYXRlKGZvY3VzRGF0ZSk7CgkJCQkJCW5ld1ZpZXdEYXRlLnNldFVUQ0RhdGUoZm9jdXNEYXRlLmdldFVUQ0RhdGUoKSArIGRpciAqIDcpOwoJCQkJCX0KCQkJCQlpZiAodGhpcy5kYXRlV2l0aGluUmFuZ2UobmV3RGF0ZSkpewoJCQkJCQl0aGlzLmZvY3VzRGF0ZSA9IHRoaXMudmlld0RhdGUgPSBuZXdWaWV3RGF0ZTsKCQkJCQkJdGhpcy5zZXRWYWx1ZSgpOwoJCQkJCQl0aGlzLmZpbGwoKTsKCQkJCQkJZS5wcmV2ZW50RGVmYXVsdCgpOwoJCQkJCX0KCQkJCQlicmVhazsKCQkJCWNhc2UgMzI6IC8vIHNwYWNlYmFyCgkJCQkJLy8gU3BhY2ViYXIgaXMgdXNlZCBpbiBtYW51YWxseSB0eXBpbmcgZGF0ZXMgaW4gc29tZSBmb3JtYXRzLgoJCQkJCS8vIEFzIHN1Y2gsIGl0cyBiZWhhdmlvciBzaG91bGQgbm90IGJlIGhpamFja2VkLgoJCQkJCWJyZWFrOwoJCQkJY2FzZSAxMzogLy8gZW50ZXIKCQkJCQlmb2N1c0RhdGUgPSB0aGlzLmZvY3VzRGF0ZSB8fCB0aGlzLmRhdGVzLmdldCgtMSkgfHwgdGhpcy52aWV3RGF0ZTsKCQkJCQlpZiAodGhpcy5vLmtleWJvYXJkTmF2aWdhdGlvbikgewoJCQkJCQl0aGlzLl90b2dnbGVfbXVsdGlkYXRlKGZvY3VzRGF0ZSk7CgkJCQkJCWRhdGVDaGFuZ2VkID0gdHJ1ZTsKCQkJCQl9CgkJCQkJdGhpcy5mb2N1c0RhdGUgPSBudWxsOwoJCQkJCXRoaXMudmlld0RhdGUgPSB0aGlzLmRhdGVzLmdldCgtMSkgfHwgdGhpcy52aWV3RGF0ZTsKCQkJCQl0aGlzLnNldFZhbHVlKCk7CgkJCQkJdGhpcy5maWxsKCk7CgkJCQkJaWYgKHRoaXMucGlja2VyLmlzKCc6dmlzaWJsZScpKXsKCQkJCQkJZS5wcmV2ZW50RGVmYXVsdCgpOwoJCQkJCQlpZiAodGhpcy5vLmF1dG9jbG9zZSkKCQkJCQkJCXRoaXMuaGlkZSgpOwoJCQkJCX0KCQkJCQlicmVhazsKCQkJCWNhc2UgOTogLy8gdGFiCgkJCQkJdGhpcy5mb2N1c0RhdGUgPSBudWxsOwoJCQkJCXRoaXMudmlld0RhdGUgPSB0aGlzLmRhdGVzLmdldCgtMSkgfHwgdGhpcy52aWV3RGF0ZTsKCQkJCQl0aGlzLmZpbGwoKTsKCQkJCQl0aGlzLmhpZGUoKTsKCQkJCQlicmVhazsKCQkJfQoJCQlpZiAoZGF0ZUNoYW5nZWQpewoJCQkJaWYgKHRoaXMuZGF0ZXMubGVuZ3RoKQoJCQkJCXRoaXMuX3RyaWdnZXIoJ2NoYW5nZURhdGUnKTsKCQkJCWVsc2UKCQkJCQl0aGlzLl90cmlnZ2VyKCdjbGVhckRhdGUnKTsKCQkJCXZhciBlbGVtZW50OwoJCQkJaWYgKHRoaXMuaXNJbnB1dCl7CgkJCQkJZWxlbWVudCA9IHRoaXMuZWxlbWVudDsKCQkJCX0KCQkJCWVsc2UgaWYgKHRoaXMuY29tcG9uZW50KXsKCQkJCQllbGVtZW50ID0gdGhpcy5lbGVtZW50LmZpbmQoJ2lucHV0Jyk7CgkJCQl9CgkJCQlpZiAoZWxlbWVudCl7CgkJCQkJZWxlbWVudC5jaGFuZ2UoKTsKCQkJCX0KCQkJfQoJCX0sCgoJCXNob3dNb2RlOiBmdW5jdGlvbihkaXIpewoJCQlpZiAoZGlyKXsKCQkJCXRoaXMudmlld01vZGUgPSBNYXRoLm1heCh0aGlzLm8ubWluVmlld01vZGUsIE1hdGgubWluKDIsIHRoaXMudmlld01vZGUgKyBkaXIpKTsKCQkJfQoJCQl0aGlzLnBpY2tlcgoJCQkJLmZpbmQoJz5kaXYnKQoJCQkJLmhpZGUoKQoJCQkJLmZpbHRlcignLmRhdGVwaWNrZXItJytEUEdsb2JhbC5tb2Rlc1t0aGlzLnZpZXdNb2RlXS5jbHNOYW1lKQoJCQkJCS5jc3MoJ2Rpc3BsYXknLCAnYmxvY2snKTsKCQkJdGhpcy51cGRhdGVOYXZBcnJvd3MoKTsKCQl9Cgl9OwoKCXZhciBEYXRlUmFuZ2VQaWNrZXIgPSBmdW5jdGlvbihlbGVtZW50LCBvcHRpb25zKXsKCQl0aGlzLmVsZW1lbnQgPSAkKGVsZW1lbnQpOwoJCXRoaXMuaW5wdXRzID0gJC5tYXAob3B0aW9ucy5pbnB1dHMsIGZ1bmN0aW9uKGkpewoJCQlyZXR1cm4gaS5qcXVlcnkgPyBpWzBdIDogaTsKCQl9KTsKCQlkZWxldGUgb3B0aW9ucy5pbnB1dHM7CgoJCSQodGhpcy5pbnB1dHMpCgkJCS5kYXRlcGlja2VyKG9wdGlvbnMpCgkJCS5iaW5kKCdjaGFuZ2VEYXRlJywgJC5wcm94eSh0aGlzLmRhdGVVcGRhdGVkLCB0aGlzKSk7CgoJCXRoaXMucGlja2VycyA9ICQubWFwKHRoaXMuaW5wdXRzLCBmdW5jdGlvbihpKXsKCQkJcmV0dXJuICQoaSkuZGF0YSgnZGF0ZXBpY2tlcicpOwoJCX0pOwoJCXRoaXMudXBkYXRlRGF0ZXMoKTsKCX07CglEYXRlUmFuZ2VQaWNrZXIucHJvdG90eXBlID0gewoJCXVwZGF0ZURhdGVzOiBmdW5jdGlvbigpewoJCQl0aGlzLmRhdGVzID0gJC5tYXAodGhpcy5waWNrZXJzLCBmdW5jdGlvbihpKXsKCQkJCXJldHVybiBpLmdldFVUQ0RhdGUoKTsKCQkJfSk7CgkJCXRoaXMudXBkYXRlUmFuZ2VzKCk7CgkJfSwKCQl1cGRhdGVSYW5nZXM6IGZ1bmN0aW9uKCl7CgkJCXZhciByYW5nZSA9ICQubWFwKHRoaXMuZGF0ZXMsIGZ1bmN0aW9uKGQpewoJCQkJcmV0dXJuIGQudmFsdWVPZigpOwoJCQl9KTsKCQkJJC5lYWNoKHRoaXMucGlja2VycywgZnVuY3Rpb24oaSwgcCl7CgkJCQlwLnNldFJhbmdlKHJhbmdlKTsKCQkJfSk7CgkJfSwKCQlkYXRlVXBkYXRlZDogZnVuY3Rpb24oZSl7CgkJCS8vIGB0aGlzLnVwZGF0aW5nYCBpcyBhIHdvcmthcm91bmQgZm9yIHByZXZlbnRpbmcgaW5maW5pdGUgcmVjdXJzaW9uCgkJCS8vIGJldHdlZW4gYGNoYW5nZURhdGVgIHRyaWdnZXJpbmcgYW5kIGBzZXRVVENEYXRlYCBjYWxsaW5nLiAgVW50aWwKCQkJLy8gdGhlcmUgaXMgYSBiZXR0ZXIgbWVjaGFuaXNtLgoJCQlpZiAodGhpcy51cGRhdGluZykKCQkJCXJldHVybjsKCQkJdGhpcy51cGRhdGluZyA9IHRydWU7CgoJCQl2YXIgZHAgPSAkKGUudGFyZ2V0KS5kYXRhKCdkYXRlcGlja2VyJyksCgkJCQluZXdfZGF0ZSA9IGRwLmdldFVUQ0RhdGUoKSwKCQkJCWkgPSAkLmluQXJyYXkoZS50YXJnZXQsIHRoaXMuaW5wdXRzKSwKCQkJCWwgPSB0aGlzLmlucHV0cy5sZW5ndGg7CgkJCWlmIChpID09PSAtMSkKCQkJCXJldHVybjsKCgkJCSQuZWFjaCh0aGlzLnBpY2tlcnMsIGZ1bmN0aW9uKGksIHApewoJCQkJaWYgKCFwLmdldFVUQ0RhdGUoKSkKCQkJCQlwLnNldFVUQ0RhdGUobmV3X2RhdGUpOwoJCQl9KTsKCgkJCWlmIChuZXdfZGF0ZSA8IHRoaXMuZGF0ZXNbaV0pewoJCQkJLy8gRGF0ZSBiZWluZyBtb3ZlZCBlYXJsaWVyL2xlZnQKCQkJCXdoaWxlIChpID49IDAgJiYgbmV3X2RhdGUgPCB0aGlzLmRhdGVzW2ldKXsKCQkJCQl0aGlzLnBpY2tlcnNbaS0tXS5zZXRVVENEYXRlKG5ld19kYXRlKTsKCQkJCX0KCQkJfQoJCQllbHNlIGlmIChuZXdfZGF0ZSA+IHRoaXMuZGF0ZXNbaV0pewoJCQkJLy8gRGF0ZSBiZWluZyBtb3ZlZCBsYXRlci9yaWdodAoJCQkJd2hpbGUgKGkgPCBsICYmIG5ld19kYXRlID4gdGhpcy5kYXRlc1tpXSl7CgkJCQkJdGhpcy5waWNrZXJzW2krK10uc2V0VVRDRGF0ZShuZXdfZGF0ZSk7CgkJCQl9CgkJCX0KCQkJdGhpcy51cGRhdGVEYXRlcygpOwoKCQkJZGVsZXRlIHRoaXMudXBkYXRpbmc7CgkJfSwKCQlyZW1vdmU6IGZ1bmN0aW9uKCl7CgkJCSQubWFwKHRoaXMucGlja2VycywgZnVuY3Rpb24ocCl7IHAucmVtb3ZlKCk7IH0pOwoJCQlkZWxldGUgdGhpcy5lbGVtZW50LmRhdGEoKS5kYXRlcGlja2VyOwoJCX0KCX07CgoJZnVuY3Rpb24gb3B0c19mcm9tX2VsKGVsLCBwcmVmaXgpewoJCS8vIERlcml2ZSBvcHRpb25zIGZyb20gZWxlbWVudCBkYXRhLWF0dHJzCgkJdmFyIGRhdGEgPSAkKGVsKS5kYXRhKCksCgkJCW91dCA9IHt9LCBpbmtleSwKCQkJcmVwbGFjZSA9IG5ldyBSZWdFeHAoJ14nICsgcHJlZml4LnRvTG93ZXJDYXNlKCkgKyAnKFtBLVpdKScpOwoJCXByZWZpeCA9IG5ldyBSZWdFeHAoJ14nICsgcHJlZml4LnRvTG93ZXJDYXNlKCkpOwoJCWZ1bmN0aW9uIHJlX2xvd2VyKF8sYSl7CgkJCXJldHVybiBhLnRvTG93ZXJDYXNlKCk7CgkJfQoJCWZvciAodmFyIGtleSBpbiBkYXRhKQoJCQlpZiAocHJlZml4LnRlc3Qoa2V5KSl7CgkJCQlpbmtleSA9IGtleS5yZXBsYWNlKHJlcGxhY2UsIHJlX2xvd2VyKTsKCQkJCW91dFtpbmtleV0gPSBkYXRhW2tleV07CgkJCX0KCQlyZXR1cm4gb3V0OwoJfQoKCWZ1bmN0aW9uIG9wdHNfZnJvbV9sb2NhbGUobGFuZyl7CgkJLy8gRGVyaXZlIG9wdGlvbnMgZnJvbSBsb2NhbGUgcGx1Z2lucwoJCXZhciBvdXQgPSB7fTsKCQkvLyBDaGVjayBpZiAiZGUtREUiIHN0eWxlIGRhdGUgaXMgYXZhaWxhYmxlLCBpZiBub3QgbGFuZ3VhZ2Ugc2hvdWxkCgkJLy8gZmFsbGJhY2sgdG8gMiBsZXR0ZXIgY29kZSBlZyAiZGUiCgkJaWYgKCFkYXRlc1tsYW5nXSl7CgkJCWxhbmcgPSBsYW5nLnNwbGl0KCctJylbMF07CgkJCWlmICghZGF0ZXNbbGFuZ10pCgkJCQlyZXR1cm47CgkJfQoJCXZhciBkID0gZGF0ZXNbbGFuZ107CgkJJC5lYWNoKGxvY2FsZV9vcHRzLCBmdW5jdGlvbihpLGspewoJCQlpZiAoayBpbiBkKQoJCQkJb3V0W2tdID0gZFtrXTsKCQl9KTsKCQlyZXR1cm4gb3V0OwoJfQoKCXZhciBvbGQgPSAkLmZuLmRhdGVwaWNrZXI7CgkkLmZuLmRhdGVwaWNrZXIgPSBmdW5jdGlvbihvcHRpb24pewoJCXZhciBhcmdzID0gQXJyYXkuYXBwbHkobnVsbCwgYXJndW1lbnRzKTsKCQlhcmdzLnNoaWZ0KCk7CgkJdmFyIGludGVybmFsX3JldHVybjsKCQl0aGlzLmVhY2goZnVuY3Rpb24oKXsKCQkJdmFyICR0aGlzID0gJCh0aGlzKSwKCQkJCWRhdGEgPSAkdGhpcy5kYXRhKCdkYXRlcGlja2VyJyksCgkJCQlvcHRpb25zID0gdHlwZW9mIG9wdGlvbiA9PT0gJ29iamVjdCcgJiYgb3B0aW9uOwoJCQlpZiAoIWRhdGEpewoJCQkJdmFyIGVsb3B0cyA9IG9wdHNfZnJvbV9lbCh0aGlzLCAnZGF0ZScpLAoJCQkJCS8vIFByZWxpbWluYXJ5IG90aW9ucwoJCQkJCXhvcHRzID0gJC5leHRlbmQoe30sIGRlZmF1bHRzLCBlbG9wdHMsIG9wdGlvbnMpLAoJCQkJCWxvY29wdHMgPSBvcHRzX2Zyb21fbG9jYWxlKHhvcHRzLmxhbmd1YWdlKSwKCQkJCQkvLyBPcHRpb25zIHByaW9yaXR5OiBqcyBhcmdzLCBkYXRhLWF0dHJzLCBsb2NhbGVzLCBkZWZhdWx0cwoJCQkJCW9wdHMgPSAkLmV4dGVuZCh7fSwgZGVmYXVsdHMsIGxvY29wdHMsIGVsb3B0cywgb3B0aW9ucyk7CgkJCQlpZiAoJHRoaXMuaXMoJy5pbnB1dC1kYXRlcmFuZ2UnKSB8fCBvcHRzLmlucHV0cyl7CgkJCQkJdmFyIHJvcHRzID0gewoJCQkJCQlpbnB1dHM6IG9wdHMuaW5wdXRzIHx8ICR0aGlzLmZpbmQoJ2lucHV0JykudG9BcnJheSgpCgkJCQkJfTsKCQkJCQkkdGhpcy5kYXRhKCdkYXRlcGlja2VyJywgKGRhdGEgPSBuZXcgRGF0ZVJhbmdlUGlja2VyKHRoaXMsICQuZXh0ZW5kKG9wdHMsIHJvcHRzKSkpKTsKCQkJCX0KCQkJCWVsc2UgewoJCQkJCSR0aGlzLmRhdGEoJ2RhdGVwaWNrZXInLCAoZGF0YSA9IG5ldyBEYXRlcGlja2VyKHRoaXMsIG9wdHMpKSk7CgkJCQl9CgkJCX0KCQkJaWYgKHR5cGVvZiBvcHRpb24gPT09ICdzdHJpbmcnICYmIHR5cGVvZiBkYXRhW29wdGlvbl0gPT09ICdmdW5jdGlvbicpewoJCQkJaW50ZXJuYWxfcmV0dXJuID0gZGF0YVtvcHRpb25dLmFwcGx5KGRhdGEsIGFyZ3MpOwoJCQkJaWYgKGludGVybmFsX3JldHVybiAhPT0gdW5kZWZpbmVkKQoJCQkJCXJldHVybiBmYWxzZTsKCQkJfQoJCX0pOwoJCWlmIChpbnRlcm5hbF9yZXR1cm4gIT09IHVuZGVmaW5lZCkKCQkJcmV0dXJuIGludGVybmFsX3JldHVybjsKCQllbHNlCgkJCXJldHVybiB0aGlzOwoJfTsKCgl2YXIgZGVmYXVsdHMgPSAkLmZuLmRhdGVwaWNrZXIuZGVmYXVsdHMgPSB7CgkJYXV0b2Nsb3NlOiBmYWxzZSwKCQliZWZvcmVTaG93RGF5OiAkLm5vb3AsCgkJY2FsZW5kYXJXZWVrczogZmFsc2UsCgkJY2xlYXJCdG46IGZhbHNlLAoJCWRheXNPZldlZWtEaXNhYmxlZDogW10sCgkJZW5kRGF0ZTogSW5maW5pdHksCgkJZm9yY2VQYXJzZTogdHJ1ZSwKCQlmb3JtYXQ6ICdtbS9kZC95eXl5JywKCQlrZXlib2FyZE5hdmlnYXRpb246IHRydWUsCgkJbGFuZ3VhZ2U6ICdlbicsCgkJbWluVmlld01vZGU6IDAsCgkJbXVsdGlkYXRlOiBmYWxzZSwKCQltdWx0aWRhdGVTZXBhcmF0b3I6ICcsJywKCQlvcmllbnRhdGlvbjogImF1dG8iLAoJCXJ0bDogZmFsc2UsCgkJc3RhcnREYXRlOiAtSW5maW5pdHksCgkJc3RhcnRWaWV3OiAwLAoJCXRvZGF5QnRuOiBmYWxzZSwKCQl0b2RheUhpZ2hsaWdodDogZmFsc2UsCgkJd2Vla1N0YXJ0OiAwCgl9OwoJdmFyIGxvY2FsZV9vcHRzID0gJC5mbi5kYXRlcGlja2VyLmxvY2FsZV9vcHRzID0gWwoJCSdmb3JtYXQnLAoJCSdydGwnLAoJCSd3ZWVrU3RhcnQnCgldOwoJJC5mbi5kYXRlcGlja2VyLkNvbnN0cnVjdG9yID0gRGF0ZXBpY2tlcjsKCXZhciBkYXRlcyA9ICQuZm4uZGF0ZXBpY2tlci5kYXRlcyA9IHsKCQllbjogewoJCQlkYXlzOiBbIlN1bmRheSIsICJNb25kYXkiLCAiVHVlc2RheSIsICJXZWRuZXNkYXkiLCAiVGh1cnNkYXkiLCAiRnJpZGF5IiwgIlNhdHVyZGF5IiwgIlN1bmRheSJdLAoJCQlkYXlzU2hvcnQ6IFsiU3VuIiwgIk1vbiIsICJUdWUiLCAiV2VkIiwgIlRodSIsICJGcmkiLCAiU2F0IiwgIlN1biJdLAoJCQlkYXlzTWluOiBbIlN1IiwgIk1vIiwgIlR1IiwgIldlIiwgIlRoIiwgIkZyIiwgIlNhIiwgIlN1Il0sCgkJCW1vbnRoczogWyJKYW51YXJ5IiwgIkZlYnJ1YXJ5IiwgIk1hcmNoIiwgIkFwcmlsIiwgIk1heSIsICJKdW5lIiwgIkp1bHkiLCAiQXVndXN0IiwgIlNlcHRlbWJlciIsICJPY3RvYmVyIiwgIk5vdmVtYmVyIiwgIkRlY2VtYmVyIl0sCgkJCW1vbnRoc1Nob3J0OiBbIkphbiIsICJGZWIiLCAiTWFyIiwgIkFwciIsICJNYXkiLCAiSnVuIiwgIkp1bCIsICJBdWciLCAiU2VwIiwgIk9jdCIsICJOb3YiLCAiRGVjIl0sCgkJCXRvZGF5OiAiVG9kYXkiLAoJCQljbGVhcjogIkNsZWFyIgoJCX0KCX07CgoJdmFyIERQR2xvYmFsID0gewoJCW1vZGVzOiBbCgkJCXsKCQkJCWNsc05hbWU6ICdkYXlzJywKCQkJCW5hdkZuYzogJ01vbnRoJywKCQkJCW5hdlN0ZXA6IDEKCQkJfSwKCQkJewoJCQkJY2xzTmFtZTogJ21vbnRocycsCgkJCQluYXZGbmM6ICdGdWxsWWVhcicsCgkJCQluYXZTdGVwOiAxCgkJCX0sCgkJCXsKCQkJCWNsc05hbWU6ICd5ZWFycycsCgkJCQluYXZGbmM6ICdGdWxsWWVhcicsCgkJCQluYXZTdGVwOiAxMAoJCX1dLAoJCWlzTGVhcFllYXI6IGZ1bmN0aW9uKHllYXIpewoJCQlyZXR1cm4gKCgoeWVhciAlIDQgPT09IDApICYmICh5ZWFyICUgMTAwICE9PSAwKSkgfHwgKHllYXIgJSA0MDAgPT09IDApKTsKCQl9LAoJCWdldERheXNJbk1vbnRoOiBmdW5jdGlvbih5ZWFyLCBtb250aCl7CgkJCXJldHVybiBbMzEsIChEUEdsb2JhbC5pc0xlYXBZZWFyKHllYXIpID8gMjkgOiAyOCksIDMxLCAzMCwgMzEsIDMwLCAzMSwgMzEsIDMwLCAzMSwgMzAsIDMxXVttb250aF07CgkJfSwKCQl2YWxpZFBhcnRzOiAvZGQ\/fEREP3xtbT98TU0\/fHl5KD86eXkpPy9nLAoJCW5vbnB1bmN0dWF0aW9uOiAvW14gLVwvOi1AXFtcdTM0MDAtXHU5ZmZmLWB7LX5cdFxuXHJdKy9nLAoJCXBhcnNlRm9ybWF0OiBmdW5jdGlvbihmb3JtYXQpewoJCQkvLyBJRSB0cmVhdHMgXDAgYXMgYSBzdHJpbmcgZW5kIGluIGlucHV0cyAodHJ1bmNhdGluZyB0aGUgdmFsdWUpLAoJCQkvLyBzbyBpdCdzIGEgYmFkIGZvcm1hdCBkZWxpbWl0ZXIsIGFueXdheQoJCQl2YXIgc2VwYXJhdG9ycyA9IGZvcm1hdC5yZXBsYWNlKHRoaXMudmFsaWRQYXJ0cywgJ1wwJykuc3BsaXQoJ1wwJyksCgkJCQlwYXJ0cyA9IGZvcm1hdC5tYXRjaCh0aGlzLnZhbGlkUGFydHMpOwoJCQlpZiAoIXNlcGFyYXRvcnMgfHwgIXNlcGFyYXRvcnMubGVuZ3RoIHx8ICFwYXJ0cyB8fCBwYXJ0cy5sZW5ndGggPT09IDApewoJCQkJdGhyb3cgbmV3IEVycm9yKCJJbnZhbGlkIGRhdGUgZm9ybWF0LiIpOwoJCQl9CgkJCXJldHVybiB7c2VwYXJhdG9yczogc2VwYXJhdG9ycywgcGFydHM6IHBhcnRzfTsKCQl9LAoJCXBhcnNlRGF0ZTogZnVuY3Rpb24oZGF0ZSwgZm9ybWF0LCBsYW5ndWFnZSl7CgkJCWlmICghZGF0ZSkKCQkJCXJldHVybiB1bmRlZmluZWQ7CgkJCWlmIChkYXRlIGluc3RhbmNlb2YgRGF0ZSkKCQkJCXJldHVybiBkYXRlOwoJCQlpZiAodHlwZW9mIGZvcm1hdCA9PT0gJ3N0cmluZycpCgkJCQlmb3JtYXQgPSBEUEdsb2JhbC5wYXJzZUZvcm1hdChmb3JtYXQpOwoJCQl2YXIgcGFydF9yZSA9IC8oW1wtK11cZCspKFtkbXd5XSkvLAoJCQkJcGFydHMgPSBkYXRlLm1hdGNoKC8oW1wtK11cZCspKFtkbXd5XSkvZyksCgkJCQlwYXJ0LCBkaXIsIGk7CgkJCWlmICgvXltcLStdXGQrW2Rtd3ldKFtccyxdK1tcLStdXGQrW2Rtd3ldKSokLy50ZXN0KGRhdGUpKXsKCQkJCWRhdGUgPSBuZXcgRGF0ZSgpOwoJCQkJZm9yIChpPTA7IGkgPCBwYXJ0cy5sZW5ndGg7IGkrKyl7CgkJCQkJcGFydCA9IHBhcnRfcmUuZXhlYyhwYXJ0c1tpXSk7CgkJCQkJZGlyID0gcGFyc2VJbnQocGFydFsxXSk7CgkJCQkJc3dpdGNoIChwYXJ0WzJdKXsKCQkJCQkJY2FzZSAnZCc6CgkJCQkJCQlkYXRlLnNldFVUQ0RhdGUoZGF0ZS5nZXRVVENEYXRlKCkgKyBkaXIpOwoJCQkJCQkJYnJlYWs7CgkJCQkJCWNhc2UgJ20nOgoJCQkJCQkJZGF0ZSA9IERhdGVwaWNrZXIucHJvdG90eXBlLm1vdmVNb250aC5jYWxsKERhdGVwaWNrZXIucHJvdG90eXBlLCBkYXRlLCBkaXIpOwoJCQkJCQkJYnJlYWs7CgkJCQkJCWNhc2UgJ3cnOgoJCQkJCQkJZGF0ZS5zZXRVVENEYXRlKGRhdGUuZ2V0VVRDRGF0ZSgpICsgZGlyICogNyk7CgkJCQkJCQlicmVhazsKCQkJCQkJY2FzZSAneSc6CgkJCQkJCQlkYXRlID0gRGF0ZXBpY2tlci5wcm90b3R5cGUubW92ZVllYXIuY2FsbChEYXRlcGlja2VyLnByb3RvdHlwZSwgZGF0ZSwgZGlyKTsKCQkJCQkJCWJyZWFrOwoJCQkJCX0KCQkJCX0KCQkJCXJldHVybiBVVENEYXRlKGRhdGUuZ2V0VVRDRnVsbFllYXIoKSwgZGF0ZS5nZXRVVENNb250aCgpLCBkYXRlLmdldFVUQ0RhdGUoKSwgMCwgMCwgMCk7CgkJCX0KCQkJcGFydHMgPSBkYXRlICYmIGRhdGUubWF0Y2godGhpcy5ub25wdW5jdHVhdGlvbikgfHwgW107CgkJCWRhdGUgPSBuZXcgRGF0ZSgpOwoJCQl2YXIgcGFyc2VkID0ge30sCgkJCQlzZXR0ZXJzX29yZGVyID0gWyd5eXl5JywgJ3l5JywgJ00nLCAnTU0nLCAnbScsICdtbScsICdkJywgJ2RkJ10sCgkJCQlzZXR0ZXJzX21hcCA9IHsKCQkJCQl5eXl5OiBmdW5jdGlvbihkLHYpewoJCQkJCQlyZXR1cm4gZC5zZXRVVENGdWxsWWVhcih2KTsKCQkJCQl9LAoJCQkJCXl5OiBmdW5jdGlvbihkLHYpewoJCQkJCQlyZXR1cm4gZC5zZXRVVENGdWxsWWVhcigyMDAwK3YpOwoJCQkJCX0sCgkJCQkJbTogZnVuY3Rpb24oZCx2KXsKCQkJCQkJaWYgKGlzTmFOKGQpKQoJCQkJCQkJcmV0dXJuIGQ7CgkJCQkJCXYgLT0gMTsKCQkJCQkJd2hpbGUgKHYgPCAwKSB2ICs9IDEyOwoJCQkJCQl2ICU9IDEyOwoJCQkJCQlkLnNldFVUQ01vbnRoKHYpOwoJCQkJCQl3aGlsZSAoZC5nZXRVVENNb250aCgpICE9PSB2KQoJCQkJCQkJZC5zZXRVVENEYXRlKGQuZ2V0VVRDRGF0ZSgpLTEpOwoJCQkJCQlyZXR1cm4gZDsKCQkJCQl9LAoJCQkJCWQ6IGZ1bmN0aW9uKGQsdil7CgkJCQkJCXJldHVybiBkLnNldFVUQ0RhdGUodik7CgkJCQkJfQoJCQkJfSwKCQkJCXZhbCwgZmlsdGVyZWQ7CgkJCXNldHRlcnNfbWFwWydNJ10gPSBzZXR0ZXJzX21hcFsnTU0nXSA9IHNldHRlcnNfbWFwWydtbSddID0gc2V0dGVyc19tYXBbJ20nXTsKCQkJc2V0dGVyc19tYXBbJ2RkJ10gPSBzZXR0ZXJzX21hcFsnZCddOwoJCQlkYXRlID0gVVRDRGF0ZShkYXRlLmdldEZ1bGxZZWFyKCksIGRhdGUuZ2V0TW9udGgoKSwgZGF0ZS5nZXREYXRlKCksIDAsIDAsIDApOwoJCQl2YXIgZnBhcnRzID0gZm9ybWF0LnBhcnRzLnNsaWNlKCk7CgkJCS8vIFJlbW92ZSBub29wIHBhcnRzCgkJCWlmIChwYXJ0cy5sZW5ndGggIT09IGZwYXJ0cy5sZW5ndGgpewoJCQkJZnBhcnRzID0gJChmcGFydHMpLmZpbHRlcihmdW5jdGlvbihpLHApewoJCQkJCXJldHVybiAkLmluQXJyYXkocCwgc2V0dGVyc19vcmRlcikgIT09IC0xOwoJCQkJfSkudG9BcnJheSgpOwoJCQl9CgkJCS8vIFByb2Nlc3MgcmVtYWluZGVyCgkJCWZ1bmN0aW9uIG1hdGNoX3BhcnQoKXsKCQkJCXZhciBtID0gdGhpcy5zbGljZSgwLCBwYXJ0c1tpXS5sZW5ndGgpLAoJCQkJCXAgPSBwYXJ0c1tpXS5zbGljZSgwLCBtLmxlbmd0aCk7CgkJCQlyZXR1cm4gbSA9PT0gcDsKCQkJfQoJCQlpZiAocGFydHMubGVuZ3RoID09PSBmcGFydHMubGVuZ3RoKXsKCQkJCXZhciBjbnQ7CgkJCQlmb3IgKGk9MCwgY250ID0gZnBhcnRzLmxlbmd0aDsgaSA8IGNudDsgaSsrKXsKCQkJCQl2YWwgPSBwYXJzZUludChwYXJ0c1tpXSwgMTApOwoJCQkJCXBhcnQgPSBmcGFydHNbaV07CgkJCQkJaWYgKGlzTmFOKHZhbCkpewoJCQkJCQlzd2l0Y2ggKHBhcnQpewoJCQkJCQkJY2FzZSAnTU0nOgoJCQkJCQkJCWZpbHRlcmVkID0gJChkYXRlc1tsYW5ndWFnZV0ubW9udGhzKS5maWx0ZXIobWF0Y2hfcGFydCk7CgkJCQkJCQkJdmFsID0gJC5pbkFycmF5KGZpbHRlcmVkWzBdLCBkYXRlc1tsYW5ndWFnZV0ubW9udGhzKSArIDE7CgkJCQkJCQkJYnJlYWs7CgkJCQkJCQljYXNlICdNJzoKCQkJCQkJCQlmaWx0ZXJlZCA9ICQoZGF0ZXNbbGFuZ3VhZ2VdLm1vbnRoc1Nob3J0KS5maWx0ZXIobWF0Y2hfcGFydCk7CgkJCQkJCQkJdmFsID0gJC5pbkFycmF5KGZpbHRlcmVkWzBdLCBkYXRlc1tsYW5ndWFnZV0ubW9udGhzU2hvcnQpICsgMTsKCQkJCQkJCQlicmVhazsKCQkJCQkJfQoJCQkJCX0KCQkJCQlwYXJzZWRbcGFydF0gPSB2YWw7CgkJCQl9CgkJCQl2YXIgX2RhdGUsIHM7CgkJCQlmb3IgKGk9MDsgaSA8IHNldHRlcnNfb3JkZXIubGVuZ3RoOyBpKyspewoJCQkJCXMgPSBzZXR0ZXJzX29yZGVyW2ldOwoJCQkJCWlmIChzIGluIHBhcnNlZCAmJiAhaXNOYU4ocGFyc2VkW3NdKSl7CgkJCQkJCV9kYXRlID0gbmV3IERhdGUoZGF0ZSk7CgkJCQkJCXNldHRlcnNfbWFwW3NdKF9kYXRlLCBwYXJzZWRbc10pOwoJCQkJCQlpZiAoIWlzTmFOKF9kYXRlKSkKCQkJCQkJCWRhdGUgPSBfZGF0ZTsKCQkJCQl9CgkJCQl9CgkJCX0KCQkJcmV0dXJuIGRhdGU7CgkJfSwKCQlmb3JtYXREYXRlOiBmdW5jdGlvbihkYXRlLCBmb3JtYXQsIGxhbmd1YWdlKXsKCQkJaWYgKCFkYXRlKQoJCQkJcmV0dXJuICcnOwoJCQlpZiAodHlwZW9mIGZvcm1hdCA9PT0gJ3N0cmluZycpCgkJCQlmb3JtYXQgPSBEUEdsb2JhbC5wYXJzZUZvcm1hdChmb3JtYXQpOwoJCQl2YXIgdmFsID0gewoJCQkJZDogZGF0ZS5nZXRVVENEYXRlKCksCgkJCQlEOiBkYXRlc1tsYW5ndWFnZV0uZGF5c1Nob3J0W2RhdGUuZ2V0VVRDRGF5KCldLAoJCQkJREQ6IGRhdGVzW2xhbmd1YWdlXS5kYXlzW2RhdGUuZ2V0VVRDRGF5KCldLAoJCQkJbTogZGF0ZS5nZXRVVENNb250aCgpICsgMSwKCQkJCU06IGRhdGVzW2xhbmd1YWdlXS5tb250aHNTaG9ydFtkYXRlLmdldFVUQ01vbnRoKCldLAoJCQkJTU06IGRhdGVzW2xhbmd1YWdlXS5tb250aHNbZGF0ZS5nZXRVVENNb250aCgpXSwKCQkJCXl5OiBkYXRlLmdldFVUQ0Z1bGxZZWFyKCkudG9TdHJpbmcoKS5zdWJzdHJpbmcoMiksCgkJCQl5eXl5OiBkYXRlLmdldFVUQ0Z1bGxZZWFyKCkKCQkJfTsKCQkJdmFsLmRkID0gKHZhbC5kIDwgMTAgPyAnMCcgOiAnJykgKyB2YWwuZDsKCQkJdmFsLm1tID0gKHZhbC5tIDwgMTAgPyAnMCcgOiAnJykgKyB2YWwubTsKCQkJZGF0ZSA9IFtdOwoJCQl2YXIgc2VwcyA9ICQuZXh0ZW5kKFtdLCBmb3JtYXQuc2VwYXJhdG9ycyk7CgkJCWZvciAodmFyIGk9MCwgY250ID0gZm9ybWF0LnBhcnRzLmxlbmd0aDsgaSA8PSBjbnQ7IGkrKyl7CgkJCQlpZiAoc2Vwcy5sZW5ndGgpCgkJCQkJZGF0ZS5wdXNoKHNlcHMuc2hpZnQoKSk7CgkJCQlkYXRlLnB1c2godmFsW2Zvcm1hdC5wYXJ0c1tpXV0pOwoJCQl9CgkJCXJldHVybiBkYXRlLmpvaW4oJycpOwoJCX0sCgkJaGVhZFRlbXBsYXRlOiAnPHRoZWFkPicrCgkJCQkJCQknPHRyPicrCgkJCQkJCQkJJzx0aCBjbGFzcz0icHJldiI+JmxhcXVvOzwvdGg+JysKCQkJCQkJCQknPHRoIGNvbHNwYW49IjUiIGNsYXNzPSJkYXRlcGlja2VyLXN3aXRjaCI+PC90aD4nKwoJCQkJCQkJCSc8dGggY2xhc3M9Im5leHQiPiZyYXF1bzs8L3RoPicrCgkJCQkJCQknPC90cj4nKwoJCQkJCQknPC90aGVhZD4nLAoJCWNvbnRUZW1wbGF0ZTogJzx0Ym9keT48dHI+PHRkIGNvbHNwYW49IjciPjwvdGQ+PC90cj48L3Rib2R5PicsCgkJZm9vdFRlbXBsYXRlOiAnPHRmb290PicrCgkJCQkJCQknPHRyPicrCgkJCQkJCQkJJzx0aCBjb2xzcGFuPSI3IiBjbGFzcz0idG9kYXkiPjwvdGg+JysKCQkJCQkJCSc8L3RyPicrCgkJCQkJCQknPHRyPicrCgkJCQkJCQkJJzx0aCBjb2xzcGFuPSI3IiBjbGFzcz0iY2xlYXIiPjwvdGg+JysKCQkJCQkJCSc8L3RyPicrCgkJCQkJCSc8L3Rmb290PicKCX07CglEUEdsb2JhbC50ZW1wbGF0ZSA9ICc8ZGl2IGNsYXNzPSJkYXRlcGlja2VyIj4nKwoJCQkJCQkJJzxkaXYgY2xhc3M9ImRhdGVwaWNrZXItZGF5cyI+JysKCQkJCQkJCQknPHRhYmxlIGNsYXNzPSIgdGFibGUtY29uZGVuc2VkIj4nKwoJCQkJCQkJCQlEUEdsb2JhbC5oZWFkVGVtcGxhdGUrCgkJCQkJCQkJCSc8dGJvZHk+PC90Ym9keT4nKwoJCQkJCQkJCQlEUEdsb2JhbC5mb290VGVtcGxhdGUrCgkJCQkJCQkJJzwvdGFibGU+JysKCQkJCQkJCSc8L2Rpdj4nKwoJCQkJCQkJJzxkaXYgY2xhc3M9ImRhdGVwaWNrZXItbW9udGhzIj4nKwoJCQkJCQkJCSc8dGFibGUgY2xhc3M9InRhYmxlLWNvbmRlbnNlZCI+JysKCQkJCQkJCQkJRFBHbG9iYWwuaGVhZFRlbXBsYXRlKwoJCQkJCQkJCQlEUEdsb2JhbC5jb250VGVtcGxhdGUrCgkJCQkJCQkJCURQR2xvYmFsLmZvb3RUZW1wbGF0ZSsKCQkJCQkJCQknPC90YWJsZT4nKwoJCQkJCQkJJzwvZGl2PicrCgkJCQkJCQknPGRpdiBjbGFzcz0iZGF0ZXBpY2tlci15ZWFycyI+JysKCQkJCQkJCQknPHRhYmxlIGNsYXNzPSJ0YWJsZS1jb25kZW5zZWQiPicrCgkJCQkJCQkJCURQR2xvYmFsLmhlYWRUZW1wbGF0ZSsKCQkJCQkJCQkJRFBHbG9iYWwuY29udFRlbXBsYXRlKwoJCQkJCQkJCQlEUEdsb2JhbC5mb290VGVtcGxhdGUrCgkJCQkJCQkJJzwvdGFibGU+JysKCQkJCQkJCSc8L2Rpdj4nKwoJCQkJCQknPC9kaXY+JzsKCgkkLmZuLmRhdGVwaWNrZXIuRFBHbG9iYWwgPSBEUEdsb2JhbDsKCgoJLyogREFURVBJQ0tFUiBOTyBDT05GTElDVAoJKiA9PT09PT09PT09PT09PT09PT09ICovCgoJJC5mbi5kYXRlcGlja2VyLm5vQ29uZmxpY3QgPSBmdW5jdGlvbigpewoJCSQuZm4uZGF0ZXBpY2tlciA9IG9sZDsKCQlyZXR1cm4gdGhpczsKCX07CgoKCS8qIERBVEVQSUNLRVIgREFUQS1BUEkKCSogPT09PT09PT09PT09PT09PT09ICovCgoJJChkb2N1bWVudCkub24oCgkJJ2ZvY3VzLmRhdGVwaWNrZXIuZGF0YS1hcGkgY2xpY2suZGF0ZXBpY2tlci5kYXRhLWFwaScsCgkJJ1tkYXRhLXByb3ZpZGU9ImRhdGVwaWNrZXIiXScsCgkJZnVuY3Rpb24oZSl7CgkJCXZhciAkdGhpcyA9ICQodGhpcyk7CgkJCWlmICgkdGhpcy5kYXRhKCdkYXRlcGlja2VyJykpCgkJCQlyZXR1cm47CgkJCWUucHJldmVudERlZmF1bHQoKTsKCQkJLy8gY29tcG9uZW50IGNsaWNrIHJlcXVpcmVzIHVzIHRvIGV4cGxpY2l0bHkgc2hvdyBpdAoJCQkkdGhpcy5kYXRlcGlja2VyKCdzaG93Jyk7CgkJfQoJKTsKCSQoZnVuY3Rpb24oKXsKCQkkKCdbZGF0YS1wcm92aWRlPSJkYXRlcGlja2VyLWlubGluZSJdJykuZGF0ZXBpY2tlcigpOwoJfSk7Cgp9KHdpbmRvdy5qUXVlcnkpKTsK",
    "size": "47205"
}