{
    "namaFile": "lib\/jpgraph\/jpgraph_polar.php",
    "lastUpdate": "2013-12-16+17:18:18.00",
    "contentFile": "PD9waHAKLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogLy8gRmlsZTogICAgICAgIEpQR1JBUEhfUE9MQVIuUEhQCiAvLyBEZXNjcmlwdGlvbjogUG9sYXIgcGxvdCBleHRlbnNpb24gZm9yIEpwR3JhcGgKIC8vIENyZWF0ZWQ6ICAgICAyMDAzLTAyLTAyCiAvLyBWZXI6ICAgICAgICAgJElkOiBqcGdyYXBoX3BvbGFyLnBocCAxNzk2IDIwMDktMDktMDcgMDk6Mzc6MTlaIGxqcCAkCiAvLwogLy8gQ29weXJpZ2h0IChjKSBBc2lhbCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAqLwoKcmVxdWlyZV9vbmNlICgnanBncmFwaF9wbG90bWFyay5pbmMucGhwJyk7CnJlcXVpcmVfb25jZSAianBncmFwaF9sb2cucGhwIjsKCgpkZWZpbmUoJ1BPTEFSXzM2MCcsMSk7CmRlZmluZSgnUE9MQVJfMTgwJywyKTsKCi8vCi8vIE5vdGUuIERvbid0IGF0dGVtcHQgdG8gbWFrZSBzZW5zZSBvZiB0aGlzIGNvZGUuCi8vIEluIG9yZGVyIG5vdCB0byBoYXZlIHRvIGJlIGFibGUgdG8gaW5oZXJpdCB0aGUgc2NhbGluZyBjb2RlCi8vIGZyb20gdGhlIG1haW4gZ3JhcGggcGFja2FnZSB3ZSBoYXZlIGhhZCB0byBtYWtlIHNvbWUgInRyaWNrcyIgc2luY2UKLy8gdGhlIG9yaWdpbmFsIHNjYWxpbmcgYW5kIGF4aXMgd2FzIG5vdCBkZXNpZ25lZCB0byBkbyB3aGF0IGlzCi8vIHJlcXVpcmVkIGhlcmUuCi8vIFRoZXJlIHdlcmUgdHdvIG9wdGlvbi4gMTogUmUtaW1wbGVtZW50IGV2ZXJ5dGhpbmcgYW5kIGdldCBhIGNsZWFuIGRlc2lnbgovLyBhbmQgMjogZG8gc29tZSAic21hbGwiIHRyaWNrZXJ5IGFuZCBiZSBhYmxlIHRvIGluaGVyaXQgbW9zdCBvZgovLyB0aGUgZnVuY3Rpb25saXR5IGZyb20gdGhlIG1haW4gZ3JhcGggcGFja2FnZS4KLy8gV2UgY2hvb3NlIDI6IGhlcmUgaW4gb3JkZXIgdG8gc2F2ZSBzb21lIHRpbWUuCi8vCgovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIGNsYXNzIFBvbGFyUGxvdAovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmNsYXNzIFBvbGFyUGxvdCB7CiAgICBwdWJsaWMgJGxpbmVfc3R5bGU9J3NvbGlkJywkbWFyazsKICAgIHB1YmxpYyAkbGVnZW5kY3NpbXRhcmdldD0nJzsKICAgIHB1YmxpYyAkbGVnZW5kY3NpbWFsdD0nJzsKICAgIHB1YmxpYyAkbGVnZW5kPSIiOwogICAgcHVibGljICRjc2ltdGFyZ2V0cz1hcnJheSgpOyAvLyBBcnJheSBvZiB0YXJnZXRzIGZvciBDU0lNCiAgICBwdWJsaWMgJGNzaW1hcmVhcz0iIjsgICAvLyBSZXN1bHRhbnQgQ1NJTSBhcmVhIHRhZ3MKICAgIHB1YmxpYyAkY3NpbWFsdHM9bnVsbDsgICAvLyBBTFQ6cyBmb3IgY29ycmVzcG9uZGluZyB0YXJnZXQKICAgIHB1YmxpYyAkc2NhbGU9bnVsbDsKICAgIHByaXZhdGUgJG51bXBvaW50cz0wOwogICAgcHJpdmF0ZSAkaUNvbG9yPSduYXZ5JywkaUZpbGxDb2xvcj0nJzsKICAgIHByaXZhdGUgJGlMaW5lV2VpZ2h0PTE7CiAgICBwcml2YXRlICRjb29yZD1udWxsOwoKICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRhRGF0YSkgewogICAgICAgICRuID0gY291bnQoJGFEYXRhKTsKICAgICAgICBpZiggJG4gJiAxICkgewogICAgICAgICAgICBKcEdyYXBoRXJyb3I6OlJhaXNlTCgxNzAwMSk7CiAgICAgICAgICAgIC8vKCdQb2xhciBwbG90cyBtdXN0IGhhdmUgYW4gZXZlbiBudW1iZXIgb2YgZGF0YSBwb2ludC4gRWFjaCBkYXRhIHBvaW50IGlzIGEgdHVwbGUgKGFuZ2xlLHJhZGl1cykuJyk7CiAgICAgICAgfQogICAgICAgICR0aGlzLT5udW1wb2ludHMgPSAkbi8yOwogICAgICAgICR0aGlzLT5jb29yZCA9ICRhRGF0YTsKICAgICAgICAkdGhpcy0+bWFyayA9IG5ldyBQbG90TWFyaygpOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldFdlaWdodCgkYVdlaWdodCkgewogICAgICAgICR0aGlzLT5pTGluZVdlaWdodCA9ICRhV2VpZ2h0OwogICAgfQoKICAgIGZ1bmN0aW9uIFNldENvbG9yKCRhQ29sb3IpewogICAgICAgICR0aGlzLT5pQ29sb3IgPSAkYUNvbG9yOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldEZpbGxDb2xvcigkYUNvbG9yKXsKICAgICAgICAkdGhpcy0+aUZpbGxDb2xvciA9ICRhQ29sb3I7CiAgICB9CgogICAgZnVuY3Rpb24gTWF4KCkgewogICAgICAgICRtID0gJHRoaXMtPmNvb3JkWzFdOwogICAgICAgICRpPTE7CiAgICAgICAgd2hpbGUoICRpIDwgJHRoaXMtPm51bXBvaW50cyApIHsKICAgICAgICAgICAgJG0gPSBtYXgoJG0sJHRoaXMtPmNvb3JkWzIqJGkrMV0pOwogICAgICAgICAgICArKyRpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gJG07CiAgICB9CiAgICAvLyBTZXQgaHJlZiB0YXJnZXRzIGZvciBDU0lNCiAgICBmdW5jdGlvbiBTZXRDU0lNVGFyZ2V0cygkYVRhcmdldHMsJGFBbHRzPW51bGwpIHsKICAgICAgICAkdGhpcy0+Y3NpbXRhcmdldHM9JGFUYXJnZXRzOwogICAgICAgICR0aGlzLT5jc2ltYWx0cz0kYUFsdHM7CiAgICB9CgogICAgLy8gR2V0IGFsbCBjcmVhdGVkIGFyZWFzCiAgICBmdW5jdGlvbiBHZXRDU0lNYXJlYXMoKSB7CiAgICAgICAgcmV0dXJuICR0aGlzLT5jc2ltYXJlYXM7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0TGVnZW5kKCRhTGVnZW5kLCRhQ1NJTT0iIiwkYUNTSU1BbHQ9IiIpIHsKICAgICAgICAkdGhpcy0+bGVnZW5kID0gJGFMZWdlbmQ7CiAgICAgICAgJHRoaXMtPmxlZ2VuZGNzaW10YXJnZXQgPSAkYUNTSU07CiAgICAgICAgJHRoaXMtPmxlZ2VuZGNzaW1hbHQgPSAkYUNTSU1BbHQ7CiAgICB9CgogICAgLy8gUHJpdmF0ZSBtZXRob2RzCgogICAgZnVuY3Rpb24gTGVnZW5kKCRhR3JhcGgpIHsKICAgICAgICAkY29sb3IgPSAkdGhpcy0+aUNvbG9yIDsKICAgICAgICBpZiggJHRoaXMtPmxlZ2VuZCAhPSAiIiApIHsKICAgICAgICAgICAgaWYoICR0aGlzLT5pRmlsbENvbG9yIT0nJyApIHsKICAgICAgICAgICAgICAgICRjb2xvciA9ICR0aGlzLT5pRmlsbENvbG9yOwogICAgICAgICAgICAgICAgJGFHcmFwaC0+bGVnZW5kLT5BZGQoJHRoaXMtPmxlZ2VuZCwkY29sb3IsJHRoaXMtPm1hcmssMCwKICAgICAgICAgICAgICAgICR0aGlzLT5sZWdlbmRjc2ltdGFyZ2V0LCR0aGlzLT5sZWdlbmRjc2ltYWx0KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICRhR3JhcGgtPmxlZ2VuZC0+QWRkKCR0aGlzLT5sZWdlbmQsJGNvbG9yLCR0aGlzLT5tYXJrLCR0aGlzLT5saW5lX3N0eWxlLAogICAgICAgICAgICAgICAgJHRoaXMtPmxlZ2VuZGNzaW10YXJnZXQsJHRoaXMtPmxlZ2VuZGNzaW1hbHQpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIFN0cm9rZSgkaW1nLCRzY2FsZSkgewoKICAgICAgICAkaT0wOwogICAgICAgICRwPWFycmF5KCk7CiAgICAgICAgJHRoaXMtPmNzaW1hcmVhcz0nJzsKICAgICAgICB3aGlsZSgkaSA8ICR0aGlzLT5udW1wb2ludHMpIHsKICAgICAgICAgICAgbGlzdCgkeDEsJHkxKSA9ICRzY2FsZS0+UFRyYW5zbGF0ZSgkdGhpcy0+Y29vcmRbMiokaV0sJHRoaXMtPmNvb3JkWzIqJGkrMV0pOwogICAgICAgICAgICAkcFsyKiRpXSA9ICR4MTsKICAgICAgICAgICAgJHBbMiokaSsxXSA9ICR5MTsKCiAgICAgICAgICAgIGlmKCBpc3NldCgkdGhpcy0+Y3NpbXRhcmdldHNbJGldKSApIHsKICAgICAgICAgICAgICAgICR0aGlzLT5tYXJrLT5TZXRDU0lNVGFyZ2V0KCR0aGlzLT5jc2ltdGFyZ2V0c1skaV0pOwogICAgICAgICAgICAgICAgJHRoaXMtPm1hcmstPlNldENTSU1BbHQoJHRoaXMtPmNzaW1hbHRzWyRpXSk7CiAgICAgICAgICAgICAgICAkdGhpcy0+bWFyay0+U2V0Q1NJTUFsdFZhbCgkdGhpcy0+Y29vcmRbMiokaV0sICR0aGlzLT5jb29yZFsyKiRpKzFdKTsKICAgICAgICAgICAgICAgICR0aGlzLT5tYXJrLT5TdHJva2UoJGltZywkeDEsJHkxKTsKICAgICAgICAgICAgICAgICR0aGlzLT5jc2ltYXJlYXMgLj0gJHRoaXMtPm1hcmstPkdldENTSU1BcmVhcygpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAJJHRoaXMtPm1hcmstPlN0cm9rZSgkaW1nLCR4MSwkeTEpOwogICAgICAgICAgICB9CgogICAgICAgICAgICArKyRpOwogICAgICAgIH0KCiAgICAgICAgaWYoICR0aGlzLT5pRmlsbENvbG9yICE9ICcnICkgewogICAgICAgICAgICAkaW1nLT5TZXRDb2xvcigkdGhpcy0+aUZpbGxDb2xvcik7CiAgICAgICAgICAgICRpbWctPkZpbGxlZFBvbHlnb24oJHApOwogICAgICAgIH0KICAgICAgICAkaW1nLT5TZXRMaW5lV2VpZ2h0KCR0aGlzLT5pTGluZVdlaWdodCk7CiAgICAgICAgJGltZy0+U2V0Q29sb3IoJHRoaXMtPmlDb2xvcik7CiAgICAgICAgJGltZy0+UG9seWdvbigkcCwkdGhpcy0+aUZpbGxDb2xvciE9JycpOwogICAgfQp9CgovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCi8vIGNsYXNzIFBvbGFyQXhpcwovLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCmNsYXNzIFBvbGFyQXhpcyBleHRlbmRzIEF4aXMgewogICAgcHJpdmF0ZSAkYW5nbGVfc3RlcD0xNSwkYW5nbGVfY29sb3I9J2xpZ2h0Z3JheScsJGFuZ2xlX2xhYmVsX2NvbG9yPSdibGFjayc7CiAgICBwcml2YXRlICRhbmdsZV9mb250ZmFtPUZGX0ZPTlQxLCRhbmdsZV9mb250c3R5bGU9RlNfTk9STUFMLCRhbmdsZV9mb250c2l6ZT0xMDsKICAgIHByaXZhdGUgJGFuZ2xlX2ZvbnRjb2xvciA9ICduYXZ5JzsKICAgIHByaXZhdGUgJGdyaWRtaW5vcl9jb2xvcj0nbGlnaHRncmF5JywkZ3JpZG1ham9yX2NvbG9yPSdsaWdodGdyYXknOwogICAgcHJpdmF0ZSAkc2hvd19taW5vcl9ncmlkID0gZmFsc2UsICRzaG93X21ham9yX2dyaWQgPSB0cnVlIDsKICAgIHByaXZhdGUgJHNob3dfYW5nbGVfbWFyaz10cnVlLCAkc2hvd19hbmdsZV9ncmlkPXRydWUsICRzaG93X2FuZ2xlX2xhYmVsPXRydWU7CiAgICBwcml2YXRlICRhbmdsZV90aWNrX2xlbj0zLCAkYW5nbGVfdGlja19sZW4yPTMsICRhbmdsZV90aWNrX2NvbG9yPSdibGFjayc7CiAgICBwcml2YXRlICRzaG93X2FuZ2xlX3RpY2s9dHJ1ZTsKICAgIHByaXZhdGUgJHJhZGl1c190aWNrX2NvbG9yPSdibGFjayc7CgogICAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGltZywkYVNjYWxlKSB7CiAgICAgICAgcGFyZW50OjpfX2NvbnN0cnVjdCgkaW1nLCRhU2NhbGUpOwogICAgfQoKICAgIGZ1bmN0aW9uIFNob3dBbmdsZURlZ3JlZU1hcmsoJGFGbGc9dHJ1ZSkgewogICAgICAgICR0aGlzLT5zaG93X2FuZ2xlX21hcmsgPSAkYUZsZzsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRBbmdsZVN0ZXAoJGFTdGVwKSB7CiAgICAgICAgJHRoaXMtPmFuZ2xlX3N0ZXA9JGFTdGVwOwogICAgfQoKICAgIGZ1bmN0aW9uIEhpZGVUaWNrcygkYUZsZz10cnVlLCRhQW5nbGVGbGc9dHJ1ZSkgewogICAgICAgIHBhcmVudDo6SGlkZVRpY2tzKCRhRmxnLCRhRmxnKTsKICAgICAgICAkdGhpcy0+c2hvd19hbmdsZV90aWNrID0gISRhQW5nbGVGbGc7CiAgICB9CgogICAgZnVuY3Rpb24gU2hvd0FuZ2xlTGFiZWwoJGFGbGc9dHJ1ZSkgewogICAgICAgICR0aGlzLT5zaG93X2FuZ2xlX2xhYmVsID0gJGFGbGc7CiAgICB9CgogICAgZnVuY3Rpb24gU2hvd0dyaWQoJGFNYWpvcj10cnVlLCRhTWlub3I9ZmFsc2UsJGFBbmdsZT10cnVlKSB7CiAgICAgICAgJHRoaXMtPnNob3dfbWlub3JfZ3JpZCA9ICRhTWlub3I7CiAgICAgICAgJHRoaXMtPnNob3dfbWFqb3JfZ3JpZCA9ICRhTWFqb3I7CiAgICAgICAgJHRoaXMtPnNob3dfYW5nbGVfZ3JpZCA9ICRhQW5nbGUgOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldEFuZ2xlRm9udCgkYUZvbnRGYW0sJGFGb250U3R5bGU9RlNfTk9STUFMLCRhRm9udFNpemU9MTApIHsKICAgICAgICAkdGhpcy0+YW5nbGVfZm9udGZhbSA9ICRhRm9udEZhbTsKICAgICAgICAkdGhpcy0+YW5nbGVfZm9udHN0eWxlID0gJGFGb250U3R5bGU7CiAgICAgICAgJHRoaXMtPmFuZ2xlX2ZvbnRzaXplID0gJGFGb250U2l6ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRDb2xvcigkYUNvbG9yLCRhUmFkQ29sb3I9JycsJGFBbmdsZUNvbG9yPScnKSB7CiAgICAgICAgaWYoICRhQW5nbGVDb2xvciA9PSAnJyApCiAgICAgICAgJGFBbmdsZUNvbG9yPSRhQ29sb3I7CiAgICAgICAgcGFyZW50OjpTZXRDb2xvcigkYUNvbG9yLCRhUmFkQ29sb3IpOwogICAgICAgICR0aGlzLT5hbmdsZV9mb250Y29sb3IgPSAkYUFuZ2xlQ29sb3I7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0R3JpZENvbG9yKCRhTWFqb3JDb2xvciwkYU1pbm9yQ29sb3I9JycsJGFBbmdsZUNvbG9yPScnKSB7CiAgICAgICAgaWYoICRhTWlub3JDb2xvciA9PSAnJyApCiAgICAgICAgJGFNaW5vckNvbG9yID0gJGFNYWpvckNvbG9yOwogICAgICAgIGlmKCAkYUFuZ2xlQ29sb3IgPT0gJycgKQogICAgICAgICRhQW5nbGVDb2xvciA9ICRhTWFqb3JDb2xvcjsKCiAgICAgICAgJHRoaXMtPmdyaWRtaW5vcl9jb2xvciA9ICRhTWlub3JDb2xvcjsKICAgICAgICAkdGhpcy0+Z3JpZG1ham9yX2NvbG9yID0gJGFNYWpvckNvbG9yOwogICAgICAgICR0aGlzLT5hbmdsZV9jb2xvciA9ICRhQW5nbGVDb2xvcjsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRUaWNrQ29sb3JzKCRhUmFkQ29sb3IsJGFBbmdsZUNvbG9yPScnKSB7CiAgICAgICAgJHRoaXMtPnJhZGl1c190aWNrX2NvbG9yID0gJGFSYWRDb2xvcjsKICAgICAgICAkdGhpcy0+YW5nbGVfdGlja19jb2xvciA9ICRhQW5nbGVDb2xvcjsKICAgIH0KCiAgICAvLyBQcml2YXRlIG1ldGhvZHMKICAgIGZ1bmN0aW9uIFN0cm9rZUdyaWQoJHBvcykgewogICAgICAgICR4ID0gcm91bmQoJHRoaXMtPmltZy0+bGVmdF9tYXJnaW4gKyAkdGhpcy0+aW1nLT5wbG90d2lkdGgvMik7CiAgICAgICAgJHRoaXMtPnNjYWxlLT50aWNrcy0+U3Ryb2tlKCR0aGlzLT5pbWcsJHRoaXMtPnNjYWxlLCRwb3MpOwoKICAgICAgICAvLyBTdHJva2UgdGhlIG1pbm9yIGFyY3MKICAgICAgICAkcG1pbiA9IGFycmF5KCk7CiAgICAgICAgJHAgPSAkdGhpcy0+c2NhbGUtPnRpY2tzLT50aWNrc19wb3M7CiAgICAgICAgJG4gPSBjb3VudCgkcCk7CiAgICAgICAgJGkgPSAwOwogICAgICAgICR0aGlzLT5pbWctPlNldENvbG9yKCR0aGlzLT5ncmlkbWlub3JfY29sb3IpOwogICAgICAgIHdoaWxlKCAkaSA8ICRuICkgewogICAgICAgICAgICAkciA9ICRwWyRpXS0keCsxOwogICAgICAgICAgICAkcG1pbltdPSRyOwogICAgICAgICAgICBpZiggJHRoaXMtPnNob3dfbWlub3JfZ3JpZCApIHsKICAgICAgICAgICAgICAgICR0aGlzLT5pbWctPkNpcmNsZSgkeCwkcG9zLCRyKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAkaSsrOwogICAgICAgIH0KCiAgICAgICAgJGxpbWl0ID0gbWF4KCR0aGlzLT5pbWctPnBsb3R3aWR0aCwkdGhpcy0+aW1nLT5wbG90aGVpZ2h0KSoxLjQgOwogICAgICAgIHdoaWxlKCAkciA8ICRsaW1pdCApIHsKICAgICAgICAgICAgJG9mZiA9ICRyOwogICAgICAgICAgICAkaT0xOwogICAgICAgICAgICAkciA9ICRvZmYgKyByb3VuZCgkcFskaV0tJHgrMSk7CiAgICAgICAgICAgIHdoaWxlKCAkciA8ICRsaW1pdCAmJiAkaSA8ICRuICkgewogICAgICAgICAgICAgICAgJHIgPSAkb2ZmKyRwWyRpXS0keDsKICAgICAgICAgICAgICAgICRwbWluW109JHI7CiAgICAgICAgICAgICAgICBpZiggJHRoaXMtPnNob3dfbWlub3JfZ3JpZCApIHsKICAgICAgICAgICAgICAgICAgICAkdGhpcy0+aW1nLT5DaXJjbGUoJHgsJHBvcywkcik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkaSsrOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBTdHJva2UgdGhlIG1ham9yIGFyY3MKICAgICAgICBpZiggJHRoaXMtPnNob3dfbWFqb3JfZ3JpZCApIHsKICAgICAgICAgICAgLy8gRmlyc3QgZGV0ZXJtaW5lIGhvdyBtYW55IG1pbm9yIHN0ZXAgb24KICAgICAgICAgICAgLy8gZXZlcnkgbWFqb3Igc3RlcC4gV2UgaGF2ZSByZWNvcmRlZCB0aGUgbWlub3IgcmFkaXVzCiAgICAgICAgICAgIC8vIGluIHBtaW4gYW5kIHVzZSB0aGVzZSB2YWx1ZXMuIFRoaXMgaXMgZG9uZSBpbiBvcmRlcgogICAgICAgICAgICAvLyB0byBhdm9pZCByb3VuZGluZyBlcnJvcnMgaWYgd2Ugd2VyZSB0byByZWNhbGN1bGF0ZSB0aGUKICAgICAgICAgICAgLy8gZGlmZmVyZW50IG1ham9yIHJhZGl1cy4KICAgICAgICAgICAgJHBtYWogPSAkdGhpcy0+c2NhbGUtPnRpY2tzLT5tYWpfdGlja3NfcG9zOwogICAgICAgICAgICAkcCA9ICR0aGlzLT5zY2FsZS0+dGlja3MtPnRpY2tzX3BvczsKICAgICAgICAgICAgaWYoICR0aGlzLT5zY2FsZS0+bmFtZSA9PSAnbGluJyApIHsKICAgICAgICAgICAgICAgICRzdGVwPXJvdW5kKCgkcG1halsxXSAtICRwbWFqWzBdKS8oJHBbMV0gLSAkcFswXSkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgJHN0ZXA9OTsKICAgICAgICAgICAgfQogICAgICAgICAgICAkbiA9IHJvdW5kKGNvdW50KCRwbWluKS8kc3RlcCk7CiAgICAgICAgICAgICRpID0gMDsKICAgICAgICAgICAgJHRoaXMtPmltZy0+U2V0Q29sb3IoJHRoaXMtPmdyaWRtYWpvcl9jb2xvcik7CiAgICAgICAgICAgICRsaW1pdCA9IG1heCgkdGhpcy0+aW1nLT5wbG90d2lkdGgsJHRoaXMtPmltZy0+cGxvdGhlaWdodCkqMS40IDsKICAgICAgICAgICAgJG9mZiA9ICRyOwogICAgICAgICAgICAkaT0wOwogICAgICAgICAgICAkciA9ICRwbWluWyRpKiRzdGVwXTsKICAgICAgICAgICAgd2hpbGUoICRyIDwgJGxpbWl0ICYmICRpIDwgJG4gKSB7CiAgICAgICAgICAgICAgICAkciA9ICRwbWluWyRpKiRzdGVwXTsKICAgICAgICAgICAgICAgICR0aGlzLT5pbWctPkNpcmNsZSgkeCwkcG9zLCRyKTsKICAgICAgICAgICAgICAgICRpKys7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIERyYXcgYW5nbGVzCiAgICAgICAgaWYoICR0aGlzLT5zaG93X2FuZ2xlX2dyaWQgKSB7CiAgICAgICAgICAgICR0aGlzLT5pbWctPlNldENvbG9yKCR0aGlzLT5hbmdsZV9jb2xvcik7CiAgICAgICAgICAgICRkID0gbWF4KCR0aGlzLT5pbWctPnBsb3RoZWlnaHQsJHRoaXMtPmltZy0+cGxvdHdpZHRoKSoxLjQgOwogICAgICAgICAgICAkYSA9IDA7CiAgICAgICAgICAgICRwID0gJHRoaXMtPnNjYWxlLT50aWNrcy0+dGlja3NfcG9zOwogICAgICAgICAgICAkc3RhcnRfcmFkaXVzID0gJHBbMV0tJHg7CiAgICAgICAgICAgIHdoaWxlKCAkYSA8IDM2MCApIHsKICAgICAgICAgICAgICAgIGlmKCAkYSA9PSA5MCB8fCAkYSA9PSAyNzAgKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gTWFrZSBzdXJlIHRoZXJlIGFyZSBubyByb3VuZGluZyBwcm9ibGVtIHdpdGgKICAgICAgICAgICAgICAgICAgICAvLyBleGFjdGx5IHZlcnRpY2FsIGxpbmVzCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmltZy0+TGluZSgkeCskc3RhcnRfcmFkaXVzKmNvcygkYS8xODAqTV9QSSkrMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRwb3MtJHN0YXJ0X3JhZGl1cypzaW4oJGEvMTgwKk1fUEkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHgrJHN0YXJ0X3JhZGl1cypjb3MoJGEvMTgwKk1fUEkpKzEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcG9zLSRkKnNpbigkYS8xODAqTV9QSSkpOwoKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICR0aGlzLT5pbWctPkxpbmUoJHgrJHN0YXJ0X3JhZGl1cypjb3MoJGEvMTgwKk1fUEkpKzEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcG9zLSRzdGFydF9yYWRpdXMqc2luKCRhLzE4MCpNX1BJKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR4KyRkKmNvcygkYS8xODAqTV9QSSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcG9zLSRkKnNpbigkYS8xODAqTV9QSSkpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJGEgKz0gJHRoaXMtPmFuZ2xlX3N0ZXA7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gU3Ryb2tlQW5nbGVMYWJlbHMoJHBvcywkdHlwZSkgewoKICAgICAgICBpZiggISR0aGlzLT5zaG93X2FuZ2xlX2xhYmVsICkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICAkeDAgPSByb3VuZCgkdGhpcy0+aW1nLT5sZWZ0X21hcmdpbiskdGhpcy0+aW1nLT5wbG90d2lkdGgvMikrMTsKCiAgICAgICAgJGQgPSBtYXgoJHRoaXMtPmltZy0+cGxvdHdpZHRoLCR0aGlzLT5pbWctPnBsb3RoZWlnaHQpKjEuNDI7CiAgICAgICAgJGEgPSAkdGhpcy0+YW5nbGVfc3RlcDsKICAgICAgICAkdCA9IG5ldyBUZXh0KCk7CiAgICAgICAgJHQtPlNldENvbG9yKCR0aGlzLT5hbmdsZV9mb250Y29sb3IpOwogICAgICAgICR0LT5TZXRGb250KCR0aGlzLT5hbmdsZV9mb250ZmFtLCR0aGlzLT5hbmdsZV9mb250c3R5bGUsJHRoaXMtPmFuZ2xlX2ZvbnRzaXplKTsKICAgICAgICAkeHJpZ2h0ID0gJHRoaXMtPmltZy0+d2lkdGggLSAkdGhpcy0+aW1nLT5yaWdodF9tYXJnaW47CiAgICAgICAgJHl0b3AgPSAkdGhpcy0+aW1nLT50b3BfbWFyZ2luOwogICAgICAgICR4bGVmdCA9ICR0aGlzLT5pbWctPmxlZnRfbWFyZ2luOwogICAgICAgICR5Ym90dG9tID0gJHRoaXMtPmltZy0+aGVpZ2h0IC0gJHRoaXMtPmltZy0+Ym90dG9tX21hcmdpbjsKICAgICAgICAkaGEgPSAnbGVmdCc7CiAgICAgICAgJHZhID0gJ2NlbnRlcic7CiAgICAgICAgJHcgPSAkdGhpcy0+aW1nLT5wbG90d2lkdGgvMjsKICAgICAgICAkaCA9ICR0aGlzLT5pbWctPnBsb3RoZWlnaHQvMjsKICAgICAgICAkeHQgPSAkeDA7ICR5dCA9ICRwb3M7CiAgICAgICAgJG1hcmdpbj01OwoKICAgICAgICAkdGwgID0gJHRoaXMtPmFuZ2xlX3RpY2tfbGVuIDsgLy8gT3V0ZXIgbGVuCiAgICAgICAgJHRsMiA9ICR0aGlzLT5hbmdsZV90aWNrX2xlbjIgOyAvLyBJbnRlcmlvciBsZW4KCiAgICAgICAgJHRoaXMtPmltZy0+U2V0Q29sb3IoJHRoaXMtPmFuZ2xlX3RpY2tfY29sb3IpOwogICAgICAgICRyb3Q5MCA9ICR0aGlzLT5pbWctPmEgPT0gOTAgOwoKICAgICAgICBpZiggJHR5cGUgPT0gUE9MQVJfMzYwICkgewoKICAgICAgICAgICAgLy8gQ29ybmVyIGFuZ2xlcyBvZiB0aGUgZm91ciBjb3JuZXJzCiAgICAgICAgICAgICRjYTEgPSBhdGFuKCRoLyR3KS9NX1BJKjE4MDsKICAgICAgICAgICAgJGNhMiA9IDE4MC0kY2ExOwogICAgICAgICAgICAkY2EzID0gJGNhMSsxODA7CiAgICAgICAgICAgICRjYTQgPSAzNjAtJGNhMTsKICAgICAgICAgICAgJGVuZCA9IDM2MDsKCiAgICAgICAgICAgIHdoaWxlKCAkYSA8ICRlbmQgKSB7CiAgICAgICAgICAgICAgICAkY2EgPSBjb3MoJGEvMTgwKk1fUEkpOwogICAgICAgICAgICAgICAgJHNhID0gc2luKCRhLzE4MCpNX1BJKTsKICAgICAgICAgICAgICAgICR4ID0gJGQqJGNhOwogICAgICAgICAgICAgICAgJHkgPSAkZCokc2E7CiAgICAgICAgICAgICAgICAkeHQ9MTAwMDskeXQ9MTAwMDsKICAgICAgICAgICAgICAgIGlmKCAkYSA8PSAkY2ExIHx8ICRhID49ICRjYTQgKSB7CiAgICAgICAgICAgICAgICAgICAgJHl0ID0gJHBvcyAtICR3ICogJHkvJHg7CiAgICAgICAgICAgICAgICAgICAgJHh0ID0gJHhyaWdodCArICRtYXJnaW47CiAgICAgICAgICAgICAgICAgICAgaWYoICRyb3Q5MCApIHsKICAgICAgICAgICAgICAgICAgICAgICAgJGhhID0gJ2NlbnRlcic7CiAgICAgICAgICAgICAgICAgICAgICAgICR2YSA9ICd0b3AnOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgJGhhID0gJ2xlZnQnOwogICAgICAgICAgICAgICAgICAgICAgICAkdmEgPSAnY2VudGVyJzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJHgxPSR4cmlnaHQtJHRsMjsgJHgyPSR4cmlnaHQrJHRsOwogICAgICAgICAgICAgICAgICAgICR5MT0keTI9JHl0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZWlmKCAkYSA+ICRjYTEgJiYgJGEgPCAkY2EyICkgewogICAgICAgICAgICAgICAgICAgICR4dCA9ICR4MCArICRoICogJHgvJHk7CiAgICAgICAgICAgICAgICAgICAgJHl0ID0gJHl0b3AgLSAkbWFyZ2luOwogICAgICAgICAgICAgICAgICAgIGlmKCAkcm90OTAgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRoYSA9ICdsZWZ0JzsKICAgICAgICAgICAgICAgICAgICAgICAgJHZhID0gJ2NlbnRlcic7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAkaGEgPSAnY2VudGVyJzsKICAgICAgICAgICAgICAgICAgICAgICAgJHZhID0gJ2JvdHRvbSc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICR5MT0keXRvcCskdGwyOyR5Mj0keXRvcC0kdGw7CiAgICAgICAgICAgICAgICAgICAgJHgxPSR4Mj0keHQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlaWYoICRhID49ICRjYTIgJiYgJGEgPD0gJGNhMyApIHsKICAgICAgICAgICAgICAgICAgICAkeXQgPSAkcG9zICsgJHcgKiAkeS8keDsKICAgICAgICAgICAgICAgICAgICAkeHQgPSAkeGxlZnQgLSAkbWFyZ2luOwogICAgICAgICAgICAgICAgICAgIGlmKCAkcm90OTAgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRoYSA9ICdjZW50ZXInOwogICAgICAgICAgICAgICAgICAgICAgICAkdmEgPSAnYm90dG9tJzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRoYSA9ICdyaWdodCc7CiAgICAgICAgICAgICAgICAgICAgICAgICR2YSA9ICdjZW50ZXInOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAkeDE9JHhsZWZ0KyR0bDI7JHgyPSR4bGVmdC0kdGw7CiAgICAgICAgICAgICAgICAgICAgJHkxPSR5Mj0keXQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkeHQgPSAkeDAgLSAkaCAqICR4LyR5OwogICAgICAgICAgICAgICAgICAgICR5dCA9ICR5Ym90dG9tICsgJG1hcmdpbjsKICAgICAgICAgICAgICAgICAgICBpZiggJHJvdDkwICkgewogICAgICAgICAgICAgICAgICAgICAgICAkaGEgPSAncmlnaHQnOwogICAgICAgICAgICAgICAgICAgICAgICAkdmEgPSAnY2VudGVyJzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRoYSA9ICdjZW50ZXInOwogICAgICAgICAgICAgICAgICAgICAgICAkdmEgPSAndG9wJzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJHkxPSR5Ym90dG9tLSR0bDI7JHkyPSR5Ym90dG9tKyR0bDsKICAgICAgICAgICAgICAgICAgICAkeDE9JHgyPSR4dDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKCAkYSAhPSAwICYmICRhICE9IDE4MCApIHsKICAgICAgICAgICAgICAgICAgICAkdC0+QWxpZ24oJGhhLCR2YSk7CiAgICAgICAgICAgICAgICAgICAgaWYoICR0aGlzLT5zY2FsZS0+Y2xvY2t3aXNlICkgewogICAgICAgICAgICAgICAgICAgICAgICAkdC0+U2V0KDM2MC0kYSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAkdC0+U2V0KCRhKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYoICR0aGlzLT5zaG93X2FuZ2xlX21hcmsgJiYgJHQtPmZvbnRfZmFtaWx5ID4gNCApIHsKICAgICAgICAgICAgICAgICAgICAgICAgJGEgLj0gU3ltQ2hhcjo6R2V0KCdkZWdyZWUnKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJHQtPlN0cm9rZSgkdGhpcy0+aW1nLCR4dCwkeXQpOwogICAgICAgICAgICAgICAgICAgIGlmKCAkdGhpcy0+c2hvd19hbmdsZV90aWNrICkgewogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+aW1nLT5MaW5lKCR4MSwkeTEsJHgyLCR5Mik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJGEgKz0gJHRoaXMtPmFuZ2xlX3N0ZXA7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIC8vIFBPTEFSX0hBTEYKICAgICAgICAgICAgJGNhMSA9IGF0YW4oJGgvJHcqMikvTV9QSSoxODA7CiAgICAgICAgICAgICRjYTIgPSAxODAtJGNhMTsKICAgICAgICAgICAgJGVuZCA9IDE4MDsKICAgICAgICAgICAgd2hpbGUoICRhIDwgJGVuZCApIHsKICAgICAgICAgICAgICAgICRjYSA9IGNvcygkYS8xODAqTV9QSSk7CiAgICAgICAgICAgICAgICAkc2EgPSBzaW4oJGEvMTgwKk1fUEkpOwogICAgICAgICAgICAgICAgJHggPSAkZCokY2E7CiAgICAgICAgICAgICAgICAkeSA9ICRkKiRzYTsKICAgICAgICAgICAgICAgIGlmKCAkYSA8PSAkY2ExICkgewogICAgICAgICAgICAgICAgICAgICR5dCA9ICRwb3MgLSAkdyAqICR5LyR4OwogICAgICAgICAgICAgICAgICAgICR4dCA9ICR4cmlnaHQgKyAkbWFyZ2luOwogICAgICAgICAgICAgICAgICAgIGlmKCAkcm90OTAgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRoYSA9ICdjZW50ZXInOwogICAgICAgICAgICAgICAgICAgICAgICAkdmEgPSAndG9wJzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRoYSA9ICdsZWZ0JzsKICAgICAgICAgICAgICAgICAgICAgICAgJHZhID0gJ2NlbnRlcic7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICR4MT0keHJpZ2h0LSR0bDI7ICR4Mj0keHJpZ2h0KyR0bDsKICAgICAgICAgICAgICAgICAgICAkeTE9JHkyPSR5dDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2VpZiggJGEgPiAkY2ExICYmICRhIDwgJGNhMiApIHsKICAgICAgICAgICAgICAgICAgICAkeHQgPSAkeDAgKyAyKiRoICogJHgvJHk7CiAgICAgICAgICAgICAgICAgICAgJHl0ID0gJHl0b3AgLSAkbWFyZ2luOwogICAgICAgICAgICAgICAgICAgIGlmKCAkcm90OTAgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRoYSA9ICdsZWZ0JzsKICAgICAgICAgICAgICAgICAgICAgICAgJHZhID0gJ2NlbnRlcic7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAkaGEgPSAnY2VudGVyJzsKICAgICAgICAgICAgICAgICAgICAgICAgJHZhID0gJ2JvdHRvbSc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICR5MT0keXRvcCskdGwyOyR5Mj0keXRvcC0kdGw7CiAgICAgICAgICAgICAgICAgICAgJHgxPSR4Mj0keHQ7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlaWYoICRhID49ICRjYTIgKSB7CiAgICAgICAgICAgICAgICAgICAgJHl0ID0gJHBvcyArICR3ICogJHkvJHg7CiAgICAgICAgICAgICAgICAgICAgJHh0ID0gJHhsZWZ0IC0gJG1hcmdpbjsKICAgICAgICAgICAgICAgICAgICBpZiggJHJvdDkwICkgewogICAgICAgICAgICAgICAgICAgICAgICAkaGEgPSAnY2VudGVyJzsKICAgICAgICAgICAgICAgICAgICAgICAgJHZhID0gJ2JvdHRvbSc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAkaGEgPSAncmlnaHQnOwogICAgICAgICAgICAgICAgICAgICAgICAkdmEgPSAnY2VudGVyJzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJHgxPSR4bGVmdCskdGwyOyR4Mj0keGxlZnQtJHRsOwogICAgICAgICAgICAgICAgICAgICR5MT0keTI9JHl0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJHQtPkFsaWduKCRoYSwkdmEpOwogICAgICAgICAgICAgICAgaWYoICR0aGlzLT5zaG93X2FuZ2xlX21hcmsgJiYgJHQtPmZvbnRfZmFtaWx5ID4gNCApIHsKICAgICAgICAgICAgICAgIAkkYSAuPSBTeW1DaGFyOjpHZXQoJ2RlZ3JlZScpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJHQtPlNldCgkYSk7CiAgICAgICAgICAgICAgICAkdC0+U3Ryb2tlKCR0aGlzLT5pbWcsJHh0LCR5dCk7CiAgICAgICAgICAgICAgICBpZiggJHRoaXMtPnNob3dfYW5nbGVfdGljayApIHsKICAgICAgICAgICAgICAgICAgICAkdGhpcy0+aW1nLT5MaW5lKCR4MSwkeTEsJHgyLCR5Mik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkYSArPSAkdGhpcy0+YW5nbGVfc3RlcDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBTdHJva2UoJHBvcywkZHVtbXk9dHJ1ZSkgewoKICAgICAgICAkdGhpcy0+aW1nLT5TZXRMaW5lV2VpZ2h0KCR0aGlzLT53ZWlnaHQpOwogICAgICAgICR0aGlzLT5pbWctPlNldENvbG9yKCR0aGlzLT5jb2xvcik7CiAgICAgICAgJHRoaXMtPmltZy0+U2V0Rm9udCgkdGhpcy0+Zm9udF9mYW1pbHksJHRoaXMtPmZvbnRfc3R5bGUsJHRoaXMtPmZvbnRfc2l6ZSk7CiAgICAgICAgaWYoICEkdGhpcy0+aGlkZV9saW5lICkgewogICAgICAgICAgICAkdGhpcy0+aW1nLT5GaWxsZWRSZWN0YW5nbGUoJHRoaXMtPmltZy0+bGVmdF9tYXJnaW4sJHBvcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5pbWctPndpZHRoLSR0aGlzLT5pbWctPnJpZ2h0X21hcmdpbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRwb3MrJHRoaXMtPndlaWdodC0xKTsKICAgICAgICB9CiAgICAgICAgJHk9JHBvcyskdGhpcy0+aW1nLT5HZXRGb250SGVpZ2h0KCkrJHRoaXMtPnRpdGxlX21hcmdpbiskdGhpcy0+dGl0bGUtPm1hcmdpbjsKICAgICAgICBpZiggJHRoaXMtPnRpdGxlX2FkanVzdD09ImhpZ2giICkgewogICAgICAgICAgICAkdGhpcy0+dGl0bGUtPlNldFBvcygkdGhpcy0+aW1nLT53aWR0aC0kdGhpcy0+aW1nLT5yaWdodF9tYXJnaW4sJHksInJpZ2h0IiwidG9wIik7CiAgICAgICAgfQogICAgICAgIGVsc2VpZiggJHRoaXMtPnRpdGxlX2FkanVzdD09Im1pZGRsZSIgfHwgJHRoaXMtPnRpdGxlX2FkanVzdD09ImNlbnRlciIgKSB7CiAgICAgICAgICAgICR0aGlzLT50aXRsZS0+U2V0UG9zKCgkdGhpcy0+aW1nLT53aWR0aC0kdGhpcy0+aW1nLT5sZWZ0X21hcmdpbi0kdGhpcy0+aW1nLT5yaWdodF9tYXJnaW4pLzIrJHRoaXMtPmltZy0+bGVmdF9tYXJnaW4sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHksImNlbnRlciIsInRvcCIpOwogICAgICAgIH0KICAgICAgICBlbHNlaWYoJHRoaXMtPnRpdGxlX2FkanVzdD09ImxvdyIpIHsKICAgICAgICAgICAgJHRoaXMtPnRpdGxlLT5TZXRQb3MoJHRoaXMtPmltZy0+bGVmdF9tYXJnaW4sJHksImxlZnQiLCJ0b3AiKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDE3MDAyLCR0aGlzLT50aXRsZV9hZGp1c3QpOwogICAgICAgICAgICAvLygnVW5rbm93biBhbGlnbm1lbnQgc3BlY2lmaWVkIGZvciBYLWF4aXMgdGl0bGUuICgnLiR0aGlzLT50aXRsZV9hZGp1c3QuJyknKTsKICAgICAgICB9CgoKICAgICAgICBpZiAoISR0aGlzLT5oaWRlX2xhYmVscykgewogICAgICAgICAgICAkdGhpcy0+U3Ryb2tlTGFiZWxzKCRwb3MsZmFsc2UpOwogICAgICAgIH0KICAgICAgICAkdGhpcy0+aW1nLT5TZXRDb2xvcigkdGhpcy0+cmFkaXVzX3RpY2tfY29sb3IpOwogICAgICAgICR0aGlzLT5zY2FsZS0+dGlja3MtPlN0cm9rZSgkdGhpcy0+aW1nLCR0aGlzLT5zY2FsZSwkcG9zKTsKCiAgICAgICAgLy8KICAgICAgICAvLyBNaXJyb3IgdGhlIHBvc2l0aW9ucyBmb3IgdGhlIGxlZnQgc2lkZSBvZiB0aGUgc2NhbGUKICAgICAgICAvLwogICAgICAgICRtaWQgPSAyKigkdGhpcy0+aW1nLT5sZWZ0X21hcmdpbiskdGhpcy0+aW1nLT5wbG90d2lkdGgvMik7CiAgICAgICAgJG4gPSBjb3VudCgkdGhpcy0+c2NhbGUtPnRpY2tzLT50aWNrc19wb3MpOwogICAgICAgICRpPTA7CiAgICAgICAgd2hpbGUoICRpIDwgJG4gKSB7CiAgICAgICAgICAgICR0aGlzLT5zY2FsZS0+dGlja3MtPnRpY2tzX3Bvc1skaV0gPQogICAgICAgICAgICAkbWlkLSR0aGlzLT5zY2FsZS0+dGlja3MtPnRpY2tzX3Bvc1skaV0gOwogICAgICAgICAgICArKyRpOwogICAgICAgIH0KCiAgICAgICAgJG4gPSBjb3VudCgkdGhpcy0+c2NhbGUtPnRpY2tzLT5tYWpfdGlja3NfcG9zKTsKICAgICAgICAkaT0wOwogICAgICAgIHdoaWxlKCAkaSA8ICRuICkgewogICAgICAgICAgICAkdGhpcy0+c2NhbGUtPnRpY2tzLT5tYWpfdGlja3NfcG9zWyRpXSA9CiAgICAgICAgICAgICRtaWQtJHRoaXMtPnNjYWxlLT50aWNrcy0+bWFqX3RpY2tzX3Bvc1skaV0gOwogICAgICAgICAgICArKyRpOwogICAgICAgIH0KCiAgICAgICAgJG4gPSBjb3VudCgkdGhpcy0+c2NhbGUtPnRpY2tzLT5tYWpfdGlja2xhYmVsc19wb3MpOwogICAgICAgICRpPTE7CiAgICAgICAgd2hpbGUoICRpIDwgJG4gKSB7CiAgICAgICAgICAgICR0aGlzLT5zY2FsZS0+dGlja3MtPm1hal90aWNrbGFiZWxzX3Bvc1skaV0gPQogICAgICAgICAgICAkbWlkLSR0aGlzLT5zY2FsZS0+dGlja3MtPm1hal90aWNrbGFiZWxzX3Bvc1skaV0gOwogICAgICAgICAgICArKyRpOwogICAgICAgIH0KCiAgICAgICAgLy8gRHJhdyB0aGUgbGVmdCBzaWRlIG9mIHRoZSBzY2FsZQogICAgICAgICRuID0gY291bnQoJHRoaXMtPnNjYWxlLT50aWNrcy0+dGlja3NfcG9zKTsKICAgICAgICAkeXUgPSAkcG9zIC0gJHRoaXMtPnNjYWxlLT50aWNrcy0+ZGlyZWN0aW9uKiR0aGlzLT5zY2FsZS0+dGlja3MtPkdldE1pblRpY2tBYnNTaXplKCk7CgoKICAgICAgICAvLyBNaW5vciB0aWNrcwogICAgICAgIGlmKCAhICR0aGlzLT5zY2FsZS0+dGlja3MtPnN1cHJlc3NfbWlub3JfdGlja21hcmtzICkgewogICAgICAgICAgICAkaT0xOwogICAgICAgICAgICB3aGlsZSggJGkgPCAkbi8yICkgewogICAgICAgICAgICAgICAgJHggPSByb3VuZCgkdGhpcy0+c2NhbGUtPnRpY2tzLT50aWNrc19wb3NbJGldKSA7CiAgICAgICAgICAgICAgICAkdGhpcy0+aW1nLT5MaW5lKCR4LCRwb3MsJHgsJHl1KTsKICAgICAgICAgICAgICAgICsrJGk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICRuID0gY291bnQoJHRoaXMtPnNjYWxlLT50aWNrcy0+bWFqX3RpY2tzX3Bvcyk7CiAgICAgICAgJHl1ID0gJHBvcyAtICR0aGlzLT5zY2FsZS0+dGlja3MtPmRpcmVjdGlvbiokdGhpcy0+c2NhbGUtPnRpY2tzLT5HZXRNYWpUaWNrQWJzU2l6ZSgpOwoKCiAgICAgICAgLy8gTWFqb3IgdGlja3MKICAgICAgICBpZiggISAkdGhpcy0+c2NhbGUtPnRpY2tzLT5zdXByZXNzX3RpY2ttYXJrcyApIHsKICAgICAgICAgICAgJGk9MTsKICAgICAgICAgICAgd2hpbGUoICRpIDwgJG4vMiApIHsKICAgICAgICAgICAgICAgICR4ID0gcm91bmQoJHRoaXMtPnNjYWxlLT50aWNrcy0+bWFqX3RpY2tzX3Bvc1skaV0pIDsKICAgICAgICAgICAgICAgICR0aGlzLT5pbWctPkxpbmUoJHgsJHBvcywkeCwkeXUpOwogICAgICAgICAgICAgICAgKyskaTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoISR0aGlzLT5oaWRlX2xhYmVscykgewogICAgICAgICAgICAkdGhpcy0+U3Ryb2tlTGFiZWxzKCRwb3MsZmFsc2UpOwogICAgICAgIH0KICAgICAgICAkdGhpcy0+dGl0bGUtPlN0cm9rZSgkdGhpcy0+aW1nKTsKICAgIH0KfQoKY2xhc3MgUG9sYXJTY2FsZSBleHRlbmRzIExpbmVhclNjYWxlIHsKICAgIHByaXZhdGUgJGdyYXBoOwogICAgcHVibGljICRjbG9ja3dpc2U9ZmFsc2U7CgogICAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGFNYXgsJGdyYXBoLCRhQ2xvY2t3aXNlKSB7CiAgICAgICAgcGFyZW50OjpfX2NvbnN0cnVjdCgwLCRhTWF4LCd4Jyk7CiAgICAgICAgJHRoaXMtPmdyYXBoID0gJGdyYXBoOwogICAgICAgICR0aGlzLT5jbG9ja3dpc2UgPSAkYUNsb2Nrd2lzZTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRDbG9ja3dpc2UoJGFGbGcpIHsKICAgICAgICAkdGhpcy0+Y2xvY2t3aXNlID0gJGFGbGc7CiAgICB9CgogICAgZnVuY3Rpb24gX1RyYW5zbGF0ZSgkdikgewogICAgICAgIHJldHVybiBwYXJlbnQ6OlRyYW5zbGF0ZSgkdik7CiAgICB9CgogICAgZnVuY3Rpb24gUFRyYW5zbGF0ZSgkYUFuZ2xlLCRhUmFkKSB7CgogICAgICAgICRtID0gJHRoaXMtPnNjYWxlWzFdOwogICAgICAgICR3ID0gJHRoaXMtPmdyYXBoLT5pbWctPnBsb3R3aWR0aC8yOwogICAgICAgICRhUmFkID0gJGFSYWQvJG0qJHc7CgogICAgICAgICRhID0gJGFBbmdsZS8xODAgKiBNX1BJOwogICAgICAgIGlmKCAkdGhpcy0+Y2xvY2t3aXNlICkgeyAKICAgICAgICAgICAgJGEgPSAyKk1fUEktJGE7CiAgICAgICAgfQoKICAgICAgICAkeCA9IGNvcygkYSkgKiAkYVJhZDsKICAgICAgICAkeSA9IHNpbigkYSkgKiAkYVJhZDsKCiAgICAgICAgJHggKz0gJHRoaXMtPl9UcmFuc2xhdGUoMCk7CgogICAgICAgIGlmKCAkdGhpcy0+Z3JhcGgtPmlUeXBlID09IFBPTEFSXzM2MCApIHsKICAgICAgICAgICAgJHkgPSAoJHRoaXMtPmdyYXBoLT5pbWctPnRvcF9tYXJnaW4gKyAkdGhpcy0+Z3JhcGgtPmltZy0+cGxvdGhlaWdodC8yKSAtICR5OwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJHkgPSAoJHRoaXMtPmdyYXBoLT5pbWctPnRvcF9tYXJnaW4gKyAkdGhpcy0+Z3JhcGgtPmltZy0+cGxvdGhlaWdodCkgLSAkeTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGFycmF5KCR4LCR5KTsKICAgIH0KfQoKY2xhc3MgUG9sYXJMb2dTY2FsZSBleHRlbmRzIExvZ1NjYWxlIHsKICAgIHByaXZhdGUgJGdyYXBoOwogICAgcHVibGljICRjbG9ja3dpc2U9ZmFsc2U7CgogICAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGFNYXgsJGdyYXBoLCRhQ2xvY2t3aXNlPWZhbHNlKSB7CiAgICAgICAgcGFyZW50OjpfX2NvbnN0cnVjdCgwLCRhTWF4LCd4Jyk7CiAgICAgICAgJHRoaXMtPmdyYXBoID0gJGdyYXBoOwogICAgICAgICR0aGlzLT50aWNrcy0+U2V0TGFiZWxMb2dUeXBlKExPR0xBQkVMU19NQUdOSVRVREUpOwogICAgICAgICR0aGlzLT5jbG9ja3dpc2UgPSAkYUNsb2Nrd2lzZTsKCiAgICB9CgogICAgZnVuY3Rpb24gU2V0Q2xvY2t3aXNlKCRhRmxnKSB7CiAgICAgICAgJHRoaXMtPmNsb2Nrd2lzZSA9ICRhRmxnOwogICAgfQoKICAgIGZ1bmN0aW9uIFBUcmFuc2xhdGUoJGFBbmdsZSwkYVJhZCkgewoKICAgICAgICBpZiggJGFSYWQgPT0gMCApCiAgICAgICAgJGFSYWQgPSAxOwogICAgICAgICRhUmFkID0gbG9nMTAoJGFSYWQpOwogICAgICAgICRtID0gJHRoaXMtPnNjYWxlWzFdOwogICAgICAgICR3ID0gJHRoaXMtPmdyYXBoLT5pbWctPnBsb3R3aWR0aC8yOwogICAgICAgICRhUmFkID0gJGFSYWQvJG0qJHc7CgogICAgICAgICRhID0gJGFBbmdsZS8xODAgKiBNX1BJOwogICAgICAgIGlmKCAkdGhpcy0+Y2xvY2t3aXNlICkgewogICAgICAgICAgICAkYSA9IDIqTV9QSS0kYTsKICAgICAgICB9CgogICAgICAgICR4ID0gY29zKCAkYSApICogJGFSYWQ7CiAgICAgICAgJHkgPSBzaW4oICRhICkgKiAkYVJhZDsKCiAgICAgICAgJHggKz0gJHcrJHRoaXMtPmdyYXBoLT5pbWctPmxlZnRfbWFyZ2luOy8vJHRoaXMtPl9UcmFuc2xhdGUoMCk7CiAgICAgICAgaWYoICR0aGlzLT5ncmFwaC0+aVR5cGUgPT0gUE9MQVJfMzYwICkgewogICAgICAgICAgICAkeSA9ICgkdGhpcy0+Z3JhcGgtPmltZy0+dG9wX21hcmdpbiArICR0aGlzLT5ncmFwaC0+aW1nLT5wbG90aGVpZ2h0LzIpIC0gJHk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAkeSA9ICgkdGhpcy0+Z3JhcGgtPmltZy0+dG9wX21hcmdpbiArICR0aGlzLT5ncmFwaC0+aW1nLT5wbG90aGVpZ2h0KSAtICR5OwogICAgICAgIH0KICAgICAgICByZXR1cm4gYXJyYXkoJHgsJHkpOwogICAgfQp9CgpjbGFzcyBQb2xhckdyYXBoIGV4dGVuZHMgR3JhcGggewogICAgcHVibGljICRzY2FsZTsKICAgIHB1YmxpYyAkYXhpczsKICAgIHB1YmxpYyAkaVR5cGU9UE9MQVJfMzYwOwogICAgcHJpdmF0ZSAkaUNsb2Nrd2lzZT1mYWxzZTsKCiAgICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkYVdpZHRoPTMwMCwkYUhlaWdodD0yMDAsJGFDYWNoZWROYW1lPSIiLCRhVGltZU91dD0wLCRhSW5saW5lPXRydWUpIHsKICAgICAgICBwYXJlbnQ6Ol9fY29uc3RydWN0KCRhV2lkdGgsJGFIZWlnaHQsJGFDYWNoZWROYW1lLCRhVGltZU91dCwkYUlubGluZSkgOwogICAgICAgICR0aGlzLT5TZXREZW5zaXR5KFRJQ0tEX0RFTlNFKTsKICAgICAgICAkdGhpcy0+U2V0Qm94KCk7CiAgICAgICAgJHRoaXMtPlNldE1hcmdpbkNvbG9yKCd3aGl0ZScpOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldERlbnNpdHkoJGFEZW5zZSkgewogICAgICAgICR0aGlzLT5TZXRUaWNrRGVuc2l0eShUSUNLRF9OT1JNQUwsJGFEZW5zZSk7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0Q2xvY2t3aXNlKCRhRmxnKSB7CiAgICAgICAgJHRoaXMtPnNjYWxlLT5TZXRDbG9ja3dpc2UoJGFGbGcpOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldDkwQW5kTWFyZ2luKCRsbT0wLCRybT0wLCR0bT0wLCRibT0wKSB7CiAgICAgICAgJGFkaiA9ICgkdGhpcy0+aW1nLT5oZWlnaHQgLSAkdGhpcy0+aW1nLT53aWR0aCkvMjsKICAgICAgICAkdGhpcy0+U2V0QW5nbGUoOTApOwogICAgICAgICRsbTIgPSAtJGFkaiArICgkbG0tJHJtKyR0bSskYm0pLzI7CiAgICAgICAgJHJtMiA9IC0kYWRqICsgKC0kbG0rJHJtKyR0bSskYm0pLzI7CiAgICAgICAgJHRtMiA9ICRhZGogKyAoJHRtLSRibSskbG0rJHJtKS8yOwogICAgICAgICRibTIgPSAkYWRqICsgKC0kdG0rJGJtKyRsbSskcm0pLzI7CiAgICAgICAgJHRoaXMtPlNldE1hcmdpbigkbG0yLCAkcm0yLCAkdG0yLCAkYm0yKTsKICAgICAgICAkdGhpcy0+YXhpcy0+U2V0TGFiZWxBbGlnbigncmlnaHQnLCdjZW50ZXInKTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRTY2FsZSgkYVNjYWxlLCRybWF4PTAsJGR1bW15MT0xLCRkdW1teTI9MSwkZHVtbXkzPTEpIHsKICAgICAgICBpZiggJGFTY2FsZSA9PSAnbGluJyApIHsKICAgICAgICAgICAgJHRoaXMtPnNjYWxlID0gbmV3IFBvbGFyU2NhbGUoJHJtYXgsJHRoaXMsJHRoaXMtPmlDbG9ja3dpc2UpOwogICAgICAgIH0KICAgICAgICBlbHNlaWYoICRhU2NhbGUgPT0gJ2xvZycgKSB7CiAgICAgICAgICAgICR0aGlzLT5zY2FsZSA9IG5ldyBQb2xhckxvZ1NjYWxlKCRybWF4LCR0aGlzLCR0aGlzLT5pQ2xvY2t3aXNlKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDE3MDA0KTsvLygnVW5rbm93biBzY2FsZSB0eXBlIGZvciBwb2xhciBncmFwaC4gTXVzdCBiZSAibGluIiBvciAibG9nIicpOwogICAgICAgIH0KCiAgICAgICAgJHRoaXMtPmF4aXMgPSBuZXcgUG9sYXJBeGlzKCR0aGlzLT5pbWcsJHRoaXMtPnNjYWxlKTsKICAgICAgICAkdGhpcy0+U2V0TWFyZ2luKDQwLDQwLDUwLDQwKTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRUeXBlKCRhVHlwZSkgewogICAgICAgICR0aGlzLT5pVHlwZSA9ICRhVHlwZTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRQbG90U2l6ZSgkdywkaCkgewogICAgICAgICR0aGlzLT5TZXRNYXJnaW4oKCR0aGlzLT5pbWctPndpZHRoLSR3KS8yLCgkdGhpcy0+aW1nLT53aWR0aC0kdykvMiwKICAgICAgICAgICAgICAgICAgICAgICAgICgkdGhpcy0+aW1nLT5oZWlnaHQtJGgpLzIsKCR0aGlzLT5pbWctPmhlaWdodC0kaCkvMik7CiAgICB9CgogICAgLy8gUHJpdmF0ZSBtZXRob2RzCiAgICBmdW5jdGlvbiBHZXRQbG90c01heCgpIHsKICAgICAgICAkbiA9IGNvdW50KCR0aGlzLT5wbG90cyk7CiAgICAgICAgJG0gPSAkdGhpcy0+cGxvdHNbMF0tPk1heCgpOwogICAgICAgICRpPTE7CiAgICAgICAgd2hpbGUoJGkgPCAkbikgewogICAgICAgICAgICAkbSA9IG1heCgkdGhpcy0+cGxvdHNbJGldLT5NYXgoKSwkbSk7CiAgICAgICAgICAgICsrJGk7CiAgICAgICAgfQogICAgICAgIHJldHVybiAkbTsKICAgIH0KCiAgICBmdW5jdGlvbiBTdHJva2UoJGFTdHJva2VGaWxlTmFtZT0iIikgewoKICAgICAgICAvLyBTdGFydCBieSBhZGp1c3RpbmcgdGhlIG1hcmdpbiBzbyB0aGF0IHBvdGVudGlhbCB0aXRsZXMgd2lsbCBmaXQuCiAgICAgICAgJHRoaXMtPkFkanVzdE1hcmdpbnNGb3JUaXRsZXMoKTsKCiAgICAgICAgLy8gSWYgdGhlIGZpbGVuYW1lIGlzIHRoZSBwcmVkZWZpbmVkIHZhbHVlID0gJ19jc2ltX3NwZWNpYWxfJwogICAgICAgIC8vIHdlIGFzc3VtZSB0aGF0IHRoZSBjYWxsIHRvIHN0cm9rZSBvbmx5IG5lZWRzIHRvIGRvIGVub3VnaAogICAgICAgIC8vIHRvIGNvcnJlY3RseSBnZW5lcmF0ZSB0aGUgQ1NJTSBtYXBzLgogICAgICAgIC8vIFdlIHVzZSB0aGlzIHZhcmlhYmxlIHRvIHNraXAgdGhpbmdzIHdlIGRvbid0IHN0cmljdGx5IG5lZWQKICAgICAgICAvLyB0byBkbyB0byBnZW5lcmF0ZSB0aGUgaW1hZ2UgbWFwIHRvIGltcHJvdmUgcGVyZm9ybWFuY2UKICAgICAgICAvLyBhIGJlc3Qgd2UgY2FuLiBUaGVyZWZvciB5b3Ugd2lsbCBzZWUgYSBsb3Qgb2YgdGVzdHMgISRfY3NpbSBpbiB0aGUKICAgICAgICAvLyBjb2RlIGJlbG93LgogICAgICAgICRfY3NpbSA9ICgkYVN0cm9rZUZpbGVOYW1lPT09X0NTSU1fU1BFQ0lBTEZJTEUpOwoKICAgICAgICAvLyBXZSBuZWVkIHRvIGtub3cgaWYgd2UgaGF2ZSBzdHJva2VkIHRoZSBwbG90IGluIHRoZQogICAgICAgIC8vIEdldENTSU1hcmVhcy4gT3RoZXJ3aXNlIHRoZSBDU0lNIGhhc24ndCBiZWVuIGdlbmVyYXRlZAogICAgICAgIC8vIGFuZCBpbiB0aGUgY2FzZSBvZiBHZXRDU0lNIGNhbGxlZCBiZWZvcmUgc3Ryb2tlIHRvIGdlbmVyYXRlCiAgICAgICAgLy8gQ1NJTSB3aXRob3V0IHN0b3JpbmcgYW4gaW1hZ2UgdG8gZGlzayBHZXRDU0lNIG11c3QgY2FsbCBTdHJva2UuCiAgICAgICAgJHRoaXMtPmlIYXNTdHJva2VkID0gdHJ1ZTsKCiAgICAgICAgLy9DaGVjayBpZiB3ZSBzaG91bGQgYXV0b3NjYWxlIGF4aXMKICAgICAgICBpZiggISR0aGlzLT5zY2FsZS0+SXNTcGVjaWZpZWQoKSAmJiBjb3VudCgkdGhpcy0+cGxvdHMpPjAgKSB7CiAgICAgICAgICAgICRtYXggPSAkdGhpcy0+R2V0UGxvdHNNYXgoKTsKICAgICAgICAgICAgJHQxID0gJHRoaXMtPmltZy0+cGxvdHdpZHRoOwogICAgICAgICAgICAkdGhpcy0+aW1nLT5wbG90d2lkdGggLz0gMjsKICAgICAgICAgICAgJHQyID0gJHRoaXMtPmltZy0+bGVmdF9tYXJnaW47CiAgICAgICAgICAgICR0aGlzLT5pbWctPmxlZnRfbWFyZ2luICs9ICR0aGlzLT5pbWctPnBsb3R3aWR0aCsxOwogICAgICAgICAgICAkdGhpcy0+c2NhbGUtPkF1dG9TY2FsZSgkdGhpcy0+aW1nLDAsJG1heCwKICAgICAgICAgICAgJHRoaXMtPmltZy0+cGxvdHdpZHRoLyR0aGlzLT54dGlja19mYWN0b3IvMik7CiAgICAgICAgICAgICR0aGlzLT5pbWctPnBsb3R3aWR0aCA9ICR0MTsKICAgICAgICAgICAgJHRoaXMtPmltZy0+bGVmdF9tYXJnaW4gPSAkdDI7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAvLyBUaGUgdGljayBjYWxjdWxhdGlvbiB3aWxsIHVzZSB0aGUgdXNlciBzdXBsaWVkIG1pbi9tYXggdmFsdWVzIHRvIGRldGVybWluZQogICAgICAgICAgICAvLyB0aGUgdGlja3MuIElmIGF1dG9fdGlja3MgaXMgZmFsc2UgdGhlIGV4YWN0IHVzZXIgc3BlY2lmZWQgbWluIGFuZCBtYXgKICAgICAgICAgICAgLy8gdmFsdWVzIHdpbGwgYmUgdXNlZCBmb3IgdGhlIHNjYWxlLgogICAgICAgICAgICAvLyBJZiBhdXRvX3RpY2tzIGlzIHRydWUgdGhlbiB0aGUgc2NhbGUgbWlnaHQgYmUgc2xpZ2h0bHkgYWRqdXN0ZWQKICAgICAgICAgICAgLy8gc28gdGhhdCB0aGUgbWluIGFuZCBtYXggdmFsdWVzIGZhbGxzIG9uIGFuIGV2ZW4gbWFqb3Igc3RlcC4KICAgICAgICAgICAgLy8kbWluID0gMDsKICAgICAgICAgICAgJG1heCA9ICR0aGlzLT5zY2FsZS0+c2NhbGVbMV07CiAgICAgICAgICAgICR0MSA9ICR0aGlzLT5pbWctPnBsb3R3aWR0aDsKICAgICAgICAgICAgJHRoaXMtPmltZy0+cGxvdHdpZHRoIC89IDI7CiAgICAgICAgICAgICR0MiA9ICR0aGlzLT5pbWctPmxlZnRfbWFyZ2luOwogICAgICAgICAgICAkdGhpcy0+aW1nLT5sZWZ0X21hcmdpbiArPSAkdGhpcy0+aW1nLT5wbG90d2lkdGgrMTsKICAgICAgICAgICAgJHRoaXMtPnNjYWxlLT5BdXRvU2NhbGUoJHRoaXMtPmltZywwLCRtYXgsCiAgICAgICAgICAgICR0aGlzLT5pbWctPnBsb3R3aWR0aC8kdGhpcy0+eHRpY2tfZmFjdG9yLzIpOwogICAgICAgICAgICAkdGhpcy0+aW1nLT5wbG90d2lkdGggPSAkdDE7CiAgICAgICAgICAgICR0aGlzLT5pbWctPmxlZnRfbWFyZ2luID0gJHQyOwogICAgICAgIH0KCiAgICAgICAgaWYoICR0aGlzLT5pVHlwZSA9PSAgUE9MQVJfMTgwICkgewogICAgICAgIAkkcG9zID0gJHRoaXMtPmltZy0+aGVpZ2h0IC0gJHRoaXMtPmltZy0+Ym90dG9tX21hcmdpbjsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgCSRwb3MgPSAkdGhpcy0+aW1nLT5wbG90aGVpZ2h0LzIgKyAkdGhpcy0+aW1nLT50b3BfbWFyZ2luOwogICAgICAgIH0KCiAgICAgICAgaWYoICEkX2NzaW0gKSB7CiAgICAgICAgICAgICR0aGlzLT5TdHJva2VQbG90QXJlYSgpOwogICAgICAgIH0KCiAgICAgICAgJHRoaXMtPmlEb0NsaXBwaW5nID0gdHJ1ZTsKCiAgICAgICAgaWYoICR0aGlzLT5pRG9DbGlwcGluZyApIHsKICAgICAgICAgICAgJG9sZGltYWdlID0gJHRoaXMtPmltZy0+Q2xvbmVDYW52YXNIKCk7CiAgICAgICAgfQoKICAgICAgICBpZiggISRfY3NpbSApIHsKICAgICAgICAgICAgJHRoaXMtPmF4aXMtPlN0cm9rZUdyaWQoJHBvcyk7CiAgICAgICAgfQoKICAgICAgICAvLyBTdHJva2UgYWxsIHBsb3RzIGZvciBZMSBheGlzCiAgICAgICAgZm9yKCRpPTA7ICRpIDwgY291bnQoJHRoaXMtPnBsb3RzKTsgKyskaSkgewogICAgICAgICAgICAkdGhpcy0+cGxvdHNbJGldLT5TdHJva2UoJHRoaXMtPmltZywkdGhpcy0+c2NhbGUpOwogICAgICAgIH0KCgogICAgICAgIGlmKCAkdGhpcy0+aURvQ2xpcHBpbmcgKSB7CiAgICAgICAgICAgIC8vIENsaXBwaW5nIG9ubHkgc3VwcG9ydHMgZ3JhcGhzIGF0IDAgYW5kIDkwIGRlZ3JlZXMKICAgICAgICAgICAgaWYoICR0aGlzLT5pbWctPmEgPT0gMCAgKSB7CiAgICAgICAgICAgICAgICAkdGhpcy0+aW1nLT5Db3B5Q2FudmFzSCgkb2xkaW1hZ2UsJHRoaXMtPmltZy0+aW1nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmltZy0+bGVmdF9tYXJnaW4sJHRoaXMtPmltZy0+dG9wX21hcmdpbiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5pbWctPmxlZnRfbWFyZ2luLCR0aGlzLT5pbWctPnRvcF9tYXJnaW4sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+aW1nLT5wbG90d2lkdGgrMSwkdGhpcy0+aW1nLT5wbG90aGVpZ2h0KzEpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2VpZiggJHRoaXMtPmltZy0+YSA9PSA5MCApIHsKICAgICAgICAgICAgICAgICRhZGoxID0gcm91bmQoKCR0aGlzLT5pbWctPmhlaWdodCAtICR0aGlzLT5pbWctPndpZHRoKS8yKTsKICAgICAgICAgICAgICAgICRhZGoyID0gcm91bmQoKCR0aGlzLT5pbWctPndpZHRoIC0gJHRoaXMtPmltZy0+aGVpZ2h0KS8yKTsKICAgICAgICAgICAgICAgICRsbSA9ICR0aGlzLT5pbWctPmxlZnRfbWFyZ2luOwogICAgICAgICAgICAgICAgJHJtID0gJHRoaXMtPmltZy0+cmlnaHRfbWFyZ2luOwogICAgICAgICAgICAgICAgJHRtID0gJHRoaXMtPmltZy0+dG9wX21hcmdpbjsKICAgICAgICAgICAgICAgICRibSA9ICR0aGlzLT5pbWctPmJvdHRvbV9tYXJnaW47CiAgICAgICAgICAgICAgICAkdGhpcy0+aW1nLT5Db3B5Q2FudmFzSCgkb2xkaW1hZ2UsJHRoaXMtPmltZy0+aW1nLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGFkajIgKyByb3VuZCgoJGxtLSRybSskdG0rJGJtKS8yKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhZGoxICsgcm91bmQoKCR0bS0kYm0rJGxtKyRybSkvMiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYWRqMiArIHJvdW5kKCgkbG0tJHJtKyR0bSskYm0pLzIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGFkajEgKyByb3VuZCgoJHRtLSRibSskbG0rJHJtKS8yKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5pbWctPnBsb3RoZWlnaHQrMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5pbWctPnBsb3R3aWR0aCsxKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAkdGhpcy0+aW1nLT5EZXN0cm95KCk7CiAgICAgICAgICAgICR0aGlzLT5pbWctPlNldENhbnZhc0goJG9sZGltYWdlKTsKICAgICAgICB9CgogICAgICAgIGlmKCAhJF9jc2ltICkgewogICAgICAgICAgICAkdGhpcy0+YXhpcy0+U3Ryb2tlKCRwb3MpOwogICAgICAgICAgICAkdGhpcy0+YXhpcy0+U3Ryb2tlQW5nbGVMYWJlbHMoJHBvcywkdGhpcy0+aVR5cGUpOwogICAgICAgIH0KCiAgICAgICAgaWYoICEkX2NzaW0gKSB7CiAgICAgICAgICAgICR0aGlzLT5TdHJva2VQbG90Qm94KCk7CiAgICAgICAgICAgICR0aGlzLT5mb290ZXItPlN0cm9rZSgkdGhpcy0+aW1nKTsKCiAgICAgICAgICAgIC8vIFRoZSB0aXRsZXMgYW5kIGxlZ2VuZHMgbmV2ZXIgZ2V0cyByb3RhdGVkIHNvIG1ha2Ugc3VyZQogICAgICAgICAgICAvLyB0aGF0IHRoZSBhbmdsZSBpcyAwIGJlZm9yZSBzdHJva2luZyB0aGVtCiAgICAgICAgICAgICRhYSA9ICR0aGlzLT5pbWctPlNldEFuZ2xlKDApOwogICAgICAgICAgICAkdGhpcy0+U3Ryb2tlVGl0bGVzKCk7CiAgICAgICAgfQoKICAgICAgICBmb3IoJGk9MDsgJGkgPCBjb3VudCgkdGhpcy0+cGxvdHMpIDsgKyskaSApIHsKICAgICAgICAgICAgJHRoaXMtPnBsb3RzWyRpXS0+TGVnZW5kKCR0aGlzKTsKICAgICAgICB9CgogICAgICAgICR0aGlzLT5sZWdlbmQtPlN0cm9rZSgkdGhpcy0+aW1nKTsKCiAgICAgICAgaWYoICEkX2NzaW0gKSB7CgogICAgICAgICAgICAkdGhpcy0+U3Ryb2tlVGV4dHMoKTsKICAgICAgICAgICAgJHRoaXMtPmltZy0+U2V0QW5nbGUoJGFhKTsKCiAgICAgICAgICAgIC8vIERyYXcgYW4gb3V0bGluZSBhcm91bmQgdGhlIGltYWdlIG1hcAogICAgICAgICAgICBpZihfSlBHX0RFQlVHKQogICAgICAgICAgICAJJHRoaXMtPkRpc3BsYXlDbGllbnRTaWRlYUltYWdlTWFwQXJlYXMoKTsKCiAgICAgICAgICAgIC8vIElmIHRoZSBmaWxlbmFtZSBpcyBnaXZlbiBhcyB0aGUgc3BlY2lhbCAiX19oYW5kbGUiCiAgICAgICAgICAgIC8vIHRoZW4gdGhlIGltYWdlIGhhbmRsZXIgaXMgcmV0dXJuZWQgYW5kIHRoZSBpbWFnZSBpcyBOT1QKICAgICAgICAgICAgLy8gc3RyZWFtZWQgYmFjawogICAgICAgICAgICBpZiggJGFTdHJva2VGaWxlTmFtZSA9PSBfSU1HX0hBTkRMRVIgKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gJHRoaXMtPmltZy0+aW1nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgLy8gRmluYWxseSBzdHJlYW0gdGhlIGdlbmVyYXRlZCBwaWN0dXJlCiAgICAgICAgICAgICAgICAkdGhpcy0+Y2FjaGUtPlB1dEFuZFN0cmVhbSgkdGhpcy0+aW1nLCR0aGlzLT5jYWNoZV9uYW1lLCR0aGlzLT5pbmxpbmUsJGFTdHJva2VGaWxlTmFtZSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCgoKPz4K",
    "size": "30423"
}