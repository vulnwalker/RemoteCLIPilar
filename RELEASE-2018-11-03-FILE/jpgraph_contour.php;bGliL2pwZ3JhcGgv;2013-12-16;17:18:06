{
    "namaFile": "lib\/jpgraph\/jpgraph_contour.php",
    "lastUpdate": "2013-12-16+17:18:06.00",
    "contentFile": "PD9waHAKLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQovLyBGaWxlOiAgICAgICAgSlBHUkFQSF9DT05UT1VSLlBIUAovLyBEZXNjcmlwdGlvbjogQ29udG91ciBwbG90Ci8vIENyZWF0ZWQ6ICAgICAyMDA5LTAzLTA4Ci8vIFZlcjogICAgICAgICAkSWQ6IGpwZ3JhcGhfY29udG91ci5waHAgMTg3MCAyMDA5LTA5LTI5IDA0OjI0OjE4WiBsanAgJAovLwovLyBDb3B5cmlnaHQgKGMpIEFzaWFsIENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLgovLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQoqLwpyZXF1aXJlX29uY2UoJ2pwZ3JhcGhfbWVzaGludGVycG9sYXRlLmluYy5waHAnKTsKZGVmaW5lKCdIT1JJWl9FREdFJywwKTsKZGVmaW5lKCdWRVJUX0VER0UnLDEpOwoKLyoqCiAqIFRoaXMgY2xhc3MgZW5jYXBzdWxhdGVzIHRoZSBjb3JlIGNvbnRvdXIgcGxvdCBhbGdvcml0aG0uIEl0IHdpbGwgZmluZCB0aGUgcGF0aAogKiBvZiB0aGUgc3BlY2lmaWVkIGlzb2JhcnMgaW4gdGhlIGRhdGEgbWF0cml4IHNwZWNpZmllZC4gSXQgaXMgYXNzdW1lZCB0aGF0IHRoZQogKiBkYXRhIG1hdHJpeCBtb2RlbHMgYW4gZXF1c3BhY2VkIFgtWSBtZXNoIG9mIGRhdGF2YWx1ZXMgY29ycmVzcG9uZGluZyB0byB0aGUgWgogKiB2YWx1ZXMuCiAqCiAqLwpjbGFzcyBDb250b3VyIHsKCiAgICBwcml2YXRlICRkYXRhUG9pbnRzID0gYXJyYXkoKTsKICAgIHByaXZhdGUgJG5ickNvbHM9MCwkbmJyUm93cz0wOwogICAgcHJpdmF0ZSAkaG9yaXpFZGdlcyA9IGFycmF5KCksICR2ZXJ0RWRnZXM9YXJyYXkoKTsKICAgIHByaXZhdGUgJGlzb2JhclZhbHVlcyA9IGFycmF5KCk7CiAgICBwcml2YXRlICRzdGFjayA9IG51bGw7CiAgICBwcml2YXRlICRpc29iYXJDb29yZCA9IGFycmF5KCk7CiAgICBwcml2YXRlICRuYnJJc29iYXJzID0gMTAsICRpc29iYXJDb2xvcnMgPSBhcnJheSgpOwogICAgcHJpdmF0ZSAkaW52ZXJ0ID0gdHJ1ZTsKICAgIHByaXZhdGUgJGhpZ2hjb250cmFzdCA9IGZhbHNlLCAkaGlnaGNvbnRyYXN0YncgPSBmYWxzZTsKCiAgICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyBjb250b3VyIGxldmVsICJhbGdvcml0aG0gbWFjaGluZSIuCiAgICAgKiBAcGFyYW0gJGFNYXRyaXggICAgVGhlIHZhbHVlcyB0byBmaW5kIHRoZSBjb250b3VyIGZyb20KICAgICAqIEBwYXJhbSAkYUlzb2JhcnMgTWl4ZWQuIElmIGludGVnZXIgaXQgZGV0ZXJtaW5lcyB0aGUgbnVtYmVyIG9mIGlzb2JhcnMgdG8gYmUgdXNlZC4gVGhlIGxldmVscyBhcmUgZGV0ZXJtaW5lZAogICAgICogYXV0b21hdGljYWxseSBhcyBlcXVkaXN0YW5jZSBiZXR3ZWVuIHRoZSBtaW4gYW5kIG1heCB2YWx1ZSBvZiB0aGUgbWF0cmljZS4KICAgICAqIElmICRhSXNvYmFycyBpcyBhbiBhcnJheSB0aGVuIHRoaXMgaXMgaW50ZXJwcmV0YXRlZCBhcyBhbiBhcnJheSBvZiB2YWx1ZXMgdG8gYmUgdXNlZCBhcyBpc29iYXJzIGluIHRoZQogICAgICogY29udG91ciBwbG90LgogICAgICogQHJldHVybiBhbiBpbnN0YW5jZSBvZiB0aGUgY29udG91ciBhbGdvcml0aG0KICAgICAqLwogICAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGFNYXRyaXgsJGFJc29iYXJzPTEwLCAkYUNvbG9ycz1udWxsKSB7CgogICAgICAgICR0aGlzLT5uYnJSb3dzID0gY291bnQoJGFNYXRyaXgpOwogICAgICAgICR0aGlzLT5uYnJDb2xzID0gY291bnQoJGFNYXRyaXhbMF0pOwogICAgICAgICR0aGlzLT5kYXRhUG9pbnRzID0gJGFNYXRyaXg7CgogICAgICAgIGlmKCBpc19hcnJheSgkYUlzb2JhcnMpICkgewogICAgICAgICAgICAvLyB1c2UgdGhlIGlzb2JhciB2YWx1ZXMgc3VwcGxpZWQKICAgICAgICAgICAgJHRoaXMtPm5icklzb2JhcnMgPSBjb3VudCgkYUlzb2JhcnMpOwogICAgICAgICAgICAkdGhpcy0+aXNvYmFyVmFsdWVzID0gJGFJc29iYXJzOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgLy8gRGV0ZXJtaW5lIHRoZSBpc29iYXIgdmFsdWVzIGF1dG9tYXRpY2FsbHkKICAgICAgICAgICAgJHRoaXMtPm5icklzb2JhcnMgPSAkYUlzb2JhcnM7CiAgICAgICAgICAgIGxpc3QoJG1pbiwkbWF4KSA9ICR0aGlzLT5nZXRNaW5NYXhWYWwoKTsKICAgICAgICAgICAgJHN0ZXBTaXplID0gKCRtYXgtJG1pbikgLyAkYUlzb2JhcnMgOwogICAgICAgICAgICAkaXNvYmFyID0gJG1pbiskc3RlcFNpemUvMjsKICAgICAgICAgICAgZm9yICgkaSA9IDA7ICRpIDwgJGFJc29iYXJzOyAkaSsrKSB7CiAgICAgICAgICAgICAgICAkdGhpcy0+aXNvYmFyVmFsdWVzWyRpXSA9ICRpc29iYXI7CiAgICAgICAgICAgICAgICAkaXNvYmFyICs9ICRzdGVwU2l6ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYoICRhQ29sb3JzICE9PSBudWxsICYmIGNvdW50KCRhQ29sb3JzKSA+IDAgKSB7CgogICAgICAgICAgICBpZiggIWlzX2FycmF5KCRhQ29sb3JzKSApIHsKICAgICAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDI4MDAxKTsKICAgICAgICAgICAgICAgIC8vJ1RoaXJkIGFyZ3VtZW50IHRvIENvbnRvdXIgbXVzdCBiZSBhbiBhcnJheSBvZiBjb2xvcnMuJwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiggY291bnQoJGFDb2xvcnMpICE9IGNvdW50KCR0aGlzLT5pc29iYXJWYWx1ZXMpICkgewogICAgICAgICAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoMjgwMDIpOwogICAgICAgICAgICAgICAgLy8nTnVtYmVyIG9mIGNvbG9ycyBtdXN0IGVxdWFsIHRoZSBudW1iZXIgb2YgaXNvYmFyIGxpbmVzIHNwZWNpZmllZCc7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICR0aGlzLT5pc29iYXJDb2xvcnMgPSAkYUNvbG9yczsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBGbGlwIHRoZSBwbG90IGFyb3VuZCB0aGUgWS1jb29yZGluYXRlLiBUaGlzIGhhcyB0aGUgc2FtZSBhZmZlY3QgYXMgZmxpcHBpbmcgdGhlIGlucHV0CiAgICAgKiBkYXRhIG1hdHJpY2UKICAgICAqCiAgICAgKiBAcGFyYW0gJGFGbGcgSWYgdHJ1ZSB0aGUgdGhlIHZlcnRpY2UgaW4gaW5wdXQgZGF0YSBtYXRyaWNlIHBvc2l0aW9uICgwLDApIGNvcnJlc3BvbmRzIHRvIHRoZSB0b3AgbGVmdAogICAgICogY29ybmVyIG9mIHRlaCBwbG90IG90aGVyd2lzZSBpdCB3aWxsIGNvcnJlc3BvbmQgdG8gdGhlIGJvdHRvbSBsZWZ0IGNvcm5lciAoYSBob3Jpem9udGFsIGZsaXApCiAgICAgKi8KICAgIGZ1bmN0aW9uIFNldEludmVydCgkYUZsZz10cnVlKSB7CiAgICAgICAgJHRoaXMtPmludmVydCA9ICRhRmxnOwogICAgfQoKICAgIC8qKgogICAgICogRmluZCB0aGUgbWluIGFuZCBtYXggdmFsdWVzIGluIHRoZSBkYXRhIG1hdHJpY2UKICAgICAqCiAgICAgKiBAcmV0dXJuIGFycmF5KG1pbl92YWx1ZSxtYXhfdmFsdWUpCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldE1pbk1heFZhbCgpIHsKICAgICAgICAkbWluID0gJHRoaXMtPmRhdGFQb2ludHNbMF1bMF07CiAgICAgICAgJG1heCA9ICR0aGlzLT5kYXRhUG9pbnRzWzBdWzBdOwogICAgICAgIGZvciAoJGkgPSAwOyAkaSA8ICR0aGlzLT5uYnJSb3dzOyAkaSsrKSB7CiAgICAgICAgICAgIGlmKCAoJG1pPW1pbigkdGhpcy0+ZGF0YVBvaW50c1skaV0pKSA8ICRtaW4gKSAgJG1pbiA9ICRtaTsKICAgICAgICAgICAgaWYoICgkbWE9bWF4KCR0aGlzLT5kYXRhUG9pbnRzWyRpXSkpID4gJG1heCApICAkbWF4ID0gJG1hOwogICAgICAgIH0KICAgICAgICByZXR1cm4gYXJyYXkoJG1pbiwkbWF4KTsKICAgIH0KCiAgICAvKioKICAgICAqIFJlc2V0IHRoZSB0d28gbWF0cmljZXMgdGhhdCBrZWVwcyB0cmFjayBvbiB3aGVyZSB0aGUgaXNvYmFycyBjcm9zc2VzIHRoZQogICAgICogaG9yaXpvbnRhbCBhbmQgdmVydGljYWwgZWRnZXMKICAgICAqLwogICAgZnVuY3Rpb24gcmVzZXRFZGdlTWF0cmljZXMoKSB7CiAgICAgICAgZm9yICgkayA9IDA7ICRrIDwgMjsgJGsrKykgewogICAgICAgICAgICBmb3IgKCRpID0gMDsgJGkgPD0gJHRoaXMtPm5iclJvd3M7ICRpKyspIHsKICAgICAgICAgICAgICAgIGZvciAoJGogPSAwOyAkaiA8PSAkdGhpcy0+bmJyQ29sczsgJGorKykgewogICAgICAgICAgICAgICAgICAgICR0aGlzLT5lZGdlc1ska11bJGldWyRqXSA9IGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogRGV0ZXJtaW5lIGlmIHRoZSBzcGVjaWZpZWQgaXNvYmFyIGNyb3NzZXMgdGhlIGhvcml6b250YWwgZWRnZSBzcGVjaWZpZWQgYnkgaXRzIHJvdyBhbmQgY29sdW1uCiAgICAgKgogICAgICogQHBhcmFtICRhUm93IFJvdyBpbmRleCBvZiBlZGdlIHRvIGJlIGNoZWNrZWQKICAgICAqIEBwYXJhbSAkYUNvbCBDb2wgaW5kZXggb2YgZWRnZSB0byBiZSBjaGVja2VkCiAgICAgKiBAcGFyYW0gJGFJc29iYXIgSXNvYmFyIHZhbHVlCiAgICAgKiBAcmV0dXJuIHRydWUgaWYgdGhlIGlzb2JhciBpcyBjcm9zc2luZyB0aGlzIGVkZ2UKICAgICAqLwogICAgZnVuY3Rpb24gaXNvYmFySENyb3NzaW5nKCRhUm93LCRhQ29sLCRhSXNvYmFyKSB7CgogICAgICAgIGlmKCAkYUNvbCA+PSAkdGhpcy0+bmJyQ29scy0xICkgewogICAgICAgICAgICBKcEdyYXBoRXJyb3I6OlJhaXNlTCgyODAwMywkYUNvbCk7CiAgICAgICAgICAgIC8vJ0NvbnRvdXJQbG90IEludGVybmFsIEVycm9yOiBpc29iYXJIQ3Jvc3Npbmc6IENvbG91bW4gaW5kZXggdG9vIGxhcmdlICglZCknCiAgICAgICAgfQogICAgICAgIGlmKCAkYVJvdyA+PSAkdGhpcy0+bmJyUm93cyApIHsKICAgICAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoMjgwMDQsJGFSb3cpOwogICAgICAgICAgICAvLydDb250b3VyUGxvdCBJbnRlcm5hbCBFcnJvcjogaXNvYmFySENyb3NzaW5nOiBSb3cgaW5kZXggdG9vIGxhcmdlICglZCknCiAgICAgICAgfQoKICAgICAgICAkdjEgPSAkdGhpcy0+ZGF0YVBvaW50c1skYVJvd11bJGFDb2xdOwogICAgICAgICR2MiA9ICR0aGlzLT5kYXRhUG9pbnRzWyRhUm93XVskYUNvbCsxXTsKCiAgICAgICAgcmV0dXJuICgkYUlzb2Jhci0kdjEpKigkYUlzb2Jhci0kdjIpIDwgMCA7CgogICAgfQoKICAgIC8qKgogICAgICogRGV0ZXJtaW5lIGlmIHRoZSBzcGVjaWZpZWQgaXNvYmFyIGNyb3NzZXMgdGhlIHZlcnRpY2FsIGVkZ2Ugc3BlY2lmaWVkIGJ5IGl0cyByb3cgYW5kIGNvbHVtbgogICAgICoKICAgICAqIEBwYXJhbSAkYVJvdyBSb3cgaW5kZXggb2YgZWRnZSB0byBiZSBjaGVja2VkCiAgICAgKiBAcGFyYW0gJGFDb2wgQ29sIGluZGV4IG9mIGVkZ2UgdG8gYmUgY2hlY2tlZAogICAgICogQHBhcmFtICRhSXNvYmFyIElzb2JhciB2YWx1ZQogICAgICogQHJldHVybiB0cnVlIGlmIHRoZSBpc29iYXIgaXMgY3Jvc3NpbmcgdGhpcyBlZGdlCiAgICAgKi8KICAgIGZ1bmN0aW9uIGlzb2JhclZDcm9zc2luZygkYVJvdywkYUNvbCwkYUlzb2JhcikgewoKICAgICAgICBpZiggJGFSb3cgPj0gJHRoaXMtPm5iclJvd3MtMSkgewogICAgICAgICAgICBKcEdyYXBoRXJyb3I6OlJhaXNlTCgyODAwNSwkYVJvdyk7CiAgICAgICAgICAgIC8vJ2lzb2JhclZDcm9zc2luZzogUm93IGluZGV4IHRvbyBsYXJnZQogICAgICAgIH0KICAgICAgICBpZiggJGFDb2wgPj0gJHRoaXMtPm5ickNvbHMgKSB7CiAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDI4MDA2LCRhQ29sKTsKICAgICAgICAgICAgLy8naXNvYmFyVkNyb3NzaW5nOiBDb2wgaW5kZXggdG9vIGxhcmdlCiAgICAgICAgfQoKICAgICAgICAkdjEgPSAkdGhpcy0+ZGF0YVBvaW50c1skYVJvd11bJGFDb2xdOwogICAgICAgICR2MiA9ICR0aGlzLT5kYXRhUG9pbnRzWyRhUm93KzFdWyRhQ29sXTsKCiAgICAgICAgcmV0dXJuICgkYUlzb2Jhci0kdjEpKigkYUlzb2Jhci0kdjIpIDwgMCA7CgogICAgfQoKICAgIC8qKgogICAgICogRGV0ZXJtaW5lIGFsbCBlZGdlcywgaG9yaXpvbnRhbCBhbmQgdmVydGljYWwgdGhhdCB0aGUgc3BlY2lmaWVkIGlzb2JhciBjcm9zc2VzLiBUaGUgY3Jvc3NpbmdzCiAgICAgKiBhcmUgcmVjb3JkZWQgaW4gdGhlIHR3byBlZGdlIG1hdHJpY2VzLgogICAgICoKICAgICAqIEBwYXJhbSAkYUlzb2JhciBUaGUgdmFsdWUgb2YgdGhlIGlzb2JhciB0byBiZSBjaGVja2VkCiAgICAgKi8KICAgIGZ1bmN0aW9uIGRldGVybWluZUlzb2JhckVkZ2VDcm9zc2luZ3MoJGFJc29iYXIpIHsKCiAgICAgICAgJGliID0gJHRoaXMtPmlzb2JhclZhbHVlc1skYUlzb2Jhcl07CgogICAgICAgIGZvciAoJGkgPSAwOyAkaSA8ICR0aGlzLT5uYnJSb3dzLTE7ICRpKyspIHsKICAgICAgICAgICAgZm9yICgkaiA9IDA7ICRqIDwgJHRoaXMtPm5ickNvbHMtMTsgJGorKykgewogICAgICAgICAgICAgICAgJHRoaXMtPmVkZ2VzW0hPUklaX0VER0VdWyRpXVskal0gPSAkdGhpcy0+aXNvYmFySENyb3NzaW5nKCRpLCRqLCRpYik7CiAgICAgICAgICAgICAgICAkdGhpcy0+ZWRnZXNbVkVSVF9FREdFXVskaV1bJGpdID0gJHRoaXMtPmlzb2JhclZDcm9zc2luZygkaSwkaiwkaWIpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBXZSBub3cgaGF2ZSB0aGUgYm90dG9tIGFuZCByaWdodG1vc3QgZWRnZXMgdW5zZWFyY2hlZAogICAgICAgIGZvciAoJGkgPSAwOyAkaSA8ICR0aGlzLT5uYnJSb3dzLTE7ICRpKyspIHsKICAgICAgICAgICAgJHRoaXMtPmVkZ2VzW1ZFUlRfRURHRV1bJGldWyRqXSA9ICR0aGlzLT5pc29iYXJWQ3Jvc3NpbmcoJGksJHRoaXMtPm5ickNvbHMtMSwkaWIpOwogICAgICAgIH0KICAgICAgICBmb3IgKCRqID0gMDsgJGogPCAkdGhpcy0+bmJyQ29scy0xOyAkaisrKSB7CiAgICAgICAgICAgICR0aGlzLT5lZGdlc1tIT1JJWl9FREdFXVskaV1bJGpdID0gJHRoaXMtPmlzb2JhckhDcm9zc2luZygkdGhpcy0+bmJyUm93cy0xLCRqLCRpYik7CiAgICAgICAgfQoKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybiB0aGUgbm9ybWFsaXplZCBjb29yZGluYXRlcyBmb3IgdGhlIGNyb3NzaW5nIG9mIHRoZSBzcGVjaWZpZWQgZWRnZSB3aXRoIHRoZSBzcGVjaWZpZWQKICAgICAqIGlzb2Jhci0gVGhlIGNyb3NzaW5nIGlzIHNpbXB5IGRldHJtaW5lZCB3aXRoIGEgbGluZWFyIGludGVycG9sYXRpb24gYmV0d2VlbiB0aGUgdHdvIHZlcnRpY2VzCiAgICAgKiBvbiBlYWNoIHNpZGUgb2YgdGhlIGVkZ2UgYW5kIHRoZSB2YWx1ZSBvZiB0aGUgaXNvYmFyCiAgICAgKgogICAgICogQHBhcmFtICRhUm93IFJvdyBvZiBlZGdlCiAgICAgKiBAcGFyYW0gJGFDb2wgQ29sdW1uIG9mIGVkZ2UKICAgICAqIEBwYXJhbSAkYUVkZ2VEaXIgRGV0ZXJtaW5lIGlmIHRoaXMgaXMgYSBob3Jpem9udGFsIG9yIHZlcnRpY2FsIGVkZ2UKICAgICAqIEBwYXJhbSAkaWIgVGhlIGlzb2JhciB2YWx1ZQogICAgICogQHJldHVybiB1bmtub3duX3R5cGUKICAgICAqLwogICAgZnVuY3Rpb24gZ2V0Q3Jvc3NpbmdDb29yZCgkYVJvdywkYUNvbCwkYUVkZ2VEaXIsJGFJc29iYXJWYWwpIHsKCiAgICAgICAgLy8gSW4gb3JkZXIgdG8gYXZvaWQgbnVtZXJpY2FsIHByb2JsZW0gd2hlbiB0d28gdmVydGljZXMgYXJlIHZlcnkgY2xvc2UKICAgICAgICAvLyB3ZSBoYXZlIHRvIGNoZWNrIGFuZCBhdm9pZCBkaXZpZGluZyBieSBjbG9zZSB0byB6ZXJvIGRlbnVtZXJhdG9yLgogICAgICAgIGlmKCAkYUVkZ2VEaXIgPT0gSE9SSVpfRURHRSApIHsKICAgICAgICAgICAgJGQgPSBhYnMoJHRoaXMtPmRhdGFQb2ludHNbJGFSb3ddWyRhQ29sXSAtICR0aGlzLT5kYXRhUG9pbnRzWyRhUm93XVskYUNvbCsxXSk7CiAgICAgICAgICAgIGlmKCAkZCA+IDAuMDAxICkgewogICAgICAgICAgICAgICAgJHhjb29yZCA9ICRhQ29sICsgYWJzKCRhSXNvYmFyVmFsIC0gJHRoaXMtPmRhdGFQb2ludHNbJGFSb3ddWyRhQ29sXSkgLyAkZDsKICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICR4Y29vcmQgPSAkYUNvbDsKICAgICAgICAgICAgfQogICAgICAgICAgICAkeWNvb3JkID0gJGFSb3c7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAkZCA9IGFicygkdGhpcy0+ZGF0YVBvaW50c1skYVJvd11bJGFDb2xdIC0gJHRoaXMtPmRhdGFQb2ludHNbJGFSb3crMV1bJGFDb2xdKTsKICAgICAgICAgICAgaWYoICRkID4gMC4wMDEgKSB7CiAgICAgICAgICAgICAgICAkeWNvb3JkID0gJGFSb3cgKyBhYnMoJGFJc29iYXJWYWwgLSAkdGhpcy0+ZGF0YVBvaW50c1skYVJvd11bJGFDb2xdKSAvICRkOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgJHljb29yZCA9ICRhUm93OwogICAgICAgICAgICB9CiAgICAgICAgICAgICR4Y29vcmQgPSAkYUNvbDsKICAgICAgICB9CiAgICAgICAgaWYoICR0aGlzLT5pbnZlcnQgKSB7CiAgICAgICAgICAgICR5Y29vcmQgPSAkdGhpcy0+bmJyUm93cy0xIC0gJHljb29yZDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGFycmF5KCR4Y29vcmQsJHljb29yZCk7CgogICAgfQoKICAgIC8qKgogICAgICogSW4gb3JkZXIgdG8gYXZvaWQgYWxsIGtpbmRzIG9mIHVucGxlYXNlbnQgZXh0cmEgY2hlY2tzIGFuZCBjb21wbGV4IGJvdW5kYXJ5CiAgICAgKiBjb250cm9scyBmb3IgdGhlIGRlZ2VuZXJhdGVkIGNhc2Ugd2hlcmUgdGhlIGNvbnRvdXIgbGV2ZWxzIGV4YWN0bHkgY3Jvc3NlcwogICAgICogb25lIG9mIHRoZSB2ZXJ0aWNlcyB3ZSBhZGQgYSB2ZXJ5IHNtYWxsIGRlbHRhICgwLjElKSB0byB0aGUgZGF0YSBwb2ludCB2YWx1ZS4KICAgICAqIFRoaXMgaGFzIG5vIHZpc2libGUgYWZmZWN0IGJ1dCBpdCBtYWtlcyB0aGUgY29kZSBzb29vb28gbXVjaCBjbGVhbmVyLgogICAgICoKICAgICAqLwogICAgZnVuY3Rpb24gYWRqdXN0RGF0YVBvaW50VmFsdWVzKCkgewoKICAgICAgICAkbmkgPSBjb3VudCgkdGhpcy0+aXNvYmFyVmFsdWVzKTsKICAgICAgICBmb3IgKCRrID0gMDsgJGsgPCAkbmk7ICRrKyspIHsKICAgICAgICAgICAgJGliID0gJHRoaXMtPmlzb2JhclZhbHVlc1ska107CiAgICAgICAgICAgIGZvciAoJHJvdyA9IDAgOyAkcm93IDwgJHRoaXMtPm5iclJvd3MtMTsgKyskcm93KSB7CiAgICAgICAgICAgICAgICBmb3IgKCRjb2wgPSAwIDsgJGNvbCA8ICR0aGlzLT5uYnJDb2xzLTE7ICsrJGNvbCApIHsKICAgICAgICAgICAgICAgICAgICBpZiggYWJzKCR0aGlzLT5kYXRhUG9pbnRzWyRyb3ddWyRjb2xdIC0gJGliKSA8IDAuMDAwMSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmRhdGFQb2ludHNbJHJvd11bJGNvbF0gKz0gJHRoaXMtPmRhdGFQb2ludHNbJHJvd11bJGNvbF0qMC4wMDE7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgIH0KCiAgICAvKioKICAgICAqIEBwYXJhbSAkYUZsZwogICAgICogQHBhcmFtICRhQlcKICAgICAqIEByZXR1cm4gdW5rbm93bl90eXBlCiAgICAgKi8KICAgIGZ1bmN0aW9uIFVzZUhpZ2hDb250cmFzdENvbG9yKCRhRmxnPXRydWUsJGFCVz1mYWxzZSkgewogICAgICAgICR0aGlzLT5oaWdoY29udHJhc3QgPSAkYUZsZzsKICAgICAgICAkdGhpcy0+aGlnaGNvbnRyYXN0YncgPSAkYUJXOwogICAgfQoKICAgIC8qKgogICAgICogQ2FsY3VsYXRlIHN1aXRhYmxlIGNvbG9ycyBmb3IgZWFjaCBkZWZpbmVkIGlzb2JhcgogICAgICoKICAgICAqLwogICAgZnVuY3Rpb24gQ2FsY3VsYXRlQ29sb3JzKCkgewogICAgICAgIGlmICggJHRoaXMtPmhpZ2hjb250cmFzdCApIHsKICAgICAgICAgICAgaWYgKCAkdGhpcy0+aGlnaGNvbnRyYXN0YncgKSB7CiAgICAgICAgICAgICAgICBmb3IgKCRpYiA9IDA7ICRpYiA8ICR0aGlzLT5uYnJJc29iYXJzOyAkaWIrKykgewogICAgICAgICAgICAgICAgICAgICR0aGlzLT5pc29iYXJDb2xvcnNbJGliXSA9ICdibGFjayc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAvLyBVc2Ugb25seSBibHVlL3JlZCBzY2FsZQogICAgICAgICAgICAgICAgJHN0ZXAgPSByb3VuZCgyNTUvKCR0aGlzLT5uYnJJc29iYXJzLTEpKTsKICAgICAgICAgICAgICAgIGZvciAoJGliID0gMDsgJGliIDwgJHRoaXMtPm5icklzb2JhcnM7ICRpYisrKSB7CiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmlzb2JhckNvbG9yc1skaWJdID0gYXJyYXkoJGliKiRzdGVwLCA1MCwgMjU1LSRpYiokc3RlcCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICRuID0gJHRoaXMtPm5icklzb2JhcnM7CiAgICAgICAgICAgICR2ID0gMDsgJHN0ZXAgPSAxIC8gKCR0aGlzLT5uYnJJc29iYXJzLTEpOwogICAgICAgICAgICBmb3IgKCRpYiA9IDA7ICRpYiA8ICR0aGlzLT5uYnJJc29iYXJzOyAkaWIrKykgewogICAgICAgICAgICAgICAgJHRoaXMtPmlzb2JhckNvbG9yc1skaWJdID0gUkdCOjpHZXRTcGVjdHJ1bSgkdik7CiAgICAgICAgICAgICAgICAkdiArPSAkc3RlcDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFRoaXMgaXMgd2hlcmUgdGhlIG1haW4gd29yayBpcyBkb25lLiBGb3IgZWFjaCBpc29iYXIgdGhlIGNyb3NzaW5nIG9mIHRoZSBlZGdlcyBhcmUgZGV0ZXJtaW5lZAogICAgICogYW5kIHRoZW4gZWFjaCBjZWxsIGlzIGFuYWx5emVkIHRvIGZpbmQgdGhlIDAsIDIgb3IgNCBjcm9zc2luZ3MuIFRoZW4gdGhlIG5vcm1hbGl6ZWQgY29vcmRpbmF0ZQogICAgICogZm9yIHRoZSBjcm9zc2luZ3MgYXJlIGRldGVybWluZWQgYW5kIHB1c2hlZCBvbiB0byB0aGUgaXNvYmFyIHN0YWNrLiBXaGVuIHRoZSBtZXRob2QgaXMgZmluaXNoZWQKICAgICAqIHRoZSAkaXNvYmFyQ29vcmQgd2lsbCBob2xkIG9uZSBhcnJheWZvciBlYWNoIGlzb2JhciB3aGVyZSBhbGwgdGhlIGxpbmUgc2VnbWVudHMgdGhhdCBtYWtlcwogICAgICogdXAgdGhlIGNvbnRvdXIgcGxvdCBhcmUgc3RvcmVkLgogICAgICoKICAgICAqIEByZXR1cm4gYXJyYXkoICRpc29iYXJDb29yZCwgJGlzb2JhclZhbHVlcywgJGlzb2JhckNvbG9ycyApCiAgICAgKi8KICAgIGZ1bmN0aW9uIGdldElzb2JhcnMoKSB7CgogICAgICAgICR0aGlzLT5hZGp1c3REYXRhUG9pbnRWYWx1ZXMoKTsKCiAgICAgICAgZm9yICgkaXNvYmFyID0gMDsgJGlzb2JhciA8ICR0aGlzLT5uYnJJc29iYXJzOyAkaXNvYmFyKyspIHsKCiAgICAgICAgICAgICRpYiA9ICR0aGlzLT5pc29iYXJWYWx1ZXNbJGlzb2Jhcl07CiAgICAgICAgICAgICR0aGlzLT5yZXNldEVkZ2VNYXRyaWNlcygpOwogICAgICAgICAgICAkdGhpcy0+ZGV0ZXJtaW5lSXNvYmFyRWRnZUNyb3NzaW5ncygkaXNvYmFyKTsKICAgICAgICAgICAgJHRoaXMtPmlzb2JhckNvb3JkWyRpc29iYXJdID0gYXJyYXkoKTsKCiAgICAgICAgICAgICRuY29vcmQgPSAwOwoKICAgICAgICAgICAgZm9yICgkcm93ID0gMCA7ICRyb3cgPCAkdGhpcy0+bmJyUm93cy0xOyArKyRyb3cpIHsKICAgICAgICAgICAgICAgIGZvciAoJGNvbCA9IDAgOyAkY29sIDwgJHRoaXMtPm5ickNvbHMtMTsgKyskY29sICkgewoKICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIG91dCBob3cgbWFueSBjcm9zc2luZ3MgYXJvdW5kIHRoZSBlZGdlcwogICAgICAgICAgICAgICAgICAgICRuID0gMDsKICAgICAgICAgICAgICAgICAgICBpZiAoICR0aGlzLT5lZGdlc1tIT1JJWl9FREdFXVskcm93XVskY29sXSApICAgJG5laWdoWyRuKytdID0gYXJyYXkoJHJvdywgICRjb2wsICBIT1JJWl9FREdFKTsKICAgICAgICAgICAgICAgICAgICBpZiAoICR0aGlzLT5lZGdlc1tIT1JJWl9FREdFXVskcm93KzFdWyRjb2xdICkgJG5laWdoWyRuKytdID0gYXJyYXkoJHJvdysxLCRjb2wsICBIT1JJWl9FREdFKTsKICAgICAgICAgICAgICAgICAgICBpZiAoICR0aGlzLT5lZGdlc1tWRVJUX0VER0VdWyRyb3ddWyRjb2xdICkgICAgJG5laWdoWyRuKytdID0gYXJyYXkoJHJvdywgICRjb2wsICBWRVJUX0VER0UpOwogICAgICAgICAgICAgICAgICAgIGlmICggJHRoaXMtPmVkZ2VzW1ZFUlRfRURHRV1bJHJvd11bJGNvbCsxXSApICAkbmVpZ2hbJG4rK10gPSBhcnJheSgkcm93LCAgJGNvbCsxLFZFUlRfRURHRSk7CgogICAgICAgICAgICAgICAgICAgIGlmICggJG4gPT0gMiApIHsKICAgICAgICAgICAgICAgICAgICAgICAgJG4xPTA7ICRuMj0xOwogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+aXNvYmFyQ29vcmRbJGlzb2Jhcl1bJG5jb29yZCsrXSA9IGFycmF5KAogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Z2V0Q3Jvc3NpbmdDb29yZCgkbmVpZ2hbJG4xXVswXSwkbmVpZ2hbJG4xXVsxXSwkbmVpZ2hbJG4xXVsyXSwkaWIpLAogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Z2V0Q3Jvc3NpbmdDb29yZCgkbmVpZ2hbJG4yXVswXSwkbmVpZ2hbJG4yXVsxXSwkbmVpZ2hbJG4yXVsyXSwkaWIpICk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2VpZiAoICRuID09IDQgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFdlIG11c3QgZGV0ZXJtaW5lIGhvdyB0byBjb25uZWN0IHRoZSBlZGdlcyBlaXRoZXIgbm9ydGh3ZXN0LT5zb3V0aGVhc3Qgb3IKICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm9ydGhlYXN0LT5zb3V0aHdlc3QuIFdlIGRvIHRoYXQgYnkgY2FsY3VsYXRpbmcgdGhlIGltYWdpbmFyeSBtaWRkbGUgdmFsdWUgb2YKICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhlIGNlbGwgYnkgYXZlcmFnaW5nIHRoZSBmb3IgY29ybmVycy4gVGhpcyB3aWxsIGNvbXBhcmVkIHdpdGggdGhlIHZhbHVlIG9mIHRoZQogICAgICAgICAgICAgICAgICAgICAgICAvLyB0b3AgbGVmdCBjb3JuZXIgd2lsbCBoZWxwIGRldGVybWluZSB0aGUgb3JpZW50YXRpb24gb2YgdGhlIHJpZGdlL2NyZWVrCiAgICAgICAgICAgICAgICAgICAgICAgICRtaWR2YWwgPSAoJHRoaXMtPmRhdGFQb2ludHNbJHJvd11bJGNvbF0rJHRoaXMtPmRhdGFQb2ludHNbJHJvd11bJGNvbCsxXSskdGhpcy0+ZGF0YVBvaW50c1skcm93KzFdWyRjb2xdKyR0aGlzLT5kYXRhUG9pbnRzWyRyb3crMV1bJGNvbCsxXSkvNDsKICAgICAgICAgICAgICAgICAgICAgICAgJHYgPSAkdGhpcy0+ZGF0YVBvaW50c1skcm93XVskY29sXTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoICRtaWR2YWwgPT0gJGliICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gT3JpZW50YXRpb24gIisiCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbjE9MDsgJG4yPTE7ICRuMz0yOyAkbjQ9MzsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlaWYgKCAoJG1pZHZhbCA+ICRpYiAmJiAkdiA+ICRpYikgfHwgICgkbWlkdmFsIDwgJGliICYmICR2IDwgJGliKSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9yaWVudGF0aW9uIG9mIHJpZGdlL3ZhbGxleSA9ICJcIgogICAgICAgICAgICAgICAgICAgICAgICAgICAgJG4xPTA7ICRuMj0zOyAkbjM9MjsgJG40PTE7CiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZWlmICggKCRtaWR2YWwgPiAkaWIgJiYgJHYgPCAkaWIpIHx8ICAoJG1pZHZhbCA8ICRpYiAmJiAkdiA+ICRpYikgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBPcmllbnRhdGlvbiBvZiByaWRnZS92YWxsZXkgPSAiLyIKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRuMT0wOyAkbjI9MjsgJG4zPTM7ICRuND0xOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+aXNvYmFyQ29vcmRbJGlzb2Jhcl1bJG5jb29yZCsrXSA9IGFycmF5KAogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Z2V0Q3Jvc3NpbmdDb29yZCgkbmVpZ2hbJG4xXVswXSwkbmVpZ2hbJG4xXVsxXSwkbmVpZ2hbJG4xXVsyXSwkaWIpLAogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Z2V0Q3Jvc3NpbmdDb29yZCgkbmVpZ2hbJG4yXVswXSwkbmVpZ2hbJG4yXVsxXSwkbmVpZ2hbJG4yXVsyXSwkaWIpICk7CgogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+aXNvYmFyQ29vcmRbJGlzb2Jhcl1bJG5jb29yZCsrXSA9IGFycmF5KAogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Z2V0Q3Jvc3NpbmdDb29yZCgkbmVpZ2hbJG4zXVswXSwkbmVpZ2hbJG4zXVsxXSwkbmVpZ2hbJG4zXVsyXSwkaWIpLAogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Z2V0Q3Jvc3NpbmdDb29yZCgkbmVpZ2hbJG40XVswXSwkbmVpZ2hbJG40XVsxXSwkbmVpZ2hbJG40XVsyXSwkaWIpICk7CgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYoIGNvdW50KCR0aGlzLT5pc29iYXJDb2xvcnMpID09IDAgKSB7CiAgICAgICAgICAgIC8vIE5vIG1hbnVhbGx5IHNwZWNpZmllZCBjb2xvcnMuIENhbGN1bGF0ZSB0aGVtIGF1dG9tYXRpY2FsbHkuCiAgICAgICAgICAgICR0aGlzLT5DYWxjdWxhdGVDb2xvcnMoKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGFycmF5KCAkdGhpcy0+aXNvYmFyQ29vcmQsICR0aGlzLT5pc29iYXJWYWx1ZXMsICR0aGlzLT5pc29iYXJDb2xvcnMgKTsKICAgIH0KfQoKCi8qKgogKiBUaGlzIGNsYXNzIHJlcHJlc2VudCBhIHBsb3R0aW5nIG9mIGEgY29udG91ciBvdXRsaW5lIG9mIGRhdGEgZ2l2ZW4gYXMgYSBYLVkgbWF0cmljZQogKgogKi8KY2xhc3MgQ29udG91clBsb3QgZXh0ZW5kcyBQbG90IHsKCiAgICBwcml2YXRlICRjb250b3VyLCAkY29udG91ckNvb3JkLCAkY29udG91clZhbCwgJGNvbnRvdXJDb2xvcjsKICAgIHByaXZhdGUgJG5ickNvdW50b3VycyA9IDAgOwogICAgcHJpdmF0ZSAkZGF0YU1hdHJpeCA9IGFycmF5KCk7CiAgICBwcml2YXRlICRpbnZlcnRMZWdlbmQgPSBmYWxzZTsKICAgIHByaXZhdGUgJGludGVycEZhY3RvciA9IDE7CiAgICBwcml2YXRlICRmbGlwRGF0YSA9IGZhbHNlOwogICAgcHJpdmF0ZSAkaXNvYmFyID0gMTA7CiAgICBwcml2YXRlICRzaG93TGVnZW5kID0gZmFsc2U7CiAgICBwcml2YXRlICRoaWdoY29udHJhc3QgPSBmYWxzZSwgJGhpZ2hjb250cmFzdGJ3ID0gZmFsc2U7CiAgICBwcml2YXRlICRtYW51YWxJc29iYXJDb2xvcnMgPSBhcnJheSgpOwoKICAgIC8qKgogICAgICogQ29uc3RydWN0IGEgY29udG91ciBwbG90dGluZyBhbGdvcml0aG0uIFRoZSBlbmQgcmVzdWx0IG9mIHRoZSBhbGdvcml0aG0gaXMgYSBzZXF1ZW5jZSBvZgogICAgICogbGluZSBzZWdtZW50cyBmb3IgZWFjaCBpc29iYXIgZ2l2ZW4gYXMgdHdvIHZlcnRpY2VzLgogICAgICoKICAgICAqIEBwYXJhbSAkYURhdGFNYXRyaXggICAgVGhlIFotZGF0YSB0byBiZSB1c2VkCiAgICAgKiBAcGFyYW0gJGFJc29iYXIgQSBtaXhlZCB2YXJpYWJsZSwgaWYgaXQgaXMgYW4gaW50ZWdlciB0aGVuIHRoaXMgc3BlY2lmaWVkIHRoZSBudW1iZXIgb2YgaXNvYmFycyB0byB1c2UuCiAgICAgKiBUaGUgdmFsdWVzIG9mIHRoZSBpc29iYXJzIGFyZSBhdXRvbWF0aWNhbGx5IGRldHJtaW5lZCB0byBiZSBlcXUtc3BhY2VkIGJldHdlZW4gdGhlIG1pbi9tYXggdmFsdWUgb2YgdGhlCiAgICAgKiBkYXRhLiBJZiBpdCBpcyBhbiBhcnJheSB0aGVuIGl0IGV4cGxpY2V0ZWx5IGdpdmVzIHRoZSBpc29iYXIgdmFsdWVzCiAgICAgKiBAcGFyYW0gJGFJbnZlcnQgQnkgZGVmYXVsdCB0aGUgbWF0cmljZSB3aXRoIHJvdyBpbmRleCAwIGNvcnJlc3BvbmRzIHRvIFktdmFsdWUgMCwgaS5lLiBpbiB0aGUgYm90dG9tIG9mCiAgICAgKiB0aGUgcGxvdC4gSWYgdGhpcyBhcmd1bWVudCBpcyB0cnVlIHRoZW4gdGhlIHJvdyB3aXRoIHRoZSBoaWdoZXN0IGluZGV4IGluIHRoZSBtYXRyaWNlIGNvcnJlc3BvbmRzICB0bwogICAgICogWS12YWx1ZSAwLiBJbiBhZmZlY3QgZmxpcHBpbmcgdGhlIG1hdHJpY2UgYXJvdW5kIGFuIGltYWdpbmFyeSBob3Jpem9udGFsIGF4aXMuCiAgICAgKiBAcGFyYW0gJGFIaWdoQ29udHJhc3QgVXNlIGhpZ2ggY29udHJhc3QgY29sb3JzIChibHVlL3JlZDppc2gpCiAgICAgKiBAcGFyYW0gJGFIaWdoQ29udHJhc3RCVyBVc2Ugb25seSBibGFjayBjb2xvcnMgZm9yIGNvbnRvdXJzCiAgICAgKiBAcmV0dXJuIGFuIGluc3RhbmNlIG9mIHRoZSBjb250b3VyIHBsb3QgYWxnb3JpdGhtCiAgICAgKi8KICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRhRGF0YU1hdHJpeCwgJGFJc29iYXI9MTAsICRhRmFjdG9yPTEsICRhSW52ZXJ0PWZhbHNlLCAkYUlzb2JhckNvbG9ycz1hcnJheSgpKSB7CgogICAgICAgICR0aGlzLT5kYXRhTWF0cml4ID0gJGFEYXRhTWF0cml4OwogICAgICAgICR0aGlzLT5mbGlwRGF0YSA9ICRhSW52ZXJ0OwogICAgICAgICR0aGlzLT5pc29iYXIgPSAkYUlzb2JhcjsKICAgICAgICAkdGhpcy0+aW50ZXJwRmFjdG9yID0gJGFGYWN0b3I7CgogICAgICAgIGlmICggJHRoaXMtPmludGVycEZhY3RvciA+IDEgKSB7CgogICAgICAgICAgICBpZiggJHRoaXMtPmludGVycEZhY3RvciA+IDUgKSB7CiAgICAgICAgICAgICAgICBKcEdyYXBoRXJyb3I6OlJhaXNlTCgyODAwNyk7Ly8gQ29udG91clBsb3QgaW50ZXJwb2xhdGlvbiBmYWN0b3IgaXMgdG9vIGxhcmdlICg+NSkKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJGlwID0gbmV3IE1lc2hJbnRlcnBvbGF0ZSgpOwogICAgICAgICAgICAkdGhpcy0+ZGF0YU1hdHJpeCA9ICRpcC0+TGluZWFyKCR0aGlzLT5kYXRhTWF0cml4LCAkdGhpcy0+aW50ZXJwRmFjdG9yKTsKICAgICAgICB9CgogICAgICAgICR0aGlzLT5jb250b3VyID0gbmV3IENvbnRvdXIoJHRoaXMtPmRhdGFNYXRyaXgsJHRoaXMtPmlzb2JhciwkYUlzb2JhckNvbG9ycyk7CgogICAgICAgIGlmKCBpc19hcnJheSgkYUlzb2JhcikgKQogICAgICAgICAgICAkdGhpcy0+bmJyQ29udG91cnMgPSBjb3VudCgkYUlzb2Jhcik7CiAgICAgICAgZWxzZQogICAgICAgICAgICAkdGhpcy0+bmJyQ29udG91cnMgPSAkYUlzb2JhcjsKICAgIH0KCgogICAgLyoqCiAgICAgKiBGbGlwZSB0aGUgZGF0YSBhcm91bmQgdGhlIGNlbnRlcgogICAgICoKICAgICAqIEBwYXJhbSAkYUZsZwogICAgICoKICAgICAqLwogICAgZnVuY3Rpb24gU2V0SW52ZXJ0KCRhRmxnPXRydWUpIHsKICAgICAgICAkdGhpcy0+ZmxpcERhdGEgPSAkYUZsZzsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCB0aGUgY29sb3JzIGZvciB0aGUgaXNvYmFyIGxpbmVzCiAgICAgKgogICAgICogQHBhcmFtICRhQ29sb3JBcnJheQogICAgICoKICAgICAqLwogICAgZnVuY3Rpb24gU2V0SXNvYmFyQ29sb3JzKCRhQ29sb3JBcnJheSkgewogICAgICAgICR0aGlzLT5tYW51YWxJc29iYXJDb2xvcnMgPSAkYUNvbG9yQXJyYXk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTaG93IHRoZSBsZWdlbmQKICAgICAqCiAgICAgKiBAcGFyYW0gJGFGbGcgdHJ1ZSBpZiB0aGUgbGVnZW5kIHNob3VsZCBiZSBzaG93bgogICAgICoKICAgICAqLwogICAgZnVuY3Rpb24gU2hvd0xlZ2VuZCgkYUZsZz10cnVlKSB7CiAgICAgICAgJHRoaXMtPnNob3dMZWdlbmQgPSAkYUZsZzsKICAgIH0KCgogICAgLyoqCiAgICAgKiBAcGFyYW0gJGFGbGcgdHJ1ZSBpZiB0aGUgbGVnZW5kIHNob3VsZCBzdGFydCB3aXRoIHRoZSBsb3dlc3QgaXNvYmFyIG9uIHRvcAogICAgICogQHJldHVybiB1bmtub3duX3R5cGUKICAgICAqLwogICAgZnVuY3Rpb24gSW52ZXJ0bGVnZW5kKCRhRmxnPXRydWUpIHsKICAgICAgICAkdGhpcy0+aW52ZXJ0TGVnZW5kID0gJGFGbGc7CiAgICB9CgogICAgLyogSW50ZXJuYWwgbWV0aG9kLiBHaXZlIHRoZSBtaW4gdmFsdWUgdG8gYmUgdXNlZCBmb3IgdGhlIHNjYWxpbmcKICAgICAqCiAgICAgKi8KICAgIGZ1bmN0aW9uIE1pbigpIHsKICAgICAgICByZXR1cm4gYXJyYXkoMCwwKTsKICAgIH0KCiAgICAvKiBJbnRlcm5hbCBtZXRob2QuIEdpdmUgdGhlIG1heCB2YWx1ZSB0byBiZSB1c2VkIGZvciB0aGUgc2NhbGluZwogICAgICoKICAgICAqLwogICAgZnVuY3Rpb24gTWF4KCkgewogICAgICAgIHJldHVybiBhcnJheShjb3VudCgkdGhpcy0+ZGF0YU1hdHJpeFswXSktMSxjb3VudCgkdGhpcy0+ZGF0YU1hdHJpeCktMSk7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbnRlcm5hbCByYW1ld3JvayBtZXRob2QgdG8gc2V0dXAgdGhlIGxlZ2VuZCB0byBiZSB1c2VkIGZvciB0aGlzIHBsb3QuCiAgICAgKiBAcGFyYW0gJGFHcmFwaCBUaGUgcGFyZW50IGdyYXBoIGNsYXNzCiAgICAgKi8KICAgIGZ1bmN0aW9uIExlZ2VuZCgkYUdyYXBoKSB7CgogICAgICAgIGlmKCAhICR0aGlzLT5zaG93TGVnZW5kICkKICAgICAgICAgICAgcmV0dXJuOwoKICAgICAgICBpZiggJHRoaXMtPmludmVydExlZ2VuZCApIHsKICAgICAgICAgICAgZm9yICgkaSA9IDA7ICRpIDwgJHRoaXMtPm5ickNvbnRvdXJzOyAkaSsrKSB7CiAgICAgICAgICAgICAgICAkYUdyYXBoLT5sZWdlbmQtPkFkZChzcHJpbnRmKCclLjFmJywkdGhpcy0+Y29udG91clZhbFskaV0pLCAkdGhpcy0+Y29udG91ckNvbG9yWyRpXSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGZvciAoJGkgPSAkdGhpcy0+bmJyQ29udG91cnMtMTsgJGkgPj0gMCA7ICRpLS0pIHsKICAgICAgICAgICAgICAgICRhR3JhcGgtPmxlZ2VuZC0+QWRkKHNwcmludGYoJyUuMWYnLCR0aGlzLT5jb250b3VyVmFsWyRpXSksICR0aGlzLT5jb250b3VyQ29sb3JbJGldKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCgogICAgLyoqCiAgICAgKiAgRnJhbWV3b3JrIGZ1bmN0aW9uIHdoaWNoIGdldHMgY2FsbGVkIGJlZm9yZSB0aGUgU3Ryb2tlKCkgbWV0aG9kIGlzIGNhbGxlZAogICAgICoKICAgICAqICBAc2VlIFBsb3QjUHJlU2NhbGVTZXR1cCgkYUdyYXBoKQogICAgICoKICAgICAqLwogICAgZnVuY3Rpb24gUHJlU2NhbGVTZXR1cCgkYUdyYXBoKSB7CiAgICAgICAgJHhuID0gY291bnQoJHRoaXMtPmRhdGFNYXRyaXhbMF0pLTE7CiAgICAgICAgJHluID0gY291bnQoJHRoaXMtPmRhdGFNYXRyaXgpLTE7CgogICAgICAgICRhR3JhcGgtPnhheGlzLT5zY2FsZS0+VXBkYXRlKCRhR3JhcGgtPmltZywwLCR4bik7CiAgICAgICAgJGFHcmFwaC0+eWF4aXMtPnNjYWxlLT5VcGRhdGUoJGFHcmFwaC0+aW1nLDAsJHluKTsKCiAgICAgICAgJHRoaXMtPmNvbnRvdXItPlNldEludmVydCgkdGhpcy0+ZmxpcERhdGEpOwogICAgICAgIGxpc3QoJHRoaXMtPmNvbnRvdXJDb29yZCwkdGhpcy0+Y29udG91clZhbCwkdGhpcy0+Y29udG91ckNvbG9yKSA9ICR0aGlzLT5jb250b3VyLT5nZXRJc29iYXJzKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBVc2UgaGlnaCBjb250cmFzdCBjb2xvciBzY2hlbWEKICAgICAqCiAgICAgKiBAcGFyYW0gJGFGbGcgVHJ1ZSwgdG8gdXNlIGhpZ2ggY29udHJhc3QgY29sb3IKICAgICAqIEBwYXJhbSAkYUJXIFRydWUsIFVzZSBvbmx5IGJsYWNrIGFuZCB3aGl0ZSBjb2xvciBzY2hlbWEKICAgICAqLwogICAgZnVuY3Rpb24gVXNlSGlnaENvbnRyYXN0Q29sb3IoJGFGbGc9dHJ1ZSwkYUJXPWZhbHNlKSB7CiAgICAgICAgJHRoaXMtPmhpZ2hjb250cmFzdCA9ICRhRmxnOwogICAgICAgICR0aGlzLT5oaWdoY29udHJhc3RidyA9ICRhQlc7CiAgICAgICAgJHRoaXMtPmNvbnRvdXItPlVzZUhpZ2hDb250cmFzdENvbG9yKCR0aGlzLT5oaWdoY29udHJhc3QsJHRoaXMtPmhpZ2hjb250cmFzdGJ3KTsKICAgIH0KCiAgICAvKioKICAgICAqIEludGVybmFsIG1ldGhvZC4gU3Ryb2tlIHRoZSBjb250b3VyIHBsb3QgdG8gdGhlIGdyYXBoCiAgICAgKgogICAgICogQHBhcmFtICRpbWcgSW1hZ2UgaGFuZGxlcgogICAgICogQHBhcmFtICR4c2NhbGUgSW5zdGFuY2Ugb2YgdGhlIHhzY2FsZSB0byB1c2UKICAgICAqIEBwYXJhbSAkeXNjYWxlIEluc3RhbmNlIG9mIHRoZSB5c2NhbGUgdG8gdXNlCiAgICAgKi8KICAgIGZ1bmN0aW9uIFN0cm9rZSgkaW1nLCR4c2NhbGUsJHlzY2FsZSkgewoKICAgICAgICBpZiggY291bnQoJHRoaXMtPm1hbnVhbElzb2JhckNvbG9ycykgPiAwICkgewogICAgICAgICAgICAkdGhpcy0+Y29udG91ckNvbG9yID0gJHRoaXMtPm1hbnVhbElzb2JhckNvbG9yczsKICAgICAgICAgICAgaWYoIGNvdW50KCR0aGlzLT5tYW51YWxJc29iYXJDb2xvcnMpICE9ICR0aGlzLT5uYnJDb250b3VycyApIHsKICAgICAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDI4MDAyKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgJGltZy0+U2V0TGluZVdlaWdodCgkdGhpcy0+bGluZV93ZWlnaHQpOwoKICAgICAgICBmb3IgKCRjID0gMDsgJGMgPCAkdGhpcy0+bmJyQ29udG91cnM7ICRjKyspIHsKCiAgICAgICAgICAgICRpbWctPlNldENvbG9yKCAkdGhpcy0+Y29udG91ckNvbG9yWyRjXSApOwoKICAgICAgICAgICAgJG4gPSBjb3VudCgkdGhpcy0+Y29udG91ckNvb3JkWyRjXSk7CiAgICAgICAgICAgICRpID0gMDsKICAgICAgICAgICAgd2hpbGUgKCAkaSA8ICRuICkgewogICAgICAgICAgICAgICAgbGlzdCgkeDEsJHkxKSA9ICR0aGlzLT5jb250b3VyQ29vcmRbJGNdWyRpXVswXTsKICAgICAgICAgICAgICAgICR4MXQgPSAkeHNjYWxlLT5UcmFuc2xhdGUoJHgxKTsKICAgICAgICAgICAgICAgICR5MXQgPSAkeXNjYWxlLT5UcmFuc2xhdGUoJHkxKTsKCiAgICAgICAgICAgICAgICBsaXN0KCR4MiwkeTIpID0gJHRoaXMtPmNvbnRvdXJDb29yZFskY11bJGkrK11bMV07CiAgICAgICAgICAgICAgICAkeDJ0ID0gJHhzY2FsZS0+VHJhbnNsYXRlKCR4Mik7CiAgICAgICAgICAgICAgICAkeTJ0ID0gJHlzY2FsZS0+VHJhbnNsYXRlKCR5Mik7CgogICAgICAgICAgICAgICAgJGltZy0+TGluZSgkeDF0LCR5MXQsJHgydCwkeTJ0KTsKICAgICAgICAgICAgfQoKICAgICAgICB9CiAgICB9Cgp9CgovLyBFT0YKPz4K",
    "size": "21081"
}