{
    "namaFile": "lib\/PHPExcel\/Classes\/PHPExcel\/Writer\/Excel5.php",
    "lastUpdate": "2017-12-25+01:39:38.00",
    "contentFile": "PD9waHAKCi8qKgogKiBQSFBFeGNlbF9Xcml0ZXJfRXhjZWw1CiAqCiAqIENvcHlyaWdodCAoYykgMjAwNiAtIDIwMTUgUEhQRXhjZWwKICoKICogVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgogKiBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCiAqIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlcgogKiB2ZXJzaW9uIDIuMSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KICoKICogVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCiAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCiAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VCiAqIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCiAqCiAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKICogTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZQogKiBGb3VuZGF0aW9uLCBJbmMuLCA1MSBGcmFua2xpbiBTdHJlZXQsIEZpZnRoIEZsb29yLCBCb3N0b24sIE1BICAwMjExMC0xMzAxICBVU0EKICoKICogQGNhdGVnb3J5ICAgUEhQRXhjZWwKICogQHBhY2thZ2UgICAgUEhQRXhjZWxfV3JpdGVyX0V4Y2VsNQogKiBAY29weXJpZ2h0ICBDb3B5cmlnaHQgKGMpIDIwMDYgLSAyMDE1IFBIUEV4Y2VsIChodHRwOi8vd3d3LmNvZGVwbGV4LmNvbS9QSFBFeGNlbCkKICogQGxpY2Vuc2UgICAgaHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL29sZC1saWNlbnNlcy9sZ3BsLTIuMS50eHQgICAgTEdQTAogKiBAdmVyc2lvbiAgICAjI1ZFUlNJT04jIywgIyNEQVRFIyMKICovCmNsYXNzIFBIUEV4Y2VsX1dyaXRlcl9FeGNlbDUgZXh0ZW5kcyBQSFBFeGNlbF9Xcml0ZXJfQWJzdHJhY3QgaW1wbGVtZW50cyBQSFBFeGNlbF9Xcml0ZXJfSVdyaXRlcgp7CiAgICAvKioKICAgICAqIFBIUEV4Y2VsIG9iamVjdAogICAgICoKICAgICAqIEB2YXIgUEhQRXhjZWwKICAgICAqLwogICAgcHJpdmF0ZSAkcGhwRXhjZWw7CgogICAgLyoqCiAgICAgKiBUb3RhbCBudW1iZXIgb2Ygc2hhcmVkIHN0cmluZ3MgaW4gd29ya2Jvb2sKICAgICAqCiAgICAgKiBAdmFyIGludAogICAgICovCiAgICBwcml2YXRlICRzdHJUb3RhbCA9IDA7CgogICAgLyoqCiAgICAgKiBOdW1iZXIgb2YgdW5pcXVlIHNoYXJlZCBzdHJpbmdzIGluIHdvcmtib29rCiAgICAgKgogICAgICogQHZhciBpbnQKICAgICAqLwogICAgcHJpdmF0ZSAkc3RyVW5pcXVlID0gMDsKCiAgICAvKioKICAgICAqIEFycmF5IG9mIHVuaXF1ZSBzaGFyZWQgc3RyaW5ncyBpbiB3b3JrYm9vawogICAgICoKICAgICAqIEB2YXIgYXJyYXkKICAgICAqLwogICAgcHJpdmF0ZSAkc3RyVGFibGUgPSBhcnJheSgpOwoKICAgIC8qKgogICAgICogQ29sb3IgY2FjaGUuIE1hcHBpbmcgYmV0d2VlbiBSR0IgdmFsdWUgYW5kIGNvbG9yIGluZGV4LgogICAgICoKICAgICAqIEB2YXIgYXJyYXkKICAgICAqLwogICAgcHJpdmF0ZSAkY29sb3JzOwoKICAgIC8qKgogICAgICogRm9ybXVsYSBwYXJzZXIKICAgICAqCiAgICAgKiBAdmFyIFBIUEV4Y2VsX1dyaXRlcl9FeGNlbDVfUGFyc2VyCiAgICAgKi8KICAgIHByaXZhdGUgJHBhcnNlcjsKCiAgICAvKioKICAgICAqIElkZW50aWZpZXIgY2x1c3RlcnMgZm9yIGRyYXdpbmdzLiBVc2VkIGluIE1TT0RSQVdJTkdHUk9VUCByZWNvcmQuCiAgICAgKgogICAgICogQHZhciBhcnJheQogICAgICovCiAgICBwcml2YXRlICRJRENMczsKCiAgICAvKioKICAgICAqIEJhc2ljIE9MRSBvYmplY3Qgc3VtbWFyeSBpbmZvcm1hdGlvbgogICAgICoKICAgICAqIEB2YXIgYXJyYXkKICAgICAqLwogICAgcHJpdmF0ZSAkc3VtbWFyeUluZm9ybWF0aW9uOwoKICAgIC8qKgogICAgICogRXh0ZW5kZWQgT0xFIG9iamVjdCBkb2N1bWVudCBzdW1tYXJ5IGluZm9ybWF0aW9uCiAgICAgKgogICAgICogQHZhciBhcnJheQogICAgICovCiAgICBwcml2YXRlICRkb2N1bWVudFN1bW1hcnlJbmZvcm1hdGlvbjsKCiAgICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyBQSFBFeGNlbF9Xcml0ZXJfRXhjZWw1CiAgICAgKgogICAgICogQHBhcmFtICAgIFBIUEV4Y2VsICAgICRwaHBFeGNlbCAgICBQSFBFeGNlbCBvYmplY3QKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KFBIUEV4Y2VsICRwaHBFeGNlbCkKICAgIHsKICAgICAgICAkdGhpcy0+cGhwRXhjZWwgICAgPSAkcGhwRXhjZWw7CgogICAgICAgICR0aGlzLT5wYXJzZXIgICAgICAgID0gbmV3IFBIUEV4Y2VsX1dyaXRlcl9FeGNlbDVfUGFyc2VyKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiBTYXZlIFBIUEV4Y2VsIHRvIGZpbGUKICAgICAqCiAgICAgKiBAcGFyYW0gICAgc3RyaW5nICAgICAgICAkcEZpbGVuYW1lCiAgICAgKiBAdGhyb3dzICAgIFBIUEV4Y2VsX1dyaXRlcl9FeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIHNhdmUoJHBGaWxlbmFtZSA9IG51bGwpCiAgICB7CgogICAgICAgIC8vIGdhcmJhZ2UgY29sbGVjdAogICAgICAgICR0aGlzLT5waHBFeGNlbC0+Z2FyYmFnZUNvbGxlY3QoKTsKCiAgICAgICAgJHNhdmVEZWJ1Z0xvZyA9IFBIUEV4Y2VsX0NhbGN1bGF0aW9uOjpnZXRJbnN0YW5jZSgkdGhpcy0+cGhwRXhjZWwpLT5nZXREZWJ1Z0xvZygpLT5nZXRXcml0ZURlYnVnTG9nKCk7CiAgICAgICAgUEhQRXhjZWxfQ2FsY3VsYXRpb246OmdldEluc3RhbmNlKCR0aGlzLT5waHBFeGNlbCktPmdldERlYnVnTG9nKCktPnNldFdyaXRlRGVidWdMb2coZmFsc2UpOwogICAgICAgICRzYXZlRGF0ZVJldHVyblR5cGUgPSBQSFBFeGNlbF9DYWxjdWxhdGlvbl9GdW5jdGlvbnM6OmdldFJldHVybkRhdGVUeXBlKCk7CiAgICAgICAgUEhQRXhjZWxfQ2FsY3VsYXRpb25fRnVuY3Rpb25zOjpzZXRSZXR1cm5EYXRlVHlwZShQSFBFeGNlbF9DYWxjdWxhdGlvbl9GdW5jdGlvbnM6OlJFVFVSTkRBVEVfRVhDRUwpOwoKICAgICAgICAvLyBpbml0aWFsaXplIGNvbG9ycyBhcnJheQogICAgICAgICR0aGlzLT5jb2xvcnMgPSBhcnJheSgpOwoKICAgICAgICAvLyBJbml0aWFsaXNlIHdvcmtib29rIHdyaXRlcgogICAgICAgICR0aGlzLT53cml0ZXJXb3JrYm9vayA9IG5ldyBQSFBFeGNlbF9Xcml0ZXJfRXhjZWw1X1dvcmtib29rKCR0aGlzLT5waHBFeGNlbCwgJHRoaXMtPnN0clRvdGFsLCAkdGhpcy0+c3RyVW5pcXVlLCAkdGhpcy0+c3RyVGFibGUsICR0aGlzLT5jb2xvcnMsICR0aGlzLT5wYXJzZXIpOwoKICAgICAgICAvLyBJbml0aWFsaXNlIHdvcmtzaGVldCB3cml0ZXJzCiAgICAgICAgJGNvdW50U2hlZXRzID0gJHRoaXMtPnBocEV4Y2VsLT5nZXRTaGVldENvdW50KCk7CiAgICAgICAgZm9yICgkaSA9IDA7ICRpIDwgJGNvdW50U2hlZXRzOyArKyRpKSB7CiAgICAgICAgICAgICR0aGlzLT53cml0ZXJXb3Jrc2hlZXRzWyRpXSA9IG5ldyBQSFBFeGNlbF9Xcml0ZXJfRXhjZWw1X1dvcmtzaGVldCgkdGhpcy0+c3RyVG90YWwsICR0aGlzLT5zdHJVbmlxdWUsICR0aGlzLT5zdHJUYWJsZSwgJHRoaXMtPmNvbG9ycywgJHRoaXMtPnBhcnNlciwgJHRoaXMtPnByZUNhbGN1bGF0ZUZvcm11bGFzLCAkdGhpcy0+cGhwRXhjZWwtPmdldFNoZWV0KCRpKSk7CiAgICAgICAgfQoKICAgICAgICAvLyBidWlsZCBFc2NoZXIgb2JqZWN0cy4gRXNjaGVyIG9iamVjdHMgZm9yIHdvcmtib29rcyBuZWVkcyB0byBiZSBidWlsZCBiZWZvcmUgRXNjaGVyIG9iamVjdCBmb3Igd29ya2Jvb2suCiAgICAgICAgJHRoaXMtPmJ1aWxkV29ya3NoZWV0RXNjaGVycygpOwogICAgICAgICR0aGlzLT5idWlsZFdvcmtib29rRXNjaGVyKCk7CgogICAgICAgIC8vIGFkZCAxNSBpZGVudGljYWwgY2VsbCBzdHlsZSBYZnMKICAgICAgICAvLyBmb3Igbm93LCB3ZSB1c2UgdGhlIGZpcnN0IGNlbGxYZiBpbnN0ZWFkIG9mIGNlbGxTdHlsZVhmCiAgICAgICAgJGNlbGxYZkNvbGxlY3Rpb24gPSAkdGhpcy0+cGhwRXhjZWwtPmdldENlbGxYZkNvbGxlY3Rpb24oKTsKICAgICAgICBmb3IgKCRpID0gMDsgJGkgPCAxNTsgKyskaSkgewogICAgICAgICAgICAkdGhpcy0+d3JpdGVyV29ya2Jvb2stPmFkZFhmV3JpdGVyKCRjZWxsWGZDb2xsZWN0aW9uWzBdLCB0cnVlKTsKICAgICAgICB9CgogICAgICAgIC8vIGFkZCBhbGwgdGhlIGNlbGwgWGZzCiAgICAgICAgZm9yZWFjaCAoJHRoaXMtPnBocEV4Y2VsLT5nZXRDZWxsWGZDb2xsZWN0aW9uKCkgYXMgJHN0eWxlKSB7CiAgICAgICAgICAgICR0aGlzLT53cml0ZXJXb3JrYm9vay0+YWRkWGZXcml0ZXIoJHN0eWxlLCBmYWxzZSk7CiAgICAgICAgfQoKICAgICAgICAvLyBhZGQgZm9udHMgZnJvbSByaWNoIHRleHQgZWxlZW1udHMKICAgICAgICBmb3IgKCRpID0gMDsgJGkgPCAkY291bnRTaGVldHM7ICsrJGkpIHsKICAgICAgICAgICAgZm9yZWFjaCAoJHRoaXMtPndyaXRlcldvcmtzaGVldHNbJGldLT5waHBTaGVldC0+Z2V0Q2VsbENvbGxlY3Rpb24oKSBhcyAkY2VsbElEKSB7CiAgICAgICAgICAgICAgICAkY2VsbCA9ICR0aGlzLT53cml0ZXJXb3Jrc2hlZXRzWyRpXS0+cGhwU2hlZXQtPmdldENlbGwoJGNlbGxJRCk7CiAgICAgICAgICAgICAgICAkY1ZhbCA9ICRjZWxsLT5nZXRWYWx1ZSgpOwogICAgICAgICAgICAgICAgaWYgKCRjVmFsIGluc3RhbmNlb2YgUEhQRXhjZWxfUmljaFRleHQpIHsKICAgICAgICAgICAgICAgICAgICAkZWxlbWVudHMgPSAkY1ZhbC0+Z2V0UmljaFRleHRFbGVtZW50cygpOwogICAgICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRlbGVtZW50cyBhcyAkZWxlbWVudCkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAoJGVsZW1lbnQgaW5zdGFuY2VvZiBQSFBFeGNlbF9SaWNoVGV4dF9SdW4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRmb250ID0gJGVsZW1lbnQtPmdldEZvbnQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT53cml0ZXJXb3Jrc2hlZXRzWyRpXS0+Zm9udEhhc2hJbmRleFskZm9udC0+Z2V0SGFzaENvZGUoKV0gPSAkdGhpcy0+d3JpdGVyV29ya2Jvb2stPmFkZEZvbnQoJGZvbnQpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBpbml0aWFsaXplIE9MRSBmaWxlCiAgICAgICAgJHdvcmtib29rU3RyZWFtTmFtZSA9ICdXb3JrYm9vayc7CiAgICAgICAgJE9MRSA9IG5ldyBQSFBFeGNlbF9TaGFyZWRfT0xFX1BQU19GaWxlKFBIUEV4Y2VsX1NoYXJlZF9PTEU6OkFzYzJVY3MoJHdvcmtib29rU3RyZWFtTmFtZSkpOwoKICAgICAgICAvLyBXcml0ZSB0aGUgd29ya3NoZWV0IHN0cmVhbXMgYmVmb3JlIHRoZSBnbG9iYWwgd29ya2Jvb2sgc3RyZWFtLAogICAgICAgIC8vIGJlY2F1c2UgdGhlIGJ5dGUgc2l6ZXMgb2YgdGhlc2UgYXJlIG5lZWRlZCBpbiB0aGUgZ2xvYmFsIHdvcmtib29rIHN0cmVhbQogICAgICAgICR3b3Jrc2hlZXRTaXplcyA9IGFycmF5KCk7CiAgICAgICAgZm9yICgkaSA9IDA7ICRpIDwgJGNvdW50U2hlZXRzOyArKyRpKSB7CiAgICAgICAgICAgICR0aGlzLT53cml0ZXJXb3Jrc2hlZXRzWyRpXS0+Y2xvc2UoKTsKICAgICAgICAgICAgJHdvcmtzaGVldFNpemVzW10gPSAkdGhpcy0+d3JpdGVyV29ya3NoZWV0c1skaV0tPl9kYXRhc2l6ZTsKICAgICAgICB9CgogICAgICAgIC8vIGFkZCBiaW5hcnkgZGF0YSBmb3IgZ2xvYmFsIHdvcmtib29rIHN0cmVhbQogICAgICAgICRPTEUtPmFwcGVuZCgkdGhpcy0+d3JpdGVyV29ya2Jvb2stPndyaXRlV29ya2Jvb2soJHdvcmtzaGVldFNpemVzKSk7CgogICAgICAgIC8vIGFkZCBiaW5hcnkgZGF0YSBmb3Igc2hlZXQgc3RyZWFtcwogICAgICAgIGZvciAoJGkgPSAwOyAkaSA8ICRjb3VudFNoZWV0czsgKyskaSkgewogICAgICAgICAgICAkT0xFLT5hcHBlbmQoJHRoaXMtPndyaXRlcldvcmtzaGVldHNbJGldLT5nZXREYXRhKCkpOwogICAgICAgIH0KCiAgICAgICAgJHRoaXMtPmRvY3VtZW50U3VtbWFyeUluZm9ybWF0aW9uID0gJHRoaXMtPndyaXRlRG9jdW1lbnRTdW1tYXJ5SW5mb3JtYXRpb24oKTsKICAgICAgICAvLyBpbml0aWFsaXplIE9MRSBEb2N1bWVudCBTdW1tYXJ5IEluZm9ybWF0aW9uCiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5kb2N1bWVudFN1bW1hcnlJbmZvcm1hdGlvbikgJiYgIWVtcHR5KCR0aGlzLT5kb2N1bWVudFN1bW1hcnlJbmZvcm1hdGlvbikpIHsKICAgICAgICAgICAgJE9MRV9Eb2N1bWVudFN1bW1hcnlJbmZvcm1hdGlvbiA9IG5ldyBQSFBFeGNlbF9TaGFyZWRfT0xFX1BQU19GaWxlKFBIUEV4Y2VsX1NoYXJlZF9PTEU6OkFzYzJVY3MoY2hyKDUpIC4gJ0RvY3VtZW50U3VtbWFyeUluZm9ybWF0aW9uJykpOwogICAgICAgICAgICAkT0xFX0RvY3VtZW50U3VtbWFyeUluZm9ybWF0aW9uLT5hcHBlbmQoJHRoaXMtPmRvY3VtZW50U3VtbWFyeUluZm9ybWF0aW9uKTsKICAgICAgICB9CgogICAgICAgICR0aGlzLT5zdW1tYXJ5SW5mb3JtYXRpb24gPSAkdGhpcy0+d3JpdGVTdW1tYXJ5SW5mb3JtYXRpb24oKTsKICAgICAgICAvLyBpbml0aWFsaXplIE9MRSBTdW1tYXJ5IEluZm9ybWF0aW9uCiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5zdW1tYXJ5SW5mb3JtYXRpb24pICYmICFlbXB0eSgkdGhpcy0+c3VtbWFyeUluZm9ybWF0aW9uKSkgewogICAgICAgICAgICAkT0xFX1N1bW1hcnlJbmZvcm1hdGlvbiA9IG5ldyBQSFBFeGNlbF9TaGFyZWRfT0xFX1BQU19GaWxlKFBIUEV4Y2VsX1NoYXJlZF9PTEU6OkFzYzJVY3MoY2hyKDUpIC4gJ1N1bW1hcnlJbmZvcm1hdGlvbicpKTsKICAgICAgICAgICAgJE9MRV9TdW1tYXJ5SW5mb3JtYXRpb24tPmFwcGVuZCgkdGhpcy0+c3VtbWFyeUluZm9ybWF0aW9uKTsKICAgICAgICB9CgogICAgICAgIC8vIGRlZmluZSBPTEUgUGFydHMKICAgICAgICAkYXJyUm9vdERhdGEgPSBhcnJheSgkT0xFKTsKICAgICAgICAvLyBpbml0aWFsaXplIE9MRSBQcm9wZXJ0aWVzIGZpbGUKICAgICAgICBpZiAoaXNzZXQoJE9MRV9TdW1tYXJ5SW5mb3JtYXRpb24pKSB7CiAgICAgICAgICAgICRhcnJSb290RGF0YVtdID0gJE9MRV9TdW1tYXJ5SW5mb3JtYXRpb247CiAgICAgICAgfQogICAgICAgIC8vIGluaXRpYWxpemUgT0xFIEV4dGVuZGVkIFByb3BlcnRpZXMgZmlsZQogICAgICAgIGlmIChpc3NldCgkT0xFX0RvY3VtZW50U3VtbWFyeUluZm9ybWF0aW9uKSkgewogICAgICAgICAgICAkYXJyUm9vdERhdGFbXSA9ICRPTEVfRG9jdW1lbnRTdW1tYXJ5SW5mb3JtYXRpb247CiAgICAgICAgfQoKICAgICAgICAkcm9vdCA9IG5ldyBQSFBFeGNlbF9TaGFyZWRfT0xFX1BQU19Sb290KHRpbWUoKSwgdGltZSgpLCAkYXJyUm9vdERhdGEpOwogICAgICAgIC8vIHNhdmUgdGhlIE9MRSBmaWxlCiAgICAgICAgJHJlcyA9ICRyb290LT5zYXZlKCRwRmlsZW5hbWUpOwoKICAgICAgICBQSFBFeGNlbF9DYWxjdWxhdGlvbl9GdW5jdGlvbnM6OnNldFJldHVybkRhdGVUeXBlKCRzYXZlRGF0ZVJldHVyblR5cGUpOwogICAgICAgIFBIUEV4Y2VsX0NhbGN1bGF0aW9uOjpnZXRJbnN0YW5jZSgkdGhpcy0+cGhwRXhjZWwpLT5nZXREZWJ1Z0xvZygpLT5zZXRXcml0ZURlYnVnTG9nKCRzYXZlRGVidWdMb2cpOwogICAgfQoKICAgIC8qKgogICAgICogU2V0IHRlbXBvcmFyeSBzdG9yYWdlIGRpcmVjdG9yeQogICAgICoKICAgICAqIEBkZXByZWNhdGVkCiAgICAgKiBAcGFyYW0gICAgc3RyaW5nICAgICRwVmFsdWUgICAgICAgIFRlbXBvcmFyeSBzdG9yYWdlIGRpcmVjdG9yeQogICAgICogQHRocm93cyAgICBQSFBFeGNlbF9Xcml0ZXJfRXhjZXB0aW9uICAgIHdoZW4gZGlyZWN0b3J5IGRvZXMgbm90IGV4aXN0CiAgICAgKiBAcmV0dXJuIFBIUEV4Y2VsX1dyaXRlcl9FeGNlbDUKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIHNldFRlbXBEaXIoJHBWYWx1ZSA9ICcnKQogICAgewogICAgICAgIHJldHVybiAkdGhpczsKICAgIH0KCiAgICAvKioKICAgICAqIEJ1aWxkIHRoZSBXb3Jrc2hlZXQgRXNjaGVyIG9iamVjdHMKICAgICAqCiAgICAgKi8KICAgIHByaXZhdGUgZnVuY3Rpb24gYnVpbGRXb3Jrc2hlZXRFc2NoZXJzKCkKICAgIHsKICAgICAgICAvLyAxLWJhc2VkIGluZGV4IHRvIEJzdG9yZUNvbnRhaW5lcgogICAgICAgICRibGlwSW5kZXggPSAwOwogICAgICAgICRsYXN0UmVkdWNlZFNwSWQgPSAwOwogICAgICAgICRsYXN0U3BJZCA9IDA7CgogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5waHBFeGNlbC0+Z2V0QWxsc2hlZXRzKCkgYXMgJHNoZWV0KSB7CiAgICAgICAgICAgIC8vIHNoZWV0IGluZGV4CiAgICAgICAgICAgICRzaGVldEluZGV4ID0gJHNoZWV0LT5nZXRQYXJlbnQoKS0+Z2V0SW5kZXgoJHNoZWV0KTsKCiAgICAgICAgICAgICRlc2NoZXIgPSBudWxsOwoKICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlcmUgYXJlIGFueSBzaGFwZXMgZm9yIHRoaXMgc2hlZXQKICAgICAgICAgICAgJGZpbHRlclJhbmdlID0gJHNoZWV0LT5nZXRBdXRvRmlsdGVyKCktPmdldFJhbmdlKCk7CiAgICAgICAgICAgIGlmIChjb3VudCgkc2hlZXQtPmdldERyYXdpbmdDb2xsZWN0aW9uKCkpID09IDAgJiYgZW1wdHkoJGZpbHRlclJhbmdlKSkgewogICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIGNyZWF0ZSBpbnRlcm1lZGlhdGUgRXNjaGVyIG9iamVjdAogICAgICAgICAgICAkZXNjaGVyID0gbmV3IFBIUEV4Y2VsX1NoYXJlZF9Fc2NoZXIoKTsKCiAgICAgICAgICAgIC8vIGRnQ29udGFpbmVyCiAgICAgICAgICAgICRkZ0NvbnRhaW5lciA9IG5ldyBQSFBFeGNlbF9TaGFyZWRfRXNjaGVyX0RnQ29udGFpbmVyKCk7CgogICAgICAgICAgICAvLyBzZXQgdGhlIGRyYXdpbmcgaW5kZXggKHdlIHVzZSBzaGVldCBpbmRleCArIDEpCiAgICAgICAgICAgICRkZ0lkID0gJHNoZWV0LT5nZXRQYXJlbnQoKS0+Z2V0SW5kZXgoJHNoZWV0KSArIDE7CiAgICAgICAgICAgICRkZ0NvbnRhaW5lci0+c2V0RGdJZCgkZGdJZCk7CiAgICAgICAgICAgICRlc2NoZXItPnNldERnQ29udGFpbmVyKCRkZ0NvbnRhaW5lcik7CgogICAgICAgICAgICAvLyBzcGdyQ29udGFpbmVyCiAgICAgICAgICAgICRzcGdyQ29udGFpbmVyID0gbmV3IFBIUEV4Y2VsX1NoYXJlZF9Fc2NoZXJfRGdDb250YWluZXJfU3BnckNvbnRhaW5lcigpOwogICAgICAgICAgICAkZGdDb250YWluZXItPnNldFNwZ3JDb250YWluZXIoJHNwZ3JDb250YWluZXIpOwoKICAgICAgICAgICAgLy8gYWRkIG9uZSBzaGFwZSB3aGljaCBpcyB0aGUgZ3JvdXAgc2hhcGUKICAgICAgICAgICAgJHNwQ29udGFpbmVyID0gbmV3IFBIUEV4Y2VsX1NoYXJlZF9Fc2NoZXJfRGdDb250YWluZXJfU3BnckNvbnRhaW5lcl9TcENvbnRhaW5lcigpOwogICAgICAgICAgICAkc3BDb250YWluZXItPnNldFNwZ3IodHJ1ZSk7CiAgICAgICAgICAgICRzcENvbnRhaW5lci0+c2V0U3BUeXBlKDApOwogICAgICAgICAgICAkc3BDb250YWluZXItPnNldFNwSWQoKCRzaGVldC0+Z2V0UGFyZW50KCktPmdldEluZGV4KCRzaGVldCkgKyAxKSA8PCAxMCk7CiAgICAgICAgICAgICRzcGdyQ29udGFpbmVyLT5hZGRDaGlsZCgkc3BDb250YWluZXIpOwoKICAgICAgICAgICAgLy8gYWRkIHRoZSBzaGFwZXMKCiAgICAgICAgICAgICRjb3VudFNoYXBlc1skc2hlZXRJbmRleF0gPSAwOyAvLyBjb3VudCBudW1iZXIgb2Ygc2hhcGVzIChtaW51cyBncm91cCBzaGFwZSksIGluIHNoZWV0CgogICAgICAgICAgICBmb3JlYWNoICgkc2hlZXQtPmdldERyYXdpbmdDb2xsZWN0aW9uKCkgYXMgJGRyYXdpbmcpIHsKICAgICAgICAgICAgICAgICsrJGJsaXBJbmRleDsKCiAgICAgICAgICAgICAgICArKyRjb3VudFNoYXBlc1skc2hlZXRJbmRleF07CgogICAgICAgICAgICAgICAgLy8gYWRkIHRoZSBzaGFwZQogICAgICAgICAgICAgICAgJHNwQ29udGFpbmVyID0gbmV3IFBIUEV4Y2VsX1NoYXJlZF9Fc2NoZXJfRGdDb250YWluZXJfU3BnckNvbnRhaW5lcl9TcENvbnRhaW5lcigpOwoKICAgICAgICAgICAgICAgIC8vIHNldCB0aGUgc2hhcGUgdHlwZQogICAgICAgICAgICAgICAgJHNwQ29udGFpbmVyLT5zZXRTcFR5cGUoMHgwMDRCKTsKICAgICAgICAgICAgICAgIC8vIHNldCB0aGUgc2hhcGUgZmxhZwogICAgICAgICAgICAgICAgJHNwQ29udGFpbmVyLT5zZXRTcEZsYWcoMHgwMik7CgogICAgICAgICAgICAgICAgLy8gc2V0IHRoZSBzaGFwZSBpbmRleCAod2UgY29tYmluZSAxLWJhc2VkIHNoZWV0IGluZGV4IGFuZCAkY291bnRTaGFwZXMgdG8gY3JlYXRlIHVuaXF1ZSBzaGFwZSBpbmRleCkKICAgICAgICAgICAgICAgICRyZWR1Y2VkU3BJZCA9ICRjb3VudFNoYXBlc1skc2hlZXRJbmRleF07CiAgICAgICAgICAgICAgICAkc3BJZCA9ICRyZWR1Y2VkU3BJZAogICAgICAgICAgICAgICAgICAgIHwgKCRzaGVldC0+Z2V0UGFyZW50KCktPmdldEluZGV4KCRzaGVldCkgKyAxKSA8PCAxMDsKICAgICAgICAgICAgICAgICRzcENvbnRhaW5lci0+c2V0U3BJZCgkc3BJZCk7CgogICAgICAgICAgICAgICAgLy8ga2VlcCB0cmFjayBvZiBsYXN0IHJlZHVjZWRTcElkCiAgICAgICAgICAgICAgICAkbGFzdFJlZHVjZWRTcElkID0gJHJlZHVjZWRTcElkOwoKICAgICAgICAgICAgICAgIC8vIGtlZXAgdHJhY2sgb2YgbGFzdCBzcElkCiAgICAgICAgICAgICAgICAkbGFzdFNwSWQgPSAkc3BJZDsKCiAgICAgICAgICAgICAgICAvLyBzZXQgdGhlIEJMSVAgaW5kZXgKICAgICAgICAgICAgICAgICRzcENvbnRhaW5lci0+c2V0T1BUKDB4NDEwNCwgJGJsaXBJbmRleCk7CgogICAgICAgICAgICAgICAgLy8gc2V0IGNvb3JkaW5hdGVzIGFuZCBvZmZzZXRzLCBjbGllbnQgYW5jaG9yCiAgICAgICAgICAgICAgICAkY29vcmRpbmF0ZXMgPSAkZHJhd2luZy0+Z2V0Q29vcmRpbmF0ZXMoKTsKICAgICAgICAgICAgICAgICRvZmZzZXRYID0gJGRyYXdpbmctPmdldE9mZnNldFgoKTsKICAgICAgICAgICAgICAgICRvZmZzZXRZID0gJGRyYXdpbmctPmdldE9mZnNldFkoKTsKICAgICAgICAgICAgICAgICR3aWR0aCA9ICRkcmF3aW5nLT5nZXRXaWR0aCgpOwogICAgICAgICAgICAgICAgJGhlaWdodCA9ICRkcmF3aW5nLT5nZXRIZWlnaHQoKTsKCiAgICAgICAgICAgICAgICAkdHdvQW5jaG9yID0gUEhQRXhjZWxfU2hhcmVkX0V4Y2VsNTo6b25lQW5jaG9yMnR3b0FuY2hvcigkc2hlZXQsICRjb29yZGluYXRlcywgJG9mZnNldFgsICRvZmZzZXRZLCAkd2lkdGgsICRoZWlnaHQpOwoKICAgICAgICAgICAgICAgICRzcENvbnRhaW5lci0+c2V0U3RhcnRDb29yZGluYXRlcygkdHdvQW5jaG9yWydzdGFydENvb3JkaW5hdGVzJ10pOwogICAgICAgICAgICAgICAgJHNwQ29udGFpbmVyLT5zZXRTdGFydE9mZnNldFgoJHR3b0FuY2hvclsnc3RhcnRPZmZzZXRYJ10pOwogICAgICAgICAgICAgICAgJHNwQ29udGFpbmVyLT5zZXRTdGFydE9mZnNldFkoJHR3b0FuY2hvclsnc3RhcnRPZmZzZXRZJ10pOwogICAgICAgICAgICAgICAgJHNwQ29udGFpbmVyLT5zZXRFbmRDb29yZGluYXRlcygkdHdvQW5jaG9yWydlbmRDb29yZGluYXRlcyddKTsKICAgICAgICAgICAgICAgICRzcENvbnRhaW5lci0+c2V0RW5kT2Zmc2V0WCgkdHdvQW5jaG9yWydlbmRPZmZzZXRYJ10pOwogICAgICAgICAgICAgICAgJHNwQ29udGFpbmVyLT5zZXRFbmRPZmZzZXRZKCR0d29BbmNob3JbJ2VuZE9mZnNldFknXSk7CgogICAgICAgICAgICAgICAgJHNwZ3JDb250YWluZXItPmFkZENoaWxkKCRzcENvbnRhaW5lcik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIEF1dG9GaWx0ZXJzCiAgICAgICAgICAgIGlmICghZW1wdHkoJGZpbHRlclJhbmdlKSkgewogICAgICAgICAgICAgICAgJHJhbmdlQm91bmRzID0gUEhQRXhjZWxfQ2VsbDo6cmFuZ2VCb3VuZGFyaWVzKCRmaWx0ZXJSYW5nZSk7CiAgICAgICAgICAgICAgICAkaU51bUNvbFN0YXJ0ID0gJHJhbmdlQm91bmRzWzBdWzBdOwogICAgICAgICAgICAgICAgJGlOdW1Db2xFbmQgPSAkcmFuZ2VCb3VuZHNbMV1bMF07CgogICAgICAgICAgICAgICAgJGlJbmMgPSAkaU51bUNvbFN0YXJ0OwogICAgICAgICAgICAgICAgd2hpbGUgKCRpSW5jIDw9ICRpTnVtQ29sRW5kKSB7CiAgICAgICAgICAgICAgICAgICAgKyskY291bnRTaGFwZXNbJHNoZWV0SW5kZXhdOwoKICAgICAgICAgICAgICAgICAgICAvLyBjcmVhdGUgYW4gRHJhd2luZyBPYmplY3QgZm9yIHRoZSBkcm9wZG93bgogICAgICAgICAgICAgICAgICAgICRvRHJhd2luZyAgPSBuZXcgUEhQRXhjZWxfV29ya3NoZWV0X0Jhc2VEcmF3aW5nKCk7CiAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IHRoZSBjb29yZGluYXRlcyBvZiBkcmF3aW5nCiAgICAgICAgICAgICAgICAgICAgJGNEcmF3aW5nICAgPSBQSFBFeGNlbF9DZWxsOjpzdHJpbmdGcm9tQ29sdW1uSW5kZXgoJGlJbmMgLSAxKSAuICRyYW5nZUJvdW5kc1swXVsxXTsKICAgICAgICAgICAgICAgICAgICAkb0RyYXdpbmctPnNldENvb3JkaW5hdGVzKCRjRHJhd2luZyk7CiAgICAgICAgICAgICAgICAgICAgJG9EcmF3aW5nLT5zZXRXb3Jrc2hlZXQoJHNoZWV0KTsKCiAgICAgICAgICAgICAgICAgICAgLy8gYWRkIHRoZSBzaGFwZQogICAgICAgICAgICAgICAgICAgICRzcENvbnRhaW5lciA9IG5ldyBQSFBFeGNlbF9TaGFyZWRfRXNjaGVyX0RnQ29udGFpbmVyX1NwZ3JDb250YWluZXJfU3BDb250YWluZXIoKTsKICAgICAgICAgICAgICAgICAgICAvLyBzZXQgdGhlIHNoYXBlIHR5cGUKICAgICAgICAgICAgICAgICAgICAkc3BDb250YWluZXItPnNldFNwVHlwZSgweDAwQzkpOwogICAgICAgICAgICAgICAgICAgIC8vIHNldCB0aGUgc2hhcGUgZmxhZwogICAgICAgICAgICAgICAgICAgICRzcENvbnRhaW5lci0+c2V0U3BGbGFnKDB4MDEpOwoKICAgICAgICAgICAgICAgICAgICAvLyBzZXQgdGhlIHNoYXBlIGluZGV4ICh3ZSBjb21iaW5lIDEtYmFzZWQgc2hlZXQgaW5kZXggYW5kICRjb3VudFNoYXBlcyB0byBjcmVhdGUgdW5pcXVlIHNoYXBlIGluZGV4KQogICAgICAgICAgICAgICAgICAgICRyZWR1Y2VkU3BJZCA9ICRjb3VudFNoYXBlc1skc2hlZXRJbmRleF07CiAgICAgICAgICAgICAgICAgICAgJHNwSWQgPSAkcmVkdWNlZFNwSWQKICAgICAgICAgICAgICAgICAgICAgICAgfCAoJHNoZWV0LT5nZXRQYXJlbnQoKS0+Z2V0SW5kZXgoJHNoZWV0KSArIDEpIDw8IDEwOwogICAgICAgICAgICAgICAgICAgICRzcENvbnRhaW5lci0+c2V0U3BJZCgkc3BJZCk7CgogICAgICAgICAgICAgICAgICAgIC8vIGtlZXAgdHJhY2sgb2YgbGFzdCByZWR1Y2VkU3BJZAogICAgICAgICAgICAgICAgICAgICRsYXN0UmVkdWNlZFNwSWQgPSAkcmVkdWNlZFNwSWQ7CgogICAgICAgICAgICAgICAgICAgIC8vIGtlZXAgdHJhY2sgb2YgbGFzdCBzcElkCiAgICAgICAgICAgICAgICAgICAgJGxhc3RTcElkID0gJHNwSWQ7CgogICAgICAgICAgICAgICAgICAgICRzcENvbnRhaW5lci0+c2V0T1BUKDB4MDA3RiwgMHgwMTA0MDEwNCk7IC8vIFByb3RlY3Rpb24gLT4gZkxvY2tBZ2FpbnN0R3JvdXBpbmcKICAgICAgICAgICAgICAgICAgICAkc3BDb250YWluZXItPnNldE9QVCgweDAwQkYsIDB4MDAwODAwMDgpOyAvLyBUZXh0IC0+IGZGaXRUZXh0VG9TaGFwZQogICAgICAgICAgICAgICAgICAgICRzcENvbnRhaW5lci0+c2V0T1BUKDB4MDFCRiwgMHgwMDAxMDAwMCk7IC8vIEZpbGwgU3R5bGUgLT4gZk5vRmlsbEhpdFRlc3QKICAgICAgICAgICAgICAgICAgICAkc3BDb250YWluZXItPnNldE9QVCgweDAxRkYsIDB4MDAwODAwMDApOyAvLyBMaW5lIFN0eWxlIC0+IGZOb0xpbmVEcmF3RGFzaAogICAgICAgICAgICAgICAgICAgICRzcENvbnRhaW5lci0+c2V0T1BUKDB4MDNCRiwgMHgwMDBBMDAwMCk7IC8vIEdyb3VwIFNoYXBlIC0+IGZQcmludAoKICAgICAgICAgICAgICAgICAgICAvLyBzZXQgY29vcmRpbmF0ZXMgYW5kIG9mZnNldHMsIGNsaWVudCBhbmNob3IKICAgICAgICAgICAgICAgICAgICAkZW5kQ29vcmRpbmF0ZXMgPSBQSFBFeGNlbF9DZWxsOjpzdHJpbmdGcm9tQ29sdW1uSW5kZXgoUEhQRXhjZWxfQ2VsbDo6c3RyaW5nRnJvbUNvbHVtbkluZGV4KCRpSW5jIC0gMSkpOwogICAgICAgICAgICAgICAgICAgICRlbmRDb29yZGluYXRlcyAuPSAkcmFuZ2VCb3VuZHNbMF1bMV0gKyAxOwoKICAgICAgICAgICAgICAgICAgICAkc3BDb250YWluZXItPnNldFN0YXJ0Q29vcmRpbmF0ZXMoJGNEcmF3aW5nKTsKICAgICAgICAgICAgICAgICAgICAkc3BDb250YWluZXItPnNldFN0YXJ0T2Zmc2V0WCgwKTsKICAgICAgICAgICAgICAgICAgICAkc3BDb250YWluZXItPnNldFN0YXJ0T2Zmc2V0WSgwKTsKICAgICAgICAgICAgICAgICAgICAkc3BDb250YWluZXItPnNldEVuZENvb3JkaW5hdGVzKCRlbmRDb29yZGluYXRlcyk7CiAgICAgICAgICAgICAgICAgICAgJHNwQ29udGFpbmVyLT5zZXRFbmRPZmZzZXRYKDApOwogICAgICAgICAgICAgICAgICAgICRzcENvbnRhaW5lci0+c2V0RW5kT2Zmc2V0WSgwKTsKCiAgICAgICAgICAgICAgICAgICAgJHNwZ3JDb250YWluZXItPmFkZENoaWxkKCRzcENvbnRhaW5lcik7CiAgICAgICAgICAgICAgICAgICAgJGlJbmMrKzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gaWRlbnRpZmllciBjbHVzdGVycywgdXNlZCBmb3Igd29ya2Jvb2sgRXNjaGVyIG9iamVjdAogICAgICAgICAgICAkdGhpcy0+SURDTHNbJGRnSWRdID0gJGxhc3RSZWR1Y2VkU3BJZDsKCiAgICAgICAgICAgIC8vIHNldCBsYXN0IHNoYXBlIGluZGV4CiAgICAgICAgICAgICRkZ0NvbnRhaW5lci0+c2V0TGFzdFNwSWQoJGxhc3RTcElkKTsKCiAgICAgICAgICAgIC8vIHNldCB0aGUgRXNjaGVyIG9iamVjdAogICAgICAgICAgICAkdGhpcy0+d3JpdGVyV29ya3NoZWV0c1skc2hlZXRJbmRleF0tPnNldEVzY2hlcigkZXNjaGVyKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBCdWlsZCB0aGUgRXNjaGVyIG9iamVjdCBjb3JyZXNwb25kaW5nIHRvIHRoZSBNU09EUkFXSU5HR1JPVVAgcmVjb3JkCiAgICAgKi8KICAgIHByaXZhdGUgZnVuY3Rpb24gYnVpbGRXb3JrYm9va0VzY2hlcigpCiAgICB7CiAgICAgICAgJGVzY2hlciA9IG51bGw7CgogICAgICAgIC8vIGFueSBkcmF3aW5ncyBpbiB0aGlzIHdvcmtib29rPwogICAgICAgICRmb3VuZCA9IGZhbHNlOwogICAgICAgIGZvcmVhY2ggKCR0aGlzLT5waHBFeGNlbC0+Z2V0QWxsU2hlZXRzKCkgYXMgJHNoZWV0KSB7CiAgICAgICAgICAgIGlmIChjb3VudCgkc2hlZXQtPmdldERyYXdpbmdDb2xsZWN0aW9uKCkpID4gMCkgewogICAgICAgICAgICAgICAgJGZvdW5kID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAvLyBub3RoaW5nIHRvIGRvIGlmIHRoZXJlIGFyZSBubyBkcmF3aW5ncwogICAgICAgIGlmICghJGZvdW5kKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIC8vIGlmIHdlIHJlYWNoIGhlcmUsIHRoZW4gdGhlcmUgYXJlIGRyYXdpbmdzIGluIHRoZSB3b3JrYm9vawogICAgICAgICRlc2NoZXIgPSBuZXcgUEhQRXhjZWxfU2hhcmVkX0VzY2hlcigpOwoKICAgICAgICAvLyBkZ2dDb250YWluZXIKICAgICAgICAkZGdnQ29udGFpbmVyID0gbmV3IFBIUEV4Y2VsX1NoYXJlZF9Fc2NoZXJfRGdnQ29udGFpbmVyKCk7CiAgICAgICAgJGVzY2hlci0+c2V0RGdnQ29udGFpbmVyKCRkZ2dDb250YWluZXIpOwoKICAgICAgICAvLyBzZXQgSURDTHMgKGlkZW50aWZpZXIgY2x1c3RlcnMpCiAgICAgICAgJGRnZ0NvbnRhaW5lci0+c2V0SURDTHMoJHRoaXMtPklEQ0xzKTsKCiAgICAgICAgLy8gdGhpcyBsb29wIGlzIGZvciBkZXRlcm1pbmluZyBtYXhpbXVtIHNoYXBlIGlkZW50aWZpZXIgb2YgYWxsIGRyYXdpbmcKICAgICAgICAkc3BJZE1heCA9IDA7CiAgICAgICAgJHRvdGFsQ291bnRTaGFwZXMgPSAwOwogICAgICAgICRjb3VudERyYXdpbmdzID0gMDsKCiAgICAgICAgZm9yZWFjaCAoJHRoaXMtPnBocEV4Y2VsLT5nZXRBbGxzaGVldHMoKSBhcyAkc2hlZXQpIHsKICAgICAgICAgICAgJHNoZWV0Q291bnRTaGFwZXMgPSAwOyAvLyBjb3VudCBudW1iZXIgb2Ygc2hhcGVzIChtaW51cyBncm91cCBzaGFwZSksIGluIHNoZWV0CgogICAgICAgICAgICBpZiAoY291bnQoJHNoZWV0LT5nZXREcmF3aW5nQ29sbGVjdGlvbigpKSA+IDApIHsKICAgICAgICAgICAgICAgICsrJGNvdW50RHJhd2luZ3M7CgogICAgICAgICAgICAgICAgZm9yZWFjaCAoJHNoZWV0LT5nZXREcmF3aW5nQ29sbGVjdGlvbigpIGFzICRkcmF3aW5nKSB7CiAgICAgICAgICAgICAgICAgICAgKyskc2hlZXRDb3VudFNoYXBlczsKICAgICAgICAgICAgICAgICAgICArKyR0b3RhbENvdW50U2hhcGVzOwoKICAgICAgICAgICAgICAgICAgICAkc3BJZCA9ICRzaGVldENvdW50U2hhcGVzIHwgKCR0aGlzLT5waHBFeGNlbC0+Z2V0SW5kZXgoJHNoZWV0KSArIDEpIDw8IDEwOwogICAgICAgICAgICAgICAgICAgICRzcElkTWF4ID0gbWF4KCRzcElkLCAkc3BJZE1heCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICRkZ2dDb250YWluZXItPnNldFNwSWRNYXgoJHNwSWRNYXggKyAxKTsKICAgICAgICAkZGdnQ29udGFpbmVyLT5zZXRDRGdTYXZlZCgkY291bnREcmF3aW5ncyk7CiAgICAgICAgJGRnZ0NvbnRhaW5lci0+c2V0Q1NwU2F2ZWQoJHRvdGFsQ291bnRTaGFwZXMgKyAkY291bnREcmF3aW5ncyk7IC8vIHRvdGFsIG51bWJlciBvZiBzaGFwZXMgaW5jbC4gb25lIGdyb3VwIHNoYXBlcyBwZXIgZHJhd2luZwoKICAgICAgICAvLyBic3RvcmVDb250YWluZXIKICAgICAgICAkYnN0b3JlQ29udGFpbmVyID0gbmV3IFBIUEV4Y2VsX1NoYXJlZF9Fc2NoZXJfRGdnQ29udGFpbmVyX0JzdG9yZUNvbnRhaW5lcigpOwogICAgICAgICRkZ2dDb250YWluZXItPnNldEJzdG9yZUNvbnRhaW5lcigkYnN0b3JlQ29udGFpbmVyKTsKCiAgICAgICAgLy8gdGhlIEJTRSdzIChhbGwgdGhlIGltYWdlcykKICAgICAgICBmb3JlYWNoICgkdGhpcy0+cGhwRXhjZWwtPmdldEFsbHNoZWV0cygpIGFzICRzaGVldCkgewogICAgICAgICAgICBmb3JlYWNoICgkc2hlZXQtPmdldERyYXdpbmdDb2xsZWN0aW9uKCkgYXMgJGRyYXdpbmcpIHsKICAgICAgICAgICAgICAgIGlmICgkZHJhd2luZyBpbnN0YW5jZW9mIFBIUEV4Y2VsX1dvcmtzaGVldF9EcmF3aW5nKSB7CiAgICAgICAgICAgICAgICAgICAgJGZpbGVuYW1lID0gJGRyYXdpbmctPmdldFBhdGgoKTsKCiAgICAgICAgICAgICAgICAgICAgbGlzdCgkaW1hZ2VzeCwgJGltYWdlc3ksICRpbWFnZUZvcm1hdCkgPSBnZXRpbWFnZXNpemUoJGZpbGVuYW1lKTsKCiAgICAgICAgICAgICAgICAgICAgc3dpdGNoICgkaW1hZ2VGb3JtYXQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOiAvLyBHSUYsIG5vdCBzdXBwb3J0ZWQgYnkgQklGRjgsIHdlIGNvbnZlcnQgdG8gUE5HCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYmxpcFR5cGUgPSBQSFBFeGNlbF9TaGFyZWRfRXNjaGVyX0RnZ0NvbnRhaW5lcl9Cc3RvcmVDb250YWluZXJfQlNFOjpCTElQVFlQRV9QTkc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYl9zdGFydCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2VwbmcoaW1hZ2VjcmVhdGVmcm9tZ2lmKCRmaWxlbmFtZSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGJsaXBEYXRhID0gb2JfZ2V0X2NvbnRlbnRzKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYl9lbmRfY2xlYW4oKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDI6IC8vIEpQRUcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRibGlwVHlwZSA9IFBIUEV4Y2VsX1NoYXJlZF9Fc2NoZXJfRGdnQ29udGFpbmVyX0JzdG9yZUNvbnRhaW5lcl9CU0U6OkJMSVBUWVBFX0pQRUc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYmxpcERhdGEgPSBmaWxlX2dldF9jb250ZW50cygkZmlsZW5hbWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMzogLy8gUE5HCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYmxpcFR5cGUgPSBQSFBFeGNlbF9TaGFyZWRfRXNjaGVyX0RnZ0NvbnRhaW5lcl9Cc3RvcmVDb250YWluZXJfQlNFOjpCTElQVFlQRV9QTkc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYmxpcERhdGEgPSBmaWxlX2dldF9jb250ZW50cygkZmlsZW5hbWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgNjogLy8gV2luZG93cyBESUIgKEJNUCksIHdlIGNvbnZlcnQgdG8gUE5HCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYmxpcFR5cGUgPSBQSFBFeGNlbF9TaGFyZWRfRXNjaGVyX0RnZ0NvbnRhaW5lcl9Cc3RvcmVDb250YWluZXJfQlNFOjpCTElQVFlQRV9QTkc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYl9zdGFydCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaW1hZ2VwbmcoUEhQRXhjZWxfU2hhcmVkX0RyYXdpbmc6OmltYWdlY3JlYXRlZnJvbWJtcCgkZmlsZW5hbWUpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRibGlwRGF0YSA9IG9iX2dldF9jb250ZW50cygpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JfZW5kX2NsZWFuKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlIDI7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAkYmxpcCA9IG5ldyBQSFBFeGNlbF9TaGFyZWRfRXNjaGVyX0RnZ0NvbnRhaW5lcl9Cc3RvcmVDb250YWluZXJfQlNFX0JsaXAoKTsKICAgICAgICAgICAgICAgICAgICAkYmxpcC0+c2V0RGF0YSgkYmxpcERhdGEpOwoKICAgICAgICAgICAgICAgICAgICAkQlNFID0gbmV3IFBIUEV4Y2VsX1NoYXJlZF9Fc2NoZXJfRGdnQ29udGFpbmVyX0JzdG9yZUNvbnRhaW5lcl9CU0UoKTsKICAgICAgICAgICAgICAgICAgICAkQlNFLT5zZXRCbGlwVHlwZSgkYmxpcFR5cGUpOwogICAgICAgICAgICAgICAgICAgICRCU0UtPnNldEJsaXAoJGJsaXApOwoKICAgICAgICAgICAgICAgICAgICAkYnN0b3JlQ29udGFpbmVyLT5hZGRCU0UoJEJTRSk7CiAgICAgICAgICAgICAgICB9IGVsc2VpZiAoJGRyYXdpbmcgaW5zdGFuY2VvZiBQSFBFeGNlbF9Xb3Jrc2hlZXRfTWVtb3J5RHJhd2luZykgewogICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoJGRyYXdpbmctPmdldFJlbmRlcmluZ0Z1bmN0aW9uKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBQSFBFeGNlbF9Xb3Jrc2hlZXRfTWVtb3J5RHJhd2luZzo6UkVOREVSSU5HX0pQRUc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYmxpcFR5cGUgPSBQSFBFeGNlbF9TaGFyZWRfRXNjaGVyX0RnZ0NvbnRhaW5lcl9Cc3RvcmVDb250YWluZXJfQlNFOjpCTElQVFlQRV9KUEVHOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJlbmRlcmluZ0Z1bmN0aW9uID0gJ2ltYWdlanBlZyc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBQSFBFeGNlbF9Xb3Jrc2hlZXRfTWVtb3J5RHJhd2luZzo6UkVOREVSSU5HX0dJRjoKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBQSFBFeGNlbF9Xb3Jrc2hlZXRfTWVtb3J5RHJhd2luZzo6UkVOREVSSU5HX1BORzoKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBQSFBFeGNlbF9Xb3Jrc2hlZXRfTWVtb3J5RHJhd2luZzo6UkVOREVSSU5HX0RFRkFVTFQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYmxpcFR5cGUgPSBQSFBFeGNlbF9TaGFyZWRfRXNjaGVyX0RnZ0NvbnRhaW5lcl9Cc3RvcmVDb250YWluZXJfQlNFOjpCTElQVFlQRV9QTkc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcmVuZGVyaW5nRnVuY3Rpb24gPSAnaW1hZ2VwbmcnOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBvYl9zdGFydCgpOwogICAgICAgICAgICAgICAgICAgIGNhbGxfdXNlcl9mdW5jKCRyZW5kZXJpbmdGdW5jdGlvbiwgJGRyYXdpbmctPmdldEltYWdlUmVzb3VyY2UoKSk7CiAgICAgICAgICAgICAgICAgICAgJGJsaXBEYXRhID0gb2JfZ2V0X2NvbnRlbnRzKCk7CiAgICAgICAgICAgICAgICAgICAgb2JfZW5kX2NsZWFuKCk7CgogICAgICAgICAgICAgICAgICAgICRibGlwID0gbmV3IFBIUEV4Y2VsX1NoYXJlZF9Fc2NoZXJfRGdnQ29udGFpbmVyX0JzdG9yZUNvbnRhaW5lcl9CU0VfQmxpcCgpOwogICAgICAgICAgICAgICAgICAgICRibGlwLT5zZXREYXRhKCRibGlwRGF0YSk7CgogICAgICAgICAgICAgICAgICAgICRCU0UgPSBuZXcgUEhQRXhjZWxfU2hhcmVkX0VzY2hlcl9EZ2dDb250YWluZXJfQnN0b3JlQ29udGFpbmVyX0JTRSgpOwogICAgICAgICAgICAgICAgICAgICRCU0UtPnNldEJsaXBUeXBlKCRibGlwVHlwZSk7CiAgICAgICAgICAgICAgICAgICAgJEJTRS0+c2V0QmxpcCgkYmxpcCk7CgogICAgICAgICAgICAgICAgICAgICRic3RvcmVDb250YWluZXItPmFkZEJTRSgkQlNFKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gU2V0IHRoZSBFc2NoZXIgb2JqZWN0CiAgICAgICAgJHRoaXMtPndyaXRlcldvcmtib29rLT5zZXRFc2NoZXIoJGVzY2hlcik7CiAgICB9CgogICAgLyoqCiAgICAgKiBCdWlsZCB0aGUgT0xFIFBhcnQgZm9yIERvY3VtZW50U3VtbWFyeSBJbmZvcm1hdGlvbgogICAgICogQHJldHVybiBzdHJpbmcKICAgICAqLwogICAgcHJpdmF0ZSBmdW5jdGlvbiB3cml0ZURvY3VtZW50U3VtbWFyeUluZm9ybWF0aW9uKCkKICAgIHsKICAgICAgICAvLyBvZmZzZXQ6IDA7IHNpemU6IDI7IG11c3QgYmUgMHhGRSAweEZGIChVVEYtMTYgTEUgYnl0ZSBvcmRlciBtYXJrKQogICAgICAgICRkYXRhID0gcGFjaygndicsIDB4RkZGRSk7CiAgICAgICAgLy8gb2Zmc2V0OiAyOyBzaXplOiAyOwogICAgICAgICRkYXRhIC49IHBhY2soJ3YnLCAweDAwMDApOwogICAgICAgIC8vIG9mZnNldDogNDsgc2l6ZTogMjsgT1MgdmVyc2lvbgogICAgICAgICRkYXRhIC49IHBhY2soJ3YnLCAweDAxMDYpOwogICAgICAgIC8vIG9mZnNldDogNjsgc2l6ZTogMjsgT1MgaW5kaWNhdG9yCiAgICAgICAgJGRhdGEgLj0gcGFjaygndicsIDB4MDAwMik7CiAgICAgICAgLy8gb2Zmc2V0OiA4OyBzaXplOiAxNgogICAgICAgICRkYXRhIC49IHBhY2soJ1ZWVlYnLCAweDAwLCAweDAwLCAweDAwLCAweDAwKTsKICAgICAgICAvLyBvZmZzZXQ6IDI0OyBzaXplOiA0OyBzZWN0aW9uIGNvdW50CiAgICAgICAgJGRhdGEgLj0gcGFjaygnVicsIDB4MDAwMSk7CgogICAgICAgIC8vIG9mZnNldDogMjg7IHNpemU6IDE2OyBmaXJzdCBzZWN0aW9uJ3MgY2xhc3MgaWQ6IDAyIGQ1IGNkIGQ1IDljIDJlIDFiIDEwIDkzIDk3IDA4IDAwIDJiIDJjIGY5IGFlCiAgICAgICAgJGRhdGEgLj0gcGFjaygndnZ2dnZ2dnYnLCAweEQ1MDIsIDB4RDVDRCwgMHgyRTlDLCAweDEwMUIsIDB4OTc5MywgMHgwMDA4LCAweDJDMkIsIDB4QUVGOSk7CiAgICAgICAgLy8gb2Zmc2V0OiA0NDsgc2l6ZTogNDsgb2Zmc2V0IG9mIHRoZSBzdGFydAogICAgICAgICRkYXRhIC49IHBhY2soJ1YnLCAweDMwKTsKCiAgICAgICAgLy8gU0VDVElPTgogICAgICAgICRkYXRhU2VjdGlvbiA9IGFycmF5KCk7CiAgICAgICAgJGRhdGFTZWN0aW9uX051bVByb3BzID0gMDsKICAgICAgICAkZGF0YVNlY3Rpb25fU3VtbWFyeSA9ICcnOwogICAgICAgICRkYXRhU2VjdGlvbl9Db250ZW50ID0gJyc7CgogICAgICAgIC8vIEdLUElERFNJX0NPREVQQUdFOiBDb2RlUGFnZQogICAgICAgICRkYXRhU2VjdGlvbltdID0gYXJyYXkoJ3N1bW1hcnknPT4gYXJyYXkoJ3BhY2snID0+ICdWJywgJ2RhdGEnID0+IDB4MDEpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29mZnNldCcgPT4gYXJyYXkoJ3BhY2snID0+ICdWJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHlwZScgICAgID0+IGFycmF5KCdwYWNrJyA9PiAnVicsICdkYXRhJyA9PiAweDAyKSwgLy8gMiBieXRlIHNpZ25lZCBpbnRlZ2VyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YScgICAgPT4gYXJyYXkoJ2RhdGEnID0+IDEyNTIpKTsKICAgICAgICAkZGF0YVNlY3Rpb25fTnVtUHJvcHMrKzsKCiAgICAgICAgLy8gR0tQSUREU0lfQ0FURUdPUlkgOiBDYXRlZ29yeQogICAgICAgIGlmICgkdGhpcy0+cGhwRXhjZWwtPmdldFByb3BlcnRpZXMoKS0+Z2V0Q2F0ZWdvcnkoKSkgewogICAgICAgICAgICAkZGF0YVByb3AgPSAkdGhpcy0+cGhwRXhjZWwtPmdldFByb3BlcnRpZXMoKS0+Z2V0Q2F0ZWdvcnkoKTsKICAgICAgICAgICAgJGRhdGFTZWN0aW9uW10gPSBhcnJheSgnc3VtbWFyeSc9PiBhcnJheSgncGFjaycgPT4gJ1YnLCAnZGF0YScgPT4gMHgwMiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29mZnNldCcgPT4gYXJyYXkoJ3BhY2snID0+ICdWJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3R5cGUnICAgICA9PiBhcnJheSgncGFjaycgPT4gJ1YnLCAnZGF0YScgPT4gMHgxRSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGEnICAgID0+IGFycmF5KCdkYXRhJyA9PiAkZGF0YVByb3AsICdsZW5ndGgnID0+IHN0cmxlbigkZGF0YVByb3ApKSk7CiAgICAgICAgICAgICRkYXRhU2VjdGlvbl9OdW1Qcm9wcysrOwogICAgICAgIH0KICAgICAgICAvLyBHS1BJRERTSV9WRVJTSU9OIDpWZXJzaW9uIG9mIHRoZSBhcHBsaWNhdGlvbiB0aGF0IHdyb3RlIHRoZSBwcm9wZXJ0eSBzdG9yYWdlCiAgICAgICAgJGRhdGFTZWN0aW9uW10gPSBhcnJheSgnc3VtbWFyeSc9PiBhcnJheSgncGFjaycgPT4gJ1YnLCAnZGF0YScgPT4gMHgxNyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb2Zmc2V0JyA9PiBhcnJheSgncGFjaycgPT4gJ1YnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0eXBlJyAgICAgPT4gYXJyYXkoJ3BhY2snID0+ICdWJywgJ2RhdGEnID0+IDB4MDMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGEnICAgID0+IGFycmF5KCdwYWNrJyA9PiAnVicsICdkYXRhJyA9PiAweDAwMEMwMDAwKSk7CiAgICAgICAgJGRhdGFTZWN0aW9uX051bVByb3BzKys7CiAgICAgICAgLy8gR0tQSUREU0lfU0NBTEUgOiBGQUxTRQogICAgICAgICRkYXRhU2VjdGlvbltdID0gYXJyYXkoJ3N1bW1hcnknPT4gYXJyYXkoJ3BhY2snID0+ICdWJywgJ2RhdGEnID0+IDB4MEIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29mZnNldCcgPT4gYXJyYXkoJ3BhY2snID0+ICdWJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHlwZScgICAgID0+IGFycmF5KCdwYWNrJyA9PiAnVicsICdkYXRhJyA9PiAweDBCKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhJyAgICA9PiBhcnJheSgnZGF0YScgPT4gZmFsc2UpKTsKICAgICAgICAkZGF0YVNlY3Rpb25fTnVtUHJvcHMrKzsKICAgICAgICAvLyBHS1BJRERTSV9MSU5LU0RJUlRZIDogVHJ1ZSBpZiBhbnkgb2YgdGhlIHZhbHVlcyBmb3IgdGhlIGxpbmtlZCBwcm9wZXJ0aWVzIGhhdmUgY2hhbmdlZCBvdXRzaWRlIG9mIHRoZSBhcHBsaWNhdGlvbgogICAgICAgICRkYXRhU2VjdGlvbltdID0gYXJyYXkoJ3N1bW1hcnknPT4gYXJyYXkoJ3BhY2snID0+ICdWJywgJ2RhdGEnID0+IDB4MTApLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29mZnNldCcgPT4gYXJyYXkoJ3BhY2snID0+ICdWJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHlwZScgICAgID0+IGFycmF5KCdwYWNrJyA9PiAnVicsICdkYXRhJyA9PiAweDBCKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhJyAgICA9PiBhcnJheSgnZGF0YScgPT4gZmFsc2UpKTsKICAgICAgICAkZGF0YVNlY3Rpb25fTnVtUHJvcHMrKzsKICAgICAgICAvLyBHS1BJRERTSV9TSEFSRURPQyA6IEZBTFNFCiAgICAgICAgJGRhdGFTZWN0aW9uW10gPSBhcnJheSgnc3VtbWFyeSc9PiBhcnJheSgncGFjaycgPT4gJ1YnLCAnZGF0YScgPT4gMHgxMyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb2Zmc2V0JyA9PiBhcnJheSgncGFjaycgPT4gJ1YnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0eXBlJyAgICAgPT4gYXJyYXkoJ3BhY2snID0+ICdWJywgJ2RhdGEnID0+IDB4MEIpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGEnICAgID0+IGFycmF5KCdkYXRhJyA9PiBmYWxzZSkpOwogICAgICAgICRkYXRhU2VjdGlvbl9OdW1Qcm9wcysrOwogICAgICAgIC8vIEdLUElERFNJX0hZUEVSTElOS1NDSEFOR0VEIDogVHJ1ZSBpZiBhbnkgb2YgdGhlIHZhbHVlcyBmb3IgdGhlIF9QSURfTElOS1MgKGh5cGVybGluayB0ZXh0KSBoYXZlIGNoYW5nZWQgb3V0c2lkZSBvZiB0aGUgYXBwbGljYXRpb24KICAgICAgICAkZGF0YVNlY3Rpb25bXSA9IGFycmF5KCdzdW1tYXJ5Jz0+IGFycmF5KCdwYWNrJyA9PiAnVicsICdkYXRhJyA9PiAweDE2KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvZmZzZXQnID0+IGFycmF5KCdwYWNrJyA9PiAnVicpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3R5cGUnICAgICA9PiBhcnJheSgncGFjaycgPT4gJ1YnLCAnZGF0YScgPT4gMHgwQiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YScgICAgPT4gYXJyYXkoJ2RhdGEnID0+IGZhbHNlKSk7CiAgICAgICAgJGRhdGFTZWN0aW9uX051bVByb3BzKys7CgogICAgICAgIC8vIEdLUElERFNJX0RPQ1NQQVJUUwogICAgICAgIC8vIE1TLU9TSEFSRUQgcDc1ICgyLjMuMy4yLjIuMSkKICAgICAgICAvLyBTdHJ1Y3R1cmUgaXMgVnRWZWNVbmFsaWduZWRMcHN0clZhbHVlICgyLjMuMy4xLjkpCiAgICAgICAgLy8gY0VsZW1lbnRzCiAgICAgICAgJGRhdGFQcm9wID0gcGFjaygndicsIDB4MDAwMSk7CiAgICAgICAgJGRhdGFQcm9wIC49IHBhY2soJ3YnLCAweDAwMDApOwogICAgICAgIC8vIGFycmF5IG9mIFVuYWxpZ25lZExwc3RyCiAgICAgICAgICAvLyBjY2gKICAgICAgICAgICRkYXRhUHJvcCAuPSBwYWNrKCd2JywgMHgwMDBBKTsKICAgICAgICAgICRkYXRhUHJvcCAuPSBwYWNrKCd2JywgMHgwMDAwKTsKICAgICAgICAgIC8vIHZhbHVlCiAgICAgICAgICAkZGF0YVByb3AgLj0gJ1dvcmtzaGVldCcuY2hyKDApOwoKICAgICAgICAkZGF0YVNlY3Rpb25bXSA9IGFycmF5KCdzdW1tYXJ5Jz0+IGFycmF5KCdwYWNrJyA9PiAnVicsICdkYXRhJyA9PiAweDBEKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvZmZzZXQnID0+IGFycmF5KCdwYWNrJyA9PiAnVicpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3R5cGUnICAgICA9PiBhcnJheSgncGFjaycgPT4gJ1YnLCAnZGF0YScgPT4gMHgxMDFFKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhJyAgICA9PiBhcnJheSgnZGF0YScgPT4gJGRhdGFQcm9wLCAnbGVuZ3RoJyA9PiBzdHJsZW4oJGRhdGFQcm9wKSkpOwogICAgICAgICRkYXRhU2VjdGlvbl9OdW1Qcm9wcysrOwoKICAgICAgICAvLyBHS1BJRERTSV9IRUFESU5HUEFJUgogICAgICAgIC8vIFZ0VmVjSGVhZGluZ1BhaXJWYWx1ZQogICAgICAgICAgLy8gY0VsZW1lbnRzCiAgICAgICAgICAkZGF0YVByb3AgPSBwYWNrKCd2JywgMHgwMDAyKTsKICAgICAgICAgICRkYXRhUHJvcCAuPSBwYWNrKCd2JywgMHgwMDAwKTsKICAgICAgICAgIC8vIEFycmF5IG9mIHZ0SGVhZGluZ1BhaXIKICAgICAgICAgICAgLy8gdnRVbmFsaWduZWRTdHJpbmcgLSBoZWFkaW5nU3RyaW5nCiAgICAgICAgICAgICAgLy8gc3RyaW5nVHlwZQogICAgICAgICAgICAgICRkYXRhUHJvcCAuPSBwYWNrKCd2JywgMHgwMDFFKTsKICAgICAgICAgICAgICAvLyBwYWRkaW5nCiAgICAgICAgICAgICAgJGRhdGFQcm9wIC49IHBhY2soJ3YnLCAweDAwMDApOwogICAgICAgICAgICAgIC8vIFVuYWxpZ25lZExwc3RyCiAgICAgICAgICAgICAgICAvLyBjY2gKICAgICAgICAgICAgICAgICRkYXRhUHJvcCAuPSBwYWNrKCd2JywgMHgwMDEzKTsKICAgICAgICAgICAgICAgICRkYXRhUHJvcCAuPSBwYWNrKCd2JywgMHgwMDAwKTsKICAgICAgICAgICAgICAgIC8vIHZhbHVlCiAgICAgICAgICAgICAgICAkZGF0YVByb3AgLj0gJ0ZldWlsbGVzIGRlIGNhbGN1bCc7CiAgICAgICAgICAgIC8vIHZ0VW5hbGlnbmVkU3RyaW5nIC0gaGVhZGluZ1BhcnRzCiAgICAgICAgICAgICAgLy8gd1R5cGUgOiAweDAwMDMgPSAzMiBiaXQgc2lnbmVkIGludGVnZXIKICAgICAgICAgICAgICAkZGF0YVByb3AgLj0gcGFjaygndicsIDB4MDMwMCk7CiAgICAgICAgICAgICAgLy8gcGFkZGluZwogICAgICAgICAgICAgICRkYXRhUHJvcCAuPSBwYWNrKCd2JywgMHgwMDAwKTsKICAgICAgICAgICAgICAvLyB2YWx1ZQogICAgICAgICAgICAgICRkYXRhUHJvcCAuPSBwYWNrKCd2JywgMHgwMTAwKTsKICAgICAgICAgICAgICAkZGF0YVByb3AgLj0gcGFjaygndicsIDB4MDAwMCk7CiAgICAgICAgICAgICAgJGRhdGFQcm9wIC49IHBhY2soJ3YnLCAweDAwMDApOwogICAgICAgICAgICAgICRkYXRhUHJvcCAuPSBwYWNrKCd2JywgMHgwMDAwKTsKCiAgICAgICAgJGRhdGFTZWN0aW9uW10gPSBhcnJheSgnc3VtbWFyeSc9PiBhcnJheSgncGFjaycgPT4gJ1YnLCAnZGF0YScgPT4gMHgwQyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb2Zmc2V0JyA9PiBhcnJheSgncGFjaycgPT4gJ1YnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0eXBlJyAgICAgPT4gYXJyYXkoJ3BhY2snID0+ICdWJywgJ2RhdGEnID0+IDB4MTAwQyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YScgICAgPT4gYXJyYXkoJ2RhdGEnID0+ICRkYXRhUHJvcCwgJ2xlbmd0aCcgPT4gc3RybGVuKCRkYXRhUHJvcCkpKTsKICAgICAgICAkZGF0YVNlY3Rpb25fTnVtUHJvcHMrKzsKCiAgICAgICAgLy8gICAgICAgICA0ICAgICBTZWN0aW9uIExlbmd0aAogICAgICAgIC8vICAgICAgICA0ICAgICBQcm9wZXJ0eSBjb3VudAogICAgICAgIC8vICAgICAgICA4ICogJGRhdGFTZWN0aW9uX051bVByb3BzICg4ID0gIElEICg0KSArIE9mZlNldCg0KSkKICAgICAgICAkZGF0YVNlY3Rpb25fQ29udGVudF9PZmZzZXQgPSA4ICsgJGRhdGFTZWN0aW9uX051bVByb3BzICogODsKICAgICAgICBmb3JlYWNoICgkZGF0YVNlY3Rpb24gYXMgJGRhdGFQcm9wKSB7CiAgICAgICAgICAgIC8vIFN1bW1hcnkKICAgICAgICAgICAgJGRhdGFTZWN0aW9uX1N1bW1hcnkgLj0gcGFjaygkZGF0YVByb3BbJ3N1bW1hcnknXVsncGFjayddLCAkZGF0YVByb3BbJ3N1bW1hcnknXVsnZGF0YSddKTsKICAgICAgICAgICAgLy8gT2Zmc2V0CiAgICAgICAgICAgICRkYXRhU2VjdGlvbl9TdW1tYXJ5IC49IHBhY2soJGRhdGFQcm9wWydvZmZzZXQnXVsncGFjayddLCAkZGF0YVNlY3Rpb25fQ29udGVudF9PZmZzZXQpOwogICAgICAgICAgICAvLyBEYXRhVHlwZQogICAgICAgICAgICAkZGF0YVNlY3Rpb25fQ29udGVudCAuPSBwYWNrKCRkYXRhUHJvcFsndHlwZSddWydwYWNrJ10sICRkYXRhUHJvcFsndHlwZSddWydkYXRhJ10pOwogICAgICAgICAgICAvLyBEYXRhCiAgICAgICAgICAgIGlmICgkZGF0YVByb3BbJ3R5cGUnXVsnZGF0YSddID09IDB4MDIpIHsgLy8gMiBieXRlIHNpZ25lZCBpbnRlZ2VyCiAgICAgICAgICAgICAgICAkZGF0YVNlY3Rpb25fQ29udGVudCAuPSBwYWNrKCdWJywgJGRhdGFQcm9wWydkYXRhJ11bJ2RhdGEnXSk7CgogICAgICAgICAgICAgICAgJGRhdGFTZWN0aW9uX0NvbnRlbnRfT2Zmc2V0ICs9IDQgKyA0OwogICAgICAgICAgICB9IGVsc2VpZiAoJGRhdGFQcm9wWyd0eXBlJ11bJ2RhdGEnXSA9PSAweDAzKSB7IC8vIDQgYnl0ZSBzaWduZWQgaW50ZWdlcgogICAgICAgICAgICAgICAgJGRhdGFTZWN0aW9uX0NvbnRlbnQgLj0gcGFjaygnVicsICRkYXRhUHJvcFsnZGF0YSddWydkYXRhJ10pOwoKICAgICAgICAgICAgICAgICRkYXRhU2VjdGlvbl9Db250ZW50X09mZnNldCArPSA0ICsgNDsKICAgICAgICAgICAgfSBlbHNlaWYgKCRkYXRhUHJvcFsndHlwZSddWydkYXRhJ10gPT0gMHgwQikgeyAvLyBCb29sZWFuCiAgICAgICAgICAgICAgICBpZiAoJGRhdGFQcm9wWydkYXRhJ11bJ2RhdGEnXSA9PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgICRkYXRhU2VjdGlvbl9Db250ZW50IC49IHBhY2soJ1YnLCAweDAwMDApOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkZGF0YVNlY3Rpb25fQ29udGVudCAuPSBwYWNrKCdWJywgMHgwMDAxKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICRkYXRhU2VjdGlvbl9Db250ZW50X09mZnNldCArPSA0ICsgNDsKICAgICAgICAgICAgfSBlbHNlaWYgKCRkYXRhUHJvcFsndHlwZSddWydkYXRhJ10gPT0gMHgxRSkgeyAvLyBudWxsLXRlcm1pbmF0ZWQgc3RyaW5nIHByZXBlbmRlZCBieSBkd29yZCBzdHJpbmcgbGVuZ3RoCiAgICAgICAgICAgICAgICAvLyBOdWxsLXRlcm1pbmF0ZWQgc3RyaW5nCiAgICAgICAgICAgICAgICAkZGF0YVByb3BbJ2RhdGEnXVsnZGF0YSddIC49IGNocigwKTsKICAgICAgICAgICAgICAgICRkYXRhUHJvcFsnZGF0YSddWydsZW5ndGgnXSArPSAxOwogICAgICAgICAgICAgICAgLy8gQ29tcGxldGUgdGhlIHN0cmluZyB3aXRoIG51bGwgc3RyaW5nIGZvciBiZWluZyBhICU0CiAgICAgICAgICAgICAgICAkZGF0YVByb3BbJ2RhdGEnXVsnbGVuZ3RoJ10gPSAkZGF0YVByb3BbJ2RhdGEnXVsnbGVuZ3RoJ10gKyAoKDQgLSAkZGF0YVByb3BbJ2RhdGEnXVsnbGVuZ3RoJ10gJSA0KT09NCA\/IDAgOiAoNCAtICRkYXRhUHJvcFsnZGF0YSddWydsZW5ndGgnXSAlIDQpKTsKICAgICAgICAgICAgICAgICRkYXRhUHJvcFsnZGF0YSddWydkYXRhJ10gPSBzdHJfcGFkKCRkYXRhUHJvcFsnZGF0YSddWydkYXRhJ10sICRkYXRhUHJvcFsnZGF0YSddWydsZW5ndGgnXSwgY2hyKDApLCBTVFJfUEFEX1JJR0hUKTsKCiAgICAgICAgICAgICAgICAkZGF0YVNlY3Rpb25fQ29udGVudCAuPSBwYWNrKCdWJywgJGRhdGFQcm9wWydkYXRhJ11bJ2xlbmd0aCddKTsKICAgICAgICAgICAgICAgICRkYXRhU2VjdGlvbl9Db250ZW50IC49ICRkYXRhUHJvcFsnZGF0YSddWydkYXRhJ107CgogICAgICAgICAgICAgICAgJGRhdGFTZWN0aW9uX0NvbnRlbnRfT2Zmc2V0ICs9IDQgKyA0ICsgc3RybGVuKCRkYXRhUHJvcFsnZGF0YSddWydkYXRhJ10pOwogICAgICAgICAgICB9IGVsc2VpZiAoJGRhdGFQcm9wWyd0eXBlJ11bJ2RhdGEnXSA9PSAweDQwKSB7IC8vIEZpbGV0aW1lICg2NC1iaXQgdmFsdWUgcmVwcmVzZW50aW5nIHRoZSBudW1iZXIgb2YgMTAwLW5hbm9zZWNvbmQgaW50ZXJ2YWxzIHNpbmNlIEphbnVhcnkgMSwgMTYwMSkKICAgICAgICAgICAgICAgICRkYXRhU2VjdGlvbl9Db250ZW50IC49ICRkYXRhUHJvcFsnZGF0YSddWydkYXRhJ107CgogICAgICAgICAgICAgICAgJGRhdGFTZWN0aW9uX0NvbnRlbnRfT2Zmc2V0ICs9IDQgKyA4OwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgLy8gRGF0YSBUeXBlIE5vdCBVc2VkIGF0IHRoZSBtb21lbnQKICAgICAgICAgICAgICAgICRkYXRhU2VjdGlvbl9Db250ZW50IC49ICRkYXRhUHJvcFsnZGF0YSddWydkYXRhJ107CgogICAgICAgICAgICAgICAgJGRhdGFTZWN0aW9uX0NvbnRlbnRfT2Zmc2V0ICs9IDQgKyAkZGF0YVByb3BbJ2RhdGEnXVsnbGVuZ3RoJ107CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLy8gTm93ICRkYXRhU2VjdGlvbl9Db250ZW50X09mZnNldCBjb250YWlucyB0aGUgc2l6ZSBvZiB0aGUgY29udGVudAoKICAgICAgICAvLyBzZWN0aW9uIGhlYWRlcgogICAgICAgIC8vIG9mZnNldDogJHNlY09mZnNldDsgc2l6ZTogNDsgc2VjdGlvbiBsZW5ndGgKICAgICAgICAvLyAgICAgICAgICsgeCAgU2l6ZSBvZiB0aGUgY29udGVudCAoc3VtbWFyeSArIGNvbnRlbnQpCiAgICAgICAgJGRhdGEgLj0gcGFjaygnVicsICRkYXRhU2VjdGlvbl9Db250ZW50X09mZnNldCk7CiAgICAgICAgLy8gb2Zmc2V0OiAkc2VjT2Zmc2V0KzQ7IHNpemU6IDQ7IHByb3BlcnR5IGNvdW50CiAgICAgICAgJGRhdGEgLj0gcGFjaygnVicsICRkYXRhU2VjdGlvbl9OdW1Qcm9wcyk7CiAgICAgICAgLy8gU2VjdGlvbiBTdW1tYXJ5CiAgICAgICAgJGRhdGEgLj0gJGRhdGFTZWN0aW9uX1N1bW1hcnk7CiAgICAgICAgLy8gU2VjdGlvbiBDb250ZW50CiAgICAgICAgJGRhdGEgLj0gJGRhdGFTZWN0aW9uX0NvbnRlbnQ7CgogICAgICAgIHJldHVybiAkZGF0YTsKICAgIH0KCiAgICAvKioKICAgICAqIEJ1aWxkIHRoZSBPTEUgUGFydCBmb3IgU3VtbWFyeSBJbmZvcm1hdGlvbgogICAgICogQHJldHVybiBzdHJpbmcKICAgICAqLwogICAgcHJpdmF0ZSBmdW5jdGlvbiB3cml0ZVN1bW1hcnlJbmZvcm1hdGlvbigpCiAgICB7CiAgICAgICAgLy8gb2Zmc2V0OiAwOyBzaXplOiAyOyBtdXN0IGJlIDB4RkUgMHhGRiAoVVRGLTE2IExFIGJ5dGUgb3JkZXIgbWFyaykKICAgICAgICAkZGF0YSA9IHBhY2soJ3YnLCAweEZGRkUpOwogICAgICAgIC8vIG9mZnNldDogMjsgc2l6ZTogMjsKICAgICAgICAkZGF0YSAuPSBwYWNrKCd2JywgMHgwMDAwKTsKICAgICAgICAvLyBvZmZzZXQ6IDQ7IHNpemU6IDI7IE9TIHZlcnNpb24KICAgICAgICAkZGF0YSAuPSBwYWNrKCd2JywgMHgwMTA2KTsKICAgICAgICAvLyBvZmZzZXQ6IDY7IHNpemU6IDI7IE9TIGluZGljYXRvcgogICAgICAgICRkYXRhIC49IHBhY2soJ3YnLCAweDAwMDIpOwogICAgICAgIC8vIG9mZnNldDogODsgc2l6ZTogMTYKICAgICAgICAkZGF0YSAuPSBwYWNrKCdWVlZWJywgMHgwMCwgMHgwMCwgMHgwMCwgMHgwMCk7CiAgICAgICAgLy8gb2Zmc2V0OiAyNDsgc2l6ZTogNDsgc2VjdGlvbiBjb3VudAogICAgICAgICRkYXRhIC49IHBhY2soJ1YnLCAweDAwMDEpOwoKICAgICAgICAvLyBvZmZzZXQ6IDI4OyBzaXplOiAxNjsgZmlyc3Qgc2VjdGlvbidzIGNsYXNzIGlkOiBlMCA4NSA5ZiBmMiBmOSA0ZiA2OCAxMCBhYiA5MSAwOCAwMCAyYiAyNyBiMyBkOQogICAgICAgICRkYXRhIC49IHBhY2soJ3Z2dnZ2dnZ2JywgMHg4NUUwLCAweEYyOUYsIDB4NEZGOSwgMHgxMDY4LCAweDkxQUIsIDB4MDAwOCwgMHgyNzJCLCAweEQ5QjMpOwogICAgICAgIC8vIG9mZnNldDogNDQ7IHNpemU6IDQ7IG9mZnNldCBvZiB0aGUgc3RhcnQKICAgICAgICAkZGF0YSAuPSBwYWNrKCdWJywgMHgzMCk7CgogICAgICAgIC8vIFNFQ1RJT04KICAgICAgICAkZGF0YVNlY3Rpb24gPSBhcnJheSgpOwogICAgICAgICRkYXRhU2VjdGlvbl9OdW1Qcm9wcyA9IDA7CiAgICAgICAgJGRhdGFTZWN0aW9uX1N1bW1hcnkgPSAnJzsKICAgICAgICAkZGF0YVNlY3Rpb25fQ29udGVudCA9ICcnOwoKICAgICAgICAvLyBDb2RlUGFnZSA6IENQLTEyNTIKICAgICAgICAkZGF0YVNlY3Rpb25bXSA9IGFycmF5KCdzdW1tYXJ5Jz0+IGFycmF5KCdwYWNrJyA9PiAnVicsICdkYXRhJyA9PiAweDAxKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvZmZzZXQnID0+IGFycmF5KCdwYWNrJyA9PiAnVicpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3R5cGUnICAgICA9PiBhcnJheSgncGFjaycgPT4gJ1YnLCAnZGF0YScgPT4gMHgwMiksIC8vIDIgYnl0ZSBzaWduZWQgaW50ZWdlcgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGEnICAgID0+IGFycmF5KCdkYXRhJyA9PiAxMjUyKSk7CiAgICAgICAgJGRhdGFTZWN0aW9uX051bVByb3BzKys7CgogICAgICAgIC8vICAgIFRpdGxlCiAgICAgICAgaWYgKCR0aGlzLT5waHBFeGNlbC0+Z2V0UHJvcGVydGllcygpLT5nZXRUaXRsZSgpKSB7CiAgICAgICAgICAgICRkYXRhUHJvcCA9ICR0aGlzLT5waHBFeGNlbC0+Z2V0UHJvcGVydGllcygpLT5nZXRUaXRsZSgpOwogICAgICAgICAgICAkZGF0YVNlY3Rpb25bXSA9IGFycmF5KCdzdW1tYXJ5Jz0+IGFycmF5KCdwYWNrJyA9PiAnVicsICdkYXRhJyA9PiAweDAyKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb2Zmc2V0JyA9PiBhcnJheSgncGFjaycgPT4gJ1YnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHlwZScgICAgID0+IGFycmF5KCdwYWNrJyA9PiAnVicsICdkYXRhJyA9PiAweDFFKSwgLy8gbnVsbC10ZXJtaW5hdGVkIHN0cmluZyBwcmVwZW5kZWQgYnkgZHdvcmQgc3RyaW5nIGxlbmd0aAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhJyAgICA9PiBhcnJheSgnZGF0YScgPT4gJGRhdGFQcm9wLCAnbGVuZ3RoJyA9PiBzdHJsZW4oJGRhdGFQcm9wKSkpOwogICAgICAgICAgICAkZGF0YVNlY3Rpb25fTnVtUHJvcHMrKzsKICAgICAgICB9CiAgICAgICAgLy8gICAgU3ViamVjdAogICAgICAgIGlmICgkdGhpcy0+cGhwRXhjZWwtPmdldFByb3BlcnRpZXMoKS0+Z2V0U3ViamVjdCgpKSB7CiAgICAgICAgICAgICRkYXRhUHJvcCA9ICR0aGlzLT5waHBFeGNlbC0+Z2V0UHJvcGVydGllcygpLT5nZXRTdWJqZWN0KCk7CiAgICAgICAgICAgICRkYXRhU2VjdGlvbltdID0gYXJyYXkoJ3N1bW1hcnknPT4gYXJyYXkoJ3BhY2snID0+ICdWJywgJ2RhdGEnID0+IDB4MDMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvZmZzZXQnID0+IGFycmF5KCdwYWNrJyA9PiAnVicpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0eXBlJyAgICAgPT4gYXJyYXkoJ3BhY2snID0+ICdWJywgJ2RhdGEnID0+IDB4MUUpLCAvLyBudWxsLXRlcm1pbmF0ZWQgc3RyaW5nIHByZXBlbmRlZCBieSBkd29yZCBzdHJpbmcgbGVuZ3RoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2RhdGEnICAgID0+IGFycmF5KCdkYXRhJyA9PiAkZGF0YVByb3AsICdsZW5ndGgnID0+IHN0cmxlbigkZGF0YVByb3ApKSk7CiAgICAgICAgICAgICRkYXRhU2VjdGlvbl9OdW1Qcm9wcysrOwogICAgICAgIH0KICAgICAgICAvLyAgICBBdXRob3IgKENyZWF0b3IpCiAgICAgICAgaWYgKCR0aGlzLT5waHBFeGNlbC0+Z2V0UHJvcGVydGllcygpLT5nZXRDcmVhdG9yKCkpIHsKICAgICAgICAgICAgJGRhdGFQcm9wID0gJHRoaXMtPnBocEV4Y2VsLT5nZXRQcm9wZXJ0aWVzKCktPmdldENyZWF0b3IoKTsKICAgICAgICAgICAgJGRhdGFTZWN0aW9uW10gPSBhcnJheSgnc3VtbWFyeSc9PiBhcnJheSgncGFjaycgPT4gJ1YnLCAnZGF0YScgPT4gMHgwNCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29mZnNldCcgPT4gYXJyYXkoJ3BhY2snID0+ICdWJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3R5cGUnICAgICA9PiBhcnJheSgncGFjaycgPT4gJ1YnLCAnZGF0YScgPT4gMHgxRSksIC8vIG51bGwtdGVybWluYXRlZCBzdHJpbmcgcHJlcGVuZGVkIGJ5IGR3b3JkIHN0cmluZyBsZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YScgICAgPT4gYXJyYXkoJ2RhdGEnID0+ICRkYXRhUHJvcCwgJ2xlbmd0aCcgPT4gc3RybGVuKCRkYXRhUHJvcCkpKTsKICAgICAgICAgICAgJGRhdGFTZWN0aW9uX051bVByb3BzKys7CiAgICAgICAgfQogICAgICAgIC8vICAgIEtleXdvcmRzCiAgICAgICAgaWYgKCR0aGlzLT5waHBFeGNlbC0+Z2V0UHJvcGVydGllcygpLT5nZXRLZXl3b3JkcygpKSB7CiAgICAgICAgICAgICRkYXRhUHJvcCA9ICR0aGlzLT5waHBFeGNlbC0+Z2V0UHJvcGVydGllcygpLT5nZXRLZXl3b3JkcygpOwogICAgICAgICAgICAkZGF0YVNlY3Rpb25bXSA9IGFycmF5KCdzdW1tYXJ5Jz0+IGFycmF5KCdwYWNrJyA9PiAnVicsICdkYXRhJyA9PiAweDA1KSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb2Zmc2V0JyA9PiBhcnJheSgncGFjaycgPT4gJ1YnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHlwZScgICAgID0+IGFycmF5KCdwYWNrJyA9PiAnVicsICdkYXRhJyA9PiAweDFFKSwgLy8gbnVsbC10ZXJtaW5hdGVkIHN0cmluZyBwcmVwZW5kZWQgYnkgZHdvcmQgc3RyaW5nIGxlbmd0aAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhJyAgICA9PiBhcnJheSgnZGF0YScgPT4gJGRhdGFQcm9wLCAnbGVuZ3RoJyA9PiBzdHJsZW4oJGRhdGFQcm9wKSkpOwogICAgICAgICAgICAkZGF0YVNlY3Rpb25fTnVtUHJvcHMrKzsKICAgICAgICB9CiAgICAgICAgLy8gICAgQ29tbWVudHMgKERlc2NyaXB0aW9uKQogICAgICAgIGlmICgkdGhpcy0+cGhwRXhjZWwtPmdldFByb3BlcnRpZXMoKS0+Z2V0RGVzY3JpcHRpb24oKSkgewogICAgICAgICAgICAkZGF0YVByb3AgPSAkdGhpcy0+cGhwRXhjZWwtPmdldFByb3BlcnRpZXMoKS0+Z2V0RGVzY3JpcHRpb24oKTsKICAgICAgICAgICAgJGRhdGFTZWN0aW9uW10gPSBhcnJheSgnc3VtbWFyeSc9PiBhcnJheSgncGFjaycgPT4gJ1YnLCAnZGF0YScgPT4gMHgwNiksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29mZnNldCcgPT4gYXJyYXkoJ3BhY2snID0+ICdWJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3R5cGUnICAgICA9PiBhcnJheSgncGFjaycgPT4gJ1YnLCAnZGF0YScgPT4gMHgxRSksIC8vIG51bGwtdGVybWluYXRlZCBzdHJpbmcgcHJlcGVuZGVkIGJ5IGR3b3JkIHN0cmluZyBsZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YScgICAgPT4gYXJyYXkoJ2RhdGEnID0+ICRkYXRhUHJvcCwgJ2xlbmd0aCcgPT4gc3RybGVuKCRkYXRhUHJvcCkpKTsKICAgICAgICAgICAgJGRhdGFTZWN0aW9uX051bVByb3BzKys7CiAgICAgICAgfQogICAgICAgIC8vICAgIExhc3QgU2F2ZWQgQnkgKExhc3RNb2RpZmllZEJ5KQogICAgICAgIGlmICgkdGhpcy0+cGhwRXhjZWwtPmdldFByb3BlcnRpZXMoKS0+Z2V0TGFzdE1vZGlmaWVkQnkoKSkgewogICAgICAgICAgICAkZGF0YVByb3AgPSAkdGhpcy0+cGhwRXhjZWwtPmdldFByb3BlcnRpZXMoKS0+Z2V0TGFzdE1vZGlmaWVkQnkoKTsKICAgICAgICAgICAgJGRhdGFTZWN0aW9uW10gPSBhcnJheSgnc3VtbWFyeSc9PiBhcnJheSgncGFjaycgPT4gJ1YnLCAnZGF0YScgPT4gMHgwOCksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29mZnNldCcgPT4gYXJyYXkoJ3BhY2snID0+ICdWJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3R5cGUnICAgICA9PiBhcnJheSgncGFjaycgPT4gJ1YnLCAnZGF0YScgPT4gMHgxRSksIC8vIG51bGwtdGVybWluYXRlZCBzdHJpbmcgcHJlcGVuZGVkIGJ5IGR3b3JkIHN0cmluZyBsZW5ndGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YScgICAgPT4gYXJyYXkoJ2RhdGEnID0+ICRkYXRhUHJvcCwgJ2xlbmd0aCcgPT4gc3RybGVuKCRkYXRhUHJvcCkpKTsKICAgICAgICAgICAgJGRhdGFTZWN0aW9uX051bVByb3BzKys7CiAgICAgICAgfQogICAgICAgIC8vICAgIENyZWF0ZWQgRGF0ZS9UaW1lCiAgICAgICAgaWYgKCR0aGlzLT5waHBFeGNlbC0+Z2V0UHJvcGVydGllcygpLT5nZXRDcmVhdGVkKCkpIHsKICAgICAgICAgICAgJGRhdGFQcm9wID0gJHRoaXMtPnBocEV4Y2VsLT5nZXRQcm9wZXJ0aWVzKCktPmdldENyZWF0ZWQoKTsKICAgICAgICAgICAgJGRhdGFTZWN0aW9uW10gPSBhcnJheSgnc3VtbWFyeSc9PiBhcnJheSgncGFjaycgPT4gJ1YnLCAnZGF0YScgPT4gMHgwQyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29mZnNldCcgPT4gYXJyYXkoJ3BhY2snID0+ICdWJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3R5cGUnICAgICA9PiBhcnJheSgncGFjaycgPT4gJ1YnLCAnZGF0YScgPT4gMHg0MCksIC8vIEZpbGV0aW1lICg2NC1iaXQgdmFsdWUgcmVwcmVzZW50aW5nIHRoZSBudW1iZXIgb2YgMTAwLW5hbm9zZWNvbmQgaW50ZXJ2YWxzIHNpbmNlIEphbnVhcnkgMSwgMTYwMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YScgICAgPT4gYXJyYXkoJ2RhdGEnID0+IFBIUEV4Y2VsX1NoYXJlZF9PTEU6OkxvY2FsRGF0ZTJPTEUoJGRhdGFQcm9wKSkpOwogICAgICAgICAgICAkZGF0YVNlY3Rpb25fTnVtUHJvcHMrKzsKICAgICAgICB9CiAgICAgICAgLy8gICAgTW9kaWZpZWQgRGF0ZS9UaW1lCiAgICAgICAgaWYgKCR0aGlzLT5waHBFeGNlbC0+Z2V0UHJvcGVydGllcygpLT5nZXRNb2RpZmllZCgpKSB7CiAgICAgICAgICAgICRkYXRhUHJvcCA9ICR0aGlzLT5waHBFeGNlbC0+Z2V0UHJvcGVydGllcygpLT5nZXRNb2RpZmllZCgpOwogICAgICAgICAgICAkZGF0YVNlY3Rpb25bXSA9IGFycmF5KCdzdW1tYXJ5Jz0+IGFycmF5KCdwYWNrJyA9PiAnVicsICdkYXRhJyA9PiAweDBEKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb2Zmc2V0JyA9PiBhcnJheSgncGFjaycgPT4gJ1YnKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHlwZScgICAgID0+IGFycmF5KCdwYWNrJyA9PiAnVicsICdkYXRhJyA9PiAweDQwKSwgLy8gRmlsZXRpbWUgKDY0LWJpdCB2YWx1ZSByZXByZXNlbnRpbmcgdGhlIG51bWJlciBvZiAxMDAtbmFub3NlY29uZCBpbnRlcnZhbHMgc2luY2UgSmFudWFyeSAxLCAxNjAxKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdkYXRhJyAgICA9PiBhcnJheSgnZGF0YScgPT4gUEhQRXhjZWxfU2hhcmVkX09MRTo6TG9jYWxEYXRlMk9MRSgkZGF0YVByb3ApKSk7CiAgICAgICAgICAgICRkYXRhU2VjdGlvbl9OdW1Qcm9wcysrOwogICAgICAgIH0KICAgICAgICAvLyAgICBTZWN1cml0eQogICAgICAgICRkYXRhU2VjdGlvbltdID0gYXJyYXkoJ3N1bW1hcnknPT4gYXJyYXkoJ3BhY2snID0+ICdWJywgJ2RhdGEnID0+IDB4MTMpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ29mZnNldCcgPT4gYXJyYXkoJ3BhY2snID0+ICdWJyksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndHlwZScgICAgID0+IGFycmF5KCdwYWNrJyA9PiAnVicsICdkYXRhJyA9PiAweDAzKSwgLy8gNCBieXRlIHNpZ25lZCBpbnRlZ2VyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGF0YScgICAgPT4gYXJyYXkoJ2RhdGEnID0+IDB4MDApKTsKICAgICAgICAkZGF0YVNlY3Rpb25fTnVtUHJvcHMrKzsKCgogICAgICAgIC8vICAgICAgICAgNCAgICAgU2VjdGlvbiBMZW5ndGgKICAgICAgICAvLyAgICAgICAgNCAgICAgUHJvcGVydHkgY291bnQKICAgICAgICAvLyAgICAgICAgOCAqICRkYXRhU2VjdGlvbl9OdW1Qcm9wcyAoOCA9ICBJRCAoNCkgKyBPZmZTZXQoNCkpCiAgICAgICAgJGRhdGFTZWN0aW9uX0NvbnRlbnRfT2Zmc2V0ID0gOCArICRkYXRhU2VjdGlvbl9OdW1Qcm9wcyAqIDg7CiAgICAgICAgZm9yZWFjaCAoJGRhdGFTZWN0aW9uIGFzICRkYXRhUHJvcCkgewogICAgICAgICAgICAvLyBTdW1tYXJ5CiAgICAgICAgICAgICRkYXRhU2VjdGlvbl9TdW1tYXJ5IC49IHBhY2soJGRhdGFQcm9wWydzdW1tYXJ5J11bJ3BhY2snXSwgJGRhdGFQcm9wWydzdW1tYXJ5J11bJ2RhdGEnXSk7CiAgICAgICAgICAgIC8vIE9mZnNldAogICAgICAgICAgICAkZGF0YVNlY3Rpb25fU3VtbWFyeSAuPSBwYWNrKCRkYXRhUHJvcFsnb2Zmc2V0J11bJ3BhY2snXSwgJGRhdGFTZWN0aW9uX0NvbnRlbnRfT2Zmc2V0KTsKICAgICAgICAgICAgLy8gRGF0YVR5cGUKICAgICAgICAgICAgJGRhdGFTZWN0aW9uX0NvbnRlbnQgLj0gcGFjaygkZGF0YVByb3BbJ3R5cGUnXVsncGFjayddLCAkZGF0YVByb3BbJ3R5cGUnXVsnZGF0YSddKTsKICAgICAgICAgICAgLy8gRGF0YQogICAgICAgICAgICBpZiAoJGRhdGFQcm9wWyd0eXBlJ11bJ2RhdGEnXSA9PSAweDAyKSB7IC8vIDIgYnl0ZSBzaWduZWQgaW50ZWdlcgogICAgICAgICAgICAgICAgJGRhdGFTZWN0aW9uX0NvbnRlbnQgLj0gcGFjaygnVicsICRkYXRhUHJvcFsnZGF0YSddWydkYXRhJ10pOwoKICAgICAgICAgICAgICAgICRkYXRhU2VjdGlvbl9Db250ZW50X09mZnNldCArPSA0ICsgNDsKICAgICAgICAgICAgfSBlbHNlaWYgKCRkYXRhUHJvcFsndHlwZSddWydkYXRhJ10gPT0gMHgwMykgeyAvLyA0IGJ5dGUgc2lnbmVkIGludGVnZXIKICAgICAgICAgICAgICAgICRkYXRhU2VjdGlvbl9Db250ZW50IC49IHBhY2soJ1YnLCAkZGF0YVByb3BbJ2RhdGEnXVsnZGF0YSddKTsKCiAgICAgICAgICAgICAgICAkZGF0YVNlY3Rpb25fQ29udGVudF9PZmZzZXQgKz0gNCArIDQ7CiAgICAgICAgICAgIH0gZWxzZWlmICgkZGF0YVByb3BbJ3R5cGUnXVsnZGF0YSddID09IDB4MUUpIHsgLy8gbnVsbC10ZXJtaW5hdGVkIHN0cmluZyBwcmVwZW5kZWQgYnkgZHdvcmQgc3RyaW5nIGxlbmd0aAogICAgICAgICAgICAgICAgLy8gTnVsbC10ZXJtaW5hdGVkIHN0cmluZwogICAgICAgICAgICAgICAgJGRhdGFQcm9wWydkYXRhJ11bJ2RhdGEnXSAuPSBjaHIoMCk7CiAgICAgICAgICAgICAgICAkZGF0YVByb3BbJ2RhdGEnXVsnbGVuZ3RoJ10gKz0gMTsKICAgICAgICAgICAgICAgIC8vIENvbXBsZXRlIHRoZSBzdHJpbmcgd2l0aCBudWxsIHN0cmluZyBmb3IgYmVpbmcgYSAlNAogICAgICAgICAgICAgICAgJGRhdGFQcm9wWydkYXRhJ11bJ2xlbmd0aCddID0gJGRhdGFQcm9wWydkYXRhJ11bJ2xlbmd0aCddICsgKCg0IC0gJGRhdGFQcm9wWydkYXRhJ11bJ2xlbmd0aCddICUgNCk9PTQgPyAwIDogKDQgLSAkZGF0YVByb3BbJ2RhdGEnXVsnbGVuZ3RoJ10gJSA0KSk7CiAgICAgICAgICAgICAgICAkZGF0YVByb3BbJ2RhdGEnXVsnZGF0YSddID0gc3RyX3BhZCgkZGF0YVByb3BbJ2RhdGEnXVsnZGF0YSddLCAkZGF0YVByb3BbJ2RhdGEnXVsnbGVuZ3RoJ10sIGNocigwKSwgU1RSX1BBRF9SSUdIVCk7CgogICAgICAgICAgICAgICAgJGRhdGFTZWN0aW9uX0NvbnRlbnQgLj0gcGFjaygnVicsICRkYXRhUHJvcFsnZGF0YSddWydsZW5ndGgnXSk7CiAgICAgICAgICAgICAgICAkZGF0YVNlY3Rpb25fQ29udGVudCAuPSAkZGF0YVByb3BbJ2RhdGEnXVsnZGF0YSddOwoKICAgICAgICAgICAgICAgICRkYXRhU2VjdGlvbl9Db250ZW50X09mZnNldCArPSA0ICsgNCArIHN0cmxlbigkZGF0YVByb3BbJ2RhdGEnXVsnZGF0YSddKTsKICAgICAgICAgICAgfSBlbHNlaWYgKCRkYXRhUHJvcFsndHlwZSddWydkYXRhJ10gPT0gMHg0MCkgeyAvLyBGaWxldGltZSAoNjQtYml0IHZhbHVlIHJlcHJlc2VudGluZyB0aGUgbnVtYmVyIG9mIDEwMC1uYW5vc2Vjb25kIGludGVydmFscyBzaW5jZSBKYW51YXJ5IDEsIDE2MDEpCiAgICAgICAgICAgICAgICAkZGF0YVNlY3Rpb25fQ29udGVudCAuPSAkZGF0YVByb3BbJ2RhdGEnXVsnZGF0YSddOwoKICAgICAgICAgICAgICAgICRkYXRhU2VjdGlvbl9Db250ZW50X09mZnNldCArPSA0ICsgODsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIC8vIERhdGEgVHlwZSBOb3QgVXNlZCBhdCB0aGUgbW9tZW50CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLy8gTm93ICRkYXRhU2VjdGlvbl9Db250ZW50X09mZnNldCBjb250YWlucyB0aGUgc2l6ZSBvZiB0aGUgY29udGVudAoKICAgICAgICAvLyBzZWN0aW9uIGhlYWRlcgogICAgICAgIC8vIG9mZnNldDogJHNlY09mZnNldDsgc2l6ZTogNDsgc2VjdGlvbiBsZW5ndGgKICAgICAgICAvLyAgICAgICAgICsgeCAgU2l6ZSBvZiB0aGUgY29udGVudCAoc3VtbWFyeSArIGNvbnRlbnQpCiAgICAgICAgJGRhdGEgLj0gcGFjaygnVicsICRkYXRhU2VjdGlvbl9Db250ZW50X09mZnNldCk7CiAgICAgICAgLy8gb2Zmc2V0OiAkc2VjT2Zmc2V0KzQ7IHNpemU6IDQ7IHByb3BlcnR5IGNvdW50CiAgICAgICAgJGRhdGEgLj0gcGFjaygnVicsICRkYXRhU2VjdGlvbl9OdW1Qcm9wcyk7CiAgICAgICAgLy8gU2VjdGlvbiBTdW1tYXJ5CiAgICAgICAgJGRhdGEgLj0gJGRhdGFTZWN0aW9uX1N1bW1hcnk7CiAgICAgICAgLy8gU2VjdGlvbiBDb250ZW50CiAgICAgICAgJGRhdGEgLj0gJGRhdGFTZWN0aW9uX0NvbnRlbnQ7CgogICAgICAgIHJldHVybiAkZGF0YTsKICAgIH0KfQo=",
    "size": "40805"
}