{
    "namaFile": "lib\/PHPExcel\/Classes\/PHPExcel\/Reader\/OOCalc.php",
    "lastUpdate": "2017-12-25+01:39:38.00",
    "contentFile": "PD9waHAKCi8qKiBQSFBFeGNlbCByb290IGRpcmVjdG9yeSAqLwppZiAoIWRlZmluZWQoJ1BIUEVYQ0VMX1JPT1QnKSkgewogICAgLyoqCiAgICAgKiBAaWdub3JlCiAgICAgKi8KICAgIGRlZmluZSgnUEhQRVhDRUxfUk9PVCcsIGRpcm5hbWUoX19GSUxFX18pIC4gJy8uLi8uLi8nKTsKICAgIHJlcXVpcmUoUEhQRVhDRUxfUk9PVCAuICdQSFBFeGNlbC9BdXRvbG9hZGVyLnBocCcpOwp9CgovKioKICogUEhQRXhjZWxfUmVhZGVyX09PQ2FsYwogKgogKiBDb3B5cmlnaHQgKGMpIDIwMDYgLSAyMDE1IFBIUEV4Y2VsCiAqCiAqIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKICogbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYwogKiBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKICogdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiAqCiAqIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAogKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgogKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVQogKiBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgogKgogKiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCiAqIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgd3JpdGUgdG8gdGhlIEZyZWUgU29mdHdhcmUKICogRm91bmRhdGlvbiwgSW5jLiwgNTEgRnJhbmtsaW4gU3RyZWV0LCBGaWZ0aCBGbG9vciwgQm9zdG9uLCBNQSAgMDIxMTAtMTMwMSAgVVNBCiAqCiAqIEBjYXRlZ29yeSAgIFBIUEV4Y2VsCiAqIEBwYWNrYWdlICAgIFBIUEV4Y2VsX1JlYWRlcgogKiBAY29weXJpZ2h0ICBDb3B5cmlnaHQgKGMpIDIwMDYgLSAyMDE1IFBIUEV4Y2VsIChodHRwOi8vd3d3LmNvZGVwbGV4LmNvbS9QSFBFeGNlbCkKICogQGxpY2Vuc2UgICAgaHR0cDovL3d3dy5nbnUub3JnL2xpY2Vuc2VzL29sZC1saWNlbnNlcy9sZ3BsLTIuMS50eHQgICAgTEdQTAogKiBAdmVyc2lvbiAgICAjI1ZFUlNJT04jIywgIyNEQVRFIyMKICovCmNsYXNzIFBIUEV4Y2VsX1JlYWRlcl9PT0NhbGMgZXh0ZW5kcyBQSFBFeGNlbF9SZWFkZXJfQWJzdHJhY3QgaW1wbGVtZW50cyBQSFBFeGNlbF9SZWFkZXJfSVJlYWRlcgp7CiAgICAvKioKICAgICAqIEZvcm1hdHMKICAgICAqCiAgICAgKiBAdmFyIGFycmF5CiAgICAgKi8KICAgIHByaXZhdGUgJHN0eWxlcyA9IGFycmF5KCk7CgogICAgLyoqCiAgICAgKiBDcmVhdGUgYSBuZXcgUEhQRXhjZWxfUmVhZGVyX09PQ2FsYwogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gX19jb25zdHJ1Y3QoKQogICAgewogICAgICAgICR0aGlzLT5yZWFkRmlsdGVyICAgICA9IG5ldyBQSFBFeGNlbF9SZWFkZXJfRGVmYXVsdFJlYWRGaWx0ZXIoKTsKICAgIH0KCiAgICAvKioKICAgICAqIENhbiB0aGUgY3VycmVudCBQSFBFeGNlbF9SZWFkZXJfSVJlYWRlciByZWFkIHRoZSBmaWxlPwogICAgICoKICAgICAqIEBwYXJhbSAgICAgc3RyaW5nICAgICAgICAgJHBGaWxlbmFtZQogICAgICogQHJldHVybiAgICAgYm9vbGVhbgogICAgICogQHRocm93cyBQSFBFeGNlbF9SZWFkZXJfRXhjZXB0aW9uCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBjYW5SZWFkKCRwRmlsZW5hbWUpCiAgICB7CiAgICAgICAgLy8gQ2hlY2sgaWYgZmlsZSBleGlzdHMKICAgICAgICBpZiAoIWZpbGVfZXhpc3RzKCRwRmlsZW5hbWUpKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBQSFBFeGNlbF9SZWFkZXJfRXhjZXB0aW9uKCJDb3VsZCBub3Qgb3BlbiAiIC4gJHBGaWxlbmFtZSAuICIgZm9yIHJlYWRpbmchIEZpbGUgZG9lcyBub3QgZXhpc3QuIik7CiAgICAgICAgfQoKICAgICAgICAkemlwQ2xhc3MgPSBQSFBFeGNlbF9TZXR0aW5nczo6Z2V0WmlwQ2xhc3MoKTsKCiAgICAgICAgLy8gQ2hlY2sgaWYgemlwIGNsYXNzIGV4aXN0cwovLyAgICAgICAgaWYgKCFjbGFzc19leGlzdHMoJHppcENsYXNzLCBmYWxzZSkpIHsKLy8gICAgICAgICAgICB0aHJvdyBuZXcgUEhQRXhjZWxfUmVhZGVyX0V4Y2VwdGlvbigkemlwQ2xhc3MgLiAiIGxpYnJhcnkgaXMgbm90IGVuYWJsZWQiKTsKLy8gICAgICAgIH0KCiAgICAgICAgJG1pbWVUeXBlID0gJ1VOS05PV04nOwogICAgICAgIC8vIExvYWQgZmlsZQogICAgICAgICR6aXAgPSBuZXcgJHppcENsYXNzOwogICAgICAgIGlmICgkemlwLT5vcGVuKCRwRmlsZW5hbWUpID09PSB0cnVlKSB7CiAgICAgICAgICAgIC8vIGNoZWNrIGlmIGl0IGlzIGFuIE9PWE1MIGFyY2hpdmUKICAgICAgICAgICAgJHN0YXQgPSAkemlwLT5zdGF0TmFtZSgnbWltZXR5cGUnKTsKICAgICAgICAgICAgaWYgKCRzdGF0ICYmICgkc3RhdFsnc2l6ZSddIDw9IDI1NSkpIHsKICAgICAgICAgICAgICAgICRtaW1lVHlwZSA9ICR6aXAtPmdldEZyb21OYW1lKCRzdGF0WyduYW1lJ10pOwogICAgICAgICAgICB9IGVsc2VpZiAoJHN0YXQgPSAkemlwLT5zdGF0TmFtZSgnTUVUQS1JTkYvbWFuaWZlc3QueG1sJykpIHsKICAgICAgICAgICAgICAgICR4bWwgPSBzaW1wbGV4bWxfbG9hZF9zdHJpbmcoJHRoaXMtPnNlY3VyaXR5U2NhbigkemlwLT5nZXRGcm9tTmFtZSgnTUVUQS1JTkYvbWFuaWZlc3QueG1sJykpLCAnU2ltcGxlWE1MRWxlbWVudCcsIFBIUEV4Y2VsX1NldHRpbmdzOjpnZXRMaWJYbWxMb2FkZXJPcHRpb25zKCkpOwogICAgICAgICAgICAgICAgJG5hbWVzcGFjZXNDb250ZW50ID0gJHhtbC0+Z2V0TmFtZXNwYWNlcyh0cnVlKTsKICAgICAgICAgICAgICAgIGlmIChpc3NldCgkbmFtZXNwYWNlc0NvbnRlbnRbJ21hbmlmZXN0J10pKSB7CiAgICAgICAgICAgICAgICAgICAgJG1hbmlmZXN0ID0gJHhtbC0+Y2hpbGRyZW4oJG5hbWVzcGFjZXNDb250ZW50WydtYW5pZmVzdCddKTsKICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkbWFuaWZlc3QgYXMgJG1hbmlmZXN0RGF0YVNldCkgewogICAgICAgICAgICAgICAgICAgICAgICAkbWFuaWZlc3RBdHRyaWJ1dGVzID0gJG1hbmlmZXN0RGF0YVNldC0+YXR0cmlidXRlcygkbmFtZXNwYWNlc0NvbnRlbnRbJ21hbmlmZXN0J10pOwogICAgICAgICAgICAgICAgICAgICAgICBpZiAoJG1hbmlmZXN0QXR0cmlidXRlcy0+eydmdWxsLXBhdGgnfSA9PSAnLycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtaW1lVHlwZSA9IChzdHJpbmcpICRtYW5pZmVzdEF0dHJpYnV0ZXMtPnsnbWVkaWEtdHlwZSd9OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICR6aXAtPmNsb3NlKCk7CgogICAgICAgICAgICByZXR1cm4gKCRtaW1lVHlwZSA9PT0gJ2FwcGxpY2F0aW9uL3ZuZC5vYXNpcy5vcGVuZG9jdW1lbnQuc3ByZWFkc2hlZXQnKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCgogICAgLyoqCiAgICAgKiBSZWFkcyBuYW1lcyBvZiB0aGUgd29ya3NoZWV0cyBmcm9tIGEgZmlsZSwgd2l0aG91dCBwYXJzaW5nIHRoZSB3aG9sZSBmaWxlIHRvIGEgUEhQRXhjZWwgb2JqZWN0CiAgICAgKgogICAgICogQHBhcmFtICAgICBzdHJpbmcgICAgICAgICAkcEZpbGVuYW1lCiAgICAgKiBAdGhyb3dzICAgICBQSFBFeGNlbF9SZWFkZXJfRXhjZXB0aW9uCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBsaXN0V29ya3NoZWV0TmFtZXMoJHBGaWxlbmFtZSkKICAgIHsKICAgICAgICAvLyBDaGVjayBpZiBmaWxlIGV4aXN0cwogICAgICAgIGlmICghZmlsZV9leGlzdHMoJHBGaWxlbmFtZSkpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFBIUEV4Y2VsX1JlYWRlcl9FeGNlcHRpb24oIkNvdWxkIG5vdCBvcGVuICIgLiAkcEZpbGVuYW1lIC4gIiBmb3IgcmVhZGluZyEgRmlsZSBkb2VzIG5vdCBleGlzdC4iKTsKICAgICAgICB9CgogICAgICAgICR6aXBDbGFzcyA9IFBIUEV4Y2VsX1NldHRpbmdzOjpnZXRaaXBDbGFzcygpOwoKICAgICAgICAkemlwID0gbmV3ICR6aXBDbGFzczsKICAgICAgICBpZiAoISR6aXAtPm9wZW4oJHBGaWxlbmFtZSkpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFBIUEV4Y2VsX1JlYWRlcl9FeGNlcHRpb24oIkNvdWxkIG5vdCBvcGVuICIgLiAkcEZpbGVuYW1lIC4gIiBmb3IgcmVhZGluZyEgRXJyb3Igb3BlbmluZyBmaWxlLiIpOwogICAgICAgIH0KCiAgICAgICAgJHdvcmtzaGVldE5hbWVzID0gYXJyYXkoKTsKCiAgICAgICAgJHhtbCA9IG5ldyBYTUxSZWFkZXIoKTsKICAgICAgICAkcmVzID0gJHhtbC0+eG1sKCR0aGlzLT5zZWN1cml0eVNjYW5GaWxlKCd6aXA6Ly8nLnJlYWxwYXRoKCRwRmlsZW5hbWUpLicjY29udGVudC54bWwnKSwgbnVsbCwgUEhQRXhjZWxfU2V0dGluZ3M6OmdldExpYlhtbExvYWRlck9wdGlvbnMoKSk7CiAgICAgICAgJHhtbC0+c2V0UGFyc2VyUHJvcGVydHkoMiwgdHJ1ZSk7CgogICAgICAgIC8vICAgIFN0ZXAgaW50byB0aGUgZmlyc3QgbGV2ZWwgb2YgY29udGVudCBvZiB0aGUgWE1MCiAgICAgICAgJHhtbC0+cmVhZCgpOwogICAgICAgIHdoaWxlICgkeG1sLT5yZWFkKCkpIHsKICAgICAgICAgICAgLy8gICAgUXVpY2tseSBqdW1wIHRocm91Z2ggdG8gdGhlIG9mZmljZTpib2R5IG5vZGUKICAgICAgICAgICAgd2hpbGUgKCR4bWwtPm5hbWUgIT09ICdvZmZpY2U6Ym9keScpIHsKICAgICAgICAgICAgICAgIGlmICgkeG1sLT5pc0VtcHR5RWxlbWVudCkgewogICAgICAgICAgICAgICAgICAgICR4bWwtPnJlYWQoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJHhtbC0+bmV4dCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vICAgIE5vdyByZWFkIGVhY2ggbm9kZSB1bnRpbCB3ZSBmaW5kIG91ciBmaXJzdCB0YWJsZTp0YWJsZSBub2RlCiAgICAgICAgICAgIHdoaWxlICgkeG1sLT5yZWFkKCkpIHsKICAgICAgICAgICAgICAgIGlmICgkeG1sLT5uYW1lID09ICd0YWJsZTp0YWJsZScgJiYgJHhtbC0+bm9kZVR5cGUgPT0gWE1MUmVhZGVyOjpFTEVNRU5UKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gICAgTG9vcCB0aHJvdWdoIGVhY2ggdGFibGU6dGFibGUgbm9kZSByZWFkaW5nIHRoZSB0YWJsZTpuYW1lIGF0dHJpYnV0ZSBmb3IgZWFjaCB3b3Jrc2hlZXQgbmFtZQogICAgICAgICAgICAgICAgICAgIGRvIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHdvcmtzaGVldE5hbWVzW10gPSAkeG1sLT5nZXRBdHRyaWJ1dGUoJ3RhYmxlOm5hbWUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgJHhtbC0+bmV4dCgpOwogICAgICAgICAgICAgICAgICAgIH0gd2hpbGUgKCR4bWwtPm5hbWUgPT0gJ3RhYmxlOnRhYmxlJyAmJiAkeG1sLT5ub2RlVHlwZSA9PSBYTUxSZWFkZXI6OkVMRU1FTlQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gJHdvcmtzaGVldE5hbWVzOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHdvcmtzaGVldCBpbmZvIChOYW1lLCBMYXN0IENvbHVtbiBMZXR0ZXIsIExhc3QgQ29sdW1uIEluZGV4LCBUb3RhbCBSb3dzLCBUb3RhbCBDb2x1bW5zKQogICAgICoKICAgICAqIEBwYXJhbSAgIHN0cmluZyAgICAgJHBGaWxlbmFtZQogICAgICogQHRocm93cyAgIFBIUEV4Y2VsX1JlYWRlcl9FeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIGxpc3RXb3Jrc2hlZXRJbmZvKCRwRmlsZW5hbWUpCiAgICB7CiAgICAgICAgLy8gQ2hlY2sgaWYgZmlsZSBleGlzdHMKICAgICAgICBpZiAoIWZpbGVfZXhpc3RzKCRwRmlsZW5hbWUpKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBQSFBFeGNlbF9SZWFkZXJfRXhjZXB0aW9uKCJDb3VsZCBub3Qgb3BlbiAiIC4gJHBGaWxlbmFtZSAuICIgZm9yIHJlYWRpbmchIEZpbGUgZG9lcyBub3QgZXhpc3QuIik7CiAgICAgICAgfQoKICAgICAgICAkd29ya3NoZWV0SW5mbyA9IGFycmF5KCk7CgogICAgICAgICR6aXBDbGFzcyA9IFBIUEV4Y2VsX1NldHRpbmdzOjpnZXRaaXBDbGFzcygpOwoKICAgICAgICAkemlwID0gbmV3ICR6aXBDbGFzczsKICAgICAgICBpZiAoISR6aXAtPm9wZW4oJHBGaWxlbmFtZSkpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFBIUEV4Y2VsX1JlYWRlcl9FeGNlcHRpb24oIkNvdWxkIG5vdCBvcGVuICIgLiAkcEZpbGVuYW1lIC4gIiBmb3IgcmVhZGluZyEgRXJyb3Igb3BlbmluZyBmaWxlLiIpOwogICAgICAgIH0KCiAgICAgICAgJHhtbCA9IG5ldyBYTUxSZWFkZXIoKTsKICAgICAgICAkcmVzID0gJHhtbC0+eG1sKCR0aGlzLT5zZWN1cml0eVNjYW5GaWxlKCd6aXA6Ly8nLnJlYWxwYXRoKCRwRmlsZW5hbWUpLicjY29udGVudC54bWwnKSwgbnVsbCwgUEhQRXhjZWxfU2V0dGluZ3M6OmdldExpYlhtbExvYWRlck9wdGlvbnMoKSk7CiAgICAgICAgJHhtbC0+c2V0UGFyc2VyUHJvcGVydHkoMiwgdHJ1ZSk7CgogICAgICAgIC8vICAgIFN0ZXAgaW50byB0aGUgZmlyc3QgbGV2ZWwgb2YgY29udGVudCBvZiB0aGUgWE1MCiAgICAgICAgJHhtbC0+cmVhZCgpOwogICAgICAgIHdoaWxlICgkeG1sLT5yZWFkKCkpIHsKICAgICAgICAgICAgLy8gICAgUXVpY2tseSBqdW1wIHRocm91Z2ggdG8gdGhlIG9mZmljZTpib2R5IG5vZGUKICAgICAgICAgICAgd2hpbGUgKCR4bWwtPm5hbWUgIT09ICdvZmZpY2U6Ym9keScpIHsKICAgICAgICAgICAgICAgIGlmICgkeG1sLT5pc0VtcHR5RWxlbWVudCkgewogICAgICAgICAgICAgICAgICAgICR4bWwtPnJlYWQoKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJHhtbC0+bmV4dCgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAvLyAgICBOb3cgcmVhZCBlYWNoIG5vZGUgdW50aWwgd2UgZmluZCBvdXIgZmlyc3QgdGFibGU6dGFibGUgbm9kZQogICAgICAgICAgICB3aGlsZSAoJHhtbC0+cmVhZCgpKSB7CiAgICAgICAgICAgICAgICBpZiAoJHhtbC0+bmFtZSA9PSAndGFibGU6dGFibGUnICYmICR4bWwtPm5vZGVUeXBlID09IFhNTFJlYWRlcjo6RUxFTUVOVCkgewogICAgICAgICAgICAgICAgICAgICR3b3Jrc2hlZXROYW1lc1tdID0gJHhtbC0+Z2V0QXR0cmlidXRlKCd0YWJsZTpuYW1lJyk7CgogICAgICAgICAgICAgICAgICAgICR0bXBJbmZvID0gYXJyYXkoCiAgICAgICAgICAgICAgICAgICAgICAgICd3b3Jrc2hlZXROYW1lJyA9PiAkeG1sLT5nZXRBdHRyaWJ1dGUoJ3RhYmxlOm5hbWUnKSwKICAgICAgICAgICAgICAgICAgICAgICAgJ2xhc3RDb2x1bW5MZXR0ZXInID0+ICdBJywKICAgICAgICAgICAgICAgICAgICAgICAgJ2xhc3RDb2x1bW5JbmRleCcgPT4gMCwKICAgICAgICAgICAgICAgICAgICAgICAgJ3RvdGFsUm93cycgPT4gMCwKICAgICAgICAgICAgICAgICAgICAgICAgJ3RvdGFsQ29sdW1ucycgPT4gMCwKICAgICAgICAgICAgICAgICAgICApOwoKICAgICAgICAgICAgICAgICAgICAvLyAgICBMb29wIHRocm91Z2ggZWFjaCBjaGlsZCBub2RlIG9mIHRoZSB0YWJsZTp0YWJsZSBlbGVtZW50IHJlYWRpbmcKICAgICAgICAgICAgICAgICAgICAkY3VyckNlbGxzID0gMDsKICAgICAgICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAgICAgICAgICR4bWwtPnJlYWQoKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCR4bWwtPm5hbWUgPT0gJ3RhYmxlOnRhYmxlLXJvdycgJiYgJHhtbC0+bm9kZVR5cGUgPT0gWE1MUmVhZGVyOjpFTEVNRU5UKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm93c3BhbiA9ICR4bWwtPmdldEF0dHJpYnV0ZSgndGFibGU6bnVtYmVyLXJvd3MtcmVwZWF0ZWQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb3dzcGFuID0gZW1wdHkoJHJvd3NwYW4pID8gMSA6ICRyb3dzcGFuOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRtcEluZm9bJ3RvdGFsUm93cyddICs9ICRyb3dzcGFuOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRtcEluZm9bJ3RvdGFsQ29sdW1ucyddID0gbWF4KCR0bXBJbmZvWyd0b3RhbENvbHVtbnMnXSwgJGN1cnJDZWxscyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY3VyckNlbGxzID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgIFN0ZXAgaW50byB0aGUgcm93CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkeG1sLT5yZWFkKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkbyB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCR4bWwtPm5hbWUgPT0gJ3RhYmxlOnRhYmxlLWNlbGwnICYmICR4bWwtPm5vZGVUeXBlID09IFhNTFJlYWRlcjo6RUxFTUVOVCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoISR4bWwtPmlzRW1wdHlFbGVtZW50KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY3VyckNlbGxzKys7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkeG1sLT5uZXh0KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkeG1sLT5yZWFkKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2VpZiAoJHhtbC0+bmFtZSA9PSAndGFibGU6Y292ZXJlZC10YWJsZS1jZWxsJyAmJiAkeG1sLT5ub2RlVHlwZSA9PSBYTUxSZWFkZXI6OkVMRU1FTlQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1lcmdlU2l6ZSA9ICR4bWwtPmdldEF0dHJpYnV0ZSgndGFibGU6bnVtYmVyLWNvbHVtbnMtcmVwZWF0ZWQnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGN1cnJDZWxscyArPSAkbWVyZ2VTaXplOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkeG1sLT5yZWFkKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSB3aGlsZSAoJHhtbC0+bmFtZSAhPSAndGFibGU6dGFibGUtcm93Jyk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9IHdoaWxlICgkeG1sLT5uYW1lICE9ICd0YWJsZTp0YWJsZScpOwoKICAgICAgICAgICAgICAgICAgICAkdG1wSW5mb1sndG90YWxDb2x1bW5zJ10gPSBtYXgoJHRtcEluZm9bJ3RvdGFsQ29sdW1ucyddLCAkY3VyckNlbGxzKTsKICAgICAgICAgICAgICAgICAgICAkdG1wSW5mb1snbGFzdENvbHVtbkluZGV4J10gPSAkdG1wSW5mb1sndG90YWxDb2x1bW5zJ10gLSAxOwogICAgICAgICAgICAgICAgICAgICR0bXBJbmZvWydsYXN0Q29sdW1uTGV0dGVyJ10gPSBQSFBFeGNlbF9DZWxsOjpzdHJpbmdGcm9tQ29sdW1uSW5kZXgoJHRtcEluZm9bJ2xhc3RDb2x1bW5JbmRleCddKTsKICAgICAgICAgICAgICAgICAgICAkd29ya3NoZWV0SW5mb1tdID0gJHRtcEluZm87CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCi8vICAgICAgICAgICAgICAgIGZvcmVhY2ggKCR3b3JrYm9va0RhdGEtPnRhYmxlIGFzICR3b3Jrc2hlZXREYXRhU2V0KSB7Ci8vICAgICAgICAgICAgICAgICAgICAkd29ya3NoZWV0RGF0YSA9ICR3b3Jrc2hlZXREYXRhU2V0LT5jaGlsZHJlbigkbmFtZXNwYWNlc0NvbnRlbnRbJ3RhYmxlJ10pOwovLyAgICAgICAgICAgICAgICAgICAgJHdvcmtzaGVldERhdGFBdHRyaWJ1dGVzID0gJHdvcmtzaGVldERhdGFTZXQtPmF0dHJpYnV0ZXMoJG5hbWVzcGFjZXNDb250ZW50Wyd0YWJsZSddKTsKLy8KLy8gICAgICAgICAgICAgICAgICAgICRyb3dJbmRleCA9IDA7Ci8vICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkd29ya3NoZWV0RGF0YSBhcyAka2V5ID0+ICRyb3dEYXRhKSB7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICgka2V5KSB7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3RhYmxlLXJvdycgOgovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvd0RhdGFUYWJsZUF0dHJpYnV0ZXMgPSAkcm93RGF0YS0+YXR0cmlidXRlcygkbmFtZXNwYWNlc0NvbnRlbnRbJ3RhYmxlJ10pOwovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvd1JlcGVhdHMgPSAoaXNzZXQoJHJvd0RhdGFUYWJsZUF0dHJpYnV0ZXNbJ251bWJlci1yb3dzLXJlcGVhdGVkJ10pKSA\/Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb3dEYXRhVGFibGVBdHRyaWJ1dGVzWydudW1iZXItcm93cy1yZXBlYXRlZCddIDogMTsKLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjb2x1bW5JbmRleCA9IDA7Ci8vCi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkcm93RGF0YSBhcyAka2V5ID0+ICRjZWxsRGF0YSkgewovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjZWxsRGF0YVRhYmxlQXR0cmlidXRlcyA9ICRjZWxsRGF0YS0+YXR0cmlidXRlcygkbmFtZXNwYWNlc0NvbnRlbnRbJ3RhYmxlJ10pOwovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjb2xSZXBlYXRzID0gKGlzc2V0KCRjZWxsRGF0YVRhYmxlQXR0cmlidXRlc1snbnVtYmVyLWNvbHVtbnMtcmVwZWF0ZWQnXSkpID8KLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNlbGxEYXRhVGFibGVBdHRyaWJ1dGVzWydudW1iZXItY29sdW1ucy1yZXBlYXRlZCddIDogMTsKLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY2VsbERhdGFPZmZpY2VBdHRyaWJ1dGVzID0gJGNlbGxEYXRhLT5hdHRyaWJ1dGVzKCRuYW1lc3BhY2VzQ29udGVudFsnb2ZmaWNlJ10pOwovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc3NldCgkY2VsbERhdGFPZmZpY2VBdHRyaWJ1dGVzWyd2YWx1ZS10eXBlJ10pKSB7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0bXBJbmZvWydsYXN0Q29sdW1uSW5kZXgnXSA9IG1heCgkdG1wSW5mb1snbGFzdENvbHVtbkluZGV4J10sICRjb2x1bW5JbmRleCArICRjb2xSZXBlYXRzIC0gMSk7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0bXBJbmZvWyd0b3RhbFJvd3MnXSA9IG1heCgkdG1wSW5mb1sndG90YWxSb3dzJ10sICRyb3dJbmRleCArICRyb3dSZXBlYXRzKTsKLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNvbHVtbkluZGV4ICs9ICRjb2xSZXBlYXRzOwovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvd0luZGV4ICs9ICRyb3dSZXBlYXRzOwovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgfQovLyAgICAgICAgICAgICAgICAgICAgfQovLwovLyAgICAgICAgICAgICAgICAgICAgJHRtcEluZm9bJ2xhc3RDb2x1bW5MZXR0ZXInXSA9IFBIUEV4Y2VsX0NlbGw6OnN0cmluZ0Zyb21Db2x1bW5JbmRleCgkdG1wSW5mb1snbGFzdENvbHVtbkluZGV4J10pOwovLyAgICAgICAgICAgICAgICAgICAgJHRtcEluZm9bJ3RvdGFsQ29sdW1ucyddID0gJHRtcEluZm9bJ2xhc3RDb2x1bW5JbmRleCddICsgMTsKLy8KLy8gICAgICAgICAgICAgICAgfQovLyAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHJldHVybiAkd29ya3NoZWV0SW5mbzsKICAgIH0KCiAgICAvKioKICAgICAqIExvYWRzIFBIUEV4Y2VsIGZyb20gZmlsZQogICAgICoKICAgICAqIEBwYXJhbSAgICAgc3RyaW5nICAgICAgICAgJHBGaWxlbmFtZQogICAgICogQHJldHVybiAgICAgUEhQRXhjZWwKICAgICAqIEB0aHJvd3MgICAgIFBIUEV4Y2VsX1JlYWRlcl9FeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIGxvYWQoJHBGaWxlbmFtZSkKICAgIHsKICAgICAgICAvLyBDcmVhdGUgbmV3IFBIUEV4Y2VsCiAgICAgICAgJG9ialBIUEV4Y2VsID0gbmV3IFBIUEV4Y2VsKCk7CgogICAgICAgIC8vIExvYWQgaW50byB0aGlzIGluc3RhbmNlCiAgICAgICAgcmV0dXJuICR0aGlzLT5sb2FkSW50b0V4aXN0aW5nKCRwRmlsZW5hbWUsICRvYmpQSFBFeGNlbCk7CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgZnVuY3Rpb24gaWRlbnRpZnlGaXhlZFN0eWxlVmFsdWUoJHN0eWxlTGlzdCwgJiRzdHlsZUF0dHJpYnV0ZVZhbHVlKQogICAgewogICAgICAgICRzdHlsZUF0dHJpYnV0ZVZhbHVlID0gc3RydG9sb3dlcigkc3R5bGVBdHRyaWJ1dGVWYWx1ZSk7CiAgICAgICAgZm9yZWFjaCAoJHN0eWxlTGlzdCBhcyAkc3R5bGUpIHsKICAgICAgICAgICAgaWYgKCRzdHlsZUF0dHJpYnV0ZVZhbHVlID09IHN0cnRvbG93ZXIoJHN0eWxlKSkgewogICAgICAgICAgICAgICAgJHN0eWxlQXR0cmlidXRlVmFsdWUgPSAkc3R5bGU7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiBMb2FkcyBQSFBFeGNlbCBmcm9tIGZpbGUgaW50byBQSFBFeGNlbCBpbnN0YW5jZQogICAgICoKICAgICAqIEBwYXJhbSAgICAgc3RyaW5nICAgICAgICAgJHBGaWxlbmFtZQogICAgICogQHBhcmFtICAgIFBIUEV4Y2VsICAgICRvYmpQSFBFeGNlbAogICAgICogQHJldHVybiAgICAgUEhQRXhjZWwKICAgICAqIEB0aHJvd3MgICAgIFBIUEV4Y2VsX1JlYWRlcl9FeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIGxvYWRJbnRvRXhpc3RpbmcoJHBGaWxlbmFtZSwgUEhQRXhjZWwgJG9ialBIUEV4Y2VsKQogICAgewogICAgICAgIC8vIENoZWNrIGlmIGZpbGUgZXhpc3RzCiAgICAgICAgaWYgKCFmaWxlX2V4aXN0cygkcEZpbGVuYW1lKSkgewogICAgICAgICAgICB0aHJvdyBuZXcgUEhQRXhjZWxfUmVhZGVyX0V4Y2VwdGlvbigiQ291bGQgbm90IG9wZW4gIiAuICRwRmlsZW5hbWUgLiAiIGZvciByZWFkaW5nISBGaWxlIGRvZXMgbm90IGV4aXN0LiIpOwogICAgICAgIH0KCiAgICAgICAgJHRpbWV6b25lT2JqID0gbmV3IERhdGVUaW1lWm9uZSgnRXVyb3BlL0xvbmRvbicpOwogICAgICAgICRHTVQgPSBuZXcgRGF0ZVRpbWVab25lKCdVVEMnKTsKCiAgICAgICAgJHppcENsYXNzID0gUEhQRXhjZWxfU2V0dGluZ3M6OmdldFppcENsYXNzKCk7CgogICAgICAgICR6aXAgPSBuZXcgJHppcENsYXNzOwogICAgICAgIGlmICghJHppcC0+b3BlbigkcEZpbGVuYW1lKSkgewogICAgICAgICAgICB0aHJvdyBuZXcgUEhQRXhjZWxfUmVhZGVyX0V4Y2VwdGlvbigiQ291bGQgbm90IG9wZW4gIiAuICRwRmlsZW5hbWUgLiAiIGZvciByZWFkaW5nISBFcnJvciBvcGVuaW5nIGZpbGUuIik7CiAgICAgICAgfQoKLy8gICAgICAgIGVjaG8gJzxoMT5NZXRhIEluZm9ybWF0aW9uPC9oMT4nOwogICAgICAgICR4bWwgPSBzaW1wbGV4bWxfbG9hZF9zdHJpbmcoJHRoaXMtPnNlY3VyaXR5U2NhbigkemlwLT5nZXRGcm9tTmFtZSgibWV0YS54bWwiKSksICdTaW1wbGVYTUxFbGVtZW50JywgUEhQRXhjZWxfU2V0dGluZ3M6OmdldExpYlhtbExvYWRlck9wdGlvbnMoKSk7CiAgICAgICAgJG5hbWVzcGFjZXNNZXRhID0gJHhtbC0+Z2V0TmFtZXNwYWNlcyh0cnVlKTsKLy8gICAgICAgIGVjaG8gJzxwcmU+JzsKLy8gICAgICAgIHByaW50X3IoJG5hbWVzcGFjZXNNZXRhKTsKLy8gICAgICAgIGVjaG8gJzwvcHJlPjxociAvPic7CgogICAgICAgICRkb2NQcm9wcyA9ICRvYmpQSFBFeGNlbC0+Z2V0UHJvcGVydGllcygpOwogICAgICAgICRvZmZpY2VQcm9wZXJ0eSA9ICR4bWwtPmNoaWxkcmVuKCRuYW1lc3BhY2VzTWV0YVsnb2ZmaWNlJ10pOwogICAgICAgIGZvcmVhY2ggKCRvZmZpY2VQcm9wZXJ0eSBhcyAkb2ZmaWNlUHJvcGVydHlEYXRhKSB7CiAgICAgICAgICAgICRvZmZpY2VQcm9wZXJ0eURDID0gYXJyYXkoKTsKICAgICAgICAgICAgaWYgKGlzc2V0KCRuYW1lc3BhY2VzTWV0YVsnZGMnXSkpIHsKICAgICAgICAgICAgICAgICRvZmZpY2VQcm9wZXJ0eURDID0gJG9mZmljZVByb3BlcnR5RGF0YS0+Y2hpbGRyZW4oJG5hbWVzcGFjZXNNZXRhWydkYyddKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmb3JlYWNoICgkb2ZmaWNlUHJvcGVydHlEQyBhcyAkcHJvcGVydHlOYW1lID0+ICRwcm9wZXJ0eVZhbHVlKSB7CiAgICAgICAgICAgICAgICAkcHJvcGVydHlWYWx1ZSA9IChzdHJpbmcpICRwcm9wZXJ0eVZhbHVlOwogICAgICAgICAgICAgICAgc3dpdGNoICgkcHJvcGVydHlOYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAndGl0bGUnOgogICAgICAgICAgICAgICAgICAgICAgICAkZG9jUHJvcHMtPnNldFRpdGxlKCRwcm9wZXJ0eVZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3ViamVjdCc6CiAgICAgICAgICAgICAgICAgICAgICAgICRkb2NQcm9wcy0+c2V0U3ViamVjdCgkcHJvcGVydHlWYWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0b3InOgogICAgICAgICAgICAgICAgICAgICAgICAkZG9jUHJvcHMtPnNldENyZWF0b3IoJHByb3BlcnR5VmFsdWUpOwogICAgICAgICAgICAgICAgICAgICAgICAkZG9jUHJvcHMtPnNldExhc3RNb2RpZmllZEJ5KCRwcm9wZXJ0eVZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnZGF0ZSc6CiAgICAgICAgICAgICAgICAgICAgICAgICRjcmVhdGlvbkRhdGUgPSBzdHJ0b3RpbWUoJHByb3BlcnR5VmFsdWUpOwogICAgICAgICAgICAgICAgICAgICAgICAkZG9jUHJvcHMtPnNldENyZWF0ZWQoJGNyZWF0aW9uRGF0ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICRkb2NQcm9wcy0+c2V0TW9kaWZpZWQoJGNyZWF0aW9uRGF0ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgJ2Rlc2NyaXB0aW9uJzoKICAgICAgICAgICAgICAgICAgICAgICAgJGRvY1Byb3BzLT5zZXREZXNjcmlwdGlvbigkcHJvcGVydHlWYWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgICRvZmZpY2VQcm9wZXJ0eU1ldGEgPSBhcnJheSgpOwogICAgICAgICAgICBpZiAoaXNzZXQoJG5hbWVzcGFjZXNNZXRhWydkYyddKSkgewogICAgICAgICAgICAgICAgJG9mZmljZVByb3BlcnR5TWV0YSA9ICRvZmZpY2VQcm9wZXJ0eURhdGEtPmNoaWxkcmVuKCRuYW1lc3BhY2VzTWV0YVsnbWV0YSddKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBmb3JlYWNoICgkb2ZmaWNlUHJvcGVydHlNZXRhIGFzICRwcm9wZXJ0eU5hbWUgPT4gJHByb3BlcnR5VmFsdWUpIHsKICAgICAgICAgICAgICAgICRwcm9wZXJ0eVZhbHVlQXR0cmlidXRlcyA9ICRwcm9wZXJ0eVZhbHVlLT5hdHRyaWJ1dGVzKCRuYW1lc3BhY2VzTWV0YVsnbWV0YSddKTsKICAgICAgICAgICAgICAgICRwcm9wZXJ0eVZhbHVlID0gKHN0cmluZykgJHByb3BlcnR5VmFsdWU7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKCRwcm9wZXJ0eU5hbWUpIHsKICAgICAgICAgICAgICAgICAgICBjYXNlICdpbml0aWFsLWNyZWF0b3InOgogICAgICAgICAgICAgICAgICAgICAgICAkZG9jUHJvcHMtPnNldENyZWF0b3IoJHByb3BlcnR5VmFsdWUpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlICdrZXl3b3JkJzoKICAgICAgICAgICAgICAgICAgICAgICAgJGRvY1Byb3BzLT5zZXRLZXl3b3JkcygkcHJvcGVydHlWYWx1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0aW9uLWRhdGUnOgogICAgICAgICAgICAgICAgICAgICAgICAkY3JlYXRpb25EYXRlID0gc3RydG90aW1lKCRwcm9wZXJ0eVZhbHVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgJGRvY1Byb3BzLT5zZXRDcmVhdGVkKCRjcmVhdGlvbkRhdGUpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlICd1c2VyLWRlZmluZWQnOgogICAgICAgICAgICAgICAgICAgICAgICAkcHJvcGVydHlWYWx1ZVR5cGUgPSBQSFBFeGNlbF9Eb2N1bWVudFByb3BlcnRpZXM6OlBST1BFUlRZX1RZUEVfU1RSSU5HOwogICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkcHJvcGVydHlWYWx1ZUF0dHJpYnV0ZXMgYXMgJGtleSA9PiAkdmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgka2V5ID09ICduYW1lJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRwcm9wZXJ0eVZhbHVlTmFtZSA9IChzdHJpbmcpICR2YWx1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZWlmICgka2V5ID09ICd2YWx1ZS10eXBlJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoJHZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2RhdGUnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHByb3BlcnR5VmFsdWUgPSBQSFBFeGNlbF9Eb2N1bWVudFByb3BlcnRpZXM6OmNvbnZlcnRQcm9wZXJ0eSgkcHJvcGVydHlWYWx1ZSwgJ2RhdGUnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRwcm9wZXJ0eVZhbHVlVHlwZSA9IFBIUEV4Y2VsX0RvY3VtZW50UHJvcGVydGllczo6UFJPUEVSVFlfVFlQRV9EQVRFOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2Jvb2xlYW4nOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHByb3BlcnR5VmFsdWUgPSBQSFBFeGNlbF9Eb2N1bWVudFByb3BlcnRpZXM6OmNvbnZlcnRQcm9wZXJ0eSgkcHJvcGVydHlWYWx1ZSwgJ2Jvb2wnKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRwcm9wZXJ0eVZhbHVlVHlwZSA9IFBIUEV4Y2VsX0RvY3VtZW50UHJvcGVydGllczo6UFJPUEVSVFlfVFlQRV9CT09MRUFOOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2Zsb2F0JzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRwcm9wZXJ0eVZhbHVlID0gUEhQRXhjZWxfRG9jdW1lbnRQcm9wZXJ0aWVzOjpjb252ZXJ0UHJvcGVydHkoJHByb3BlcnR5VmFsdWUsICdyNCcpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHByb3BlcnR5VmFsdWVUeXBlID0gUEhQRXhjZWxfRG9jdW1lbnRQcm9wZXJ0aWVzOjpQUk9QRVJUWV9UWVBFX0ZMT0FUOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcHJvcGVydHlWYWx1ZVR5cGUgPSBQSFBFeGNlbF9Eb2N1bWVudFByb3BlcnRpZXM6OlBST1BFUlRZX1RZUEVfU1RSSU5HOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAkZG9jUHJvcHMtPnNldEN1c3RvbVByb3BlcnR5KCRwcm9wZXJ0eVZhbHVlTmFtZSwgJHByb3BlcnR5VmFsdWUsICRwcm9wZXJ0eVZhbHVlVHlwZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKCi8vICAgICAgICBlY2hvICc8aDE+V29ya2Jvb2sgQ29udGVudDwvaDE+JzsKICAgICAgICAkeG1sID0gc2ltcGxleG1sX2xvYWRfc3RyaW5nKCR0aGlzLT5zZWN1cml0eVNjYW4oJHppcC0+Z2V0RnJvbU5hbWUoImNvbnRlbnQueG1sIikpLCAnU2ltcGxlWE1MRWxlbWVudCcsIFBIUEV4Y2VsX1NldHRpbmdzOjpnZXRMaWJYbWxMb2FkZXJPcHRpb25zKCkpOwogICAgICAgICRuYW1lc3BhY2VzQ29udGVudCA9ICR4bWwtPmdldE5hbWVzcGFjZXModHJ1ZSk7Ci8vICAgICAgICBlY2hvICc8cHJlPic7Ci8vICAgICAgICBwcmludF9yKCRuYW1lc3BhY2VzQ29udGVudCk7Ci8vICAgICAgICBlY2hvICc8L3ByZT48aHIgLz4nOwoKICAgICAgICAkd29ya2Jvb2sgPSAkeG1sLT5jaGlsZHJlbigkbmFtZXNwYWNlc0NvbnRlbnRbJ29mZmljZSddKTsKICAgICAgICBmb3JlYWNoICgkd29ya2Jvb2stPmJvZHktPnNwcmVhZHNoZWV0IGFzICR3b3JrYm9va0RhdGEpIHsKICAgICAgICAgICAgJHdvcmtib29rRGF0YSA9ICR3b3JrYm9va0RhdGEtPmNoaWxkcmVuKCRuYW1lc3BhY2VzQ29udGVudFsndGFibGUnXSk7CiAgICAgICAgICAgICR3b3Jrc2hlZXRJRCA9IDA7CiAgICAgICAgICAgIGZvcmVhY2ggKCR3b3JrYm9va0RhdGEtPnRhYmxlIGFzICR3b3Jrc2hlZXREYXRhU2V0KSB7CiAgICAgICAgICAgICAgICAkd29ya3NoZWV0RGF0YSA9ICR3b3Jrc2hlZXREYXRhU2V0LT5jaGlsZHJlbigkbmFtZXNwYWNlc0NvbnRlbnRbJ3RhYmxlJ10pOwovLyAgICAgICAgICAgICAgICBwcmludF9yKCR3b3Jrc2hlZXREYXRhKTsKLy8gICAgICAgICAgICAgICAgZWNobyAnPGJyIC8+JzsKICAgICAgICAgICAgICAgICR3b3Jrc2hlZXREYXRhQXR0cmlidXRlcyA9ICR3b3Jrc2hlZXREYXRhU2V0LT5hdHRyaWJ1dGVzKCRuYW1lc3BhY2VzQ29udGVudFsndGFibGUnXSk7Ci8vICAgICAgICAgICAgICAgIHByaW50X3IoJHdvcmtzaGVldERhdGFBdHRyaWJ1dGVzKTsKLy8gICAgICAgICAgICAgICAgZWNobyAnPGJyIC8+JzsKICAgICAgICAgICAgICAgIGlmICgoaXNzZXQoJHRoaXMtPmxvYWRTaGVldHNPbmx5KSkgJiYgKGlzc2V0KCR3b3Jrc2hlZXREYXRhQXR0cmlidXRlc1snbmFtZSddKSkgJiYKICAgICAgICAgICAgICAgICAgICAoIWluX2FycmF5KCR3b3Jrc2hlZXREYXRhQXR0cmlidXRlc1snbmFtZSddLCAkdGhpcy0+bG9hZFNoZWV0c09ubHkpKSkgewogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgfQoKLy8gICAgICAgICAgICAgICAgZWNobyAnPGgyPldvcmtzaGVldCAnLiR3b3Jrc2hlZXREYXRhQXR0cmlidXRlc1snbmFtZSddLic8L2gyPic7CiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IFdvcmtzaGVldAogICAgICAgICAgICAgICAgJG9ialBIUEV4Y2VsLT5jcmVhdGVTaGVldCgpOwogICAgICAgICAgICAgICAgJG9ialBIUEV4Y2VsLT5zZXRBY3RpdmVTaGVldEluZGV4KCR3b3Jrc2hlZXRJRCk7CiAgICAgICAgICAgICAgICBpZiAoaXNzZXQoJHdvcmtzaGVldERhdGFBdHRyaWJ1dGVzWyduYW1lJ10pKSB7CiAgICAgICAgICAgICAgICAgICAgJHdvcmtzaGVldE5hbWUgPSAoc3RyaW5nKSAkd29ya3NoZWV0RGF0YUF0dHJpYnV0ZXNbJ25hbWUnXTsKICAgICAgICAgICAgICAgICAgICAvLyAgICBVc2UgZmFsc2UgZm9yICR1cGRhdGVGb3JtdWxhQ2VsbFJlZmVyZW5jZXMgdG8gcHJldmVudCBhZGp1c3RtZW50IG9mIHdvcmtzaGVldCByZWZlcmVuY2VzIGluCiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgIGZvcm11bGEgY2VsbHMuLi4gZHVyaW5nIHRoZSBsb2FkLCBhbGwgZm9ybXVsYWUgc2hvdWxkIGJlIGNvcnJlY3QsIGFuZCB3ZSdyZSBzaW1wbHkKICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgYnJpbmdpbmcgdGhlIHdvcmtzaGVldCBuYW1lIGluIGxpbmUgd2l0aCB0aGUgZm9ybXVsYSwgbm90IHRoZSByZXZlcnNlCiAgICAgICAgICAgICAgICAgICAgJG9ialBIUEV4Y2VsLT5nZXRBY3RpdmVTaGVldCgpLT5zZXRUaXRsZSgkd29ya3NoZWV0TmFtZSwgZmFsc2UpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICRyb3dJRCA9IDE7CiAgICAgICAgICAgICAgICBmb3JlYWNoICgkd29ya3NoZWV0RGF0YSBhcyAka2V5ID0+ICRyb3dEYXRhKSB7Ci8vICAgICAgICAgICAgICAgICAgICBlY2hvICc8Yj4nLiRrZXkuJzwvYj48YnIgLz4nOwogICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoJGtleSkgewogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd0YWJsZS1oZWFkZXItcm93cyc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkcm93RGF0YSBhcyAka2V5ID0+ICRjZWxsRGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb3dEYXRhID0gJGNlbGxEYXRhOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd0YWJsZS1yb3cnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvd0RhdGFUYWJsZUF0dHJpYnV0ZXMgPSAkcm93RGF0YS0+YXR0cmlidXRlcygkbmFtZXNwYWNlc0NvbnRlbnRbJ3RhYmxlJ10pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvd1JlcGVhdHMgPSAoaXNzZXQoJHJvd0RhdGFUYWJsZUF0dHJpYnV0ZXNbJ251bWJlci1yb3dzLXJlcGVhdGVkJ10pKSA\/ICRyb3dEYXRhVGFibGVBdHRyaWJ1dGVzWydudW1iZXItcm93cy1yZXBlYXRlZCddIDogMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjb2x1bW5JRCA9ICdBJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRyb3dEYXRhIGFzICRrZXkgPT4gJGNlbGxEYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCR0aGlzLT5nZXRSZWFkRmlsdGVyKCkgIT09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEkdGhpcy0+Z2V0UmVhZEZpbHRlcigpLT5yZWFkQ2VsbCgkY29sdW1uSUQsICRyb3dJRCwgJHdvcmtzaGVldE5hbWUpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlY2hvICc8Yj4nLiRjb2x1bW5JRC4kcm93SUQuJzwvYj48YnIgLz4nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjZWxsRGF0YVRleHQgPSAoaXNzZXQoJG5hbWVzcGFjZXNDb250ZW50Wyd0ZXh0J10pKSA\/ICRjZWxsRGF0YS0+Y2hpbGRyZW4oJG5hbWVzcGFjZXNDb250ZW50Wyd0ZXh0J10pIDogJyc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNlbGxEYXRhT2ZmaWNlID0gJGNlbGxEYXRhLT5jaGlsZHJlbigkbmFtZXNwYWNlc0NvbnRlbnRbJ29mZmljZSddKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY2VsbERhdGFPZmZpY2VBdHRyaWJ1dGVzID0gJGNlbGxEYXRhLT5hdHRyaWJ1dGVzKCRuYW1lc3BhY2VzQ29udGVudFsnb2ZmaWNlJ10pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjZWxsRGF0YVRhYmxlQXR0cmlidXRlcyA9ICRjZWxsRGF0YS0+YXR0cmlidXRlcygkbmFtZXNwYWNlc0NvbnRlbnRbJ3RhYmxlJ10pOwoKLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVjaG8gJ09mZmljZSBBdHRyaWJ1dGVzOiAnOwovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnRfcigkY2VsbERhdGFPZmZpY2VBdHRyaWJ1dGVzKTsKLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVjaG8gJzxiciAvPlRhYmxlIEF0dHJpYnV0ZXM6ICc7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludF9yKCRjZWxsRGF0YVRhYmxlQXR0cmlidXRlcyk7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlY2hvICc8YnIgLz5DZWxsIERhdGEgVGV4dCc7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludF9yKCRjZWxsRGF0YVRleHQpOwovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNobyAnPGJyIC8+JzsKLy8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdHlwZSA9ICRmb3JtYXR0aW5nID0gJGh5cGVybGluayA9IG51bGw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGhhc0NhbGN1bGF0ZWRWYWx1ZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjZWxsRGF0YUZvcm11bGEgPSAnJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNzZXQoJGNlbGxEYXRhVGFibGVBdHRyaWJ1dGVzWydmb3JtdWxhJ10pKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjZWxsRGF0YUZvcm11bGEgPSAkY2VsbERhdGFUYWJsZUF0dHJpYnV0ZXNbJ2Zvcm11bGEnXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGhhc0NhbGN1bGF0ZWRWYWx1ZSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNzZXQoJGNlbGxEYXRhT2ZmaWNlLT5hbm5vdGF0aW9uKSkgewovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVjaG8gJ0NlbGwgaGFzIGNvbW1lbnQ8YnIgLz4nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYW5ub3RhdGlvblRleHQgPSAkY2VsbERhdGFPZmZpY2UtPmFubm90YXRpb24tPmNoaWxkcmVuKCRuYW1lc3BhY2VzQ29udGVudFsndGV4dCddKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRleHRBcnJheSA9IGFycmF5KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRhbm5vdGF0aW9uVGV4dCBhcyAkdCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzc2V0KCR0LT5zcGFuKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcmVhY2ggKCR0LT5zcGFuIGFzICR0ZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0ZXh0QXJyYXlbXSA9IChzdHJpbmcpJHRleHQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGV4dEFycmF5W10gPSAoc3RyaW5nKSAkdDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGV4dCA9IGltcGxvZGUoIlxuIiwgJHRleHRBcnJheSk7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNobyAkdGV4dCwgJzxiciAvPic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRvYmpQSFBFeGNlbC0+Z2V0QWN0aXZlU2hlZXQoKS0+Z2V0Q29tbWVudCgkY29sdW1uSUQuJHJvd0lEKS0+c2V0VGV4dCgkdGhpcy0+cGFyc2VSaWNoVGV4dCgkdGV4dCkpOwovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5zZXRBdXRob3IoICRhdXRob3IgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzc2V0KCRjZWxsRGF0YVRleHQtPnApKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIENvbnNvbGlkYXRlIGlmIHRoZXJlIGFyZSBtdWx0aXBsZSBwIHJlY29yZHMgKG1heWJlIHdpdGggc3BhbnMgYXMgd2VsbCkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGRhdGFBcnJheSA9IGFycmF5KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFRleHQgY2FuIGhhdmUgbXVsdGlwbGUgdGV4dDpwIGFuZCB3aXRoaW4gdGhvc2UsIG11bHRpcGxlIHRleHQ6c3Bhbi4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGV4dDpwIG5ld2xpbmVzLCBidXQgdGV4dDpzcGFuIGRvZXMgbm90LgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBbHNvLCBoZXJlIHdlIGFzc3VtZSB0aGVyZSBpcyBubyB0ZXh0IGRhdGEgaXMgc3BhbiBmaWVsZHMgYXJlIHNwZWNpZmllZCwgc2luY2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2UgaGF2ZSBubyB3YXkgb2Yga25vd2luZyBwcm9wZXIgcG9zaXRpb25pbmcgYW55d2F5LgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkY2VsbERhdGFUZXh0LT5wIGFzICRwRGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzc2V0KCRwRGF0YS0+c3BhbikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzcGFuIHNlY3Rpb25zIGRvIG5vdCBuZXdsaW5lLCBzbyB3ZSBqdXN0IGNyZWF0ZSBvbmUgbGFyZ2Ugc3RyaW5nIGhlcmUKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3BhblNlY3Rpb24gPSAiIjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkcERhdGEtPnNwYW4gYXMgJHNwYW5EYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzcGFuU2VjdGlvbiAuPSAkc3BhbkRhdGE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFycmF5X3B1c2goJGRhdGFBcnJheSwgJHNwYW5TZWN0aW9uKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXJyYXlfcHVzaCgkZGF0YUFycmF5LCAkcERhdGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhbGxDZWxsRGF0YVRleHQgPSBpbXBsb2RlKCRkYXRhQXJyYXksICJcbiIpOwoKLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlY2hvICdWYWx1ZSBUeXBlIGlzICcuJGNlbGxEYXRhT2ZmaWNlQXR0cmlidXRlc1sndmFsdWUtdHlwZSddLic8YnIgLz4nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKCRjZWxsRGF0YU9mZmljZUF0dHJpYnV0ZXNbJ3ZhbHVlLXR5cGUnXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3RyaW5nJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdHlwZSA9IFBIUEV4Y2VsX0NlbGxfRGF0YVR5cGU6OlRZUEVfU1RSSU5HOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRkYXRhVmFsdWUgPSAkYWxsQ2VsbERhdGFUZXh0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc3NldCgkZGF0YVZhbHVlLT5hKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZGF0YVZhbHVlID0gJGRhdGFWYWx1ZS0+YTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNlbGxYTGlua0F0dHJpYnV0ZXMgPSAkZGF0YVZhbHVlLT5hdHRyaWJ1dGVzKCRuYW1lc3BhY2VzQ29udGVudFsneGxpbmsnXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRoeXBlcmxpbmsgPSAkY2VsbFhMaW5rQXR0cmlidXRlc1snaHJlZiddOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2Jvb2xlYW4nOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0eXBlID0gUEhQRXhjZWxfQ2VsbF9EYXRhVHlwZTo6VFlQRV9CT09MOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRkYXRhVmFsdWUgPSAoJGFsbENlbGxEYXRhVGV4dCA9PSAnVFJVRScpID8gdHJ1ZSA6IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAncGVyY2VudGFnZSc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHR5cGUgPSBQSFBFeGNlbF9DZWxsX0RhdGFUeXBlOjpUWVBFX05VTUVSSUM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGRhdGFWYWx1ZSA9IChmbG9hdCkgJGNlbGxEYXRhT2ZmaWNlQXR0cmlidXRlc1sndmFsdWUnXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmxvb3IoJGRhdGFWYWx1ZSkgPT0gJGRhdGFWYWx1ZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZGF0YVZhbHVlID0gKGludGVnZXIpICRkYXRhVmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRmb3JtYXR0aW5nID0gUEhQRXhjZWxfU3R5bGVfTnVtYmVyRm9ybWF0OjpGT1JNQVRfUEVSQ0VOVEFHRV8wMDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2N1cnJlbmN5JzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdHlwZSA9IFBIUEV4Y2VsX0NlbGxfRGF0YVR5cGU6OlRZUEVfTlVNRVJJQzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZGF0YVZhbHVlID0gKGZsb2F0KSAkY2VsbERhdGFPZmZpY2VBdHRyaWJ1dGVzWyd2YWx1ZSddOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmbG9vcigkZGF0YVZhbHVlKSA9PSAkZGF0YVZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRkYXRhVmFsdWUgPSAoaW50ZWdlcikgJGRhdGFWYWx1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGZvcm1hdHRpbmcgPSBQSFBFeGNlbF9TdHlsZV9OdW1iZXJGb3JtYXQ6OkZPUk1BVF9DVVJSRU5DWV9VU0RfU0lNUExFOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZmxvYXQnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0eXBlID0gUEhQRXhjZWxfQ2VsbF9EYXRhVHlwZTo6VFlQRV9OVU1FUklDOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRkYXRhVmFsdWUgPSAoZmxvYXQpICRjZWxsRGF0YU9mZmljZUF0dHJpYnV0ZXNbJ3ZhbHVlJ107CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZsb29yKCRkYXRhVmFsdWUpID09ICRkYXRhVmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRkYXRhVmFsdWUgPT0gKGludGVnZXIpICRkYXRhVmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRkYXRhVmFsdWUgPSAoaW50ZWdlcikgJGRhdGFWYWx1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRkYXRhVmFsdWUgPSAoZmxvYXQpICRkYXRhVmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdkYXRlJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdHlwZSA9IFBIUEV4Y2VsX0NlbGxfRGF0YVR5cGU6OlRZUEVfTlVNRVJJQzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZGF0ZU9iaiA9IG5ldyBEYXRlVGltZSgkY2VsbERhdGFPZmZpY2VBdHRyaWJ1dGVzWydkYXRlLXZhbHVlJ10sICRHTVQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRkYXRlT2JqLT5zZXRUaW1lWm9uZSgkdGltZXpvbmVPYmopOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpc3QoJHllYXIsICRtb250aCwgJGRheSwgJGhvdXIsICRtaW51dGUsICRzZWNvbmQpID0gZXhwbG9kZSgnICcsICRkYXRlT2JqLT5mb3JtYXQoJ1kgbSBkIEggaSBzJykpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRkYXRhVmFsdWUgPSBQSFBFeGNlbF9TaGFyZWRfRGF0ZTo6Rm9ybWF0dGVkUEhQVG9FeGNlbCgkeWVhciwgJG1vbnRoLCAkZGF5LCAkaG91ciwgJG1pbnV0ZSwgJHNlY29uZCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRkYXRhVmFsdWUgIT0gZmxvb3IoJGRhdGFWYWx1ZSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGZvcm1hdHRpbmcgPSBQSFBFeGNlbF9TdHlsZV9OdW1iZXJGb3JtYXQ6OkZPUk1BVF9EQVRFX1hMU1gxNS4nICcuUEhQRXhjZWxfU3R5bGVfTnVtYmVyRm9ybWF0OjpGT1JNQVRfREFURV9USU1FNDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZm9ybWF0dGluZyA9IFBIUEV4Y2VsX1N0eWxlX051bWJlckZvcm1hdDo6Rk9STUFUX0RBVEVfWExTWDE1OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3RpbWUnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0eXBlID0gUEhQRXhjZWxfQ2VsbF9EYXRhVHlwZTo6VFlQRV9OVU1FUklDOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRkYXRhVmFsdWUgPSBQSFBFeGNlbF9TaGFyZWRfRGF0ZTo6UEhQVG9FeGNlbChzdHJ0b3RpbWUoJzAxLTAxLTE5NzAgJy5pbXBsb2RlKCc6Jywgc3NjYW5mKCRjZWxsRGF0YU9mZmljZUF0dHJpYnV0ZXNbJ3RpbWUtdmFsdWUnXSwgJ1BUJWRIJWRNJWRTJykpKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGZvcm1hdHRpbmcgPSBQSFBFeGNlbF9TdHlsZV9OdW1iZXJGb3JtYXQ6OkZPUk1BVF9EQVRFX1RJTUU0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNobyAnRGF0YSB2YWx1ZSBpcyAnLiRkYXRhVmFsdWUuJzxiciAvPic7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRoeXBlcmxpbmsgIT09IG51bGwpIHsKLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNobyAnSHlwZXJsaW5rIGlzICcuJGh5cGVybGluay4nPGJyIC8+JzsKLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHR5cGUgPSBQSFBFeGNlbF9DZWxsX0RhdGFUeXBlOjpUWVBFX05VTEw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRkYXRhVmFsdWUgPSBudWxsOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRoYXNDYWxjdWxhdGVkVmFsdWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHR5cGUgPSBQSFBFeGNlbF9DZWxsX0RhdGFUeXBlOjpUWVBFX0ZPUk1VTEE7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNobyAnRm9ybXVsYTogJywgJGNlbGxEYXRhRm9ybXVsYSwgUEhQX0VPTDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNlbGxEYXRhRm9ybXVsYSA9IHN1YnN0cigkY2VsbERhdGFGb3JtdWxhLCBzdHJwb3MoJGNlbGxEYXRhRm9ybXVsYSwgJzo9JykrMSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0ZW1wID0gZXhwbG9kZSgnIicsICRjZWxsRGF0YUZvcm11bGEpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdEtleSA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkdGVtcCBhcyAmJHZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICBPbmx5IHJlcGxhY2UgaW4gYWx0ZXJuYXRlIGFycmF5IGVudHJpZXMgKGkuZS4gbm9uLXF1b3RlZCBibG9ja3MpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHRLZXkgPSAhJHRLZXkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdmFsdWUgPSBwcmVnX3JlcGxhY2UoJy9cWyhbXlwuXSspXC4oW15cLl0rKTpcLihbXlwuXSspXF0vVWknLCAnJDEhJDI6JDMnLCAkdmFsdWUpOyAgICAvLyAgQ2VsbCByYW5nZSByZWZlcmVuY2UgaW4gYW5vdGhlciBzaGVldAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR2YWx1ZSA9IHByZWdfcmVwbGFjZSgnL1xbKFteXC5dKylcLihbXlwuXSspXF0vVWknLCAnJDEhJDInLCAkdmFsdWUpOyAgICAgICAvLyAgQ2VsbCByZWZlcmVuY2UgaW4gYW5vdGhlciBzaGVldAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR2YWx1ZSA9IHByZWdfcmVwbGFjZSgnL1xbXC4oW15cLl0rKTpcLihbXlwuXSspXF0vVWknLCAnJDE6JDInLCAkdmFsdWUpOyAgICAvLyAgQ2VsbCByYW5nZSByZWZlcmVuY2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdmFsdWUgPSBwcmVnX3JlcGxhY2UoJy9cW1wuKFteXC5dKylcXS9VaScsICckMScsICR2YWx1ZSk7ICAgICAgICAgICAgICAgICAgLy8gIFNpbXBsZSBjZWxsIHJlZmVyZW5jZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR2YWx1ZSA9IFBIUEV4Y2VsX0NhbGN1bGF0aW9uOjp0cmFuc2xhdGVTZXBhcmF0b3IoJzsnLCAnLCcsICR2YWx1ZSwgJGluQnJhY2VzKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB1bnNldCgkdmFsdWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgICBUaGVuIHJlYnVpbGQgdGhlIGZvcm11bGEgc3RyaW5nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjZWxsRGF0YUZvcm11bGEgPSBpbXBsb2RlKCciJywgJHRlbXApOwovLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVjaG8gJ0FkanVzdGVkIEZvcm11bGE6ICcsICRjZWxsRGF0YUZvcm11bGEsIFBIUF9FT0w7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY29sUmVwZWF0cyA9IChpc3NldCgkY2VsbERhdGFUYWJsZUF0dHJpYnV0ZXNbJ251bWJlci1jb2x1bW5zLXJlcGVhdGVkJ10pKSA\/ICRjZWxsRGF0YVRhYmxlQXR0cmlidXRlc1snbnVtYmVyLWNvbHVtbnMtcmVwZWF0ZWQnXSA6IDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCR0eXBlICE9PSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoJGkgPSAwOyAkaSA8ICRjb2xSZXBlYXRzOyArKyRpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJGkgPiAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyskY29sdW1uSUQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHR5cGUgIT09IFBIUEV4Y2VsX0NlbGxfRGF0YVR5cGU6OlRZUEVfTlVMTCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoJHJvd0FkanVzdCA9IDA7ICRyb3dBZGp1c3QgPCAkcm93UmVwZWF0czsgKyskcm93QWRqdXN0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRySUQgPSAkcm93SUQgKyAkcm93QWRqdXN0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkb2JqUEhQRXhjZWwtPmdldEFjdGl2ZVNoZWV0KCktPmdldENlbGwoJGNvbHVtbklELiRySUQpLT5zZXRWYWx1ZUV4cGxpY2l0KCgoJGhhc0NhbGN1bGF0ZWRWYWx1ZSkgPyAkY2VsbERhdGFGb3JtdWxhIDogJGRhdGFWYWx1ZSksICR0eXBlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRoYXNDYWxjdWxhdGVkVmFsdWUpIHsKLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWNobyAnRm9ydW1sYSByZXN1bHQgaXMgJy4kZGF0YVZhbHVlLic8YnIgLz4nOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG9ialBIUEV4Y2VsLT5nZXRBY3RpdmVTaGVldCgpLT5nZXRDZWxsKCRjb2x1bW5JRC4kcklEKS0+c2V0Q2FsY3VsYXRlZFZhbHVlKCRkYXRhVmFsdWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkZm9ybWF0dGluZyAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG9ialBIUEV4Y2VsLT5nZXRBY3RpdmVTaGVldCgpLT5nZXRTdHlsZSgkY29sdW1uSUQuJHJJRCktPmdldE51bWJlckZvcm1hdCgpLT5zZXRGb3JtYXRDb2RlKCRmb3JtYXR0aW5nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRvYmpQSFBFeGNlbC0+Z2V0QWN0aXZlU2hlZXQoKS0+Z2V0U3R5bGUoJGNvbHVtbklELiRySUQpLT5nZXROdW1iZXJGb3JtYXQoKS0+c2V0Rm9ybWF0Q29kZShQSFBFeGNlbF9TdHlsZV9OdW1iZXJGb3JtYXQ6OkZPUk1BVF9HRU5FUkFMKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJGh5cGVybGluayAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG9ialBIUEV4Y2VsLT5nZXRBY3RpdmVTaGVldCgpLT5nZXRDZWxsKCRjb2x1bW5JRC4kcklEKS0+Z2V0SHlwZXJsaW5rKCktPnNldFVybCgkaHlwZXJsaW5rKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gICAgTWVyZ2VkIGNlbGxzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKChpc3NldCgkY2VsbERhdGFUYWJsZUF0dHJpYnV0ZXNbJ251bWJlci1jb2x1bW5zLXNwYW5uZWQnXSkpIHx8IChpc3NldCgkY2VsbERhdGFUYWJsZUF0dHJpYnV0ZXNbJ251bWJlci1yb3dzLXNwYW5uZWQnXSkpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoJHR5cGUgIT09IFBIUEV4Y2VsX0NlbGxfRGF0YVR5cGU6OlRZUEVfTlVMTCkgfHwgKCEkdGhpcy0+cmVhZERhdGFPbmx5KSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNvbHVtblRvID0gJGNvbHVtbklEOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzc2V0KCRjZWxsRGF0YVRhYmxlQXR0cmlidXRlc1snbnVtYmVyLWNvbHVtbnMtc3Bhbm5lZCddKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjb2x1bW5UbyA9IFBIUEV4Y2VsX0NlbGw6OnN0cmluZ0Zyb21Db2x1bW5JbmRleChQSFBFeGNlbF9DZWxsOjpjb2x1bW5JbmRleEZyb21TdHJpbmcoJGNvbHVtbklEKSArICRjZWxsRGF0YVRhYmxlQXR0cmlidXRlc1snbnVtYmVyLWNvbHVtbnMtc3Bhbm5lZCddIC0yKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRyb3dUbyA9ICRyb3dJRDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc3NldCgkY2VsbERhdGFUYWJsZUF0dHJpYnV0ZXNbJ251bWJlci1yb3dzLXNwYW5uZWQnXSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm93VG8gPSAkcm93VG8gKyAkY2VsbERhdGFUYWJsZUF0dHJpYnV0ZXNbJ251bWJlci1yb3dzLXNwYW5uZWQnXSAtIDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY2VsbFJhbmdlID0gJGNvbHVtbklELiRyb3dJRC4nOicuJGNvbHVtblRvLiRyb3dUbzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRvYmpQSFBFeGNlbC0+Z2V0QWN0aXZlU2hlZXQoKS0+bWVyZ2VDZWxscygkY2VsbFJhbmdlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKyskY29sdW1uSUQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkcm93SUQgKz0gJHJvd1JlcGVhdHM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICArKyR3b3Jrc2hlZXRJRDsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgLy8gUmV0dXJuCiAgICAgICAgcmV0dXJuICRvYmpQSFBFeGNlbDsKICAgIH0KCiAgICBwcml2YXRlIGZ1bmN0aW9uIHBhcnNlUmljaFRleHQoJGlzID0gJycpCiAgICB7CiAgICAgICAgJHZhbHVlID0gbmV3IFBIUEV4Y2VsX1JpY2hUZXh0KCk7CgogICAgICAgICR2YWx1ZS0+Y3JlYXRlVGV4dCgkaXMpOwoKICAgICAgICByZXR1cm4gJHZhbHVlOwogICAgfQp9Cg==",
    "size": "37096"
}