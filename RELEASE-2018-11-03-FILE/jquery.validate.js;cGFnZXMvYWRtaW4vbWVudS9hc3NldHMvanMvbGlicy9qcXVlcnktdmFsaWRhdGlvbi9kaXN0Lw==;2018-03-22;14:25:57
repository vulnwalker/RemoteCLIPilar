{
    "namaFile": "pages\/admin\/menu\/assets\/js\/libs\/jquery-validation\/dist\/jquery.validate.js",
    "lastUpdate": "2018-03-22+14:25:57.39",
    "contentFile": "LyohCiAqIGpRdWVyeSBWYWxpZGF0aW9uIFBsdWdpbiB2MS4xMy4xCiAqCiAqIGh0dHA6Ly9qcXVlcnl2YWxpZGF0aW9uLm9yZy8KICoKICogQ29weXJpZ2h0IChjKSAyMDE0IErDtnJuIFphZWZmZXJlcgogKiBSZWxlYXNlZCB1bmRlciB0aGUgTUlUIGxpY2Vuc2UKICovCihmdW5jdGlvbiggZmFjdG9yeSApIHsKCWlmICggdHlwZW9mIGRlZmluZSA9PT0gImZ1bmN0aW9uIiAmJiBkZWZpbmUuYW1kICkgewoJCWRlZmluZSggWyJqcXVlcnkiXSwgZmFjdG9yeSApOwoJfSBlbHNlIHsKCQlmYWN0b3J5KCBqUXVlcnkgKTsKCX0KfShmdW5jdGlvbiggJCApIHsKCiQuZXh0ZW5kKCQuZm4sIHsKCS8vIGh0dHA6Ly9qcXVlcnl2YWxpZGF0aW9uLm9yZy92YWxpZGF0ZS8KCXZhbGlkYXRlOiBmdW5jdGlvbiggb3B0aW9ucyApIHsKCgkJLy8gaWYgbm90aGluZyBpcyBzZWxlY3RlZCwgcmV0dXJuIG5vdGhpbmc7IGNhbid0IGNoYWluIGFueXdheQoJCWlmICggIXRoaXMubGVuZ3RoICkgewoJCQlpZiAoIG9wdGlvbnMgJiYgb3B0aW9ucy5kZWJ1ZyAmJiB3aW5kb3cuY29uc29sZSApIHsKCQkJCWNvbnNvbGUud2FybiggIk5vdGhpbmcgc2VsZWN0ZWQsIGNhbid0IHZhbGlkYXRlLCByZXR1cm5pbmcgbm90aGluZy4iICk7CgkJCX0KCQkJcmV0dXJuOwoJCX0KCgkJLy8gY2hlY2sgaWYgYSB2YWxpZGF0b3IgZm9yIHRoaXMgZm9ybSB3YXMgYWxyZWFkeSBjcmVhdGVkCgkJdmFyIHZhbGlkYXRvciA9ICQuZGF0YSggdGhpc1sgMCBdLCAidmFsaWRhdG9yIiApOwoJCWlmICggdmFsaWRhdG9yICkgewoJCQlyZXR1cm4gdmFsaWRhdG9yOwoJCX0KCgkJLy8gQWRkIG5vdmFsaWRhdGUgdGFnIGlmIEhUTUw1LgoJCXRoaXMuYXR0ciggIm5vdmFsaWRhdGUiLCAibm92YWxpZGF0ZSIgKTsKCgkJdmFsaWRhdG9yID0gbmV3ICQudmFsaWRhdG9yKCBvcHRpb25zLCB0aGlzWyAwIF0gKTsKCQkkLmRhdGEoIHRoaXNbIDAgXSwgInZhbGlkYXRvciIsIHZhbGlkYXRvciApOwoKCQlpZiAoIHZhbGlkYXRvci5zZXR0aW5ncy5vbnN1Ym1pdCApIHsKCgkJCXRoaXMudmFsaWRhdGVEZWxlZ2F0ZSggIjpzdWJtaXQiLCAiY2xpY2siLCBmdW5jdGlvbiggZXZlbnQgKSB7CgkJCQlpZiAoIHZhbGlkYXRvci5zZXR0aW5ncy5zdWJtaXRIYW5kbGVyICkgewoJCQkJCXZhbGlkYXRvci5zdWJtaXRCdXR0b24gPSBldmVudC50YXJnZXQ7CgkJCQl9CgkJCQkvLyBhbGxvdyBzdXBwcmVzc2luZyB2YWxpZGF0aW9uIGJ5IGFkZGluZyBhIGNhbmNlbCBjbGFzcyB0byB0aGUgc3VibWl0IGJ1dHRvbgoJCQkJaWYgKCAkKCBldmVudC50YXJnZXQgKS5oYXNDbGFzcyggImNhbmNlbCIgKSApIHsKCQkJCQl2YWxpZGF0b3IuY2FuY2VsU3VibWl0ID0gdHJ1ZTsKCQkJCX0KCgkJCQkvLyBhbGxvdyBzdXBwcmVzc2luZyB2YWxpZGF0aW9uIGJ5IGFkZGluZyB0aGUgaHRtbDUgZm9ybW5vdmFsaWRhdGUgYXR0cmlidXRlIHRvIHRoZSBzdWJtaXQgYnV0dG9uCgkJCQlpZiAoICQoIGV2ZW50LnRhcmdldCApLmF0dHIoICJmb3Jtbm92YWxpZGF0ZSIgKSAhPT0gdW5kZWZpbmVkICkgewoJCQkJCXZhbGlkYXRvci5jYW5jZWxTdWJtaXQgPSB0cnVlOwoJCQkJfQoJCQl9KTsKCgkJCS8vIHZhbGlkYXRlIHRoZSBmb3JtIG9uIHN1Ym1pdAoJCQl0aGlzLnN1Ym1pdCggZnVuY3Rpb24oIGV2ZW50ICkgewoJCQkJaWYgKCB2YWxpZGF0b3Iuc2V0dGluZ3MuZGVidWcgKSB7CgkJCQkJLy8gcHJldmVudCBmb3JtIHN1Ym1pdCB0byBiZSBhYmxlIHRvIHNlZSBjb25zb2xlIG91dHB1dAoJCQkJCWV2ZW50LnByZXZlbnREZWZhdWx0KCk7CgkJCQl9CgkJCQlmdW5jdGlvbiBoYW5kbGUoKSB7CgkJCQkJdmFyIGhpZGRlbiwgcmVzdWx0OwoJCQkJCWlmICggdmFsaWRhdG9yLnNldHRpbmdzLnN1Ym1pdEhhbmRsZXIgKSB7CgkJCQkJCWlmICggdmFsaWRhdG9yLnN1Ym1pdEJ1dHRvbiApIHsKCQkJCQkJCS8vIGluc2VydCBhIGhpZGRlbiBpbnB1dCBhcyBhIHJlcGxhY2VtZW50IGZvciB0aGUgbWlzc2luZyBzdWJtaXQgYnV0dG9uCgkJCQkJCQloaWRkZW4gPSAkKCAiPGlucHV0IHR5cGU9J2hpZGRlbicvPiIgKQoJCQkJCQkJCS5hdHRyKCAibmFtZSIsIHZhbGlkYXRvci5zdWJtaXRCdXR0b24ubmFtZSApCgkJCQkJCQkJLnZhbCggJCggdmFsaWRhdG9yLnN1Ym1pdEJ1dHRvbiApLnZhbCgpICkKCQkJCQkJCQkuYXBwZW5kVG8oIHZhbGlkYXRvci5jdXJyZW50Rm9ybSApOwoJCQkJCQl9CgkJCQkJCXJlc3VsdCA9IHZhbGlkYXRvci5zZXR0aW5ncy5zdWJtaXRIYW5kbGVyLmNhbGwoIHZhbGlkYXRvciwgdmFsaWRhdG9yLmN1cnJlbnRGb3JtLCBldmVudCApOwoJCQkJCQlpZiAoIHZhbGlkYXRvci5zdWJtaXRCdXR0b24gKSB7CgkJCQkJCQkvLyBhbmQgY2xlYW4gdXAgYWZ0ZXJ3YXJkczsgdGhhbmtzIHRvIG5vLWJsb2NrLXNjb3BlLCBoaWRkZW4gY2FuIGJlIHJlZmVyZW5jZWQKCQkJCQkJCWhpZGRlbi5yZW1vdmUoKTsKCQkJCQkJfQoJCQkJCQlpZiAoIHJlc3VsdCAhPT0gdW5kZWZpbmVkICkgewoJCQkJCQkJcmV0dXJuIHJlc3VsdDsKCQkJCQkJfQoJCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQkJfQoJCQkJCXJldHVybiB0cnVlOwoJCQkJfQoKCQkJCS8vIHByZXZlbnQgc3VibWl0IGZvciBpbnZhbGlkIGZvcm1zIG9yIGN1c3RvbSBzdWJtaXQgaGFuZGxlcnMKCQkJCWlmICggdmFsaWRhdG9yLmNhbmNlbFN1Ym1pdCApIHsKCQkJCQl2YWxpZGF0b3IuY2FuY2VsU3VibWl0ID0gZmFsc2U7CgkJCQkJcmV0dXJuIGhhbmRsZSgpOwoJCQkJfQoJCQkJaWYgKCB2YWxpZGF0b3IuZm9ybSgpICkgewoJCQkJCWlmICggdmFsaWRhdG9yLnBlbmRpbmdSZXF1ZXN0ICkgewoJCQkJCQl2YWxpZGF0b3IuZm9ybVN1Ym1pdHRlZCA9IHRydWU7CgkJCQkJCXJldHVybiBmYWxzZTsKCQkJCQl9CgkJCQkJcmV0dXJuIGhhbmRsZSgpOwoJCQkJfSBlbHNlIHsKCQkJCQl2YWxpZGF0b3IuZm9jdXNJbnZhbGlkKCk7CgkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJfQoJCQl9KTsKCQl9CgoJCXJldHVybiB2YWxpZGF0b3I7Cgl9LAoJLy8gaHR0cDovL2pxdWVyeXZhbGlkYXRpb24ub3JnL3ZhbGlkLwoJdmFsaWQ6IGZ1bmN0aW9uKCkgewoJCXZhciB2YWxpZCwgdmFsaWRhdG9yOwoKCQlpZiAoICQoIHRoaXNbIDAgXSApLmlzKCAiZm9ybSIgKSApIHsKCQkJdmFsaWQgPSB0aGlzLnZhbGlkYXRlKCkuZm9ybSgpOwoJCX0gZWxzZSB7CgkJCXZhbGlkID0gdHJ1ZTsKCQkJdmFsaWRhdG9yID0gJCggdGhpc1sgMCBdLmZvcm0gKS52YWxpZGF0ZSgpOwoJCQl0aGlzLmVhY2goIGZ1bmN0aW9uKCkgewoJCQkJdmFsaWQgPSB2YWxpZGF0b3IuZWxlbWVudCggdGhpcyApICYmIHZhbGlkOwoJCQl9KTsKCQl9CgkJcmV0dXJuIHZhbGlkOwoJfSwKCS8vIGF0dHJpYnV0ZXM6IHNwYWNlIHNlcGFyYXRlZCBsaXN0IG9mIGF0dHJpYnV0ZXMgdG8gcmV0cmlldmUgYW5kIHJlbW92ZQoJcmVtb3ZlQXR0cnM6IGZ1bmN0aW9uKCBhdHRyaWJ1dGVzICkgewoJCXZhciByZXN1bHQgPSB7fSwKCQkJJGVsZW1lbnQgPSB0aGlzOwoJCSQuZWFjaCggYXR0cmlidXRlcy5zcGxpdCggL1xzLyApLCBmdW5jdGlvbiggaW5kZXgsIHZhbHVlICkgewoJCQlyZXN1bHRbIHZhbHVlIF0gPSAkZWxlbWVudC5hdHRyKCB2YWx1ZSApOwoJCQkkZWxlbWVudC5yZW1vdmVBdHRyKCB2YWx1ZSApOwoJCX0pOwoJCXJldHVybiByZXN1bHQ7Cgl9LAoJLy8gaHR0cDovL2pxdWVyeXZhbGlkYXRpb24ub3JnL3J1bGVzLwoJcnVsZXM6IGZ1bmN0aW9uKCBjb21tYW5kLCBhcmd1bWVudCApIHsKCQl2YXIgZWxlbWVudCA9IHRoaXNbIDAgXSwKCQkJc2V0dGluZ3MsIHN0YXRpY1J1bGVzLCBleGlzdGluZ1J1bGVzLCBkYXRhLCBwYXJhbSwgZmlsdGVyZWQ7CgoJCWlmICggY29tbWFuZCApIHsKCQkJc2V0dGluZ3MgPSAkLmRhdGEoIGVsZW1lbnQuZm9ybSwgInZhbGlkYXRvciIgKS5zZXR0aW5nczsKCQkJc3RhdGljUnVsZXMgPSBzZXR0aW5ncy5ydWxlczsKCQkJZXhpc3RpbmdSdWxlcyA9ICQudmFsaWRhdG9yLnN0YXRpY1J1bGVzKCBlbGVtZW50ICk7CgkJCXN3aXRjaCAoIGNvbW1hbmQgKSB7CgkJCWNhc2UgImFkZCI6CgkJCQkkLmV4dGVuZCggZXhpc3RpbmdSdWxlcywgJC52YWxpZGF0b3Iubm9ybWFsaXplUnVsZSggYXJndW1lbnQgKSApOwoJCQkJLy8gcmVtb3ZlIG1lc3NhZ2VzIGZyb20gcnVsZXMsIGJ1dCBhbGxvdyB0aGVtIHRvIGJlIHNldCBzZXBhcmF0ZWx5CgkJCQlkZWxldGUgZXhpc3RpbmdSdWxlcy5tZXNzYWdlczsKCQkJCXN0YXRpY1J1bGVzWyBlbGVtZW50Lm5hbWUgXSA9IGV4aXN0aW5nUnVsZXM7CgkJCQlpZiAoIGFyZ3VtZW50Lm1lc3NhZ2VzICkgewoJCQkJCXNldHRpbmdzLm1lc3NhZ2VzWyBlbGVtZW50Lm5hbWUgXSA9ICQuZXh0ZW5kKCBzZXR0aW5ncy5tZXNzYWdlc1sgZWxlbWVudC5uYW1lIF0sIGFyZ3VtZW50Lm1lc3NhZ2VzICk7CgkJCQl9CgkJCQlicmVhazsKCQkJY2FzZSAicmVtb3ZlIjoKCQkJCWlmICggIWFyZ3VtZW50ICkgewoJCQkJCWRlbGV0ZSBzdGF0aWNSdWxlc1sgZWxlbWVudC5uYW1lIF07CgkJCQkJcmV0dXJuIGV4aXN0aW5nUnVsZXM7CgkJCQl9CgkJCQlmaWx0ZXJlZCA9IHt9OwoJCQkJJC5lYWNoKCBhcmd1bWVudC5zcGxpdCggL1xzLyApLCBmdW5jdGlvbiggaW5kZXgsIG1ldGhvZCApIHsKCQkJCQlmaWx0ZXJlZFsgbWV0aG9kIF0gPSBleGlzdGluZ1J1bGVzWyBtZXRob2QgXTsKCQkJCQlkZWxldGUgZXhpc3RpbmdSdWxlc1sgbWV0aG9kIF07CgkJCQkJaWYgKCBtZXRob2QgPT09ICJyZXF1aXJlZCIgKSB7CgkJCQkJCSQoIGVsZW1lbnQgKS5yZW1vdmVBdHRyKCAiYXJpYS1yZXF1aXJlZCIgKTsKCQkJCQl9CgkJCQl9KTsKCQkJCXJldHVybiBmaWx0ZXJlZDsKCQkJfQoJCX0KCgkJZGF0YSA9ICQudmFsaWRhdG9yLm5vcm1hbGl6ZVJ1bGVzKAoJCSQuZXh0ZW5kKAoJCQl7fSwKCQkJJC52YWxpZGF0b3IuY2xhc3NSdWxlcyggZWxlbWVudCApLAoJCQkkLnZhbGlkYXRvci5hdHRyaWJ1dGVSdWxlcyggZWxlbWVudCApLAoJCQkkLnZhbGlkYXRvci5kYXRhUnVsZXMoIGVsZW1lbnQgKSwKCQkJJC52YWxpZGF0b3Iuc3RhdGljUnVsZXMoIGVsZW1lbnQgKQoJCSksIGVsZW1lbnQgKTsKCgkJLy8gbWFrZSBzdXJlIHJlcXVpcmVkIGlzIGF0IGZyb250CgkJaWYgKCBkYXRhLnJlcXVpcmVkICkgewoJCQlwYXJhbSA9IGRhdGEucmVxdWlyZWQ7CgkJCWRlbGV0ZSBkYXRhLnJlcXVpcmVkOwoJCQlkYXRhID0gJC5leHRlbmQoIHsgcmVxdWlyZWQ6IHBhcmFtIH0sIGRhdGEgKTsKCQkJJCggZWxlbWVudCApLmF0dHIoICJhcmlhLXJlcXVpcmVkIiwgInRydWUiICk7CgkJfQoKCQkvLyBtYWtlIHN1cmUgcmVtb3RlIGlzIGF0IGJhY2sKCQlpZiAoIGRhdGEucmVtb3RlICkgewoJCQlwYXJhbSA9IGRhdGEucmVtb3RlOwoJCQlkZWxldGUgZGF0YS5yZW1vdGU7CgkJCWRhdGEgPSAkLmV4dGVuZCggZGF0YSwgeyByZW1vdGU6IHBhcmFtIH0pOwoJCX0KCgkJcmV0dXJuIGRhdGE7Cgl9Cn0pOwoKLy8gQ3VzdG9tIHNlbGVjdG9ycwokLmV4dGVuZCggJC5leHByWyAiOiIgXSwgewoJLy8gaHR0cDovL2pxdWVyeXZhbGlkYXRpb24ub3JnL2JsYW5rLXNlbGVjdG9yLwoJYmxhbms6IGZ1bmN0aW9uKCBhICkgewoJCXJldHVybiAhJC50cmltKCAiIiArICQoIGEgKS52YWwoKSApOwoJfSwKCS8vIGh0dHA6Ly9qcXVlcnl2YWxpZGF0aW9uLm9yZy9maWxsZWQtc2VsZWN0b3IvCglmaWxsZWQ6IGZ1bmN0aW9uKCBhICkgewoJCXJldHVybiAhISQudHJpbSggIiIgKyAkKCBhICkudmFsKCkgKTsKCX0sCgkvLyBodHRwOi8vanF1ZXJ5dmFsaWRhdGlvbi5vcmcvdW5jaGVja2VkLXNlbGVjdG9yLwoJdW5jaGVja2VkOiBmdW5jdGlvbiggYSApIHsKCQlyZXR1cm4gISQoIGEgKS5wcm9wKCAiY2hlY2tlZCIgKTsKCX0KfSk7CgovLyBjb25zdHJ1Y3RvciBmb3IgdmFsaWRhdG9yCiQudmFsaWRhdG9yID0gZnVuY3Rpb24oIG9wdGlvbnMsIGZvcm0gKSB7Cgl0aGlzLnNldHRpbmdzID0gJC5leHRlbmQoIHRydWUsIHt9LCAkLnZhbGlkYXRvci5kZWZhdWx0cywgb3B0aW9ucyApOwoJdGhpcy5jdXJyZW50Rm9ybSA9IGZvcm07Cgl0aGlzLmluaXQoKTsKfTsKCi8vIGh0dHA6Ly9qcXVlcnl2YWxpZGF0aW9uLm9yZy9qUXVlcnkudmFsaWRhdG9yLmZvcm1hdC8KJC52YWxpZGF0b3IuZm9ybWF0ID0gZnVuY3Rpb24oIHNvdXJjZSwgcGFyYW1zICkgewoJaWYgKCBhcmd1bWVudHMubGVuZ3RoID09PSAxICkgewoJCXJldHVybiBmdW5jdGlvbigpIHsKCQkJdmFyIGFyZ3MgPSAkLm1ha2VBcnJheSggYXJndW1lbnRzICk7CgkJCWFyZ3MudW5zaGlmdCggc291cmNlICk7CgkJCXJldHVybiAkLnZhbGlkYXRvci5mb3JtYXQuYXBwbHkoIHRoaXMsIGFyZ3MgKTsKCQl9OwoJfQoJaWYgKCBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBwYXJhbXMuY29uc3RydWN0b3IgIT09IEFycmF5ICApIHsKCQlwYXJhbXMgPSAkLm1ha2VBcnJheSggYXJndW1lbnRzICkuc2xpY2UoIDEgKTsKCX0KCWlmICggcGFyYW1zLmNvbnN0cnVjdG9yICE9PSBBcnJheSApIHsKCQlwYXJhbXMgPSBbIHBhcmFtcyBdOwoJfQoJJC5lYWNoKCBwYXJhbXMsIGZ1bmN0aW9uKCBpLCBuICkgewoJCXNvdXJjZSA9IHNvdXJjZS5yZXBsYWNlKCBuZXcgUmVnRXhwKCAiXFx7IiArIGkgKyAiXFx9IiwgImciICksIGZ1bmN0aW9uKCkgewoJCQlyZXR1cm4gbjsKCQl9KTsKCX0pOwoJcmV0dXJuIHNvdXJjZTsKfTsKCiQuZXh0ZW5kKCAkLnZhbGlkYXRvciwgewoKCWRlZmF1bHRzOiB7CgkJbWVzc2FnZXM6IHt9LAoJCWdyb3Vwczoge30sCgkJcnVsZXM6IHt9LAoJCWVycm9yQ2xhc3M6ICJlcnJvciIsCgkJdmFsaWRDbGFzczogInZhbGlkIiwKCQllcnJvckVsZW1lbnQ6ICJsYWJlbCIsCgkJZm9jdXNDbGVhbnVwOiBmYWxzZSwKCQlmb2N1c0ludmFsaWQ6IHRydWUsCgkJZXJyb3JDb250YWluZXI6ICQoIFtdICksCgkJZXJyb3JMYWJlbENvbnRhaW5lcjogJCggW10gKSwKCQlvbnN1Ym1pdDogdHJ1ZSwKCQlpZ25vcmU6ICI6aGlkZGVuIiwKCQlpZ25vcmVUaXRsZTogZmFsc2UsCgkJb25mb2N1c2luOiBmdW5jdGlvbiggZWxlbWVudCApIHsKCQkJdGhpcy5sYXN0QWN0aXZlID0gZWxlbWVudDsKCgkJCS8vIEhpZGUgZXJyb3IgbGFiZWwgYW5kIHJlbW92ZSBlcnJvciBjbGFzcyBvbiBmb2N1cyBpZiBlbmFibGVkCgkJCWlmICggdGhpcy5zZXR0aW5ncy5mb2N1c0NsZWFudXAgKSB7CgkJCQlpZiAoIHRoaXMuc2V0dGluZ3MudW5oaWdobGlnaHQgKSB7CgkJCQkJdGhpcy5zZXR0aW5ncy51bmhpZ2hsaWdodC5jYWxsKCB0aGlzLCBlbGVtZW50LCB0aGlzLnNldHRpbmdzLmVycm9yQ2xhc3MsIHRoaXMuc2V0dGluZ3MudmFsaWRDbGFzcyApOwoJCQkJfQoJCQkJdGhpcy5oaWRlVGhlc2UoIHRoaXMuZXJyb3JzRm9yKCBlbGVtZW50ICkgKTsKCQkJfQoJCX0sCgkJb25mb2N1c291dDogZnVuY3Rpb24oIGVsZW1lbnQgKSB7CgkJCWlmICggIXRoaXMuY2hlY2thYmxlKCBlbGVtZW50ICkgJiYgKCBlbGVtZW50Lm5hbWUgaW4gdGhpcy5zdWJtaXR0ZWQgfHwgIXRoaXMub3B0aW9uYWwoIGVsZW1lbnQgKSApICkgewoJCQkJdGhpcy5lbGVtZW50KCBlbGVtZW50ICk7CgkJCX0KCQl9LAoJCW9ua2V5dXA6IGZ1bmN0aW9uKCBlbGVtZW50LCBldmVudCApIHsKCQkJaWYgKCBldmVudC53aGljaCA9PT0gOSAmJiB0aGlzLmVsZW1lbnRWYWx1ZSggZWxlbWVudCApID09PSAiIiApIHsKCQkJCXJldHVybjsKCQkJfSBlbHNlIGlmICggZWxlbWVudC5uYW1lIGluIHRoaXMuc3VibWl0dGVkIHx8IGVsZW1lbnQgPT09IHRoaXMubGFzdEVsZW1lbnQgKSB7CgkJCQl0aGlzLmVsZW1lbnQoIGVsZW1lbnQgKTsKCQkJfQoJCX0sCgkJb25jbGljazogZnVuY3Rpb24oIGVsZW1lbnQgKSB7CgkJCS8vIGNsaWNrIG9uIHNlbGVjdHMsIHJhZGlvYnV0dG9ucyBhbmQgY2hlY2tib3hlcwoJCQlpZiAoIGVsZW1lbnQubmFtZSBpbiB0aGlzLnN1Ym1pdHRlZCApIHsKCQkJCXRoaXMuZWxlbWVudCggZWxlbWVudCApOwoKCQkJLy8gb3Igb3B0aW9uIGVsZW1lbnRzLCBjaGVjayBwYXJlbnQgc2VsZWN0IGluIHRoYXQgY2FzZQoJCQl9IGVsc2UgaWYgKCBlbGVtZW50LnBhcmVudE5vZGUubmFtZSBpbiB0aGlzLnN1Ym1pdHRlZCApIHsKCQkJCXRoaXMuZWxlbWVudCggZWxlbWVudC5wYXJlbnROb2RlICk7CgkJCX0KCQl9LAoJCWhpZ2hsaWdodDogZnVuY3Rpb24oIGVsZW1lbnQsIGVycm9yQ2xhc3MsIHZhbGlkQ2xhc3MgKSB7CgkJCWlmICggZWxlbWVudC50eXBlID09PSAicmFkaW8iICkgewoJCQkJdGhpcy5maW5kQnlOYW1lKCBlbGVtZW50Lm5hbWUgKS5hZGRDbGFzcyggZXJyb3JDbGFzcyApLnJlbW92ZUNsYXNzKCB2YWxpZENsYXNzICk7CgkJCX0gZWxzZSB7CgkJCQkkKCBlbGVtZW50ICkuYWRkQ2xhc3MoIGVycm9yQ2xhc3MgKS5yZW1vdmVDbGFzcyggdmFsaWRDbGFzcyApOwoJCQl9CgkJfSwKCQl1bmhpZ2hsaWdodDogZnVuY3Rpb24oIGVsZW1lbnQsIGVycm9yQ2xhc3MsIHZhbGlkQ2xhc3MgKSB7CgkJCWlmICggZWxlbWVudC50eXBlID09PSAicmFkaW8iICkgewoJCQkJdGhpcy5maW5kQnlOYW1lKCBlbGVtZW50Lm5hbWUgKS5yZW1vdmVDbGFzcyggZXJyb3JDbGFzcyApLmFkZENsYXNzKCB2YWxpZENsYXNzICk7CgkJCX0gZWxzZSB7CgkJCQkkKCBlbGVtZW50ICkucmVtb3ZlQ2xhc3MoIGVycm9yQ2xhc3MgKS5hZGRDbGFzcyggdmFsaWRDbGFzcyApOwoJCQl9CgkJfQoJfSwKCgkvLyBodHRwOi8vanF1ZXJ5dmFsaWRhdGlvbi5vcmcvalF1ZXJ5LnZhbGlkYXRvci5zZXREZWZhdWx0cy8KCXNldERlZmF1bHRzOiBmdW5jdGlvbiggc2V0dGluZ3MgKSB7CgkJJC5leHRlbmQoICQudmFsaWRhdG9yLmRlZmF1bHRzLCBzZXR0aW5ncyApOwoJfSwKCgltZXNzYWdlczogewoJCXJlcXVpcmVkOiAiVGhpcyBmaWVsZCBpcyByZXF1aXJlZC4iLAoJCXJlbW90ZTogIlBsZWFzZSBmaXggdGhpcyBmaWVsZC4iLAoJCWVtYWlsOiAiUGxlYXNlIGVudGVyIGEgdmFsaWQgZW1haWwgYWRkcmVzcy4iLAoJCXVybDogIlBsZWFzZSBlbnRlciBhIHZhbGlkIFVSTC4iLAoJCWRhdGU6ICJQbGVhc2UgZW50ZXIgYSB2YWxpZCBkYXRlLiIsCgkJZGF0ZUlTTzogIlBsZWFzZSBlbnRlciBhIHZhbGlkIGRhdGUgKCBJU08gKS4iLAoJCW51bWJlcjogIlBsZWFzZSBlbnRlciBhIHZhbGlkIG51bWJlci4iLAoJCWRpZ2l0czogIlBsZWFzZSBlbnRlciBvbmx5IGRpZ2l0cy4iLAoJCWNyZWRpdGNhcmQ6ICJQbGVhc2UgZW50ZXIgYSB2YWxpZCBjcmVkaXQgY2FyZCBudW1iZXIuIiwKCQllcXVhbFRvOiAiUGxlYXNlIGVudGVyIHRoZSBzYW1lIHZhbHVlIGFnYWluLiIsCgkJbWF4bGVuZ3RoOiAkLnZhbGlkYXRvci5mb3JtYXQoICJQbGVhc2UgZW50ZXIgbm8gbW9yZSB0aGFuIHswfSBjaGFyYWN0ZXJzLiIgKSwKCQltaW5sZW5ndGg6ICQudmFsaWRhdG9yLmZvcm1hdCggIlBsZWFzZSBlbnRlciBhdCBsZWFzdCB7MH0gY2hhcmFjdGVycy4iICksCgkJcmFuZ2VsZW5ndGg6ICQudmFsaWRhdG9yLmZvcm1hdCggIlBsZWFzZSBlbnRlciBhIHZhbHVlIGJldHdlZW4gezB9IGFuZCB7MX0gY2hhcmFjdGVycyBsb25nLiIgKSwKCQlyYW5nZTogJC52YWxpZGF0b3IuZm9ybWF0KCAiUGxlYXNlIGVudGVyIGEgdmFsdWUgYmV0d2VlbiB7MH0gYW5kIHsxfS4iICksCgkJbWF4OiAkLnZhbGlkYXRvci5mb3JtYXQoICJQbGVhc2UgZW50ZXIgYSB2YWx1ZSBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gezB9LiIgKSwKCQltaW46ICQudmFsaWRhdG9yLmZvcm1hdCggIlBsZWFzZSBlbnRlciBhIHZhbHVlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byB7MH0uIiApCgl9LAoKCWF1dG9DcmVhdGVSYW5nZXM6IGZhbHNlLAoKCXByb3RvdHlwZTogewoKCQlpbml0OiBmdW5jdGlvbigpIHsKCQkJdGhpcy5sYWJlbENvbnRhaW5lciA9ICQoIHRoaXMuc2V0dGluZ3MuZXJyb3JMYWJlbENvbnRhaW5lciApOwoJCQl0aGlzLmVycm9yQ29udGV4dCA9IHRoaXMubGFiZWxDb250YWluZXIubGVuZ3RoICYmIHRoaXMubGFiZWxDb250YWluZXIgfHwgJCggdGhpcy5jdXJyZW50Rm9ybSApOwoJCQl0aGlzLmNvbnRhaW5lcnMgPSAkKCB0aGlzLnNldHRpbmdzLmVycm9yQ29udGFpbmVyICkuYWRkKCB0aGlzLnNldHRpbmdzLmVycm9yTGFiZWxDb250YWluZXIgKTsKCQkJdGhpcy5zdWJtaXR0ZWQgPSB7fTsKCQkJdGhpcy52YWx1ZUNhY2hlID0ge307CgkJCXRoaXMucGVuZGluZ1JlcXVlc3QgPSAwOwoJCQl0aGlzLnBlbmRpbmcgPSB7fTsKCQkJdGhpcy5pbnZhbGlkID0ge307CgkJCXRoaXMucmVzZXQoKTsKCgkJCXZhciBncm91cHMgPSAoIHRoaXMuZ3JvdXBzID0ge30gKSwKCQkJCXJ1bGVzOwoJCQkkLmVhY2goIHRoaXMuc2V0dGluZ3MuZ3JvdXBzLCBmdW5jdGlvbigga2V5LCB2YWx1ZSApIHsKCQkJCWlmICggdHlwZW9mIHZhbHVlID09PSAic3RyaW5nIiApIHsKCQkJCQl2YWx1ZSA9IHZhbHVlLnNwbGl0KCAvXHMvICk7CgkJCQl9CgkJCQkkLmVhY2goIHZhbHVlLCBmdW5jdGlvbiggaW5kZXgsIG5hbWUgKSB7CgkJCQkJZ3JvdXBzWyBuYW1lIF0gPSBrZXk7CgkJCQl9KTsKCQkJfSk7CgkJCXJ1bGVzID0gdGhpcy5zZXR0aW5ncy5ydWxlczsKCQkJJC5lYWNoKCBydWxlcywgZnVuY3Rpb24oIGtleSwgdmFsdWUgKSB7CgkJCQlydWxlc1sga2V5IF0gPSAkLnZhbGlkYXRvci5ub3JtYWxpemVSdWxlKCB2YWx1ZSApOwoJCQl9KTsKCgkJCWZ1bmN0aW9uIGRlbGVnYXRlKCBldmVudCApIHsKCQkJCXZhciB2YWxpZGF0b3IgPSAkLmRhdGEoIHRoaXNbIDAgXS5mb3JtLCAidmFsaWRhdG9yIiApLAoJCQkJCWV2ZW50VHlwZSA9ICJvbiIgKyBldmVudC50eXBlLnJlcGxhY2UoIC9edmFsaWRhdGUvLCAiIiApLAoJCQkJCXNldHRpbmdzID0gdmFsaWRhdG9yLnNldHRpbmdzOwoJCQkJaWYgKCBzZXR0aW5nc1sgZXZlbnRUeXBlIF0gJiYgIXRoaXMuaXMoIHNldHRpbmdzLmlnbm9yZSApICkgewoJCQkJCXNldHRpbmdzWyBldmVudFR5cGUgXS5jYWxsKCB2YWxpZGF0b3IsIHRoaXNbIDAgXSwgZXZlbnQgKTsKCQkJCX0KCQkJfQoJCQkkKCB0aGlzLmN1cnJlbnRGb3JtICkKCQkJCS52YWxpZGF0ZURlbGVnYXRlKCAiOnRleHQsIFt0eXBlPSdwYXNzd29yZCddLCBbdHlwZT0nZmlsZSddLCBzZWxlY3QsIHRleHRhcmVhLCAiICsKCQkJCQkiW3R5cGU9J251bWJlciddLCBbdHlwZT0nc2VhcmNoJ10gLFt0eXBlPSd0ZWwnXSwgW3R5cGU9J3VybCddLCAiICsKCQkJCQkiW3R5cGU9J2VtYWlsJ10sIFt0eXBlPSdkYXRldGltZSddLCBbdHlwZT0nZGF0ZSddLCBbdHlwZT0nbW9udGgnXSwgIiArCgkJCQkJIlt0eXBlPSd3ZWVrJ10sIFt0eXBlPSd0aW1lJ10sIFt0eXBlPSdkYXRldGltZS1sb2NhbCddLCAiICsKCQkJCQkiW3R5cGU9J3JhbmdlJ10sIFt0eXBlPSdjb2xvciddLCBbdHlwZT0ncmFkaW8nXSwgW3R5cGU9J2NoZWNrYm94J10iLAoJCQkJCSJmb2N1c2luIGZvY3Vzb3V0IGtleXVwIiwgZGVsZWdhdGUpCgkJCQkvLyBTdXBwb3J0OiBDaHJvbWUsIG9sZElFCgkJCQkvLyAic2VsZWN0IiBpcyBwcm92aWRlZCBhcyBldmVudC50YXJnZXQgd2hlbiBjbGlja2luZyBhIG9wdGlvbgoJCQkJLnZhbGlkYXRlRGVsZWdhdGUoInNlbGVjdCwgb3B0aW9uLCBbdHlwZT0ncmFkaW8nXSwgW3R5cGU9J2NoZWNrYm94J10iLCAiY2xpY2siLCBkZWxlZ2F0ZSk7CgoJCQlpZiAoIHRoaXMuc2V0dGluZ3MuaW52YWxpZEhhbmRsZXIgKSB7CgkJCQkkKCB0aGlzLmN1cnJlbnRGb3JtICkuYmluZCggImludmFsaWQtZm9ybS52YWxpZGF0ZSIsIHRoaXMuc2V0dGluZ3MuaW52YWxpZEhhbmRsZXIgKTsKCQkJfQoKCQkJLy8gQWRkIGFyaWEtcmVxdWlyZWQgdG8gYW55IFN0YXRpYy9EYXRhL0NsYXNzIHJlcXVpcmVkIGZpZWxkcyBiZWZvcmUgZmlyc3QgdmFsaWRhdGlvbgoJCQkvLyBTY3JlZW4gcmVhZGVycyByZXF1aXJlIHRoaXMgYXR0cmlidXRlIHRvIGJlIHByZXNlbnQgYmVmb3JlIHRoZSBpbml0aWFsIHN1Ym1pc3Npb24gaHR0cDovL3d3dy53My5vcmcvVFIvV0NBRy1URUNIUy9BUklBMi5odG1sCgkJCSQoIHRoaXMuY3VycmVudEZvcm0gKS5maW5kKCAiW3JlcXVpcmVkXSwgW2RhdGEtcnVsZS1yZXF1aXJlZF0sIC5yZXF1aXJlZCIgKS5hdHRyKCAiYXJpYS1yZXF1aXJlZCIsICJ0cnVlIiApOwoJCX0sCgoJCS8vIGh0dHA6Ly9qcXVlcnl2YWxpZGF0aW9uLm9yZy9WYWxpZGF0b3IuZm9ybS8KCQlmb3JtOiBmdW5jdGlvbigpIHsKCQkJdGhpcy5jaGVja0Zvcm0oKTsKCQkJJC5leHRlbmQoIHRoaXMuc3VibWl0dGVkLCB0aGlzLmVycm9yTWFwICk7CgkJCXRoaXMuaW52YWxpZCA9ICQuZXh0ZW5kKHt9LCB0aGlzLmVycm9yTWFwICk7CgkJCWlmICggIXRoaXMudmFsaWQoKSApIHsKCQkJCSQoIHRoaXMuY3VycmVudEZvcm0gKS50cmlnZ2VySGFuZGxlciggImludmFsaWQtZm9ybSIsIFsgdGhpcyBdKTsKCQkJfQoJCQl0aGlzLnNob3dFcnJvcnMoKTsKCQkJcmV0dXJuIHRoaXMudmFsaWQoKTsKCQl9LAoKCQljaGVja0Zvcm06IGZ1bmN0aW9uKCkgewoJCQl0aGlzLnByZXBhcmVGb3JtKCk7CgkJCWZvciAoIHZhciBpID0gMCwgZWxlbWVudHMgPSAoIHRoaXMuY3VycmVudEVsZW1lbnRzID0gdGhpcy5lbGVtZW50cygpICk7IGVsZW1lbnRzWyBpIF07IGkrKyApIHsKCQkJCXRoaXMuY2hlY2soIGVsZW1lbnRzWyBpIF0gKTsKCQkJfQoJCQlyZXR1cm4gdGhpcy52YWxpZCgpOwoJCX0sCgoJCS8vIGh0dHA6Ly9qcXVlcnl2YWxpZGF0aW9uLm9yZy9WYWxpZGF0b3IuZWxlbWVudC8KCQllbGVtZW50OiBmdW5jdGlvbiggZWxlbWVudCApIHsKCQkJdmFyIGNsZWFuRWxlbWVudCA9IHRoaXMuY2xlYW4oIGVsZW1lbnQgKSwKCQkJCWNoZWNrRWxlbWVudCA9IHRoaXMudmFsaWRhdGlvblRhcmdldEZvciggY2xlYW5FbGVtZW50ICksCgkJCQlyZXN1bHQgPSB0cnVlOwoKCQkJdGhpcy5sYXN0RWxlbWVudCA9IGNoZWNrRWxlbWVudDsKCgkJCWlmICggY2hlY2tFbGVtZW50ID09PSB1bmRlZmluZWQgKSB7CgkJCQlkZWxldGUgdGhpcy5pbnZhbGlkWyBjbGVhbkVsZW1lbnQubmFtZSBdOwoJCQl9IGVsc2UgewoJCQkJdGhpcy5wcmVwYXJlRWxlbWVudCggY2hlY2tFbGVtZW50ICk7CgkJCQl0aGlzLmN1cnJlbnRFbGVtZW50cyA9ICQoIGNoZWNrRWxlbWVudCApOwoKCQkJCXJlc3VsdCA9IHRoaXMuY2hlY2soIGNoZWNrRWxlbWVudCApICE9PSBmYWxzZTsKCQkJCWlmICggcmVzdWx0ICkgewoJCQkJCWRlbGV0ZSB0aGlzLmludmFsaWRbIGNoZWNrRWxlbWVudC5uYW1lIF07CgkJCQl9IGVsc2UgewoJCQkJCXRoaXMuaW52YWxpZFsgY2hlY2tFbGVtZW50Lm5hbWUgXSA9IHRydWU7CgkJCQl9CgkJCX0KCQkJLy8gQWRkIGFyaWEtaW52YWxpZCBzdGF0dXMgZm9yIHNjcmVlbiByZWFkZXJzCgkJCSQoIGVsZW1lbnQgKS5hdHRyKCAiYXJpYS1pbnZhbGlkIiwgIXJlc3VsdCApOwoKCQkJaWYgKCAhdGhpcy5udW1iZXJPZkludmFsaWRzKCkgKSB7CgkJCQkvLyBIaWRlIGVycm9yIGNvbnRhaW5lcnMgb24gbGFzdCBlcnJvcgoJCQkJdGhpcy50b0hpZGUgPSB0aGlzLnRvSGlkZS5hZGQoIHRoaXMuY29udGFpbmVycyApOwoJCQl9CgkJCXRoaXMuc2hvd0Vycm9ycygpOwoJCQlyZXR1cm4gcmVzdWx0OwoJCX0sCgoJCS8vIGh0dHA6Ly9qcXVlcnl2YWxpZGF0aW9uLm9yZy9WYWxpZGF0b3Iuc2hvd0Vycm9ycy8KCQlzaG93RXJyb3JzOiBmdW5jdGlvbiggZXJyb3JzICkgewoJCQlpZiAoIGVycm9ycyApIHsKCQkJCS8vIGFkZCBpdGVtcyB0byBlcnJvciBsaXN0IGFuZCBtYXAKCQkJCSQuZXh0ZW5kKCB0aGlzLmVycm9yTWFwLCBlcnJvcnMgKTsKCQkJCXRoaXMuZXJyb3JMaXN0ID0gW107CgkJCQlmb3IgKCB2YXIgbmFtZSBpbiBlcnJvcnMgKSB7CgkJCQkJdGhpcy5lcnJvckxpc3QucHVzaCh7CgkJCQkJCW1lc3NhZ2U6IGVycm9yc1sgbmFtZSBdLAoJCQkJCQllbGVtZW50OiB0aGlzLmZpbmRCeU5hbWUoIG5hbWUgKVsgMCBdCgkJCQkJfSk7CgkJCQl9CgkJCQkvLyByZW1vdmUgaXRlbXMgZnJvbSBzdWNjZXNzIGxpc3QKCQkJCXRoaXMuc3VjY2Vzc0xpc3QgPSAkLmdyZXAoIHRoaXMuc3VjY2Vzc0xpc3QsIGZ1bmN0aW9uKCBlbGVtZW50ICkgewoJCQkJCXJldHVybiAhKCBlbGVtZW50Lm5hbWUgaW4gZXJyb3JzICk7CgkJCQl9KTsKCQkJfQoJCQlpZiAoIHRoaXMuc2V0dGluZ3Muc2hvd0Vycm9ycyApIHsKCQkJCXRoaXMuc2V0dGluZ3Muc2hvd0Vycm9ycy5jYWxsKCB0aGlzLCB0aGlzLmVycm9yTWFwLCB0aGlzLmVycm9yTGlzdCApOwoJCQl9IGVsc2UgewoJCQkJdGhpcy5kZWZhdWx0U2hvd0Vycm9ycygpOwoJCQl9CgkJfSwKCgkJLy8gaHR0cDovL2pxdWVyeXZhbGlkYXRpb24ub3JnL1ZhbGlkYXRvci5yZXNldEZvcm0vCgkJcmVzZXRGb3JtOiBmdW5jdGlvbigpIHsKCQkJaWYgKCAkLmZuLnJlc2V0Rm9ybSApIHsKCQkJCSQoIHRoaXMuY3VycmVudEZvcm0gKS5yZXNldEZvcm0oKTsKCQkJfQoJCQl0aGlzLnN1Ym1pdHRlZCA9IHt9OwoJCQl0aGlzLmxhc3RFbGVtZW50ID0gbnVsbDsKCQkJdGhpcy5wcmVwYXJlRm9ybSgpOwoJCQl0aGlzLmhpZGVFcnJvcnMoKTsKCQkJdGhpcy5lbGVtZW50cygpCgkJCQkJLnJlbW92ZUNsYXNzKCB0aGlzLnNldHRpbmdzLmVycm9yQ2xhc3MgKQoJCQkJCS5yZW1vdmVEYXRhKCAicHJldmlvdXNWYWx1ZSIgKQoJCQkJCS5yZW1vdmVBdHRyKCAiYXJpYS1pbnZhbGlkIiApOwoJCX0sCgoJCW51bWJlck9mSW52YWxpZHM6IGZ1bmN0aW9uKCkgewoJCQlyZXR1cm4gdGhpcy5vYmplY3RMZW5ndGgoIHRoaXMuaW52YWxpZCApOwoJCX0sCgoJCW9iamVjdExlbmd0aDogZnVuY3Rpb24oIG9iaiApIHsKCQkJLyoganNoaW50IHVudXNlZDogZmFsc2UgKi8KCQkJdmFyIGNvdW50ID0gMCwKCQkJCWk7CgkJCWZvciAoIGkgaW4gb2JqICkgewoJCQkJY291bnQrKzsKCQkJfQoJCQlyZXR1cm4gY291bnQ7CgkJfSwKCgkJaGlkZUVycm9yczogZnVuY3Rpb24oKSB7CgkJCXRoaXMuaGlkZVRoZXNlKCB0aGlzLnRvSGlkZSApOwoJCX0sCgoJCWhpZGVUaGVzZTogZnVuY3Rpb24oIGVycm9ycyApIHsKCQkJZXJyb3JzLm5vdCggdGhpcy5jb250YWluZXJzICkudGV4dCggIiIgKTsKCQkJdGhpcy5hZGRXcmFwcGVyKCBlcnJvcnMgKS5oaWRlKCk7CgkJfSwKCgkJdmFsaWQ6IGZ1bmN0aW9uKCkgewoJCQlyZXR1cm4gdGhpcy5zaXplKCkgPT09IDA7CgkJfSwKCgkJc2l6ZTogZnVuY3Rpb24oKSB7CgkJCXJldHVybiB0aGlzLmVycm9yTGlzdC5sZW5ndGg7CgkJfSwKCgkJZm9jdXNJbnZhbGlkOiBmdW5jdGlvbigpIHsKCQkJaWYgKCB0aGlzLnNldHRpbmdzLmZvY3VzSW52YWxpZCApIHsKCQkJCXRyeSB7CgkJCQkJJCggdGhpcy5maW5kTGFzdEFjdGl2ZSgpIHx8IHRoaXMuZXJyb3JMaXN0Lmxlbmd0aCAmJiB0aGlzLmVycm9yTGlzdFsgMCBdLmVsZW1lbnQgfHwgW10pCgkJCQkJLmZpbHRlciggIjp2aXNpYmxlIiApCgkJCQkJLmZvY3VzKCkKCQkJCQkvLyBtYW51YWxseSB0cmlnZ2VyIGZvY3VzaW4gZXZlbnQ7IHdpdGhvdXQgaXQsIGZvY3VzaW4gaGFuZGxlciBpc24ndCBjYWxsZWQsIGZpbmRMYXN0QWN0aXZlIHdvbid0IGhhdmUgYW55dGhpbmcgdG8gZmluZAoJCQkJCS50cmlnZ2VyKCAiZm9jdXNpbiIgKTsKCQkJCX0gY2F0Y2ggKCBlICkgewoJCQkJCS8vIGlnbm9yZSBJRSB0aHJvd2luZyBlcnJvcnMgd2hlbiBmb2N1c2luZyBoaWRkZW4gZWxlbWVudHMKCQkJCX0KCQkJfQoJCX0sCgoJCWZpbmRMYXN0QWN0aXZlOiBmdW5jdGlvbigpIHsKCQkJdmFyIGxhc3RBY3RpdmUgPSB0aGlzLmxhc3RBY3RpdmU7CgkJCXJldHVybiBsYXN0QWN0aXZlICYmICQuZ3JlcCggdGhpcy5lcnJvckxpc3QsIGZ1bmN0aW9uKCBuICkgewoJCQkJcmV0dXJuIG4uZWxlbWVudC5uYW1lID09PSBsYXN0QWN0aXZlLm5hbWU7CgkJCX0pLmxlbmd0aCA9PT0gMSAmJiBsYXN0QWN0aXZlOwoJCX0sCgoJCWVsZW1lbnRzOiBmdW5jdGlvbigpIHsKCQkJdmFyIHZhbGlkYXRvciA9IHRoaXMsCgkJCQlydWxlc0NhY2hlID0ge307CgoJCQkvLyBzZWxlY3QgYWxsIHZhbGlkIGlucHV0cyBpbnNpZGUgdGhlIGZvcm0gKG5vIHN1Ym1pdCBvciByZXNldCBidXR0b25zKQoJCQlyZXR1cm4gJCggdGhpcy5jdXJyZW50Rm9ybSApCgkJCS5maW5kKCAiaW5wdXQsIHNlbGVjdCwgdGV4dGFyZWEiICkKCQkJLm5vdCggIjpzdWJtaXQsIDpyZXNldCwgOmltYWdlLCBbZGlzYWJsZWRdLCBbcmVhZG9ubHldIiApCgkJCS5ub3QoIHRoaXMuc2V0dGluZ3MuaWdub3JlICkKCQkJLmZpbHRlciggZnVuY3Rpb24oKSB7CgkJCQlpZiAoICF0aGlzLm5hbWUgJiYgdmFsaWRhdG9yLnNldHRpbmdzLmRlYnVnICYmIHdpbmRvdy5jb25zb2xlICkgewoJCQkJCWNvbnNvbGUuZXJyb3IoICIlbyBoYXMgbm8gbmFtZSBhc3NpZ25lZCIsIHRoaXMgKTsKCQkJCX0KCgkJCQkvLyBzZWxlY3Qgb25seSB0aGUgZmlyc3QgZWxlbWVudCBmb3IgZWFjaCBuYW1lLCBhbmQgb25seSB0aG9zZSB3aXRoIHJ1bGVzIHNwZWNpZmllZAoJCQkJaWYgKCB0aGlzLm5hbWUgaW4gcnVsZXNDYWNoZSB8fCAhdmFsaWRhdG9yLm9iamVjdExlbmd0aCggJCggdGhpcyApLnJ1bGVzKCkgKSApIHsKCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9CgoJCQkJcnVsZXNDYWNoZVsgdGhpcy5uYW1lIF0gPSB0cnVlOwoJCQkJcmV0dXJuIHRydWU7CgkJCX0pOwoJCX0sCgoJCWNsZWFuOiBmdW5jdGlvbiggc2VsZWN0b3IgKSB7CgkJCXJldHVybiAkKCBzZWxlY3RvciApWyAwIF07CgkJfSwKCgkJZXJyb3JzOiBmdW5jdGlvbigpIHsKCQkJdmFyIGVycm9yQ2xhc3MgPSB0aGlzLnNldHRpbmdzLmVycm9yQ2xhc3Muc3BsaXQoICIgIiApLmpvaW4oICIuIiApOwoJCQlyZXR1cm4gJCggdGhpcy5zZXR0aW5ncy5lcnJvckVsZW1lbnQgKyAiLiIgKyBlcnJvckNsYXNzLCB0aGlzLmVycm9yQ29udGV4dCApOwoJCX0sCgoJCXJlc2V0OiBmdW5jdGlvbigpIHsKCQkJdGhpcy5zdWNjZXNzTGlzdCA9IFtdOwoJCQl0aGlzLmVycm9yTGlzdCA9IFtdOwoJCQl0aGlzLmVycm9yTWFwID0ge307CgkJCXRoaXMudG9TaG93ID0gJCggW10gKTsKCQkJdGhpcy50b0hpZGUgPSAkKCBbXSApOwoJCQl0aGlzLmN1cnJlbnRFbGVtZW50cyA9ICQoIFtdICk7CgkJfSwKCgkJcHJlcGFyZUZvcm06IGZ1bmN0aW9uKCkgewoJCQl0aGlzLnJlc2V0KCk7CgkJCXRoaXMudG9IaWRlID0gdGhpcy5lcnJvcnMoKS5hZGQoIHRoaXMuY29udGFpbmVycyApOwoJCX0sCgoJCXByZXBhcmVFbGVtZW50OiBmdW5jdGlvbiggZWxlbWVudCApIHsKCQkJdGhpcy5yZXNldCgpOwoJCQl0aGlzLnRvSGlkZSA9IHRoaXMuZXJyb3JzRm9yKCBlbGVtZW50ICk7CgkJfSwKCgkJZWxlbWVudFZhbHVlOiBmdW5jdGlvbiggZWxlbWVudCApIHsKCQkJdmFyIHZhbCwKCQkJCSRlbGVtZW50ID0gJCggZWxlbWVudCApLAoJCQkJdHlwZSA9IGVsZW1lbnQudHlwZTsKCgkJCWlmICggdHlwZSA9PT0gInJhZGlvIiB8fCB0eXBlID09PSAiY2hlY2tib3giICkgewoJCQkJcmV0dXJuICQoICJpbnB1dFtuYW1lPSciICsgZWxlbWVudC5uYW1lICsgIiddOmNoZWNrZWQiICkudmFsKCk7CgkJCX0gZWxzZSBpZiAoIHR5cGUgPT09ICJudW1iZXIiICYmIHR5cGVvZiBlbGVtZW50LnZhbGlkaXR5ICE9PSAidW5kZWZpbmVkIiApIHsKCQkJCXJldHVybiBlbGVtZW50LnZhbGlkaXR5LmJhZElucHV0ID8gZmFsc2UgOiAkZWxlbWVudC52YWwoKTsKCQkJfQoKCQkJdmFsID0gJGVsZW1lbnQudmFsKCk7CgkJCWlmICggdHlwZW9mIHZhbCA9PT0gInN0cmluZyIgKSB7CgkJCQlyZXR1cm4gdmFsLnJlcGxhY2UoL1xyL2csICIiICk7CgkJCX0KCQkJcmV0dXJuIHZhbDsKCQl9LAoKCQljaGVjazogZnVuY3Rpb24oIGVsZW1lbnQgKSB7CgkJCWVsZW1lbnQgPSB0aGlzLnZhbGlkYXRpb25UYXJnZXRGb3IoIHRoaXMuY2xlYW4oIGVsZW1lbnQgKSApOwoKCQkJdmFyIHJ1bGVzID0gJCggZWxlbWVudCApLnJ1bGVzKCksCgkJCQlydWxlc0NvdW50ID0gJC5tYXAoIHJ1bGVzLCBmdW5jdGlvbiggbiwgaSApIHsKCQkJCQlyZXR1cm4gaTsKCQkJCX0pLmxlbmd0aCwKCQkJCWRlcGVuZGVuY3lNaXNtYXRjaCA9IGZhbHNlLAoJCQkJdmFsID0gdGhpcy5lbGVtZW50VmFsdWUoIGVsZW1lbnQgKSwKCQkJCXJlc3VsdCwgbWV0aG9kLCBydWxlOwoKCQkJZm9yICggbWV0aG9kIGluIHJ1bGVzICkgewoJCQkJcnVsZSA9IHsgbWV0aG9kOiBtZXRob2QsIHBhcmFtZXRlcnM6IHJ1bGVzWyBtZXRob2QgXSB9OwoJCQkJdHJ5IHsKCgkJCQkJcmVzdWx0ID0gJC52YWxpZGF0b3IubWV0aG9kc1sgbWV0aG9kIF0uY2FsbCggdGhpcywgdmFsLCBlbGVtZW50LCBydWxlLnBhcmFtZXRlcnMgKTsKCgkJCQkJLy8gaWYgYSBtZXRob2QgaW5kaWNhdGVzIHRoYXQgdGhlIGZpZWxkIGlzIG9wdGlvbmFsIGFuZCB0aGVyZWZvcmUgdmFsaWQsCgkJCQkJLy8gZG9uJ3QgbWFyayBpdCBhcyB2YWxpZCB3aGVuIHRoZXJlIGFyZSBubyBvdGhlciBydWxlcwoJCQkJCWlmICggcmVzdWx0ID09PSAiZGVwZW5kZW5jeS1taXNtYXRjaCIgJiYgcnVsZXNDb3VudCA9PT0gMSApIHsKCQkJCQkJZGVwZW5kZW5jeU1pc21hdGNoID0gdHJ1ZTsKCQkJCQkJY29udGludWU7CgkJCQkJfQoJCQkJCWRlcGVuZGVuY3lNaXNtYXRjaCA9IGZhbHNlOwoKCQkJCQlpZiAoIHJlc3VsdCA9PT0gInBlbmRpbmciICkgewoJCQkJCQl0aGlzLnRvSGlkZSA9IHRoaXMudG9IaWRlLm5vdCggdGhpcy5lcnJvcnNGb3IoIGVsZW1lbnQgKSApOwoJCQkJCQlyZXR1cm47CgkJCQkJfQoKCQkJCQlpZiAoICFyZXN1bHQgKSB7CgkJCQkJCXRoaXMuZm9ybWF0QW5kQWRkKCBlbGVtZW50LCBydWxlICk7CgkJCQkJCXJldHVybiBmYWxzZTsKCQkJCQl9CgkJCQl9IGNhdGNoICggZSApIHsKCQkJCQlpZiAoIHRoaXMuc2V0dGluZ3MuZGVidWcgJiYgd2luZG93LmNvbnNvbGUgKSB7CgkJCQkJCWNvbnNvbGUubG9nKCAiRXhjZXB0aW9uIG9jY3VycmVkIHdoZW4gY2hlY2tpbmcgZWxlbWVudCAiICsgZWxlbWVudC5pZCArICIsIGNoZWNrIHRoZSAnIiArIHJ1bGUubWV0aG9kICsgIicgbWV0aG9kLiIsIGUgKTsKCQkJCQl9CgkJCQkJdGhyb3cgZTsKCQkJCX0KCQkJfQoJCQlpZiAoIGRlcGVuZGVuY3lNaXNtYXRjaCApIHsKCQkJCXJldHVybjsKCQkJfQoJCQlpZiAoIHRoaXMub2JqZWN0TGVuZ3RoKCBydWxlcyApICkgewoJCQkJdGhpcy5zdWNjZXNzTGlzdC5wdXNoKCBlbGVtZW50ICk7CgkJCX0KCQkJcmV0dXJuIHRydWU7CgkJfSwKCgkJLy8gcmV0dXJuIHRoZSBjdXN0b20gbWVzc2FnZSBmb3IgdGhlIGdpdmVuIGVsZW1lbnQgYW5kIHZhbGlkYXRpb24gbWV0aG9kCgkJLy8gc3BlY2lmaWVkIGluIHRoZSBlbGVtZW50J3MgSFRNTDUgZGF0YSBhdHRyaWJ1dGUKCQkvLyByZXR1cm4gdGhlIGdlbmVyaWMgbWVzc2FnZSBpZiBwcmVzZW50IGFuZCBubyBtZXRob2Qgc3BlY2lmaWMgbWVzc2FnZSBpcyBwcmVzZW50CgkJY3VzdG9tRGF0YU1lc3NhZ2U6IGZ1bmN0aW9uKCBlbGVtZW50LCBtZXRob2QgKSB7CgkJCXJldHVybiAkKCBlbGVtZW50ICkuZGF0YSggIm1zZyIgKyBtZXRob2QuY2hhckF0KCAwICkudG9VcHBlckNhc2UoKSArCgkJCQltZXRob2Quc3Vic3RyaW5nKCAxICkudG9Mb3dlckNhc2UoKSApIHx8ICQoIGVsZW1lbnQgKS5kYXRhKCAibXNnIiApOwoJCX0sCgoJCS8vIHJldHVybiB0aGUgY3VzdG9tIG1lc3NhZ2UgZm9yIHRoZSBnaXZlbiBlbGVtZW50IG5hbWUgYW5kIHZhbGlkYXRpb24gbWV0aG9kCgkJY3VzdG9tTWVzc2FnZTogZnVuY3Rpb24oIG5hbWUsIG1ldGhvZCApIHsKCQkJdmFyIG0gPSB0aGlzLnNldHRpbmdzLm1lc3NhZ2VzWyBuYW1lIF07CgkJCXJldHVybiBtICYmICggbS5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nID8gbSA6IG1bIG1ldGhvZCBdKTsKCQl9LAoKCQkvLyByZXR1cm4gdGhlIGZpcnN0IGRlZmluZWQgYXJndW1lbnQsIGFsbG93aW5nIGVtcHR5IHN0cmluZ3MKCQlmaW5kRGVmaW5lZDogZnVuY3Rpb24oKSB7CgkJCWZvciAoIHZhciBpID0gMDsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewoJCQkJaWYgKCBhcmd1bWVudHNbIGkgXSAhPT0gdW5kZWZpbmVkICkgewoJCQkJCXJldHVybiBhcmd1bWVudHNbIGkgXTsKCQkJCX0KCQkJfQoJCQlyZXR1cm4gdW5kZWZpbmVkOwoJCX0sCgoJCWRlZmF1bHRNZXNzYWdlOiBmdW5jdGlvbiggZWxlbWVudCwgbWV0aG9kICkgewoJCQlyZXR1cm4gdGhpcy5maW5kRGVmaW5lZCgKCQkJCXRoaXMuY3VzdG9tTWVzc2FnZSggZWxlbWVudC5uYW1lLCBtZXRob2QgKSwKCQkJCXRoaXMuY3VzdG9tRGF0YU1lc3NhZ2UoIGVsZW1lbnQsIG1ldGhvZCApLAoJCQkJLy8gdGl0bGUgaXMgbmV2ZXIgdW5kZWZpbmVkLCBzbyBoYW5kbGUgZW1wdHkgc3RyaW5nIGFzIHVuZGVmaW5lZAoJCQkJIXRoaXMuc2V0dGluZ3MuaWdub3JlVGl0bGUgJiYgZWxlbWVudC50aXRsZSB8fCB1bmRlZmluZWQsCgkJCQkkLnZhbGlkYXRvci5tZXNzYWdlc1sgbWV0aG9kIF0sCgkJCQkiPHN0cm9uZz5XYXJuaW5nOiBObyBtZXNzYWdlIGRlZmluZWQgZm9yICIgKyBlbGVtZW50Lm5hbWUgKyAiPC9zdHJvbmc+IgoJCQkpOwoJCX0sCgoJCWZvcm1hdEFuZEFkZDogZnVuY3Rpb24oIGVsZW1lbnQsIHJ1bGUgKSB7CgkJCXZhciBtZXNzYWdlID0gdGhpcy5kZWZhdWx0TWVzc2FnZSggZWxlbWVudCwgcnVsZS5tZXRob2QgKSwKCQkJCXRoZXJlZ2V4ID0gL1wkP1x7KFxkKylcfS9nOwoJCQlpZiAoIHR5cGVvZiBtZXNzYWdlID09PSAiZnVuY3Rpb24iICkgewoJCQkJbWVzc2FnZSA9IG1lc3NhZ2UuY2FsbCggdGhpcywgcnVsZS5wYXJhbWV0ZXJzLCBlbGVtZW50ICk7CgkJCX0gZWxzZSBpZiAoIHRoZXJlZ2V4LnRlc3QoIG1lc3NhZ2UgKSApIHsKCQkJCW1lc3NhZ2UgPSAkLnZhbGlkYXRvci5mb3JtYXQoIG1lc3NhZ2UucmVwbGFjZSggdGhlcmVnZXgsICJ7JDF9IiApLCBydWxlLnBhcmFtZXRlcnMgKTsKCQkJfQoJCQl0aGlzLmVycm9yTGlzdC5wdXNoKHsKCQkJCW1lc3NhZ2U6IG1lc3NhZ2UsCgkJCQllbGVtZW50OiBlbGVtZW50LAoJCQkJbWV0aG9kOiBydWxlLm1ldGhvZAoJCQl9KTsKCgkJCXRoaXMuZXJyb3JNYXBbIGVsZW1lbnQubmFtZSBdID0gbWVzc2FnZTsKCQkJdGhpcy5zdWJtaXR0ZWRbIGVsZW1lbnQubmFtZSBdID0gbWVzc2FnZTsKCQl9LAoKCQlhZGRXcmFwcGVyOiBmdW5jdGlvbiggdG9Ub2dnbGUgKSB7CgkJCWlmICggdGhpcy5zZXR0aW5ncy53cmFwcGVyICkgewoJCQkJdG9Ub2dnbGUgPSB0b1RvZ2dsZS5hZGQoIHRvVG9nZ2xlLnBhcmVudCggdGhpcy5zZXR0aW5ncy53cmFwcGVyICkgKTsKCQkJfQoJCQlyZXR1cm4gdG9Ub2dnbGU7CgkJfSwKCgkJZGVmYXVsdFNob3dFcnJvcnM6IGZ1bmN0aW9uKCkgewoJCQl2YXIgaSwgZWxlbWVudHMsIGVycm9yOwoJCQlmb3IgKCBpID0gMDsgdGhpcy5lcnJvckxpc3RbIGkgXTsgaSsrICkgewoJCQkJZXJyb3IgPSB0aGlzLmVycm9yTGlzdFsgaSBdOwoJCQkJaWYgKCB0aGlzLnNldHRpbmdzLmhpZ2hsaWdodCApIHsKCQkJCQl0aGlzLnNldHRpbmdzLmhpZ2hsaWdodC5jYWxsKCB0aGlzLCBlcnJvci5lbGVtZW50LCB0aGlzLnNldHRpbmdzLmVycm9yQ2xhc3MsIHRoaXMuc2V0dGluZ3MudmFsaWRDbGFzcyApOwoJCQkJfQoJCQkJdGhpcy5zaG93TGFiZWwoIGVycm9yLmVsZW1lbnQsIGVycm9yLm1lc3NhZ2UgKTsKCQkJfQoJCQlpZiAoIHRoaXMuZXJyb3JMaXN0Lmxlbmd0aCApIHsKCQkJCXRoaXMudG9TaG93ID0gdGhpcy50b1Nob3cuYWRkKCB0aGlzLmNvbnRhaW5lcnMgKTsKCQkJfQoJCQlpZiAoIHRoaXMuc2V0dGluZ3Muc3VjY2VzcyApIHsKCQkJCWZvciAoIGkgPSAwOyB0aGlzLnN1Y2Nlc3NMaXN0WyBpIF07IGkrKyApIHsKCQkJCQl0aGlzLnNob3dMYWJlbCggdGhpcy5zdWNjZXNzTGlzdFsgaSBdICk7CgkJCQl9CgkJCX0KCQkJaWYgKCB0aGlzLnNldHRpbmdzLnVuaGlnaGxpZ2h0ICkgewoJCQkJZm9yICggaSA9IDAsIGVsZW1lbnRzID0gdGhpcy52YWxpZEVsZW1lbnRzKCk7IGVsZW1lbnRzWyBpIF07IGkrKyApIHsKCQkJCQl0aGlzLnNldHRpbmdzLnVuaGlnaGxpZ2h0LmNhbGwoIHRoaXMsIGVsZW1lbnRzWyBpIF0sIHRoaXMuc2V0dGluZ3MuZXJyb3JDbGFzcywgdGhpcy5zZXR0aW5ncy52YWxpZENsYXNzICk7CgkJCQl9CgkJCX0KCQkJdGhpcy50b0hpZGUgPSB0aGlzLnRvSGlkZS5ub3QoIHRoaXMudG9TaG93ICk7CgkJCXRoaXMuaGlkZUVycm9ycygpOwoJCQl0aGlzLmFkZFdyYXBwZXIoIHRoaXMudG9TaG93ICkuc2hvdygpOwoJCX0sCgoJCXZhbGlkRWxlbWVudHM6IGZ1bmN0aW9uKCkgewoJCQlyZXR1cm4gdGhpcy5jdXJyZW50RWxlbWVudHMubm90KCB0aGlzLmludmFsaWRFbGVtZW50cygpICk7CgkJfSwKCgkJaW52YWxpZEVsZW1lbnRzOiBmdW5jdGlvbigpIHsKCQkJcmV0dXJuICQoIHRoaXMuZXJyb3JMaXN0ICkubWFwKGZ1bmN0aW9uKCkgewoJCQkJcmV0dXJuIHRoaXMuZWxlbWVudDsKCQkJfSk7CgkJfSwKCgkJc2hvd0xhYmVsOiBmdW5jdGlvbiggZWxlbWVudCwgbWVzc2FnZSApIHsKCQkJdmFyIHBsYWNlLCBncm91cCwgZXJyb3JJRCwKCQkJCWVycm9yID0gdGhpcy5lcnJvcnNGb3IoIGVsZW1lbnQgKSwKCQkJCWVsZW1lbnRJRCA9IHRoaXMuaWRPck5hbWUoIGVsZW1lbnQgKSwKCQkJCWRlc2NyaWJlZEJ5ID0gJCggZWxlbWVudCApLmF0dHIoICJhcmlhLWRlc2NyaWJlZGJ5IiApOwoJCQlpZiAoIGVycm9yLmxlbmd0aCApIHsKCQkJCS8vIHJlZnJlc2ggZXJyb3Ivc3VjY2VzcyBjbGFzcwoJCQkJZXJyb3IucmVtb3ZlQ2xhc3MoIHRoaXMuc2V0dGluZ3MudmFsaWRDbGFzcyApLmFkZENsYXNzKCB0aGlzLnNldHRpbmdzLmVycm9yQ2xhc3MgKTsKCQkJCS8vIHJlcGxhY2UgbWVzc2FnZSBvbiBleGlzdGluZyBsYWJlbAoJCQkJZXJyb3IuaHRtbCggbWVzc2FnZSApOwoJCQl9IGVsc2UgewoJCQkJLy8gY3JlYXRlIGVycm9yIGVsZW1lbnQKCQkJCWVycm9yID0gJCggIjwiICsgdGhpcy5zZXR0aW5ncy5lcnJvckVsZW1lbnQgKyAiPiIgKQoJCQkJCS5hdHRyKCAiaWQiLCBlbGVtZW50SUQgKyAiLWVycm9yIiApCgkJCQkJLmFkZENsYXNzKCB0aGlzLnNldHRpbmdzLmVycm9yQ2xhc3MgKQoJCQkJCS5odG1sKCBtZXNzYWdlIHx8ICIiICk7CgoJCQkJLy8gTWFpbnRhaW4gcmVmZXJlbmNlIHRvIHRoZSBlbGVtZW50IHRvIGJlIHBsYWNlZCBpbnRvIHRoZSBET00KCQkJCXBsYWNlID0gZXJyb3I7CgkJCQlpZiAoIHRoaXMuc2V0dGluZ3Mud3JhcHBlciApIHsKCQkJCQkvLyBtYWtlIHN1cmUgdGhlIGVsZW1lbnQgaXMgdmlzaWJsZSwgZXZlbiBpbiBJRQoJCQkJCS8vIGFjdHVhbGx5IHNob3dpbmcgdGhlIHdyYXBwZWQgZWxlbWVudCBpcyBoYW5kbGVkIGVsc2V3aGVyZQoJCQkJCXBsYWNlID0gZXJyb3IuaGlkZSgpLnNob3coKS53cmFwKCAiPCIgKyB0aGlzLnNldHRpbmdzLndyYXBwZXIgKyAiLz4iICkucGFyZW50KCk7CgkJCQl9CgkJCQlpZiAoIHRoaXMubGFiZWxDb250YWluZXIubGVuZ3RoICkgewoJCQkJCXRoaXMubGFiZWxDb250YWluZXIuYXBwZW5kKCBwbGFjZSApOwoJCQkJfSBlbHNlIGlmICggdGhpcy5zZXR0aW5ncy5lcnJvclBsYWNlbWVudCApIHsKCQkJCQl0aGlzLnNldHRpbmdzLmVycm9yUGxhY2VtZW50KCBwbGFjZSwgJCggZWxlbWVudCApICk7CgkJCQl9IGVsc2UgewoJCQkJCXBsYWNlLmluc2VydEFmdGVyKCBlbGVtZW50ICk7CgkJCQl9CgoJCQkJLy8gTGluayBlcnJvciBiYWNrIHRvIHRoZSBlbGVtZW50CgkJCQlpZiAoIGVycm9yLmlzKCAibGFiZWwiICkgKSB7CgkJCQkJLy8gSWYgdGhlIGVycm9yIGlzIGEgbGFiZWwsIHRoZW4gYXNzb2NpYXRlIHVzaW5nICdmb3InCgkJCQkJZXJyb3IuYXR0ciggImZvciIsIGVsZW1lbnRJRCApOwoJCQkJfSBlbHNlIGlmICggZXJyb3IucGFyZW50cyggImxhYmVsW2Zvcj0nIiArIGVsZW1lbnRJRCArICInXSIgKS5sZW5ndGggPT09IDAgKSB7CgkJCQkJLy8gSWYgdGhlIGVsZW1lbnQgaXMgbm90IGEgY2hpbGQgb2YgYW4gYXNzb2NpYXRlZCBsYWJlbCwgdGhlbiBpdCdzIG5lY2Vzc2FyeQoJCQkJCS8vIHRvIGV4cGxpY2l0bHkgYXBwbHkgYXJpYS1kZXNjcmliZWRieQoKCQkJCQllcnJvcklEID0gZXJyb3IuYXR0ciggImlkIiApLnJlcGxhY2UoIC8oOnxcLnxcW3xcXSkvZywgIlxcJDEiKTsKCQkJCQkvLyBSZXNwZWN0IGV4aXN0aW5nIG5vbi1lcnJvciBhcmlhLWRlc2NyaWJlZGJ5CgkJCQkJaWYgKCAhZGVzY3JpYmVkQnkgKSB7CgkJCQkJCWRlc2NyaWJlZEJ5ID0gZXJyb3JJRDsKCQkJCQl9IGVsc2UgaWYgKCAhZGVzY3JpYmVkQnkubWF0Y2goIG5ldyBSZWdFeHAoICJcXGIiICsgZXJyb3JJRCArICJcXGIiICkgKSApIHsKCQkJCQkJLy8gQWRkIHRvIGVuZCBvZiBsaXN0IGlmIG5vdCBhbHJlYWR5IHByZXNlbnQKCQkJCQkJZGVzY3JpYmVkQnkgKz0gIiAiICsgZXJyb3JJRDsKCQkJCQl9CgkJCQkJJCggZWxlbWVudCApLmF0dHIoICJhcmlhLWRlc2NyaWJlZGJ5IiwgZGVzY3JpYmVkQnkgKTsKCgkJCQkJLy8gSWYgdGhpcyBlbGVtZW50IGlzIGdyb3VwZWQsIHRoZW4gYXNzaWduIHRvIGFsbCBlbGVtZW50cyBpbiB0aGUgc2FtZSBncm91cAoJCQkJCWdyb3VwID0gdGhpcy5ncm91cHNbIGVsZW1lbnQubmFtZSBdOwoJCQkJCWlmICggZ3JvdXAgKSB7CgkJCQkJCSQuZWFjaCggdGhpcy5ncm91cHMsIGZ1bmN0aW9uKCBuYW1lLCB0ZXN0Z3JvdXAgKSB7CgkJCQkJCQlpZiAoIHRlc3Rncm91cCA9PT0gZ3JvdXAgKSB7CgkJCQkJCQkJJCggIltuYW1lPSciICsgbmFtZSArICInXSIsIHRoaXMuY3VycmVudEZvcm0gKQoJCQkJCQkJCQkuYXR0ciggImFyaWEtZGVzY3JpYmVkYnkiLCBlcnJvci5hdHRyKCAiaWQiICkgKTsKCQkJCQkJCX0KCQkJCQkJfSk7CgkJCQkJfQoJCQkJfQoJCQl9CgkJCWlmICggIW1lc3NhZ2UgJiYgdGhpcy5zZXR0aW5ncy5zdWNjZXNzICkgewoJCQkJZXJyb3IudGV4dCggIiIgKTsKCQkJCWlmICggdHlwZW9mIHRoaXMuc2V0dGluZ3Muc3VjY2VzcyA9PT0gInN0cmluZyIgKSB7CgkJCQkJZXJyb3IuYWRkQ2xhc3MoIHRoaXMuc2V0dGluZ3Muc3VjY2VzcyApOwoJCQkJfSBlbHNlIHsKCQkJCQl0aGlzLnNldHRpbmdzLnN1Y2Nlc3MoIGVycm9yLCBlbGVtZW50ICk7CgkJCQl9CgkJCX0KCQkJdGhpcy50b1Nob3cgPSB0aGlzLnRvU2hvdy5hZGQoIGVycm9yICk7CgkJfSwKCgkJZXJyb3JzRm9yOiBmdW5jdGlvbiggZWxlbWVudCApIHsKCQkJdmFyIG5hbWUgPSB0aGlzLmlkT3JOYW1lKCBlbGVtZW50ICksCgkJCQlkZXNjcmliZXIgPSAkKCBlbGVtZW50ICkuYXR0ciggImFyaWEtZGVzY3JpYmVkYnkiICksCgkJCQlzZWxlY3RvciA9ICJsYWJlbFtmb3I9JyIgKyBuYW1lICsgIiddLCBsYWJlbFtmb3I9JyIgKyBuYW1lICsgIiddICoiOwoKCQkJLy8gYXJpYS1kZXNjcmliZWRieSBzaG91bGQgZGlyZWN0bHkgcmVmZXJlbmNlIHRoZSBlcnJvciBlbGVtZW50CgkJCWlmICggZGVzY3JpYmVyICkgewoJCQkJc2VsZWN0b3IgPSBzZWxlY3RvciArICIsICMiICsgZGVzY3JpYmVyLnJlcGxhY2UoIC9ccysvZywgIiwgIyIgKTsKCQkJfQoJCQlyZXR1cm4gdGhpcwoJCQkJLmVycm9ycygpCgkJCQkuZmlsdGVyKCBzZWxlY3RvciApOwoJCX0sCgoJCWlkT3JOYW1lOiBmdW5jdGlvbiggZWxlbWVudCApIHsKCQkJcmV0dXJuIHRoaXMuZ3JvdXBzWyBlbGVtZW50Lm5hbWUgXSB8fCAoIHRoaXMuY2hlY2thYmxlKCBlbGVtZW50ICkgPyBlbGVtZW50Lm5hbWUgOiBlbGVtZW50LmlkIHx8IGVsZW1lbnQubmFtZSApOwoJCX0sCgoJCXZhbGlkYXRpb25UYXJnZXRGb3I6IGZ1bmN0aW9uKCBlbGVtZW50ICkgewoKCQkJLy8gSWYgcmFkaW8vY2hlY2tib3gsIHZhbGlkYXRlIGZpcnN0IGVsZW1lbnQgaW4gZ3JvdXAgaW5zdGVhZAoJCQlpZiAoIHRoaXMuY2hlY2thYmxlKCBlbGVtZW50ICkgKSB7CgkJCQllbGVtZW50ID0gdGhpcy5maW5kQnlOYW1lKCBlbGVtZW50Lm5hbWUgKTsKCQkJfQoKCQkJLy8gQWx3YXlzIGFwcGx5IGlnbm9yZSBmaWx0ZXIKCQkJcmV0dXJuICQoIGVsZW1lbnQgKS5ub3QoIHRoaXMuc2V0dGluZ3MuaWdub3JlIClbIDAgXTsKCQl9LAoKCQljaGVja2FibGU6IGZ1bmN0aW9uKCBlbGVtZW50ICkgewoJCQlyZXR1cm4gKCAvcmFkaW98Y2hlY2tib3gvaSApLnRlc3QoIGVsZW1lbnQudHlwZSApOwoJCX0sCgoJCWZpbmRCeU5hbWU6IGZ1bmN0aW9uKCBuYW1lICkgewoJCQlyZXR1cm4gJCggdGhpcy5jdXJyZW50Rm9ybSApLmZpbmQoICJbbmFtZT0nIiArIG5hbWUgKyAiJ10iICk7CgkJfSwKCgkJZ2V0TGVuZ3RoOiBmdW5jdGlvbiggdmFsdWUsIGVsZW1lbnQgKSB7CgkJCXN3aXRjaCAoIGVsZW1lbnQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSApIHsKCQkJY2FzZSAic2VsZWN0IjoKCQkJCXJldHVybiAkKCAib3B0aW9uOnNlbGVjdGVkIiwgZWxlbWVudCApLmxlbmd0aDsKCQkJY2FzZSAiaW5wdXQiOgoJCQkJaWYgKCB0aGlzLmNoZWNrYWJsZSggZWxlbWVudCApICkgewoJCQkJCXJldHVybiB0aGlzLmZpbmRCeU5hbWUoIGVsZW1lbnQubmFtZSApLmZpbHRlciggIjpjaGVja2VkIiApLmxlbmd0aDsKCQkJCX0KCQkJfQoJCQlyZXR1cm4gdmFsdWUubGVuZ3RoOwoJCX0sCgoJCWRlcGVuZDogZnVuY3Rpb24oIHBhcmFtLCBlbGVtZW50ICkgewoJCQlyZXR1cm4gdGhpcy5kZXBlbmRUeXBlc1t0eXBlb2YgcGFyYW1dID8gdGhpcy5kZXBlbmRUeXBlc1t0eXBlb2YgcGFyYW1dKCBwYXJhbSwgZWxlbWVudCApIDogdHJ1ZTsKCQl9LAoKCQlkZXBlbmRUeXBlczogewoJCQkiYm9vbGVhbiI6IGZ1bmN0aW9uKCBwYXJhbSApIHsKCQkJCXJldHVybiBwYXJhbTsKCQkJfSwKCQkJInN0cmluZyI6IGZ1bmN0aW9uKCBwYXJhbSwgZWxlbWVudCApIHsKCQkJCXJldHVybiAhISQoIHBhcmFtLCBlbGVtZW50LmZvcm0gKS5sZW5ndGg7CgkJCX0sCgkJCSJmdW5jdGlvbiI6IGZ1bmN0aW9uKCBwYXJhbSwgZWxlbWVudCApIHsKCQkJCXJldHVybiBwYXJhbSggZWxlbWVudCApOwoJCQl9CgkJfSwKCgkJb3B0aW9uYWw6IGZ1bmN0aW9uKCBlbGVtZW50ICkgewoJCQl2YXIgdmFsID0gdGhpcy5lbGVtZW50VmFsdWUoIGVsZW1lbnQgKTsKCQkJcmV0dXJuICEkLnZhbGlkYXRvci5tZXRob2RzLnJlcXVpcmVkLmNhbGwoIHRoaXMsIHZhbCwgZWxlbWVudCApICYmICJkZXBlbmRlbmN5LW1pc21hdGNoIjsKCQl9LAoKCQlzdGFydFJlcXVlc3Q6IGZ1bmN0aW9uKCBlbGVtZW50ICkgewoJCQlpZiAoICF0aGlzLnBlbmRpbmdbIGVsZW1lbnQubmFtZSBdICkgewoJCQkJdGhpcy5wZW5kaW5nUmVxdWVzdCsrOwoJCQkJdGhpcy5wZW5kaW5nWyBlbGVtZW50Lm5hbWUgXSA9IHRydWU7CgkJCX0KCQl9LAoKCQlzdG9wUmVxdWVzdDogZnVuY3Rpb24oIGVsZW1lbnQsIHZhbGlkICkgewoJCQl0aGlzLnBlbmRpbmdSZXF1ZXN0LS07CgkJCS8vIHNvbWV0aW1lcyBzeW5jaHJvbml6YXRpb24gZmFpbHMsIG1ha2Ugc3VyZSBwZW5kaW5nUmVxdWVzdCBpcyBuZXZlciA8IDAKCQkJaWYgKCB0aGlzLnBlbmRpbmdSZXF1ZXN0IDwgMCApIHsKCQkJCXRoaXMucGVuZGluZ1JlcXVlc3QgPSAwOwoJCQl9CgkJCWRlbGV0ZSB0aGlzLnBlbmRpbmdbIGVsZW1lbnQubmFtZSBdOwoJCQlpZiAoIHZhbGlkICYmIHRoaXMucGVuZGluZ1JlcXVlc3QgPT09IDAgJiYgdGhpcy5mb3JtU3VibWl0dGVkICYmIHRoaXMuZm9ybSgpICkgewoJCQkJJCggdGhpcy5jdXJyZW50Rm9ybSApLnN1Ym1pdCgpOwoJCQkJdGhpcy5mb3JtU3VibWl0dGVkID0gZmFsc2U7CgkJCX0gZWxzZSBpZiAoIXZhbGlkICYmIHRoaXMucGVuZGluZ1JlcXVlc3QgPT09IDAgJiYgdGhpcy5mb3JtU3VibWl0dGVkICkgewoJCQkJJCggdGhpcy5jdXJyZW50Rm9ybSApLnRyaWdnZXJIYW5kbGVyKCAiaW52YWxpZC1mb3JtIiwgWyB0aGlzIF0pOwoJCQkJdGhpcy5mb3JtU3VibWl0dGVkID0gZmFsc2U7CgkJCX0KCQl9LAoKCQlwcmV2aW91c1ZhbHVlOiBmdW5jdGlvbiggZWxlbWVudCApIHsKCQkJcmV0dXJuICQuZGF0YSggZWxlbWVudCwgInByZXZpb3VzVmFsdWUiICkgfHwgJC5kYXRhKCBlbGVtZW50LCAicHJldmlvdXNWYWx1ZSIsIHsKCQkJCW9sZDogbnVsbCwKCQkJCXZhbGlkOiB0cnVlLAoJCQkJbWVzc2FnZTogdGhpcy5kZWZhdWx0TWVzc2FnZSggZWxlbWVudCwgInJlbW90ZSIgKQoJCQl9KTsKCQl9CgoJfSwKCgljbGFzc1J1bGVTZXR0aW5nczogewoJCXJlcXVpcmVkOiB7IHJlcXVpcmVkOiB0cnVlIH0sCgkJZW1haWw6IHsgZW1haWw6IHRydWUgfSwKCQl1cmw6IHsgdXJsOiB0cnVlIH0sCgkJZGF0ZTogeyBkYXRlOiB0cnVlIH0sCgkJZGF0ZUlTTzogeyBkYXRlSVNPOiB0cnVlIH0sCgkJbnVtYmVyOiB7IG51bWJlcjogdHJ1ZSB9LAoJCWRpZ2l0czogeyBkaWdpdHM6IHRydWUgfSwKCQljcmVkaXRjYXJkOiB7IGNyZWRpdGNhcmQ6IHRydWUgfQoJfSwKCglhZGRDbGFzc1J1bGVzOiBmdW5jdGlvbiggY2xhc3NOYW1lLCBydWxlcyApIHsKCQlpZiAoIGNsYXNzTmFtZS5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nICkgewoJCQl0aGlzLmNsYXNzUnVsZVNldHRpbmdzWyBjbGFzc05hbWUgXSA9IHJ1bGVzOwoJCX0gZWxzZSB7CgkJCSQuZXh0ZW5kKCB0aGlzLmNsYXNzUnVsZVNldHRpbmdzLCBjbGFzc05hbWUgKTsKCQl9Cgl9LAoKCWNsYXNzUnVsZXM6IGZ1bmN0aW9uKCBlbGVtZW50ICkgewoJCXZhciBydWxlcyA9IHt9LAoJCQljbGFzc2VzID0gJCggZWxlbWVudCApLmF0dHIoICJjbGFzcyIgKTsKCgkJaWYgKCBjbGFzc2VzICkgewoJCQkkLmVhY2goIGNsYXNzZXMuc3BsaXQoICIgIiApLCBmdW5jdGlvbigpIHsKCQkJCWlmICggdGhpcyBpbiAkLnZhbGlkYXRvci5jbGFzc1J1bGVTZXR0aW5ncyApIHsKCQkJCQkkLmV4dGVuZCggcnVsZXMsICQudmFsaWRhdG9yLmNsYXNzUnVsZVNldHRpbmdzWyB0aGlzIF0pOwoJCQkJfQoJCQl9KTsKCQl9CgkJcmV0dXJuIHJ1bGVzOwoJfSwKCglhdHRyaWJ1dGVSdWxlczogZnVuY3Rpb24oIGVsZW1lbnQgKSB7CgkJdmFyIHJ1bGVzID0ge30sCgkJCSRlbGVtZW50ID0gJCggZWxlbWVudCApLAoJCQl0eXBlID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoICJ0eXBlIiApLAoJCQltZXRob2QsIHZhbHVlOwoKCQlmb3IgKCBtZXRob2QgaW4gJC52YWxpZGF0b3IubWV0aG9kcyApIHsKCgkJCS8vIHN1cHBvcnQgZm9yIDxpbnB1dCByZXF1aXJlZD4gaW4gYm90aCBodG1sNSBhbmQgb2xkZXIgYnJvd3NlcnMKCQkJaWYgKCBtZXRob2QgPT09ICJyZXF1aXJlZCIgKSB7CgkJCQl2YWx1ZSA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCBtZXRob2QgKTsKCQkJCS8vIFNvbWUgYnJvd3NlcnMgcmV0dXJuIGFuIGVtcHR5IHN0cmluZyBmb3IgdGhlIHJlcXVpcmVkIGF0dHJpYnV0ZQoJCQkJLy8gYW5kIG5vbi1IVE1MNSBicm93c2VycyBtaWdodCBoYXZlIHJlcXVpcmVkPSIiIG1hcmt1cAoJCQkJaWYgKCB2YWx1ZSA9PT0gIiIgKSB7CgkJCQkJdmFsdWUgPSB0cnVlOwoJCQkJfQoJCQkJLy8gZm9yY2Ugbm9uLUhUTUw1IGJyb3dzZXJzIHRvIHJldHVybiBib29sCgkJCQl2YWx1ZSA9ICEhdmFsdWU7CgkJCX0gZWxzZSB7CgkJCQl2YWx1ZSA9ICRlbGVtZW50LmF0dHIoIG1ldGhvZCApOwoJCQl9CgoJCQkvLyBjb252ZXJ0IHRoZSB2YWx1ZSB0byBhIG51bWJlciBmb3IgbnVtYmVyIGlucHV0cywgYW5kIGZvciB0ZXh0IGZvciBiYWNrd2FyZHMgY29tcGFiaWxpdHkKCQkJLy8gYWxsb3dzIHR5cGU9ImRhdGUiIGFuZCBvdGhlcnMgdG8gYmUgY29tcGFyZWQgYXMgc3RyaW5ncwoJCQlpZiAoIC9taW58bWF4Ly50ZXN0KCBtZXRob2QgKSAmJiAoIHR5cGUgPT09IG51bGwgfHwgL251bWJlcnxyYW5nZXx0ZXh0Ly50ZXN0KCB0eXBlICkgKSApIHsKCQkJCXZhbHVlID0gTnVtYmVyKCB2YWx1ZSApOwoJCQl9CgoJCQlpZiAoIHZhbHVlIHx8IHZhbHVlID09PSAwICkgewoJCQkJcnVsZXNbIG1ldGhvZCBdID0gdmFsdWU7CgkJCX0gZWxzZSBpZiAoIHR5cGUgPT09IG1ldGhvZCAmJiB0eXBlICE9PSAicmFuZ2UiICkgewoJCQkJLy8gZXhjZXB0aW9uOiB0aGUganF1ZXJ5IHZhbGlkYXRlICdyYW5nZScgbWV0aG9kCgkJCQkvLyBkb2VzIG5vdCB0ZXN0IGZvciB0aGUgaHRtbDUgJ3JhbmdlJyB0eXBlCgkJCQlydWxlc1sgbWV0aG9kIF0gPSB0cnVlOwoJCQl9CgkJfQoKCQkvLyBtYXhsZW5ndGggbWF5IGJlIHJldHVybmVkIGFzIC0xLCAyMTQ3NDgzNjQ3ICggSUUgKSBhbmQgNTI0Mjg4ICggc2FmYXJpICkgZm9yIHRleHQgaW5wdXRzCgkJaWYgKCBydWxlcy5tYXhsZW5ndGggJiYgLy0xfDIxNDc0ODM2NDd8NTI0Mjg4Ly50ZXN0KCBydWxlcy5tYXhsZW5ndGggKSApIHsKCQkJZGVsZXRlIHJ1bGVzLm1heGxlbmd0aDsKCQl9CgoJCXJldHVybiBydWxlczsKCX0sCgoJZGF0YVJ1bGVzOiBmdW5jdGlvbiggZWxlbWVudCApIHsKCQl2YXIgbWV0aG9kLCB2YWx1ZSwKCQkJcnVsZXMgPSB7fSwgJGVsZW1lbnQgPSAkKCBlbGVtZW50ICk7CgkJZm9yICggbWV0aG9kIGluICQudmFsaWRhdG9yLm1ldGhvZHMgKSB7CgkJCXZhbHVlID0gJGVsZW1lbnQuZGF0YSggInJ1bGUiICsgbWV0aG9kLmNoYXJBdCggMCApLnRvVXBwZXJDYXNlKCkgKyBtZXRob2Quc3Vic3RyaW5nKCAxICkudG9Mb3dlckNhc2UoKSApOwoJCQlpZiAoIHZhbHVlICE9PSB1bmRlZmluZWQgKSB7CgkJCQlydWxlc1sgbWV0aG9kIF0gPSB2YWx1ZTsKCQkJfQoJCX0KCQlyZXR1cm4gcnVsZXM7Cgl9LAoKCXN0YXRpY1J1bGVzOiBmdW5jdGlvbiggZWxlbWVudCApIHsKCQl2YXIgcnVsZXMgPSB7fSwKCQkJdmFsaWRhdG9yID0gJC5kYXRhKCBlbGVtZW50LmZvcm0sICJ2YWxpZGF0b3IiICk7CgoJCWlmICggdmFsaWRhdG9yLnNldHRpbmdzLnJ1bGVzICkgewoJCQlydWxlcyA9ICQudmFsaWRhdG9yLm5vcm1hbGl6ZVJ1bGUoIHZhbGlkYXRvci5zZXR0aW5ncy5ydWxlc1sgZWxlbWVudC5uYW1lIF0gKSB8fCB7fTsKCQl9CgkJcmV0dXJuIHJ1bGVzOwoJfSwKCglub3JtYWxpemVSdWxlczogZnVuY3Rpb24oIHJ1bGVzLCBlbGVtZW50ICkgewoJCS8vIGhhbmRsZSBkZXBlbmRlbmN5IGNoZWNrCgkJJC5lYWNoKCBydWxlcywgZnVuY3Rpb24oIHByb3AsIHZhbCApIHsKCQkJLy8gaWdub3JlIHJ1bGUgd2hlbiBwYXJhbSBpcyBleHBsaWNpdGx5IGZhbHNlLCBlZy4gcmVxdWlyZWQ6ZmFsc2UKCQkJaWYgKCB2YWwgPT09IGZhbHNlICkgewoJCQkJZGVsZXRlIHJ1bGVzWyBwcm9wIF07CgkJCQlyZXR1cm47CgkJCX0KCQkJaWYgKCB2YWwucGFyYW0gfHwgdmFsLmRlcGVuZHMgKSB7CgkJCQl2YXIga2VlcFJ1bGUgPSB0cnVlOwoJCQkJc3dpdGNoICggdHlwZW9mIHZhbC5kZXBlbmRzICkgewoJCQkJY2FzZSAic3RyaW5nIjoKCQkJCQlrZWVwUnVsZSA9ICEhJCggdmFsLmRlcGVuZHMsIGVsZW1lbnQuZm9ybSApLmxlbmd0aDsKCQkJCQlicmVhazsKCQkJCWNhc2UgImZ1bmN0aW9uIjoKCQkJCQlrZWVwUnVsZSA9IHZhbC5kZXBlbmRzLmNhbGwoIGVsZW1lbnQsIGVsZW1lbnQgKTsKCQkJCQlicmVhazsKCQkJCX0KCQkJCWlmICgga2VlcFJ1bGUgKSB7CgkJCQkJcnVsZXNbIHByb3AgXSA9IHZhbC5wYXJhbSAhPT0gdW5kZWZpbmVkID8gdmFsLnBhcmFtIDogdHJ1ZTsKCQkJCX0gZWxzZSB7CgkJCQkJZGVsZXRlIHJ1bGVzWyBwcm9wIF07CgkJCQl9CgkJCX0KCQl9KTsKCgkJLy8gZXZhbHVhdGUgcGFyYW1ldGVycwoJCSQuZWFjaCggcnVsZXMsIGZ1bmN0aW9uKCBydWxlLCBwYXJhbWV0ZXIgKSB7CgkJCXJ1bGVzWyBydWxlIF0gPSAkLmlzRnVuY3Rpb24oIHBhcmFtZXRlciApID8gcGFyYW1ldGVyKCBlbGVtZW50ICkgOiBwYXJhbWV0ZXI7CgkJfSk7CgoJCS8vIGNsZWFuIG51bWJlciBwYXJhbWV0ZXJzCgkJJC5lYWNoKFsgIm1pbmxlbmd0aCIsICJtYXhsZW5ndGgiIF0sIGZ1bmN0aW9uKCkgewoJCQlpZiAoIHJ1bGVzWyB0aGlzIF0gKSB7CgkJCQlydWxlc1sgdGhpcyBdID0gTnVtYmVyKCBydWxlc1sgdGhpcyBdICk7CgkJCX0KCQl9KTsKCQkkLmVhY2goWyAicmFuZ2VsZW5ndGgiLCAicmFuZ2UiIF0sIGZ1bmN0aW9uKCkgewoJCQl2YXIgcGFydHM7CgkJCWlmICggcnVsZXNbIHRoaXMgXSApIHsKCQkJCWlmICggJC5pc0FycmF5KCBydWxlc1sgdGhpcyBdICkgKSB7CgkJCQkJcnVsZXNbIHRoaXMgXSA9IFsgTnVtYmVyKCBydWxlc1sgdGhpcyBdWyAwIF0pLCBOdW1iZXIoIHJ1bGVzWyB0aGlzIF1bIDEgXSApIF07CgkJCQl9IGVsc2UgaWYgKCB0eXBlb2YgcnVsZXNbIHRoaXMgXSA9PT0gInN0cmluZyIgKSB7CgkJCQkJcGFydHMgPSBydWxlc1sgdGhpcyBdLnJlcGxhY2UoL1tcW1xdXS9nLCAiIiApLnNwbGl0KCAvW1xzLF0rLyApOwoJCQkJCXJ1bGVzWyB0aGlzIF0gPSBbIE51bWJlciggcGFydHNbIDAgXSksIE51bWJlciggcGFydHNbIDEgXSApIF07CgkJCQl9CgkJCX0KCQl9KTsKCgkJaWYgKCAkLnZhbGlkYXRvci5hdXRvQ3JlYXRlUmFuZ2VzICkgewoJCQkvLyBhdXRvLWNyZWF0ZSByYW5nZXMKCQkJaWYgKCBydWxlcy5taW4gIT0gbnVsbCAmJiBydWxlcy5tYXggIT0gbnVsbCApIHsKCQkJCXJ1bGVzLnJhbmdlID0gWyBydWxlcy5taW4sIHJ1bGVzLm1heCBdOwoJCQkJZGVsZXRlIHJ1bGVzLm1pbjsKCQkJCWRlbGV0ZSBydWxlcy5tYXg7CgkJCX0KCQkJaWYgKCBydWxlcy5taW5sZW5ndGggIT0gbnVsbCAmJiBydWxlcy5tYXhsZW5ndGggIT0gbnVsbCApIHsKCQkJCXJ1bGVzLnJhbmdlbGVuZ3RoID0gWyBydWxlcy5taW5sZW5ndGgsIHJ1bGVzLm1heGxlbmd0aCBdOwoJCQkJZGVsZXRlIHJ1bGVzLm1pbmxlbmd0aDsKCQkJCWRlbGV0ZSBydWxlcy5tYXhsZW5ndGg7CgkJCX0KCQl9CgoJCXJldHVybiBydWxlczsKCX0sCgoJLy8gQ29udmVydHMgYSBzaW1wbGUgc3RyaW5nIHRvIGEge3N0cmluZzogdHJ1ZX0gcnVsZSwgZS5nLiwgInJlcXVpcmVkIiB0byB7cmVxdWlyZWQ6dHJ1ZX0KCW5vcm1hbGl6ZVJ1bGU6IGZ1bmN0aW9uKCBkYXRhICkgewoJCWlmICggdHlwZW9mIGRhdGEgPT09ICJzdHJpbmciICkgewoJCQl2YXIgdHJhbnNmb3JtZWQgPSB7fTsKCQkJJC5lYWNoKCBkYXRhLnNwbGl0KCAvXHMvICksIGZ1bmN0aW9uKCkgewoJCQkJdHJhbnNmb3JtZWRbIHRoaXMgXSA9IHRydWU7CgkJCX0pOwoJCQlkYXRhID0gdHJhbnNmb3JtZWQ7CgkJfQoJCXJldHVybiBkYXRhOwoJfSwKCgkvLyBodHRwOi8vanF1ZXJ5dmFsaWRhdGlvbi5vcmcvalF1ZXJ5LnZhbGlkYXRvci5hZGRNZXRob2QvCglhZGRNZXRob2Q6IGZ1bmN0aW9uKCBuYW1lLCBtZXRob2QsIG1lc3NhZ2UgKSB7CgkJJC52YWxpZGF0b3IubWV0aG9kc1sgbmFtZSBdID0gbWV0aG9kOwoJCSQudmFsaWRhdG9yLm1lc3NhZ2VzWyBuYW1lIF0gPSBtZXNzYWdlICE9PSB1bmRlZmluZWQgPyBtZXNzYWdlIDogJC52YWxpZGF0b3IubWVzc2FnZXNbIG5hbWUgXTsKCQlpZiAoIG1ldGhvZC5sZW5ndGggPCAzICkgewoJCQkkLnZhbGlkYXRvci5hZGRDbGFzc1J1bGVzKCBuYW1lLCAkLnZhbGlkYXRvci5ub3JtYWxpemVSdWxlKCBuYW1lICkgKTsKCQl9Cgl9LAoKCW1ldGhvZHM6IHsKCgkJLy8gaHR0cDovL2pxdWVyeXZhbGlkYXRpb24ub3JnL3JlcXVpcmVkLW1ldGhvZC8KCQlyZXF1aXJlZDogZnVuY3Rpb24oIHZhbHVlLCBlbGVtZW50LCBwYXJhbSApIHsKCQkJLy8gY2hlY2sgaWYgZGVwZW5kZW5jeSBpcyBtZXQKCQkJaWYgKCAhdGhpcy5kZXBlbmQoIHBhcmFtLCBlbGVtZW50ICkgKSB7CgkJCQlyZXR1cm4gImRlcGVuZGVuY3ktbWlzbWF0Y2giOwoJCQl9CgkJCWlmICggZWxlbWVudC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSAic2VsZWN0IiApIHsKCQkJCS8vIGNvdWxkIGJlIGFuIGFycmF5IGZvciBzZWxlY3QtbXVsdGlwbGUgb3IgYSBzdHJpbmcsIGJvdGggYXJlIGZpbmUgdGhpcyB3YXkKCQkJCXZhciB2YWwgPSAkKCBlbGVtZW50ICkudmFsKCk7CgkJCQlyZXR1cm4gdmFsICYmIHZhbC5sZW5ndGggPiAwOwoJCQl9CgkJCWlmICggdGhpcy5jaGVja2FibGUoIGVsZW1lbnQgKSApIHsKCQkJCXJldHVybiB0aGlzLmdldExlbmd0aCggdmFsdWUsIGVsZW1lbnQgKSA+IDA7CgkJCX0KCQkJcmV0dXJuICQudHJpbSggdmFsdWUgKS5sZW5ndGggPiAwOwoJCX0sCgoJCS8vIGh0dHA6Ly9qcXVlcnl2YWxpZGF0aW9uLm9yZy9lbWFpbC1tZXRob2QvCgkJZW1haWw6IGZ1bmN0aW9uKCB2YWx1ZSwgZWxlbWVudCApIHsKCQkJLy8gRnJvbSBodHRwOi8vd3d3LndoYXR3Zy5vcmcvc3BlY3Mvd2ViLWFwcHMvY3VycmVudC13b3JrL211bHRpcGFnZS9zdGF0ZXMtb2YtdGhlLXR5cGUtYXR0cmlidXRlLmh0bWwjZS1tYWlsLXN0YXRlLSUyOHR5cGU9ZW1haWwlMjkKCQkJLy8gUmV0cmlldmVkIDIwMTQtMDEtMTQKCQkJLy8gSWYgeW91IGhhdmUgYSBwcm9ibGVtIHdpdGggdGhpcyBpbXBsZW1lbnRhdGlvbiwgcmVwb3J0IGEgYnVnIGFnYWluc3QgdGhlIGFib3ZlIHNwZWMKCQkJLy8gT3IgdXNlIGN1c3RvbSBtZXRob2RzIHRvIGltcGxlbWVudCB5b3VyIG93biBlbWFpbCB2YWxpZGF0aW9uCgkJCXJldHVybiB0aGlzLm9wdGlvbmFsKCBlbGVtZW50ICkgfHwgL15bYS16QS1aMC05LiEjJCUmJyorXC89P15fYHt8fX4tXStAW2EtekEtWjAtOV0oPzpbYS16QS1aMC05LV17MCw2MX1bYS16QS1aMC05XSk\/KD86XC5bYS16QS1aMC05XSg\/OlthLXpBLVowLTktXXswLDYxfVthLXpBLVowLTldKT8pKiQvLnRlc3QoIHZhbHVlICk7CgkJfSwKCgkJLy8gaHR0cDovL2pxdWVyeXZhbGlkYXRpb24ub3JnL3VybC1tZXRob2QvCgkJdXJsOiBmdW5jdGlvbiggdmFsdWUsIGVsZW1lbnQgKSB7CgkJCS8vIGNvbnRyaWJ1dGVkIGJ5IFNjb3R0IEdvbnphbGV6OiBodHRwOi8vcHJvamVjdHMuc2NvdHRzcGxheWdyb3VuZC5jb20vaXJpLwoJCQlyZXR1cm4gdGhpcy5vcHRpb25hbCggZWxlbWVudCApIHx8IC9eKGh0dHBzP3xzP2Z0cCk6XC9cLygoKChbYS16XXxcZHwtfFwufF98fnxbXHUwMEEwLVx1RDdGRlx1RjkwMC1cdUZEQ0ZcdUZERjAtXHVGRkVGXSl8KCVbXGRhLWZdezJ9KXxbIVwkJidcKFwpXCpcKyw7PV18OikqQCk\/KCgoXGR8WzEtOV1cZHwxXGRcZHwyWzAtNF1cZHwyNVswLTVdKVwuKFxkfFsxLTldXGR8MVxkXGR8MlswLTRdXGR8MjVbMC01XSlcLihcZHxbMS05XVxkfDFcZFxkfDJbMC00XVxkfDI1WzAtNV0pXC4oXGR8WzEtOV1cZHwxXGRcZHwyWzAtNF1cZHwyNVswLTVdKSl8KCgoW2Etel18XGR8W1x1MDBBMC1cdUQ3RkZcdUY5MDAtXHVGRENGXHVGREYwLVx1RkZFRl0pfCgoW2Etel18XGR8W1x1MDBBMC1cdUQ3RkZcdUY5MDAtXHVGRENGXHVGREYwLVx1RkZFRl0pKFthLXpdfFxkfC18XC58X3x+fFtcdTAwQTAtXHVEN0ZGXHVGOTAwLVx1RkRDRlx1RkRGMC1cdUZGRUZdKSooW2Etel18XGR8W1x1MDBBMC1cdUQ3RkZcdUY5MDAtXHVGRENGXHVGREYwLVx1RkZFRl0pKSlcLikrKChbYS16XXxbXHUwMEEwLVx1RDdGRlx1RjkwMC1cdUZEQ0ZcdUZERjAtXHVGRkVGXSl8KChbYS16XXxbXHUwMEEwLVx1RDdGRlx1RjkwMC1cdUZEQ0ZcdUZERjAtXHVGRkVGXSkoW2Etel18XGR8LXxcLnxffH58W1x1MDBBMC1cdUQ3RkZcdUY5MDAtXHVGRENGXHVGREYwLVx1RkZFRl0pKihbYS16XXxbXHUwMEEwLVx1RDdGRlx1RjkwMC1cdUZEQ0ZcdUZERjAtXHVGRkVGXSkpKVwuPykoOlxkKik\/KShcLygoKFthLXpdfFxkfC18XC58X3x+fFtcdTAwQTAtXHVEN0ZGXHVGOTAwLVx1RkRDRlx1RkRGMC1cdUZGRUZdKXwoJVtcZGEtZl17Mn0pfFshXCQmJ1woXClcKlwrLDs9XXw6fEApKyhcLygoW2Etel18XGR8LXxcLnxffH58W1x1MDBBMC1cdUQ3RkZcdUY5MDAtXHVGRENGXHVGREYwLVx1RkZFRl0pfCglW1xkYS1mXXsyfSl8WyFcJCYnXChcKVwqXCssOz1dfDp8QCkqKSopPyk\/KFw\/KCgoW2Etel18XGR8LXxcLnxffH58W1x1MDBBMC1cdUQ3RkZcdUY5MDAtXHVGRENGXHVGREYwLVx1RkZFRl0pfCglW1xkYS1mXXsyfSl8WyFcJCYnXChcKVwqXCssOz1dfDp8QCl8W1x1RTAwMC1cdUY4RkZdfFwvfFw\/KSopPygjKCgoW2Etel18XGR8LXxcLnxffH58W1x1MDBBMC1cdUQ3RkZcdUY5MDAtXHVGRENGXHVGREYwLVx1RkZFRl0pfCglW1xkYS1mXXsyfSl8WyFcJCYnXChcKVwqXCssOz1dfDp8QCl8XC98XD8pKik\/JC9pLnRlc3QoIHZhbHVlICk7CgkJfSwKCgkJLy8gaHR0cDovL2pxdWVyeXZhbGlkYXRpb24ub3JnL2RhdGUtbWV0aG9kLwoJCWRhdGU6IGZ1bmN0aW9uKCB2YWx1ZSwgZWxlbWVudCApIHsKCQkJcmV0dXJuIHRoaXMub3B0aW9uYWwoIGVsZW1lbnQgKSB8fCAhL0ludmFsaWR8TmFOLy50ZXN0KCBuZXcgRGF0ZSggdmFsdWUgKS50b1N0cmluZygpICk7CgkJfSwKCgkJLy8gaHR0cDovL2pxdWVyeXZhbGlkYXRpb24ub3JnL2RhdGVJU08tbWV0aG9kLwoJCWRhdGVJU086IGZ1bmN0aW9uKCB2YWx1ZSwgZWxlbWVudCApIHsKCQkJcmV0dXJuIHRoaXMub3B0aW9uYWwoIGVsZW1lbnQgKSB8fCAvXlxkezR9W1wvXC1dKDA\/WzEtOV18MVswMTJdKVtcL1wtXSgwP1sxLTldfFsxMl1bMC05XXwzWzAxXSkkLy50ZXN0KCB2YWx1ZSApOwoJCX0sCgoJCS8vIGh0dHA6Ly9qcXVlcnl2YWxpZGF0aW9uLm9yZy9udW1iZXItbWV0aG9kLwoJCW51bWJlcjogZnVuY3Rpb24oIHZhbHVlLCBlbGVtZW50ICkgewoJCQlyZXR1cm4gdGhpcy5vcHRpb25hbCggZWxlbWVudCApIHx8IC9eLT8oPzpcZCt8XGR7MSwzfSg\/OixcZHszfSkrKT8oPzpcLlxkKyk\/JC8udGVzdCggdmFsdWUgKTsKCQl9LAoKCQkvLyBodHRwOi8vanF1ZXJ5dmFsaWRhdGlvbi5vcmcvZGlnaXRzLW1ldGhvZC8KCQlkaWdpdHM6IGZ1bmN0aW9uKCB2YWx1ZSwgZWxlbWVudCApIHsKCQkJcmV0dXJuIHRoaXMub3B0aW9uYWwoIGVsZW1lbnQgKSB8fCAvXlxkKyQvLnRlc3QoIHZhbHVlICk7CgkJfSwKCgkJLy8gaHR0cDovL2pxdWVyeXZhbGlkYXRpb24ub3JnL2NyZWRpdGNhcmQtbWV0aG9kLwoJCS8vIGJhc2VkIG9uIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvTHVobi8KCQljcmVkaXRjYXJkOiBmdW5jdGlvbiggdmFsdWUsIGVsZW1lbnQgKSB7CgkJCWlmICggdGhpcy5vcHRpb25hbCggZWxlbWVudCApICkgewoJCQkJcmV0dXJuICJkZXBlbmRlbmN5LW1pc21hdGNoIjsKCQkJfQoJCQkvLyBhY2NlcHQgb25seSBzcGFjZXMsIGRpZ2l0cyBhbmQgZGFzaGVzCgkJCWlmICggL1teMC05IFwtXSsvLnRlc3QoIHZhbHVlICkgKSB7CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0KCQkJdmFyIG5DaGVjayA9IDAsCgkJCQluRGlnaXQgPSAwLAoJCQkJYkV2ZW4gPSBmYWxzZSwKCQkJCW4sIGNEaWdpdDsKCgkJCXZhbHVlID0gdmFsdWUucmVwbGFjZSggL1xEL2csICIiICk7CgoJCQkvLyBCYXNpbmcgbWluIGFuZCBtYXggbGVuZ3RoIG9uCgkJCS8vIGh0dHA6Ly9kZXZlbG9wZXIuZWFuLmNvbS9nZW5lcmFsX2luZm8vVmFsaWRfQ3JlZGl0X0NhcmRfVHlwZXMKCQkJaWYgKCB2YWx1ZS5sZW5ndGggPCAxMyB8fCB2YWx1ZS5sZW5ndGggPiAxOSApIHsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoKCQkJZm9yICggbiA9IHZhbHVlLmxlbmd0aCAtIDE7IG4gPj0gMDsgbi0tKSB7CgkJCQljRGlnaXQgPSB2YWx1ZS5jaGFyQXQoIG4gKTsKCQkJCW5EaWdpdCA9IHBhcnNlSW50KCBjRGlnaXQsIDEwICk7CgkJCQlpZiAoIGJFdmVuICkgewoJCQkJCWlmICggKCBuRGlnaXQgKj0gMiApID4gOSApIHsKCQkJCQkJbkRpZ2l0IC09IDk7CgkJCQkJfQoJCQkJfQoJCQkJbkNoZWNrICs9IG5EaWdpdDsKCQkJCWJFdmVuID0gIWJFdmVuOwoJCQl9CgoJCQlyZXR1cm4gKCBuQ2hlY2sgJSAxMCApID09PSAwOwoJCX0sCgoJCS8vIGh0dHA6Ly9qcXVlcnl2YWxpZGF0aW9uLm9yZy9taW5sZW5ndGgtbWV0aG9kLwoJCW1pbmxlbmd0aDogZnVuY3Rpb24oIHZhbHVlLCBlbGVtZW50LCBwYXJhbSApIHsKCQkJdmFyIGxlbmd0aCA9ICQuaXNBcnJheSggdmFsdWUgKSA\/IHZhbHVlLmxlbmd0aCA6IHRoaXMuZ2V0TGVuZ3RoKCB2YWx1ZSwgZWxlbWVudCApOwoJCQlyZXR1cm4gdGhpcy5vcHRpb25hbCggZWxlbWVudCApIHx8IGxlbmd0aCA+PSBwYXJhbTsKCQl9LAoKCQkvLyBodHRwOi8vanF1ZXJ5dmFsaWRhdGlvbi5vcmcvbWF4bGVuZ3RoLW1ldGhvZC8KCQltYXhsZW5ndGg6IGZ1bmN0aW9uKCB2YWx1ZSwgZWxlbWVudCwgcGFyYW0gKSB7CgkJCXZhciBsZW5ndGggPSAkLmlzQXJyYXkoIHZhbHVlICkgPyB2YWx1ZS5sZW5ndGggOiB0aGlzLmdldExlbmd0aCggdmFsdWUsIGVsZW1lbnQgKTsKCQkJcmV0dXJuIHRoaXMub3B0aW9uYWwoIGVsZW1lbnQgKSB8fCBsZW5ndGggPD0gcGFyYW07CgkJfSwKCgkJLy8gaHR0cDovL2pxdWVyeXZhbGlkYXRpb24ub3JnL3JhbmdlbGVuZ3RoLW1ldGhvZC8KCQlyYW5nZWxlbmd0aDogZnVuY3Rpb24oIHZhbHVlLCBlbGVtZW50LCBwYXJhbSApIHsKCQkJdmFyIGxlbmd0aCA9ICQuaXNBcnJheSggdmFsdWUgKSA\/IHZhbHVlLmxlbmd0aCA6IHRoaXMuZ2V0TGVuZ3RoKCB2YWx1ZSwgZWxlbWVudCApOwoJCQlyZXR1cm4gdGhpcy5vcHRpb25hbCggZWxlbWVudCApIHx8ICggbGVuZ3RoID49IHBhcmFtWyAwIF0gJiYgbGVuZ3RoIDw9IHBhcmFtWyAxIF0gKTsKCQl9LAoKCQkvLyBodHRwOi8vanF1ZXJ5dmFsaWRhdGlvbi5vcmcvbWluLW1ldGhvZC8KCQltaW46IGZ1bmN0aW9uKCB2YWx1ZSwgZWxlbWVudCwgcGFyYW0gKSB7CgkJCXJldHVybiB0aGlzLm9wdGlvbmFsKCBlbGVtZW50ICkgfHwgdmFsdWUgPj0gcGFyYW07CgkJfSwKCgkJLy8gaHR0cDovL2pxdWVyeXZhbGlkYXRpb24ub3JnL21heC1tZXRob2QvCgkJbWF4OiBmdW5jdGlvbiggdmFsdWUsIGVsZW1lbnQsIHBhcmFtICkgewoJCQlyZXR1cm4gdGhpcy5vcHRpb25hbCggZWxlbWVudCApIHx8IHZhbHVlIDw9IHBhcmFtOwoJCX0sCgoJCS8vIGh0dHA6Ly9qcXVlcnl2YWxpZGF0aW9uLm9yZy9yYW5nZS1tZXRob2QvCgkJcmFuZ2U6IGZ1bmN0aW9uKCB2YWx1ZSwgZWxlbWVudCwgcGFyYW0gKSB7CgkJCXJldHVybiB0aGlzLm9wdGlvbmFsKCBlbGVtZW50ICkgfHwgKCB2YWx1ZSA+PSBwYXJhbVsgMCBdICYmIHZhbHVlIDw9IHBhcmFtWyAxIF0gKTsKCQl9LAoKCQkvLyBodHRwOi8vanF1ZXJ5dmFsaWRhdGlvbi5vcmcvZXF1YWxUby1tZXRob2QvCgkJZXF1YWxUbzogZnVuY3Rpb24oIHZhbHVlLCBlbGVtZW50LCBwYXJhbSApIHsKCQkJLy8gYmluZCB0byB0aGUgYmx1ciBldmVudCBvZiB0aGUgdGFyZ2V0IGluIG9yZGVyIHRvIHJldmFsaWRhdGUgd2hlbmV2ZXIgdGhlIHRhcmdldCBmaWVsZCBpcyB1cGRhdGVkCgkJCS8vIFRPRE8gZmluZCBhIHdheSB0byBiaW5kIHRoZSBldmVudCBqdXN0IG9uY2UsIGF2b2lkaW5nIHRoZSB1bmJpbmQtcmViaW5kIG92ZXJoZWFkCgkJCXZhciB0YXJnZXQgPSAkKCBwYXJhbSApOwoJCQlpZiAoIHRoaXMuc2V0dGluZ3Mub25mb2N1c291dCApIHsKCQkJCXRhcmdldC51bmJpbmQoICIudmFsaWRhdGUtZXF1YWxUbyIgKS5iaW5kKCAiYmx1ci52YWxpZGF0ZS1lcXVhbFRvIiwgZnVuY3Rpb24oKSB7CgkJCQkJJCggZWxlbWVudCApLnZhbGlkKCk7CgkJCQl9KTsKCQkJfQoJCQlyZXR1cm4gdmFsdWUgPT09IHRhcmdldC52YWwoKTsKCQl9LAoKCQkvLyBodHRwOi8vanF1ZXJ5dmFsaWRhdGlvbi5vcmcvcmVtb3RlLW1ldGhvZC8KCQlyZW1vdGU6IGZ1bmN0aW9uKCB2YWx1ZSwgZWxlbWVudCwgcGFyYW0gKSB7CgkJCWlmICggdGhpcy5vcHRpb25hbCggZWxlbWVudCApICkgewoJCQkJcmV0dXJuICJkZXBlbmRlbmN5LW1pc21hdGNoIjsKCQkJfQoKCQkJdmFyIHByZXZpb3VzID0gdGhpcy5wcmV2aW91c1ZhbHVlKCBlbGVtZW50ICksCgkJCQl2YWxpZGF0b3IsIGRhdGE7CgoJCQlpZiAoIXRoaXMuc2V0dGluZ3MubWVzc2FnZXNbIGVsZW1lbnQubmFtZSBdICkgewoJCQkJdGhpcy5zZXR0aW5ncy5tZXNzYWdlc1sgZWxlbWVudC5uYW1lIF0gPSB7fTsKCQkJfQoJCQlwcmV2aW91cy5vcmlnaW5hbE1lc3NhZ2UgPSB0aGlzLnNldHRpbmdzLm1lc3NhZ2VzWyBlbGVtZW50Lm5hbWUgXS5yZW1vdGU7CgkJCXRoaXMuc2V0dGluZ3MubWVzc2FnZXNbIGVsZW1lbnQubmFtZSBdLnJlbW90ZSA9IHByZXZpb3VzLm1lc3NhZ2U7CgoJCQlwYXJhbSA9IHR5cGVvZiBwYXJhbSA9PT0gInN0cmluZyIgJiYgeyB1cmw6IHBhcmFtIH0gfHwgcGFyYW07CgoJCQlpZiAoIHByZXZpb3VzLm9sZCA9PT0gdmFsdWUgKSB7CgkJCQlyZXR1cm4gcHJldmlvdXMudmFsaWQ7CgkJCX0KCgkJCXByZXZpb3VzLm9sZCA9IHZhbHVlOwoJCQl2YWxpZGF0b3IgPSB0aGlzOwoJCQl0aGlzLnN0YXJ0UmVxdWVzdCggZWxlbWVudCApOwoJCQlkYXRhID0ge307CgkJCWRhdGFbIGVsZW1lbnQubmFtZSBdID0gdmFsdWU7CgkJCSQuYWpheCggJC5leHRlbmQoIHRydWUsIHsKCQkJCXVybDogcGFyYW0sCgkJCQltb2RlOiAiYWJvcnQiLAoJCQkJcG9ydDogInZhbGlkYXRlIiArIGVsZW1lbnQubmFtZSwKCQkJCWRhdGFUeXBlOiAianNvbiIsCgkJCQlkYXRhOiBkYXRhLAoJCQkJY29udGV4dDogdmFsaWRhdG9yLmN1cnJlbnRGb3JtLAoJCQkJc3VjY2VzczogZnVuY3Rpb24oIHJlc3BvbnNlICkgewoJCQkJCXZhciB2YWxpZCA9IHJlc3BvbnNlID09PSB0cnVlIHx8IHJlc3BvbnNlID09PSAidHJ1ZSIsCgkJCQkJCWVycm9ycywgbWVzc2FnZSwgc3VibWl0dGVkOwoKCQkJCQl2YWxpZGF0b3Iuc2V0dGluZ3MubWVzc2FnZXNbIGVsZW1lbnQubmFtZSBdLnJlbW90ZSA9IHByZXZpb3VzLm9yaWdpbmFsTWVzc2FnZTsKCQkJCQlpZiAoIHZhbGlkICkgewoJCQkJCQlzdWJtaXR0ZWQgPSB2YWxpZGF0b3IuZm9ybVN1Ym1pdHRlZDsKCQkJCQkJdmFsaWRhdG9yLnByZXBhcmVFbGVtZW50KCBlbGVtZW50ICk7CgkJCQkJCXZhbGlkYXRvci5mb3JtU3VibWl0dGVkID0gc3VibWl0dGVkOwoJCQkJCQl2YWxpZGF0b3Iuc3VjY2Vzc0xpc3QucHVzaCggZWxlbWVudCApOwoJCQkJCQlkZWxldGUgdmFsaWRhdG9yLmludmFsaWRbIGVsZW1lbnQubmFtZSBdOwoJCQkJCQl2YWxpZGF0b3Iuc2hvd0Vycm9ycygpOwoJCQkJCX0gZWxzZSB7CgkJCQkJCWVycm9ycyA9IHt9OwoJCQkJCQltZXNzYWdlID0gcmVzcG9uc2UgfHwgdmFsaWRhdG9yLmRlZmF1bHRNZXNzYWdlKCBlbGVtZW50LCAicmVtb3RlIiApOwoJCQkJCQllcnJvcnNbIGVsZW1lbnQubmFtZSBdID0gcHJldmlvdXMubWVzc2FnZSA9ICQuaXNGdW5jdGlvbiggbWVzc2FnZSApID8gbWVzc2FnZSggdmFsdWUgKSA6IG1lc3NhZ2U7CgkJCQkJCXZhbGlkYXRvci5pbnZhbGlkWyBlbGVtZW50Lm5hbWUgXSA9IHRydWU7CgkJCQkJCXZhbGlkYXRvci5zaG93RXJyb3JzKCBlcnJvcnMgKTsKCQkJCQl9CgkJCQkJcHJldmlvdXMudmFsaWQgPSB2YWxpZDsKCQkJCQl2YWxpZGF0b3Iuc3RvcFJlcXVlc3QoIGVsZW1lbnQsIHZhbGlkICk7CgkJCQl9CgkJCX0sIHBhcmFtICkgKTsKCQkJcmV0dXJuICJwZW5kaW5nIjsKCQl9CgoJfQoKfSk7CgokLmZvcm1hdCA9IGZ1bmN0aW9uIGRlcHJlY2F0ZWQoKSB7Cgl0aHJvdyAiJC5mb3JtYXQgaGFzIGJlZW4gZGVwcmVjYXRlZC4gUGxlYXNlIHVzZSAkLnZhbGlkYXRvci5mb3JtYXQgaW5zdGVhZC4iOwp9OwoKLy8gYWpheCBtb2RlOiBhYm9ydAovLyB1c2FnZTogJC5hamF4KHsgbW9kZTogImFib3J0IlssIHBvcnQ6ICJ1bmlxdWVwb3J0Il19KTsKLy8gaWYgbW9kZToiYWJvcnQiIGlzIHVzZWQsIHRoZSBwcmV2aW91cyByZXF1ZXN0IG9uIHRoYXQgcG9ydCAocG9ydCBjYW4gYmUgdW5kZWZpbmVkKSBpcyBhYm9ydGVkIHZpYSBYTUxIdHRwUmVxdWVzdC5hYm9ydCgpCgp2YXIgcGVuZGluZ1JlcXVlc3RzID0ge30sCglhamF4OwovLyBVc2UgYSBwcmVmaWx0ZXIgaWYgYXZhaWxhYmxlICgxLjUrKQppZiAoICQuYWpheFByZWZpbHRlciApIHsKCSQuYWpheFByZWZpbHRlcihmdW5jdGlvbiggc2V0dGluZ3MsIF8sIHhociApIHsKCQl2YXIgcG9ydCA9IHNldHRpbmdzLnBvcnQ7CgkJaWYgKCBzZXR0aW5ncy5tb2RlID09PSAiYWJvcnQiICkgewoJCQlpZiAoIHBlbmRpbmdSZXF1ZXN0c1twb3J0XSApIHsKCQkJCXBlbmRpbmdSZXF1ZXN0c1twb3J0XS5hYm9ydCgpOwoJCQl9CgkJCXBlbmRpbmdSZXF1ZXN0c1twb3J0XSA9IHhocjsKCQl9Cgl9KTsKfSBlbHNlIHsKCS8vIFByb3h5IGFqYXgKCWFqYXggPSAkLmFqYXg7CgkkLmFqYXggPSBmdW5jdGlvbiggc2V0dGluZ3MgKSB7CgkJdmFyIG1vZGUgPSAoICJtb2RlIiBpbiBzZXR0aW5ncyA\/IHNldHRpbmdzIDogJC5hamF4U2V0dGluZ3MgKS5tb2RlLAoJCQlwb3J0ID0gKCAicG9ydCIgaW4gc2V0dGluZ3MgPyBzZXR0aW5ncyA6ICQuYWpheFNldHRpbmdzICkucG9ydDsKCQlpZiAoIG1vZGUgPT09ICJhYm9ydCIgKSB7CgkJCWlmICggcGVuZGluZ1JlcXVlc3RzW3BvcnRdICkgewoJCQkJcGVuZGluZ1JlcXVlc3RzW3BvcnRdLmFib3J0KCk7CgkJCX0KCQkJcGVuZGluZ1JlcXVlc3RzW3BvcnRdID0gYWpheC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoJCQlyZXR1cm4gcGVuZGluZ1JlcXVlc3RzW3BvcnRdOwoJCX0KCQlyZXR1cm4gYWpheC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoJfTsKfQoKLy8gcHJvdmlkZXMgZGVsZWdhdGUodHlwZTogU3RyaW5nLCBkZWxlZ2F0ZTogU2VsZWN0b3IsIGhhbmRsZXI6IENhbGxiYWNrKSBwbHVnaW4gZm9yIGVhc2llciBldmVudCBkZWxlZ2F0aW9uCi8vIGhhbmRsZXIgaXMgb25seSBjYWxsZWQgd2hlbiAkKGV2ZW50LnRhcmdldCkuaXMoZGVsZWdhdGUpLCBpbiB0aGUgc2NvcGUgb2YgdGhlIGpxdWVyeS1vYmplY3QgZm9yIGV2ZW50LnRhcmdldAoKJC5leHRlbmQoJC5mbiwgewoJdmFsaWRhdGVEZWxlZ2F0ZTogZnVuY3Rpb24oIGRlbGVnYXRlLCB0eXBlLCBoYW5kbGVyICkgewoJCXJldHVybiB0aGlzLmJpbmQodHlwZSwgZnVuY3Rpb24oIGV2ZW50ICkgewoJCQl2YXIgdGFyZ2V0ID0gJChldmVudC50YXJnZXQpOwoJCQlpZiAoIHRhcmdldC5pcyhkZWxlZ2F0ZSkgKSB7CgkJCQlyZXR1cm4gaGFuZGxlci5hcHBseSh0YXJnZXQsIGFyZ3VtZW50cyk7CgkJCX0KCQl9KTsKCX0KfSk7Cgp9KSk7",
    "size": "42696"
}