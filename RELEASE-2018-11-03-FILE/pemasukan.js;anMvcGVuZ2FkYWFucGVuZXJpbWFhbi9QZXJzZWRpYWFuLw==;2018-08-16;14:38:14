{
    "namaFile": "js\/pengadaanpenerimaan\/Persediaan\/pemasukan.js",
    "lastUpdate": "2018-08-16+14:38:14.73",
    "contentFile": "ZnVuY3Rpb24gUGVyYmFydWlfRGF0YSgpew0KCXBlbWFzdWthbi5yZWZyZXNoTGlzdCh0cnVlKTsNCn0NCg0KdmFyIHBlbWFzdWthblNLUEQgPSBuZXcgU2twZENscyh7DQoJcHJlZml4IDogJ3BlbWFzdWthblNLUEQnLCBmb3JtTmFtZToncGVtYXN1a2FuRm9ybScsIGtvbG9tV2lkdGg6MTIwLA0KCQ0KCXBpbGloQmlkYW5nQWZ0ZXIgOiBmdW5jdGlvbigpe3BlbWFzdWthbi5yZWZyZXNoTGlzdCh0cnVlKTt9LA0KCXBpbGloVW5pdEFmdGVyIDogZnVuY3Rpb24oKXtwZW1hc3VrYW4ucmVmcmVzaExpc3QodHJ1ZSk7fSwNCglwaWxpaFN1YlVuaXRBZnRlciA6IGZ1bmN0aW9uKCl7cGVtYXN1a2FuLnJlZnJlc2hMaXN0KHRydWUpO30sDQoJcGlsaWhTZWtzaUFmdGVyIDogZnVuY3Rpb24oKXtwZW1hc3VrYW4ucmVmcmVzaExpc3QodHJ1ZSk7fQ0KfSk7DQoNCnZhciBwZW1hc3VrYW5TS1BEMiA9IG5ldyBTa3BkQ2xzKHsNCglwcmVmaXggOiAncGVtYXN1a2FuU0tQRDInLCANCglmb3JtTmFtZTogJ3BlbWFzdWthbkZvcm0nLA0KCQ0KCXBpbGloVXJ1c2FuZnRlciA6IGZ1bmN0aW9uKCl7cGVtYXN1a2FuLnJlZnJlc2hMaXN0KHRydWUpO30sDQoJcGlsaWhCaWRhbmdBZnRlciA6IGZ1bmN0aW9uKCl7cGVtYXN1a2FuLnJlZnJlc2hMaXN0KHRydWUpO30sDQoJcGlsaWhVbml0QWZ0ZXIgOiBmdW5jdGlvbigpe3BlbWFzdWthbi5yZWZyZXNoTGlzdCh0cnVlKTt9LA0KCXBpbGloU3ViVW5pdEFmdGVyIDogZnVuY3Rpb24oKXtwZW1hc3VrYW4ucmVmcmVzaExpc3QodHJ1ZSk7fSwNCglwaWxpaFNla3NpQWZ0ZXIgOiBmdW5jdGlvbigpe3BlbWFzdWthbi5yZWZyZXNoTGlzdCh0cnVlKTt9DQp9KTsNCg0KdmFyIHBlbWFzdWthbiA9IG5ldyBEYWZ0YXJPYmoyKHsNCglwcmVmaXggOiAncGVtYXN1a2FuJywNCgl1cmwgOiAncGFnZXMucGhwP1BnPXBlbWFzdWthbicsIA0KCWZvcm1OYW1lIDogJ3BlbWFzdWthbkZvcm0nLA0KCXNhdHVhbl9mb3JtIDogJzAnLC8vZGVmYXVsdCBqcyBzYXR1YW4NCglKTUxfUE9TVElORyA6IDAsDQoJQlRMX1BPU1RJTkcgOiAwLA0KCWptbFNldFBPU1QgCTogMCwNCglEYXJpVmFsaWRhc2kgOiAwLA0KCVN0YXR1c1Bvc3RpbmcgOiAwLA0KCVBPU1RfVHJhY2sxIDogMCwNCglQT1NUX1RyYWNrMiA6IDAsDQoJUE9TVF9UcmFjazMgOiAwLA0KCVBPU1RfVHJhY2s0IDogMCwNCglBZGFZYW5nVGFueWEgOiAwLA0KCUFqYXhUaW1lX1RyYWNrMSA6ICIiLA0KCUFqYXhUaW1lX1RyYWNrMiA6ICIiLA0KCUFqYXhUaW1lX1RyYWNrMyA6ICIiLA0KCUFqYXhUaW1lX1RyYWNrNCA6ICIiLA0KCVdha3R1VGVyYWtoaXIgOiAwLA0KCUVzdGltYXNpV2FrdHVueWEgOiAwLA0KCUJhbmRpbmdXYWt0dSA6IDAsDQoJbG9hZGluZzogZnVuY3Rpb24oKXsNCgkJLy9hbGVydCgnbG9hZGluZycpOw0KCQl0aGlzLnRvcEJhclJlbmRlcigpOw0KCQl0aGlzLmZpbHRlclJlbmRlcigpOw0KCQl0aGlzLmRhZnRhclJlbmRlcigpOw0KCQl0aGlzLnN1bUhhbFJlbmRlcigpOw0KCQ0KCX0sDQoJDQoJU2V0X1Bvc3RUcmFjayA6IGZ1bmN0aW9uKCl7DQoJCWlmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJqbWxfYnJnX25leHRQT1NUIikpew0KCQkJSm1sQnJnID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImptbF9icmdfbmV4dFBPU1QiKS52YWx1ZTsNCgkJCUptbEJyZyA9IHBhcnNlSW50KEptbEJyZyk7DQoJCQlpZihKbWxCcmcgPiAxMDAgJiYgSm1sQnJnIDw9NTAwKXsNCgkJCQlkYXRhID0gMjsNCgkJCX1lbHNlIGlmKEptbEJyZyA+IDUwMCAmJiBKbWxCcmcgPD0xMDAwKXsNCgkJCQlkYXRhID0gMzsNCgkJCX1lbHNlIGlmKEptbEJyZyA+IDEwMDApew0KCQkJCWRhdGEgPSA0Ow0KCQkJfWVsc2V7DQoJCQkJZGF0YSA9IDE7DQoJCQl9DQoJCX1lbHNlew0KCQkJZGF0YSA9IDE7DQoJCX0NCgkJCQ0KCQkNCgkJcmV0dXJuIGRhdGE7DQoJfSwNCgkNCglDZWtfUE9TVF9UcmFjayA6IGZ1bmN0aW9uKCl7DQoJCXZhciBtZT10aGlzOw0KCQl2YXIgcG9zdCA9IDA7DQoJCWlmKHBvc3QgPT0gMCAmJiBtZS5QT1NUX1RyYWNrMT09MSlwb3N0PTE7DQoJCWlmKHBvc3QgPT0gMCAmJiBtZS5QT1NUX1RyYWNrMj09MSlwb3N0PTE7DQoJCWlmKHBvc3QgPT0gMCAmJiBtZS5QT1NUX1RyYWNrMz09MSlwb3N0PTE7DQoJCWlmKHBvc3QgPT0gMCAmJiBtZS5QT1NUX1RyYWNrND09MSlwb3N0PTE7DQoJCQ0KCQlyZXR1cm4gcG9zdDsJCQ0KCX0sDQoJDQoJU2V0X1BPU1RfVHJhY2sgOiBmdW5jdGlvbih0cmFjaywgaXNpKXsNCgkJdmFyIG1lPXRoaXM7DQoJCXN3aXRjaCh0cmFjayl7DQoJCQljYXNlIDIgOiBtZS5QT1NUX1RyYWNrMj1pc2k7YnJlYWs7DQoJCQljYXNlIDMgOiBtZS5QT1NUX1RyYWNrMz1pc2k7YnJlYWs7DQoJCQljYXNlIDQgOiBtZS5QT1NUX1RyYWNrND1pc2k7YnJlYWs7DQoJCQlkZWZhdWx0OiBtZS5QT1NUX1RyYWNrMT1pc2k7YnJlYWs7DQoJCX0JDQoJfSwNCgkNCglmaWx0ZXJSZW5kZXJBZnRlciA6IGZ1bmN0aW9uKCl7DQoJCXZhciBtZSA9IHRoaXM7DQoJCURhdGFQZW5nYXR1cmFuLm55YWxha2FuZGF0ZXBpY2tlcjIoKTsJCQ0KCX0sDQoJDQoJU2V0TmFtYTogZnVuY3Rpb24ocGlsaWhhbil7DQoJCQl2YXIgbWU9dGhpczsNCgkJCSQuYWpheCh7DQoJCQkJdHlwZTonUE9TVCcsIA0KCQkJCWRhdGE6JCgnIycrdGhpcy5wcmVmaXgrJ19mb3JtX1RURCcpLnNlcmlhbGl6ZSgpLA0KCQkJCXVybDogdGhpcy51cmwrJyZ0aXBlPVNldE5hbWEmcGlsaWhhbj0nK3BpbGloYW4sDQoJCQkgIAlzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7CQkNCgkJCQkJdmFyIHJlc3AgPSBldmFsKCcoJyArIGRhdGEgKyAnKScpOw0KCQkJCQlpZihyZXNwLmVycj09Jycpew0KCQkJCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25pcF8nK3BpbGloYW4pLnZhbHVlPXJlc3AuY29udGVudC5uaXA7DQoJCQkJCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFuZ2thdF8nK3BpbGloYW4pLnZhbHVlPXJlc3AuY29udGVudC5wYW5na2F0Ow0KCQkJCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2VzZWxvbl8nK3BpbGloYW4pLnZhbHVlPXJlc3AuY29udGVudC5lc2Vsb247DQoJCQkJCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnamFiYXRhbl8nK3BpbGloYW4pLnZhbHVlPXJlc3AuY29udGVudC5qYWJhdGFuOw0KCQkJCQl9ZWxzZXsNCgkJCQkJCWFsZXJ0KHJlc3AuZXJyKTsNCgkJCQkJfQ0KCQkJICAJfSwNCgkJCQllcnJvcjogZnVuY3Rpb24gKHhociwgYWpheE9wdGlvbnMsIHRocm93bkVycm9yKSB7DQoJCQkJCW1lLlNldE5hbWEocGlsaWhhbik7DQoJCSAgICAJfQ0KCQkJfSk7CQ0KCX0sCQ0KCQ0KCWRldGFpbDogZnVuY3Rpb24oKXsNCgkJLy9hbGVydCgnZGV0YWlsJyk7DQoJCXZhciBtZSA9IHRoaXM7DQoJCWVycm1zZyA9IHRoaXMuQ2VrQ2hlY2tib3goKTsNCgkJaWYoZXJybXNnID09JycpeyANCgkJCXZhciBib3ggPSB0aGlzLkdldENieENoZWNrZWQoKTsJCQkNCgkJCS8vVXNlckFrdGl2aXRhc0RldC5nZW5EZXRhaWwoKTsJCQkNCgkJCQ0KCQl9ZWxzZXsNCgkJDQoJCQlhbGVydChlcnJtc2cpOw0KCQl9DQoJCQ0KCX0sDQoJDQoJSW5wdXRCYXJ1OiBmdW5jdGlvbigpew0KCQl2YXIgbWUgPSB0aGlzOw0KCQl2YXIgY292ZXIxID0gdGhpcy5wcmVmaXgrJ19mb3JtY292ZXInOw0KCQlkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93PSdoaWRkZW4nOw0KCQlhZGRDb3ZlclBhZ2UyKGNvdmVyMSwxLHRydWUsZmFsc2UpOw0KCQkkLmFqYXgoew0KCQkJdHlwZTonUE9TVCcsIA0KCQkJZGF0YTokKCcjJyt0aGlzLmZvcm1OYW1lKS5zZXJpYWxpemUoKSwNCgkJCXVybDogdGhpcy51cmwrJyZ0aXBlPWZvcm1CYXJ1JywNCgkJICAJc3VjY2VzczogZnVuY3Rpb24oZGF0YSkgewkJDQoJCQkJdmFyIHJlc3AgPSBldmFsKCcoJyArIGRhdGEgKyAnKScpOwkNCgkJCQlkZWxFbGVtKGNvdmVyMSk7DQoJCQkJZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdz0nYXV0byc7DQoJCQkJLy9kb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb3ZlcikuaW5uZXJIVE1MID0gcmVzcC5jb250ZW50Ow0KCQkJCWlmKHJlc3AuZXJyPT0nJyl7DQoJCQkJCXZhciBhRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHBlbWFzdWthbi5mb3JtTmFtZSk7CQkNCgkJCQkJYUZvcm0uYWN0aW9uPSBtZS51cmwrJ19pbnMmWU49MSc7Ly8nP09wPScrb3ArJyZQZz0yJmlkcHJzPWNldGFrX2hhbCc7CQkNCgkJCQkJYUZvcm0udGFyZ2V0PSdfYmxhbmsnOw0KCQkJCQlhRm9ybS5zdWJtaXQoKTsJDQoJCQkJCWFGb3JtLnRhcmdldD0nJzsNCgkJCQl9ZWxzZXsNCgkJCQkJYWxlcnQocmVzcC5lcnIpOw0KCQkJCX0NCgkJICAJfQ0KCQl9KTsNCgl9LA0KCQ0KCVR1dHVwRm9ybTpmdW5jdGlvbihjb3Zlcil7DQoJCWlmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvdmVyKSkgZGVsRWxlbShjb3Zlcik7CQkJCQkNCgl9LA0KCQ0KCUxhcG9yYW46IGZ1bmN0aW9uKCl7DQoJCXZhciBtZT10aGlzOw0KCQkNCgkJcGVtYXN1a2FuX2JhcnUuZm9ybU5hbWUgPSBtZS5mb3JtTmFtZTsNCgkJcGVtYXN1a2FuX2JhcnUubm1fcHJlZml4ID0gbWUucHJlZml4Ow0KCQlwZW1hc3VrYW5fYmFydS5MYXBvcmFuX0FmdGVyMj0gZnVuY3Rpb24oKXsJCQkNCgkJCXZhciBhID0gdGhpczsJCQkJDQoJCX07CQ0KCQlwZW1hc3VrYW5fYmFydS5MYXBvcmFuKCk7DQoJfSwNCgkNCgkvKkxhcG9yYW46IGZ1bmN0aW9uKCl7DQoJdmFyIG1lID0gdGhpczsNCgkNCgkJc2twZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2ZXJfc2twZCcpLnZhbHVlIDsNCgkJLy9lcnJtc2cgPSB0aGlzLkNla0NoZWNrYm94KCk7DQoJCWVycm1zZyA9ICcnOw0KCQkvL2lmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2ZXJfc2twZCcpLnZhbHVlID09IDEpew0KCQkJYzFuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BlbWFzdWthblNLUEQyZm1VUlVTQU4nKTsNCgkJCWNuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BlbWFzdWthblNLUEQyZm1TS1BEJyk7DQoJCQlkbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwZW1hc3VrYW5TS1BEMmZtVU5JVCcpOw0KCQkJZW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGVtYXN1a2FuU0tQRDJmbVNVQlVOSVQnKTsNCgkJCWUxbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwZW1hc3VrYW5TS1BEMmZtU0VLU0knKTsNCgkJLyp9ZWxzZXsNCgkJCWMxbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwZW1hc3VrYW5TS1BEZm1VcnVzYW4nKTsNCgkJCWNuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BlbWFzdWthblNLUERmbVNLUEQnKTsNCgkJCWRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BlbWFzdWthblNLUERmbVVOSVQnKTsNCgkJCWVuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BlbWFzdWthblNLUERmbVNVQlVOSVQnKTsNCgkJCWUxbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwZW1hc3VrYW5TS1BEZm1TRUtTSScpOw0KCQl9Ki8NCgkvKgkNCgkJaWYoYzFuICE9ICcnICYmIHNrcGQgIT0gMSl7DQoJCQlpZihlcnJtc2cgPT0gJycgJiYgYzFuLnZhbHVlID09ICcwJyllcnJtc2cgPSAiVVJVU0FOIEJlbHVtIGRpIFBpbGloICEgIjsNCgkJfQ0KCQlpZihlcnJtc2cgPT0gJycgJiYgY24udmFsdWUgPT0gJzAwJyllcnJtc2cgPSAiQklEQU5HIEJlbHVtIGRpIFBpbGloICEgIjsNCgkJaWYoZXJybXNnID09ICcnICYmIGRuLnZhbHVlID09ICcwMCcpZXJybXNnID0gIlNLUEQgQmVsdW0gZGkgUGlsaWggISAiOw0KCQlpZihlcnJtc2cgPT0gJycgJiYgZW4udmFsdWUgPT0gJzAwJyllcnJtc2cgPSAiVU5JVCBCZWx1bSBkaSBQaWxpaCAhICI7DQoJCWlmKGVycm1zZyA9PSAnJyAmJiBlMW4udmFsdWUgPT0gJzAwMCcpZXJybXNnID0gIlNVQiBVTklUIEJlbHVtIGRpIFBpbGloICEgIjsNCgkJDQoJCWVycm1zZyA9ICcnOw0KCQlpZihlcnJtc2cgPT0nJyl7IA0KCQkJLy92YXIgYm94ID0gdGhpcy5HZXRDYnhDaGVja2VkKCk7DQoJCQkNCgkJCS8vYWxlcnQoYm94LnZhbHVlKTsNCgkJCQkJDQoJCQl2YXIgY292ZXIgPSB0aGlzLnByZWZpeCsnX2Zvcm1jb3Zlcic7DQoJCQlkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93PSdoaWRkZW4nOw0KCQkJYWRkQ292ZXJQYWdlMihjb3ZlciwxLHRydWUsZmFsc2UpOw0KCQkJDQoJCQkkLmFqYXgoew0KCQkJCXR5cGU6J1BPU1QnLCANCgkJCQlkYXRhOiQoJyMnK3RoaXMuZm9ybU5hbWUpLnNlcmlhbGl6ZSgpLA0KCQkJICAJdXJsOiB0aGlzLnVybCsnJnRpcGU9QnVhdExhcG9yYW4nLA0KCQkJICAJc3VjY2VzczogZnVuY3Rpb24oZGF0YSkgewkJDQoJCQkJCXZhciByZXNwID0gZXZhbCgnKCcgKyBkYXRhICsgJyknKTsNCgkJCQkJaWYocmVzcC5lcnIgPT0gJycpew0KCQkJCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY292ZXIpLmlubmVySFRNTCA9IHJlc3AuY29udGVudDsNCgkJCQkJCXBlbWFzdWthbl9pbnMubnlhbGFrYW5kYXRlcGlja2VyKCk7DQoJCQkJCX1lbHNlew0KCQkJCQkJYWxlcnQocmVzcC5lcnIpOw0KCQkJCQkJbWUuQ2xvc2UoKTsNCgkJCQkJfQkJCQ0KCQkJCQkNCgkJCQkJLy9zZXRUaW1lb3V0KGZ1bmN0aW9uIG15RnVuY3Rpb24oKSB7cGVtYXN1a2FuLmphbSgpfSwxMDApOwkNCgkJCQkJLy9tZS5BZnRlckZvcm1CYXJ1KCk7DQoJCQkgIAl9DQoJCQl9KTsNCgkJCQ0KCQkJDQoJCQkNCgkJfWVsc2V7DQoJCQkJYWxlcnQoZXJybXNnKTsNCgkJfQkNCgl9LCovDQoJDQoJTGFwb3JhblRURDogZnVuY3Rpb24oKXsNCgkJdmFyIG1lID0gdGhpczsNCgkJCQkJCQ0KCQkJdmFyIGNvdmVyID0gdGhpcy5wcmVmaXgrJ19mb3JtY292ZXJfVFREJzsNCgkJCWRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3c9J2hpZGRlbic7DQoJCQlhZGRDb3ZlclBhZ2UyKGNvdmVyLDIsdHJ1ZSxmYWxzZSk7DQoJCQkNCgkJCSQuYWpheCh7DQoJCQkJdHlwZTonUE9TVCcsIA0KCQkJCWRhdGE6JCgnIycrdGhpcy5wcmVmaXgrJ19mb3JtJykuc2VyaWFsaXplKCksDQoJCQkgIAl1cmw6IHRoaXMudXJsKycmdGlwZT1MYXBvcmFuVFREJywNCgkJCSAgCXN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHsJCQ0KCQkJCQl2YXIgcmVzcCA9IGV2YWwoJygnICsgZGF0YSArICcpJyk7DQoJCQkJCWlmKHJlc3AuZXJyID09ICcnKXsNCgkJCQkJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvdmVyKS5pbm5lckhUTUwgPSByZXNwLmNvbnRlbnQ7DQoJCQkJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uIG15RnVuY3Rpb24oKSB7cGVtYXN1a2FuLlNldE5hbWEoJ3BlbmVyaW1hJyk7fSwxMDApOw0KCQkJCQkJc2V0VGltZW91dChmdW5jdGlvbiBteUZ1bmN0aW9uKCkge3BlbWFzdWthbi5TZXROYW1hKCdtZW5nZXRhaHVpJyk7fSwxMDApOw0KCQkJCQl9ZWxzZXsNCgkJCQkJCWFsZXJ0KHJlc3AuZXJyKTsNCgkJCQkJCW1lLkNsb3NlKCk7DQoJCQkJCX0JCQkNCgkJCQkJDQoJCQkJCS8vc2V0VGltZW91dChmdW5jdGlvbiBteUZ1bmN0aW9uKCkge3BlbWFzdWthbi5qYW0oKX0sMTAwKTsJDQoJCQkJCS8vbWUuQWZ0ZXJGb3JtQmFydSgpOw0KCQkJICAJfQ0KCQkJfSk7DQoJCQkNCgkJCQ0KCX0sDQoJDQoJDQoJDQoJZGFmdGFyUmVuZGVyOmZ1bmN0aW9uKCl7DQoJCXZhciBtZSA9dGhpczsgLy9yZW5kZXIgZGFmdGFyIA0KCQlhZGRDb3ZlclBhZ2UyKA0KCQkJJ2RhZnRhcl9jb3ZlcicsCTEsIAl0cnVlLCB0cnVlLAl7cmVuZGVyVG86IHRoaXMucHJlZml4KydfY29udF9kYWZ0YXInLA0KCQkJaW1nc3JjOiAnaW1hZ2VzL3dhaXQuZ2lmJywNCgkJCXN0eWxlOiB7cG9zaXRpb246J2Fic29sdXRlJywgdG9wOic1JywgbGVmdDonNSd9DQoJCQl9DQoJCSk7DQoJCSQuYWpheCh7DQoJCSAgCXVybDogdGhpcy51cmwrJyZ0aXBlPWRhZnRhcicsDQoJCSAJdHlwZTonUE9TVCcsIA0KCQkJZGF0YTokKCcjJyt0aGlzLmZvcm1OYW1lKS5zZXJpYWxpemUoKSwgDQoJCSAgCXN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHsJCQ0KCQkJCXZhciByZXNwID0gZXZhbCgnKCcgKyBkYXRhICsgJyknKTsNCgkJCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZChtZS5wcmVmaXgrJ19jb250X2RhZnRhcicpLmlubmVySFRNTCA9IHJlc3AuY29udGVudDsNCgkJCQltZS5zdW1IYWxSZW5kZXIoKTsNCgkJICAJfQ0KCQl9KTsNCgl9LA0KCVZhbGlkYXNpOmZ1bmN0aW9uKGRhdGFueWE9MCl7DQoJCXZhciBtZSA9IHRoaXM7DQoJCWVycm1zZyA9IHRoaXMuQ2VrQ2hlY2tib3goKTsNCgkJbWUuRGFyaVZhbGlkYXNpID0gZGF0YW55YTsNCgkJaWYoZXJybXNnID09JycpeyANCgkJCXZhciBib3ggPSB0aGlzLkdldENieENoZWNrZWQoKTsNCgkJCQ0KCQkJdmFyIGNvdmVyID0gdGhpcy5wcmVmaXgrJ19mb3JtY292ZXJfdmFsaWRhc2knOw0KCQkJZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdz0naGlkZGVuJzsNCgkJCWlmKG1lLnNhdHVhbl9mb3JtPT0wKXsvL2JhcnUgZGFyaSBzYXR1YW4NCgkJCQlhZGRDb3ZlclBhZ2UyKGNvdmVyLDEsdHJ1ZSxmYWxzZSk7CQ0KCQkJfWVsc2V7Ly9iYXJ1IGRhcmkgYmFyYW5nDQoJCQkJYWRkQ292ZXJQYWdlMihjb3Zlciw5OTksdHJ1ZSxmYWxzZSk7CQ0KCQkJfQ0KCQkJJC5hamF4KHsNCgkJCQl0eXBlOidQT1NUJywgDQoJCQkJZGF0YTokKCcjJyt0aGlzLmZvcm1OYW1lKS5zZXJpYWxpemUoKSwNCgkJCSAgCXVybDogdGhpcy51cmwrJyZ0aXBlPVZhbGlkYXNpJywNCgkJCSAgCXN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHsJCQ0KCQkJCQl2YXIgcmVzcCA9IGV2YWwoJygnICsgZGF0YSArICcpJyk7DQoJCQkJCWlmKHJlc3AuZXJyID09ICcnKXsNCgkJCQkJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvdmVyKS5pbm5lckhUTUwgPSByZXNwLmNvbnRlbnQ7DQoJCQkJCX1lbHNlew0KCQkJCQkJYWxlcnQocmVzcC5lcnIpOw0KCQkJCQkJZGVsRWxlbShjb3Zlcik7DQoJCQkJCQlkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93PSdhdXRvJzsNCgkJCQkJfQkJDQoJCQkgIAl9DQoJCQl9KTsNCgkJfWVsc2V7DQoJCQlhbGVydChlcnJtc2cpOw0KCQl9DQoJCQ0KCX0sDQoJDQoJamFtOiBmdW5jdGlvbiAoKSB7DQoJICB2YXIgZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0Z2xfdmFsaWRhc2knKSwNCgkgIGQgPSBuZXcgRGF0ZSgpLCBoLCBtLCBzOw0KCSAgaCA9IGQuZ2V0SG91cnMoKTsNCgkgIG0gPSBwZW1hc3VrYW4uc2V0SmFtKGQuZ2V0TWludXRlcygpKTsNCgkgIHMgPSBwZW1hc3VrYW4uc2V0SmFtKGQuZ2V0U2Vjb25kcygpKTsNCgkgIA0KCSAgDQoJICBoYXJpID0gZC5nZXREYXRlKCk7DQoJICBidWxhbiA9IGQuZ2V0TW9udGgoKTsNCgkgIHl5ID0gZC5nZXRZZWFyKCk7DQoJICB2YXIgVGFodW4gPSAoeXkgPCAxMDAwKSA\/IHl5ICsgMTkwMCA6IHl5Ow0KCSAgYnVsYW4gPSBidWxhbiArIDE7DQoJICBibG4gPSBidWxhbi50b1N0cmluZygpDQoJICBpZihibG4ubGVuZ3RoID09IDEpYmxuID0gIjAiK2JsbjsNCgkNCgkgIGUudmFsdWUgPSBoYXJpICsgJy0nKyBibG4gKyAnLScrIFRhaHVuICsiICIrIGggKyc6JysgbSArJzonKyBzOw0KCQ0KCSAgDQoJICBzZXRUaW1lb3V0KGZ1bmN0aW9uIG15RnVuY3Rpb24oKSB7cGVtYXN1a2FuLmphbSgpfSwxMDAwKTsNCgkgfSwNCgkNCgkgc2V0SmFtOiBmdW5jdGlvbiAoZSkgew0KCSAgCWUgPSBlIDwgMTAgPyAnMCcrIGUgOiBlOw0KCSAgCXJldHVybiBlOw0KCSB9LA0KCQ0KCUVkaXQ6ZnVuY3Rpb24oKXsNCgkJdmFyIG1lID0gdGhpczsNCgkJZXJybXNnID0gdGhpcy5DZWtDaGVja2JveCgpOw0KCQlpZihlcnJtc2cgPT0nJyl7IA0KCQkJdmFyIGJveCA9IHRoaXMuR2V0Q2J4Q2hlY2tlZCgpOw0KCQkJdmFyIGNvdmVyMSA9IHRoaXMucHJlZml4KydfZm9ybVViYWhjb3ZlcjInOw0KCQkJZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdz0naGlkZGVuJzsNCgkJCWFkZENvdmVyUGFnZTIoY292ZXIxLDEsdHJ1ZSxmYWxzZSk7DQoJCQkkLmFqYXgoew0KCQkJCXR5cGU6J1BPU1QnLCANCgkJCQlkYXRhOiQoJyMnK3RoaXMuZm9ybU5hbWUpLnNlcmlhbGl6ZSgpLA0KCQkJCXVybDogdGhpcy51cmwrJyZ0aXBlPVBlbmdlY2VrYW5VYmFoJkNla1ViYWg9MScsDQoJCQkgIAlzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7CQkNCgkJCQkJdmFyIHJlc3AgPSBldmFsKCcoJyArIGRhdGEgKyAnKScpOwkNCgkJCQkJZGVsRWxlbShjb3ZlcjEpOw0KCQkJCQlkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93PSdhdXRvJzsNCgkJCQkJLy9kb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb3ZlcikuaW5uZXJIVE1MID0gcmVzcC5jb250ZW50Ow0KCQkJCQlpZihyZXNwLmVycj09Jycpew0KCQkJCQkJdmFyIGFGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocGVtYXN1a2FuLmZvcm1OYW1lKTsJCQ0KCQkJCQkJYUZvcm0uYWN0aW9uPSBwZW1hc3VrYW4udXJsKydfaW5zJllOPTInOy8vJz9PcD0nK29wKycmUGc9MiZpZHBycz1jZXRha19oYWwnOwkJDQoJCQkJCQlhRm9ybS50YXJnZXQ9J19ibGFuayc7DQoJCQkJCQlhRm9ybS5zdWJtaXQoKTsJDQoJCQkJCQlhRm9ybS50YXJnZXQ9Jyc7DQoJCQkJCX1lbHNlew0KCQkJCQkJYWxlcnQocmVzcC5lcnIpOw0KCQkJCQl9DQoJCQkgIAl9DQoJCQl9KTsNCgkJCQ0KCQkJDQoJCX1lbHNlew0KCQkJYWxlcnQoZXJybXNnKTsNCgkJfQ0KCQkNCgl9LA0KCQkNCglTaW1wYW46IGZ1bmN0aW9uKCl7DQoJCXZhciBtZT0gdGhpczsJDQoJCXRoaXMuT25FcnJvckNsb3NlID0gZmFsc2UJDQoJCWRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3c9J2hpZGRlbic7DQoJCXZhciBjb3ZlciA9IHRoaXMucHJlZml4KydfZm9ybWNvdmVyX3NpbXBhbnZhbGlkYXNpJzsNCgkJYWRkQ292ZXJQYWdlMihjb3ZlciwxLHRydWUsZmFsc2UpOwkNCgkJLyp0aGlzLnNlbmRSZXEoDQoJCQl0aGlzLnVybCwNCgkJCXsgaWRwcnM6IDAsIGRhZnRhclByb3NlczogbmV3IEFycmF5KCdzaW1wYW4nKX0sDQoJCQl0aGlzLmZvcm1EaWFsb2cpOyovDQoJCSQuYWpheCh7DQoJCQl0eXBlOidQT1NUJywgDQoJCQlkYXRhOiQoJyMnK3RoaXMucHJlZml4KydfZm9ybScpLnNlcmlhbGl6ZSgpLA0KCQkJdXJsOiB0aGlzLnVybCsnJnRpcGU9c2ltcGFuJywNCgkJICAJc3VjY2VzczogZnVuY3Rpb24oZGF0YSkgewkJDQoJCQkJdmFyIHJlc3AgPSBldmFsKCcoJyArIGRhdGEgKyAnKScpOwkJCQ0KCQkJCS8vZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY292ZXIpLmlubmVySFRNTCA9IHJlc3AuY29udGVudDsNCgkJCQlkZWxFbGVtKGNvdmVyKTsNCgkJCQlpZihyZXNwLmVycj09JycpewkJCQkJDQoJCQkJCWFsZXJ0KHJlc3AuY29udGVudC5hbGVydCk7CQ0KCQkJCQltZS5DbG9zZVZhbGlkYXNpKCk7DQoJCQkJCXBlbWFzdWthbi5yZWZyZXNoTGlzdCgpOw0KCQkJCX1lbHNlew0KCQkJCQlhbGVydChyZXNwLmVycik7DQoJCQkJfQ0KCQkgIAl9DQoJCX0pOw0KCX0sDQoJDQoJQ2V0YWtQZXJtb2hvbmFuOiBmdW5jdGlvbihpZG55YSwgRm9ybW55YT0ncGVtYXN1a2FuX2luc0Zvcm0nKXsNCgkNCgkJCQkNCgkJCXZhciBhRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKEZvcm1ueWEpOwkJDQoJCQlhRm9ybS5hY3Rpb249IHRoaXMudXJsKycmdGlwZT1DZXRha1Blcm1vaG9uYW4maWRueWE9JytpZG55YTsvLyc\/T3A9JytvcCsnJlBnPTImaWRwcnM9Y2V0YWtfaGFsJzsJCQ0KCQkJYUZvcm0udGFyZ2V0PSdfYmxhbmsnOw0KCQkJYUZvcm0uc3VibWl0KCk7CQ0KCQkJYUZvcm0udGFyZ2V0PScnOw0KCX0sDQoJDQoJaGVhZGVyVGFiZWw6IGZ1bmN0aW9uKCl7DQoJCXZhciB0YXJnZXQgPSAkKCcjaGVhZGVyLWZpeCcpOw0KCQl2YXIgZGl2X3Bvc2l0aW9uID0gdGFyZ2V0Lm9mZnNldCgpLnRvcDsNCgkJDQoJCSQod2luZG93KS5zY3JvbGwoZnVuY3Rpb24oKSB7IA0KCQkgICAgdmFyIHlfcG9zaXRpb24gPSAkKHdpbmRvdykuc2Nyb2xsVG9wKCk7DQoJCSAgICBpZih5X3Bvc2l0aW9uID4gZGl2X3Bvc2l0aW9uKSB7DQoJCSAgICAgICAgdGFyZ2V0LmFkZENsYXNzKCd0ZXRhcGRpYXRhcycpOw0KCQkgICAgfQ0KCQkgICAgZWxzZSB7DQoJCSAgICAgICAgdGFyZ2V0LnJlbW92ZUNsYXNzKCd0ZXRhcGRpYXRhcycpOw0KCQkgICAgfQ0KCQl9KTsNCgkJCQ0KCX0sDQoJDQoJRGlzdHJpYnVzaWthbjogZnVuY3Rpb24oSWRUZXJpbWEsIElkVGVyaW1hX2RldCxjbHM9MSl7DQoJCXZhciBhRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwZW1hc3VrYW5Gb3JtJyk7CQkNCgkJCWFGb3JtLmFjdGlvbj0gdGhpcy51cmwrJ19kaXN0cmlidXNpJmlkVGVyaW1hX255YT0nK0lkVGVyaW1hKycmaWRUZXJpbWFfZGV0X255YT0nK0lkVGVyaW1hX2RldCsnJmNscz0nK2NsczsNCgkJCWFGb3JtLnRhcmdldD0nX2JsYW5rJzsNCgkJCWFGb3JtLnN1Ym1pdCgpOwkNCgkJCWFGb3JtLnRhcmdldD0nJzsNCgl9LA0KCQ0KCUthcGl0YWxpc2FzaWthbjogZnVuY3Rpb24oSWRUZXJpbWEsIElkVGVyaW1hX2RldCl7DQoJCQkkLmFqYXgoew0KCQkJCXR5cGU6J1BPU1QnLCANCgkJCQlkYXRhOiQoJyMnK3RoaXMuZm9ybU5hbWUpLnNlcmlhbGl6ZSgpLA0KCQkJCXVybDogdGhpcy51cmwrJyZ0aXBlPVBlbmdlY2VrYW5LYXBpdGFsaXNhc2kmSWRUZXJpbWFueWE9JytJZFRlcmltYSwNCgkJCSAgCXN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHsJCQ0KCQkJCQl2YXIgcmVzcCA9IGV2YWwoJygnICsgZGF0YSArICcpJyk7DQoJCQkJCWlmKHJlc3AuZXJyPT0nJyl7DQoJCQkJCQlwZW1hc3VrYW4uTXVsYWlLYXBpdGFsaXNhc2koSWRUZXJpbWEsIElkVGVyaW1hX2RldCk7CQkJCQkJDQoJCQkJCX1lbHNlew0KCQkJCQkJYWxlcnQocmVzcC5lcnIpOw0KCQkJCQl9DQoJCQkgIAl9DQoJCQl9KTsNCgkJCQ0KCX0sDQoJDQoJTXVsYWlLYXBpdGFsaXNhc2k6IGZ1bmN0aW9uKElkVGVyaW1hLCBJZFRlcmltYV9kZXQpew0KCQl2YXIgYUZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGVtYXN1a2FuRm9ybScpOwkJDQoJCWFGb3JtLmFjdGlvbj0gdGhpcy51cmwrJ19rYXBpdGFsaXNhc2kmaWRUZXJpbWFfbnlhPScrSWRUZXJpbWErJyZpZFRlcmltYV9kZXRfbnlhPScrSWRUZXJpbWFfZGV0Ow0KCQlhRm9ybS50YXJnZXQ9J19ibGFuayc7DQoJCWFGb3JtLnN1Ym1pdCgpOwkNCgkJYUZvcm0udGFyZ2V0PScnOw0KCX0sDQoJDQoJQXRyaWJ1c2lCYXJ1OiBmdW5jdGlvbigpew0KCQl2YXIgbWUgPSB0aGlzOw0KCQllcnJtc2cgPSB0aGlzLkNla0NoZWNrYm94KCk7DQoJCWlmKGVycm1zZyA9PSdEYXRhIGJlbHVtIGRpcGlsaWghJyl7DQoJCQl2YXIgY292ZXIxID0gdGhpcy5wcmVmaXgrJ19mb3JtQXRyY292ZXInOw0KCQkJZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdz0naGlkZGVuJzsNCgkJCWFkZENvdmVyUGFnZTIoY292ZXIxLDEsdHJ1ZSxmYWxzZSk7DQoJCQkkLmFqYXgoew0KCQkJCXR5cGU6J1BPU1QnLCANCgkJCQlkYXRhOiQoJyMnK3RoaXMuZm9ybU5hbWUpLnNlcmlhbGl6ZSgpLA0KCQkJCXVybDogdGhpcy51cmwrJyZ0aXBlPUF0cmlidXNpQmFydScsDQoJCQkgIAlzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7CQkNCgkJCQkJdmFyIHJlc3AgPSBldmFsKCcoJyArIGRhdGEgKyAnKScpOw0KCQkJCQlkZWxFbGVtKGNvdmVyMSk7DQoJCQkJCWRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3c9J2F1dG8nOw0KCQkJCQlpZihyZXNwLmVycj09Jycpew0KCQkJCQkJdmFyIGFGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobWUuZm9ybU5hbWUpOwkJDQoJCQkJCQlhRm9ybS5hY3Rpb249IG1lLnVybCsnX2F0cmlidXNpJllOPTEnOy8vJz9PcD0nK29wKycmUGc9MiZpZHBycz1jZXRha19oYWwnOwkJDQoJCQkJCQlhRm9ybS50YXJnZXQ9J19ibGFuayc7DQoJCQkJCQlhRm9ybS5zdWJtaXQoKTsJDQoJCQkJCQlhRm9ybS50YXJnZXQ9Jyc7DQoJCQkJCX1lbHNlew0KCQkJCQkJYWxlcnQocmVzcC5lcnIpOw0KCQkJCQl9DQoJCQkgIAl9DQoJCQl9KTsNCgkJfWVsc2UgaWYoZXJybXNnID09ICJQaWxpaCBIYW55YSBTYXR1IERhdGEhIil7DQoJCQlhbGVydChlcnJtc2cpOw0KCQl9ZWxzZXsNCgkJCXZhciBjb3ZlcjEgPSB0aGlzLnByZWZpeCsnX2Zvcm1BdHJjb3ZlcjInOw0KCQkJZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdz0naGlkZGVuJzsNCgkJCWFkZENvdmVyUGFnZTIoY292ZXIxLDEsdHJ1ZSxmYWxzZSk7DQoJCQkkLmFqYXgoew0KCQkJCXR5cGU6J1BPU1QnLCANCgkJCQlkYXRhOiQoJyMnK3RoaXMuZm9ybU5hbWUpLnNlcmlhbGl6ZSgpLA0KCQkJCXVybDogdGhpcy51cmwrJyZ0aXBlPVBlbmdlY2VrYW5VYmFoJmF0cmliPVknLA0KCQkJICAJc3VjY2VzczogZnVuY3Rpb24oZGF0YSkgewkJDQoJCQkJCXZhciByZXNwID0gZXZhbCgnKCcgKyBkYXRhICsgJyknKTsNCgkJCQkJZGVsRWxlbShjb3ZlcjEpOw0KCQkJCQlkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93PSdhdXRvJzsNCgkJCQkJaWYocmVzcC5lcnI9PScnKXsNCgkJCQkJCXZhciBhRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHBlbWFzdWthbi5mb3JtTmFtZSk7CQkNCgkJCQkJCWFGb3JtLmFjdGlvbj0gcGVtYXN1a2FuLnVybCsnX2F0cmlidXNpJllOPTInOy8vJz9PcD0nK29wKycmUGc9MiZpZHBycz1jZXRha19oYWwnOwkJDQoJCQkJCQlhRm9ybS50YXJnZXQ9J19ibGFuayc7DQoJCQkJCQlhRm9ybS5zdWJtaXQoKTsJDQoJCQkJCQlhRm9ybS50YXJnZXQ9Jyc7DQoJCQkJCX1lbHNlew0KCQkJCQkJYWxlcnQocmVzcC5lcnIpOw0KCQkJCQl9DQoJCQkgIAl9DQoJCQl9KTsNCgkJCQ0KCQl9CQ0KCX0sDQoJDQoJUG9zdGluZzpmdW5jdGlvbigpew0KCQl2YXIgbWUgPSB0aGlzOw0KCQllcnJtc2cgPSB0aGlzLkNla0NoZWNrYm94KCk7DQoJCWlmKGVycm1zZyA9PScnKXsgDQoJCQl2YXIgYm94ID0gdGhpcy5HZXRDYnhDaGVja2VkKCk7DQoJCQkNCgkJCS8vdGhpcy5TaG93ICgnZm9ybWVkaXQnLHtpZHBsaDpib3gudmFsdWV9LCBmYWxzZSwgdHJ1ZSk7CQkJDQoJCQl2YXIgY292ZXIgPSB0aGlzLnByZWZpeCsnX2Zvcm1jb3Zlcic7DQoJCQlhZGRDb3ZlclBhZ2UyKGNvdmVyLDEsdHJ1ZSxmYWxzZSk7CQ0KCQkJZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdz0naGlkZGVuJzsNCgkJCSQuYWpheCh7DQoJCQkJdHlwZTonUE9TVCcsIA0KCQkJCWRhdGE6JCgnIycrdGhpcy5mb3JtTmFtZSkuc2VyaWFsaXplKCksDQoJCQkJdXJsOiB0aGlzLnVybCsnJnRpcGU9Zm9ybVBvc3RpbmcnLA0KCQkJICAJc3VjY2VzczogZnVuY3Rpb24oZGF0YSkgewkJDQoJCQkJCXZhciByZXNwID0gZXZhbCgnKCcgKyBkYXRhICsgJyknKTsJDQoJCQkJCWlmIChyZXNwLmVyciA9PScnKXsJCQ0KCQkJCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY292ZXIpLmlubmVySFRNTCA9IHJlc3AuY29udGVudDsNCgkJCQkJCQ0KCQkJCQl9ZWxzZXsNCgkJCQkJCWFsZXJ0KHJlc3AuZXJyKTsNCgkJCQkJCWRlbEVsZW0oY292ZXIpOw0KCQkJCQkJZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdz0nYXV0byc7DQoJCQkJCX0NCgkJCSAgCX0NCgkJCX0pOw0KCQl9ZWxzZXsNCgkJCWFsZXJ0KGVycm1zZyk7DQoJCX0NCgkJDQoJfSwNCgkNCglmdW5jdGlvbl9wZXJzZW5hbjogZnVuY3Rpb24ocGVyc2VuKXsNCgkJaWYoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInN0YXR1c3R4dCIpKWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzdGF0dXN0eHQiKS5zdHlsZS53aWR0aCA9IHBlcnNlbisiJSI7IA0KCQlpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic3RhdHVzdHh0IikpZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInN0YXR1c3R4dCIpLmlubmVySFRNTCA9IHBlcnNlbisiJSI7DQoJfSwNCgkNCglQcm9zZXNQb3N0aW5nUGVyc2VkaWFhbl9BZnRlcjogZnVuY3Rpb24oa29udGVuKXsNCgkJdmFyIG1lPXRoaXM7DQoJCW1lLmZ1bmN0aW9uX3BlcnNlbmFuKGtvbnRlbi5wZXJzZW5hbik7DQoJCWlmKGtvbnRlbi5sYW5qdXQgPT0gMSl7DQoJCQltZS5Qcm9zZXNQb3N0aW5nUGVyc2VkaWFhbihrb250ZW4ubXVsYWkpOw0KCQl9ZWxzZXsNCgkJCW1lLlByb3Nlc1Bvc3RpbmdQZXJzZWRpYWFuX1NlbGVzYWkoKTsNCgkJfQ0KCX0sDQoJDQoJUHJvc2VzUG9zdGluZ1BlcnNlZGlhYW5fU2VsZXNhaTogZnVuY3Rpb24oKXsNCgkJdmFyIG1lPSB0aGlzOwkNCgkJZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdz0naGlkZGVuJzsNCgkJdmFyIGNvdmVyID0gdGhpcy5wcmVmaXgrJ19mb3JtcHN0aW5nJzsNCgkJYWRkQ292ZXJQYWdlMihjb3ZlciwxLHRydWUsZmFsc2UpOw0KCQkkLmFqYXgoew0KCQkJdHlwZTonUE9TVCcsIA0KCQkJZGF0YTokKCcjJyt0aGlzLnByZWZpeCsnX2Zvcm0nKS5zZXJpYWxpemUoKSwNCgkJCXVybDogdGhpcy51cmwrJyZ0aXBlPVByb3Nlc1Bvc3RpbmdQZXJzZWRpYWFuX1NlbGVzYWknLA0KCQkgIAlzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7CQkNCgkJCQl2YXIgcmVzcCA9IGV2YWwoJygnICsgZGF0YSArICcpJyk7CQ0KCQkJCWRlbEVsZW0oY292ZXIpOwkNCgkJCQlkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93PSdhdXRvJzsJDQoJCQkJaWYocmVzcC5lcnI9PScnKXsNCgkJCQkJYWxlcnQoIkRhdGEgQmVyaGFzaWwgRGkgUG9zdGluZyAhIik7DQoJCQkJCW1lLkNsb3NlKCk7DQoJCQkJCW1lLnJlZnJlc2hMaXN0KHRydWUpOw0KCQkJCX1lbHNlew0KCQkJCQlhbGVydChyZXNwLmVycik7DQoJCQkJfQ0KCQkgIAl9DQoJCX0pOw0KCX0sDQoJDQoJUHJvc2VzUG9zdGluZ1BlcnNlZGlhYW46IGZ1bmN0aW9uKG11bGFpKXsNCgkJdmFyIG1lPSB0aGlzOwkNCgkJZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdz0naGlkZGVuJzsNCgkJdmFyIGNvdmVyID0gdGhpcy5wcmVmaXgrJ19mb3JtcHN0aW5nJzsNCgkJYWRkQ292ZXJQYWdlMihjb3ZlciwxLHRydWUsZmFsc2UpOw0KCQkkLmFqYXgoew0KCQkJdHlwZTonUE9TVCcsIA0KCQkJZGF0YTokKCcjJyt0aGlzLnByZWZpeCsnX2Zvcm0nKS5zZXJpYWxpemUoKSwNCgkJCXVybDogdGhpcy51cmwrJyZ0aXBlPVByb3Nlc1Bvc3RpbmdQZXJzZWRpYWFuJm11bGFpPScrbXVsYWksDQoJCSAgCXN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHsJCQ0KCQkJCXZhciByZXNwID0gZXZhbCgnKCcgKyBkYXRhICsgJyknKTsJDQoJCQkJZGVsRWxlbShjb3Zlcik7CQkNCgkJCQlpZihyZXNwLmVycj09Jycpew0KCQkJCQltZS5Qcm9zZXNQb3N0aW5nUGVyc2VkaWFhbl9BZnRlcihyZXNwLmNvbnRlbnQpOw0KCQkJCX1lbHNlew0KCQkJCQlhbGVydChyZXNwLmVycik7DQoJCQkJfQ0KCQkgIAl9DQoJCX0pOw0KCX0sDQoJDQoJSGFwdXNQb3N0aW5nUGVyc2VkaWFhbl9TZWxlc2FpOiBmdW5jdGlvbigpew0KCQl2YXIgbWU9IHRoaXM7CQ0KCQlkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93PSdoaWRkZW4nOw0KCQl2YXIgY292ZXIgPSB0aGlzLnByZWZpeCsnX2Zvcm1kZWwnOw0KCQlhZGRDb3ZlclBhZ2UyKGNvdmVyLDEsdHJ1ZSxmYWxzZSk7DQoJCSQuYWpheCh7DQoJCQl0eXBlOidQT1NUJywgDQoJCQlkYXRhOiQoJyMnK3RoaXMucHJlZml4KydfZm9ybScpLnNlcmlhbGl6ZSgpLA0KCQkJdXJsOiB0aGlzLnVybCsnJnRpcGU9SGFwdXNQb3N0aW5nUGVyc2VkaWFhbl9TZWxlc2FpJywNCgkJICAJc3VjY2VzczogZnVuY3Rpb24oZGF0YSkgewkJDQoJCQkJdmFyIHJlc3AgPSBldmFsKCcoJyArIGRhdGEgKyAnKScpOwkNCgkJCQlkZWxFbGVtKGNvdmVyKTsJCQ0KCQkJCWRlbEVsZW0oInBlbWFzdWthbl9mb3JtY292ZXJfbG9hZCIpOwkJDQoJCQkJZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdz0nYXV0byc7DQoJCQkJaWYocmVzcC5lcnI9PScnKXsNCgkJCQkJYWxlcnQoIkJlcmhhc2lsIE1lbWJhdGFsa2FuIFBvc3RpbmcgISIpOw0KCQkJCQltZS5DbG9zZSgpOw0KCQkJCQltZS5yZWZyZXNoTGlzdCh0cnVlKTsNCgkJCQl9ZWxzZXsNCgkJCQkJYWxlcnQocmVzcC5lcnIpOw0KCQkJCX0NCgkJICAJfQ0KCQl9KTsJDQoJfSwNCgkNCglIYXB1c1Bvc3RpbmdQZXJzZWRpYWFuX0FmdGVyOiBmdW5jdGlvbihrb250ZW4pew0KCQl2YXIgbWU9dGhpczsNCgkJbWUuZnVuY3Rpb25fcGVyc2VuYW4oa29udGVuLnBlcnNlbmFuKTsNCgkJaWYoa29udGVuLmxhbmp1dCA9PSAxKXsNCgkJCW1lLkhhcHVzUG9zdGluZ1BlcnNlZGlhYW4oMTAwKTsNCgkJfWVsc2V7DQoJCQltZS5IYXB1c1Bvc3RpbmdQZXJzZWRpYWFuX1NlbGVzYWkoKTsNCgkJfQkJDQoJfSwNCgkNCglIYXB1c1Bvc3RpbmdQZXJzZWRpYWFuOiBmdW5jdGlvbihMaW1pdCl7DQoJCXZhciBtZT0gdGhpczsJDQoJCWRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3c9J2hpZGRlbic7DQoJCXZhciBjb3ZlciA9IHRoaXMucHJlZml4KydfZm9ybXBvc3RpbmcnOw0KCQlhZGRDb3ZlclBhZ2UyKGNvdmVyLDEsdHJ1ZSxmYWxzZSk7DQoJCSQuYWpheCh7DQoJCQl0eXBlOidQT1NUJywgDQoJCQlkYXRhOiQoJyMnK3RoaXMucHJlZml4KydfZm9ybScpLnNlcmlhbGl6ZSgpLA0KCQkJdXJsOiB0aGlzLnVybCsnJnRpcGU9SGFwdXNQb3N0aW5nUGVyc2VkaWFhbiZMaW1pdD0nK0xpbWl0LA0KCQkgIAlzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7CQkNCgkJCQl2YXIgcmVzcCA9IGV2YWwoJygnICsgZGF0YSArICcpJyk7CQ0KCQkJCWRlbEVsZW0oY292ZXIpOwkNCgkJCQlpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGVtYXN1a2FuX2Zvcm1jb3Zlcl9sb2FkIikpZGVsRWxlbSgicGVtYXN1a2FuX2Zvcm1jb3Zlcl9sb2FkIik7CQ0KCQkJCWlmKHJlc3AuZXJyPT0nJyl7DQoJCQkJCW1lLkhhcHVzUG9zdGluZ1BlcnNlZGlhYW5fQWZ0ZXIocmVzcC5jb250ZW50KTsNCgkJCQl9ZWxzZXsNCgkJCQkJYWxlcnQocmVzcC5lcnIpOw0KCQkJCX0NCgkJICAJfSwNCgkJCWVycm9yOiBmdW5jdGlvbiAoeGhyLCBhamF4T3B0aW9ucywgdGhyb3duRXJyb3IpIHsNCgkJCQltZS5IYXB1c1Bvc3RpbmdQZXJzZWRpYWFuKExpbWl0KTsNCgkgICAgCX0JCQkNCgkJfSk7CQ0KCX0sDQoJDQoJU2ltcGFuUG9zdGluZzogZnVuY3Rpb24oKXsNCgkJdmFyIG1lPSB0aGlzOwkNCgkJDQoJCXRvdF9qbWxiYXJhbmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG90X2ptbGJhcmFuZycpLnZhbHVlOw0KCQl2YXIgY292ZXIxID0gdGhpcy5wcmVmaXgrJ19mb3JtTXVsYWlwb3N0aW5nMSc7DQoJCWFkZENvdmVyUGFnZTIoY292ZXIxLDEsdHJ1ZSxmYWxzZSk7DQoJCQkJDQoJCSQuYWpheCh7DQoJCQl0eXBlOidQT1NUJywgDQoJCQlkYXRhOiQoJyMnK3RoaXMucHJlZml4KyJfZm9ybSIpLnNlcmlhbGl6ZSgpLA0KCQkJdXJsOiB0aGlzLnVybCsnJnRpcGU9UGVuZ2VjZWthblBvc3RpbmcnLA0KCQkgIAlzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7CQkNCgkJCQl2YXIgcmVzcCA9IGV2YWwoJygnICsgZGF0YSArICcpJyk7DQoJCQkJZGVsRWxlbShjb3ZlcjEpOw0KCQkJCWlmKHJlc3AuZXJyPT0nJyl7DQoJCQkJCWlmKHJlc3AuY29udGVudC5rb25maXJtYXNpKXsNCgkJCQkJCWlmKHJlc3AuY29udGVudC5Ob1Bvc3Rpbmcpew0KCQkJCQkJCWFsZXJ0KHJlc3AuY29udGVudC5rb25maXJtYXNpKTsNCgkJCQkJCX1lbHNlew0KCQkJCQkJCWtvbmYgPSBjb25maXJtKHJlc3AuY29udGVudC5rb25maXJtYXNpKTsNCgkJCQkJCQlpZihrb25mID09IHRydWUpew0KCQkJCQkJCQlpZighcmVzcC5jb250ZW50LmVycil7DQoJCQkJCQkJCQl2YXIgY292ZXIgPSAncGVtYXN1a2FuX2Zvcm1jb3Zlcl9sb2FkJzsNCgkJCQkJCQkJCWFkZENvdmVyUGFnZTIoY292ZXIsMSx0cnVlLGZhbHNlKTsJDQoJCQkJCQkJCQlkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93PSdoaWRkZW4nOw0KCQkJCQkJCQkJc3dpdGNoKHJlc3AuY29udGVudC5qbnNfdHJhbnMpew0KCQkJCQkJCQkJCWNhc2UgIjEiOg0KCQkJCQkJCQkJCQltZS5TdGF0dXNQb3N0aW5nID0gMTsNCgkJCQkJCQkJCQkJaWYocmVzcC5jb250ZW50LmtvbmZpcm1hc2kgPT0gIkJhdGFsa2FuIFBvc3RpbmcgRGF0YSA\/Iil7DQoJCQkJCQkJCQkJCQlkZWxFbGVtKGNvdmVyKTsNCgkJCQkJCQkJCQkJCW1lLkJUTF9QT1NUSU5HPTA7DQoJCQkJCQkJCQkJCQlzdG9wd2F0Y2gubmFtZSA9ICJUdWtUaW1lciI7DQoJCQkJCQkJCQkJCQlzdG9wd2F0Y2guTXVsYWkoKTsNCgkJCQkJCQkJCQkJCW1lLkhhcHVzUG9zdGluZ19QZW5nYWRhYW4oKTsNCgkJCQkJCQkJCQkJfWVsc2V7DQoJCQkJCQkJCQkJCQlpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaWRiYXJhbmdueWFfMCcpKXsNCgkJCQkJCQkJCQkJCQlpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiam1sX2JyZ19uZXh0UE9TVCIpKW1lLmptbFNldFBPU1QgPSBwYXJzZUludChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiam1sX2JyZ19uZXh0UE9TVCIpLnZhbHVlKTsJCQkJCQkNCgkJCQkJCQkJCQkJCQltZS5KTUxfUE9TVElORz0wOw0KCQkJCQkJCQkJCQkJCW1lLkFkYVlhbmdUYW55YT0wOw0KCQkJCQkJCQkJCQkJCUphbHVyUG9zdCA9IG1lLlNldF9Qb3N0VHJhY2soKTsNCgkJCQkJCQkJCQkJCQlzdG9wd2F0Y2gubmFtZSA9ICJUdWtUaW1lciI7DQoJCQkJCQkJCQkJCQkJc3RvcHdhdGNoLk11bGFpKCk7DQoJCQkJCQkJCQkJCQkJaWYoSmFsdXJQb3N0ID4gMSAmJiBKYWx1clBvc3QgPCA1KXsNCgkJCQkJCQkJCQkJCQkJZm9yKGk9MTtpPD1KYWx1clBvc3Q7aSsrKXsNCgkJCQkJCQkJCQkJCQkJCW1lLlByb3Nlc1Bvc3RpbmdfUGVuZ2FkYWFuKDAsaSk7DQoJCQkJCQkJCQkJCQkJCX0NCgkJCQkJCQkJCQkJCQl9ZWxzZXsNCgkJCQkJCQkJCQkJCQkJbWUuUHJvc2VzUG9zdGluZ19QZW5nYWRhYW4oMCwxKTsNCgkJCQkJCQkJCQkJCQl9CQ0KCQkJCQkJCQkJCQkJCQ0KCQkJCQkJCQkJCQkJfQ0KCQkJCQkJCQkJCQl9DQoJCQkJCQkJCQkJYnJlYWs7DQoJCQkJCQkJCQkJY2FzZSAiMiI6DQoJCQkJCQkJCQkJCWlmKHJlc3AuY29udGVudC5rb25maXJtYXNpID09ICJCYXRhbGthbiBQb3N0aW5nIERhdGEgPyIpew0KCQkJCQkJCQkJCQkJbWUuSGFwdXNQb3N0aW5nX1BlbWVsaWhhcmFhbigpOw0KCQkJCQkJCQkJCQl9ZWxzZXsNCgkJCQkJCQkJCQkJCWlmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpZEtQVExTXzAnKSltZS5Qcm9zZXNQb3N0aW5nUGVtZWxpaGFyYWFuKDAsIDAsIDApOw0KCQkJCQkJCQkJCQl9DQoJCQkJCQkJCQkJYnJlYWs7DQoJCQkJCQkJCQkJY2FzZSAiMyI6DQoJCQkJCQkJCQkJCWlmKHJlc3AuY29udGVudC5rb25maXJtYXNpID09ICJCYXRhbGthbiBQb3N0aW5nIERhdGEgPyIpew0KCQkJCQkJCQkJCQkJbWUuSGFwdXNQb3N0aW5nUGVyc2VkaWFhbigxMDApOw0KCQkJCQkJCQkJCQl9ZWxzZXsNCgkJCQkJCQkJCQkJCWRlbEVsZW0oY292ZXIpOw0KCQkJCQkJCQkJCQkJZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdz0nYXV0byc7DQoJCQkJCQkJCQkJCQlpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaWRfRGV0YWlsXzAnKSltZS5Qcm9zZXNQb3N0aW5nUGVyc2VkaWFhbigwKTsNCgkJCQkJCQkJCQkJfQ0KCQkJCQkJCQkJCWJyZWFrOw0KCQkJCQkJCQkJfQ0KCQkJCQkJCQl9ZWxzZXsNCgkJCQkJCQkJCWFsZXJ0KHJlc3AuY29udGVudC5lcnIpOw0KCQkJCQkJCQl9DQoJCQkJCQkJfQ0KCQkJCQkJfQ0KCQkJCQkJCQ0KCQkJCQl9DQoJCQkJCQkJDQoJCQkJfWVsc2V7DQoJCQkJCWFsZXJ0KHJlc3AuZXJyKTsNCgkJCQl9DQoJCSAgCX0NCgkJCX0pOwkJDQoJCQ0KCQkNCgl9LA0KCQ0KCWtlbWFqdWFucGVyc2VuOiBmdW5jdGlvbihwZXJzZW5hbixtYXhwZXJzZW4scGVyc2VuU2ViZWx1bT0wKSB7DQoJCSB2YXIgZWxlbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwcm9ncmVzc2JveCIpOw0KCQkgdmFyIG1lID0gdGhpczsNCgkJIHZhciB0b3Rfam1sYmFyYW5nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvdF9qbWxiYXJhbmcnKS52YWx1ZTsNCgkJIHRtYmhuID0gMS90b3Rfam1sYmFyYW5nICogMTAwOw0KCQkgCQkgDQoJCSBpZihNYXRoLnJvdW5kKHBlcnNlbmFuK3RtYmhuKSA8IG1heHBlcnNlbiAmJiBNYXRoLnJvdW5kKHBlcnNlbmFuKTw9MTAwKXsNCgkJCXBlcnNlbmFuID0gTWF0aC5yb3VuZChwZXJzZW5hbik7DQoJCQkJCQkNCgkJCWlmKHBlcnNlblNlYmVsdW0gIT0gcGVyc2VuYW4pew0KCQkJCS8vYWxlcnQocGVyc2VuU2ViZWx1bSsiID09ICIrcGVyc2VuYW4rIiA9ICIrbWF4cGVyc2VuKTsNCgkJCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic3RhdHVzdHh0Iikuc3R5bGUud2lkdGggPSBwZXJzZW5hbisiJSI7IA0KCQkJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzdGF0dXN0eHQiKS5pbm5lckhUTUwgPSBwZXJzZW5hbisiJSI7DQoJCQkJDQoJCQkJcGVyc2VuU2ViZWx1bSA9IHBlcnNlbmFuOw0KCQkJCXBlcnNlbmFuID0gcGVyc2VuYW4gKyBNYXRoLnJvdW5kKHRtYmhuKTsNCgkJCQkJCQkNCgkJCQkvL2FsZXJ0KHBlcnNlblNlYmVsdW0rIiA9ICIrcGVyc2VuYW4pOwkNCgkJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uIG15RnVuY3Rpb25QZXJzZW4oKSB7bWUua2VtYWp1YW5wZXJzZW4ocGVyc2VuYW4sbWF4cGVyc2VuLHBlcnNlblNlYmVsdW0pfSwxKTsNCgkJCX0NCgkJIH1lbHNlew0KCQkJaWYobWF4cGVyc2VuID49IDEwMCl7DQoJCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInN0YXR1c3R4dCIpLnN0eWxlLndpZHRoID0gMTAwKyIlIjsgDQoJCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInN0YXR1c3R4dCIpLmlubmVySFRNTCA9IDEwMCsiJSI7DQoJCQl9ZWxzZXsNCgkJCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic3RhdHVzdHh0Iikuc3R5bGUud2lkdGggPSBNYXRoLnJvdW5kKG1heHBlcnNlbikrIiUiOyANCgkJCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic3RhdHVzdHh0IikuaW5uZXJIVE1MID0gTWF0aC5yb3VuZChtYXhwZXJzZW4pKyIlIjsNCgkJCX0JDQoJCSB9CQ0KCQkNCgl9LA0KCQ0KCUhhcHVzUG9zdGluZ19QZW5nYWRhYW5fQWZ0ZXI6IGZ1bmN0aW9uKHJlc3Apew0KCQl2YXIgbWU9dGhpczsNCgkJJCgiI2tldF90b3Rfam1sX3Bvc3QiKS5odG1sKHJlc3AuY29udGVudC5KdW1sYWhCYXJhbmcpOw0KCQltZS5mdW5jdGlvbl9wZXJzZW5hbihyZXNwLmNvbnRlbnQucGVyc2VuKTsNCgkJbWUuR2V0VGltZVBvc3RpbmcoMSwyKTsNCgkJbWUuU2V0X0RldGFpbERhdGFQb3N0aW5nKDIpOw0KCQlpZihyZXNwLmNvbnRlbnQuUHJvc2VzID09ICJORVhUIil7DQoJCQlpZihyZXNwLmNvbnRlbnQuSm1sUHJvc2VzKXsNCgkJCQltZS5CVExfUE9TVElORyArPSBwYXJzZUludChyZXNwLmNvbnRlbnQuSm1sUHJvc2VzKTsNCgkJCQlEYXRhUGVuZ2F0dXJhbi5TZXRfY2VrRGNJRF92YWwoIlN1ZGFoUG9zdGluZ19EYXRhIiwgcmVzcC5jb250ZW50Lkp1bWxhaEJhcmFuZyk7DQoJCQkJaWYocGFyc2VJbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImptbF9icmdfbmV4dFBPU1QiKS52YWx1ZSkgPiBtZS5CVExfUE9TVElORyl7DQoJCQkJCW1lLkhhcHVzUG9zdGluZ19QZW5nYWRhYW4oKTsNCgkJCQl9ZWxzZXsNCgkJCQkJYWxlcnQoIkRhdGEgU2VsZXNhaSBEaSBCYXRhbCBQb3N0aW5nICEiKTsNCgkJCQkJbWUuQ2xvc2UoKTsNCgkJCQkJbWUuUG9zdGluZygpOw0KCQkJCQlzdG9wd2F0Y2guU3RvcCgpOw0KCQkJCQljbGVhclRpbWVvdXQobWUuQmFuZGluZ1dha3R1KTsJCQkJCQ0KCQkJCX0JCQkJCQkJDQoJCQl9ZWxzZXsNCgkJCQltZS5IYXB1c1Bvc3RpbmdfUGVuZ2FkYWFuKCk7DQoJCQl9CQkJDQoJCQkJDQoJCX1lbHNlewkJCQkJCQkNCgkJCWFsZXJ0KCJCZXJoYXNpbCBNZW1iYXRhbGthbiBQb3N0aW5nICEiKTsNCgkJCW1lLkNsb3NlKCk7DQoJCQltZS5yZWZyZXNoTGlzdCgpOw0KCQkJc3RvcHdhdGNoLlN0b3AoKTsNCgkJfQ0KCX0sDQoJDQoJSGFwdXNQb3N0aW5nX1BlbmdhZGFhbjogZnVuY3Rpb24oKXsJDQoJCXZhciBtZT10aGlzOwkJDQoJCWlmKG1lLlN0YXR1c1Bvc3RpbmcgPT0gMSl7DQoJCQltZS5TZXRBamF4VGltZSgxKTsNCgkJCW1lLk11bGFpUG9zdGluZ19QZW5nYWRhYW4oKTsNCgkJCW1lLkxvYWRpbmdQb3N0aW5nKCIiKTsNCgkJCSQuYWpheCh7DQoJCQkJdHlwZTonUE9TVCcsIA0KCQkJCWRhdGE6JCgnIycrdGhpcy5wcmVmaXgrIl9mb3JtIikuc2VyaWFsaXplKCksDQoJCQkJdXJsOiB0aGlzLnVybCsnJnRpcGU9SGFwdXNQb3N0aW5nJkJUTF9IQVBVU0NFSz0nK21lLkJUTF9QT1NUSU5HLA0KCQkJCXN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHsJCQ0KCQkJCQl2YXIgcmVzcCA9IGV2YWwoJygnICsgZGF0YSArICcpJyk7DQoJCQkJCWlmKHJlc3AuZXJyPT0nJyl7DQoJCQkJCQltZS5IYXB1c1Bvc3RpbmdfUGVuZ2FkYWFuX0FmdGVyKHJlc3ApOwkJCQkJDQoJCQkJCX1lbHNlew0KCQkJCQkJYWxlcnQocmVzcC5lcnIpOw0KCQkJCQkJc3RvcHdhdGNoLlN0b3AoKTsNCgkJCQkJCW1lLkNsb3NlKCk7DQoJCQkJCQltZS5Qb3N0aW5nKCk7DQoJCQkJCX0NCgkJCQl9LA0KCQkJCWVycm9yOiBmdW5jdGlvbiAoeGhyLCBhamF4T3B0aW9ucywgdGhyb3duRXJyb3IpIHsNCgkJCQkJbWUuSGFwdXNQb3N0aW5nX1BlbmdhZGFhbigpOw0KCQkgICAgCX0NCgkJCX0pOwkNCgkJfWVsc2V7DQoJCQltZS5Mb2FkaW5nUG9zdGluZ19FbmQoKTsNCgkJfQ0KCX0sDQoJDQoJSGFwdXNQb3N0aW5nX1BlbWVsaWhhcmFhbjogZnVuY3Rpb24oKXsJDQoJCXZhciBtZT10aGlzOwkNCgkJdmFyIGNvdmVyID0gJ3BlbWFzdWthbl9mb3JtY292ZXJfbG9hZCc7CQ0KCQkkLmFqYXgoew0KCQkJdHlwZTonUE9TVCcsIA0KCQkJZGF0YTokKCcjJyt0aGlzLnByZWZpeCsiX2Zvcm0iKS5zZXJpYWxpemUoKSwNCgkJCXVybDogdGhpcy51cmwrJyZ0aXBlPUhhcHVzUG9zdGluZycsDQoJCQlzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7CQkNCgkJCQl2YXIgcmVzcCA9IGV2YWwoJygnICsgZGF0YSArICcpJyk7DQoJCQkJaWYocmVzcC5lcnI9PScnKXsNCgkJCQkJJCgiI2tldF90b3Rfam1sX3Bvc3QiKS5odG1sKHJlc3AuY29udGVudC5KdW1sYWhCYXJhbmcpOw0KCQkJCQltZS5mdW5jdGlvbl9wZXJzZW5hbihyZXNwLmNvbnRlbnQucGVyc2VuKTsNCgkJCQkJaWYocmVzcC5jb250ZW50LlByb3NlcyA9PSAiTkVYVCIpew0KCQkJCQkJbWUuSGFwdXNQb3N0aW5nX1BlbWVsaWhhcmFhbih0b3RfcGVyc2VuKTs7DQoJCQkJCX1lbHNlew0KCQkJCQkJYWxlcnQoIkJlcmhhc2lsIE1lbWJhdGFsa2FuIFBvc3RpbmcgISIpOw0KCQkJCQkJbWUuQ2xvc2UoKTsNCgkJCQkJCW1lLnJlZnJlc2hMaXN0KCk7DQoJCQkJCQlkZWxFbGVtKGNvdmVyKTsNCgkJCQkJfQkJCQkJCQ0KCQkJCX1lbHNlew0KCQkJCQlkZWxFbGVtKGNvdmVyKTsNCgkJCQkJYWxlcnQocmVzcC5lcnIpOw0KCQkJCX0NCgkJCX0sDQoJCQllcnJvcjogZnVuY3Rpb24gKHhociwgYWpheE9wdGlvbnMsIHRocm93bkVycm9yKSB7DQoJCQkJbWUuSGFwdXNQb3N0aW5nX1BlbWVsaWhhcmFhbigpOw0KCSAgICAJfQ0KCQl9KTsJDQoJfSwNCgkNCglTZXRfRGV0YWlsRGF0YVBvc3Rpbmc6IGZ1bmN0aW9uKEpucz0xKXsNCgkJdmFyIG1lPXRoaXM7DQoJCXZhciBTdWRhaFBvc3RpbmcgPSBKbnMgPT0gMT9tZS5KTUxfUE9TVElORzptZS5CVExfUE9TVElORzsNCgkJdmFyIGptbF9icmdfbmV4dFBPU1QgPSAxOw0KCQlpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiam1sX2JyZ19uZXh0UE9TVCIpKWptbF9icmdfbmV4dFBPU1QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiam1sX2JyZ19uZXh0UE9TVCIpLnZhbHVlOw0KCQkNCgkJdmFyIEtldCA9IEpucyA9PSAxPyJQT1NUSU5HIjoiQkFUQUwgUE9TVElORyI7DQoJCQ0KCQlEYXRhUGVuZ2F0dXJhbi5TZXRfY2VrRGNJRF9JTk5FUigiS2V0X0VsYXBzZWQiLCAiPGhyPlBST1NFUyAiK0tldCsiIDogIitTdWRhaFBvc3RpbmcrIi8iK2ptbF9icmdfbmV4dFBPU1QpOw0KCX0sDQoJDQoJUHJvc2VzUG9zdGluZ19QZW5nYWRhYW5fQWZ0ZXI6IGZ1bmN0aW9uKHVydXRhbiwga29udGVuLCBKYWx1cil7DQoJCXZhciBtZT10aGlzOw0KCQlqbWxTZXRQT1NUID0gbWUuam1sU2V0UE9TVDsNCgkJbWUuSk1MX1BPU1RJTkcgPSBOdW1iZXIobWUuSk1MX1BPU1RJTkcpICsgTnVtYmVyKGtvbnRlbi5qbWxfcHJvc2VzKTsJDQoJCQ0KCQlpZihrb250ZW4uTGFuZ3N1bmcgPT0gIjEiKXVydXRhbis9MTsJCQ0KCQltZS5mdW5jdGlvbl9wZXJzZW5hbihrb250ZW4ucGVyc2VuKTsNCgkJJCgiI2tldF90b3Rfam1sX3Bvc3QiKS5odG1sKGtvbnRlbi5qbWxfYmFyYW5nKTsNCgkJDQoJCW1lLkdldFRpbWVQb3N0aW5nKEphbHVyKTsJDQoJCW1lLlNldF9EZXRhaWxEYXRhUG9zdGluZygpOwkJDQoJCQkJDQoJCWlmKGtvbnRlbi5zZWxlc2FpID09IDEpew0KCQkJc3RvcHdhdGNoLlN0b3AoKTsNCgkJCWNsZWFyVGltZW91dChtZS5CYW5kaW5nV2FrdHUpOwkNCgkJCWlmKG1lLkNla19QT1NUX1RyYWNrKCkgPT0gMCltZS5VcGRhdGVQb3N0aW5nQmVyaGFzaWwoKTsJCQkNCgkJfWVsc2V7CQkNCgkJCWlmKG1lLkpNTF9QT1NUSU5HID49IGptbFNldFBPU1Qpew0KCQkJCWlmKG1lLkNla19QT1NUX1RyYWNrKCkgPT0gMCAmJiBtZS5BZGFZYW5nVGFueWEgPT0gMCl7DQoJCQkJCW1lLkFkYVlhbmdUYW55YSA9IDE7DQoJCQkJCS8qdmFyIHRhbnlhID0gY29uZmlybSgiRGF0YSBTdWtzZXMgRGkgUG9zdGluZyAhIE1hdSBkaSBMYW5qdXRrYW4gPyIpOw0KCQkJCQlpZih0YW55YSl7DQoJCQkJCQltZS5KTUxfUE9TVElORz0wOw0KCQkJCQkJbWUuU3RhdHVzUG9zdGluZyA9IDE7DQoJCQkJCQltZS5BZGFZYW5nVGFueWEgPSAwDQoJCQkJCQltZS5Qcm9zZXNQb3N0aW5nX1BlbmdhZGFhbigwLCBKYWx1cik7DQoJCQkJCX1lbHNlew0KCQkJCQkJbWUuU3RhdHVzUG9zdGluZyA9IDA7DQoJCQkJCQltZS5Mb2FkaW5nUG9zdGluZ19FbmQoKTsNCgkJCQkJfSovDQoJCQkJCWlmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwZW1hc3VrYW5fZm9ybWNvdmVyX2xvYWQiKSlkZWxFbGVtKCJwZW1hc3VrYW5fZm9ybWNvdmVyX2xvYWQiKTsNCgkJCQkJYWxlcnQoIkRhdGEgU3Vrc2VzIERpIFBvc3RpbmcgISIpOw0KCQkJCQlzdG9wd2F0Y2guU3RvcCgpOw0KCQkJCQljbGVhclRpbWVvdXQobWUuQmFuZGluZ1dha3R1KTsJDQoJCQkJCW1lLlN0YXR1c1Bvc3RpbmcgPSAwOw0KCQkJCQltZS5Mb2FkaW5nUG9zdGluZ19FbmQoKTsNCgkJCQl9CQkJCQkJCQkJDQoJCQl9ZWxzZXsJCQkJDQoJCQkJbWUuUHJvc2VzUG9zdGluZ19QZW5nYWRhYW4odXJ1dGFuLCBKYWx1cik7DQoJCQl9DQoJCX0JCQ0KCQkNCgkJDQoJfSwNCgkNCglMb2FkaW5nUG9zdGluZzogZnVuY3Rpb24oa29udGVuKXsNCgkJdmFyIG1lID0gdGhpczsNCgkJaWYoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImptbF9icmdfbmV4dFBPU1QiKSlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiam1sX2JyZ19uZXh0UE9TVCIpLnJlYWRPbmx5PXRydWU7DQoJCWlmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwb3N0aW5nIikpZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBvc3RpbmciKS5kaXNhYmxlZD10cnVlOw0KCX0sCQkNCgkNCglNdWxhaVBvc3RpbmdfUGVuZ2FkYWFuOmZ1bmN0aW9uKCl7CQ0KCQl2YXIgbWU9dGhpczsNCgkJaWYoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIkJ0bl9Gb3JQb3N0aW5nIikpew0KCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIkJ0bl9Gb3JQb3N0aW5nIikuaW5uZXJIVE1MPSI8dGFibGUgd2lkdGg9JzEwMCUnPjx0cj48dGQ+PGltZyBzcmM9J2ltYWdlcy9hZG1pbmlzdHJhdG9yL2ltYWdlcy9sb2FkZXIuZ2lmJyB3aWR0aD0nMzVweCcgLz48L3RkPjx0ZCB3aWR0aD0nMTAlJz48aW5wdXQgdHlwZT0nYnV0dG9uJyBuYW1lPSdCdG5fU3RvcFBvc3RpbmcnIHZhbHVlPSdCRVJIRU5USScgb25jbGljaz0ncGVtYXN1a2FuLkJlcmhlbnRpUG9zdGluZ19QZW5nYWRhYW4oKTsnIC8+PC90ZD48L3RyPjwvdGFibGU+IjsNCgkJfQ0KCX0sDQoJDQoJQmVyaGVudGlQb3N0aW5nX1BlbmdhZGFhbjpmdW5jdGlvbigpewkNCgkJdmFyIG1lPXRoaXM7DQoJCW1lLlN0YXR1c1Bvc3RpbmcgPTA7DQoJCWlmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJCdG5fRm9yUG9zdGluZyIpKXsNCgkJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJCdG5fRm9yUG9zdGluZyIpLmlubmVySFRNTD0iPGltZyBzcmM9J2ltYWdlcy9hZG1pbmlzdHJhdG9yL2ltYWdlcy9sb2FkZXJlbmQuZ2lmJyB3aWR0aD0nMzBweCcgLz4iOw0KCQkJY2xlYXJUaW1lb3V0KG1lLkJhbmRpbmdXYWt0dSk7CQ0KCQkJc3RvcHdhdGNoLlN0b3AoKTsNCgkJCQ0KCQl9DQoJfSwNCgkJDQoJTG9hZGluZ1Bvc3RpbmdfRW5kOiBmdW5jdGlvbigpew0KCQl2YXIgbWU9dGhpczsNCgkJaWYobWUuQ2VrX1BPU1RfVHJhY2soKSA9PSAwKXsNCgkJCWNsZWFyVGltZW91dChtZS5CYW5kaW5nV2FrdHUpOw0KCQkJaWYoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBlbWFzdWthbl9mb3JtY292ZXIiKSlkZWxFbGVtKCJwZW1hc3VrYW5fZm9ybWNvdmVyIik7DQoJCQltZS5Qb3N0aW5nKCk7DQoJCX0JCQ0KCX0sDQoJDQoJU2V0QWpheFRpbWU6ZnVuY3Rpb24oSmFsdXI9MSl7DQoJCXZhciBtZT10aGlzOw0KCQl2YXIgVGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpOw0KCQlpZihKYWx1ciA9PSAxKW1lLkFqYXhUaW1lX1RyYWNrMT1UaW1lOw0KCQlpZihKYWx1ciA9PSAyKW1lLkFqYXhUaW1lX1RyYWNrMj1UaW1lOw0KCQlpZihKYWx1ciA9PSAzKW1lLkFqYXhUaW1lX1RyYWNrMz1UaW1lOw0KCQlpZihKYWx1ciA9PSA0KW1lLkFqYXhUaW1lX1RyYWNrND1UaW1lOw0KCX0sDQoJDQoJR2V0QWpheFRpbWU6ZnVuY3Rpb24oSmFsdXI9MSl7DQoJCXZhciBtZT10aGlzOw0KCQlpZihKYWx1ciA9PSAxKUFqYXhUaW1lID0gbWUuQWpheFRpbWVfVHJhY2sxOw0KCQlpZihKYWx1ciA9PSAyKUFqYXhUaW1lID0gbWUuQWpheFRpbWVfVHJhY2syOw0KCQlpZihKYWx1ciA9PSAzKUFqYXhUaW1lID0gbWUuQWpheFRpbWVfVHJhY2szOw0KCQlpZihKYWx1ciA9PSA0KUFqYXhUaW1lID0gbWUuQWpheFRpbWVfVHJhY2s0Ow0KCQkNCgkJcmV0dXJuIEFqYXhUaW1lOw0KCX0sDQoJDQoJU2V0V2FrdHU6ZnVuY3Rpb24oV2FrdHUpew0KCQl2YXIgbWU9dGhpczsJDQoJCWlmKFdha3R1ID4gMTAwMCl7DQoJCQlUaW1lID0gbXNUb1RpbWUoV2FrdHUpOw0KCQkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIkVsYXBzZWQiKS5pbm5lckhUTUwgPSAiRVNUSU1BU0kgV0FLVFUgOiAiK1RpbWU7DQoJCQkvLyQoIiNFbGFwc2VkIikuaHRtbCgiRVNUSU1BU0kgV0FLVFUgOiAiK1RpbWUpOw0KCQkJV2FrdHUgPSBXYWt0dSAtIDEwMDA7DQoJCQltZS5CYW5kaW5nV2FrdHUgPSANCgkJCQlzZXRUaW1lb3V0KA0KCQkJCQlmdW5jdGlvbiBteUZ1bmN0aW9uKCkgew0KCQkJCQkJbWUuU2V0V2FrdHUoV2FrdHUpOw0KCQkJCQl9LDEwMDApOw0KCQl9ZWxzZXsNCgkJCW1lLldha3R1VGVyYWtoaXIgPSAwOw0KCQkJY2xlYXJUaW1lb3V0KG1lLkJhbmRpbmdXYWt0dSk7DQoJCX0NCgkJDQoJfSwNCgkNCglHZXRUaW1lUG9zdGluZzogZnVuY3Rpb24oSmFsdXI9MSwgSm5zPTEpew0KCQl2YXIgbWU9dGhpczsNCgkJDQoJCWlmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJqbWxfYnJnX25leHRQT1NUIikpew0KCQkJVG90YWxQb3N0ID0gcGFyc2VJbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImptbF9icmdfbmV4dFBPU1QiKS52YWx1ZSk7DQoJCQlTdWRhaFBvc3RpbmcgPSBKbnMgPT0gMT9tZS5KTUxfUE9TVElORzptZS5CVExfUE9TVElORzsNCgkJCVByYWtpcmFhbiA9IFRvdGFsUG9zdCAtIFN1ZGFoUG9zdGluZzsNCgkJCWlmKFByYWtpcmFhbiA8IDEpUHJha2lyYWFuID0gMDsNCgkJCVBpbGloID0gIEpucyA9PSAxPyJNYXhEYXRhUG9zdGluZyI6Ik1heERhdGFQb3N0aW5nX0RlbCI7DQoJCQlQZXJQb3N0ID0gcGFyc2VJbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoUGlsaWgpLnZhbHVlKTsNCgkJCURhdGFQb3N0ID0gKFByYWtpcmFhbi9QZXJQb3N0KTsNCgkJCWlmKEpucyA9PSAxKURhdGFQb3N0ID0gRGF0YVBvc3QvbWUuU2V0X1Bvc3RUcmFjaygpOw0KCQkJDQoJCQl2YXIgdG90YWxUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCktbWUuR2V0QWpheFRpbWUoSmFsdXIpOw0KCQkJV2FrdHUgPSB0b3RhbFRpbWUgKiBEYXRhUG9zdDsvL1dha3R1IFBlciBtcwkNCgkJCQ0KCQkJSGl0dW5nID0gSm5zID09IDE\/bWUuSk1MX1BPU1RJTkcgKyBQZXJQb3N0Om1lLkJUTF9QT1NUSU5HICsgUGVyUG9zdDsJDQoJCQkNCgkJCWlmKFN1ZGFoUG9zdGluZyA9PSAwIHx8IChXYWt0dSA+IG1lLldha3R1VGVyYWtoaXIgJiYgSGl0dW5nICsgUGVyUG9zdCA8PSBUb3RhbFBvc3QpKXsNCgkJCQltZS5XYWt0dVRlcmFraGlyID0gV2FrdHU7DQoJCQkJY2xlYXJUaW1lb3V0KG1lLkJhbmRpbmdXYWt0dSk7DQoJCQkJbWUuU2V0V2FrdHUoV2FrdHUpOw0KCQkJfWVsc2V7CQkJCQ0KCQkJCWlmKEhpdHVuZyArIFBlclBvc3QgPj0gVG90YWxQb3N0KXsNCgkJCQkJY2xlYXJUaW1lb3V0KG1lLkJhbmRpbmdXYWt0dSk7DQoJCQkJCW1lLlNldFdha3R1KFdha3R1KTsJDQoJCQkJfQ0KCQkJfQkJCQkJDQoJCX0NCgkJDQoJfSwNCgkNCglQcm9zZXNQb3N0aW5nX1BlbmdhZGFhbjogZnVuY3Rpb24odXJ1dGFuLCBKYWx1cj0xKXsNCgkJdmFyIG1lID0gdGhpczsJCQkNCgkJdmFyIGNvdmVyID0gdGhpcy5wcmVmaXgrJ19mb3JtY292ZXJfcG9zdGluZyc7DQoJCQ0KCQlkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93PSdoaWRkZW4nOw0KCQkNCgkJSWREZXQgPSAkKCIjaWRiYXJhbmdueWFfIit1cnV0YW4pLnZhbCgpOw0KCQlTdGF0SWREZXQgPSAkKCIjc3RhdF9wb3N0XyIrSWREZXQpLnZhbCgpOw0KCQkNCgkJaWYoU3RhdElkRGV0ID09ICIwIil7DQoJCQltZS5TZXRBamF4VGltZShKYWx1cik7DQoJCQlpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGVtYXN1a2FuX2Zvcm1jb3Zlcl9sb2FkIikpZGVsRWxlbSgicGVtYXN1a2FuX2Zvcm1jb3Zlcl9sb2FkIik7DQoJCQlpZihtZS5TdGF0dXNQb3N0aW5nID09IDEpew0KCQkJCW1lLk11bGFpUG9zdGluZ19QZW5nYWRhYW4oKTsNCgkJCQltZS5TZXRfUE9TVF9UcmFjayhKYWx1ciwgMSk7DQoJCQkJJC5hamF4KHsNCgkJCQkJdHlwZTonUE9TVCcsIA0KCQkJCQlkYXRhOiQoJyMnK3RoaXMucHJlZml4KyJfZm9ybSIpLnNlcmlhbGl6ZSgpLA0KCQkJCQl1cmw6IHRoaXMudXJsKycmdGlwZT1Qcm9zZXNQb3N0aW5nX1BlbmdhZGFhbiZUUkFDSz0nK0phbHVyKycmSWRQZW5EZXQ9JytJZERldCsiJlRvdGFsU3VkYWhQb3N0aW5nPSIrbWUuSk1MX1BPU1RJTkcsDQoJCQkJICAJc3VjY2VzczogZnVuY3Rpb24oZGF0YSkgewkJDQoJCQkJCQl2YXIgcmVzcCA9IGV2YWwoJygnICsgZGF0YSArICcpJyk7CQkJCQkNCgkJCQkJCS8vZGVsRWxlbShjb3Zlcik7CQkJCQkNCgkJCQkJCW1lLlNldF9QT1NUX1RyYWNrKEphbHVyLCAwKTsNCgkJCQkJCWlmIChyZXNwLmVyciA9PScnKXsNCgkJCQkJCQltZS5Qcm9zZXNQb3N0aW5nX1BlbmdhZGFhbl9BZnRlcih1cnV0YW4sIHJlc3AuY29udGVudCk7DQoJCQkJCQkJbWUuTG9hZGluZ1Bvc3RpbmcocmVzcC5jb250ZW50KTsNCgkJCQkJCX1lbHNlew0KCQkJCQkJCW1lLlN0YXR1c1Bvc3RpbmcgPSAwOw0KCQkJCQkJCWRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3c9J2F1dG8nOw0KCQkJCQkJCXNldFRpbWVvdXQoZnVuY3Rpb24gbXlGdW5jdGlvbigpIHsNCgkJCQkJCQkJaWYoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBlbWFzdWthbl9mb3JtY292ZXJfbG9hZCIpKWRlbEVsZW0oInBlbWFzdWthbl9mb3JtY292ZXJfbG9hZCIpOwkNCgkJCQkJCQkJaWYoSmFsdXIgPT0gMSAmJiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGVtYXN1a2FuX2Zvcm1jb3ZlciIpKXsJCQkJCQkJDQoJCQkJCQkJCQlhbGVydChyZXNwLmVycik7CQ0KCQkJCQkJCQkJc3RvcHdhdGNoLlN0b3AoKTsNCgkJCQkJCQkJCWRlbEVsZW0oInBlbWFzdWthbl9mb3JtY292ZXIiKTsJCQkJCQ0KCQkJCQkJCQkJbWUuUG9zdGluZygpOw0KCQkJCQkJCQl9DQoJCQkJCQkJCQ0KCQkJCQkJCX0sMTAwKTsNCgkJCQkJCX0NCgkJCQkgIAl9LA0KCQkJCQllcnJvcjogZnVuY3Rpb24gKHhociwgYWpheE9wdGlvbnMsIHRocm93bkVycm9yKSB7DQoJCQkJICAgICAgICAvL2RlbEVsZW0oY292ZXIpOw0KCQkJCQkJbWUuUHJvc2VzUG9zdGluZ19QZW5nYWRhYW4odXJ1dGFuKTsNCgkJCQkJCW1lLlNldF9QT1NUX1RyYWNrKEphbHVyLCAwKTsNCgkJCSAgICAJfQ0KCQkJCX0pOw0KCQkJfWVsc2V7DQoJCQkJbWUuTG9hZGluZ1Bvc3RpbmdfRW5kKCk7DQoJCQl9DQoJCX1lbHNlew0KCQkJdXJ1dGFuICs9MTsNCgkJCWlmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJpZGJhcmFuZ255YV8iK3VydXRhbikpew0KCQkJCW1lLlByb3Nlc1Bvc3RpbmdfUGVuZ2FkYWFuKHVydXRhbixKYWx1cik7DQoJCQl9ZWxzZXsNCgkJCQltZS5Mb2FkaW5nUG9zdGluZ19FbmQoKTsNCgkJCX0NCgkJfQ0KCQkNCgkJDQoJCQ0KCX0sDQoJDQoJVXBkYXRlUG9zdGluZ0Jlcmhhc2lsOiBmdW5jdGlvbigpew0KCQl2YXIgbWUgPSB0aGlzOw0KCQkkLmFqYXgoew0KCQkJdHlwZTonUE9TVCcsIA0KCQkJZGF0YTokKCcjJyt0aGlzLnByZWZpeCsiX2Zvcm0iKS5zZXJpYWxpemUoKSwNCgkJCXVybDogdGhpcy51cmwrJyZ0aXBlPUJlcmhhc2lsUG9zdGluZycsDQoJCQlzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7CQkNCgkJCQl2YXIgcmVzcCA9IGV2YWwoJygnICsgZGF0YSArICcpJyk7DQoJCQkJaWYocmVzcC5lcnI9PScnKXsNCgkJCQkJYWxlcnQoIkJlcmhhc2lsIE1lbXBvc3RpbmcgRGF0YSAhIik7DQoJCQkJCQ0KCQkJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uIG15RnVuY3Rpb25QZXJzZW4oKSB7bWUuQ2xvc2UoKTtwZW1hc3VrYW4ucmVmcmVzaExpc3QoKTt9LDExMSk7DQoJCQkJCWlmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwZW1hc3VrYW5fZm9ybWNvdmVyX2xvYWQiKSlzZXRUaW1lb3V0KGZ1bmN0aW9uIG15RnVuY3Rpb25QZXJzZW4oKSB7ZGVsRWxlbSgncGVtYXN1a2FuX2Zvcm1jb3Zlcl9sb2FkJyk7fSw1MDApOw0KCQkJCX1lbHNlew0KCQkJCQlhbGVydChyZXNwLmVycik7DQoJCQkJfQ0KCQkJfQ0KCQl9KTsNCgl9LA0KCQkNCglTaW1wYW5UVEQ6IGZ1bmN0aW9uKCl7DQoJCXZhciBtZT0gdGhpczsNCgkJDQoJCXZhciBjb3ZlciA9IHRoaXMucHJlZml4KydfZm9ybWNvdmVyX1RURF9sb2FkJzsNCgkJZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdz0naGlkZGVuJzsNCgkJYWRkQ292ZXJQYWdlMihjb3ZlciwyLHRydWUsZmFsc2UpOwkNCgkJDQoJCQ0KCQkkLmFqYXgoew0KCQkJdHlwZTonUE9TVCcsIA0KCQkJZGF0YTokKCcjJyt0aGlzLnByZWZpeCsnX2Zvcm1fVFREJykuc2VyaWFsaXplKCksDQoJCQl1cmw6IHRoaXMudXJsKycmdGlwZT1TaW1wYW5UVEQnLA0KCQkgIAlzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7CQkNCgkJCQl2YXIgcmVzcCA9IGV2YWwoJygnICsgZGF0YSArICcpJyk7CQ0KCQkJCWRlbEVsZW0oY292ZXIpOwkJDQoJCQkJLy9kb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb3ZlcikuaW5uZXJIVE1MID0gcmVzcC5jb250ZW50Ow0KCQkJCWlmKHJlc3AuZXJyPT0nJyl7DQoJCQkJCWFsZXJ0KHJlc3AuY29udGVudCk7DQoJCQkJCW1lLlR1dHVwRm9ybSgicGVtYXN1a2FuX2Zvcm1jb3Zlcl9UVEQiKTsNCgkJCQl9ZWxzZXsNCgkJCQkJYWxlcnQocmVzcC5lcnIpOw0KCQkJCX0NCgkJICAJfQ0KCQl9KTsNCgl9LA0KCQ0KCVByaW50TGFwb3JhbjogZnVuY3Rpb24oKXsNCgkJdmFyIGFGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5wcmVmaXgrKCdfZm9ybScpKTsJCQ0KCQkJYUZvcm0uYWN0aW9uPSB0aGlzLnVybCsnJnRpcGU9UHJpbnRMYXBvcmFuJzsJDQoJCQlhRm9ybS50YXJnZXQ9J19ibGFuayc7DQoJCQlhRm9ybS5zdWJtaXQoKTsJDQoJCQlhRm9ybS50YXJnZXQ9Jyc7DQoJfSwNCgkNCglQcm9zZXNQb3N0aW5nUGVtZWxpaGFyYWFuOiBmdW5jdGlvbih1cnV0YW4sIEJSR01VTEFJLCBCUkdTVURBSFBST1NFUyl7DQoJCXZhciBtZT0gdGhpczsJDQoJCXZhciBjb3ZlciA9IHRoaXMucHJlZml4KydfZm9ybWNvdmVyJzsNCgkJDQoJCQ0KCQl0b3Rfam1sYmFyYW5nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvdF9qbWxiYXJhbmcnKS52YWx1ZTsNCgkJDQoJCWlmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpZEtQVExTXycrdXJ1dGFuKSl7DQoJCQlpZEtQVExTID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lkS1BUTFNfJyt1cnV0YW4pLnZhbHVlOw0KCQkJDQoJCQlpZihCUkdTVURBSFBST1NFUyA9PSAwKXsNCgkJCQlwZXJhd2FsPTE7DQoJCQl9ZWxzZXsNCgkJCQlwZXJhd2FsPUJSR1NVREFIUFJPU0VTOw0KCQkJfQ0KCQkJDQoJCQlwZXJzZW5hbiA9IHBlcmF3YWwvdG90X2ptbGJhcmFuZyAqIDEwMDsJCQkJCQkJCQ0KCQkJCSQuYWpheCh7DQoJCQkJCXR5cGU6J1BPU1QnLCANCgkJCQkJZGF0YTokKCcjJyt0aGlzLnByZWZpeCsiX2Zvcm0iKS5zZXJpYWxpemUoKSwNCgkJCQkJdXJsOiB0aGlzLnVybCsnJnRpcGU9UHJvc2VzUG9zdGluZ1BlbWVsaWhhcmFhbiZJZERpc3RyaWJ1c2k9JytpZEtQVExTKycmQlJHTVVMQUk9JytCUkdNVUxBSSwNCgkJCQkgIAlzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7CQkNCgkJCQkJCXZhciByZXNwID0gZXZhbCgnKCcgKyBkYXRhICsgJyknKTsNCgkJCQkJCWlmKHJlc3AuZXJyPT0nJyl7DQoJCQkJCQkJDQoJCQkJCQkJQlJHTVVMQUkgPSBCUkdNVUxBSSArIDE7DQoJCQkJCQkJdXJ1dGFuID0gdXJ1dGFuICsgMTsNCgkJCQkJCQkNCgkJCQkJCQltYXhwZXJzZW5hbiA9IHJlc3AuY29udGVudC5icmdfaW5wdXQvdG90X2ptbGJhcmFuZyAqIDEwMCA7DQoJCQkJCQkJDQoJCQkJCQkJaWYocmVzcC5jb250ZW50Lmxhbmp1dCA9PSAiTkVYVCIpew0KCQkJCQkJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uIG15RnVuY3Rpb25QZXJzZW4oKSB7bWUua2VtYWp1YW5wZXJzZW4ocGVyc2VuYW4sbWF4cGVyc2VuYW4pfSwxMDApOw0KCQkJCQkJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uIG15RnVuY3Rpb25QZXJzZW4oKSB7bWUuUHJvc2VzUG9zdGluZ1BlbWVsaWhhcmFhbih1cnV0YW4sIEJSR01VTEFJLCByZXNwLmNvbnRlbnQuQmFyYW5nU3VkYWhQcm9zZXMpO30sMTAxKTsJDQoJCQkJCQkJfWVsc2V7DQoJCQkJCQkJCXNldFRpbWVvdXQoZnVuY3Rpb24gbXlGdW5jdGlvblBlcnNlbigpIHttZS5rZW1hanVhbnBlcnNlbihwZXJzZW5hbixtYXhwZXJzZW5hbil9LDEwMCk7DQoJCQkJCQkJCXNldFRpbWVvdXQoZnVuY3Rpb24gbXlGdW5jdGlvblBlcnNlbigpIHttZS5VcGRhdGVQb3N0aW5nQmVyaGFzaWwoKTt9LDExMCk7DQoJCQkJCQkJCQ0KCQkJCQkJCX0NCgkJCQkJCQkJCQkJCQkJCQkNCgkJCQkJCX1lbHNlew0KCQkJCQkJCWFsZXJ0KHJlc3AuZXJyKTsNCgkJCQkJCQlkZWxFbGVtKCJwZW1hc3VrYW5fZm9ybWNvdmVyX2xvYWQiKTsNCgkJCQkJCX0NCgkJCQkgIAl9DQoJCQkJfSk7CQ0KCQkJCQkNCgkJCQkJDQoJCQkJCQ0KCQl9DQoJCQ0KCX0sDQoJDQoJTGloYXREYXRhX0dldERhdGFfRGV0YWlsOiBmdW5jdGlvbigpew0KCQl2YXIgbWU9dGhpczsNCgkJbWUuRm9ybV9QZW5jYXJpYW5EZXRhaWwoKTsNCgkJcGVtYXN1a2FuX2luc19kZXQuZm9ybU5hbWU9InBlbWFzdWthbl9Gb3JtTGloYXREYXRhIjsNCgkJcGVtYXN1a2FuX2luc19kZXQubG9hZGluZygpOw0KCX0sDQoJDQoJTGloYXREYXRhOmZ1bmN0aW9uKElkbnlhLCBjYil7DQoJCXZhciBtZSA9IHRoaXM7DQoJCQl2YXIgYm94ID0gdGhpcy5HZXRDYnhDaGVja2VkKCk7DQoJCQkNCgkJCS8vdGhpcy5TaG93ICgnZm9ybWVkaXQnLHtpZHBsaDpib3gudmFsdWV9LCBmYWxzZSwgdHJ1ZSk7CQkJDQoJCQl2YXIgY292ZXIgPSB0aGlzLnByZWZpeCsnX2Zvcm1jb3Zlcic7DQoJCQlhZGRDb3ZlclBhZ2UyKGNvdmVyLDEsdHJ1ZSxmYWxzZSk7CQ0KCQkJZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdz0naGlkZGVuJzsNCgkJCSQuYWpheCh7DQoJCQkJdHlwZTonUE9TVCcsIA0KCQkJCWRhdGE6JCgnIycrdGhpcy5mb3JtTmFtZSkuc2VyaWFsaXplKCksDQoJCQkJdXJsOiB0aGlzLnVybCsnJnRpcGU9Zm9ybUxpaGF0RGF0YSZJZG55YT0nK0lkbnlhKycmY2JueWE9JytjYiwNCgkJCSAgCXN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHsJCQ0KCQkJCQl2YXIgcmVzcCA9IGV2YWwoJygnICsgZGF0YSArICcpJyk7CQ0KCQkJCQlpZiAocmVzcC5lcnIgPT0nJyl7CQkNCgkJCQkJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvdmVyKS5pbm5lckhUTUwgPSByZXNwLmNvbnRlbnQ7DQoJCQkJCQltZS5MaWhhdERhdGFfR2V0RGF0YV9EZXRhaWwoKTsNCgkJCQkJfWVsc2V7DQoJCQkJCQlhbGVydChyZXNwLmVycik7DQoJCQkJCQlkZWxFbGVtKGNvdmVyKTsNCgkJCQkJCWRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3c9J2F1dG8nOw0KCQkJCQl9DQoJCQkgIAl9DQoJCQl9KTsNCgkJDQoJfSwNCgkNCglPcHRfTGloYXREYXRhOmZ1bmN0aW9uKCl7DQoJCXZhciBtZSA9IHRoaXM7CQ0KCQllcnJtc2cgPSB0aGlzLkNla0NoZWNrYm94KCk7DQoJCWlmKGVycm1zZyA9PScnKXsgDQoJCQl2YXIgYm94ID0gdGhpcy5HZXRDYnhDaGVja2VkKCk7DQoJCQlkYXRhID0gYm94LmlkOw0KCQkJZGF0YW55YSA9IGRhdGEuc3BsaXQoIl9jYiIpOw0KCQkJbWUuTGloYXREYXRhKGJveC52YWx1ZSwgZGF0YW55YVsxXSkNCgkJfWVsc2V7DQoJCQlhbGVydChlcnJtc2cpOw0KCQl9DQoJfSwNCgkNCglTaW5na3JvbkF0cmlidXNpOiBmdW5jdGlvbigpew0KCQl2YXIgbWU9IHRoaXM7DQoJCXRoaXMuT25FcnJvckNsb3NlID0gZmFsc2UJDQoJCWRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3c9J2hpZGRlbic7DQoJCXZhciBjb3ZlciA9IHRoaXMucHJlZml4KydfZm9ybXNpbXBhbic7DQoJCWFkZENvdmVyUGFnZTIoY292ZXIsMSx0cnVlLGZhbHNlKTsJDQoJCQ0KCQkkLmFqYXgoew0KCQkJdHlwZTonUE9TVCcsIA0KCQkJZGF0YTokKCcjJyt0aGlzLmZvcm1OYW1lKS5zZXJpYWxpemUoKSwNCgkJCXVybDogdGhpcy51cmwrJyZ0aXBlPVNpbmdrcm9uQXRyaWJ1c2knLA0KCQkgIAlzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7CQkNCgkJCQl2YXIgcmVzcCA9IGV2YWwoJygnICsgZGF0YSArICcpJyk7CQ0KCQkJCWRlbEVsZW0oY292ZXIpOwkJDQoJCQkJZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdz0nYXV0byc7DQoJCQkJaWYocmVzcC5lcnI9PScnKXsNCgkJCQkJYWxlcnQoIlNlbGVzYWkiKTsNCgkJCQl9ZWxzZXsNCgkJCQkJYWxlcnQocmVzcC5lcnIpOw0KCQkJCX0NCgkJICAJfQ0KCQl9KTsNCgkJCQ0KCQkNCgl9LA0KCQ0KCUZvcm1UZW1wbGF0ZTpmdW5jdGlvbigpew0KCQl2YXIgbWUgPSB0aGlzOw0KCQkJLy92YXIgYm94ID0gdGhpcy5HZXRDYnhDaGVja2VkKCk7DQoJCQkNCgkJCS8vdGhpcy5TaG93ICgnZm9ybWVkaXQnLHtpZHBsaDpib3gudmFsdWV9LCBmYWxzZSwgdHJ1ZSk7CQkJDQoJCQl2YXIgY292ZXIgPSB0aGlzLnByZWZpeCsnX2Zvcm1jb3Zlcic7DQoJCQlhZGRDb3ZlclBhZ2UyKGNvdmVyLDEsdHJ1ZSxmYWxzZSk7CQ0KCQkJZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdz0naGlkZGVuJzsNCgkJCSQuYWpheCh7DQoJCQkJdHlwZTonUE9TVCcsIA0KCQkJCWRhdGE6JCgnIycrdGhpcy5mb3JtTmFtZSkuc2VyaWFsaXplKCksDQoJCQkJdXJsOiB0aGlzLnVybCsnJnRpcGU9Rm9ybVRlbXBsYXRlJywNCgkJCSAgCXN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHsJCQ0KCQkJCQl2YXIgcmVzcCA9IGV2YWwoJygnICsgZGF0YSArICcpJyk7CQ0KCQkJCQlpZiAocmVzcC5lcnIgPT0nJyl7CQkNCgkJCQkJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvdmVyKS5pbm5lckhUTUwgPSByZXNwLmNvbnRlbnQ7DQoJCQkJCQkNCgkJCQkJfWVsc2V7DQoJCQkJCQlhbGVydChyZXNwLmVycik7DQoJCQkJCQlkZWxFbGVtKGNvdmVyKTsNCgkJCQkJCWRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3c9J2F1dG8nOw0KCQkJCQl9DQoJCQkgIAl9DQoJCQl9KTsNCgkJDQoJfSwNCgkNCglQaWxpaFRlbXBsYXRlOmZ1bmN0aW9uKCl7DQoJCXZhciBlcnJtc2cgPSAnJzsNCgkJdmFyIHBpbF90ZW1wbGF0ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwaWxfdGVtcGxhdGUnKS52YWx1ZTsNCgkJaWYocGlsX3RlbXBsYXRlID09ICcnKWVycm1zZyA9ICJUZW1wbGF0ZSBCZWx1bSBEaSBQaWxpaCAhIjsNCgkJDQoJCWlmKGVycm1zZyA9PScnKXsgDQoJCQl2YXIgdHVrVXJsID0gJ2NhcmlUZW1wbGF0ZSc7DQoJCQlpZihwaWxfdGVtcGxhdGUgPT0gJzEnKXR1a1VybD0ncmVmX3RlbXBsYXRlYmFyYW5nJzsNCgkJCQkJCQkJDQoJCQl2YXIgYUZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLnByZWZpeCsiX2Zvcm0iKTsJCQ0KCQkJYUZvcm0uYWN0aW9uPSAicGFnZXMucGhwP1BnPSIrdHVrVXJsOwkJDQoJCQlhRm9ybS50YXJnZXQ9J19ibGFuayc7DQoJCQlhRm9ybS5zdWJtaXQoKTsJDQoJCQlhRm9ybS50YXJnZXQ9Jyc7DQoJCX1lbHNlew0KCQkJCWFsZXJ0KGVycm1zZyk7DQoJCX0JDQoJfSwNCgkNCglIaXR1bmdUb3RhbFNlbXVhOmZ1bmN0aW9uKCl7DQoJCXZhciBtZSA9IHRoaXM7DQoJCXZhciBjb3ZlciA9IHRoaXMucHJlZml4KydfZm9ybWNvdmVyX0hyZyc7DQoJCWRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3c9J2hpZGRlbic7DQoJCWFkZENvdmVyUGFnZTIoY292ZXIsMSx0cnVlLGZhbHNlKTsNCgkJJC5hamF4KHsNCgkJCXR5cGU6J1BPU1QnLCANCgkJCWRhdGE6JCgnIycrdGhpcy5mb3JtTmFtZSkuc2VyaWFsaXplKCksDQoJCSAgCXVybDogdGhpcy51cmwrJyZ0aXBlPUhpdHVuZ1RvdGFsU2VtdWEnLA0KCQkgIAlzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7CQkNCgkJCQl2YXIgcmVzcCA9IGV2YWwoJygnICsgZGF0YSArICcpJyk7DQoJCQkJZGVsRWxlbShjb3Zlcik7DQoJCQkJZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdz0nYXV0byc7DQoJCQkJaWYocmVzcC5lcnIgPT0gJycpew0KCQkJCQkkKCIjVG90X0JhcmFuZyIpLmh0bWwocmVzcC5jb250ZW50LlRvdF9CYXJhbmcpOw0KCQkJCQkkKCIjVG90X1JlayIpLmh0bWwocmVzcC5jb250ZW50LlRvdF9SZWspOw0KCQkJCQkkKCIjVG90X0JlbGkiKS5odG1sKHJlc3AuY29udGVudC5Ub3RfQmVsaSk7DQoJCQkJCSQoIiNUb3RfQXRyaWJ1c2kiKS5odG1sKHJlc3AuY29udGVudC5Ub3RfQXRyaWJ1c2kpOw0KCQkJCQkkKCIjVG90X1Blcm9sZWhhbiIpLmh0bWwocmVzcC5jb250ZW50LlRvdF9QZXJvbGVoYW4pOw0KCQkJCX1lbHNlew0KCQkJCQlhbGVydChyZXNwLmVycik7DQoJCQkJfQkNCgkJICAJfQ0KCQl9KTsNCgl9LA0KCQ0KCVByb3Nlc19KU1ZhbGlkYXNpOmZ1bmN0aW9uKGNiKXsNCgkJdmFyIG1lPXRoaXM7DQoJCXZhciBzYXlhID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobWUucHJlZml4KyJfY2IiK2NiKTsNCgkJZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobWUucHJlZml4KyJfdG9nZ2xlIikuY2hlY2tlZCA9IGZhbHNlOw0KCQljaGVja0FsbDMoMjUsbWUucHJlZml4KydfY2InLG1lLnByZWZpeCsnX3RvZ2dsZScsbWUucHJlZml4Kydfam1sY2VrJyk7DQoJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG1lLnByZWZpeCsiX2NiIitjYikuY2hlY2tlZCA9IHRydWU7DQoJCWlzQ2hlY2tlZDIoc2F5YS5jaGVja2VkLG1lLnByZWZpeCsnX2ptbGNlaycpOw0KCQltZS5jYnhQaWxpaChzYXlhKSANCgkJbWUuVmFsaWRhc2koMSk7DQoJfSwNCgkNCglDbG9zZVZhbGlkYXNpOmZ1bmN0aW9uKCl7DQoJCXZhciBtZT10aGlzOw0KCQlkZWxFbGVtKG1lLnByZWZpeCsiX2Zvcm1jb3Zlcl92YWxpZGFzaSIpOw0KCQlpZihtZS5EYXJpVmFsaWRhc2kgPT0gMClkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93PSdhdXRvJzsNCgl9LA0KCQ0KCUZuX01hcHBpbmdSZWtlbmluZ0JhcmFuZzpmdW5jdGlvbigpew0KCQl2YXIgbWUgPSB0aGlzOw0KCQl2YXIgY292ZXIgPSB0aGlzLnByZWZpeCsnX2Zvcm1jb3Zlcl9Gbl9NYXBwaW5nUmVrZW5pbmdCYXJhbmcnOw0KCQlkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93PSdoaWRkZW4nOw0KCQlhZGRDb3ZlclBhZ2UyKGNvdmVyLDEsdHJ1ZSxmYWxzZSk7DQoJCSQuYWpheCh7DQoJCQl0eXBlOidQT1NUJywgDQoJCQlkYXRhOiQoJyMnK3RoaXMuZm9ybU5hbWUpLnNlcmlhbGl6ZSgpLA0KCQkgIAl1cmw6IHRoaXMudXJsKycmdGlwZT1Gbl9NYXBwaW5nUmVrZW5pbmdCYXJhbmcnLA0KCQkgIAlzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7CQkNCgkJCQl2YXIgcmVzcCA9IGV2YWwoJygnICsgZGF0YSArICcpJyk7DQoJCQkJZGVsRWxlbShjb3Zlcik7DQoJCQkJZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdz0nYXV0byc7DQoJCQkJYWxlcnQocmVzcC5lcnIpOw0KCQkgIAl9DQoJCX0pOw0KCX0sDQoJDQoJRm5fQ2JQT1NUOmZ1bmN0aW9uKCl7DQoJCWlmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJMYmxfUG9zdCIpKXsNCgkJCVN1ZGFoUG9zdGluZ19EYXRhID0gcGFyc2VJbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIlN1ZGFoUG9zdGluZ19EYXRhIikudmFsdWUpOw0KCQkJVG90YWxCYXJhbmcgPSBwYXJzZUludChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgidG90X2ptbGJhcmFuZyIpLnZhbHVlKTsNCgkJCQkJCQ0KCQkJaWYoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBvc3RpbmciKS5jaGVja2VkID09IGZhbHNlICYmIHBhcnNlSW50KFN1ZGFoUG9zdGluZ19EYXRhKSA+IDApew0KCQkJCWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJMYmxfUG9zdCIpLmlubmVySFRNTD0iQkFUQUwgRElQT1NUSU5HIjsNCgkJCX1lbHNlew0KCQkJCVN1ZGFoUG9zdGluZ19EYXRhID0gVG90YWxCYXJhbmcgLSBTdWRhaFBvc3RpbmdfRGF0YTsNCgkJCQlkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiTGJsX1Bvc3QiKS5pbm5lckhUTUw9IkFLQU4gRElQT1NUSU5HIjsNCgkJCX0NCgkJCQ0KCQkJaWYoU3VkYWhQb3N0aW5nX0RhdGEgPiAxMDAwMClTdWRhaFBvc3RpbmdfRGF0YT0xMDAwMDsNCgkJCURhdGFQZW5nYXR1cmFuLlNldF9jZWtEY0lEX3ZhbCgiam1sX2JyZ19uZXh0UE9TVCIsU3VkYWhQb3N0aW5nX0RhdGEpOw0KCQkJDQoJCX0JDQoJfSwNCgkNCglGb3JtX1BlbmNhcmlhbkRldGFpbDpmdW5jdGlvbigpew0KCQl2YXIgbWUgPSB0aGlzOw0KCQl2YXIgY292ZXIgPSB0aGlzLnByZWZpeCsnX2Zvcm1jb3Zlcl9Gb3JtX1BlbmNhcmlhbkRldGFpbCc7DQoJCWRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3c9J2hpZGRlbic7DQoJCWFkZENvdmVyUGFnZTIoY292ZXIsMSx0cnVlLGZhbHNlKTsNCgkJJC5hamF4KHsNCgkJCXR5cGU6J1BPU1QnLCANCgkJCWRhdGE6JCgnIycrdGhpcy5wcmVmaXgrIl9Gb3JtTGloYXREYXRhIikuc2VyaWFsaXplKCksDQoJCSAgCXVybDogdGhpcy51cmwrJyZ0aXBlPUZvcm1fUGVuY2FyaWFuRGV0YWlsJywNCgkJICAJc3VjY2VzczogZnVuY3Rpb24oZGF0YSkgewkJDQoJCQkJdmFyIHJlc3AgPSBldmFsKCcoJyArIGRhdGEgKyAnKScpOw0KCQkJCWRlbEVsZW0oY292ZXIpOw0KCQkJCWlmKHJlc3AuZXJyID09ICcnKXsNCgkJCQkJJCgiI0Zvcm1fUGVuY2FyaWFuRGV0YWlsIikuaHRtbChyZXNwLmNvbnRlbnQpOw0KCQkJCX1lbHNlew0KCQkJCQlhbGVydChyZXNwLmVycik7DQoJCQkJfQkNCgkJICAJfSwNCgkJCWVycm9yOiBmdW5jdGlvbiAoeGhyLCBhamF4T3B0aW9ucywgdGhyb3duRXJyb3IpIHsNCgkJCQlkZWxFbGVtKGNvdmVyKTsNCgkJCQltZS5Gb3JtX1BlbmNhcmlhbkRldGFpbCgpOw0KCSAgICAJfQ0KCQl9KTsNCgl9LA0KCQ0KCVViYWhCYXJhbmdEZXRhaWw6ZnVuY3Rpb24oKXsNCgkJdmFyIG1lID0gdGhpczsNCgkJdmFyIGNvdmVyID0gdGhpcy5wcmVmaXgrJ19mb3JtY292ZXJfVWJhaEJhcmFuZ0RldGFpbCc7DQoJCWRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3c9J2hpZGRlbic7DQoJCWFkZENvdmVyUGFnZTIoY292ZXIsOSx0cnVlLGZhbHNlKTsNCgkJJC5hamF4KHsNCgkJCXR5cGU6J1BPU1QnLCANCgkJCWRhdGE6JCgnIycrdGhpcy5wcmVmaXgrIl9Gb3JtTGloYXREYXRhIikuc2VyaWFsaXplKCksDQoJCSAgCXVybDogdGhpcy51cmwrJyZ0aXBlPUZvcm1fVWJhaEJhcmFuZ0RldGFpbCcsDQoJCSAgCXN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHsJCQ0KCQkJCXZhciByZXNwID0gZXZhbCgnKCcgKyBkYXRhICsgJyknKTsNCgkJCQlpZihyZXNwLmVyciA9PSAnJyl7DQoJCQkJCSQoIiMiK2NvdmVyKS5odG1sKHJlc3AuY29udGVudCk7DQoJCQkJfWVsc2V7DQoJCQkJCWFsZXJ0KHJlc3AuZXJyKTsNCgkJCQkJZGVsRWxlbShjb3Zlcik7DQoJCQkJfQkNCgkJICAJfSwNCgkJCWVycm9yOiBmdW5jdGlvbiAoeGhyLCBhamF4T3B0aW9ucywgdGhyb3duRXJyb3IpIHsNCgkJCQlkZWxFbGVtKGNvdmVyKTsNCgkJCQltZS5VYmFoQmFyYW5nRGV0YWlsKCk7DQoJICAgIAl9DQoJCX0pOw0KCX0sDQoJDQoJQ2xvc2VfVWJhaEJhcmFuZ0RldGFpbDpmdW5jdGlvbigpew0KCQl2YXIgbWUgPSB0aGlzOw0KCQl2YXIgY292ZXIgPSB0aGlzLnByZWZpeCsnX2Zvcm1jb3Zlcl9VYmFoQmFyYW5nRGV0YWlsJzsNCgkJZGVsRWxlbShjb3Zlcik7DQoJfSwNCgkJCQ0KCWNhcmlCYXJhbmc6ZnVuY3Rpb24oKXsNCgkJdmFyIG1lID0gdGhpczsNCgkJY2FyaUJhcmFuZy56aW5kZXg9MTE7DQoJCWNhcmlCYXJhbmcud2luZG93U2hvdyhtZS5wcmVmaXgrIl9mb3JtVWJhaERldGFpbCIpDQoJfSwNCgkNCglTaW1wYW5fVWJhaEJhcmFuZ0RldGFpbDpmdW5jdGlvbigpew0KCQl2YXIgbWUgPSB0aGlzOw0KCQl2YXIgY292ZXIgPSB0aGlzLnByZWZpeCsnX2Zvcm1jb3Zlcl9TaW1wYW5fVWJhaEJhcmFuZ0RldGFpbCc7DQoJCWRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3c9J2hpZGRlbic7DQoJCWFkZENvdmVyUGFnZTIoY292ZXIsOSx0cnVlLGZhbHNlKTsNCgkJJC5hamF4KHsNCgkJCXR5cGU6J1BPU1QnLCANCgkJCWRhdGE6JCgnIycrdGhpcy5wcmVmaXgrIl9mb3JtVWJhaERldGFpbCIpLnNlcmlhbGl6ZSgpLA0KCQkgIAl1cmw6IHRoaXMudXJsKycmdGlwZT1TaW1wYW5fVWJhaEJhcmFuZ0RldGFpbCcsDQoJCSAgCXN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHsJCQ0KCQkJCXZhciByZXNwID0gZXZhbCgnKCcgKyBkYXRhICsgJyknKTsJCQkJDQoJCQkJZGVsRWxlbShjb3Zlcik7DQoJCQkJaWYocmVzcC5lcnIgPT0gJycpew0KCQkJCQlhbGVydCgiRGF0YSBCZXJoYXNpbCBkaSBTaW1wYW4gISIpOw0KCQkJCQltZS5DbG9zZV9VYmFoQmFyYW5nRGV0YWlsKCk7DQoJCQkJCW1lLkxpaGF0RGF0YV9HZXREYXRhX0RldGFpbCgpOw0KCQkJCX1lbHNlew0KCQkJCQlhbGVydChyZXNwLmVycik7DQoJCQkJfQkNCgkJICAJfSwNCgkJCWVycm9yOiBmdW5jdGlvbiAoeGhyLCBhamF4T3B0aW9ucywgdGhyb3duRXJyb3IpIHsNCgkJCQlkZWxFbGVtKGNvdmVyKTsNCgkJCQlhbGVydCgiU2ViYWdpYW4gRGF0YSBHYWdhbCBEaSBQcm9zZXMuIE1vaG9uIFVsYW5naSBQZXJ1YmFoYW4gRGF0YSAhIik7DQoJICAgIAl9DQoJCX0pOw0KCX0sDQoJDQoJUG9zdGluZ0RldGFpbEJhcmFuZzpmdW5jdGlvbigpew0KCQl2YXIgbWUgPSB0aGlzOw0KCQl2YXIgY292ZXIgPSB0aGlzLnByZWZpeCsnX2Zvcm1jb3Zlcl9Qb3N0aW5nRGV0YWlsQmFyYW5nJzsNCgkJZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdz0naGlkZGVuJzsNCgkJYWRkQ292ZXJQYWdlMihjb3Zlciw5LHRydWUsZmFsc2UpOw0KCQkkLmFqYXgoew0KCQkJdHlwZTonUE9TVCcsIA0KCQkJZGF0YTokKCcjJyt0aGlzLnByZWZpeCsiX0Zvcm1MaWhhdERhdGEiKS5zZXJpYWxpemUoKSwNCgkJICAJdXJsOiB0aGlzLnVybCsnJnRpcGU9Rm9ybV9Qb3N0aW5nRGV0YWlsQmFyYW5nJywNCgkJICAJc3VjY2VzczogZnVuY3Rpb24oZGF0YSkgewkJDQoJCQkJdmFyIHJlc3AgPSBldmFsKCcoJyArIGRhdGEgKyAnKScpOw0KCQkJCWlmKHJlc3AuZXJyID09ICcnKXsNCgkJCQkJJCgiIyIrY292ZXIpLmh0bWwocmVzcC5jb250ZW50KTsNCgkJCQl9ZWxzZXsNCgkJCQkJYWxlcnQocmVzcC5lcnIpOw0KCQkJCQlkZWxFbGVtKGNvdmVyKTsNCgkJCQl9CQ0KCQkgIAl9LA0KCQkJZXJyb3I6IGZ1bmN0aW9uICh4aHIsIGFqYXhPcHRpb25zLCB0aHJvd25FcnJvcikgew0KCQkJCWRlbEVsZW0oY292ZXIpOw0KCQkJCW1lLlBvc3RpbmdEZXRhaWxCYXJhbmcoKTsNCgkgICAgCX0NCgkJfSk7DQoJfSwNCgkNCglDbG9zZV9Qb3N0aW5nRGV0YWlsQmFyYW5nOmZ1bmN0aW9uKCl7DQoJCXZhciBtZSA9IHRoaXM7DQoJCXZhciBjb3ZlciA9IHRoaXMucHJlZml4KydfZm9ybWNvdmVyX1Bvc3RpbmdEZXRhaWxCYXJhbmcnOw0KCQlpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb3ZlcikpZGVsRWxlbShjb3Zlcik7DQoJfSwNCgkNCglTaW1wYW5Qb3N0aW5nX1NpbmdsZTogZnVuY3Rpb24oKXsNCgkJdmFyIG1lPSB0aGlzOwkNCgkJDQoJCXRvdF9qbWxiYXJhbmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG90X2ptbGJhcmFuZycpLnZhbHVlOw0KCQl2YXIgY292ZXIxID0gdGhpcy5wcmVmaXgrJ19mb3JtTXVsYWlwb3N0aW5nMSc7DQoJCWFkZENvdmVyUGFnZTIoY292ZXIxLDEwLHRydWUsZmFsc2UpOw0KCQkJCQ0KCQkkLmFqYXgoew0KCQkJdHlwZTonUE9TVCcsIA0KCQkJZGF0YTokKCcjJyt0aGlzLnByZWZpeCsiX2Zvcm1QT1NUU2luZ2xlIikuc2VyaWFsaXplKCksDQoJCQl1cmw6IHRoaXMudXJsKycmdGlwZT1QZW5nZWNla2FuUG9zdGluZ19QZW5nYWRhYW5TaW5nbGUnLA0KCQkgIAlzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7CQkNCgkJCQl2YXIgcmVzcCA9IGV2YWwoJygnICsgZGF0YSArICcpJyk7DQoJCQkJZGVsRWxlbShjb3ZlcjEpOw0KCQkJCWlmKHJlc3AuZXJyPT0nJyl7DQoJCQkJCWlmKHJlc3AuY29udGVudC5rb25maXJtYXNpKXsNCgkJCQkJCWlmKHJlc3AuY29udGVudC5Ob1Bvc3Rpbmcpew0KCQkJCQkJCWFsZXJ0KHJlc3AuY29udGVudC5rb25maXJtYXNpKTsNCgkJCQkJCX1lbHNlew0KCQkJCQkJCWtvbmYgPSBjb25maXJtKHJlc3AuY29udGVudC5rb25maXJtYXNpKTsNCgkJCQkJCQlpZihrb25mID09IHRydWUpew0KCQkJCQkJCQlpZighcmVzcC5jb250ZW50LmVycil7DQoJCQkJCQkJCQltZS5TdGF0dXNQb3N0aW5nID0gMTsNCgkJCQkJCQkJCWlmKHJlc3AuY29udGVudC5rb25maXJtYXNpID09ICJCYXRhbGthbiBQb3N0aW5nIERhdGEgPyIpew0KCQkJCQkJCQkJCW1lLkJUTF9QT1NUSU5HPTA7DQoJCQkJCQkJCQkJc3RvcHdhdGNoLm5hbWUgPSAiVHVrVGltZXIiOw0KCQkJCQkJCQkJCXN0b3B3YXRjaC5NdWxhaSgpOw0KCQkJCQkJCQkJCW1lLkhhcHVzUG9zdGluZ19QZW5nYWRhYW5fU2luZ2xlKCk7DQoJCQkJCQkJCQl9ZWxzZXsNCgkJCQkJCQkJCQlpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaWRiYXJhbmdueWFfMCcpKXsNCgkJCQkJCQkJCQkJaWYoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImptbF9icmdfbmV4dFBPU1QiKSltZS5qbWxTZXRQT1NUID0gcGFyc2VJbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImptbF9icmdfbmV4dFBPU1QiKS52YWx1ZSk7CQkJCQkJDQoJCQkJCQkJCQkJCW1lLkpNTF9QT1NUSU5HPTA7DQoJCQkJCQkJCQkJCW1lLkFkYVlhbmdUYW55YT0wOw0KCQkJCQkJCQkJCQlKYWx1clBvc3QgPSBtZS5TZXRfUG9zdFRyYWNrKCk7DQoJCQkJCQkJCQkJCXN0b3B3YXRjaC5uYW1lID0gIlR1a1RpbWVyIjsNCgkJCQkJCQkJCQkJc3RvcHdhdGNoLk11bGFpKCk7DQoJCQkJCQkJCQkJCWlmKEphbHVyUG9zdCA+IDEgJiYgSmFsdXJQb3N0IDwgNSl7DQoJCQkJCQkJCQkJCQlmb3IoaT0xO2k8PUphbHVyUG9zdDtpKyspew0KCQkJCQkJCQkJCQkJCW1lLlByb3Nlc1Bvc3RpbmdfUGVuZ2FkYWFuX1NpbmdsZSgwLGkpOw0KCQkJCQkJCQkJCQkJfQ0KCQkJCQkJCQkJCQl9ZWxzZXsNCgkJCQkJCQkJCQkJCW1lLlByb3Nlc1Bvc3RpbmdfUGVuZ2FkYWFuX1NpbmdsZSgwLDEpOw0KCQkJCQkJCQkJCQl9CQ0KCQkJCQkJCQkJCQkNCgkJCQkJCQkJCQl9DQoJCQkJCQkJCQl9DQoJCQkJCQkJCX1lbHNlew0KCQkJCQkJCQkJYWxlcnQocmVzcC5jb250ZW50LmVycik7DQoJCQkJCQkJCX0NCgkJCQkJCQl9DQoJCQkJCQl9DQoJCQkJCQkJDQoJCQkJCX0NCgkJCQkJCQkNCgkJCQl9ZWxzZXsNCgkJCQkJYWxlcnQocmVzcC5lcnIpOw0KCQkJCX0NCgkJICAJfSwNCgkJCWVycm9yOiBmdW5jdGlvbiAoeGhyLCBhamF4T3B0aW9ucywgdGhyb3duRXJyb3IpIHsNCgkJCQlkZWxFbGVtKGNvdmVyMSk7DQoJCQkJbWUuU2ltcGFuUG9zdGluZ19TaW5nbGUoKTsNCgkgICAgCX0NCgkJCX0pOwkNCgl9LA0KCQ0KCVByb3Nlc1Bvc3RpbmdfUGVuZ2FkYWFuX1NpbmdsZTogZnVuY3Rpb24odXJ1dGFuLCBKYWx1cj0xKXsNCgkJdmFyIG1lID0gdGhpczsJCQkNCgkJdmFyIGNvdmVyID0gdGhpcy5wcmVmaXgrJ19mb3JtY292ZXJfcG9zdGluZyc7DQoJCQ0KCQlkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93PSdoaWRkZW4nOw0KCQkNCgkJSWREZXQgPSAkKCIjaWRiYXJhbmdueWFfIit1cnV0YW4pLnZhbCgpOw0KCQlTdGF0SWREZXQgPSAkKCIjc3RhdF9wb3N0XyIrSWREZXQpLnZhbCgpOw0KCQkNCgkJaWYoU3RhdElkRGV0ID09ICIwIil7DQoJCQltZS5TZXRBamF4VGltZShKYWx1cik7DQoJCQlpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGVtYXN1a2FuX2Zvcm1jb3Zlcl9sb2FkIikpZGVsRWxlbSgicGVtYXN1a2FuX2Zvcm1jb3Zlcl9sb2FkIik7DQoJCQlpZihtZS5TdGF0dXNQb3N0aW5nID09IDEpew0KCQkJCW1lLk11bGFpUG9zdGluZ19QZW5nYWRhYW4oKTsNCgkJCQltZS5TZXRfUE9TVF9UcmFjayhKYWx1ciwgMSk7DQoJCQkJJC5hamF4KHsNCgkJCQkJdHlwZTonUE9TVCcsIA0KCQkJCQlkYXRhOiQoJyMnK3RoaXMucHJlZml4KydfZm9ybVBPU1RTaW5nbGUnKS5zZXJpYWxpemUoKSwNCgkJCQkJdXJsOiB0aGlzLnVybCsnJnRpcGU9UHJvc2VzUG9zdGluZ19QZW5nYWRhYW4mU0lOR0xFREFUQT0xJlRSQUNLPScrSmFsdXIrJyZJZFBlbkRldD0nK0lkRGV0KyImVG90YWxTdWRhaFBvc3Rpbmc9IittZS5KTUxfUE9TVElORywNCgkJCQkgIAlzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7CQkNCgkJCQkJCXZhciByZXNwID0gZXZhbCgnKCcgKyBkYXRhICsgJyknKTsJCQkJCQ0KCQkJCQkJLy9kZWxFbGVtKGNvdmVyKTsJCQkJCQ0KCQkJCQkJbWUuU2V0X1BPU1RfVHJhY2soSmFsdXIsIDApOw0KCQkJCQkJaWYgKHJlc3AuZXJyID09Jycpew0KCQkJCQkJCW1lLlByb3Nlc1Bvc3RpbmdfUGVuZ2FkYWFuX0FmdGVyX1NpbmdsZSh1cnV0YW4sIHJlc3AuY29udGVudCk7DQoJCQkJCQkJbWUuTG9hZGluZ1Bvc3RpbmcocmVzcC5jb250ZW50KTsNCgkJCQkJCX1lbHNlew0KCQkJCQkJCW1lLlN0YXR1c1Bvc3RpbmcgPSAwOw0KCQkJCQkJCWRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3c9J2F1dG8nOw0KCQkJCQkJCXNldFRpbWVvdXQoZnVuY3Rpb24gbXlGdW5jdGlvbigpIHsNCgkJCQkJCQkJaWYoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInBlbWFzdWthbl9mb3JtY292ZXJfbG9hZCIpKWRlbEVsZW0oInBlbWFzdWthbl9mb3JtY292ZXJfbG9hZCIpOw0KCQkJCQkJCQlpZihKYWx1ciA9PSAxICYmIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwZW1hc3VrYW5fZm9ybWNvdmVyX1Bvc3RpbmdEZXRhaWxCYXJhbmciKSl7CQkNCgkJCQkJCQkJCWFsZXJ0KHJlc3AuZXJyKTsNCgkJCQkJCQkJCXN0b3B3YXRjaC5TdG9wKCk7DQoJCQkJCQkJCQlkZWxFbGVtKCJwZW1hc3VrYW5fZm9ybWNvdmVyX1Bvc3RpbmdEZXRhaWxCYXJhbmciKTsJCQkJCQ0KCQkJCQkJCQkJbWUuUG9zdGluZ0RldGFpbEJhcmFuZygpOw0KCQkJCQkJCQl9DQoJCQkJCQkJfSwxMDAwKTsNCgkJCQkJCX0NCgkJCQkgIAl9LA0KCQkJCQllcnJvcjogZnVuY3Rpb24gKHhociwgYWpheE9wdGlvbnMsIHRocm93bkVycm9yKSB7DQoJCQkJICAgICAgICAvL2RlbEVsZW0oY292ZXIpOw0KCQkJCQkJbWUuUHJvc2VzUG9zdGluZ19QZW5nYWRhYW5fU2luZ2xlKHVydXRhbik7DQoJCQkJCQltZS5TZXRfUE9TVF9UcmFjayhKYWx1ciwgMCk7DQoJCQkgICAgCX0NCgkJCQl9KTsNCgkJCX1lbHNlew0KCQkJCW1lLkxvYWRpbmdQb3N0aW5nX0VuZF9TaW5nbGUoKTsNCgkJCX0NCgkJfQkJDQoJfSwNCgkNCglQcm9zZXNQb3N0aW5nX1BlbmdhZGFhbl9BZnRlcl9TaW5nbGU6IGZ1bmN0aW9uKHVydXRhbiwga29udGVuLCBKYWx1cil7DQoJCXZhciBtZT10aGlzOw0KCQlqbWxTZXRQT1NUID0gbWUuam1sU2V0UE9TVDsNCgkJbWUuSk1MX1BPU1RJTkcgPSBOdW1iZXIobWUuSk1MX1BPU1RJTkcpICsgTnVtYmVyKGtvbnRlbi5qbWxfcHJvc2VzKTsJDQoJCQkNCgkJbWUuZnVuY3Rpb25fcGVyc2VuYW4oa29udGVuLnBlcnNlbl9kZXQpOw0KCQkkKCIja2V0X3RvdF9qbWxfcG9zdCIpLmh0bWwoa29udGVuLmptbF9iYXJhbmdfZGV0KTsJCQ0KCQltZS5HZXRUaW1lUG9zdGluZyhKYWx1cik7CQ0KCQltZS5TZXRfRGV0YWlsRGF0YVBvc3RpbmcoKTsJCQ0KCQkJCQ0KCQlpZihrb250ZW4uc2VsZXNhaV9kZXQgPT0gMSl7DQoJCQlzdG9wd2F0Y2guU3RvcCgpOw0KCQkJY2xlYXJUaW1lb3V0KG1lLkJhbmRpbmdXYWt0dSk7DQoJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uIG15RnVuY3Rpb24oKSB7DQoJCQkJYWxlcnQoIkRhdGEgSW5pIEJlcmhhc2lsIGRpIFBvc3RpbmcgISIpOwkJCQkNCgkJCQltZS5DbG9zZV9Qb3N0aW5nRGV0YWlsQmFyYW5nKCk7DQoJCQkJbWUuTGloYXREYXRhX0dldERhdGFfRGV0YWlsKCk7CQ0KCQkJfSwxMDAwKTsJCQkJDQoJCX1lbHNlewkNCgkJCWlmKGtvbnRlbi5MYW5nc3VuZyA9PSAiMSIgfHwgbWUuSk1MX1BPU1RJTkcgPj0gam1sU2V0UE9TVCl7DQoJCQkJYWxlcnQoIkRhdGEgSW5pIEJlcmhhc2lsIGRpIFBvc3RpbmcgISIpOw0KCQkJCWlmKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJwZW1hc3VrYW5fZm9ybWNvdmVyX2xvYWQiKSlkZWxFbGVtKCJwZW1hc3VrYW5fZm9ybWNvdmVyX2xvYWQiKTsNCgkJCQlzdG9wd2F0Y2guU3RvcCgpOw0KCQkJCWNsZWFyVGltZW91dChtZS5CYW5kaW5nV2FrdHUpOwkNCgkJCQltZS5TdGF0dXNQb3N0aW5nID0gMDsNCgkJCQltZS5Mb2FkaW5nUG9zdGluZ19FbmRfU2luZ2xlKCk7DQoJCQl9ZWxzZXsJCQkJDQoJCQkJbWUuUHJvc2VzUG9zdGluZ19QZW5nYWRhYW5fU2luZ2xlKHVydXRhbiwgSmFsdXIpOw0KCQkJfQ0KCQl9DQoJfSwNCgkNCglMb2FkaW5nUG9zdGluZ19FbmRfU2luZ2xlOiBmdW5jdGlvbigpew0KCQl2YXIgbWU9dGhpczsNCgkJaWYobWUuQ2VrX1BPU1RfVHJhY2soKSA9PSAwKXsNCgkJCWNsZWFyVGltZW91dChtZS5CYW5kaW5nV2FrdHUpOw0KCQkJaWYoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobWUucHJlZml4KyJfZm9ybWNvdmVyX1Bvc3RpbmdEZXRhaWxCYXJhbmciKSlkZWxFbGVtKG1lLnByZWZpeCsiX2Zvcm1jb3Zlcl9Qb3N0aW5nRGV0YWlsQmFyYW5nIik7DQoJCQltZS5Qb3N0aW5nRGV0YWlsQmFyYW5nKCk7DQoJCX0JCQ0KCX0sDQoJDQoJSGFwdXNQb3N0aW5nX1BlbmdhZGFhbl9BZnRlcl9TaW5nbGU6IGZ1bmN0aW9uKHJlc3Apew0KCQl2YXIgbWU9dGhpczsNCgkJJCgiI2tldF90b3Rfam1sX3Bvc3QiKS5odG1sKHJlc3AuY29udGVudC5KdW1sYWhCYXJhbmcpOw0KCQltZS5mdW5jdGlvbl9wZXJzZW5hbihyZXNwLmNvbnRlbnQucGVyc2VuKTsNCgkJbWUuR2V0VGltZVBvc3RpbmcoMSwyKTsNCgkJbWUuU2V0X0RldGFpbERhdGFQb3N0aW5nKDIpOw0KCQlpZihyZXNwLmNvbnRlbnQuUHJvc2VzID09ICJORVhUIil7DQoJCQlpZihyZXNwLmNvbnRlbnQuSm1sUHJvc2VzKXsNCgkJCQltZS5CVExfUE9TVElORyArPSBwYXJzZUludChyZXNwLmNvbnRlbnQuSm1sUHJvc2VzKTsNCgkJCQlEYXRhUGVuZ2F0dXJhbi5TZXRfY2VrRGNJRF92YWwoIlN1ZGFoUG9zdGluZ19EYXRhIiwgcmVzcC5jb250ZW50Lkp1bWxhaEJhcmFuZyk7DQoJCQkJaWYocGFyc2VJbnQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImptbF9icmdfbmV4dFBPU1QiKS52YWx1ZSkgPiBtZS5CVExfUE9TVElORyl7DQoJCQkJCW1lLkhhcHVzUG9zdGluZ19QZW5nYWRhYW5fU2luZ2xlKCk7DQoJCQkJfWVsc2V7DQoJCQkJCXN0b3B3YXRjaC5TdG9wKCk7DQoJCQkJCWNsZWFyVGltZW91dChtZS5CYW5kaW5nV2FrdHUpOw0KCQkJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uIG15RnVuY3Rpb24oKSB7DQoJCQkJCQlhbGVydCgiRGF0YSBJbmkgQmVyaGFzaWwgZGkgQmF0YWwgUG9zdGluZyAhIik7CQkJCQ0KCQkJCQkJbWUuQ2xvc2VfUG9zdGluZ0RldGFpbEJhcmFuZygpOw0KCQkJCQkJbWUuTGloYXREYXRhX0dldERhdGFfRGV0YWlsKCk7CQ0KCQkJCQl9LDEwMDApOwkJCQkJDQoJCQkJfQkJCQkJCQkNCgkJCX1lbHNlew0KCQkJCW1lLkhhcHVzUG9zdGluZ19QZW5nYWRhYW5fU2luZ2xlKCk7DQoJCQl9CQkJDQoJCQkJDQoJCX1lbHNlewkJCQkJCQkNCgkJCXNldFRpbWVvdXQoZnVuY3Rpb24gbXlGdW5jdGlvbigpIHsNCgkJCQlhbGVydCgiRGF0YSBJbmkgQmVyaGFzaWwgZGkgQmF0YWwgUG9zdGluZyAhIik7CQkJCQ0KCQkJCW1lLkNsb3NlX1Bvc3RpbmdEZXRhaWxCYXJhbmcoKTsNCgkJCQltZS5MaWhhdERhdGFfR2V0RGF0YV9EZXRhaWwoKTsJDQoJCQl9LDEwMDApOw0KCQkJbWUucmVmcmVzaExpc3QoKTsNCgkJCXN0b3B3YXRjaC5TdG9wKCk7DQoJCX0NCgl9LA0KCQ0KCUhhcHVzUG9zdGluZ19QZW5nYWRhYW5fU2luZ2xlOiBmdW5jdGlvbigpewkNCgkJdmFyIG1lPXRoaXM7CQkNCgkJaWYobWUuU3RhdHVzUG9zdGluZyA9PSAxKXsNCgkJCW1lLlNldEFqYXhUaW1lKDEpOw0KCQkJbWUuTXVsYWlQb3N0aW5nX1BlbmdhZGFhbigpOw0KCQkJbWUuTG9hZGluZ1Bvc3RpbmcoIiIpOw0KCQkJJC5hamF4KHsNCgkJCQl0eXBlOidQT1NUJywgDQoJCQkJZGF0YTokKCcjJyt0aGlzLnByZWZpeCsiX2Zvcm1QT1NUU2luZ2xlIikuc2VyaWFsaXplKCksDQoJCQkJdXJsOiB0aGlzLnVybCsnJnRpcGU9SGFwdXNQb3N0aW5nX1NpbmdsZSZCVExfSEFQVVNDRUs9JyttZS5CVExfUE9TVElORywNCgkJCQlzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7CQkNCgkJCQkJdmFyIHJlc3AgPSBldmFsKCcoJyArIGRhdGEgKyAnKScpOw0KCQkJCQlpZihyZXNwLmVycj09Jycpew0KCQkJCQkJbWUuSGFwdXNQb3N0aW5nX1BlbmdhZGFhbl9BZnRlcl9TaW5nbGUocmVzcCk7CQkJCQkNCgkJCQkJfWVsc2V7DQoJCQkJCQlpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgicGVtYXN1a2FuX2Zvcm1jb3Zlcl9Qb3N0aW5nRGV0YWlsQmFyYW5nIikpewkJCQkJCQ0KCQkJCQkJCWFsZXJ0KHJlc3AuZXJyKTsNCgkJCQkJCQlzdG9wd2F0Y2guU3RvcCgpOw0KCQkJCQkJCWRlbEVsZW0oInBlbWFzdWthbl9mb3JtY292ZXJfUG9zdGluZ0RldGFpbEJhcmFuZyIpOwkJCQkJDQoJCQkJCQkJbWUuUG9zdGluZ0RldGFpbEJhcmFuZygpOw0KCQkJCQkJfQ0KCQkJCQl9DQoJCQkJfSwNCgkJCQllcnJvcjogZnVuY3Rpb24gKHhociwgYWpheE9wdGlvbnMsIHRocm93bkVycm9yKSB7DQoJCQkJCW1lLkhhcHVzUG9zdGluZ19QZW5nYWRhYW5fU2luZ2xlKCk7DQoJCSAgICAJfQ0KCQkJfSk7CQ0KCQl9ZWxzZXsNCgkJCW1lLkxvYWRpbmdQb3N0aW5nX0VuZF9TaW5nbGUoKTsNCgkJfQ0KCX0sDQoJDQp9KTsNCg==",
    "size": "51742"
}