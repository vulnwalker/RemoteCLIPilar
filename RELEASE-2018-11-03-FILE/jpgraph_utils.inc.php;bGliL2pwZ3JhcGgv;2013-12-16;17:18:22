{
    "namaFile": "lib\/jpgraph\/jpgraph_utils.inc.php",
    "lastUpdate": "2013-12-16+17:18:22.00",
    "contentFile": "PD9waHAKLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogLy8gRmlsZTogICAgICAgIEpQR1JBUEhfVVRJTFMuSU5DCiAvLyBEZXNjcmlwdGlvbjogQ29sbGVjdGlvbiBvZiBub24tZXNzZW50aWFsICJuaWNlIHRvIGhhdmUiIHV0aWxpdGllcwogLy8gQ3JlYXRlZDogICAgIDIwMDUtMTEtMjAKIC8vIFZlcjogICAgICAgICAkSWQ6IGpwZ3JhcGhfdXRpbHMuaW5jLnBocCAxNzc3IDIwMDktMDgtMjMgMTc6MzQ6MzZaIGxqcCAkCiAvLwogLy8gQ29weXJpZ2h0IChjKSBBc2lhbCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAqLwoKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gQ0xBU1MgRnVuY0dlbmVyYXRvcgovLyBEZXNjcmlwdGlvbjogVXRpbGl0eSBjbGFzcyB0byBoZWxwIGdlbmVyYXRlIGRhdGEgZm9yIGZ1bmN0aW9uIHBsb3RzLgovLyBUaGUgY2xhc3Mgc3VwcG9ydHMgYm90aCBwYXJhbWV0cmljIGFuZCByZWd1bGFyIGZ1bmN0aW9ucy4KLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KY2xhc3MgRnVuY0dlbmVyYXRvciB7CiAgICBwcml2YXRlICRpRnVuYz0nJywkaVhGdW5jPScnLCRpTWluLCRpTWF4LCRpU3RlcFNpemU7CgogICAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGFGdW5jLCRhWEZ1bmM9JycpIHsKICAgICAgICAkdGhpcy0+aUZ1bmMgPSAkYUZ1bmM7CiAgICAgICAgJHRoaXMtPmlYRnVuYyA9ICRhWEZ1bmM7CiAgICB9CgogICAgZnVuY3Rpb24gRSgkYVhNaW4sJGFYTWF4LCRhU3RlcHM9NTApIHsKICAgICAgICAkdGhpcy0+aU1pbiA9ICRhWE1pbjsKICAgICAgICAkdGhpcy0+aU1heCA9ICRhWE1heDsKICAgICAgICAkdGhpcy0+aVN0ZXBTaXplID0gKCRhWE1heC0kYVhNaW4pLyRhU3RlcHM7CgogICAgICAgIGlmKCAkdGhpcy0+aVhGdW5jICE9ICcnICkKICAgICAgICAkdCA9ICdmb3IoJGk9Jy4kYVhNaW4uJzsgJGk8PScuJGFYTWF4Lic7ICRpICs9ICcuJHRoaXMtPmlTdGVwU2l6ZS4nKSB7JHlhW109Jy4kdGhpcy0+aUZ1bmMuJzskeGFbXT0nLiR0aGlzLT5pWEZ1bmMuJzt9JzsKICAgICAgICBlbHNlaWYoICR0aGlzLT5pRnVuYyAhPSAnJyApCiAgICAgICAgJHQgPSAnZm9yKCR4PScuJGFYTWluLic7ICR4PD0nLiRhWE1heC4nOyAkeCArPSAnLiR0aGlzLT5pU3RlcFNpemUuJykgeyR5YVtdPScuJHRoaXMtPmlGdW5jLic7JHhhW109JHg7fSAkeD0nLiRhWE1heC4nOyR5YVtdPScuJHRoaXMtPmlGdW5jLic7JHhhW109JHg7JzsKICAgICAgICBlbHNlCiAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoMjQwMDEpOy8vKCdGdW5jR2VuZXJhdG9yIDogTm8gZnVuY3Rpb24gc3BlY2lmaWVkLiAnKTsKCiAgICAgICAgQGV2YWwoJHQpOwoKICAgICAgICAvLyBJZiB0aGVyZSBpcyBhbiBlcnJvciBpbiB0aGUgZnVuY3Rpb24gc3BlY2lmY2F0aW9uIHRoaXMgaXMgdGhlIG9ubHkKICAgICAgICAvLyB3YXkgd2UgY2FuIGRpc2NvdmVyIHRoYXQuCiAgICAgICAgaWYoIGVtcHR5KCR4YSkgfHwgZW1wdHkoJHlhKSApCiAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoMjQwMDIpOy8vKCdGdW5jR2VuZXJhdG9yIDogU3ludGF4IGVycm9yIGluIGZ1bmN0aW9uIHNwZWNpZmljYXRpb24gJyk7CgogICAgICAgIHJldHVybiBhcnJheSgkeGEsJHlhKTsKICAgIH0KfQoKCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gQ0xBU1MgRGF0ZVNjYWxlVXRpbHMKLy8gRGVzY3JpcHRpb246IEhlbHAgdG8gY3JlYXRlIGEgbWFudWFsIGRhdGUgc2NhbGUKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpkZWZpbmUoJ0RTVVRJTFNfTU9OVEgnLDEpOyAvLyBNYWpvciBhbmQgbWlub3IgdGlja3Mgb24gYSBtb250aGx5IGJhc2lzCmRlZmluZSgnRFNVVElMU19NT05USDEnLDEpOyAvLyBNYWpvciBhbmQgbWlub3IgdGlja3Mgb24gYSBtb250aGx5IGJhc2lzCmRlZmluZSgnRFNVVElMU19NT05USDInLDIpOyAvLyBNYWpvciB0aWNrcyBvbiBhIGJpLW1vbnRobHkgYmFzaXMKZGVmaW5lKCdEU1VUSUxTX01PTlRIMycsMyk7IC8vIE1ham9yIGlja3Mgb24gYSB0cmktbW9udGhseSBiYXNpcwpkZWZpbmUoJ0RTVVRJTFNfTU9OVEg2Jyw0KTsgLy8gTWFqb3Igb24gYSBzaXgtbW9udGhseSBiYXNpcwpkZWZpbmUoJ0RTVVRJTFNfV0VFSzEnLDUpOyAvLyBNYWpvciB0aWNrcyBvbiBhIHdlZWtseSBiYXNpcwpkZWZpbmUoJ0RTVVRJTFNfV0VFSzInLDYpOyAvLyBNYWpvciB0aWNrcyBvbiBhIGJpLXdlZWtseSBiYXNpcwpkZWZpbmUoJ0RTVVRJTFNfV0VFSzQnLDcpOyAvLyBNYWpvciB0aWNrcyBvbiBhIHF1b2Qtd2Vla2x5IGJhc2lzCmRlZmluZSgnRFNVVElMU19EQVkxJyw4KTsgLy8gTWFqb3IgdGlja3Mgb24gYSBkYWlseSBiYXNpcwpkZWZpbmUoJ0RTVVRJTFNfREFZMicsOSk7IC8vIE1ham9yIHRpY2tzIG9uIGEgYmktZGFpbHkgYmFzaXMKZGVmaW5lKCdEU1VUSUxTX0RBWTQnLDEwKTsgLy8gTWFqb3IgdGlja3Mgb24gYSBxb3VkLWRhaWx5IGJhc2lzCmRlZmluZSgnRFNVVElMU19ZRUFSMScsMTEpOyAvLyBNYWpvciB0aWNrcyBvbiBhIHllYXJseSBiYXNpcwpkZWZpbmUoJ0RTVVRJTFNfWUVBUjInLDEyKTsgLy8gTWFqb3IgdGlja3Mgb24gYSBiaS15ZWFybHkgYmFzaXMKZGVmaW5lKCdEU1VUSUxTX1lFQVI1JywxMyk7IC8vIE1ham9yIHRpY2tzIG9uIGEgZml2ZS15ZWFybHkgYmFzaXMKCgpjbGFzcyBEYXRlU2NhbGVVdGlscyB7CiAgICBwdWJsaWMgc3RhdGljICRpTWluPTAsICRpTWF4PTA7CgogICAgcHJpdmF0ZSBzdGF0aWMgJHN0YXJ0aG91ciwkc3RhcnRtb250aCwgJHN0YXJ0ZGF5LCAkc3RhcnR5ZWFyOwogICAgcHJpdmF0ZSBzdGF0aWMgJGVuZG1vbnRoLCAkZW5keWVhciwgJGVuZGRheTsKICAgIHByaXZhdGUgc3RhdGljICR0aWNrUG9zaXRpb25zPWFycmF5KCksJG1pblRpY2tQb3NpdGlvbnM9YXJyYXkoKTsKICAgIHByaXZhdGUgc3RhdGljICRpVXNlV2Vla3MgPSB0cnVlOwoKICAgIHN0YXRpYyBmdW5jdGlvbiBVc2VXZWVrRm9ybWF0KCRhRmxnKSB7CiAgICAgICAgc2VsZjo6JGlVc2VXZWVrcyA9ICRhRmxnOwogICAgfQoKICAgIHN0YXRpYyBmdW5jdGlvbiBkb1llYXJseSgkYVR5cGUsJGFNaW5vcj1mYWxzZSkgewogICAgICAgICRpPTA7ICRqPTA7CiAgICAgICAgJG0gPSBzZWxmOjokc3RhcnRtb250aDsKICAgICAgICAkeSA9IHNlbGY6OiRzdGFydHllYXI7CgogICAgICAgIGlmKCBzZWxmOjokc3RhcnRkYXkgPT0gMSApIHsKICAgICAgICAgICAgc2VsZjo6JHRpY2tQb3NpdGlvbnNbJGkrK10gPSBta3RpbWUoMCwwLDAsJG0sMSwkeSk7CiAgICAgICAgfQogICAgICAgICsrJG07CgoKICAgICAgICBzd2l0Y2goICRhVHlwZSApIHsKICAgICAgICAgICAgY2FzZSBEU1VUSUxTX1lFQVIxOgogICAgICAgICAgICAgICAgZm9yKCR5PXNlbGY6OiRzdGFydHllYXI7ICR5IDw9IHNlbGY6OiRlbmR5ZWFyOyArKyR5ICkgewogICAgICAgICAgICAgICAgICAgIGlmKCAkYU1pbm9yICkgewogICAgICAgICAgICAgICAgICAgICAgICB3aGlsZSggJG0gPD0gMTIgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiggISgkeSA9PSBzZWxmOjokZW5keWVhciAmJiAkbSA+IHNlbGY6OiRlbmRtb250aCkgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZjo6JG1pblRpY2tQb3NpdGlvbnNbJGorK10gPSBta3RpbWUoMCwwLDAsJG0sMSwkeSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICArKyRtOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICRtPTE7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHNlbGY6OiR0aWNrUG9zaXRpb25zWyRpKytdID0gbWt0aW1lKDAsMCwwLDEsMSwkeSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBEU1VUSUxTX1lFQVIyOgogICAgICAgICAgICAgICAgJHk9c2VsZjo6JHN0YXJ0eWVhcjsKICAgICAgICAgICAgICAgIHdoaWxlKCAkeSA8PSBzZWxmOjokZW5keWVhciApIHsKICAgICAgICAgICAgICAgICAgICBzZWxmOjokdGlja1Bvc2l0aW9uc1skaSsrXSA9IG1rdGltZSgwLDAsMCwxLDEsJHkpOwogICAgICAgICAgICAgICAgICAgIGZvcigkaz0wOyAkayA8IDE7ICsrJGsgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICsrJHk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAkYU1pbm9yICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZjo6JG1pblRpY2tQb3NpdGlvbnNbJGorK10gPSBta3RpbWUoMCwwLDAsMSwxLCR5KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICArKyR5OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgRFNVVElMU19ZRUFSNToKICAgICAgICAgICAgICAgICR5PXNlbGY6OiRzdGFydHllYXI7CiAgICAgICAgICAgICAgICB3aGlsZSggJHkgPD0gc2VsZjo6JGVuZHllYXIgKSB7CiAgICAgICAgICAgICAgICAgICAgc2VsZjo6JHRpY2tQb3NpdGlvbnNbJGkrK10gPSBta3RpbWUoMCwwLDAsMSwxLCR5KTsKICAgICAgICAgICAgICAgICAgICBmb3IoJGs9MDsgJGsgPCA0OyArKyRrICkgewogICAgICAgICAgICAgICAgICAgICAgICArKyR5OwogICAgICAgICAgICAgICAgICAgICAgICBpZiggJGFNaW5vciApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGY6OiRtaW5UaWNrUG9zaXRpb25zWyRqKytdID0gbWt0aW1lKDAsMCwwLDEsMSwkeSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgKyskeTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgIH0KCiAgICBzdGF0aWMgZnVuY3Rpb24gZG9EYWlseSgkYVR5cGUsJGFNaW5vcj1mYWxzZSkgewogICAgICAgICRtID0gc2VsZjo6JHN0YXJ0bW9udGg7CiAgICAgICAgJHkgPSBzZWxmOjokc3RhcnR5ZWFyOwogICAgICAgICRkID0gc2VsZjo6JHN0YXJ0ZGF5OwogICAgICAgICRoID0gc2VsZjo6JHN0YXJ0aG91cjsKICAgICAgICAkaT0wOyRqPTA7CgogICAgICAgIGlmKCAkaCA9PSAwICkgewogICAgICAgICAgICBzZWxmOjokdGlja1Bvc2l0aW9uc1skaSsrXSA9IG1rdGltZSgwLDAsMCwkbSwkZCwkeSk7CiAgICAgICAgfQogICAgICAgICR0ID0gbWt0aW1lKDAsMCwwLCRtLCRkLCR5KTsKCiAgICAgICAgc3dpdGNoKCRhVHlwZSkgewogICAgICAgICAgICBjYXNlIERTVVRJTFNfREFZMToKICAgICAgICAgICAgICAgIHdoaWxlKCAkdCA8PSBzZWxmOjokaU1heCApIHsKICAgICAgICAgICAgICAgICAgICAkdCA9IHN0cnRvdGltZSgnKzEgZGF5JywkdCk7CiAgICAgICAgICAgICAgICAgICAgc2VsZjo6JHRpY2tQb3NpdGlvbnNbJGkrK10gPSAkdDsKICAgICAgICAgICAgICAgICAgICBpZiggJGFNaW5vciApIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZjo6JG1pblRpY2tQb3NpdGlvbnNbJGorK10gPSBzdHJ0b3RpbWUoJysxMiBob3VycycsJHQpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIERTVVRJTFNfREFZMjoKICAgICAgICAgICAgICAgIHdoaWxlKCAkdCA8PSBzZWxmOjokaU1heCApIHsKICAgICAgICAgICAgICAgICAgICAkdCA9IHN0cnRvdGltZSgnKzEgZGF5JywkdCk7CiAgICAgICAgICAgICAgICAgICAgaWYoICRhTWlub3IgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGY6OiRtaW5UaWNrUG9zaXRpb25zWyRqKytdID0gJHQ7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICR0ID0gc3RydG90aW1lKCcrMSBkYXknLCR0KTsKICAgICAgICAgICAgICAgICAgICBzZWxmOjokdGlja1Bvc2l0aW9uc1skaSsrXSA9ICR0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgRFNVVElMU19EQVk0OgogICAgICAgICAgICAgICAgd2hpbGUoICR0IDw9IHNlbGY6OiRpTWF4ICkgewogICAgICAgICAgICAgICAgICAgIGZvcigkaz0wOyAkayA8IDM7ICsrJGsgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICR0ID0gc3RydG90aW1lKCcrMSBkYXknLCR0KTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoICRhTWlub3IgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmOjokbWluVGlja1Bvc2l0aW9uc1skaisrXSA9ICR0OwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICR0ID0gc3RydG90aW1lKCcrMSBkYXknLCR0KTsKICAgICAgICAgICAgICAgICAgICBzZWxmOjokdGlja1Bvc2l0aW9uc1skaSsrXSA9ICR0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQoKICAgIHN0YXRpYyBmdW5jdGlvbiBkb1dlZWtseSgkYVR5cGUsJGFNaW5vcj1mYWxzZSkgewogICAgICAgICRocGQgPSAzNjAwKjI0OwogICAgICAgICRocHcgPSAzNjAwKjI0Kjc7CiAgICAgICAgLy8gRmluZCBvdXQgd2VlayBudW1iZXIgb2YgbWluIGRhdGUKICAgICAgICAkdGh1cnNkYXkgPSBzZWxmOjokaU1pbiArICRocGQgKiAoMyAtIChkYXRlKCd3Jywgc2VsZjo6JGlNaW4pICsgNikgJSA3KTsKICAgICAgICAkd2VlayA9IDEgKyAoZGF0ZSgneicsICR0aHVyc2RheSkgLSAoMTEgLSBkYXRlKCd3JywgbWt0aW1lKDAsIDAsIDAsIDEsIDEsIGRhdGUoJ1knLCAkdGh1cnNkYXkpKSkpICUgNykgLyA3OwogICAgICAgICRkYXludW1iZXIgPSBkYXRlKCd3JyxzZWxmOjokaU1pbik7CiAgICAgICAgaWYoICRkYXludW1iZXIgPT0gMCApICRkYXludW1iZXIgPSA3OwogICAgICAgICRtID0gc2VsZjo6JHN0YXJ0bW9udGg7CiAgICAgICAgJHkgPSBzZWxmOjokc3RhcnR5ZWFyOwogICAgICAgICRkID0gc2VsZjo6JHN0YXJ0ZGF5OwogICAgICAgICRpPTA7JGo9MDsKICAgICAgICAvLyBUaGUgYXNzdW1wdGlvbiBpcyB0aGF0IHRoZSB3ZWVrcyBzdGFydCBvbiBNb25kYXkuIElmIHRoZSBmaXJzdCBkYXkKICAgICAgICAvLyBpcyBsYXRlciBpbiB0aGUgd2VlayB0aGVuIHRoZSBmaXJzdCB3ZWVrIHRpY2sgaGFzIHRvIGJlIG9uIHRoZSBmb2xsb3dpbmcKICAgICAgICAvLyB3ZWVrLgogICAgICAgIGlmKCAkZGF5bnVtYmVyID09IDEgKSB7CiAgICAgICAgICAgIHNlbGY6OiR0aWNrUG9zaXRpb25zWyRpKytdID0gbWt0aW1lKDAsMCwwLCRtLCRkLCR5KTsKICAgICAgICAgICAgJHQgPSBta3RpbWUoMCwwLDAsJG0sJGQsJHkpICsgJGhwdzsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICR0ID0gbWt0aW1lKDAsMCwwLCRtLCRkLCR5KSArICRocGQqKDgtJGRheW51bWJlcik7CiAgICAgICAgfQoKICAgICAgICBzd2l0Y2goJGFUeXBlKSB7CiAgICAgICAgICAgIGNhc2UgRFNVVElMU19XRUVLMToKICAgICAgICAgICAgICAgICRjbnQ9MDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIERTVVRJTFNfV0VFSzI6CiAgICAgICAgICAgICAgICAkY250PTE7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBEU1VUSUxTX1dFRUs0OgogICAgICAgICAgICAgICAgJGNudD0zOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIHdoaWxlKCAkdCA8PSBzZWxmOjokaU1heCApIHsKICAgICAgICAgICAgc2VsZjo6JHRpY2tQb3NpdGlvbnNbJGkrK10gPSAkdDsKICAgICAgICAgICAgZm9yKCRrPTA7ICRrIDwgJGNudDsgKyskayApIHsKICAgICAgICAgICAgICAgICR0ICs9ICRocHc7CiAgICAgICAgICAgICAgICBpZiggJGFNaW5vciApIHsKICAgICAgICAgICAgICAgICAgICBzZWxmOjokbWluVGlja1Bvc2l0aW9uc1skaisrXSA9ICR0OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgICR0ICs9ICRocHc7CiAgICAgICAgfQogICAgfQoKICAgIHN0YXRpYyBmdW5jdGlvbiBkb01vbnRobHkoJGFUeXBlLCRhTWlub3I9ZmFsc2UpIHsKICAgICAgICAkbW9udGhjb3VudD0wOwogICAgICAgICRtID0gc2VsZjo6JHN0YXJ0bW9udGg7CiAgICAgICAgJHkgPSBzZWxmOjokc3RhcnR5ZWFyOwogICAgICAgICRpPTA7ICRqPTA7CgogICAgICAgIC8vIFNraXAgdGhlIGZpcnN0IG1vbnRoIGxhYmVsIGlmIGl0IGlzIGJlZm9yZSB0aGUgc3RhcnRkYXRlCiAgICAgICAgaWYoIHNlbGY6OiRzdGFydGRheSA9PSAxICkgewogICAgICAgICAgICBzZWxmOjokdGlja1Bvc2l0aW9uc1skaSsrXSA9IG1rdGltZSgwLDAsMCwkbSwxLCR5KTsKICAgICAgICAgICAgJG1vbnRoY291bnQ9MTsKICAgICAgICB9CiAgICAgICAgaWYoICRhVHlwZSA9PSAxICkgewogICAgICAgICAgICBpZiggc2VsZjo6JHN0YXJ0ZGF5IDwgMTUgKSB7CiAgICAgICAgICAgICAgICBzZWxmOjokbWluVGlja1Bvc2l0aW9uc1skaisrXSA9IG1rdGltZSgwLDAsMCwkbSwxNSwkeSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgKyskbTsKCiAgICAgICAgLy8gTG9vcCB0aHJvdWdoIGFsbCB0aGUgeWVhcnMgaW5jbHVkZWQgaW4gdGhlIHNjYWxlCiAgICAgICAgZm9yKCR5PXNlbGY6OiRzdGFydHllYXI7ICR5IDw9IHNlbGY6OiRlbmR5ZWFyOyArKyR5ICkgewogICAgICAgICAgICAvLyBMb29wIHRocm91Z2ggYWxsIHRoZSBtb250aHMuIFRoZXJlIGFyZSB0aHJlZSBjYXNlcyB0byBjb25zaWRlcjoKICAgICAgICAgICAgLy8gMS4gV2UgYXJlIGluIHRoZSBmaXJzdCB5ZWFyIGFuZCBtdXN0IHN0YXJ0IHdpdGggdGhlIHN0YXJ0bW9udGgKICAgICAgICAgICAgLy8gMi4gV2UgYXJlIGluIHRoZSBlbmQgeWVhciBhbmQgd2UgbXVzdCBzdG9wIGF0IGxhc3QgbW9udGggb2YgdGhlIHNjYWxlCiAgICAgICAgICAgIC8vIDMuIEEgeWVhciBpbiBiZXR3ZWVuIHdoZXJlIHdlIHJ1biB0aHJvdWdoIGFsbCB0aGUgMTIgbW9udGhzCiAgICAgICAgICAgICRzdG9wbW9udGggPSAkeSA9PSBzZWxmOjokZW5keWVhciA\/IHNlbGY6OiRlbmRtb250aCA6IDEyOwogICAgICAgICAgICB3aGlsZSggJG0gPD0gJHN0b3Btb250aCApIHsKICAgICAgICAgICAgICAgIHN3aXRjaCggJGFUeXBlICkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgRFNVVElMU19NT05USDE6CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCBtaW5vciB0aWNrIGF0IHRoZSBtaWRkbGUgb2YgdGhlIG1vbnRoCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAkYU1pbm9yICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoICRtIDw9ICRzdG9wbW9udGggKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoICEoJHk9PXNlbGY6OiRlbmR5ZWFyICYmICRtPT0kc3RvcG1vbnRoICYmIHNlbGY6OiRlbmRkYXkgPCAxNSkgKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGY6OiRtaW5UaWNrUG9zaXRpb25zWyRqKytdID0gbWt0aW1lKDAsMCwwLCRtLDE1LCR5KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAvLyBNYWpvciBhdCBtb250aAogICAgICAgICAgICAgICAgICAgICAgICAvLyBHZXQgdGltZXN0YW1wIG9mIGZpcnN0IGhvdXIgb2YgZmlyc3QgZGF5IGluIGVhY2ggbW9udGgKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZjo6JHRpY2tQb3NpdGlvbnNbJGkrK10gPSBta3RpbWUoMCwwLDAsJG0sMSwkeSk7CgogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIERTVVRJTFNfTU9OVEgyOgogICAgICAgICAgICAgICAgICAgICAgICBpZiggJGFNaW5vciApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNldCBtaW5vciB0aWNrIGF0IHN0YXJ0IG9mIGVhY2ggbW9udGgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGY6OiRtaW5UaWNrUG9zaXRpb25zWyRqKytdID0gbWt0aW1lKDAsMCwwLCRtLDEsJHkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAvLyBNYWpvciBhdCBldmVyeSBzZWNvbmQgbW9udGgKICAgICAgICAgICAgICAgICAgICAgICAgLy8gR2V0IHRpbWVzdGFtcCBvZiBmaXJzdCBob3VyIG9mIGZpcnN0IGRheSBpbiBlYWNoIG1vbnRoCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAkbW9udGhjb3VudCAlIDIgPT0gMCApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGY6OiR0aWNrUG9zaXRpb25zWyRpKytdID0gbWt0aW1lKDAsMCwwLCRtLDEsJHkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgRFNVVElMU19NT05USDM6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAkYU1pbm9yICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2V0IG1pbm9yIHRpY2sgYXQgc3RhcnQgb2YgZWFjaCBtb250aAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZjo6JG1pblRpY2tQb3NpdGlvbnNbJGorK10gPSBta3RpbWUoMCwwLDAsJG0sMSwkeSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFqb3IgYXQgZXZlcnkgdGhpcmQgbW9udGgKICAgICAgICAgICAgICAgICAgICAgICAgLy8gR2V0IHRpbWVzdGFtcCBvZiBmaXJzdCBob3VyIG9mIGZpcnN0IGRheSBpbiBlYWNoIG1vbnRoCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAkbW9udGhjb3VudCAlIDMgPT0gMCApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGY6OiR0aWNrUG9zaXRpb25zWyRpKytdID0gbWt0aW1lKDAsMCwwLCRtLDEsJHkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgRFNVVElMU19NT05USDY6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAkYU1pbm9yICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gU2V0IG1pbm9yIHRpY2sgYXQgc3RhcnQgb2YgZWFjaCBtb250aAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZjo6JG1pblRpY2tQb3NpdGlvbnNbJGorK10gPSBta3RpbWUoMCwwLDAsJG0sMSwkeSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWFqb3IgYXQgZXZlcnkgdGhpcmQgbW9udGgKICAgICAgICAgICAgICAgICAgICAgICAgLy8gR2V0IHRpbWVzdGFtcCBvZiBmaXJzdCBob3VyIG9mIGZpcnN0IGRheSBpbiBlYWNoIG1vbnRoCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAkbW9udGhjb3VudCAlIDYgPT0gMCApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGY6OiR0aWNrUG9zaXRpb25zWyRpKytdID0gbWt0aW1lKDAsMCwwLCRtLDEsJHkpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKyskbTsKICAgICAgICAgICAgICAgICsrJG1vbnRoY291bnQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJG09MTsKICAgICAgICB9CgogICAgICAgIC8vIEZvciB0aGUgY2FzZSB3aGVyZSBhbGwgZGF0ZXMgYXJlIHdpdGhpbiB0aGUgc2FtZSBtb250aAogICAgICAgIC8vIHdlIHdhbnQgdG8gbWFrZSBzdXJlIHdlIGhhdmUgYXQgbGVhc3QgdHdvIHRpY2tzIG9uIHRoZSBzY2FsZQogICAgICAgIC8vIHNpbmNlIHRoZSBzY2FsZSB3YW50IHdvcmsgcHJvcGVybHkgb3RoZXJ3aXNlCiAgICAgICAgaWYoc2VsZjo6JHN0YXJ0bW9udGggPT0gc2VsZjo6JGVuZG1vbnRoICYmIHNlbGY6OiRzdGFydHllYXIgPT0gc2VsZjo6JGVuZHllYXIgJiYgJGFUeXBlPT0xICkgewogICAgICAgICAgICBzZWxmOjokdGlja1Bvc2l0aW9uc1skaSsrXSA9IG1rdGltZSgwICwwICwwLCBzZWxmOjokc3RhcnRtb250aCArIDEsIDEsIHNlbGY6OiRzdGFydHllYXIpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGFycmF5KHNlbGY6OiR0aWNrUG9zaXRpb25zLHNlbGY6OiRtaW5UaWNrUG9zaXRpb25zKTsKICAgIH0KCiAgICBzdGF0aWMgZnVuY3Rpb24gR2V0VGlja3MoJGFEYXRhLCRhVHlwZT0xLCRhTWlub3I9ZmFsc2UsJGFFbmRQb2ludHM9ZmFsc2UpIHsKICAgICAgICAkbiA9IGNvdW50KCRhRGF0YSk7CiAgICAgICAgcmV0dXJuIHNlbGY6OkdldFRpY2tzRnJvbU1pbk1heCgkYURhdGFbMF0sJGFEYXRhWyRuLTFdLCRhVHlwZSwkYU1pbm9yLCRhRW5kUG9pbnRzKTsKICAgIH0KCiAgICBzdGF0aWMgZnVuY3Rpb24gR2V0QXV0b1RpY2tzKCRhTWluLCRhTWF4LCRhTWF4VGlja3M9MTAsJGFNaW5vcj1mYWxzZSkgewogICAgICAgICRkaWZmID0gJGFNYXggLSAkYU1pbjsKICAgICAgICAkc3BkID0gMzYwMCoyNDsKICAgICAgICAkc3B3ID0gJHNwZCo3OwogICAgICAgICRzcG0gPSAkc3BkKjMwOwogICAgICAgICRzcHkgPSAkc3BkKjM1MjsKCiAgICAgICAgaWYoIHNlbGY6OiRpVXNlV2Vla3MgKQogICAgICAgICR3ID0gJ1cnOwogICAgICAgIGVsc2UKICAgICAgICAkdyA9ICdkIE0nOwoKICAgICAgICAvLyBEZWNpc2lvbiB0YWJsZSBmb3Igc3VpdGFibGUgc2NhbGVzCiAgICAgICAgLy8gRmlyc3QgdmFsdWU6IE1haW4gZGVjaXNpb24gcG9pbnQKICAgICAgICAvLyBTZWNvbmQgdmFsdWU6IEFycmF5IG9mIGZvcm1hdHRpbmcgZGVwZW5kaW5nIG9uIGRpdmlzb3IgZm9yIHdhbnRlZCBtYXggbnVtYmVyIG9mIHRpY2tzLiA8ZGl2aXNvcj48Zm9ybWF0dGluZz48Zm9ybWF0LXN0cmluZz4sLi4KICAgICAgICAkdHQgPSBhcnJheSgKICAgICAgICAgICAgYXJyYXkoJHNwdywgYXJyYXkoMSxEU1VUSUxTX0RBWTEsJ2QgTScsMixEU1VUSUxTX0RBWTIsJ2QgTScsLTEsRFNVVElMU19EQVk0LCdkIE0nKSksCiAgICAgICAgICAgIGFycmF5KCRzcG0sIGFycmF5KDEsRFNVVElMU19EQVkxLCdkIE0nLDIsRFNVVElMU19EQVkyLCdkIE0nLDQsRFNVVElMU19EQVk0LCdkIE0nLDcsRFNVVElMU19XRUVLMSwkdywtMSxEU1VUSUxTX1dFRUsyLCR3KSksCiAgICAgICAgICAgIGFycmF5KCRzcHksIGFycmF5KDEsRFNVVElMU19EQVkxLCdkIE0nLDIsRFNVVElMU19EQVkyLCdkIE0nLDQsRFNVVElMU19EQVk0LCdkIE0nLDcsRFNVVElMU19XRUVLMSwkdywxNCxEU1VUSUxTX1dFRUsyLCR3LDMwLERTVVRJTFNfTU9OVEgxLCdNJyw2MCxEU1VUSUxTX01PTlRIMiwnTScsLTEsRFNVVElMU19NT05USDMsJ00nKSksCiAgICAgICAgICAgIGFycmF5KC0xLCBhcnJheSgzMCxEU1VUSUxTX01PTlRIMSwnTS1ZJyw2MCxEU1VUSUxTX01PTlRIMiwnTS1ZJyw5MCxEU1VUSUxTX01PTlRIMywnTS1ZJywxODAsRFNVVElMU19NT05USDYsJ00tWScsMzUyLERTVVRJTFNfWUVBUjEsJ1knLDcwNCxEU1VUSUxTX1lFQVIyLCdZJywtMSxEU1VUSUxTX1lFQVI1LCdZJykpKTsKCiAgICAgICAgJG50dCA9IGNvdW50KCR0dCk7CiAgICAgICAgJG5kID0gZmxvb3IoJGRpZmYvJHNwZCk7CiAgICAgICAgZm9yKCRpPTA7ICRpIDwgJG50dDsgKyskaSApIHsKICAgICAgICAgICAgaWYoICRkaWZmIDw9ICR0dFskaV1bMF0gfHwgJGk9PSRudHQtMSkgewogICAgICAgICAgICAgICAgJHQgPSAkdHRbJGldWzFdOwogICAgICAgICAgICAgICAgJG4gPSBjb3VudCgkdCkvMzsKICAgICAgICAgICAgICAgIGZvciggJGo9MDsgJGogPCAkbjsgKyskaiApIHsKICAgICAgICAgICAgICAgICAgICBpZiggJG5kLyR0WzMqJGpdIDw9ICRhTWF4VGlja3MgfHwgJGo9PSRuLTEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHR5cGUgPSAkdFszKiRqKzFdOwogICAgICAgICAgICAgICAgICAgICAgICAkZnMgPSAkdFszKiRqKzJdOwogICAgICAgICAgICAgICAgICAgICAgICBsaXN0KCR0aWNrUG9zaXRpb25zLCRtaW5UaWNrUG9zaXRpb25zKSA9IHNlbGY6OkdldFRpY2tzRnJvbU1pbk1heCgkYU1pbiwkYU1heCwkdHlwZSwkYU1pbm9yKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFycmF5KCRmcywkdGlja1Bvc2l0aW9ucywkbWluVGlja1Bvc2l0aW9ucywkdHlwZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIHN0YXRpYyBmdW5jdGlvbiBHZXRUaWNrc0Zyb21NaW5NYXgoJGFNaW4sJGFNYXgsJGFUeXBlLCRhTWlub3I9ZmFsc2UsJGFFbmRQb2ludHM9ZmFsc2UpIHsKICAgICAgICBzZWxmOjokc3RhcnRob3VyID0gZGF0ZSgnRycsJGFNaW4pOwogICAgICAgIHNlbGY6OiRzdGFydG1vbnRoID0gZGF0ZSgnbicsJGFNaW4pOwogICAgICAgIHNlbGY6OiRzdGFydGRheSA9IGRhdGUoJ2onLCRhTWluKTsKICAgICAgICBzZWxmOjokc3RhcnR5ZWFyID0gZGF0ZSgnWScsJGFNaW4pOwogICAgICAgIHNlbGY6OiRlbmRtb250aCA9IGRhdGUoJ24nLCRhTWF4KTsKICAgICAgICBzZWxmOjokZW5keWVhciA9IGRhdGUoJ1knLCRhTWF4KTsKICAgICAgICBzZWxmOjokZW5kZGF5ID0gZGF0ZSgnaicsJGFNYXgpOwogICAgICAgIHNlbGY6OiRpTWluID0gJGFNaW47CiAgICAgICAgc2VsZjo6JGlNYXggPSAkYU1heDsKCiAgICAgICAgaWYoICRhVHlwZSA8PSBEU1VUSUxTX01PTlRINiApIHsKICAgICAgICAgICAgc2VsZjo6ZG9Nb250aGx5KCRhVHlwZSwkYU1pbm9yKTsKICAgICAgICB9CiAgICAgICAgZWxzZWlmKCAkYVR5cGUgPD0gRFNVVElMU19XRUVLNCApIHsKICAgICAgICAgICAgc2VsZjo6ZG9XZWVrbHkoJGFUeXBlLCRhTWlub3IpOwogICAgICAgIH0KICAgICAgICBlbHNlaWYoICRhVHlwZSA8PSBEU1VUSUxTX0RBWTQgKSB7CiAgICAgICAgICAgIHNlbGY6OmRvRGFpbHkoJGFUeXBlLCRhTWlub3IpOwogICAgICAgIH0KICAgICAgICBlbHNlaWYoICRhVHlwZSA8PSBEU1VUSUxTX1lFQVI1ICkgewogICAgICAgICAgICBzZWxmOjpkb1llYXJseSgkYVR5cGUsJGFNaW5vcik7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBKcEdyYXBoRXJyb3I6OlJhaXNlTCgyNDAwMyk7CiAgICAgICAgfQogICAgICAgIC8vIHB1dCBhIGxhYmVsIGF0IHRoZSB2ZXJ5IGxlZnQgZGF0YSBwb3MKICAgICAgICBpZiggJGFFbmRQb2ludHMgKSB7CiAgICAgICAgICAgICR0aWNrUG9zaXRpb25zWyRpKytdID0gJGFEYXRhWzBdOwogICAgICAgIH0KCiAgICAgICAgLy8gcHV0IGEgbGFiZWwgYXQgdGhlIHZlcnkgcmlnaHQgZGF0YSBwb3MKICAgICAgICBpZiggJGFFbmRQb2ludHMgKSB7CiAgICAgICAgICAgICR0aWNrUG9zaXRpb25zWyRpXSA9ICRhRGF0YVskbi0xXTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBhcnJheShzZWxmOjokdGlja1Bvc2l0aW9ucyxzZWxmOjokbWluVGlja1Bvc2l0aW9ucyk7CiAgICB9Cn0KCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gQ2xhc3MgUmVhZEZpbGVEYXRhCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KQ2xhc3MgUmVhZEZpbGVEYXRhIHsKICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgLy8gRGVzY2lwdGlvbjoKICAgIC8vIFJlYWQgbnVtZXJpYyBkYXRhIGZyb20gYSBmaWxlLgogICAgLy8gRWFjaCB2YWx1ZSBzaG91bGQgYmUgc2VwYXJhdGVkIGJ5IGVpdGhlciBhIG5ldyBsaW5lIG9yIGJ5IGEgc3BlY2lmaWVkCiAgICAvLyBzZXBhcmF0b3IgY2hhcmFjdGVyIChkZWZhdWx0IGlzICcsJykuCiAgICAvLyBCZWZvcmUgcmV0dXJuaW5nIHRoZSBkYXRhIGVhY2ggdmFsdWUgaXMgY29udmVydGVkIHRvIGEgcHJvcGVyIGZsb2F0CiAgICAvLyB2YWx1ZS4gVGhlIHJvdXRpbmUgaXMgcm9idXN0IGluIHRoZSBzZW5zZSB0aGF0IG5vbiBudW1lcmljIGRhdGEgaW4gdGhlCiAgICAvLyBmaWxlIHdpbGwgYmUgZGlzY2FyZGVkLgogICAgLy8KICAgIC8vIFJldHVybnM6CiAgICAvLyBUaGUgbnVtYmVyIG9mIGRhdGEgdmFsdWVzIHJlYWQgb24gc3VjY2VzcywgRkFMU0Ugb24gZmFpbHVyZQogICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICBzdGF0aWMgZnVuY3Rpb24gRnJvbUNTVigkYUZpbGUsJiRhRGF0YSwkYVNlcENoYXI9JywnLCRhTWF4TGluZUxlbmd0aD0xMDI0KSB7CiAgICAgICAgJHJoID0gQGZvcGVuKCRhRmlsZSwncicpOwogICAgICAgIGlmKCAkcmggPT09IGZhbHNlICkgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgICAkdG1wID0gYXJyYXkoKTsKICAgICAgICAkbGluZW9mZGF0YSA9IGZnZXRjc3YoJHJoLCAxMDAwLCAnLCcpOwogICAgICAgIHdoaWxlICggJGxpbmVvZmRhdGEgIT09IEZBTFNFKSB7CiAgICAgICAgICAgICR0bXAgPSBhcnJheV9tZXJnZSgkdG1wLCRsaW5lb2ZkYXRhKTsKICAgICAgICAgICAgJGxpbmVvZmRhdGEgPSBmZ2V0Y3N2KCRyaCwgJGFNYXhMaW5lTGVuZ3RoLCAkYVNlcENoYXIpOwogICAgICAgIH0KICAgICAgICBmY2xvc2UoJHJoKTsKCiAgICAgICAgLy8gTm93IG1ha2Ugc3VyZSB0aGF0IGFsbCBkYXRhIGlzIG51bWVyaWMuIEJ5IGRlZmF1bHQKICAgICAgICAvLyBhbGwgZGF0YSBpcyByZWFkIGFzIHN0cmluZ3MKICAgICAgICAkbiA9IGNvdW50KCR0bXApOwogICAgICAgICRhRGF0YSA9IGFycmF5KCk7CiAgICAgICAgJGNudD0wOwogICAgICAgIGZvcigkaT0wOyAkaSA8ICRuOyArKyRpKSB7CiAgICAgICAgICAgIGlmKCAkdG1wWyRpXSAhPT0gIiIgKSB7CiAgICAgICAgICAgICAgICAkYURhdGFbJGNudCsrXSA9IGZsb2F0dmFsKCR0bXBbJGldKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gJGNudDsKICAgIH0KCiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICAgIC8vIERlc2NpcHRpb246CiAgICAvLyBSZWFkIG51bWVyaWMgZGF0YSBmcm9tIGEgZmlsZS4KICAgIC8vIEVhY2ggdmFsdWUgc2hvdWxkIGJlIHNlcGFyYXRlZCBieSBlaXRoZXIgYSBuZXcgbGluZSBvciBieSBhIHNwZWNpZmllZAogICAgLy8gc2VwYXJhdG9yIGNoYXJhY3RlciAoZGVmYXVsdCBpcyAnLCcpLgogICAgLy8gQmVmb3JlIHJldHVybmluZyB0aGUgZGF0YSBlYWNoIHZhbHVlIGlzIGNvbnZlcnRlZCB0byBhIHByb3BlciBmbG9hdAogICAgLy8gdmFsdWUuIFRoZSByb3V0aW5lIGlzIHJvYnVzdCBpbiB0aGUgc2Vuc2UgdGhhdCBub24gbnVtZXJpYyBkYXRhIGluIHRoZQogICAgLy8gZmlsZSB3aWxsIGJlIGRpc2NhcmRlZC4KICAgIC8vCiAgICAvLyBPcHRpb25zOgogICAgLy8gJ3NlcGFyYXRvcicgICAgID0+ICcsJywKICAgIC8vICdlbmNsb3N1cmUnICAgICA9PiAnIicsCiAgICAvLyAncmVhZGxlbmd0aCcgICAgPT4gMTAyNCwKICAgIC8vICdpZ25vcmVfZmlyc3QnICA9PiBmYWxzZSwKICAgIC8vICdmaXJzdF9hc19rZXknICA9PiBmYWxzZQogICAgLy8gJ2VzY2FwZScgICAgICAgID0+ICdcJywgICAjIFBIUCA+PSA1LjMgb25seQogICAgLy8KICAgIC8vIFJldHVybnM6CiAgICAvLyBUaGUgbnVtYmVyIG9mIGxpbmVzIHJlYWQgb24gc3VjY2VzcywgRkFMU0Ugb24gZmFpbHVyZQogICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAgICBzdGF0aWMgZnVuY3Rpb24gRnJvbUNTVjIoJGFGaWxlLCAmJGFEYXRhLCAkYU9wdGlvbnMgPSBhcnJheSgpKSB7CiAgICAgICAgJGFEZWZhdWx0cyA9IGFycmF5KAogICAgICAgICAgICAnc2VwYXJhdG9yJyAgICAgPT4gJywnLAogICAgICAgICAgICAnZW5jbG9zdXJlJyAgICAgPT4gY2hyKDM0KSwKICAgICAgICAgICAgJ2VzY2FwZScgICAgICAgID0+IGNocig5MiksCiAgICAgICAgICAgICdyZWFkbGVuZ3RoJyAgICA9PiAxMDI0LAogICAgICAgICAgICAnaWdub3JlX2ZpcnN0JyAgPT4gZmFsc2UsCiAgICAgICAgICAgICdmaXJzdF9hc19rZXknICA9PiBmYWxzZQogICAgICAgICAgICApOwoKICAgICAgICAkYU9wdGlvbnMgPSBhcnJheV9tZXJnZSgKICAgICAgICAgICAgJGFEZWZhdWx0cywgaXNfYXJyYXkoJGFPcHRpb25zKSA\/ICRhT3B0aW9ucyA6IGFycmF5KCkpOwoKICAgICAgICBpZiggJGFPcHRpb25zWydmaXJzdF9hc19rZXknXSApIHsKICAgICAgICAgICAgJGFPcHRpb25zWydpZ25vcmVfZmlyc3QnXSA9ICB0cnVlOwogICAgICAgIH0KCiAgICAgICAgJHJoID0gQGZvcGVuKCRhRmlsZSwgJ3InKTsKCiAgICAgICAgaWYoICRyaCA9PT0gZmFsc2UgKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CgogICAgICAgICRhRGF0YSAgPSBhcnJheSgpOwogICAgICAgICRhTGluZSAgPSBmZ2V0Y3N2KCRyaCwKICAgICAgICAgICAgICAgICAgICAgICAgICAkYU9wdGlvbnNbJ3JlYWRsZW5ndGgnXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAkYU9wdGlvbnNbJ3NlcGFyYXRvciddLAogICAgICAgICAgICAgICAgICAgICAgICAgICRhT3B0aW9uc1snZW5jbG9zdXJlJ10KICAgICAgICAgICAgICAgICAgICAgICAgICAvKiwgJGFPcHRpb25zWydlc2NhcGUnXSAgICAgIyBQSFAgPj0gNS4zIG9ubHkgKi8KICAgICAgICAgICAgICAgICAgICAgICAgICApOwoKICAgICAgICAvLyBVc2UgbnVtZXJpYyBhcnJheSBrZXlzIGZvciB0aGUgY29sdW1ucyBieSBkZWZhdWx0CiAgICAgICAgLy8gSWYgc3BlY2lmaWVkIHVzZSBmaXJzdCBsaW5lcyB2YWx1ZXMgYXMgYXNzb2Mga2V5cyBpbnN0ZWFkCiAgICAgICAgJGtleXMgPSBhcnJheV9rZXlzKCRhTGluZSk7CiAgICAgICAgaWYoICRhT3B0aW9uc1snZmlyc3RfYXNfa2V5J10gKSB7CiAgICAgICAgICAgICRrZXlzID0gYXJyYXlfdmFsdWVzKCRhTGluZSk7CiAgICAgICAgfQoKICAgICAgICAkbnVtX2xpbmVzID0gMDsKICAgICAgICAkbnVtX2NvbHMgID0gY291bnQoJGFMaW5lKTsKCiAgICAgICAgd2hpbGUgKCRhTGluZSAhPT0gZmFsc2UpIHsKICAgICAgICAgICAgaWYoIGlzX2FycmF5KCRhTGluZSkgJiYgY291bnQoJGFMaW5lKSAhPSAkbnVtX2NvbHMgKSB7CiAgICAgICAgICAgICAgICBKcEdyYXBoRXJyb3I6OlJhaXNlTCgyNDAwNCk7CiAgICAgICAgICAgICAgICAvLyAnUmVhZENTVjI6IENvbHVtbiBjb3VudCBtaXNtYXRjaCBpbiAlcyBsaW5lICVkJwogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyBmZ2V0Y3N2IHJldHVybnMgTlVMTCBmb3IgZW1wdHkgbGluZXMKICAgICAgICAgICAgaWYoICFpc19udWxsKCRhTGluZSkgKSB7CiAgICAgICAgICAgICAgICAkbnVtX2xpbmVzKys7CgogICAgICAgICAgICAgICAgaWYoICEoJGFPcHRpb25zWydpZ25vcmVfZmlyc3QnXSAmJiAkbnVtX2xpbmVzID09IDEpICYmIGlzX251bWVyaWMoJGFMaW5lWzBdKSApIHsKICAgICAgICAgICAgICAgICAgICBmb3IoICRpID0gMDsgJGkgPCAkbnVtX2NvbHM7ICRpKysgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRhRGF0YVsgJGtleXNbJGldIF1bXSA9IGZsb2F0dmFsKCRhTGluZVskaV0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgJGFMaW5lID0gZmdldGNzdigkcmgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGFPcHRpb25zWydyZWFkbGVuZ3RoJ10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGFPcHRpb25zWydzZXBhcmF0b3InXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYU9wdGlvbnNbJ2VuY2xvc3VyZSddCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyosICRhT3B0aW9uc1snZXNjYXBlJ10gICAgICMgUEhQID49IDUuMyBvbmx5Ki8KICAgICAgICAgICAgICAgICk7CiAgICAgICAgfQoKICAgICAgICBmY2xvc2UoJHJoKTsKCiAgICAgICAgaWYoICRhT3B0aW9uc1snaWdub3JlX2ZpcnN0J10gKSB7CiAgICAgICAgICAgICRudW1fbGluZXMtLTsKICAgICAgICB9CgogICAgICAgIHJldHVybiAkbnVtX2xpbmVzOwogICAgfQoKICAgIC8vIFJlYWQgZGF0YSBmcm9tIHR3byBjb2x1bW5zIGluIGEgcGxhaW4gdGV4dCBmaWxlCiAgICBzdGF0aWMgZnVuY3Rpb24gRnJvbTJDb2woJGFGaWxlLCAkYUNvbDEsICRhQ29sMiwgJGFTZXBDaGFyPScgJykgewogICAgICAgICRsaW5lcyA9IEBmaWxlKCRhRmlsZSxGSUxFX0lHTk9SRV9ORVdfTElORVN8RklMRV9TS0lQX0VNUFRZX0xJTkVTKTsKICAgICAgICBpZiggJGxpbmVzID09PSBmYWxzZSApIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgJHMgPSAnL1tcc10rLyc7CiAgICAgICAgaWYoICRhU2VwQ2hhciA9PSAnLCcgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRzID0gJy9bXHNdKixbXHNdKi8nOwogICAgICAgIH0KICAgICAgICBlbHNlaWYoICRhU2VwQ2hhciA9PSAnOycgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRzID0gJy9bXHNdKjtbXHNdKi8nOwogICAgICAgIH0KICAgICAgICBmb3JlYWNoKCAkbGluZXMgYXMgJGxpbmUgPT4gJGRhdGFyb3cgKSB7CiAgICAgICAgICAgICAgICAkc3BsaXQgPSBwcmVnX3NwbGl0KCRzLCRkYXRhcm93KTsKICAgICAgICAgICAgICAgICRhQ29sMVtdID0gZmxvYXR2YWwodHJpbSgkc3BsaXRbMF0pKTsKICAgICAgICAgICAgICAgICRhQ29sMltdID0gZmxvYXR2YWwodHJpbSgkc3BsaXRbMV0pKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBjb3VudCgkbGluZXMpOwogICAgfQoKICAgIC8vIFJlYWQgZGF0YSBmcm9tIG9uZSBjb2x1bW5zIGluIGEgcGxhaW4gdGV4dCBmaWxlCiAgICBzdGF0aWMgZnVuY3Rpb24gRnJvbTFDb2woJGFGaWxlLCAkYUNvbDEpIHsKICAgICAgICAkbGluZXMgPSBAZmlsZSgkYUZpbGUsRklMRV9JR05PUkVfTkVXX0xJTkVTfEZJTEVfU0tJUF9FTVBUWV9MSU5FUyk7CiAgICAgICAgaWYoICRsaW5lcyA9PT0gZmFsc2UgKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGZvcmVhY2goICRsaW5lcyBhcyAkbGluZSA9PiAkZGF0YXJvdyApIHsKICAgICAgICAgICAgICAgICRhQ29sMVtdID0gZmxvYXR2YWwodHJpbSgkZGF0YXJvdykpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIGNvdW50KCRsaW5lcyk7CiAgICB9CgogICAgc3RhdGljIGZ1bmN0aW9uIEZyb21NYXRyaXgoJGFGaWxlLCRhU2VwQ2hhcj0nICcpIHsKICAgICAgICAkbGluZXMgPSBAZmlsZSgkYUZpbGUsRklMRV9JR05PUkVfTkVXX0xJTkVTfEZJTEVfU0tJUF9FTVBUWV9MSU5FUyk7CiAgICAgICAgaWYoICRsaW5lcyA9PT0gZmFsc2UgKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgICRtYXQgPSBhcnJheSgpOwogICAgICAgICRyZWcgPSAnLycuJGFTZXBDaGFyLicvJzsKICAgICAgICBmb3JlYWNoKCAkbGluZXMgYXMgJGxpbmUgPT4gJGRhdGFyb3cgKSB7CiAgICAgICAgICAgICAgICAkcm93ID0gcHJlZ19zcGxpdCgkcmVnLHRyaW0oJGRhdGFyb3cpKTsKICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRyb3cgYXMgJGtleSA9PiAkY2VsbCApIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHJvd1ska2V5XSA9IGZsb2F0dmFsKHRyaW0oJGNlbGwpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICRtYXRbXSA9ICRyb3c7CiAgICAgICAgfQogICAgICAgIHJldHVybiAkbWF0OwogICAgfQoKCn0KCmRlZmluZSgnX19MUl9FUFNJTE9OJywgMS4wZS04KTsKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQovLyBDbGFzcyBMaW5lYXJSZWdyZXNzaW9uCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KY2xhc3MgTGluZWFyUmVncmVzc2lvbiB7CiAgICAgICAgcHJpdmF0ZSAkaXg9YXJyYXkoKSwkaXk9YXJyYXkoKTsKICAgICAgICBwcml2YXRlICRpYj0wLCAkaWE9MDsKICAgICAgICBwcml2YXRlICRpY2FsY3VsYXRlZD1mYWxzZTsKICAgICAgICBwdWJsaWMgJGlEZXQ9MCwgJGlDb3JyPTAsICRpU3RkRXJyPTA7CgogICAgICAgIHB1YmxpYyBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkYURhdGFYLCRhRGF0YVkpIHsKICAgICAgICAgICAgICAgIGlmKCBjb3VudCgkYURhdGFYKSAhPT0gY291bnQoJGFEYXRhWSkgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEpwR3JhcGg6OlJhaXNlKCdMaW5lYXJSZWdyZXNzaW9uOiBYIGFuZCBZIGRhdGEgYXJyYXkgbXVzdCBiZSBvZiBlcXVhbCBsZW5ndGguJyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkdGhpcy0+aXggPSAkYURhdGFYOwogICAgICAgICAgICAgICAgJHRoaXMtPml5ID0gJGFEYXRhWTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBmdW5jdGlvbiBDYWxjKCkgewoKICAgICAgICAgICAgICAgICR0aGlzLT5pY2FsY3VsYXRlZCA9IHRydWU7CgogICAgICAgICAgICAgICAgJG4gPSBjb3VudCgkdGhpcy0+aXgpOwogICAgICAgICAgICAgICAgJHN4MiA9IDAgOwogICAgICAgICAgICAgICAgJHN5MiA9IDAgOwogICAgICAgICAgICAgICAgJHN4eSA9IDAgOwogICAgICAgICAgICAgICAgJHN4ID0gMCA7CiAgICAgICAgICAgICAgICAkc3kgPSAwIDsKCiAgICAgICAgICAgICAgICBmb3IoICRpPTA7ICRpIDwgJG47ICsrJGkgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRzeDIgKz0gJHRoaXMtPml4WyRpXSAqICR0aGlzLT5peFskaV07CiAgICAgICAgICAgICAgICAgICAgICAgICRzeTIgKz0gJHRoaXMtPml5WyRpXSAqICR0aGlzLT5peVskaV07CiAgICAgICAgICAgICAgICAgICAgICAgICRzeHkgKz0gJHRoaXMtPml4WyRpXSAqICR0aGlzLT5peVskaV07CiAgICAgICAgICAgICAgICAgICAgICAgICRzeCArPSAkdGhpcy0+aXhbJGldOwogICAgICAgICAgICAgICAgICAgICAgICAkc3kgKz0gJHRoaXMtPml5WyRpXTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiggJG4qJHN4MiAtICRzeCokc3ggPiBfX0xSX0VQU0lMT04gKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5pYiA9ICgkbiokc3h5IC0gJHN4KiRzeSkgLyAoICRuKiRzeDIgLSAkc3gqJHN4ICk7CiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5pYSA9ICggJHN5IC0gJHRoaXMtPmliKiRzeCApIC8gJG47CgogICAgICAgICAgICAgICAgICAgICAgICAkc3ggPSAkdGhpcy0+aWIgKiAoICRzeHkgLSAkc3gqJHN5LyRuICk7CiAgICAgICAgICAgICAgICAgICAgICAgICRzeTIgPSAkc3kyIC0gJHN5KiRzeS8kbjsKICAgICAgICAgICAgICAgICAgICAgICAgJHN5ID0gJHN5MiAtICRzeDsKCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5pRGV0ID0gJHN4IC8gJHN5MjsKICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmlDb3JyID0gc3FydCgkdGhpcy0+aURldCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAkbiA+IDIgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmlTdGRFcnIgPSBzcXJ0KCAkc3kgLyAoJG4tMikgKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+aVN0ZEVyciA9IE5BTiA7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+aWIgPSAwOwogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+aWEgPSAwOwogICAgICAgICAgICAgICAgfQoKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRBQigpIHsKICAgICAgICAgICAgICAgIGlmKCAkdGhpcy0+aWNhbGN1bGF0ZWQgPT0gZmFsc2UgKQogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Q2FsYygpOwogICAgICAgICAgICAgICAgcmV0dXJuIGFycmF5KCR0aGlzLT5pYSwgJHRoaXMtPmliKTsKICAgICAgICB9CgogICAgICAgIHB1YmxpYyBmdW5jdGlvbiBHZXRTdGF0KCkgewogICAgICAgICAgICAgICAgaWYoICR0aGlzLT5pY2FsY3VsYXRlZCA9PSBmYWxzZSApCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5DYWxjKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gYXJyYXkoJHRoaXMtPmlTdGRFcnIsICR0aGlzLT5pQ29yciwgJHRoaXMtPmlEZXQpOwogICAgICAgIH0KCiAgICAgICAgcHVibGljIGZ1bmN0aW9uIEdldFkoJGFNaW5YLCAkYU1heFgsICRhU3RlcD0xKSB7CiAgICAgICAgICAgICAgICBpZiggJHRoaXMtPmljYWxjdWxhdGVkID09IGZhbHNlICkKICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPkNhbGMoKTsKCiAgICAgICAgICAgICAgICAkeXkgPSBhcnJheSgpOwogICAgICAgICAgICAgICAgJGkgPSAwOwogICAgICAgICAgICAgICAgZm9yKCAkeD0kYU1pblg7ICR4IDw9ICRhTWF4WDsgJHggKz0gJGFTdGVwICkgewogICAgICAgICAgICAgICAgICAgICAgICAkeHhbJGkgIF0gPSAkeDsKICAgICAgICAgICAgICAgICAgICAgICAgJHl5WyRpKytdID0gJHRoaXMtPmlhICsgJHRoaXMtPmliICogJHg7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIGFycmF5KCR4eCwkeXkpOwogICAgICAgIH0KCn0KCj8+Cg==",
    "size": "25399"
}