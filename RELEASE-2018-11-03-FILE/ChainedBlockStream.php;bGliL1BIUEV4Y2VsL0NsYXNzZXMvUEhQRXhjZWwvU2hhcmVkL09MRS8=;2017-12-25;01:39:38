{
    "namaFile": "lib\/PHPExcel\/Classes\/PHPExcel\/Shared\/OLE\/ChainedBlockStream.php",
    "lastUpdate": "2017-12-25+01:39:38.00",
    "contentFile": "PD9waHAKCi8qKgogKiBQSFBFeGNlbF9TaGFyZWRfT0xFX0NoYWluZWRCbG9ja1N0cmVhbQogKgogKiBDb3B5cmlnaHQgKGMpIDIwMDYgLSAyMDE1IFBIUEV4Y2VsCiAqCiAqIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKICogbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYwogKiBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKICogdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiAqCiAqIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAogKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgogKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVQogKiBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgogKgogKiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCiAqIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgd3JpdGUgdG8gdGhlIEZyZWUgU29mdHdhcmUKICogRm91bmRhdGlvbiwgSW5jLiwgNTEgRnJhbmtsaW4gU3RyZWV0LCBGaWZ0aCBGbG9vciwgQm9zdG9uLCBNQSAgMDIxMTAtMTMwMSAgVVNBCiAqCiAqIEBjYXRlZ29yeSAgIFBIUEV4Y2VsCiAqIEBwYWNrYWdlICAgIFBIUEV4Y2VsX1NoYXJlZF9PTEUKICogQGNvcHlyaWdodCAgQ29weXJpZ2h0IChjKSAyMDA2IC0gMjAwNyBDaHJpc3RpYW4gU2NobWlkdAogKiBAbGljZW5zZSAgICBodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvb2xkLWxpY2Vuc2VzL2xncGwtMi4xLnR4dCAgICBMR1BMCiAqIEB2ZXJzaW9uICMjVkVSU0lPTiMjLCAjI0RBVEUjIwogKi8KY2xhc3MgUEhQRXhjZWxfU2hhcmVkX09MRV9DaGFpbmVkQmxvY2tTdHJlYW0KewogICAgLyoqCiAgICAgKiBUaGUgT0xFIGNvbnRhaW5lciBvZiB0aGUgZmlsZSB0aGF0IGlzIGJlaW5nIHJlYWQuCiAgICAgKiBAdmFyIE9MRQogICAgICovCiAgICBwdWJsaWMgJG9sZTsKCiAgICAvKioKICAgICAqIFBhcmFtZXRlcnMgc3BlY2lmaWVkIGJ5IGZvcGVuKCkuCiAgICAgKiBAdmFyIGFycmF5CiAgICAgKi8KICAgIHB1YmxpYyAkcGFyYW1zOwoKICAgIC8qKgogICAgICogVGhlIGJpbmFyeSBkYXRhIG9mIHRoZSBmaWxlLgogICAgICogQHZhciAgc3RyaW5nCiAgICAgKi8KICAgIHB1YmxpYyAkZGF0YTsKCiAgICAvKioKICAgICAqIFRoZSBmaWxlIHBvaW50ZXIuCiAgICAgKiBAdmFyICBpbnQgIGJ5dGUgb2Zmc2V0CiAgICAgKi8KICAgIHB1YmxpYyAkcG9zOwoKICAgIC8qKgogICAgICogSW1wbGVtZW50cyBzdXBwb3J0IGZvciBmb3BlbigpLgogICAgICogRm9yIGNyZWF0aW5nIHN0cmVhbXMgdXNpbmcgdGhpcyB3cmFwcGVyLCB1c2UgT0xFX1BQU19GaWxlOjpnZXRTdHJlYW0oKS4KICAgICAqCiAgICAgKiBAcGFyYW0gICAgc3RyaW5nICAgICRwYXRoICAgICAgICAgICAgcmVzb3VyY2UgbmFtZSBpbmNsdWRpbmcgc2NoZW1lLCBlLmcuCiAgICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9sZS1jaGFpbmVkYmxvY2tzdHJlYW06Ly9vbGVJbnN0YW5jZUlkPTEKICAgICAqIEBwYXJhbSAgICBzdHJpbmcgICAgJG1vZGUgICAgICAgICAgICBvbmx5ICJyIiBpcyBzdXBwb3J0ZWQKICAgICAqIEBwYXJhbSAgICBpbnQgICAgICAgICRvcHRpb25zICAgICAgICBtYXNrIG9mIFNUUkVBTV9SRVBPUlRfRVJST1JTIGFuZCBTVFJFQU1fVVNFX1BBVEgKICAgICAqIEBwYXJhbSAgICBzdHJpbmcgICYkb3BlbmVkUGF0aCAgICBhYnNvbHV0ZSBwYXRoIG9mIHRoZSBvcGVuZWQgc3RyZWFtIChvdXQgcGFyYW1ldGVyKQogICAgICogQHJldHVybiAgICBib29sICAgIHRydWUgb24gc3VjY2VzcwogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gc3RyZWFtX29wZW4oJHBhdGgsICRtb2RlLCAkb3B0aW9ucywgJiRvcGVuZWRQYXRoKQogICAgewogICAgICAgIGlmICgkbW9kZSAhPSAncicpIHsKICAgICAgICAgICAgaWYgKCRvcHRpb25zICYgU1RSRUFNX1JFUE9SVF9FUlJPUlMpIHsKICAgICAgICAgICAgICAgIHRyaWdnZXJfZXJyb3IoJ09ubHkgcmVhZGluZyBpcyBzdXBwb3J0ZWQnLCBFX1VTRVJfV0FSTklORyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgLy8gMjUgaXMgbGVuZ3RoIG9mICJvbGUtY2hhaW5lZGJsb2Nrc3RyZWFtOi8vIgogICAgICAgIHBhcnNlX3N0cihzdWJzdHIoJHBhdGgsIDI1KSwgJHRoaXMtPnBhcmFtcyk7CiAgICAgICAgaWYgKCFpc3NldCgkdGhpcy0+cGFyYW1zWydvbGVJbnN0YW5jZUlkJ10sICR0aGlzLT5wYXJhbXNbJ2Jsb2NrSWQnXSwgJEdMT0JBTFNbJ19PTEVfSU5TVEFOQ0VTJ11bJHRoaXMtPnBhcmFtc1snb2xlSW5zdGFuY2VJZCddXSkpIHsKICAgICAgICAgICAgaWYgKCRvcHRpb25zICYgU1RSRUFNX1JFUE9SVF9FUlJPUlMpIHsKICAgICAgICAgICAgICAgIHRyaWdnZXJfZXJyb3IoJ09MRSBzdHJlYW0gbm90IGZvdW5kJywgRV9VU0VSX1dBUk5JTkcpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgJHRoaXMtPm9sZSA9ICRHTE9CQUxTWydfT0xFX0lOU1RBTkNFUyddWyR0aGlzLT5wYXJhbXNbJ29sZUluc3RhbmNlSWQnXV07CgogICAgICAgICRibG9ja0lkID0gJHRoaXMtPnBhcmFtc1snYmxvY2tJZCddOwogICAgICAgICR0aGlzLT5kYXRhID0gJyc7CiAgICAgICAgaWYgKGlzc2V0KCR0aGlzLT5wYXJhbXNbJ3NpemUnXSkgJiYgJHRoaXMtPnBhcmFtc1snc2l6ZSddIDwgJHRoaXMtPm9sZS0+YmlnQmxvY2tUaHJlc2hvbGQgJiYgJGJsb2NrSWQgIT0gJHRoaXMtPm9sZS0+cm9vdC0+X1N0YXJ0QmxvY2spIHsKICAgICAgICAgICAgLy8gQmxvY2sgaWQgcmVmZXJzIHRvIHNtYWxsIGJsb2NrcwogICAgICAgICAgICAkcm9vdFBvcyA9ICR0aGlzLT5vbGUtPl9nZXRCbG9ja09mZnNldCgkdGhpcy0+b2xlLT5yb290LT5fU3RhcnRCbG9jayk7CiAgICAgICAgICAgIHdoaWxlICgkYmxvY2tJZCAhPSAtMikgewogICAgICAgICAgICAgICAgJHBvcyA9ICRyb290UG9zICsgJGJsb2NrSWQgKiAkdGhpcy0+b2xlLT5iaWdCbG9ja1NpemU7CiAgICAgICAgICAgICAgICAkYmxvY2tJZCA9ICR0aGlzLT5vbGUtPnNiYXRbJGJsb2NrSWRdOwogICAgICAgICAgICAgICAgZnNlZWsoJHRoaXMtPm9sZS0+X2ZpbGVfaGFuZGxlLCAkcG9zKTsKICAgICAgICAgICAgICAgICR0aGlzLT5kYXRhIC49IGZyZWFkKCR0aGlzLT5vbGUtPl9maWxlX2hhbmRsZSwgJHRoaXMtPm9sZS0+YmlnQmxvY2tTaXplKTsKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIC8vIEJsb2NrIGlkIHJlZmVycyB0byBiaWcgYmxvY2tzCiAgICAgICAgICAgIHdoaWxlICgkYmxvY2tJZCAhPSAtMikgewogICAgICAgICAgICAgICAgJHBvcyA9ICR0aGlzLT5vbGUtPl9nZXRCbG9ja09mZnNldCgkYmxvY2tJZCk7CiAgICAgICAgICAgICAgICBmc2VlaygkdGhpcy0+b2xlLT5fZmlsZV9oYW5kbGUsICRwb3MpOwogICAgICAgICAgICAgICAgJHRoaXMtPmRhdGEgLj0gZnJlYWQoJHRoaXMtPm9sZS0+X2ZpbGVfaGFuZGxlLCAkdGhpcy0+b2xlLT5iaWdCbG9ja1NpemUpOwogICAgICAgICAgICAgICAgJGJsb2NrSWQgPSAkdGhpcy0+b2xlLT5iYmF0WyRibG9ja0lkXTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoaXNzZXQoJHRoaXMtPnBhcmFtc1snc2l6ZSddKSkgewogICAgICAgICAgICAkdGhpcy0+ZGF0YSA9IHN1YnN0cigkdGhpcy0+ZGF0YSwgMCwgJHRoaXMtPnBhcmFtc1snc2l6ZSddKTsKICAgICAgICB9CgogICAgICAgIGlmICgkb3B0aW9ucyAmIFNUUkVBTV9VU0VfUEFUSCkgewogICAgICAgICAgICAkb3BlbmVkUGF0aCA9ICRwYXRoOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbXBsZW1lbnRzIHN1cHBvcnQgZm9yIGZjbG9zZSgpLgogICAgICoKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIHN0cmVhbV9jbG9zZSgpCiAgICB7CiAgICAgICAgJHRoaXMtPm9sZSA9IG51bGw7CiAgICAgICAgdW5zZXQoJEdMT0JBTFNbJ19PTEVfSU5TVEFOQ0VTJ10pOwogICAgfQoKICAgIC8qKgogICAgICogSW1wbGVtZW50cyBzdXBwb3J0IGZvciBmcmVhZCgpLCBmZ2V0cygpIGV0Yy4KICAgICAqCiAgICAgKiBAcGFyYW0gICBpbnQgICAgICAgICRjb3VudCAgICBtYXhpbXVtIG51bWJlciBvZiBieXRlcyB0byByZWFkCiAgICAgKiBAcmV0dXJuICBzdHJpbmcKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIHN0cmVhbV9yZWFkKCRjb3VudCkKICAgIHsKICAgICAgICBpZiAoJHRoaXMtPnN0cmVhbV9lb2YoKSkgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgICRzID0gc3Vic3RyKCR0aGlzLT5kYXRhLCAkdGhpcy0+cG9zLCAkY291bnQpOwogICAgICAgICR0aGlzLT5wb3MgKz0gJGNvdW50OwogICAgICAgIHJldHVybiAkczsKICAgIH0KCiAgICAvKioKICAgICAqIEltcGxlbWVudHMgc3VwcG9ydCBmb3IgZmVvZigpLgogICAgICoKICAgICAqIEByZXR1cm4gIGJvb2wgIFRSVUUgaWYgdGhlIGZpbGUgcG9pbnRlciBpcyBhdCBFT0Y7IG90aGVyd2lzZSBGQUxTRQogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gc3RyZWFtX2VvZigpCiAgICB7CiAgICAgICAgcmV0dXJuICR0aGlzLT5wb3MgPj0gc3RybGVuKCR0aGlzLT5kYXRhKTsKICAgIH0KCiAgICAvKioKICAgICAqIFJldHVybnMgdGhlIHBvc2l0aW9uIG9mIHRoZSBmaWxlIHBvaW50ZXIsIGkuZS4gaXRzIG9mZnNldCBpbnRvIHRoZSBmaWxlCiAgICAgKiBzdHJlYW0uIEltcGxlbWVudHMgc3VwcG9ydCBmb3IgZnRlbGwoKS4KICAgICAqCiAgICAgKiBAcmV0dXJuICBpbnQKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIHN0cmVhbV90ZWxsKCkKICAgIHsKICAgICAgICByZXR1cm4gJHRoaXMtPnBvczsKICAgIH0KCiAgICAvKioKICAgICAqIEltcGxlbWVudHMgc3VwcG9ydCBmb3IgZnNlZWsoKS4KICAgICAqCiAgICAgKiBAcGFyYW0gICAgaW50ICAgICAgICAkb2Zmc2V0ICAgIGJ5dGUgb2Zmc2V0CiAgICAgKiBAcGFyYW0gICAgaW50ICAgICAgICAkd2hlbmNlICAgIFNFRUtfU0VULCBTRUVLX0NVUiBvciBTRUVLX0VORAogICAgICogQHJldHVybiAgICBib29sCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBzdHJlYW1fc2Vlaygkb2Zmc2V0LCAkd2hlbmNlKQogICAgewogICAgICAgIGlmICgkd2hlbmNlID09IFNFRUtfU0VUICYmICRvZmZzZXQgPj0gMCkgewogICAgICAgICAgICAkdGhpcy0+cG9zID0gJG9mZnNldDsKICAgICAgICB9IGVsc2VpZiAoJHdoZW5jZSA9PSBTRUVLX0NVUiAmJiAtJG9mZnNldCA8PSAkdGhpcy0+cG9zKSB7CiAgICAgICAgICAgICR0aGlzLT5wb3MgKz0gJG9mZnNldDsKICAgICAgICB9IGVsc2VpZiAoJHdoZW5jZSA9PSBTRUVLX0VORCAmJiAtJG9mZnNldCA8PSBzaXplb2YoJHRoaXMtPmRhdGEpKSB7CiAgICAgICAgICAgICR0aGlzLT5wb3MgPSBzdHJsZW4oJHRoaXMtPmRhdGEpICsgJG9mZnNldDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIC8qKgogICAgICogSW1wbGVtZW50cyBzdXBwb3J0IGZvciBmc3RhdCgpLiBDdXJyZW50bHkgdGhlIG9ubHkgc3VwcG9ydGVkIGZpZWxkIGlzCiAgICAgKiAic2l6ZSIuCiAgICAgKiBAcmV0dXJuICBhcnJheQogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gc3RyZWFtX3N0YXQoKQogICAgewogICAgICAgIHJldHVybiBhcnJheSgKICAgICAgICAgICAgJ3NpemUnID0+IHN0cmxlbigkdGhpcy0+ZGF0YSksCiAgICAgICAgICAgICk7CiAgICB9CgogICAgLy8gTWV0aG9kcyB1c2VkIGJ5IHN0cmVhbV93cmFwcGVyX3JlZ2lzdGVyKCkgdGhhdCBhcmUgbm90IGltcGxlbWVudGVkOgogICAgLy8gYm9vbCBzdHJlYW1fZmx1c2ggKCB2b2lkICkKICAgIC8vIGludCBzdHJlYW1fd3JpdGUgKCBzdHJpbmcgZGF0YSApCiAgICAvLyBib29sIHJlbmFtZSAoIHN0cmluZyBwYXRoX2Zyb20sIHN0cmluZyBwYXRoX3RvICkKICAgIC8vIGJvb2wgbWtkaXIgKCBzdHJpbmcgcGF0aCwgaW50IG1vZGUsIGludCBvcHRpb25zICkKICAgIC8vIGJvb2wgcm1kaXIgKCBzdHJpbmcgcGF0aCwgaW50IG9wdGlvbnMgKQogICAgLy8gYm9vbCBkaXJfb3BlbmRpciAoIHN0cmluZyBwYXRoLCBpbnQgb3B0aW9ucyApCiAgICAvLyBhcnJheSB1cmxfc3RhdCAoIHN0cmluZyBwYXRoLCBpbnQgZmxhZ3MgKQogICAgLy8gc3RyaW5nIGRpcl9yZWFkZGlyICggdm9pZCApCiAgICAvLyBib29sIGRpcl9yZXdpbmRkaXIgKCB2b2lkICkKICAgIC8vIGJvb2wgZGlyX2Nsb3NlZGlyICggdm9pZCApCn0K",
    "size": "6666"
}