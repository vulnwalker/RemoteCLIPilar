{
    "namaFile": "lib\/PHPExcel\/Classes\/PHPExcel\/RichText.php",
    "lastUpdate": "2017-12-25+01:39:38.00",
    "contentFile": "PD9waHAKCi8qKgogKiBQSFBFeGNlbF9SaWNoVGV4dAogKgogKiBDb3B5cmlnaHQgKGMpIDIwMDYgLSAyMDE1IFBIUEV4Y2VsCiAqCiAqIFRoaXMgbGlicmFyeSBpcyBmcmVlIHNvZnR3YXJlOyB5b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IKICogbW9kaWZ5IGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIExlc3NlciBHZW5lcmFsIFB1YmxpYwogKiBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieSB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uOyBlaXRoZXIKICogdmVyc2lvbiAyLjEgb2YgdGhlIExpY2Vuc2UsIG9yIChhdCB5b3VyIG9wdGlvbikgYW55IGxhdGVyIHZlcnNpb24uCiAqCiAqIFRoaXMgbGlicmFyeSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLAogKiBidXQgV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZgogKiBNRVJDSEFOVEFCSUxJVFkgb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuICBTZWUgdGhlIEdOVQogKiBMZXNzZXIgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBmb3IgbW9yZSBkZXRhaWxzLgogKgogKiBZb3Ugc2hvdWxkIGhhdmUgcmVjZWl2ZWQgYSBjb3B5IG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCiAqIExpY2Vuc2UgYWxvbmcgd2l0aCB0aGlzIGxpYnJhcnk7IGlmIG5vdCwgd3JpdGUgdG8gdGhlIEZyZWUgU29mdHdhcmUKICogRm91bmRhdGlvbiwgSW5jLiwgNTEgRnJhbmtsaW4gU3RyZWV0LCBGaWZ0aCBGbG9vciwgQm9zdG9uLCBNQSAgMDIxMTAtMTMwMSAgVVNBCiAqCiAqIEBjYXRlZ29yeSAgIFBIUEV4Y2VsCiAqIEBwYWNrYWdlICAgIFBIUEV4Y2VsX1JpY2hUZXh0CiAqIEBjb3B5cmlnaHQgIENvcHlyaWdodCAoYykgMjAwNiAtIDIwMTUgUEhQRXhjZWwgKGh0dHA6Ly93d3cuY29kZXBsZXguY29tL1BIUEV4Y2VsKQogKiBAbGljZW5zZSAgICBodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvb2xkLWxpY2Vuc2VzL2xncGwtMi4xLnR4dCAgICBMR1BMCiAqIEB2ZXJzaW9uICAgICMjVkVSU0lPTiMjLCAjI0RBVEUjIwogKi8KY2xhc3MgUEhQRXhjZWxfUmljaFRleHQgaW1wbGVtZW50cyBQSFBFeGNlbF9JQ29tcGFyYWJsZQp7CiAgICAvKioKICAgICAqIFJpY2ggdGV4dCBlbGVtZW50cwogICAgICoKICAgICAqIEB2YXIgUEhQRXhjZWxfUmljaFRleHRfSVRleHRFbGVtZW50W10KICAgICAqLwogICAgcHJpdmF0ZSAkcmljaFRleHRFbGVtZW50czsKCiAgICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyBQSFBFeGNlbF9SaWNoVGV4dCBpbnN0YW5jZQogICAgICoKICAgICAqIEBwYXJhbSBQSFBFeGNlbF9DZWxsICRwQ2VsbAogICAgICogQHRocm93cyBQSFBFeGNlbF9FeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KFBIUEV4Y2VsX0NlbGwgJHBDZWxsID0gbnVsbCkKICAgIHsKICAgICAgICAvLyBJbml0aWFsaXNlIHZhcmlhYmxlcwogICAgICAgICR0aGlzLT5yaWNoVGV4dEVsZW1lbnRzID0gYXJyYXkoKTsKCiAgICAgICAgLy8gUmljaC1UZXh0IHN0cmluZyBhdHRhY2hlZCB0byBjZWxsPwogICAgICAgIGlmICgkcENlbGwgIT09IG51bGwpIHsKICAgICAgICAgICAgLy8gQWRkIGNlbGwgdGV4dCBhbmQgc3R5bGUKICAgICAgICAgICAgaWYgKCRwQ2VsbC0+Z2V0VmFsdWUoKSAhPSAiIikgewogICAgICAgICAgICAgICAgJG9ialJ1biA9IG5ldyBQSFBFeGNlbF9SaWNoVGV4dF9SdW4oJHBDZWxsLT5nZXRWYWx1ZSgpKTsKICAgICAgICAgICAgICAgICRvYmpSdW4tPnNldEZvbnQoY2xvbmUgJHBDZWxsLT5nZXRQYXJlbnQoKS0+Z2V0U3R5bGUoJHBDZWxsLT5nZXRDb29yZGluYXRlKCkpLT5nZXRGb250KCkpOwogICAgICAgICAgICAgICAgJHRoaXMtPmFkZFRleHQoJG9ialJ1bik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFNldCBwYXJlbnQgdmFsdWUKICAgICAgICAgICAgJHBDZWxsLT5zZXRWYWx1ZUV4cGxpY2l0KCR0aGlzLCBQSFBFeGNlbF9DZWxsX0RhdGFUeXBlOjpUWVBFX1NUUklORyk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogQWRkIHRleHQKICAgICAqCiAgICAgKiBAcGFyYW0gUEhQRXhjZWxfUmljaFRleHRfSVRleHRFbGVtZW50ICRwVGV4dCBSaWNoIHRleHQgZWxlbWVudAogICAgICogQHRocm93cyBQSFBFeGNlbF9FeGNlcHRpb24KICAgICAqIEByZXR1cm4gUEhQRXhjZWxfUmljaFRleHQKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIGFkZFRleHQoUEhQRXhjZWxfUmljaFRleHRfSVRleHRFbGVtZW50ICRwVGV4dCA9IG51bGwpCiAgICB7CiAgICAgICAgJHRoaXMtPnJpY2hUZXh0RWxlbWVudHNbXSA9ICRwVGV4dDsKICAgICAgICByZXR1cm4gJHRoaXM7CiAgICB9CgogICAgLyoqCiAgICAgKiBDcmVhdGUgdGV4dAogICAgICoKICAgICAqIEBwYXJhbSBzdHJpbmcgJHBUZXh0IFRleHQKICAgICAqIEByZXR1cm4gUEhQRXhjZWxfUmljaFRleHRfVGV4dEVsZW1lbnQKICAgICAqIEB0aHJvd3MgUEhQRXhjZWxfRXhjZXB0aW9uCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBjcmVhdGVUZXh0KCRwVGV4dCA9ICcnKQogICAgewogICAgICAgICRvYmpUZXh0ID0gbmV3IFBIUEV4Y2VsX1JpY2hUZXh0X1RleHRFbGVtZW50KCRwVGV4dCk7CiAgICAgICAgJHRoaXMtPmFkZFRleHQoJG9ialRleHQpOwogICAgICAgIHJldHVybiAkb2JqVGV4dDsKICAgIH0KCiAgICAvKioKICAgICAqIENyZWF0ZSB0ZXh0IHJ1bgogICAgICoKICAgICAqIEBwYXJhbSBzdHJpbmcgJHBUZXh0IFRleHQKICAgICAqIEByZXR1cm4gUEhQRXhjZWxfUmljaFRleHRfUnVuCiAgICAgKiBAdGhyb3dzIFBIUEV4Y2VsX0V4Y2VwdGlvbgogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gY3JlYXRlVGV4dFJ1bigkcFRleHQgPSAnJykKICAgIHsKICAgICAgICAkb2JqVGV4dCA9IG5ldyBQSFBFeGNlbF9SaWNoVGV4dF9SdW4oJHBUZXh0KTsKICAgICAgICAkdGhpcy0+YWRkVGV4dCgkb2JqVGV4dCk7CiAgICAgICAgcmV0dXJuICRvYmpUZXh0OwogICAgfQoKICAgIC8qKgogICAgICogR2V0IHBsYWluIHRleHQKICAgICAqCiAgICAgKiBAcmV0dXJuIHN0cmluZwogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gZ2V0UGxhaW5UZXh0KCkKICAgIHsKICAgICAgICAvLyBSZXR1cm4gdmFsdWUKICAgICAgICAkcmV0dXJuVmFsdWUgPSAnJzsKCiAgICAgICAgLy8gTG9vcCB0aHJvdWdoIGFsbCBQSFBFeGNlbF9SaWNoVGV4dF9JVGV4dEVsZW1lbnQKICAgICAgICBmb3JlYWNoICgkdGhpcy0+cmljaFRleHRFbGVtZW50cyBhcyAkdGV4dCkgewogICAgICAgICAgICAkcmV0dXJuVmFsdWUgLj0gJHRleHQtPmdldFRleHQoKTsKICAgICAgICB9CgogICAgICAgIC8vIFJldHVybgogICAgICAgIHJldHVybiAkcmV0dXJuVmFsdWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBDb252ZXJ0IHRvIHN0cmluZwogICAgICoKICAgICAqIEByZXR1cm4gc3RyaW5nCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBfX3RvU3RyaW5nKCkKICAgIHsKICAgICAgICByZXR1cm4gJHRoaXMtPmdldFBsYWluVGV4dCgpOwogICAgfQoKICAgIC8qKgogICAgICogR2V0IFJpY2ggVGV4dCBlbGVtZW50cwogICAgICoKICAgICAqIEByZXR1cm4gUEhQRXhjZWxfUmljaFRleHRfSVRleHRFbGVtZW50W10KICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIGdldFJpY2hUZXh0RWxlbWVudHMoKQogICAgewogICAgICAgIHJldHVybiAkdGhpcy0+cmljaFRleHRFbGVtZW50czsKICAgIH0KCiAgICAvKioKICAgICAqIFNldCBSaWNoIFRleHQgZWxlbWVudHMKICAgICAqCiAgICAgKiBAcGFyYW0gUEhQRXhjZWxfUmljaFRleHRfSVRleHRFbGVtZW50W10gJHBFbGVtZW50cyBBcnJheSBvZiBlbGVtZW50cwogICAgICogQHRocm93cyBQSFBFeGNlbF9FeGNlcHRpb24KICAgICAqIEByZXR1cm4gUEhQRXhjZWxfUmljaFRleHQKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIHNldFJpY2hUZXh0RWxlbWVudHMoJHBFbGVtZW50cyA9IG51bGwpCiAgICB7CiAgICAgICAgaWYgKGlzX2FycmF5KCRwRWxlbWVudHMpKSB7CiAgICAgICAgICAgICR0aGlzLT5yaWNoVGV4dEVsZW1lbnRzID0gJHBFbGVtZW50czsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aHJvdyBuZXcgUEhQRXhjZWxfRXhjZXB0aW9uKCJJbnZhbGlkIFBIUEV4Y2VsX1JpY2hUZXh0X0lUZXh0RWxlbWVudFtdIGFycmF5IHBhc3NlZC4iKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICR0aGlzOwogICAgfQoKICAgIC8qKgogICAgICogR2V0IGhhc2ggY29kZQogICAgICoKICAgICAqIEByZXR1cm4gc3RyaW5nICAgIEhhc2ggY29kZQogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gZ2V0SGFzaENvZGUoKQogICAgewogICAgICAgICRoYXNoRWxlbWVudHMgPSAnJzsKICAgICAgICBmb3JlYWNoICgkdGhpcy0+cmljaFRleHRFbGVtZW50cyBhcyAkZWxlbWVudCkgewogICAgICAgICAgICAkaGFzaEVsZW1lbnRzIC49ICRlbGVtZW50LT5nZXRIYXNoQ29kZSgpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIG1kNSgKICAgICAgICAgICAgJGhhc2hFbGVtZW50cyAuCiAgICAgICAgICAgIF9fQ0xBU1NfXwogICAgICAgICk7CiAgICB9CgogICAgLyoqCiAgICAgKiBJbXBsZW1lbnQgUEhQIF9fY2xvbmUgdG8gY3JlYXRlIGEgZGVlcCBjbG9uZSwgbm90IGp1c3QgYSBzaGFsbG93IGNvcHkuCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBfX2Nsb25lKCkKICAgIHsKICAgICAgICAkdmFycyA9IGdldF9vYmplY3RfdmFycygkdGhpcyk7CiAgICAgICAgZm9yZWFjaCAoJHZhcnMgYXMgJGtleSA9PiAkdmFsdWUpIHsKICAgICAgICAgICAgaWYgKGlzX29iamVjdCgkdmFsdWUpKSB7CiAgICAgICAgICAgICAgICAkdGhpcy0+JGtleSA9IGNsb25lICR2YWx1ZTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICR0aGlzLT4ka2V5ID0gJHZhbHVlOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9Cg==",
    "size": "5035"
}