{
    "namaFile": "lib\/PHPExcel\/Classes\/PHPExcel\/Reader\/Gnumeric.php",
    "lastUpdate": "2017-12-25+01:39:38.00",
    "contentFile": "PD9waHAKCi8qKiBQSFBFeGNlbCByb290IGRpcmVjdG9yeSAqLwppZiAoIWRlZmluZWQoJ1BIUEVYQ0VMX1JPT1QnKSkgewogICAgLyoqCiAgICAgKiBAaWdub3JlCiAgICAgKi8KICAgIGRlZmluZSgnUEhQRVhDRUxfUk9PVCcsIGRpcm5hbWUoX19GSUxFX18pIC4gJy8uLi8uLi8nKTsKICAgIHJlcXVpcmUoUEhQRVhDRUxfUk9PVCAuICdQSFBFeGNlbC9BdXRvbG9hZGVyLnBocCcpOwp9CgovKioKICogUEhQRXhjZWxfUmVhZGVyX0dudW1lcmljCiAqCiAqIENvcHlyaWdodCAoYykgMjAwNiAtIDIwMTUgUEhQRXhjZWwKICoKICogVGhpcyBsaWJyYXJ5IGlzIGZyZWUgc29mdHdhcmU7IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vcgogKiBtb2RpZnkgaXQgdW5kZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgTGVzc2VyIEdlbmVyYWwgUHVibGljCiAqIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5IHRoZSBGcmVlIFNvZnR3YXJlIEZvdW5kYXRpb247IGVpdGhlcgogKiB2ZXJzaW9uIDIuMSBvZiB0aGUgTGljZW5zZSwgb3IgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi4KICoKICogVGhpcyBsaWJyYXJ5IGlzIGRpc3RyaWJ1dGVkIGluIHRoZSBob3BlIHRoYXQgaXQgd2lsbCBiZSB1c2VmdWwsCiAqIGJ1dCBXSVRIT1VUIEFOWSBXQVJSQU5UWTsgd2l0aG91dCBldmVuIHRoZSBpbXBsaWVkIHdhcnJhbnR5IG9mCiAqIE1FUkNIQU5UQUJJTElUWSBvciBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRS4gIFNlZSB0aGUgR05VCiAqIExlc3NlciBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGZvciBtb3JlIGRldGFpbHMuCiAqCiAqIFlvdSBzaG91bGQgaGF2ZSByZWNlaXZlZCBhIGNvcHkgb2YgdGhlIEdOVSBMZXNzZXIgR2VuZXJhbCBQdWJsaWMKICogTGljZW5zZSBhbG9uZyB3aXRoIHRoaXMgbGlicmFyeTsgaWYgbm90LCB3cml0ZSB0byB0aGUgRnJlZSBTb2Z0d2FyZQogKiBGb3VuZGF0aW9uLCBJbmMuLCA1MSBGcmFua2xpbiBTdHJlZXQsIEZpZnRoIEZsb29yLCBCb3N0b24sIE1BICAwMjExMC0xMzAxICBVU0EKICoKICogQGNhdGVnb3J5ICAgUEhQRXhjZWwKICogQHBhY2thZ2UgICAgUEhQRXhjZWxfUmVhZGVyCiAqIEBjb3B5cmlnaHQgIENvcHlyaWdodCAoYykgMjAwNiAtIDIwMTUgUEhQRXhjZWwgKGh0dHA6Ly93d3cuY29kZXBsZXguY29tL1BIUEV4Y2VsKQogKiBAbGljZW5zZSAgICBodHRwOi8vd3d3LmdudS5vcmcvbGljZW5zZXMvb2xkLWxpY2Vuc2VzL2xncGwtMi4xLnR4dCAgICBMR1BMCiAqIEB2ZXJzaW9uICAgICMjVkVSU0lPTiMjLCAjI0RBVEUjIwogKi8KY2xhc3MgUEhQRXhjZWxfUmVhZGVyX0dudW1lcmljIGV4dGVuZHMgUEhQRXhjZWxfUmVhZGVyX0Fic3RyYWN0IGltcGxlbWVudHMgUEhQRXhjZWxfUmVhZGVyX0lSZWFkZXIKewogICAgLyoqCiAgICAgKiBGb3JtYXRzCiAgICAgKgogICAgICogQHZhciBhcnJheQogICAgICovCiAgICBwcml2YXRlICRzdHlsZXMgPSBhcnJheSgpOwoKICAgIC8qKgogICAgICogU2hhcmVkIEV4cHJlc3Npb25zCiAgICAgKgogICAgICogQHZhciBhcnJheQogICAgICovCiAgICBwcml2YXRlICRleHByZXNzaW9ucyA9IGFycmF5KCk7CgogICAgcHJpdmF0ZSAkcmVmZXJlbmNlSGVscGVyID0gbnVsbDsKCiAgICAvKioKICAgICAqIENyZWF0ZSBhIG5ldyBQSFBFeGNlbF9SZWFkZXJfR251bWVyaWMKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KCkKICAgIHsKICAgICAgICAkdGhpcy0+cmVhZEZpbHRlciAgICAgPSBuZXcgUEhQRXhjZWxfUmVhZGVyX0RlZmF1bHRSZWFkRmlsdGVyKCk7CiAgICAgICAgJHRoaXMtPnJlZmVyZW5jZUhlbHBlciA9IFBIUEV4Y2VsX1JlZmVyZW5jZUhlbHBlcjo6Z2V0SW5zdGFuY2UoKTsKICAgIH0KCiAgICAvKioKICAgICAqIENhbiB0aGUgY3VycmVudCBQSFBFeGNlbF9SZWFkZXJfSVJlYWRlciByZWFkIHRoZSBmaWxlPwogICAgICoKICAgICAqIEBwYXJhbSAgICAgc3RyaW5nICAgICAgICAgJHBGaWxlbmFtZQogICAgICogQHJldHVybiAgICAgYm9vbGVhbgogICAgICogQHRocm93cyBQSFBFeGNlbF9SZWFkZXJfRXhjZXB0aW9uCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBjYW5SZWFkKCRwRmlsZW5hbWUpCiAgICB7CiAgICAgICAgLy8gQ2hlY2sgaWYgZmlsZSBleGlzdHMKICAgICAgICBpZiAoIWZpbGVfZXhpc3RzKCRwRmlsZW5hbWUpKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBQSFBFeGNlbF9SZWFkZXJfRXhjZXB0aW9uKCJDb3VsZCBub3Qgb3BlbiAiIC4gJHBGaWxlbmFtZSAuICIgZm9yIHJlYWRpbmchIEZpbGUgZG9lcyBub3QgZXhpc3QuIik7CiAgICAgICAgfQoKICAgICAgICAvLyBDaGVjayBpZiBnemxpYiBmdW5jdGlvbnMgYXJlIGF2YWlsYWJsZQogICAgICAgIGlmICghZnVuY3Rpb25fZXhpc3RzKCdnenJlYWQnKSkgewogICAgICAgICAgICB0aHJvdyBuZXcgUEhQRXhjZWxfUmVhZGVyX0V4Y2VwdGlvbigiZ3psaWIgbGlicmFyeSBpcyBub3QgZW5hYmxlZCIpOwogICAgICAgIH0KCiAgICAgICAgLy8gUmVhZCBzaWduYXR1cmUgZGF0YSAoZmlyc3QgMyBieXRlcykKICAgICAgICAkZmggPSBmb3BlbigkcEZpbGVuYW1lLCAncicpOwogICAgICAgICRkYXRhID0gZnJlYWQoJGZoLCAyKTsKICAgICAgICBmY2xvc2UoJGZoKTsKCiAgICAgICAgaWYgKCRkYXRhICE9IGNocigweDFGKS5jaHIoMHg4QikpIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICB9CgogICAgLyoqCiAgICAgKiBSZWFkcyBuYW1lcyBvZiB0aGUgd29ya3NoZWV0cyBmcm9tIGEgZmlsZSwgd2l0aG91dCBwYXJzaW5nIHRoZSB3aG9sZSBmaWxlIHRvIGEgUEhQRXhjZWwgb2JqZWN0CiAgICAgKgogICAgICogQHBhcmFtICAgICBzdHJpbmcgICAgICAgICAkcEZpbGVuYW1lCiAgICAgKiBAdGhyb3dzICAgICBQSFBFeGNlbF9SZWFkZXJfRXhjZXB0aW9uCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBsaXN0V29ya3NoZWV0TmFtZXMoJHBGaWxlbmFtZSkKICAgIHsKICAgICAgICAvLyBDaGVjayBpZiBmaWxlIGV4aXN0cwogICAgICAgIGlmICghZmlsZV9leGlzdHMoJHBGaWxlbmFtZSkpIHsKICAgICAgICAgICAgdGhyb3cgbmV3IFBIUEV4Y2VsX1JlYWRlcl9FeGNlcHRpb24oIkNvdWxkIG5vdCBvcGVuICIgLiAkcEZpbGVuYW1lIC4gIiBmb3IgcmVhZGluZyEgRmlsZSBkb2VzIG5vdCBleGlzdC4iKTsKICAgICAgICB9CgogICAgICAgICR4bWwgPSBuZXcgWE1MUmVhZGVyKCk7CiAgICAgICAgJHhtbC0+eG1sKCR0aGlzLT5zZWN1cml0eVNjYW5GaWxlKCdjb21wcmVzcy56bGliOi8vJy5yZWFscGF0aCgkcEZpbGVuYW1lKSksIG51bGwsIFBIUEV4Y2VsX1NldHRpbmdzOjpnZXRMaWJYbWxMb2FkZXJPcHRpb25zKCkpOwogICAgICAgICR4bWwtPnNldFBhcnNlclByb3BlcnR5KDIsIHRydWUpOwoKICAgICAgICAkd29ya3NoZWV0TmFtZXMgPSBhcnJheSgpOwogICAgICAgIHdoaWxlICgkeG1sLT5yZWFkKCkpIHsKICAgICAgICAgICAgaWYgKCR4bWwtPm5hbWUgPT0gJ2dubTpTaGVldE5hbWUnICYmICR4bWwtPm5vZGVUeXBlID09IFhNTFJlYWRlcjo6RUxFTUVOVCkgewogICAgICAgICAgICAgICAgJHhtbC0+cmVhZCgpOyAgICAvLyAgICBNb3ZlIG9udG8gdGhlIHZhbHVlIG5vZGUKICAgICAgICAgICAgICAgICR3b3Jrc2hlZXROYW1lc1tdID0gKHN0cmluZykgJHhtbC0+dmFsdWU7CiAgICAgICAgICAgIH0gZWxzZWlmICgkeG1sLT5uYW1lID09ICdnbm06U2hlZXRzJykgewogICAgICAgICAgICAgICAgLy8gICAgYnJlYWsgb3V0IG9mIHRoZSBsb29wIG9uY2Ugd2UndmUgZ290IG91ciBzaGVldCBuYW1lcyByYXRoZXIgdGhhbiBwYXJzZSB0aGUgZW50aXJlIGZpbGUKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gJHdvcmtzaGVldE5hbWVzOwogICAgfQoKICAgIC8qKgogICAgICogUmV0dXJuIHdvcmtzaGVldCBpbmZvIChOYW1lLCBMYXN0IENvbHVtbiBMZXR0ZXIsIExhc3QgQ29sdW1uIEluZGV4LCBUb3RhbCBSb3dzLCBUb3RhbCBDb2x1bW5zKQogICAgICoKICAgICAqIEBwYXJhbSAgIHN0cmluZyAgICAgJHBGaWxlbmFtZQogICAgICogQHRocm93cyAgIFBIUEV4Y2VsX1JlYWRlcl9FeGNlcHRpb24KICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIGxpc3RXb3Jrc2hlZXRJbmZvKCRwRmlsZW5hbWUpCiAgICB7CiAgICAgICAgLy8gQ2hlY2sgaWYgZmlsZSBleGlzdHMKICAgICAgICBpZiAoIWZpbGVfZXhpc3RzKCRwRmlsZW5hbWUpKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBQSFBFeGNlbF9SZWFkZXJfRXhjZXB0aW9uKCJDb3VsZCBub3Qgb3BlbiAiIC4gJHBGaWxlbmFtZSAuICIgZm9yIHJlYWRpbmchIEZpbGUgZG9lcyBub3QgZXhpc3QuIik7CiAgICAgICAgfQoKICAgICAgICAkeG1sID0gbmV3IFhNTFJlYWRlcigpOwogICAgICAgICR4bWwtPnhtbCgkdGhpcy0+c2VjdXJpdHlTY2FuRmlsZSgnY29tcHJlc3MuemxpYjovLycucmVhbHBhdGgoJHBGaWxlbmFtZSkpLCBudWxsLCBQSFBFeGNlbF9TZXR0aW5nczo6Z2V0TGliWG1sTG9hZGVyT3B0aW9ucygpKTsKICAgICAgICAkeG1sLT5zZXRQYXJzZXJQcm9wZXJ0eSgyLCB0cnVlKTsKCiAgICAgICAgJHdvcmtzaGVldEluZm8gPSBhcnJheSgpOwogICAgICAgIHdoaWxlICgkeG1sLT5yZWFkKCkpIHsKICAgICAgICAgICAgaWYgKCR4bWwtPm5hbWUgPT0gJ2dubTpTaGVldCcgJiYgJHhtbC0+bm9kZVR5cGUgPT0gWE1MUmVhZGVyOjpFTEVNRU5UKSB7CiAgICAgICAgICAgICAgICAkdG1wSW5mbyA9IGFycmF5KAogICAgICAgICAgICAgICAgICAgICd3b3Jrc2hlZXROYW1lJyA9PiAnJywKICAgICAgICAgICAgICAgICAgICAnbGFzdENvbHVtbkxldHRlcicgPT4gJ0EnLAogICAgICAgICAgICAgICAgICAgICdsYXN0Q29sdW1uSW5kZXgnID0+IDAsCiAgICAgICAgICAgICAgICAgICAgJ3RvdGFsUm93cycgPT4gMCwKICAgICAgICAgICAgICAgICAgICAndG90YWxDb2x1bW5zJyA9PiAwLAogICAgICAgICAgICAgICAgKTsKCiAgICAgICAgICAgICAgICB3aGlsZSAoJHhtbC0+cmVhZCgpKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCR4bWwtPm5hbWUgPT0gJ2dubTpOYW1lJyAmJiAkeG1sLT5ub2RlVHlwZSA9PSBYTUxSZWFkZXI6OkVMRU1FTlQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHhtbC0+cmVhZCgpOyAgICAvLyAgICBNb3ZlIG9udG8gdGhlIHZhbHVlIG5vZGUKICAgICAgICAgICAgICAgICAgICAgICAgJHRtcEluZm9bJ3dvcmtzaGVldE5hbWUnXSA9IChzdHJpbmcpICR4bWwtPnZhbHVlOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZWlmICgkeG1sLT5uYW1lID09ICdnbm06TWF4Q29sJyAmJiAkeG1sLT5ub2RlVHlwZSA9PSBYTUxSZWFkZXI6OkVMRU1FTlQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHhtbC0+cmVhZCgpOyAgICAvLyAgICBNb3ZlIG9udG8gdGhlIHZhbHVlIG5vZGUKICAgICAgICAgICAgICAgICAgICAgICAgJHRtcEluZm9bJ2xhc3RDb2x1bW5JbmRleCddID0gKGludCkgJHhtbC0+dmFsdWU7CiAgICAgICAgICAgICAgICAgICAgICAgICR0bXBJbmZvWyd0b3RhbENvbHVtbnMnXSA9IChpbnQpICR4bWwtPnZhbHVlICsgMTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2VpZiAoJHhtbC0+bmFtZSA9PSAnZ25tOk1heFJvdycgJiYgJHhtbC0+bm9kZVR5cGUgPT0gWE1MUmVhZGVyOjpFTEVNRU5UKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICR4bWwtPnJlYWQoKTsgICAgLy8gICAgTW92ZSBvbnRvIHRoZSB2YWx1ZSBub2RlCiAgICAgICAgICAgICAgICAgICAgICAgICR0bXBJbmZvWyd0b3RhbFJvd3MnXSA9IChpbnQpICR4bWwtPnZhbHVlICsgMTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJHRtcEluZm9bJ2xhc3RDb2x1bW5MZXR0ZXInXSA9IFBIUEV4Y2VsX0NlbGw6OnN0cmluZ0Zyb21Db2x1bW5JbmRleCgkdG1wSW5mb1snbGFzdENvbHVtbkluZGV4J10pOwogICAgICAgICAgICAgICAgJHdvcmtzaGVldEluZm9bXSA9ICR0bXBJbmZvOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gJHdvcmtzaGVldEluZm87CiAgICB9CgogICAgcHJpdmF0ZSBmdW5jdGlvbiBnemZpbGVHZXRDb250ZW50cygkZmlsZW5hbWUpCiAgICB7CiAgICAgICAgJGZpbGUgPSBAZ3pvcGVuKCRmaWxlbmFtZSwgJ3JiJyk7CiAgICAgICAgaWYgKCRmaWxlICE9PSBmYWxzZSkgewogICAgICAgICAgICAkZGF0YSA9ICcnOwogICAgICAgICAgICB3aGlsZSAoIWd6ZW9mKCRmaWxlKSkgewogICAgICAgICAgICAgICAgJGRhdGEgLj0gZ3pyZWFkKCRmaWxlLCAxMDI0KTsKICAgICAgICAgICAgfQogICAgICAgICAgICBnemNsb3NlKCRmaWxlKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICRkYXRhOwogICAgfQoKICAgIC8qKgogICAgICogTG9hZHMgUEhQRXhjZWwgZnJvbSBmaWxlCiAgICAgKgogICAgICogQHBhcmFtICAgICBzdHJpbmcgICAgICAgICAkcEZpbGVuYW1lCiAgICAgKiBAcmV0dXJuICAgICBQSFBFeGNlbAogICAgICogQHRocm93cyAgICAgUEhQRXhjZWxfUmVhZGVyX0V4Y2VwdGlvbgogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gbG9hZCgkcEZpbGVuYW1lKQogICAgewogICAgICAgIC8vIENyZWF0ZSBuZXcgUEhQRXhjZWwKICAgICAgICAkb2JqUEhQRXhjZWwgPSBuZXcgUEhQRXhjZWwoKTsKCiAgICAgICAgLy8gTG9hZCBpbnRvIHRoaXMgaW5zdGFuY2UKICAgICAgICByZXR1cm4gJHRoaXMtPmxvYWRJbnRvRXhpc3RpbmcoJHBGaWxlbmFtZSwgJG9ialBIUEV4Y2VsKTsKICAgIH0KCiAgICAvKioKICAgICAqIExvYWRzIFBIUEV4Y2VsIGZyb20gZmlsZSBpbnRvIFBIUEV4Y2VsIGluc3RhbmNlCiAgICAgKgogICAgICogQHBhcmFtICAgICBzdHJpbmcgICAgICAgICAkcEZpbGVuYW1lCiAgICAgKiBAcGFyYW0gICAgUEhQRXhjZWwgICAgJG9ialBIUEV4Y2VsCiAgICAgKiBAcmV0dXJuICAgICBQSFBFeGNlbAogICAgICogQHRocm93cyAgICAgUEhQRXhjZWxfUmVhZGVyX0V4Y2VwdGlvbgogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gbG9hZEludG9FeGlzdGluZygkcEZpbGVuYW1lLCBQSFBFeGNlbCAkb2JqUEhQRXhjZWwpCiAgICB7CiAgICAgICAgLy8gQ2hlY2sgaWYgZmlsZSBleGlzdHMKICAgICAgICBpZiAoIWZpbGVfZXhpc3RzKCRwRmlsZW5hbWUpKSB7CiAgICAgICAgICAgIHRocm93IG5ldyBQSFBFeGNlbF9SZWFkZXJfRXhjZXB0aW9uKCJDb3VsZCBub3Qgb3BlbiAiIC4gJHBGaWxlbmFtZSAuICIgZm9yIHJlYWRpbmchIEZpbGUgZG9lcyBub3QgZXhpc3QuIik7CiAgICAgICAgfQoKICAgICAgICAkdGltZXpvbmVPYmogPSBuZXcgRGF0ZVRpbWVab25lKCdFdXJvcGUvTG9uZG9uJyk7CiAgICAgICAgJEdNVCA9IG5ldyBEYXRlVGltZVpvbmUoJ1VUQycpOwoKICAgICAgICAkZ0ZpbGVEYXRhID0gJHRoaXMtPmd6ZmlsZUdldENvbnRlbnRzKCRwRmlsZW5hbWUpOwoKLy8gICAgICAgIGVjaG8gJzxwcmU+JzsKLy8gICAgICAgIGVjaG8gaHRtbGVudGl0aWVzKCRnRmlsZURhdGEsRU5UX1FVT1RFUywnVVRGLTgnKTsKLy8gICAgICAgIGVjaG8gJzwvcHJlPjxociAvPic7Ci8vCiAgICAgICAgJHhtbCA9IHNpbXBsZXhtbF9sb2FkX3N0cmluZygkdGhpcy0+c2VjdXJpdHlTY2FuKCRnRmlsZURhdGEpLCAnU2ltcGxlWE1MRWxlbWVudCcsIFBIUEV4Y2VsX1NldHRpbmdzOjpnZXRMaWJYbWxMb2FkZXJPcHRpb25zKCkpOwogICAgICAgICRuYW1lc3BhY2VzTWV0YSA9ICR4bWwtPmdldE5hbWVzcGFjZXModHJ1ZSk7CgovLyAgICAgICAgdmFyX2R1bXAoJG5hbWVzcGFjZXNNZXRhKTsKLy8KICAgICAgICAkZ25tWE1MID0gJHhtbC0+Y2hpbGRyZW4oJG5hbWVzcGFjZXNNZXRhWydnbm0nXSk7CgogICAgICAgICRkb2NQcm9wcyA9ICRvYmpQSFBFeGNlbC0+Z2V0UHJvcGVydGllcygpOwogICAgICAgIC8vICAgIERvY3VtZW50IFByb3BlcnRpZXMgYXJlIGhlbGQgZGlmZmVyZW50bHksIGRlcGVuZGluZyBvbiB0aGUgdmVyc2lvbiBvZiBHbnVtZXJpYwogICAgICAgIGlmIChpc3NldCgkbmFtZXNwYWNlc01ldGFbJ29mZmljZSddKSkgewogICAgICAgICAgICAkb2ZmaWNlWE1MID0gJHhtbC0+Y2hpbGRyZW4oJG5hbWVzcGFjZXNNZXRhWydvZmZpY2UnXSk7CiAgICAgICAgICAgICRvZmZpY2VEb2NYTUwgPSAkb2ZmaWNlWE1MLT57J2RvY3VtZW50LW1ldGEnfTsKICAgICAgICAgICAgJG9mZmljZURvY01ldGFYTUwgPSAkb2ZmaWNlRG9jWE1MLT5tZXRhOwoKICAgICAgICAgICAgZm9yZWFjaCAoJG9mZmljZURvY01ldGFYTUwgYXMgJG9mZmljZVByb3BlcnR5RGF0YSkgewogICAgICAgICAgICAgICAgJG9mZmljZVByb3BlcnR5REMgPSBhcnJheSgpOwogICAgICAgICAgICAgICAgaWYgKGlzc2V0KCRuYW1lc3BhY2VzTWV0YVsnZGMnXSkpIHsKICAgICAgICAgICAgICAgICAgICAkb2ZmaWNlUHJvcGVydHlEQyA9ICRvZmZpY2VQcm9wZXJ0eURhdGEtPmNoaWxkcmVuKCRuYW1lc3BhY2VzTWV0YVsnZGMnXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBmb3JlYWNoICgkb2ZmaWNlUHJvcGVydHlEQyBhcyAkcHJvcGVydHlOYW1lID0+ICRwcm9wZXJ0eVZhbHVlKSB7CiAgICAgICAgICAgICAgICAgICAgJHByb3BlcnR5VmFsdWUgPSAoc3RyaW5nKSAkcHJvcGVydHlWYWx1ZTsKICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKCRwcm9wZXJ0eU5hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAndGl0bGUnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGRvY1Byb3BzLT5zZXRUaXRsZSh0cmltKCRwcm9wZXJ0eVZhbHVlKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnc3ViamVjdCc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZG9jUHJvcHMtPnNldFN1YmplY3QodHJpbSgkcHJvcGVydHlWYWx1ZSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NyZWF0b3InOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGRvY1Byb3BzLT5zZXRDcmVhdG9yKHRyaW0oJHByb3BlcnR5VmFsdWUpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRkb2NQcm9wcy0+c2V0TGFzdE1vZGlmaWVkQnkodHJpbSgkcHJvcGVydHlWYWx1ZSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2RhdGUnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGNyZWF0aW9uRGF0ZSA9IHN0cnRvdGltZSh0cmltKCRwcm9wZXJ0eVZhbHVlKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZG9jUHJvcHMtPnNldENyZWF0ZWQoJGNyZWF0aW9uRGF0ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZG9jUHJvcHMtPnNldE1vZGlmaWVkKCRjcmVhdGlvbkRhdGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2Rlc2NyaXB0aW9uJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRkb2NQcm9wcy0+c2V0RGVzY3JpcHRpb24odHJpbSgkcHJvcGVydHlWYWx1ZSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgJG9mZmljZVByb3BlcnR5TWV0YSA9IGFycmF5KCk7CiAgICAgICAgICAgICAgICBpZiAoaXNzZXQoJG5hbWVzcGFjZXNNZXRhWydtZXRhJ10pKSB7CiAgICAgICAgICAgICAgICAgICAgJG9mZmljZVByb3BlcnR5TWV0YSA9ICRvZmZpY2VQcm9wZXJ0eURhdGEtPmNoaWxkcmVuKCRuYW1lc3BhY2VzTWV0YVsnbWV0YSddKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRvZmZpY2VQcm9wZXJ0eU1ldGEgYXMgJHByb3BlcnR5TmFtZSA9PiAkcHJvcGVydHlWYWx1ZSkgewogICAgICAgICAgICAgICAgICAgICRhdHRyaWJ1dGVzID0gJHByb3BlcnR5VmFsdWUtPmF0dHJpYnV0ZXMoJG5hbWVzcGFjZXNNZXRhWydtZXRhJ10pOwogICAgICAgICAgICAgICAgICAgICRwcm9wZXJ0eVZhbHVlID0gKHN0cmluZykgJHByb3BlcnR5VmFsdWU7CiAgICAgICAgICAgICAgICAgICAgc3dpdGNoICgkcHJvcGVydHlOYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2tleXdvcmQnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGRvY1Byb3BzLT5zZXRLZXl3b3Jkcyh0cmltKCRwcm9wZXJ0eVZhbHVlKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnaW5pdGlhbC1jcmVhdG9yJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRkb2NQcm9wcy0+c2V0Q3JlYXRvcih0cmltKCRwcm9wZXJ0eVZhbHVlKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZG9jUHJvcHMtPnNldExhc3RNb2RpZmllZEJ5KHRyaW0oJHByb3BlcnR5VmFsdWUpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdjcmVhdGlvbi1kYXRlJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjcmVhdGlvbkRhdGUgPSBzdHJ0b3RpbWUodHJpbSgkcHJvcGVydHlWYWx1ZSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGRvY1Byb3BzLT5zZXRDcmVhdGVkKCRjcmVhdGlvbkRhdGUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGRvY1Byb3BzLT5zZXRNb2RpZmllZCgkY3JlYXRpb25EYXRlKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd1c2VyLWRlZmluZWQnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGlzdCgsICRhdHRyTmFtZSkgPSBleHBsb2RlKCc6JywgJGF0dHJpYnV0ZXNbJ25hbWUnXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKCRhdHRyTmFtZSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3B1Ymxpc2hlcic6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRkb2NQcm9wcy0+c2V0Q29tcGFueSh0cmltKCRwcm9wZXJ0eVZhbHVlKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NhdGVnb3J5JzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGRvY1Byb3BzLT5zZXRDYXRlZ29yeSh0cmltKCRwcm9wZXJ0eVZhbHVlKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ21hbmFnZXInOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZG9jUHJvcHMtPnNldE1hbmFnZXIodHJpbSgkcHJvcGVydHlWYWx1ZSkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZWlmIChpc3NldCgkZ25tWE1MLT5TdW1tYXJ5KSkgewogICAgICAgICAgICBmb3JlYWNoICgkZ25tWE1MLT5TdW1tYXJ5LT5JdGVtIGFzICRzdW1tYXJ5SXRlbSkgewogICAgICAgICAgICAgICAgJHByb3BlcnR5TmFtZSA9ICRzdW1tYXJ5SXRlbS0+bmFtZTsKICAgICAgICAgICAgICAgICRwcm9wZXJ0eVZhbHVlID0gJHN1bW1hcnlJdGVtLT57J3ZhbC1zdHJpbmcnfTsKICAgICAgICAgICAgICAgIHN3aXRjaCAoJHByb3BlcnR5TmFtZSkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgJ3RpdGxlJzoKICAgICAgICAgICAgICAgICAgICAgICAgJGRvY1Byb3BzLT5zZXRUaXRsZSh0cmltKCRwcm9wZXJ0eVZhbHVlKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NvbW1lbnRzJzoKICAgICAgICAgICAgICAgICAgICAgICAgJGRvY1Byb3BzLT5zZXREZXNjcmlwdGlvbih0cmltKCRwcm9wZXJ0eVZhbHVlKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgJ2tleXdvcmRzJzoKICAgICAgICAgICAgICAgICAgICAgICAgJGRvY1Byb3BzLT5zZXRLZXl3b3Jkcyh0cmltKCRwcm9wZXJ0eVZhbHVlKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgJ2NhdGVnb3J5JzoKICAgICAgICAgICAgICAgICAgICAgICAgJGRvY1Byb3BzLT5zZXRDYXRlZ29yeSh0cmltKCRwcm9wZXJ0eVZhbHVlKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgJ21hbmFnZXInOgogICAgICAgICAgICAgICAgICAgICAgICAkZG9jUHJvcHMtPnNldE1hbmFnZXIodHJpbSgkcHJvcGVydHlWYWx1ZSkpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlICdhdXRob3InOgogICAgICAgICAgICAgICAgICAgICAgICAkZG9jUHJvcHMtPnNldENyZWF0b3IodHJpbSgkcHJvcGVydHlWYWx1ZSkpOwogICAgICAgICAgICAgICAgICAgICAgICAkZG9jUHJvcHMtPnNldExhc3RNb2RpZmllZEJ5KHRyaW0oJHByb3BlcnR5VmFsdWUpKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAnY29tcGFueSc6CiAgICAgICAgICAgICAgICAgICAgICAgICRkb2NQcm9wcy0+c2V0Q29tcGFueSh0cmltKCRwcm9wZXJ0eVZhbHVlKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAkd29ya3NoZWV0SUQgPSAwOwogICAgICAgIGZvcmVhY2ggKCRnbm1YTUwtPlNoZWV0cy0+U2hlZXQgYXMgJHNoZWV0KSB7CiAgICAgICAgICAgICR3b3Jrc2hlZXROYW1lID0gKHN0cmluZykgJHNoZWV0LT5OYW1lOwovLyAgICAgICAgICAgIGVjaG8gJzxiPldvcmtzaGVldDogJywgJHdvcmtzaGVldE5hbWUsJzwvYj48YnIgLz4nOwogICAgICAgICAgICBpZiAoKGlzc2V0KCR0aGlzLT5sb2FkU2hlZXRzT25seSkpICYmICghaW5fYXJyYXkoJHdvcmtzaGVldE5hbWUsICR0aGlzLT5sb2FkU2hlZXRzT25seSkpKSB7CiAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJG1heFJvdyA9ICRtYXhDb2wgPSAwOwoKICAgICAgICAgICAgLy8gQ3JlYXRlIG5ldyBXb3Jrc2hlZXQKICAgICAgICAgICAgJG9ialBIUEV4Y2VsLT5jcmVhdGVTaGVldCgpOwogICAgICAgICAgICAkb2JqUEhQRXhjZWwtPnNldEFjdGl2ZVNoZWV0SW5kZXgoJHdvcmtzaGVldElEKTsKICAgICAgICAgICAgLy8gICAgVXNlIGZhbHNlIGZvciAkdXBkYXRlRm9ybXVsYUNlbGxSZWZlcmVuY2VzIHRvIHByZXZlbnQgYWRqdXN0bWVudCBvZiB3b3Jrc2hlZXQgcmVmZXJlbmNlcyBpbiBmb3JtdWxhCiAgICAgICAgICAgIC8vICAgICAgICBjZWxscy4uLiBkdXJpbmcgdGhlIGxvYWQsIGFsbCBmb3JtdWxhZSBzaG91bGQgYmUgY29ycmVjdCwgYW5kIHdlJ3JlIHNpbXBseSBicmluZ2luZyB0aGUgd29ya3NoZWV0CiAgICAgICAgICAgIC8vICAgICAgICBuYW1lIGluIGxpbmUgd2l0aCB0aGUgZm9ybXVsYSwgbm90IHRoZSByZXZlcnNlCiAgICAgICAgICAgICRvYmpQSFBFeGNlbC0+Z2V0QWN0aXZlU2hlZXQoKS0+c2V0VGl0bGUoJHdvcmtzaGVldE5hbWUsIGZhbHNlKTsKCiAgICAgICAgICAgIGlmICgoISR0aGlzLT5yZWFkRGF0YU9ubHkpICYmIChpc3NldCgkc2hlZXQtPlByaW50SW5mb3JtYXRpb24pKSkgewogICAgICAgICAgICAgICAgaWYgKGlzc2V0KCRzaGVldC0+UHJpbnRJbmZvcm1hdGlvbi0+TWFyZ2lucykpIHsKICAgICAgICAgICAgICAgICAgICBmb3JlYWNoICgkc2hlZXQtPlByaW50SW5mb3JtYXRpb24tPk1hcmdpbnMtPmNoaWxkcmVuKCdnbm0nLCB0cnVlKSBhcyAka2V5ID0+ICRtYXJnaW4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgJG1hcmdpbkF0dHJpYnV0ZXMgPSAkbWFyZ2luLT5hdHRyaWJ1dGVzKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICRtYXJnaW5TaXplID0gNzIgLyAxMDA7ICAgIC8vICAgIERlZmF1bHQKICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICgkbWFyZ2luQXR0cmlidXRlc1snUHJlZlVuaXQnXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbW0nOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtYXJnaW5TaXplID0gaW50dmFsKCRtYXJnaW5BdHRyaWJ1dGVzWydQb2ludHMnXSkgLyAxMDA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICgka2V5KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd0b3AnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRvYmpQSFBFeGNlbC0+Z2V0QWN0aXZlU2hlZXQoKS0+Z2V0UGFnZU1hcmdpbnMoKS0+c2V0VG9wKCRtYXJnaW5TaXplKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2JvdHRvbSc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG9ialBIUEV4Y2VsLT5nZXRBY3RpdmVTaGVldCgpLT5nZXRQYWdlTWFyZ2lucygpLT5zZXRCb3R0b20oJG1hcmdpblNpemUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnbGVmdCc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG9ialBIUEV4Y2VsLT5nZXRBY3RpdmVTaGVldCgpLT5nZXRQYWdlTWFyZ2lucygpLT5zZXRMZWZ0KCRtYXJnaW5TaXplKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3JpZ2h0JzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkb2JqUEhQRXhjZWwtPmdldEFjdGl2ZVNoZWV0KCktPmdldFBhZ2VNYXJnaW5zKCktPnNldFJpZ2h0KCRtYXJnaW5TaXplKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ2hlYWRlcic6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG9ialBIUEV4Y2VsLT5nZXRBY3RpdmVTaGVldCgpLT5nZXRQYWdlTWFyZ2lucygpLT5zZXRIZWFkZXIoJG1hcmdpblNpemUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnZm9vdGVyJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkb2JqUEhQRXhjZWwtPmdldEFjdGl2ZVNoZWV0KCktPmdldFBhZ2VNYXJnaW5zKCktPnNldEZvb3RlcigkbWFyZ2luU2l6ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGZvcmVhY2ggKCRzaGVldC0+Q2VsbHMtPkNlbGwgYXMgJGNlbGwpIHsKICAgICAgICAgICAgICAgICRjZWxsQXR0cmlidXRlcyA9ICRjZWxsLT5hdHRyaWJ1dGVzKCk7CiAgICAgICAgICAgICAgICAkcm93ID0gKGludCkgJGNlbGxBdHRyaWJ1dGVzLT5Sb3cgKyAxOwogICAgICAgICAgICAgICAgJGNvbHVtbiA9IChpbnQpICRjZWxsQXR0cmlidXRlcy0+Q29sOwoKICAgICAgICAgICAgICAgIGlmICgkcm93ID4gJG1heFJvdykgewogICAgICAgICAgICAgICAgICAgICRtYXhSb3cgPSAkcm93OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKCRjb2x1bW4gPiAkbWF4Q29sKSB7CiAgICAgICAgICAgICAgICAgICAgJG1heENvbCA9ICRjb2x1bW47CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgJGNvbHVtbiA9IFBIUEV4Y2VsX0NlbGw6OnN0cmluZ0Zyb21Db2x1bW5JbmRleCgkY29sdW1uKTsKCiAgICAgICAgICAgICAgICAvLyBSZWFkIGNlbGw\/CiAgICAgICAgICAgICAgICBpZiAoJHRoaXMtPmdldFJlYWRGaWx0ZXIoKSAhPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIGlmICghJHRoaXMtPmdldFJlYWRGaWx0ZXIoKS0+cmVhZENlbGwoJGNvbHVtbiwgJHJvdywgJHdvcmtzaGVldE5hbWUpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkVmFsdWVUeXBlID0gJGNlbGxBdHRyaWJ1dGVzLT5WYWx1ZVR5cGU7CiAgICAgICAgICAgICAgICAkRXhwcklEID0gKHN0cmluZykgJGNlbGxBdHRyaWJ1dGVzLT5FeHBySUQ7Ci8vICAgICAgICAgICAgICAgIGVjaG8gJ0NlbGwgJywgJGNvbHVtbiwgJHJvdywnPGJyIC8+JzsKLy8gICAgICAgICAgICAgICAgZWNobyAnVHlwZSBpcyAnLCAkVmFsdWVUeXBlLCc8YnIgLz4nOwovLyAgICAgICAgICAgICAgICBlY2hvICdWYWx1ZSBpcyAnLCAkY2VsbCwnPGJyIC8+JzsKICAgICAgICAgICAgICAgICR0eXBlID0gUEhQRXhjZWxfQ2VsbF9EYXRhVHlwZTo6VFlQRV9GT1JNVUxBOwogICAgICAgICAgICAgICAgaWYgKCRFeHBySUQgPiAnJykgewogICAgICAgICAgICAgICAgICAgIGlmICgoKHN0cmluZykgJGNlbGwpID4gJycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmV4cHJlc3Npb25zWyRFeHBySURdID0gYXJyYXkoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnY29sdW1uJyAgICA9PiAkY2VsbEF0dHJpYnV0ZXMtPkNvbCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdyb3cnICAgICAgICA9PiAkY2VsbEF0dHJpYnV0ZXMtPlJvdywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdmb3JtdWxhJyAgICA9PiAoc3RyaW5nKSAkY2VsbAogICAgICAgICAgICAgICAgICAgICAgICApOwovLyAgICAgICAgICAgICAgICAgICAgICAgIGVjaG8gJ05FVyBFWFBSRVNTSU9OICcsICRFeHBySUQsJzxiciAvPic7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgJGV4cHJlc3Npb24gPSAkdGhpcy0+ZXhwcmVzc2lvbnNbJEV4cHJJRF07CgogICAgICAgICAgICAgICAgICAgICAgICAkY2VsbCA9ICR0aGlzLT5yZWZlcmVuY2VIZWxwZXItPnVwZGF0ZUZvcm11bGFSZWZlcmVuY2VzKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGV4cHJlc3Npb25bJ2Zvcm11bGEnXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdBMScsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY2VsbEF0dHJpYnV0ZXMtPkNvbCAtICRleHByZXNzaW9uWydjb2x1bW4nXSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjZWxsQXR0cmlidXRlcy0+Um93IC0gJGV4cHJlc3Npb25bJ3JvdyddLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHdvcmtzaGVldE5hbWUKICAgICAgICAgICAgICAgICAgICAgICAgKTsKLy8gICAgICAgICAgICAgICAgICAgICAgICBlY2hvICdTSEFSRUQgRVhQUkVTU0lPTiAnLCAkRXhwcklELCc8YnIgLz4nOwovLyAgICAgICAgICAgICAgICAgICAgICAgIGVjaG8gJ05ldyBWYWx1ZSBpcyAnLCAkY2VsbCwnPGJyIC8+JzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJHR5cGUgPSBQSFBFeGNlbF9DZWxsX0RhdGFUeXBlOjpUWVBFX0ZPUk1VTEE7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoJFZhbHVlVHlwZSkgewogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICcxMCc6ICAgICAgICAvLyAgICBOVUxMCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdHlwZSA9IFBIUEV4Y2VsX0NlbGxfRGF0YVR5cGU6OlRZUEVfTlVMTDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICcyMCc6ICAgICAgICAvLyAgICBCb29sZWFuCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdHlwZSA9IFBIUEV4Y2VsX0NlbGxfRGF0YVR5cGU6OlRZUEVfQk9PTDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjZWxsID0gKCRjZWxsID09ICdUUlVFJykgPyB0cnVlOiBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICczMCc6ICAgICAgICAvLyAgICBJbnRlZ2VyCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkY2VsbCA9IGludHZhbCgkY2VsbCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBFeGNlbCAyMDA3KyBkb2Vzbid0IGRpZmZlcmVudGlhdGUgYmV0d2VlbiBpbnRlZ2VyIGFuZCBmbG9hdCwgc28gc2V0IHRoZSB2YWx1ZSBhbmQgZHJvcHRocnUgdG8gdGhlIG5leHQgKG51bWVyaWMpIGNhc2UKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnNDAnOiAgICAgICAgLy8gICAgRmxvYXQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0eXBlID0gUEhQRXhjZWxfQ2VsbF9EYXRhVHlwZTo6VFlQRV9OVU1FUklDOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJzUwJzogICAgICAgIC8vICAgIEVycm9yCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdHlwZSA9IFBIUEV4Y2VsX0NlbGxfRGF0YVR5cGU6OlRZUEVfRVJST1I7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnNjAnOiAgICAgICAgLy8gICAgU3RyaW5nCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdHlwZSA9IFBIUEV4Y2VsX0NlbGxfRGF0YVR5cGU6OlRZUEVfU1RSSU5HOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJzcwJzogICAgICAgIC8vICAgIENlbGwgUmFuZ2UKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnODAnOiAgICAgICAgLy8gICAgQXJyYXkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkb2JqUEhQRXhjZWwtPmdldEFjdGl2ZVNoZWV0KCktPmdldENlbGwoJGNvbHVtbi4kcm93KS0+c2V0VmFsdWVFeHBsaWNpdCgkY2VsbCwgJHR5cGUpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoKCEkdGhpcy0+cmVhZERhdGFPbmx5KSAmJiAoaXNzZXQoJHNoZWV0LT5PYmplY3RzKSkpIHsKICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRzaGVldC0+T2JqZWN0cy0+Y2hpbGRyZW4oJ2dubScsIHRydWUpIGFzICRrZXkgPT4gJGNvbW1lbnQpIHsKICAgICAgICAgICAgICAgICAgICAkY29tbWVudEF0dHJpYnV0ZXMgPSAkY29tbWVudC0+YXR0cmlidXRlcygpOwogICAgICAgICAgICAgICAgICAgIC8vICAgIE9ubHkgY29tbWVudCBvYmplY3RzIGFyZSBoYW5kbGVkIGF0IHRoZSBtb21lbnQKICAgICAgICAgICAgICAgICAgICBpZiAoJGNvbW1lbnRBdHRyaWJ1dGVzLT5UZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRvYmpQSFBFeGNlbC0+Z2V0QWN0aXZlU2hlZXQoKS0+Z2V0Q29tbWVudCgoc3RyaW5nKSRjb21tZW50QXR0cmlidXRlcy0+T2JqZWN0Qm91bmQpLT5zZXRBdXRob3IoKHN0cmluZykkY29tbWVudEF0dHJpYnV0ZXMtPkF1dGhvciktPnNldFRleHQoJHRoaXMtPnBhcnNlUmljaFRleHQoKHN0cmluZykkY29tbWVudEF0dHJpYnV0ZXMtPlRleHQpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KLy8gICAgICAgICAgICBlY2hvICckbWF4Q29sPScsICRtYXhDb2wsJzsgJG1heFJvdz0nLCAkbWF4Um93LCc8YnIgLz4nOwovLwogICAgICAgICAgICBmb3JlYWNoICgkc2hlZXQtPlN0eWxlcy0+U3R5bGVSZWdpb24gYXMgJHN0eWxlUmVnaW9uKSB7CiAgICAgICAgICAgICAgICAkc3R5bGVBdHRyaWJ1dGVzID0gJHN0eWxlUmVnaW9uLT5hdHRyaWJ1dGVzKCk7CiAgICAgICAgICAgICAgICBpZiAoKCRzdHlsZUF0dHJpYnV0ZXNbJ3N0YXJ0Um93J10gPD0gJG1heFJvdykgJiYKICAgICAgICAgICAgICAgICAgICAoJHN0eWxlQXR0cmlidXRlc1snc3RhcnRDb2wnXSA8PSAkbWF4Q29sKSkgewogICAgICAgICAgICAgICAgICAgICRzdGFydENvbHVtbiA9IFBIUEV4Y2VsX0NlbGw6OnN0cmluZ0Zyb21Db2x1bW5JbmRleCgoaW50KSAkc3R5bGVBdHRyaWJ1dGVzWydzdGFydENvbCddKTsKICAgICAgICAgICAgICAgICAgICAkc3RhcnRSb3cgPSAkc3R5bGVBdHRyaWJ1dGVzWydzdGFydFJvdyddICsgMTsKCiAgICAgICAgICAgICAgICAgICAgJGVuZENvbHVtbiA9ICgkc3R5bGVBdHRyaWJ1dGVzWydlbmRDb2wnXSA+ICRtYXhDb2wpID8gJG1heENvbCA6IChpbnQpICRzdHlsZUF0dHJpYnV0ZXNbJ2VuZENvbCddOwogICAgICAgICAgICAgICAgICAgICRlbmRDb2x1bW4gPSBQSFBFeGNlbF9DZWxsOjpzdHJpbmdGcm9tQ29sdW1uSW5kZXgoJGVuZENvbHVtbik7CiAgICAgICAgICAgICAgICAgICAgJGVuZFJvdyA9ICgkc3R5bGVBdHRyaWJ1dGVzWydlbmRSb3cnXSA+ICRtYXhSb3cpID8gJG1heFJvdyA6ICRzdHlsZUF0dHJpYnV0ZXNbJ2VuZFJvdyddOwogICAgICAgICAgICAgICAgICAgICRlbmRSb3cgKz0gMTsKICAgICAgICAgICAgICAgICAgICAkY2VsbFJhbmdlID0gJHN0YXJ0Q29sdW1uLiRzdGFydFJvdy4nOicuJGVuZENvbHVtbi4kZW5kUm93OwovLyAgICAgICAgICAgICAgICAgICAgZWNobyAkY2VsbFJhbmdlLCc8YnIgLz4nOwoKICAgICAgICAgICAgICAgICAgICAkc3R5bGVBdHRyaWJ1dGVzID0gJHN0eWxlUmVnaW9uLT5TdHlsZS0+YXR0cmlidXRlcygpOwovLyAgICAgICAgICAgICAgICAgICAgdmFyX2R1bXAoJHN0eWxlQXR0cmlidXRlcyk7Ci8vICAgICAgICAgICAgICAgICAgICBlY2hvICc8YnIgLz4nOwoKICAgICAgICAgICAgICAgICAgICAvLyAgICBXZSBzdGlsbCBzZXQgdGhlIG51bWJlciBmb3JtYXQgbWFzayBmb3IgZGF0ZS90aW1lIHZhbHVlcywgZXZlbiBpZiByZWFkRGF0YU9ubHkgaXMgdHJ1ZQogICAgICAgICAgICAgICAgICAgIGlmICgoISR0aGlzLT5yZWFkRGF0YU9ubHkpIHx8CiAgICAgICAgICAgICAgICAgICAgICAgIChQSFBFeGNlbF9TaGFyZWRfRGF0ZTo6aXNEYXRlVGltZUZvcm1hdENvZGUoKHN0cmluZykgJHN0eWxlQXR0cmlidXRlc1snRm9ybWF0J10pKSkgewogICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheSA9IGFycmF5KCk7CiAgICAgICAgICAgICAgICAgICAgICAgICRzdHlsZUFycmF5WydudW1iZXJmb3JtYXQnXVsnY29kZSddID0gKHN0cmluZykgJHN0eWxlQXR0cmlidXRlc1snRm9ybWF0J107CiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgIElmIHJlYWREYXRhT25seSBpcyBmYWxzZSwgd2Ugc2V0IGFsbCBmb3JtYXR0aW5nIGluZm9ybWF0aW9uCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghJHRoaXMtPnJlYWREYXRhT25seSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICgkc3R5bGVBdHRyaWJ1dGVzWydIQWxpZ24nXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJzEnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnYWxpZ25tZW50J11bJ2hvcml6b250YWwnXSA9IFBIUEV4Y2VsX1N0eWxlX0FsaWdubWVudDo6SE9SSVpPTlRBTF9HRU5FUkFMOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICcyJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ2FsaWdubWVudCddWydob3Jpem9udGFsJ10gPSBQSFBFeGNlbF9TdHlsZV9BbGlnbm1lbnQ6OkhPUklaT05UQUxfTEVGVDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnNCc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzdHlsZUFycmF5WydhbGlnbm1lbnQnXVsnaG9yaXpvbnRhbCddID0gUEhQRXhjZWxfU3R5bGVfQWxpZ25tZW50OjpIT1JJWk9OVEFMX1JJR0hUOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICc4JzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ2FsaWdubWVudCddWydob3Jpem9udGFsJ10gPSBQSFBFeGNlbF9TdHlsZV9BbGlnbm1lbnQ6OkhPUklaT05UQUxfQ0VOVEVSOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICcxNic6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnNjQnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnYWxpZ25tZW50J11bJ2hvcml6b250YWwnXSA9IFBIUEV4Y2VsX1N0eWxlX0FsaWdubWVudDo6SE9SSVpPTlRBTF9DRU5URVJfQ09OVElOVU9VUzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnMzInOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnYWxpZ25tZW50J11bJ2hvcml6b250YWwnXSA9IFBIUEV4Y2VsX1N0eWxlX0FsaWdubWVudDo6SE9SSVpPTlRBTF9KVVNUSUZZOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKCRzdHlsZUF0dHJpYnV0ZXNbJ1ZBbGlnbiddKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnMSc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzdHlsZUFycmF5WydhbGlnbm1lbnQnXVsndmVydGljYWwnXSA9IFBIUEV4Y2VsX1N0eWxlX0FsaWdubWVudDo6VkVSVElDQUxfVE9QOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICcyJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ2FsaWdubWVudCddWyd2ZXJ0aWNhbCddID0gUEhQRXhjZWxfU3R5bGVfQWxpZ25tZW50OjpWRVJUSUNBTF9CT1RUT007CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJzQnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnYWxpZ25tZW50J11bJ3ZlcnRpY2FsJ10gPSBQSFBFeGNlbF9TdHlsZV9BbGlnbm1lbnQ6OlZFUlRJQ0FMX0NFTlRFUjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnOCc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzdHlsZUFycmF5WydhbGlnbm1lbnQnXVsndmVydGljYWwnXSA9IFBIUEV4Y2VsX1N0eWxlX0FsaWdubWVudDo6VkVSVElDQUxfSlVTVElGWTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ2FsaWdubWVudCddWyd3cmFwJ10gPSAoJHN0eWxlQXR0cmlidXRlc1snV3JhcFRleHQnXSA9PSAnMScpID8gdHJ1ZSA6IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ2FsaWdubWVudCddWydzaHJpbmtUb0ZpdCddID0gKCRzdHlsZUF0dHJpYnV0ZXNbJ1Nocmlua1RvRml0J10gPT0gJzEnKSA\/IHRydWUgOiBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzdHlsZUFycmF5WydhbGlnbm1lbnQnXVsnaW5kZW50J10gPSAoaW50dmFsKCRzdHlsZUF0dHJpYnV0ZXNbIkluZGVudCJdKSA+IDApID8gJHN0eWxlQXR0cmlidXRlc1siaW5kZW50Il0gOiAwOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRSR0IgPSBzZWxmOjpwYXJzZUdudW1lcmljQ29sb3VyKCRzdHlsZUF0dHJpYnV0ZXNbIkZvcmUiXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnZm9udCddWydjb2xvciddWydyZ2InXSA9ICRSR0I7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkUkdCID0gc2VsZjo6cGFyc2VHbnVtZXJpY0NvbG91cigkc3R5bGVBdHRyaWJ1dGVzWyJCYWNrIl0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNoYWRlID0gJHN0eWxlQXR0cmlidXRlc1siU2hhZGUiXTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoJFJHQiAhPSAnMDAwMDAwJykgfHwgKCRzaGFkZSAhPSAnMCcpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ2ZpbGwnXVsnY29sb3InXVsncmdiJ10gPSAkc3R5bGVBcnJheVsnZmlsbCddWydzdGFydGNvbG9yJ11bJ3JnYiddID0gJFJHQjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkUkdCMiA9IHNlbGY6OnBhcnNlR251bWVyaWNDb2xvdXIoJHN0eWxlQXR0cmlidXRlc1siUGF0dGVybkNvbG9yIl0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzdHlsZUFycmF5WydmaWxsJ11bJ2VuZGNvbG9yJ11bJ3JnYiddID0gJFJHQjI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICgkc2hhZGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnMSc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnZmlsbCddWyd0eXBlJ10gPSBQSFBFeGNlbF9TdHlsZV9GaWxsOjpGSUxMX1NPTElEOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJzInOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ2ZpbGwnXVsndHlwZSddID0gUEhQRXhjZWxfU3R5bGVfRmlsbDo6RklMTF9HUkFESUVOVF9MSU5FQVI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnMyc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnZmlsbCddWyd0eXBlJ10gPSBQSFBFeGNlbF9TdHlsZV9GaWxsOjpGSUxMX0dSQURJRU5UX1BBVEg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnNCc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnZmlsbCddWyd0eXBlJ10gPSBQSFBFeGNlbF9TdHlsZV9GaWxsOjpGSUxMX1BBVFRFUk5fREFSS0RPV047CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnNSc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnZmlsbCddWyd0eXBlJ10gPSBQSFBFeGNlbF9TdHlsZV9GaWxsOjpGSUxMX1BBVFRFUk5fREFSS0dSQVk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnNic6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnZmlsbCddWyd0eXBlJ10gPSBQSFBFeGNlbF9TdHlsZV9GaWxsOjpGSUxMX1BBVFRFUk5fREFSS0dSSUQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnNyc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnZmlsbCddWyd0eXBlJ10gPSBQSFBFeGNlbF9TdHlsZV9GaWxsOjpGSUxMX1BBVFRFUk5fREFSS0hPUklaT05UQUw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnOCc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnZmlsbCddWyd0eXBlJ10gPSBQSFBFeGNlbF9TdHlsZV9GaWxsOjpGSUxMX1BBVFRFUk5fREFSS1RSRUxMSVM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnOSc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnZmlsbCddWyd0eXBlJ10gPSBQSFBFeGNlbF9TdHlsZV9GaWxsOjpGSUxMX1BBVFRFUk5fREFSS1VQOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJzEwJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzdHlsZUFycmF5WydmaWxsJ11bJ3R5cGUnXSA9IFBIUEV4Y2VsX1N0eWxlX0ZpbGw6OkZJTExfUEFUVEVSTl9EQVJLVkVSVElDQUw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnMTEnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ2ZpbGwnXVsndHlwZSddID0gUEhQRXhjZWxfU3R5bGVfRmlsbDo6RklMTF9QQVRURVJOX0dSQVkwNjI1OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJzEyJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzdHlsZUFycmF5WydmaWxsJ11bJ3R5cGUnXSA9IFBIUEV4Y2VsX1N0eWxlX0ZpbGw6OkZJTExfUEFUVEVSTl9HUkFZMTI1OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJzEzJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzdHlsZUFycmF5WydmaWxsJ11bJ3R5cGUnXSA9IFBIUEV4Y2VsX1N0eWxlX0ZpbGw6OkZJTExfUEFUVEVSTl9MSUdIVERPV047CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnMTQnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ2ZpbGwnXVsndHlwZSddID0gUEhQRXhjZWxfU3R5bGVfRmlsbDo6RklMTF9QQVRURVJOX0xJR0hUR1JBWTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICcxNSc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnZmlsbCddWyd0eXBlJ10gPSBQSFBFeGNlbF9TdHlsZV9GaWxsOjpGSUxMX1BBVFRFUk5fTElHSFRHUklEOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJzE2JzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzdHlsZUFycmF5WydmaWxsJ11bJ3R5cGUnXSA9IFBIUEV4Y2VsX1N0eWxlX0ZpbGw6OkZJTExfUEFUVEVSTl9MSUdIVEhPUklaT05UQUw7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAnMTcnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ2ZpbGwnXVsndHlwZSddID0gUEhQRXhjZWxfU3R5bGVfRmlsbDo6RklMTF9QQVRURVJOX0xJR0hUVFJFTExJUzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICcxOCc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnZmlsbCddWyd0eXBlJ10gPSBQSFBFeGNlbF9TdHlsZV9GaWxsOjpGSUxMX1BBVFRFUk5fTElHSFRVUDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICcxOSc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnZmlsbCddWyd0eXBlJ10gPSBQSFBFeGNlbF9TdHlsZV9GaWxsOjpGSUxMX1BBVFRFUk5fTElHSFRWRVJUSUNBTDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICcyMCc6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnZmlsbCddWyd0eXBlJ10gPSBQSFBFeGNlbF9TdHlsZV9GaWxsOjpGSUxMX1BBVFRFUk5fTUVESVVNR1JBWTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkZm9udEF0dHJpYnV0ZXMgPSAkc3R5bGVSZWdpb24tPlN0eWxlLT5Gb250LT5hdHRyaWJ1dGVzKCk7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhcl9kdW1wKCRmb250QXR0cmlidXRlcyk7Ci8vICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVjaG8gJzxiciAvPic7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnZm9udCddWyduYW1lJ10gPSAoc3RyaW5nKSAkc3R5bGVSZWdpb24tPlN0eWxlLT5Gb250OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ2ZvbnQnXVsnc2l6ZSddID0gaW50dmFsKCRmb250QXR0cmlidXRlc1snVW5pdCddKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzdHlsZUFycmF5Wydmb250J11bJ2JvbGQnXSA9ICgkZm9udEF0dHJpYnV0ZXNbJ0JvbGQnXSA9PSAnMScpID8gdHJ1ZSA6IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ2ZvbnQnXVsnaXRhbGljJ10gPSAoJGZvbnRBdHRyaWJ1dGVzWydJdGFsaWMnXSA9PSAnMScpID8gdHJ1ZSA6IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ2ZvbnQnXVsnc3RyaWtlJ10gPSAoJGZvbnRBdHRyaWJ1dGVzWydTdHJpa2VUaHJvdWdoJ10gPT0gJzEnKSA\/IHRydWUgOiBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoJGZvbnRBdHRyaWJ1dGVzWydVbmRlcmxpbmUnXSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJzEnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnZm9udCddWyd1bmRlcmxpbmUnXSA9IFBIUEV4Y2VsX1N0eWxlX0ZvbnQ6OlVOREVSTElORV9TSU5HTEU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJzInOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnZm9udCddWyd1bmRlcmxpbmUnXSA9IFBIUEV4Y2VsX1N0eWxlX0ZvbnQ6OlVOREVSTElORV9ET1VCTEU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJzMnOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnZm9udCddWyd1bmRlcmxpbmUnXSA9IFBIUEV4Y2VsX1N0eWxlX0ZvbnQ6OlVOREVSTElORV9TSU5HTEVBQ0NPVU5USU5HOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICc0JzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ2ZvbnQnXVsndW5kZXJsaW5lJ10gPSBQSFBFeGNlbF9TdHlsZV9Gb250OjpVTkRFUkxJTkVfRE9VQkxFQUNDT1VOVElORzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ2ZvbnQnXVsndW5kZXJsaW5lJ10gPSBQSFBFeGNlbF9TdHlsZV9Gb250OjpVTkRFUkxJTkVfTk9ORTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKCRmb250QXR0cmlidXRlc1snU2NyaXB0J10pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICcxJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ2ZvbnQnXVsnc3VwZXJTY3JpcHQnXSA9IHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJy0xJzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ2ZvbnQnXVsnc3ViU2NyaXB0J10gPSB0cnVlOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNzZXQoJHN0eWxlUmVnaW9uLT5TdHlsZS0+U3R5bGVCb3JkZXIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzc2V0KCRzdHlsZVJlZ2lvbi0+U3R5bGUtPlN0eWxlQm9yZGVyLT5Ub3ApKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzdHlsZUFycmF5Wydib3JkZXJzJ11bJ3RvcCddID0gc2VsZjo6cGFyc2VCb3JkZXJBdHRyaWJ1dGVzKCRzdHlsZVJlZ2lvbi0+U3R5bGUtPlN0eWxlQm9yZGVyLT5Ub3AtPmF0dHJpYnV0ZXMoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpc3NldCgkc3R5bGVSZWdpb24tPlN0eWxlLT5TdHlsZUJvcmRlci0+Qm90dG9tKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnYm9yZGVycyddWydib3R0b20nXSA9IHNlbGY6OnBhcnNlQm9yZGVyQXR0cmlidXRlcygkc3R5bGVSZWdpb24tPlN0eWxlLT5TdHlsZUJvcmRlci0+Qm90dG9tLT5hdHRyaWJ1dGVzKCkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNzZXQoJHN0eWxlUmVnaW9uLT5TdHlsZS0+U3R5bGVCb3JkZXItPkxlZnQpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzdHlsZUFycmF5Wydib3JkZXJzJ11bJ2xlZnQnXSA9IHNlbGY6OnBhcnNlQm9yZGVyQXR0cmlidXRlcygkc3R5bGVSZWdpb24tPlN0eWxlLT5TdHlsZUJvcmRlci0+TGVmdC0+YXR0cmlidXRlcygpKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzc2V0KCRzdHlsZVJlZ2lvbi0+U3R5bGUtPlN0eWxlQm9yZGVyLT5SaWdodCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ2JvcmRlcnMnXVsncmlnaHQnXSA9IHNlbGY6OnBhcnNlQm9yZGVyQXR0cmlidXRlcygkc3R5bGVSZWdpb24tPlN0eWxlLT5TdHlsZUJvcmRlci0+UmlnaHQtPmF0dHJpYnV0ZXMoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgoaXNzZXQoJHN0eWxlUmVnaW9uLT5TdHlsZS0+U3R5bGVCb3JkZXItPkRpYWdvbmFsKSkgJiYgKGlzc2V0KCRzdHlsZVJlZ2lvbi0+U3R5bGUtPlN0eWxlQm9yZGVyLT57J1Jldi1EaWFnb25hbCd9KSkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ2JvcmRlcnMnXVsnZGlhZ29uYWwnXSA9IHNlbGY6OnBhcnNlQm9yZGVyQXR0cmlidXRlcygkc3R5bGVSZWdpb24tPlN0eWxlLT5TdHlsZUJvcmRlci0+RGlhZ29uYWwtPmF0dHJpYnV0ZXMoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzdHlsZUFycmF5Wydib3JkZXJzJ11bJ2RpYWdvbmFsZGlyZWN0aW9uJ10gPSBQSFBFeGNlbF9TdHlsZV9Cb3JkZXJzOjpESUFHT05BTF9CT1RIOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZWlmIChpc3NldCgkc3R5bGVSZWdpb24tPlN0eWxlLT5TdHlsZUJvcmRlci0+RGlhZ29uYWwpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzdHlsZUFycmF5Wydib3JkZXJzJ11bJ2RpYWdvbmFsJ10gPSBzZWxmOjpwYXJzZUJvcmRlckF0dHJpYnV0ZXMoJHN0eWxlUmVnaW9uLT5TdHlsZS0+U3R5bGVCb3JkZXItPkRpYWdvbmFsLT5hdHRyaWJ1dGVzKCkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnYm9yZGVycyddWydkaWFnb25hbGRpcmVjdGlvbiddID0gUEhQRXhjZWxfU3R5bGVfQm9yZGVyczo6RElBR09OQUxfVVA7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlaWYgKGlzc2V0KCRzdHlsZVJlZ2lvbi0+U3R5bGUtPlN0eWxlQm9yZGVyLT57J1Jldi1EaWFnb25hbCd9KSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnYm9yZGVycyddWydkaWFnb25hbCddID0gc2VsZjo6cGFyc2VCb3JkZXJBdHRyaWJ1dGVzKCRzdHlsZVJlZ2lvbi0+U3R5bGUtPlN0eWxlQm9yZGVyLT57J1Jldi1EaWFnb25hbCd9LT5hdHRyaWJ1dGVzKCkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnYm9yZGVycyddWydkaWFnb25hbGRpcmVjdGlvbiddID0gUEhQRXhjZWxfU3R5bGVfQm9yZGVyczo6RElBR09OQUxfRE9XTjsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNzZXQoJHN0eWxlUmVnaW9uLT5TdHlsZS0+SHlwZXJMaW5rKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgIFRPIERPCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGh5cGVybGluayA9ICRzdHlsZVJlZ2lvbi0+U3R5bGUtPkh5cGVyTGluay0+YXR0cmlidXRlcygpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9Ci8vICAgICAgICAgICAgICAgICAgICAgICAgdmFyX2R1bXAoJHN0eWxlQXJyYXkpOwovLyAgICAgICAgICAgICAgICAgICAgICAgIGVjaG8gJzxiciAvPic7CiAgICAgICAgICAgICAgICAgICAgICAgICRvYmpQSFBFeGNlbC0+Z2V0QWN0aXZlU2hlZXQoKS0+Z2V0U3R5bGUoJGNlbGxSYW5nZSktPmFwcGx5RnJvbUFycmF5KCRzdHlsZUFycmF5KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgoISR0aGlzLT5yZWFkRGF0YU9ubHkpICYmIChpc3NldCgkc2hlZXQtPkNvbHMpKSkgewogICAgICAgICAgICAgICAgLy8gICAgQ29sdW1uIFdpZHRocwogICAgICAgICAgICAgICAgJGNvbHVtbkF0dHJpYnV0ZXMgPSAkc2hlZXQtPkNvbHMtPmF0dHJpYnV0ZXMoKTsKICAgICAgICAgICAgICAgICRkZWZhdWx0V2lkdGggPSAkY29sdW1uQXR0cmlidXRlc1snRGVmYXVsdFNpemVQdHMnXSAgLyA1LjQ7CiAgICAgICAgICAgICAgICAkYyA9IDA7CiAgICAgICAgICAgICAgICBmb3JlYWNoICgkc2hlZXQtPkNvbHMtPkNvbEluZm8gYXMgJGNvbHVtbk92ZXJyaWRlKSB7CiAgICAgICAgICAgICAgICAgICAgJGNvbHVtbkF0dHJpYnV0ZXMgPSAkY29sdW1uT3ZlcnJpZGUtPmF0dHJpYnV0ZXMoKTsKICAgICAgICAgICAgICAgICAgICAkY29sdW1uID0gJGNvbHVtbkF0dHJpYnV0ZXNbJ05vJ107CiAgICAgICAgICAgICAgICAgICAgJGNvbHVtbldpZHRoID0gJGNvbHVtbkF0dHJpYnV0ZXNbJ1VuaXQnXSAgLyA1LjQ7CiAgICAgICAgICAgICAgICAgICAgJGhpZGRlbiA9ICgoaXNzZXQoJGNvbHVtbkF0dHJpYnV0ZXNbJ0hpZGRlbiddKSkgJiYgKCRjb2x1bW5BdHRyaWJ1dGVzWydIaWRkZW4nXSA9PSAnMScpKSA\/IHRydWUgOiBmYWxzZTsKICAgICAgICAgICAgICAgICAgICAkY29sdW1uQ291bnQgPSAoaXNzZXQoJGNvbHVtbkF0dHJpYnV0ZXNbJ0NvdW50J10pKSA\/ICRjb2x1bW5BdHRyaWJ1dGVzWydDb3VudCddIDogMTsKICAgICAgICAgICAgICAgICAgICB3aGlsZSAoJGMgPCAkY29sdW1uKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRvYmpQSFBFeGNlbC0+Z2V0QWN0aXZlU2hlZXQoKS0+Z2V0Q29sdW1uRGltZW5zaW9uKFBIUEV4Y2VsX0NlbGw6OnN0cmluZ0Zyb21Db2x1bW5JbmRleCgkYykpLT5zZXRXaWR0aCgkZGVmYXVsdFdpZHRoKTsKICAgICAgICAgICAgICAgICAgICAgICAgKyskYzsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKCgkYyA8ICgkY29sdW1uKyRjb2x1bW5Db3VudCkpICYmICgkYyA8PSAkbWF4Q29sKSkgewogICAgICAgICAgICAgICAgICAgICAgICAkb2JqUEhQRXhjZWwtPmdldEFjdGl2ZVNoZWV0KCktPmdldENvbHVtbkRpbWVuc2lvbihQSFBFeGNlbF9DZWxsOjpzdHJpbmdGcm9tQ29sdW1uSW5kZXgoJGMpKS0+c2V0V2lkdGgoJGNvbHVtbldpZHRoKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCRoaWRkZW4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRvYmpQSFBFeGNlbC0+Z2V0QWN0aXZlU2hlZXQoKS0+Z2V0Q29sdW1uRGltZW5zaW9uKFBIUEV4Y2VsX0NlbGw6OnN0cmluZ0Zyb21Db2x1bW5JbmRleCgkYykpLT5zZXRWaXNpYmxlKGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICArKyRjOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHdoaWxlICgkYyA8PSAkbWF4Q29sKSB7CiAgICAgICAgICAgICAgICAgICAgJG9ialBIUEV4Y2VsLT5nZXRBY3RpdmVTaGVldCgpLT5nZXRDb2x1bW5EaW1lbnNpb24oUEhQRXhjZWxfQ2VsbDo6c3RyaW5nRnJvbUNvbHVtbkluZGV4KCRjKSktPnNldFdpZHRoKCRkZWZhdWx0V2lkdGgpOwogICAgICAgICAgICAgICAgICAgICsrJGM7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmICgoISR0aGlzLT5yZWFkRGF0YU9ubHkpICYmIChpc3NldCgkc2hlZXQtPlJvd3MpKSkgewogICAgICAgICAgICAgICAgLy8gICAgUm93IEhlaWdodHMKICAgICAgICAgICAgICAgICRyb3dBdHRyaWJ1dGVzID0gJHNoZWV0LT5Sb3dzLT5hdHRyaWJ1dGVzKCk7CiAgICAgICAgICAgICAgICAkZGVmYXVsdEhlaWdodCA9ICRyb3dBdHRyaWJ1dGVzWydEZWZhdWx0U2l6ZVB0cyddOwogICAgICAgICAgICAgICAgJHIgPSAwOwoKICAgICAgICAgICAgICAgIGZvcmVhY2ggKCRzaGVldC0+Um93cy0+Um93SW5mbyBhcyAkcm93T3ZlcnJpZGUpIHsKICAgICAgICAgICAgICAgICAgICAkcm93QXR0cmlidXRlcyA9ICRyb3dPdmVycmlkZS0+YXR0cmlidXRlcygpOwogICAgICAgICAgICAgICAgICAgICRyb3cgPSAkcm93QXR0cmlidXRlc1snTm8nXTsKICAgICAgICAgICAgICAgICAgICAkcm93SGVpZ2h0ID0gJHJvd0F0dHJpYnV0ZXNbJ1VuaXQnXTsKICAgICAgICAgICAgICAgICAgICAkaGlkZGVuID0gKChpc3NldCgkcm93QXR0cmlidXRlc1snSGlkZGVuJ10pKSAmJiAoJHJvd0F0dHJpYnV0ZXNbJ0hpZGRlbiddID09ICcxJykpID8gdHJ1ZSA6IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICRyb3dDb3VudCA9IChpc3NldCgkcm93QXR0cmlidXRlc1snQ291bnQnXSkpID8gJHJvd0F0dHJpYnV0ZXNbJ0NvdW50J10gOiAxOwogICAgICAgICAgICAgICAgICAgIHdoaWxlICgkciA8ICRyb3cpIHsKICAgICAgICAgICAgICAgICAgICAgICAgKyskcjsKICAgICAgICAgICAgICAgICAgICAgICAgJG9ialBIUEV4Y2VsLT5nZXRBY3RpdmVTaGVldCgpLT5nZXRSb3dEaW1lbnNpb24oJHIpLT5zZXRSb3dIZWlnaHQoJGRlZmF1bHRIZWlnaHQpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB3aGlsZSAoKCRyIDwgKCRyb3crJHJvd0NvdW50KSkgJiYgKCRyIDwgJG1heFJvdykpIHsKICAgICAgICAgICAgICAgICAgICAgICAgKyskcjsKICAgICAgICAgICAgICAgICAgICAgICAgJG9ialBIUEV4Y2VsLT5nZXRBY3RpdmVTaGVldCgpLT5nZXRSb3dEaW1lbnNpb24oJHIpLT5zZXRSb3dIZWlnaHQoJHJvd0hlaWdodCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkaGlkZGVuKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkb2JqUEhQRXhjZWwtPmdldEFjdGl2ZVNoZWV0KCktPmdldFJvd0RpbWVuc2lvbigkciktPnNldFZpc2libGUoZmFsc2UpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgd2hpbGUgKCRyIDwgJG1heFJvdykgewogICAgICAgICAgICAgICAgICAgICsrJHI7CiAgICAgICAgICAgICAgICAgICAgJG9ialBIUEV4Y2VsLT5nZXRBY3RpdmVTaGVldCgpLT5nZXRSb3dEaW1lbnNpb24oJHIpLT5zZXRSb3dIZWlnaHQoJGRlZmF1bHRIZWlnaHQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAvLyAgICBIYW5kbGUgTWVyZ2VkIENlbGxzIGluIHRoaXMgd29ya3NoZWV0CiAgICAgICAgICAgIGlmIChpc3NldCgkc2hlZXQtPk1lcmdlZFJlZ2lvbnMpKSB7CiAgICAgICAgICAgICAgICBmb3JlYWNoICgkc2hlZXQtPk1lcmdlZFJlZ2lvbnMtPk1lcmdlIGFzICRtZXJnZUNlbGxzKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHN0cnBvcygkbWVyZ2VDZWxscywgJzonKSAhPT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJG9ialBIUEV4Y2VsLT5nZXRBY3RpdmVTaGVldCgpLT5tZXJnZUNlbGxzKCRtZXJnZUNlbGxzKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICR3b3Jrc2hlZXRJRCsrOwogICAgICAgIH0KCiAgICAgICAgLy8gICAgTG9vcCB0aHJvdWdoIGRlZmluZWROYW1lcyAoZ2xvYmFsIG5hbWVkIHJhbmdlcykKICAgICAgICBpZiAoaXNzZXQoJGdubVhNTC0+TmFtZXMpKSB7CiAgICAgICAgICAgIGZvcmVhY2ggKCRnbm1YTUwtPk5hbWVzLT5OYW1lIGFzICRuYW1lZFJhbmdlKSB7CiAgICAgICAgICAgICAgICAkbmFtZSA9IChzdHJpbmcpICRuYW1lZFJhbmdlLT5uYW1lOwogICAgICAgICAgICAgICAgJHJhbmdlID0gKHN0cmluZykgJG5hbWVkUmFuZ2UtPnZhbHVlOwogICAgICAgICAgICAgICAgaWYgKHN0cmlwb3MoJHJhbmdlLCAnI1JFRiEnKSAhPT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkcmFuZ2UgPSBleHBsb2RlKCchJywgJHJhbmdlKTsKICAgICAgICAgICAgICAgICRyYW5nZVswXSA9IHRyaW0oJHJhbmdlWzBdLCAiJyIpOwogICAgICAgICAgICAgICAgaWYgKCR3b3Jrc2hlZXQgPSAkb2JqUEhQRXhjZWwtPmdldFNoZWV0QnlOYW1lKCRyYW5nZVswXSkpIHsKICAgICAgICAgICAgICAgICAgICAkZXh0cmFjdGVkUmFuZ2UgPSBzdHJfcmVwbGFjZSgnJCcsICcnLCAkcmFuZ2VbMV0pOwogICAgICAgICAgICAgICAgICAgICRvYmpQSFBFeGNlbC0+YWRkTmFtZWRSYW5nZShuZXcgUEhQRXhjZWxfTmFtZWRSYW5nZSgkbmFtZSwgJHdvcmtzaGVldCwgJGV4dHJhY3RlZFJhbmdlKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIFJldHVybgogICAgICAgIHJldHVybiAkb2JqUEhQRXhjZWw7CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgZnVuY3Rpb24gcGFyc2VCb3JkZXJBdHRyaWJ1dGVzKCRib3JkZXJBdHRyaWJ1dGVzKQogICAgewogICAgICAgICRzdHlsZUFycmF5ID0gYXJyYXkoKTsKICAgICAgICBpZiAoaXNzZXQoJGJvcmRlckF0dHJpYnV0ZXNbIkNvbG9yIl0pKSB7CiAgICAgICAgICAgICRzdHlsZUFycmF5Wydjb2xvciddWydyZ2InXSA9IHNlbGY6OnBhcnNlR251bWVyaWNDb2xvdXIoJGJvcmRlckF0dHJpYnV0ZXNbIkNvbG9yIl0pOwogICAgICAgIH0KCiAgICAgICAgc3dpdGNoICgkYm9yZGVyQXR0cmlidXRlc1siU3R5bGUiXSkgewogICAgICAgICAgICBjYXNlICcwJzoKICAgICAgICAgICAgICAgICRzdHlsZUFycmF5WydzdHlsZSddID0gUEhQRXhjZWxfU3R5bGVfQm9yZGVyOjpCT1JERVJfTk9ORTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICcxJzoKICAgICAgICAgICAgICAgICRzdHlsZUFycmF5WydzdHlsZSddID0gUEhQRXhjZWxfU3R5bGVfQm9yZGVyOjpCT1JERVJfVEhJTjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICcyJzoKICAgICAgICAgICAgICAgICRzdHlsZUFycmF5WydzdHlsZSddID0gUEhQRXhjZWxfU3R5bGVfQm9yZGVyOjpCT1JERVJfTUVESVVNOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJzMnOgogICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ3N0eWxlJ10gPSBQSFBFeGNlbF9TdHlsZV9Cb3JkZXI6OkJPUkRFUl9TTEFOVERBU0hET1Q7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnNCc6CiAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnc3R5bGUnXSA9IFBIUEV4Y2VsX1N0eWxlX0JvcmRlcjo6Qk9SREVSX0RBU0hFRDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICc1JzoKICAgICAgICAgICAgICAgICRzdHlsZUFycmF5WydzdHlsZSddID0gUEhQRXhjZWxfU3R5bGVfQm9yZGVyOjpCT1JERVJfVEhJQ0s7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnNic6CiAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnc3R5bGUnXSA9IFBIUEV4Y2VsX1N0eWxlX0JvcmRlcjo6Qk9SREVSX0RPVUJMRTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICc3JzoKICAgICAgICAgICAgICAgICRzdHlsZUFycmF5WydzdHlsZSddID0gUEhQRXhjZWxfU3R5bGVfQm9yZGVyOjpCT1JERVJfRE9UVEVEOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJzgnOgogICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ3N0eWxlJ10gPSBQSFBFeGNlbF9TdHlsZV9Cb3JkZXI6OkJPUkRFUl9NRURJVU1EQVNIRUQ7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnOSc6CiAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnc3R5bGUnXSA9IFBIUEV4Y2VsX1N0eWxlX0JvcmRlcjo6Qk9SREVSX0RBU0hET1Q7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnMTAnOgogICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ3N0eWxlJ10gPSBQSFBFeGNlbF9TdHlsZV9Cb3JkZXI6OkJPUkRFUl9NRURJVU1EQVNIRE9UOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgJzExJzoKICAgICAgICAgICAgICAgICRzdHlsZUFycmF5WydzdHlsZSddID0gUEhQRXhjZWxfU3R5bGVfQm9yZGVyOjpCT1JERVJfREFTSERPVERPVDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlICcxMic6CiAgICAgICAgICAgICAgICAkc3R5bGVBcnJheVsnc3R5bGUnXSA9IFBIUEV4Y2VsX1N0eWxlX0JvcmRlcjo6Qk9SREVSX01FRElVTURBU0hET1RET1Q7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAnMTMnOgogICAgICAgICAgICAgICAgJHN0eWxlQXJyYXlbJ3N0eWxlJ10gPSBQSFBFeGNlbF9TdHlsZV9Cb3JkZXI6OkJPUkRFUl9NRURJVU1EQVNIRE9URE9UOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICAgIHJldHVybiAkc3R5bGVBcnJheTsKICAgIH0KCiAgICBwcml2YXRlIGZ1bmN0aW9uIHBhcnNlUmljaFRleHQoJGlzID0gJycpCiAgICB7CiAgICAgICAgJHZhbHVlID0gbmV3IFBIUEV4Y2VsX1JpY2hUZXh0KCk7CiAgICAgICAgJHZhbHVlLT5jcmVhdGVUZXh0KCRpcyk7CgogICAgICAgIHJldHVybiAkdmFsdWU7CiAgICB9CgogICAgcHJpdmF0ZSBzdGF0aWMgZnVuY3Rpb24gcGFyc2VHbnVtZXJpY0NvbG91cigkZ25tQ29sb3VyKQogICAgewogICAgICAgIGxpc3QoJGdubVIsICRnbm1HLCAkZ25tQikgPSBleHBsb2RlKCc6JywgJGdubUNvbG91cik7CiAgICAgICAgJGdubVIgPSBzdWJzdHIoc3RyX3BhZCgkZ25tUiwgNCwgJzAnLCBTVFJfUEFEX1JJR0hUKSwgMCwgMik7CiAgICAgICAgJGdubUcgPSBzdWJzdHIoc3RyX3BhZCgkZ25tRywgNCwgJzAnLCBTVFJfUEFEX1JJR0hUKSwgMCwgMik7CiAgICAgICAgJGdubUIgPSBzdWJzdHIoc3RyX3BhZCgkZ25tQiwgNCwgJzAnLCBTVFJfUEFEX1JJR0hUKSwgMCwgMik7CiAgICAgICAgcmV0dXJuICRnbm1SIC4gJGdubUcgLiAkZ25tQjsKICAgIH0KfQo=",
    "size": "41888"
}