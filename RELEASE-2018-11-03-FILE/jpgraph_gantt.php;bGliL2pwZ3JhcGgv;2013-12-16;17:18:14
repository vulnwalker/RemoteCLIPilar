{
    "namaFile": "lib\/jpgraph\/jpgraph_gantt.php",
    "lastUpdate": "2013-12-16+17:18:14.00",
    "contentFile": "PD9waHAKLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogLy8gRmlsZTogICAgICAgIEpQR1JBUEhfR0FOVFQuUEhQCiAvLyBEZXNjcmlwdGlvbjogSnBHcmFwaCBHYW50dCBwbG90IGV4dGVuc2lvbgogLy8gQ3JlYXRlZDogICAgIDIwMDEtMTEtMTIKIC8vIFZlcjogICAgICAgICAkSWQ6IGpwZ3JhcGhfZ2FudHQucGhwIDE4MDkgMjAwOS0wOS0wOSAxMzowNzozM1ogbGpwICQKIC8vCiAvLyBDb3B5cmlnaHQgKGMpIEFzaWFsIENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLgogLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICovCgpyZXF1aXJlX29uY2UoJ2pwZ3JhcGhfcGxvdGJhbmQucGhwJyk7CnJlcXVpcmVfb25jZSgnanBncmFwaF9pY29ucGxvdC5waHAnKTsKcmVxdWlyZV9vbmNlKCdqcGdyYXBoX3Bsb3RtYXJrLmluYy5waHAnKTsKCi8vIE1heGltdW0gc2l6ZSBmb3IgQXV0b21hdGljIEdhbnR0IGNoYXJ0CmRlZmluZSgnTUFYX0dBTlRUSU1HX1NJWkVfVycsODAwMCk7CmRlZmluZSgnTUFYX0dBTlRUSU1HX1NJWkVfSCcsNTAwMCk7CgovLyBTY2FsZSBIZWFkZXIgdHlwZXMKZGVmaW5lKCJHQU5UVF9IREFZIiwxKTsKZGVmaW5lKCJHQU5UVF9IV0VFSyIsMik7CmRlZmluZSgiR0FOVFRfSE1PTlRIIiw0KTsKZGVmaW5lKCJHQU5UVF9IWUVBUiIsOCk7CmRlZmluZSgiR0FOVFRfSEhPVVIiLDE2KTsKZGVmaW5lKCJHQU5UVF9ITUlOIiwzMik7CgovLyBCYXIgcGF0dGVybnMKZGVmaW5lKCJHQU5UVF9SRElBRyIsQkFORF9SRElBRyk7IC8vIFJpZ2h0IGRpYWdvbmFsIGxpbmVzCmRlZmluZSgiR0FOVFRfTERJQUciLEJBTkRfTERJQUcpOyAvLyBMZWZ0IGRpYWdvbmFsIGxpbmVzCmRlZmluZSgiR0FOVFRfU09MSUQiLEJBTkRfU09MSUQpOyAvLyBTb2xpZCBvbmUgY29sb3IKZGVmaW5lKCJHQU5UVF9WTElORSIsQkFORF9WTElORSk7IC8vIFZlcnRpY2FsIGxpbmVzCmRlZmluZSgiR0FOVFRfSExJTkUiLEJBTkRfSExJTkUpOyAgLy8gSG9yaXpvbnRhbCBsaW5lcwpkZWZpbmUoIkdBTlRUXzNEUExBTkUiLEJBTkRfM0RQTEFORSk7ICAvLyAiM0QiIFBsYW5lCmRlZmluZSgiR0FOVFRfSFZDUk9TUyIsQkFORF9IVkNST1NTKTsgIC8vIFZlcnRpY2FsL0hvciBjcm9zc2VzCmRlZmluZSgiR0FOVFRfRElBR0NST1NTIixCQU5EX0RJQUdDUk9TUyk7IC8vIERpYWdvbmFsIGNyb3NzZXMKCi8vIENvbnZlcnNpb24gY29uc3RhbnQKZGVmaW5lKCJTRUNQRVJEQVkiLDM2MDAqMjQpOwoKLy8gTG9jYWxlcy4gT05MWSBLRVBUIEZPUiBCQUNLV0FSRFMgQ09NUEFUSUJJTElUWQovLyBZb3Ugc2hvdWxkIHVzZSB0aGUgcHJvcGVyIGxvY2FsZSBzdHJpbmdzIGRpcmVjdGx5Ci8vIGZyb20gbm93IG9uLgpkZWZpbmUoIkxPQ0FMRV9FTiIsImVuX1VLIik7CmRlZmluZSgiTE9DQUxFX1NWIiwic3ZfU0UiKTsKCi8vIExheW91dCBvZiBiYXJzCmRlZmluZSgiR0FOVFRfRVZFTiIsMSk7CmRlZmluZSgiR0FOVFRfRlJPTVRPUCIsMik7CgovLyBTdHlsZSBmb3IgbWludXRlIGhlYWRlcgpkZWZpbmUoIk1JTlVURVNUWUxFX01NIiwwKTsgIC8vIDE1CmRlZmluZSgiTUlOVVRFU1RZTEVfQ1VTVE9NIiwyKTsgIC8vIEN1c3RvbSBmb3JtYXQKCgovLyBTdHlsZSBmb3IgaG91ciBoZWFkZXIKZGVmaW5lKCJIT1VSU1RZTEVfSE0yNCIsMCk7ICAvLyAxMzoxMApkZWZpbmUoIkhPVVJTVFlMRV9ITUFNUE0iLDEpOyAgLy8gMToxMHBtCmRlZmluZSgiSE9VUlNUWUxFX0gyNCIsMik7ICAvLyAxMwpkZWZpbmUoIkhPVVJTVFlMRV9IQU1QTSIsMyk7ICAvLyAxcG0KZGVmaW5lKCJIT1VSU1RZTEVfQ1VTVE9NIiw0KTsgIC8vIFVzZXIgZGVmaW5lZAoKLy8gU3R5bGUgZm9yIGRheSBoZWFkZXIKZGVmaW5lKCJEQVlTVFlMRV9PTkVMRVRURVIiLDApOyAgLy8gIk0iCmRlZmluZSgiREFZU1RZTEVfTE9ORyIsMSk7ICAvLyAiTW9uZGF5IgpkZWZpbmUoIkRBWVNUWUxFX0xPTkdEQVlEQVRFMSIsMik7IC8vICJNb25kYXkgMjMgSnVuIgpkZWZpbmUoIkRBWVNUWUxFX0xPTkdEQVlEQVRFMiIsMyk7IC8vICJNb25kYXkgMjMgSnVuIDIwMDMiCmRlZmluZSgiREFZU1RZTEVfU0hPUlQiLDQpOyAgLy8gIk1vbiIKZGVmaW5lKCJEQVlTVFlMRV9TSE9SVERBWURBVEUxIiw1KTsgLy8gIk1vbiAyMy82IgpkZWZpbmUoIkRBWVNUWUxFX1NIT1JUREFZREFURTIiLDYpOyAvLyAiTW9uIDIzIEp1biIKZGVmaW5lKCJEQVlTVFlMRV9TSE9SVERBWURBVEUzIiw3KTsgLy8gIk1vbiAyMyIKZGVmaW5lKCJEQVlTVFlMRV9TSE9SVERBVEUxIiw4KTsgLy8gIjIzLzYiCmRlZmluZSgiREFZU1RZTEVfU0hPUlREQVRFMiIsOSk7IC8vICIyMyBKdW4iCmRlZmluZSgiREFZU1RZTEVfU0hPUlREQVRFMyIsMTApOyAvLyAiTW9uIDIzIgpkZWZpbmUoIkRBWVNUWUxFX1NIT1JUREFURTQiLDExKTsgLy8gIjIzIgpkZWZpbmUoIkRBWVNUWUxFX0NVU1RPTSIsMTIpOyAgLy8gIk0iCgovLyBTdHlsZXMgZm9yIHdlZWsgaGVhZGVyCmRlZmluZSgiV0VFS1NUWUxFX1dOQlIiLDApOwpkZWZpbmUoIldFRUtTVFlMRV9GSVJTVERBWSIsMSk7CmRlZmluZSgiV0VFS1NUWUxFX0ZJUlNUREFZMiIsMik7CmRlZmluZSgiV0VFS1NUWUxFX0ZJUlNUREFZV05CUiIsMyk7CmRlZmluZSgiV0VFS1NUWUxFX0ZJUlNUREFZMldOQlIiLDQpOwoKLy8gU3R5bGVzIGZvciBtb250aCBoZWFkZXIKZGVmaW5lKCJNT05USFNUWUxFX1NIT1JUTkFNRSIsMCk7CmRlZmluZSgiTU9OVEhTVFlMRV9MT05HTkFNRSIsMSk7CmRlZmluZSgiTU9OVEhTVFlMRV9MT05HTkFNRVlFQVIyIiwyKTsKZGVmaW5lKCJNT05USFNUWUxFX1NIT1JUTkFNRVlFQVIyIiwzKTsKZGVmaW5lKCJNT05USFNUWUxFX0xPTkdOQU1FWUVBUjQiLDQpOwpkZWZpbmUoIk1PTlRIU1RZTEVfU0hPUlROQU1FWUVBUjQiLDUpOwpkZWZpbmUoIk1PTlRIU1RZTEVfRklSU1RMRVRURVIiLDYpOwoKCi8vIFR5cGVzIG9mIGNvbnN0cmFpbiBsaW5rcwpkZWZpbmUoJ0NPTlNUUkFJTl9TVEFSVFNUQVJUJywwKTsKZGVmaW5lKCdDT05TVFJBSU5fU1RBUlRFTkQnLDEpOwpkZWZpbmUoJ0NPTlNUUkFJTl9FTkRTVEFSVCcsMik7CmRlZmluZSgnQ09OU1RSQUlOX0VOREVORCcsMyk7CgovLyBBcnJvdyBkaXJlY3Rpb24gZm9yIGNvbnN0cmFpbiBsaW5rcwpkZWZpbmUoJ0FSUk9XX0RPV04nLDApOwpkZWZpbmUoJ0FSUk9XX1VQJywxKTsKZGVmaW5lKCdBUlJPV19MRUZUJywyKTsKZGVmaW5lKCdBUlJPV19SSUdIVCcsMyk7CgovLyBBcnJvdyB0eXBlIGZvciBjb25zdHJhaW4gdHlwZQpkZWZpbmUoJ0FSUk9XVF9TT0xJRCcsMCk7CmRlZmluZSgnQVJST1dUX09QRU4nLDEpOwoKLy8gQXJyb3cgc2l6ZSBmb3IgY29uc3RyYWluIGxpbmVzCmRlZmluZSgnQVJST1dfUzEnLDApOwpkZWZpbmUoJ0FSUk9XX1MyJywxKTsKZGVmaW5lKCdBUlJPV19TMycsMik7CmRlZmluZSgnQVJST1dfUzQnLDMpOwpkZWZpbmUoJ0FSUk9XX1M1Jyw0KTsKCi8vIEFjdGl2aXR5IHR5cGVzIGZvciB1c2Ugd2l0aCB1dGlsaXR5IG1ldGhvZCBDcmVhdGVTaW1wbGUoKQpkZWZpbmUoJ0FDVFlQRV9OT1JNQUwnLDApOwpkZWZpbmUoJ0FDVFlQRV9HUk9VUCcsMSk7CmRlZmluZSgnQUNUWVBFX01JTEVTVE9ORScsMik7CgpkZWZpbmUoJ0FDVElORk9fM0QnLDEpOwpkZWZpbmUoJ0FDVElORk9fMkQnLDApOwoKCi8vIENoZWNrIGlmIGFycmF5X2ZpbGwoKSBleGlzdHMKaWYgKCFmdW5jdGlvbl9leGlzdHMoJ2FycmF5X2ZpbGwnKSkgewogICAgZnVuY3Rpb24gYXJyYXlfZmlsbCgkaVN0YXJ0LCAkaUxlbiwgJHZWYWx1ZSkgewogICAgICAgICRhUmVzdWx0ID0gYXJyYXkoKTsKICAgICAgICBmb3IgKCRpQ291bnQgPSAkaVN0YXJ0OyAkaUNvdW50IDwgJGlMZW4gKyAkaVN0YXJ0OyAkaUNvdW50KyspIHsKICAgICAgICAgICAgJGFSZXN1bHRbJGlDb3VudF0gPSAkdlZhbHVlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gJGFSZXN1bHQ7CiAgICB9Cn0KCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIENMQVNTIEdhbnR0QWN0aXZpdHlJbmZvCi8vIERlc2NyaXB0aW9uOgovLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpjbGFzcyBHYW50dEFjdGl2aXR5SW5mbyB7CiAgICBwdWJsaWMgJGlTaG93PXRydWU7CiAgICBwdWJsaWMgJGlMZWZ0Q29sTWFyZ2luPTQsJGlSaWdodENvbE1hcmdpbj0xLCRpVG9wQ29sTWFyZ2luPTEsJGlCb3R0b21Db2xNYXJnaW49MzsKICAgIHB1YmxpYyAkdmdyaWQgPSBudWxsOwogICAgcHJpdmF0ZSAkaUNvbG9yPSdibGFjayc7CiAgICBwcml2YXRlICRpQmFja2dyb3VuZENvbG9yPSdsaWdodGdyYXknOwogICAgcHJpdmF0ZSAkaUZGYW1pbHk9RkZfRk9OVDEsJGlGU3R5bGU9RlNfTk9STUFMLCRpRlNpemU9MTAsJGlGb250Q29sb3I9J2JsYWNrJzsKICAgIHByaXZhdGUgJGlUaXRsZXM9YXJyYXkoKTsKICAgIHByaXZhdGUgJGlXaWR0aD1hcnJheSgpLCRpSGVpZ2h0PS0xOwogICAgcHJpdmF0ZSAkaVRvcEhlYWRlck1hcmdpbiA9IDQ7CiAgICBwcml2YXRlICRpU3R5bGU9MTsKICAgIHByaXZhdGUgJGlIZWFkZXJBbGlnbj0nY2VudGVyJzsKCiAgICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgpIHsKICAgICAgICAkdGhpcy0+dmdyaWQgPSBuZXcgTGluZVByb3BlcnR5KCk7CiAgICB9CgogICAgZnVuY3Rpb24gSGlkZSgkYUY9dHJ1ZSkgewogICAgICAgICR0aGlzLT5pU2hvdz0hJGFGOwogICAgfQoKICAgIGZ1bmN0aW9uIFNob3coJGFGPXRydWUpIHsKICAgICAgICAkdGhpcy0+aVNob3c9JGFGOwogICAgfQoKICAgIC8vIFNwZWNpZnkgZm9udAogICAgZnVuY3Rpb24gU2V0Rm9udCgkYUZGYW1pbHksJGFGU3R5bGU9RlNfTk9STUFMLCRhRlNpemU9MTApIHsKICAgICAgICAkdGhpcy0+aUZGYW1pbHkgPSAkYUZGYW1pbHk7CiAgICAgICAgJHRoaXMtPmlGU3R5bGUgID0gJGFGU3R5bGU7CiAgICAgICAgJHRoaXMtPmlGU2l6ZSAgPSAkYUZTaXplOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldFN0eWxlKCRhU3R5bGUpIHsKICAgICAgICAkdGhpcy0+aVN0eWxlID0gJGFTdHlsZTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRDb2x1bW5NYXJnaW4oJGFMZWZ0LCRhUmlnaHQpIHsKICAgICAgICAkdGhpcy0+aUxlZnRDb2xNYXJnaW4gPSAkYUxlZnQ7CiAgICAgICAgJHRoaXMtPmlSaWdodENvbE1hcmdpbiA9ICRhUmlnaHQ7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0Rm9udENvbG9yKCRhRm9udENvbG9yKSB7CiAgICAgICAgJHRoaXMtPmlGb250Q29sb3IgPSAkYUZvbnRDb2xvcjsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRDb2xvcigkYUNvbG9yKSB7CiAgICAgICAgJHRoaXMtPmlDb2xvciA9ICRhQ29sb3I7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0QmFja2dyb3VuZENvbG9yKCRhQ29sb3IpIHsKICAgICAgICAkdGhpcy0+aUJhY2tncm91bmRDb2xvciA9ICRhQ29sb3I7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0Q29sVGl0bGVzKCRhVGl0bGVzLCRhV2lkdGg9bnVsbCkgewogICAgICAgICR0aGlzLT5pVGl0bGVzID0gJGFUaXRsZXM7CiAgICAgICAgJHRoaXMtPmlXaWR0aCA9ICRhV2lkdGg7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0TWluQ29sV2lkdGgoJGFXaWR0aHMpIHsKICAgICAgICAkbiA9IG1pbihjb3VudCgkdGhpcy0+aVRpdGxlcyksY291bnQoJGFXaWR0aHMpKTsKICAgICAgICBmb3IoJGk9MDsgJGkgPCAkbjsgKyskaSApIHsKICAgICAgICAgICAgaWYoICFlbXB0eSgkYVdpZHRoc1skaV0pICkgewogICAgICAgICAgICAgICAgaWYoIGVtcHR5KCR0aGlzLT5pV2lkdGhbJGldKSApIHsKICAgICAgICAgICAgICAgICAgICAkdGhpcy0+aVdpZHRoWyRpXSA9ICRhV2lkdGhzWyRpXTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICR0aGlzLT5pV2lkdGhbJGldID0gbWF4KCR0aGlzLT5pV2lkdGhbJGldLCRhV2lkdGhzWyRpXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gR2V0V2lkdGgoJGFJbWcpIHsKICAgICAgICAkdHh0ID0gbmV3IFRleHRQcm9wZXJ0eSgpOwogICAgICAgICR0eHQtPlNldEZvbnQoJHRoaXMtPmlGRmFtaWx5LCR0aGlzLT5pRlN0eWxlLCR0aGlzLT5pRlNpemUpOwogICAgICAgICRuID0gY291bnQoJHRoaXMtPmlUaXRsZXMpIDsKICAgICAgICAkcm09JHRoaXMtPmlSaWdodENvbE1hcmdpbjsKICAgICAgICAkdyA9IDA7CiAgICAgICAgZm9yKCRoPTAsICRpPTA7ICRpIDwgJG47ICsrJGkgKSB7CiAgICAgICAgICAgICR3ICs9ICR0aGlzLT5pTGVmdENvbE1hcmdpbjsKICAgICAgICAgICAgJHR4dC0+U2V0KCR0aGlzLT5pVGl0bGVzWyRpXSk7CiAgICAgICAgICAgIGlmKCAhZW1wdHkoJHRoaXMtPmlXaWR0aFskaV0pICkgewogICAgICAgICAgICAgICAgJHcxID0gbWF4KCR0eHQtPkdldFdpZHRoKCRhSW1nKSskcm0sJHRoaXMtPmlXaWR0aFskaV0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgJHcxID0gJHR4dC0+R2V0V2lkdGgoJGFJbWcpKyRybTsKICAgICAgICAgICAgfQogICAgICAgICAgICAkdGhpcy0+aVdpZHRoWyRpXSA9ICR3MTsKICAgICAgICAgICAgJHcgKz0gJHcxOwogICAgICAgICAgICAkaCA9IG1heCgkaCwkdHh0LT5HZXRIZWlnaHQoJGFJbWcpKTsKICAgICAgICB9CiAgICAgICAgJHRoaXMtPmlIZWlnaHQgPSAkaCskdGhpcy0+aVRvcEhlYWRlck1hcmdpbjsKICAgICAgICAkdHh0PScnOwogICAgICAgIHJldHVybiAkdzsKICAgIH0KCiAgICBmdW5jdGlvbiBHZXRDb2xTdGFydCgkYUltZywmJGFTdGFydCwkYUFkZExlZnRNYXJnaW49ZmFsc2UpIHsKICAgICAgICAkbiA9IGNvdW50KCR0aGlzLT5pVGl0bGVzKSA7CiAgICAgICAgJGFkaiA9ICRhQWRkTGVmdE1hcmdpbiA\/ICR0aGlzLT5pTGVmdENvbE1hcmdpbiA6IDA7CiAgICAgICAgJGFTdGFydD1hcnJheSgkYUltZy0+bGVmdF9tYXJnaW4rJGFkaik7CiAgICAgICAgZm9yKCAkaT0xOyAkaSA8ICRuOyArKyRpICkgewogICAgICAgICAgICAkYVN0YXJ0WyRpXSA9ICRhU3RhcnRbJGktMV0rJHRoaXMtPmlMZWZ0Q29sTWFyZ2luKyR0aGlzLT5pV2lkdGhbJGktMV07CiAgICAgICAgfQogICAgfQoKICAgIC8vIEFkanVzdCBoZWFkZXJzIGxlZnQsIHJpZ2h0IG9yIGNlbnRlcmVkCiAgICBmdW5jdGlvbiBTZXRIZWFkZXJBbGlnbigkYUFsaWduKSB7CiAgICAgICAgJHRoaXMtPmlIZWFkZXJBbGlnbj0kYUFsaWduOwogICAgfQoKICAgIGZ1bmN0aW9uIFN0cm9rZSgkYUltZywkYVhMZWZ0LCRhWVRvcCwkYVhSaWdodCwkYVlCb3R0b20sJGFVc2VUZXh0SGVpZ2h0PWZhbHNlKSB7CgogICAgICAgIGlmKCAhJHRoaXMtPmlTaG93ICkgcmV0dXJuOwoKICAgICAgICAkdHh0ID0gbmV3IFRleHRQcm9wZXJ0eSgpOwogICAgICAgICR0eHQtPlNldEZvbnQoJHRoaXMtPmlGRmFtaWx5LCR0aGlzLT5pRlN0eWxlLCR0aGlzLT5pRlNpemUpOwogICAgICAgICR0eHQtPlNldENvbG9yKCR0aGlzLT5pRm9udENvbG9yKTsKICAgICAgICAkdHh0LT5TZXRBbGlnbigkdGhpcy0+aUhlYWRlckFsaWduLCd0b3AnKTsKICAgICAgICAkbj1jb3VudCgkdGhpcy0+aVRpdGxlcyk7CgogICAgICAgIGlmKCAkbiA9PSAwICkKICAgICAgICByZXR1cm47CgogICAgICAgICR4ID0gJGFYTGVmdDsKICAgICAgICAkaCA9ICR0aGlzLT5pSGVpZ2h0OwogICAgICAgICR5VG9wID0gJGFVc2VUZXh0SGVpZ2h0ID8gJGFZQm90dG9tLSRoLSR0aGlzLT5pVG9wQ29sTWFyZ2luLSR0aGlzLT5pQm90dG9tQ29sTWFyZ2luIDogJGFZVG9wIDsKCiAgICAgICAgaWYoICRoIDwgMCApIHsKICAgICAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoNjAwMSk7CiAgICAgICAgICAgIC8vKCdJbnRlcm5hbCBlcnJvci4gSGVpZ2h0IGZvciBBY3Rpdml0eVRpdGxlcyBpcyA8IDAnKTsKICAgICAgICB9CgogICAgICAgICRhSW1nLT5TZXRMaW5lV2VpZ2h0KDEpOwogICAgICAgIC8vIFNldCBiYWNrZ3JvdW5kIGNvbG9yCiAgICAgICAgJGFJbWctPlNldENvbG9yKCR0aGlzLT5pQmFja2dyb3VuZENvbG9yKTsKICAgICAgICAkYUltZy0+RmlsbGVkUmVjdGFuZ2xlKCRhWExlZnQsJHlUb3AsJGFYUmlnaHQsJGFZQm90dG9tLTEpOwoKICAgICAgICBpZiggJHRoaXMtPmlTdHlsZSA9PSAxICkgewogICAgICAgICAgICAvLyBNYWtlIGEgM0QgZWZmZWN0CiAgICAgICAgICAgICRhSW1nLT5TZXRDb2xvcignd2hpdGUnKTsKICAgICAgICAgICAgJGFJbWctPkxpbmUoJGFYTGVmdCwkeVRvcCsxLCRhWFJpZ2h0LCR5VG9wKzEpOwogICAgICAgIH0KCiAgICAgICAgZm9yKCRpPTA7ICRpIDwgJG47ICsrJGkgKSB7CiAgICAgICAgICAgIGlmKCAkdGhpcy0+aVN0eWxlID09IDEgKSB7CiAgICAgICAgICAgICAgICAvLyBNYWtlIGEgM0QgZWZmZWN0CiAgICAgICAgICAgICAgICAkYUltZy0+U2V0Q29sb3IoJ3doaXRlJyk7CiAgICAgICAgICAgICAgICAkYUltZy0+TGluZSgkeCsxLCR5VG9wLCR4KzEsJGFZQm90dG9tKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAkeCArPSAkdGhpcy0+aUxlZnRDb2xNYXJnaW47CiAgICAgICAgICAgICR0eHQtPlNldCgkdGhpcy0+aVRpdGxlc1skaV0pOwoKICAgICAgICAgICAgLy8gQWRqdXN0IHRoZSB0ZXh0IGFuY2hvciBwb3NpdGlvbiBhY2NvcmRpbmcgdG8gdGhlIGNob29zZW4gYWxpZ25tZW50CiAgICAgICAgICAgICR4cCA9ICR4OwogICAgICAgICAgICBpZiggJHRoaXMtPmlIZWFkZXJBbGlnbiA9PSAnY2VudGVyJyApIHsKICAgICAgICAgICAgICAgICR4cCA9ICgoJHgtJHRoaXMtPmlMZWZ0Q29sTWFyZ2luKSsoJHgrJHRoaXMtPmlXaWR0aFskaV0pKS8yOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2VpZiggJHRoaXMtPmlIZWFkZXJBbGlnbiA9PSAncmlnaHQnICkgewogICAgICAgICAgICAgICAgJHhwID0gJHggKyR0aGlzLT5pV2lkdGhbJGldLSR0aGlzLT5pUmlnaHRDb2xNYXJnaW47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICR0eHQtPlN0cm9rZSgkYUltZywkeHAsJHlUb3ArJHRoaXMtPmlUb3BIZWFkZXJNYXJnaW4pOwogICAgICAgICAgICAkeCArPSAkdGhpcy0+aVdpZHRoWyRpXTsKICAgICAgICAgICAgaWYoICRpIDwgJG4tMSApIHsKICAgICAgICAgICAgICAgICRhSW1nLT5TZXRDb2xvcigkdGhpcy0+aUNvbG9yKTsKICAgICAgICAgICAgICAgICRhSW1nLT5MaW5lKCR4LCR5VG9wLCR4LCRhWUJvdHRvbSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICRhSW1nLT5TZXRDb2xvcigkdGhpcy0+aUNvbG9yKTsKICAgICAgICAkYUltZy0+TGluZSgkYVhMZWZ0LCR5VG9wLCAkYVhSaWdodCwkeVRvcCk7CgogICAgICAgIC8vIFN0cm9rZSB2ZXJ0aWNhbCBjb2x1bW4gZGl2aWRlcnMKICAgICAgICAkY29scz1hcnJheSgpOwogICAgICAgICR0aGlzLT5HZXRDb2xTdGFydCgkYUltZywkY29scyk7CiAgICAgICAgJG49Y291bnQoJGNvbHMpOwogICAgICAgIGZvciggJGk9MTsgJGkgPCAkbjsgKyskaSApIHsKICAgICAgICAgICAgJHRoaXMtPnZncmlkLT5TdHJva2UoJGFJbWcsJGNvbHNbJGldLCRhWUJvdHRvbSwkY29sc1skaV0sCiAgICAgICAgICAgICRhSW1nLT5oZWlnaHQgLSAkYUltZy0+Ym90dG9tX21hcmdpbik7CiAgICAgICAgfQogICAgfQp9CgoKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gQ0xBU1MgR2FudHRHcmFwaAovLyBEZXNjcmlwdGlvbjogTWFpbiBjbGFzcyB0byBoYW5kbGUgZ2FudHQgZ3JhcGhzCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmNsYXNzIEdhbnR0R3JhcGggZXh0ZW5kcyBHcmFwaCB7CiAgICBwdWJsaWMgJHNjYWxlOyAgLy8gUHVibGljIGFjY2Vzc2libGUKICAgIHB1YmxpYyAkaGdyaWQ9bnVsbDsKICAgIHByaXZhdGUgJGlPYmo9YXJyYXkoKTsgICAgLy8gR2FudHQgb2JqZWN0cwogICAgcHJpdmF0ZSAkaUxhYmVsSE1hcmdpbkZhY3Rvcj0wLjI7IC8vIDEwJSBtYXJnaW4gb24gZWFjaCBzaWRlIG9mIHRoZSBsYWJlbHMKICAgIHByaXZhdGUgJGlMYWJlbFZNYXJnaW5GYWN0b3I9MC40OyAvLyA0MCUgbWFyZ2luIG9uIHRvcCBhbmQgYm90dG9tIG9mIGxhYmVsCiAgICBwcml2YXRlICRpTGF5b3V0PUdBTlRUX0ZST01UT1A7IC8vIENvdWxkIGFsc28gYmUgR0FOVFRfRVZFTgogICAgcHJpdmF0ZSAkaVNpbXBsZUZvbnQgPSBGRl9GT05UMSwkaVNpbXBsZUZvbnRTaXplPTExOwogICAgcHJpdmF0ZSAkaVNpbXBsZVN0eWxlPUdBTlRUX1JESUFHLCRpU2ltcGxlQ29sb3I9J3llbGxvdycsJGlTaW1wbGVCa2dDb2xvcj0ncmVkJzsKICAgIHByaXZhdGUgJGlTaW1wbGVQcm9ncmVzc0JrZ0NvbG9yPSdncmF5JywkaVNpbXBsZVByb2dyZXNzQ29sb3I9J2RhcmtncmVlbic7CiAgICBwcml2YXRlICRpU2ltcGxlUHJvZ3Jlc3NTdHlsZT1HQU5UVF9TT0xJRDsKICAgIHByaXZhdGUgJGlab29tRmFjdG9yID0gMS4wOwogICAgLy8tLS0tLS0tLS0tLS0tLS0KICAgIC8vIENPTlNUUlVDVE9SCiAgICAvLyBDcmVhdGUgYSBuZXcgZ2FudHQgZ3JhcGgKICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRhV2lkdGg9MCwkYUhlaWdodD0wLCRhQ2FjaGVkTmFtZT0iIiwkYVRpbWVPdXQ9MCwkYUlubGluZT10cnVlKSB7CgogICAgICAgIC8vIEJhY2t3YXJkIGNvbXBhdGliaWxpdHkKICAgICAgICBpZiggJGFXaWR0aCA9PSAtMSApICRhV2lkdGg9MDsKICAgICAgICBpZiggJGFIZWlnaHQgPT0gLTEgKSAkYUhlaWdodD0wOwoKICAgICAgICBpZiggJGFXaWR0aDwgIDAgfHwgJGFIZWlnaHQgPCAwICkgewogICAgICAgICAgICBKcGdyYXBoRXJyb3I6OlJhaXNlTCg2MDAyKTsKICAgICAgICAgICAgLy8oIllvdSBjYW4ndCBzcGVjaWZ5IG5lZ2F0aXZlIHNpemVzIGZvciBHYW50dCBncmFwaCBkaW1lbnNpb25zLiBVc2UgMCB0byBpbmRpY2F0ZSB0aGF0IHlvdSB3YW50IHRoZSBsaWJyYXJ5IHRvIGF1dG9tYXRpY2FsbHkgZGV0ZXJtaW5lIGEgZGltZW5zaW9uLiIpOwogICAgICAgIH0KICAgICAgICBwYXJlbnQ6Ol9fY29uc3RydWN0KCRhV2lkdGgsJGFIZWlnaHQsJGFDYWNoZWROYW1lLCRhVGltZU91dCwkYUlubGluZSk7CiAgICAgICAgJHRoaXMtPnNjYWxlID0gbmV3IEdhbnR0U2NhbGUoJHRoaXMtPmltZyk7CgogICAgICAgIC8vIERlZmF1bHQgbWFyZ2lucwogICAgICAgICR0aGlzLT5pbWctPlNldE1hcmdpbigxNSwxNywyNSwxNSk7CgogICAgICAgICR0aGlzLT5oZ3JpZCA9IG5ldyBIb3Jpem9udGFsR3JpZExpbmUoKTsKCiAgICAgICAgJHRoaXMtPnNjYWxlLT5TaG93SGVhZGVycyhHQU5UVF9IV0VFS3xHQU5UVF9IREFZKTsKICAgICAgICAkdGhpcy0+U2V0Qm94KCk7CiAgICB9CgogICAgLy8tLS0tLS0tLS0tLS0tLS0KICAgIC8vIFBVQkxJQyBNRVRIT0RTCgogICAgLy8KCiAgICBmdW5jdGlvbiBTZXRTaW1wbGVGb250KCRhRm9udCwkYVNpemUpIHsKICAgICAgICAkdGhpcy0+aVNpbXBsZUZvbnQgPSAkYUZvbnQ7CiAgICAgICAgJHRoaXMtPmlTaW1wbGVGb250U2l6ZSA9ICRhU2l6ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRTaW1wbGVTdHlsZSgkYUJhbmQsJGFDb2xvciwkYUJrZ0NvbG9yKSB7CiAgICAgICAgJHRoaXMtPmlTaW1wbGVTdHlsZSA9ICRhQmFuZDsKICAgICAgICAkdGhpcy0+aVNpbXBsZUNvbG9yID0gJGFDb2xvcjsKICAgICAgICAkdGhpcy0+aVNpbXBsZUJrZ0NvbG9yID0gJGFCa2dDb2xvcjsKICAgIH0KCiAgICAvLyBBIHV0aWxpdHkgZnVuY3Rpb24gdG8gaGVscCBjcmVhdGUgYmFzaWMgR2FudHQgY2hhcnRzCiAgICBmdW5jdGlvbiBDcmVhdGVTaW1wbGUoJGRhdGEsJGNvbnN0cmFpbnM9YXJyYXkoKSwkcHJvZ3Jlc3M9YXJyYXkoKSkgewogICAgICAgICRudW0gPSBjb3VudCgkZGF0YSk7CiAgICAgICAgZm9yKCAkaT0wOyAkaSA8ICRudW07ICsrJGkpIHsKICAgICAgICAgICAgc3dpdGNoKCAkZGF0YVskaV1bMV0gKSB7CiAgICAgICAgICAgICAgICBjYXNlIEFDVFlQRV9HUk9VUDoKICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgYSBzbGlnaHRseSBzbWFsbGVyIGhlaWdodCBiYXIgc2luY2UgdGhlCiAgICAgICAgICAgICAgICAgICAgLy8gIndpbmdzIiBhdCB0aGUgZW5kIHdpbGwgbWFrZSBpdCBsb29rIHRhbGxlcgogICAgICAgICAgICAgICAgICAgICRhID0gbmV3IEdhbnR0QmFyKCRkYXRhWyRpXVswXSwkZGF0YVskaV1bMl0sJGRhdGFbJGldWzNdLCRkYXRhWyRpXVs0XSwnJyw4KTsKICAgICAgICAgICAgICAgICAgICAkYS0+dGl0bGUtPlNldEZvbnQoJHRoaXMtPmlTaW1wbGVGb250LEZTX0JPTEQsJHRoaXMtPmlTaW1wbGVGb250U2l6ZSk7CiAgICAgICAgICAgICAgICAgICAgJGEtPnJpZ2h0TWFyay0+U2hvdygpOwogICAgICAgICAgICAgICAgICAgICRhLT5yaWdodE1hcmstPlNldFR5cGUoTUFSS19SSUdIVFRSSUFOR0xFKTsKICAgICAgICAgICAgICAgICAgICAkYS0+cmlnaHRNYXJrLT5TZXRXaWR0aCg4KTsKICAgICAgICAgICAgICAgICAgICAkYS0+cmlnaHRNYXJrLT5TZXRDb2xvcignYmxhY2snKTsKICAgICAgICAgICAgICAgICAgICAkYS0+cmlnaHRNYXJrLT5TZXRGaWxsQ29sb3IoJ2JsYWNrJyk7CgogICAgICAgICAgICAgICAgICAgICRhLT5sZWZ0TWFyay0+U2hvdygpOwogICAgICAgICAgICAgICAgICAgICRhLT5sZWZ0TWFyay0+U2V0VHlwZShNQVJLX0xFRlRUUklBTkdMRSk7CiAgICAgICAgICAgICAgICAgICAgJGEtPmxlZnRNYXJrLT5TZXRXaWR0aCg4KTsKICAgICAgICAgICAgICAgICAgICAkYS0+bGVmdE1hcmstPlNldENvbG9yKCdibGFjaycpOwogICAgICAgICAgICAgICAgICAgICRhLT5sZWZ0TWFyay0+U2V0RmlsbENvbG9yKCdibGFjaycpOwoKICAgICAgICAgICAgICAgICAgICAkYS0+U2V0UGF0dGVybihCQU5EX1NPTElELCdibGFjaycpOwogICAgICAgICAgICAgICAgICAgICRjc2ltcG9zID0gNjsKICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICBjYXNlIEFDVFlQRV9OT1JNQUw6CiAgICAgICAgICAgICAgICAgICAgJGEgPSBuZXcgR2FudHRCYXIoJGRhdGFbJGldWzBdLCRkYXRhWyRpXVsyXSwkZGF0YVskaV1bM10sJGRhdGFbJGldWzRdLCcnLDEwKTsKICAgICAgICAgICAgICAgICAgICAkYS0+dGl0bGUtPlNldEZvbnQoJHRoaXMtPmlTaW1wbGVGb250LEZTX05PUk1BTCwkdGhpcy0+aVNpbXBsZUZvbnRTaXplKTsKICAgICAgICAgICAgICAgICAgICAkYS0+U2V0UGF0dGVybigkdGhpcy0+aVNpbXBsZVN0eWxlLCR0aGlzLT5pU2ltcGxlQ29sb3IpOwogICAgICAgICAgICAgICAgICAgICRhLT5TZXRGaWxsQ29sb3IoJHRoaXMtPmlTaW1wbGVCa2dDb2xvcik7CiAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBhY3Rpdml0eSBzaG91bGQgaGF2ZSBhIGNvbnN0cmFpbiBsaW5lCiAgICAgICAgICAgICAgICAgICAgJG4gPSBjb3VudCgkY29uc3RyYWlucyk7CiAgICAgICAgICAgICAgICAgICAgZm9yKCAkaj0wOyAkaiA8ICRuOyArKyRqICkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiggZW1wdHkoJGNvbnN0cmFpbnNbJGpdKSB8fCAoY291bnQoJGNvbnN0cmFpbnNbJGpdKSAhPSAzKSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDYwMDMsJGopOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8oIkludmFsaWQgZm9ybWF0IGZvciBDb25zdHJhaW4gcGFyYW1ldGVyIGF0IGluZGV4PSRqIGluIENyZWF0ZVNpbXBsZSgpLiBQYXJhbWV0ZXIgbXVzdCBzdGFydCB3aXRoIGluZGV4IDAgYW5kIGNvbnRhaW4gYXJyYXlzIG9mIChSb3csQ29uc3RyYWluLVRvLENvbnN0cmFpbi1UeXBlKSIpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAkY29uc3RyYWluc1skal1bMF09PSRkYXRhWyRpXVswXSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhLT5TZXRDb25zdHJhaW4oJGNvbnN0cmFpbnNbJGpdWzFdLCRjb25zdHJhaW5zWyRqXVsyXSwnYmxhY2snLEFSUk9XX1MyLEFSUk9XVF9TT0xJRCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIC8vIENoZWNrIGlmIHRoaXMgYWN0aXZpdHkgaGF2ZSBhIHByb2dyZXNzIGJhcgogICAgICAgICAgICAgICAgICAgICRuID0gY291bnQoJHByb2dyZXNzKTsKICAgICAgICAgICAgICAgICAgICBmb3IoICRqPTA7ICRqIDwgJG47ICsrJGogKSB7CgogICAgICAgICAgICAgICAgICAgICAgICBpZiggZW1wdHkoJHByb2dyZXNzWyRqXSkgfHwgKGNvdW50KCRwcm9ncmVzc1skal0pICE9IDIpICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoNjAwNCwkaik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLygiSW52YWxpZCBmb3JtYXQgZm9yIFByb2dyZXNzIHBhcmFtZXRlciBhdCBpbmRleD0kaiBpbiBDcmVhdGVTaW1wbGUoKS4gUGFyYW1ldGVyIG11c3Qgc3RhcnQgd2l0aCBpbmRleCAwIGFuZCBjb250YWluIGFycmF5cyBvZiAoUm93LFByb2dyZXNzKSIpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAkcHJvZ3Jlc3NbJGpdWzBdPT0kZGF0YVskaV1bMF0gKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYS0+cHJvZ3Jlc3MtPlNldCgkcHJvZ3Jlc3NbJGpdWzFdKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhLT5wcm9ncmVzcy0+U2V0UGF0dGVybigkdGhpcy0+aVNpbXBsZVByb2dyZXNzU3R5bGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+aVNpbXBsZVByb2dyZXNzQ29sb3IpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGEtPnByb2dyZXNzLT5TZXRGaWxsQ29sb3IoJHRoaXMtPmlTaW1wbGVQcm9ncmVzc0JrZ0NvbG9yKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vJGEtPnByb2dyZXNzLT5TZXRQYXR0ZXJuKCRwcm9ncmVzc1skal1bMl0sJHByb2dyZXNzWyRqXVszXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAkY3NpbXBvcyA9IDY7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgY2FzZSBBQ1RZUEVfTUlMRVNUT05FOgogICAgICAgICAgICAgICAgICAgICRhID0gbmV3IE1pbGVTdG9uZSgkZGF0YVskaV1bMF0sJGRhdGFbJGldWzJdLCRkYXRhWyRpXVszXSk7CiAgICAgICAgICAgICAgICAgICAgJGEtPnRpdGxlLT5TZXRGb250KCR0aGlzLT5pU2ltcGxlRm9udCxGU19OT1JNQUwsJHRoaXMtPmlTaW1wbGVGb250U2l6ZSk7CiAgICAgICAgICAgICAgICAgICAgJGEtPmNhcHRpb24tPlNldEZvbnQoJHRoaXMtPmlTaW1wbGVGb250LEZTX05PUk1BTCwkdGhpcy0+aVNpbXBsZUZvbnRTaXplKTsKICAgICAgICAgICAgICAgICAgICAkY3NpbXBvcyA9IDU7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgIGRpZSgnVW5rbm93biBhY3Rpdml0eSB0eXBlJyk7CiAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFNldHVwIGNhcHRpb24KICAgICAgICAgICAgJGEtPmNhcHRpb24tPlNldCgkZGF0YVskaV1bJGNzaW1wb3MtMV0pOwoKICAgICAgICAgICAgLy8gQ2hlY2sgaWYgdGhpcyBhY3Rpdml0eSBzaG91bGQgaGF2ZSBhIENTSU0gdGFyZ2V077+9PwogICAgICAgICAgICBpZiggIWVtcHR5KCRkYXRhWyRpXVskY3NpbXBvc10pICkgewogICAgICAgICAgICAgICAgJGEtPlNldENTSU1UYXJnZXQoJGRhdGFbJGldWyRjc2ltcG9zXSk7CiAgICAgICAgICAgICAgICAkYS0+U2V0Q1NJTUFsdCgkZGF0YVskaV1bJGNzaW1wb3MrMV0pOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKCAhZW1wdHkoJGRhdGFbJGldWyRjc2ltcG9zKzJdKSApIHsKICAgICAgICAgICAgICAgICRhLT50aXRsZS0+U2V0Q1NJTVRhcmdldCgkZGF0YVskaV1bJGNzaW1wb3MrMl0pOwogICAgICAgICAgICAgICAgJGEtPnRpdGxlLT5TZXRDU0lNQWx0KCRkYXRhWyRpXVskY3NpbXBvcyszXSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICR0aGlzLT5BZGQoJGEpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBTZXQgdXNlciBzcGVjaWZpZWQgc2NhbGUgem9vbSBmYWN0b3Igd2hlbiBhdXRvIHNpemluZyBpcyB1c2VkCiAgICBmdW5jdGlvbiBTZXRab29tRmFjdG9yKCRhWm9vbSkgewogICAgCSR0aGlzLT5pWm9vbUZhY3RvciA9ICRhWm9vbTsKICAgIH0KCgogICAgLy8gU2V0IHdoYXQgaGVhZGVycyBzaG91bGQgYmUgc2hvd24KICAgIGZ1bmN0aW9uIFNob3dIZWFkZXJzKCRhRmxnKSB7CiAgICAgICAgJHRoaXMtPnNjYWxlLT5TaG93SGVhZGVycygkYUZsZyk7CiAgICB9CgogICAgLy8gU3BlY2lmeSB0aGUgZnJhY3Rpb24gb2YgdGhlIGZvbnQgaGVpZ2h0IHRoYXQgc2hvdWxkIGJlIGFkZGVkCiAgICAvLyBhcyB2ZXJ0aWNhbCBtYXJnaW4KICAgIGZ1bmN0aW9uIFNldExhYmVsVk1hcmdpbkZhY3RvcigkYVZhbCkgewogICAgICAgICR0aGlzLT5pTGFiZWxWTWFyZ2luRmFjdG9yID0gJGFWYWw7CiAgICB9CgogICAgLy8gU3lub255bSB0byB0aGUgbWV0aG9kIGFib3ZlCiAgICBmdW5jdGlvbiBTZXRWTWFyZ2luRmFjdG9yKCRhVmFsKSB7CiAgICAgICAgJHRoaXMtPmlMYWJlbFZNYXJnaW5GYWN0b3IgPSAkYVZhbDsKICAgIH0KCgogICAgLy8gQWRkIGEgbmV3IEdhbnR0IG9iamVjdAogICAgZnVuY3Rpb24gQWRkKCRhT2JqZWN0KSB7CiAgICAgICAgaWYoIGlzX2FycmF5KCRhT2JqZWN0KSAmJiBjb3VudCgkYU9iamVjdCkgPiAwICkgewogICAgICAgICAgICAkY2wgPSAkYU9iamVjdFswXTsKICAgICAgICAgICAgaWYoIGNsYXNzX2V4aXN0cygnSWNvblBsb3QnLGZhbHNlKSAmJiAoJGNsIGluc3RhbmNlb2YgSWNvblBsb3QpICkgewogICAgICAgICAgICAgICAgJHRoaXMtPkFkZEljb24oJGFPYmplY3QpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2VpZiggY2xhc3NfZXhpc3RzKCdUZXh0JyxmYWxzZSkgJiYgKCRjbCBpbnN0YW5jZW9mIFRleHQpICkgewogICAgICAgICAgICAJJHRoaXMtPkFkZFRleHQoJGFPYmplY3QpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgJG4gPSBjb3VudCgkYU9iamVjdCk7CiAgICAgICAgICAgICAgICBmb3IoJGk9MDsgJGkgPCAkbjsgKyskaSkKICAgICAgICAgICAgICAgICR0aGlzLT5pT2JqW10gPSAkYU9iamVjdFskaV07CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIGlmKCBjbGFzc19leGlzdHMoJ0ljb25QbG90JyxmYWxzZSkgJiYgKCRhT2JqZWN0IGluc3RhbmNlb2YgSWNvblBsb3QpICkgewogICAgICAgICAgICAgICAgJHRoaXMtPkFkZEljb24oJGFPYmplY3QpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2VpZiggY2xhc3NfZXhpc3RzKCdUZXh0JyxmYWxzZSkgJiYgKCRhT2JqZWN0IGluc3RhbmNlb2YgVGV4dCkgKSB7CiAgICAgICAgICAgIAkkdGhpcy0+QWRkVGV4dCgkYU9iamVjdCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAkdGhpcy0+aU9ialtdID0gJGFPYmplY3Q7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgoJZnVuY3Rpb24gU3Ryb2tlVGV4dHMoKSB7CiAgICAgICAgLy8gU3Ryb2tlIGFueSB1c2VyIGFkZGVkIHRleHQgb2JqZWN0cwogICAgICAgIGlmKCAkdGhpcy0+dGV4dHMgIT0gbnVsbCApIHsKICAgICAgICAJJG4gPSBjb3VudCgkdGhpcy0+dGV4dHMpOwogICAgICAgICAgICBmb3IoJGk9MDsgJGkgPCAkbjsgKyskaSkgewogICAgICAgICAgICAJaWYoICR0aGlzLT50ZXh0c1skaV0tPmlTY2FsZVBvc1ggIT09IG51bGwgJiYgJHRoaXMtPnRleHRzWyRpXS0+aVNjYWxlUG9zWSAhPT0gbnVsbCApIHsKICAgICAgICAgICAgCQkkeCA9ICR0aGlzLT5zY2FsZS0+VHJhbnNsYXRlRGF0ZSgkdGhpcy0+dGV4dHNbJGldLT5pU2NhbGVQb3NYKTsKICAgICAgICAgICAgCQkkeSA9ICR0aGlzLT5zY2FsZS0+VHJhbnNsYXRlVmVydFBvcygkdGhpcy0+dGV4dHNbJGldLT5pU2NhbGVQb3NZKTsKICAgICAgICAgICAgCQkkeSAtPSAkdGhpcy0+c2NhbGUtPkdldFZlcnRTcGFjaW5nKCkvMjsKICAgICAgICAgICAgCX0KICAgICAgICAgICAgCWVsc2UgewogICAgICAgICAgICAJCSR4ID0gJHkgPSBudWxsOwogICAgICAgICAgICAJfQogICAgICAgICAgICAgICAgJHRoaXMtPnRleHRzWyRpXS0+U3Ryb2tlKCR0aGlzLT5pbWcsJHgsJHkpOwogICAgICAgICAgICB9CiAgICAgICAgfQoJfQoKICAgIC8vIE92ZXJyaWRlIGluaGVyaXQgbWV0aG9kIGZyb20gR3JhcGggYW5kIGdpdmUgYSB3YXJuaW5nIG1lc3NhZ2UKICAgIGZ1bmN0aW9uIFNldFNjYWxlKCRhQXhpc1R5cGUsJGFZTWluPTEsJGFZTWF4PTEsJGFYTWluPTEsJGFYTWF4PTEpIHsKICAgICAgICBKcEdyYXBoRXJyb3I6OlJhaXNlTCg2MDA1KTsKICAgICAgICAvLygiU2V0U2NhbGUoKSBpcyBub3QgbWVhbmluZ2Z1bGwgd2l0aCBHYW50dCBjaGFydHMuIik7CiAgICB9CgogICAgLy8gU3BlY2lmeSB0aGUgZGF0ZSByYW5nZSBmb3IgR2FudHQgZ3JhcGhzIChpZiB0aGlzIGlzIG5vdCBzZXQgaXQgd2lsbCBiZQogICAgLy8gYXV0b210aWNhbGx5IGRldGVybWluZWQgZnJvbSB0aGUgaW5wdXQgZGF0YSkKICAgIGZ1bmN0aW9uIFNldERhdGVSYW5nZSgkYVN0YXJ0LCRhRW5kKSB7CiAgICAgICAgLy8gQWRqdXN0IHRoZSBzdGFydCBhbmQgZW5kIHNvIHRoYXQgdGhlIGluZGljYXRlIHRoZQogICAgICAgIC8vIGJlZ2luaW5nIGFuZCBlbmQgb2YgcmVzcGVjdGl2ZSBzdGFydCBhbmQgZW5kIGRheXMKICAgICAgICBpZiggc3RycG9zKCRhU3RhcnQsJzonKSA9PT0gZmFsc2UgKQogICAgICAgICRhU3RhcnQgPSBkYXRlKCdZLW0tZCAwMDowMCcsc3RydG90aW1lKCRhU3RhcnQpKTsKICAgICAgICBpZiggc3RycG9zKCRhRW5kLCc6JykgPT09IGZhbHNlICkKICAgICAgICAkYUVuZCA9IGRhdGUoJ1ktbS1kIDIzOjU5JyxzdHJ0b3RpbWUoJGFFbmQpKTsKICAgICAgICAkdGhpcy0+c2NhbGUtPlNldFJhbmdlKCRhU3RhcnQsJGFFbmQpOwogICAgfQoKICAgIC8vIEdldCB0aGUgbWF4aW11bSB3aWR0aCBvZiB0aGUgYWN0aXZpdHkgdGl0bGVzIGNvbHVtbnMgZm9yIHRoZSBiYXJzCiAgICAvLyBUaGUgbmFtZSBpcyBsaWdodGx5IG1pc2xlYWRpbmcgc2luY2Ugd2UgZnJvbSBub3cgb24gY2FuIGhhdmUKICAgIC8vIG11bHRpcGxlIGNvbHVtbnMgaW4gdGhlIGxhYmVsIHNlY3Rpb24uIFdoZW4gdGhpcyB3YXMgZmlyc3Qgd3JpdHRlbgogICAgLy8gaXQgb25seSBzdXBwb3J0ZWQgYSBzaW5nbGUgbGFiZWwsIGhlbmNlIHRoZSBuYW1lLgogICAgZnVuY3Rpb24gR2V0TWF4TGFiZWxXaWR0aCgpIHsKICAgICAgICAkbT0xMDsKICAgICAgICBpZiggJHRoaXMtPmlPYmogIT0gbnVsbCApIHsKICAgICAgICAgICAgJG1hcmcgPSAkdGhpcy0+c2NhbGUtPmFjdGluZm8tPmlMZWZ0Q29sTWFyZ2luKyR0aGlzLT5zY2FsZS0+YWN0aW5mby0+aVJpZ2h0Q29sTWFyZ2luOwogICAgICAgICAgICAkbiA9IGNvdW50KCR0aGlzLT5pT2JqKTsKICAgICAgICAgICAgZm9yKCRpPTA7ICRpIDwgJG47ICsrJGkpIHsKICAgICAgICAgICAgICAgIGlmKCAhZW1wdHkoJHRoaXMtPmlPYmpbJGldLT50aXRsZSkgKSB7CiAgICAgICAgICAgICAgICAgICAgaWYoICR0aGlzLT5pT2JqWyRpXS0+dGl0bGUtPkhhc1RhYnMoKSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgbGlzdCgkdG90LCR3KSA9ICR0aGlzLT5pT2JqWyRpXS0+dGl0bGUtPkdldFdpZHRoKCR0aGlzLT5pbWcsdHJ1ZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICRtPW1heCgkbSwkdG90KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICRtPW1heCgkbSwkdGhpcy0+aU9ialskaV0tPnRpdGxlLT5HZXRXaWR0aCgkdGhpcy0+aW1nKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuICRtOwogICAgfQoKICAgIC8vIEdldCB0aGUgbWF4aW11bSBoZWlnaHQgb2YgdGhlIHRpdGxlcyBmb3IgdGhlIGJhcnMKICAgIGZ1bmN0aW9uIEdldE1heExhYmVsSGVpZ2h0KCkgewogICAgICAgICRtPTEwOwogICAgICAgIGlmKCAkdGhpcy0+aU9iaiAhPSBudWxsICkgewogICAgICAgICAgICAkbiA9IGNvdW50KCR0aGlzLT5pT2JqKTsKICAgICAgICAgICAgLy8gV2UgY2FuIG5vdCBpbmNsdWRlIHRoZSB0aXRsZSBvZiBHbnR0VkxpbmUgc2luY2UgdGhhdCB0aXRsZSBpcyBzdHJva2VkIGF0IHRoZSBib3R0b20KICAgICAgICAgICAgLy8gb2YgdGhlIEdhbnR0IGJhciBhbmQgbm90IGluIHRoZSBhY3Rpdml0eSB0aXRsZSBjb2x1bW5zCiAgICAgICAgICAgIGZvcigkaT0wOyAkaSA8ICRuOyArKyRpKSB7CiAgICAgICAgICAgICAgICBpZiggIWVtcHR5KCR0aGlzLT5pT2JqWyRpXS0+dGl0bGUpICYmICEoJHRoaXMtPmlPYmpbJGldIGluc3RhbmNlb2YgR2FudHRWTGluZSkgKSB7CiAgICAgICAgICAgICAgICAgICAgJG09bWF4KCRtLCR0aGlzLT5pT2JqWyRpXS0+dGl0bGUtPkdldEhlaWdodCgkdGhpcy0+aW1nKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuICRtOwogICAgfQoKICAgIGZ1bmN0aW9uIEdldE1heEJhckFic0hlaWdodCgpIHsKICAgICAgICAkbT0wOwogICAgICAgIGlmKCAkdGhpcy0+aU9iaiAhPSBudWxsICkgewogICAgICAgICAgICAkbSA9ICR0aGlzLT5pT2JqWzBdLT5HZXRBYnNIZWlnaHQoJHRoaXMtPmltZyk7CiAgICAgICAgICAgICRuID0gY291bnQoJHRoaXMtPmlPYmopOwogICAgICAgICAgICBmb3IoJGk9MTsgJGkgPCAkbjsgKyskaSkgewogICAgICAgICAgICAgICAgJG09bWF4KCRtLCR0aGlzLT5pT2JqWyRpXS0+R2V0QWJzSGVpZ2h0KCR0aGlzLT5pbWcpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gJG07CiAgICB9CgogICAgLy8gR2V0IHRoZSBtYXhpbXVtIHVzZWQgbGluZSBudW1iZXIgKHZlcnRpY2FsIHBvc2l0aW9uKSBmb3IgYmFycwogICAgZnVuY3Rpb24gR2V0QmFyTWF4TGluZU51bWJlcigpIHsKICAgICAgICAkbT0xOwogICAgICAgIGlmKCAkdGhpcy0+aU9iaiAhPSBudWxsICkgewogICAgICAgICAgICAkbSA9ICR0aGlzLT5pT2JqWzBdLT5HZXRMaW5lTmJyKCk7CiAgICAgICAgICAgICRuID0gY291bnQoJHRoaXMtPmlPYmopOwogICAgICAgICAgICBmb3IoJGk9MTsgJGkgPCAkbjsgKyskaSkgewogICAgICAgICAgICAgICAgJG09bWF4KCRtLCR0aGlzLT5pT2JqWyRpXS0+R2V0TGluZU5icigpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gJG07CiAgICB9CgogICAgLy8gR2V0IHRoZSBtaW51bXVtIGFuZCBtYXhpbXVtIHVzZWQgZGF0ZXMgZm9yIGFsbCBiYXJzCiAgICBmdW5jdGlvbiBHZXRCYXJNaW5NYXgoKSB7CiAgICAgICAgJHN0YXJ0ID0gMCA7CiAgICAgICAgJG4gPSBjb3VudCgkdGhpcy0+aU9iaik7CiAgICAgICAgd2hpbGUoICRzdGFydCA8ICRuICYmICR0aGlzLT5pT2JqWyRzdGFydF0tPkdldE1heERhdGUoKSA9PT0gZmFsc2UgKQogICAgICAgICsrJHN0YXJ0OwogICAgICAgIGlmKCAkc3RhcnQgPj0gJG4gKSB7CiAgICAgICAgICAgIEpwZ3JhcGhFcnJvcjo6UmFpc2VMKDYwMDYpOwogICAgICAgICAgICAvLygnQ2Fubm90IGF1dG9zY2FsZSBHYW50dCBjaGFydC4gTm8gZGF0ZWQgYWN0aXZpdGllcyBleGlzdC4gW0dldEJhck1pbk1heCgpIHN0YXJ0ID49IG5dJyk7CiAgICAgICAgfQoKICAgICAgICAkbWF4PSR0aGlzLT5zY2FsZS0+Tm9ybWFsaXplRGF0ZSgkdGhpcy0+aU9ialskc3RhcnRdLT5HZXRNYXhEYXRlKCkpOwogICAgICAgICRtaW49JHRoaXMtPnNjYWxlLT5Ob3JtYWxpemVEYXRlKCR0aGlzLT5pT2JqWyRzdGFydF0tPkdldE1pbkRhdGUoKSk7CgogICAgICAgIGZvcigkaT0kc3RhcnQrMTsgJGkgPCAkbjsgKyskaSkgewogICAgICAgICAgICAkcm1heCA9ICR0aGlzLT5zY2FsZS0+Tm9ybWFsaXplRGF0ZSgkdGhpcy0+aU9ialskaV0tPkdldE1heERhdGUoKSk7CiAgICAgICAgICAgIGlmKCAkcm1heCAhPSBmYWxzZSApCiAgICAgICAgICAgICRtYXg9TWF4KCRtYXgsJHJtYXgpOwogICAgICAgICAgICAkcm1pbiA9ICR0aGlzLT5zY2FsZS0+Tm9ybWFsaXplRGF0ZSgkdGhpcy0+aU9ialskaV0tPkdldE1pbkRhdGUoKSk7CiAgICAgICAgICAgIGlmKCAkcm1pbiAhPSBmYWxzZSApCiAgICAgICAgICAgICRtaW49TWluKCRtaW4sJHJtaW4pOwogICAgICAgIH0KICAgICAgICAkbWluRGF0ZSA9IGRhdGUoIlktbS1kIiwkbWluKTsKICAgICAgICAkbWluID0gc3RydG90aW1lKCRtaW5EYXRlKTsKICAgICAgICAkbWF4RGF0ZSA9IGRhdGUoIlktbS1kIDIzOjU5IiwkbWF4KTsKICAgICAgICAkbWF4ID0gc3RydG90aW1lKCRtYXhEYXRlKTsKICAgICAgICByZXR1cm4gYXJyYXkoJG1pbiwkbWF4KTsKICAgIH0KCiAgICAvLyBDcmVhdGUgYSBuZXcgYXV0byBzaXplZCBjYW52YXMgaWYgdGhlIHVzZXIgaGFzbid0IHNwZWNpZmllZCBhIHNpemUKICAgIC8vIFRoZSBzaXplIGlzIGRldGVybWluZWQgYnkgd2hhdCBzY2FsZSB0aGUgdXNlciBoYXMgY2hvb3NlbiBhbmQgaGVuY2UKICAgIC8vIHRoZSBtaW5pbXVtIHdpZHRoIG5lZWRlZCB0byBkaXNwbGF5IHRoZSBoZWFkZXJzLiBTb21lIG1hcmdpbnMgYXJlCiAgICAvLyBhbHNvIGFkZGVkIHRvIG1ha2UgaXQgYmV0dGVyIGxvb2tpbmcuCiAgICBmdW5jdGlvbiBBdXRvU2l6ZSgpIHsKCiAgICAgICAgaWYoICR0aGlzLT5pbWctPmltZyA9PSBudWxsICkgewogICAgICAgICAgICAvLyBUaGUgcHJlZGVmaW5lZCBsZWZ0LCByaWdodCwgdG9wLCBib3R0b20gbWFyZ2lucy4KICAgICAgICAgICAgLy8gTm90ZSB0aGF0IHRoZSB0b3AgbWFyZ2luIG1pZ2h0IGluY2Vhc2UgZGVwZW5kaW5nIG9uCiAgICAgICAgICAgIC8vIHRoZSB0aXRsZS4KICAgICAgICAgICAkaGFkaiA9ICR2YWRqID0gMDsKICAgICAgICAgICBpZiggJHRoaXMtPmRvc2hhZG93ICkgewogICAgICAgICAgIAkJJGhhZGogPSAkdGhpcy0+c2hhZG93X3dpZHRoOwogICAgICAgICAgICAgICAgJHZhZGogPSAkdGhpcy0+c2hhZG93X3dpZHRoKzU7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRsbSA9ICR0aGlzLT5pbWctPmxlZnRfbWFyZ2luOwogICAgICAgICAgICAkcm0gPSAkdGhpcy0+aW1nLT5yaWdodF9tYXJnaW4gKyRoYWRqOwogICAgICAgICAgICAkcm0gKz0gMiA7CiAgICAgICAgICAgICR0bSA9ICR0aGlzLT5pbWctPnRvcF9tYXJnaW47CiAgICAgICAgICAgICRibSA9ICR0aGlzLT5pbWctPmJvdHRvbV9tYXJnaW4gKyAkdmFkajsKICAgICAgICAgICAgJGJtICs9IDI7CgogICAgICAgICAgICAvLyBJZiB0aGVyZSBhcmUgYW55IGFkZGVkIEdhbnR0VkxpbmUgd2UgbXVzdCBtYWtlIHN1cmUgdGhhdCB0aGUKICAgICAgICAgICAgLy8gYm90dG9tIG1hcmdpbiBpcyB3aWRlIGVub3VnaCB0byBob2xkIGEgdGl0bGUuCiAgICAgICAgICAgICRuID0gY291bnQoJHRoaXMtPmlPYmopOwogICAgICAgIAlmb3IoJGk9MDsgJGkgPCAkbjsgKyskaSkgewogICAgICAgICAgICAJaWYoICR0aGlzLT5pT2JqWyRpXSBpbnN0YW5jZW9mIEdhbnR0VkxpbmUgKSB7CgkJCQkJJGJtID0gbWF4KCRibSwkdGhpcy0+aU9ialskaV0tPnRpdGxlLT5HZXRIZWlnaHQoJHRoaXMtPmltZykrMTApOwogICAgICAgICAgICAJfQogICAgICAgIAl9CgogICAgICAgICAgICAvLyBGaXJzdCBmaW5kIG91dCB0aGUgaGVpZ2h0CiAgICAgICAgICAgICRuPSR0aGlzLT5HZXRCYXJNYXhMaW5lTnVtYmVyKCkrMTsKICAgICAgICAgICAgJG09bWF4KCR0aGlzLT5HZXRNYXhMYWJlbEhlaWdodCgpLCR0aGlzLT5HZXRNYXhCYXJBYnNIZWlnaHQoKSk7CiAgICAgICAgICAgICRoZWlnaHQ9JG4qKCgxKyR0aGlzLT5pTGFiZWxWTWFyZ2luRmFjdG9yKSokbSk7CgogICAgICAgICAgICAvLyBBZGQgdGhlIGhlaWdodCBvZiB0aGUgc2NhbGUgdGl0bGVzCiAgICAgICAgICAgICRoPSR0aGlzLT5zY2FsZS0+R2V0SGVhZGVySGVpZ2h0KCk7CiAgICAgICAgICAgICRoZWlnaHQgKz0gJGg7CgogICAgICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIHRvcCBtYXJnaW4gbmVlZGVkIGZvciB0aXRsZSBhbmQgc3VidGl0bGUKICAgICAgICAgICAgaWYoICR0aGlzLT50aXRsZS0+dCAhPSAiIiApIHsKICAgICAgICAgICAgICAgICR0bSArPSAkdGhpcy0+dGl0bGUtPkdldEZvbnRIZWlnaHQoJHRoaXMtPmltZyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYoICR0aGlzLT5zdWJ0aXRsZS0+dCAhPSAiIiApIHsKICAgICAgICAgICAgICAgICR0bSArPSAkdGhpcy0+c3VidGl0bGUtPkdldEZvbnRIZWlnaHQoJHRoaXMtPmltZyk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIC4uLmFuZCB0aGVuIHRha2UgdGhlIGJvdHRvbSBhbmQgdG9wIHBsb3QgbWFyZ2lucyBpbnRvIGFjY291bnQKICAgICAgICAgICAgJGhlaWdodCArPSAkdG0gKyAkYm0gKyAkdGhpcy0+c2NhbGUtPmlUb3BQbG90TWFyZ2luICsgJHRoaXMtPnNjYWxlLT5pQm90dG9tUGxvdE1hcmdpbjsKICAgICAgICAgICAgLy8gTm93IGZpbmQgdGhlIG1pbmltdW0gd2lkdGggZm9yIHRoZSBjaGFydCByZXF1aXJlZAoKICAgICAgICAgICAgLy8gSWYgZGF5IHNjYWxlIG9yIHNtYWxsZXIgaXMgc2hvd24gdGhlbiB3ZSB1c2UgdGhlIGRheSBmb250IHdpZHRoCiAgICAgICAgICAgIC8vIGFzIHRoZSBiYXNlIHNpemUgdW5pdC4KICAgICAgICAgICAgLy8gSWYgb25seSB3ZWVrcyBvciBhYm92ZSBpcyBkaXNwbGF5ZWQgd2UgdXNlIGEgbW9kaWZpZWQgdW5pdCB0bwogICAgICAgICAgICAvLyBnZXQgYSBzbWFsbGVyIGltYWdlLgogICAgICAgICAgICBpZiggJHRoaXMtPnNjYWxlLT5Jc0Rpc3BsYXlIb3VyKCkgfHwgJHRoaXMtPnNjYWxlLT5Jc0Rpc3BsYXlNaW51dGUoKSApIHsKICAgICAgICAgICAgICAgIC8vIEFkZCAyIHBpeGVsIG1hcmdpbiBvbiBlYWNoIHNpZGUKICAgICAgICAgICAgICAgICRmdz0kdGhpcy0+c2NhbGUtPmRheS0+R2V0Rm9udFdpZHRoKCR0aGlzLT5pbWcpKzQ7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZWlmKCAkdGhpcy0+c2NhbGUtPklzRGlzcGxheVdlZWsoKSApIHsKICAgICAgICAgICAgICAgICRmdyA9IDg7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZWlmKCAkdGhpcy0+c2NhbGUtPklzRGlzcGxheU1vbnRoKCkgKSB7CiAgICAgICAgICAgICAgICAkZncgPSA0OwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgJGZ3ID0gMjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJG5kPSR0aGlzLT5zY2FsZS0+R2V0TnVtYmVyT2ZEYXlzKCk7CgogICAgICAgICAgICBpZiggJHRoaXMtPnNjYWxlLT5Jc0Rpc3BsYXlEYXkoKSApIHsKICAgICAgICAgICAgICAgIC8vIElmIHRoZSBkYXlzIGFyZSBkaXNwbGF5ZWQgd2UgYWxzbyBuZWVkIHRvIGZpZ3VyZSBvdXQKICAgICAgICAgICAgICAgIC8vIGhvdyBtdWNoIHNwYWNlIGVhY2ggZGF5J3MgdGl0bGUgd2lsbCByZXF1aXJlLgogICAgICAgICAgICAgICAgc3dpdGNoKCAkdGhpcy0+c2NhbGUtPmRheS0+aVN0eWxlICkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgREFZU1RZTEVfTE9ORyA6CiAgICAgICAgICAgICAgICAgICAgICAgICR0eHQgPSAiTW9uZGF5IjsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBEQVlTVFlMRV9MT05HREFZREFURTEgOgogICAgICAgICAgICAgICAgICAgICAgICAkdHh0ID0gICJNb25kYXkgMjMgSnVuIjsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBEQVlTVFlMRV9MT05HREFZREFURTIgOgogICAgICAgICAgICAgICAgICAgICAgICAkdHh0ID0gICJNb25kYXkgMjMgSnVuIDIwMDMiOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIERBWVNUWUxFX1NIT1JUIDoKICAgICAgICAgICAgICAgICAgICAgICAgJHR4dCA9ICAiTW9uIjsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBEQVlTVFlMRV9TSE9SVERBWURBVEUxIDoKICAgICAgICAgICAgICAgICAgICAgICAgJHR4dCA9ICAiTW9uIDIzLzYiOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIERBWVNUWUxFX1NIT1JUREFZREFURTIgOgogICAgICAgICAgICAgICAgICAgICAgICAkdHh0ID0gICJNb24gMjMgSnVuIjsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBEQVlTVFlMRV9TSE9SVERBWURBVEUzIDoKICAgICAgICAgICAgICAgICAgICAgICAgJHR4dCA9ICAiTW9uIDIzIjsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBEQVlTVFlMRV9TSE9SVERBVEUxIDoKICAgICAgICAgICAgICAgICAgICAgICAgJHR4dCA9ICAiMjMvNiI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgREFZU1RZTEVfU0hPUlREQVRFMiA6CiAgICAgICAgICAgICAgICAgICAgICAgICR0eHQgPSAgIjIzIEp1biI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgREFZU1RZTEVfU0hPUlREQVRFMyA6CiAgICAgICAgICAgICAgICAgICAgICAgICR0eHQgPSAgIk1vbiAyMyI7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgREFZU1RZTEVfU0hPUlREQVRFNCA6CiAgICAgICAgICAgICAgICAgICAgICAgICR0eHQgPSAgIjg4IjsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBEQVlTVFlMRV9DVVNUT00gOgogICAgICAgICAgICAgICAgICAgICAgICAkdHh0ID0gZGF0ZSgkdGhpcy0+c2NhbGUtPmRheS0+aUxhYmVsRm9ybVN0cixzdHJ0b3RpbWUoJzIwMDMtMTItMjAgMTg6MDAnKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgREFZU1RZTEVfT05FTEVUVEVSIDoKICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgICAgICAkdHh0ID0gIk0iOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICRmdyA9ICR0aGlzLT5zY2FsZS0+ZGF5LT5HZXRTdHJXaWR0aCgkdGhpcy0+aW1nLCR0eHQpKzY7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIElmIHdlIGhhdmUgaG91cnMgZW5hYmxlZCB3ZSBtdXN0IG1ha2Ugc3VyZSB0aGF0IGVhY2ggZGF5IGhhcyBlbm91Z2gKICAgICAgICAgICAgLy8gc3BhY2UgdG8gZml0IHRoZSBudW1iZXIgb2YgaG91cnMgdG8gYmUgZGlzcGxheWVkLgogICAgICAgICAgICBpZiggJHRoaXMtPnNjYWxlLT5Jc0Rpc3BsYXlIb3VyKCkgKSB7CiAgICAgICAgICAgICAgICAvLyBEZXBlbmRpbmcgb24gd2hhdCBmb3JtYXQgdGhlIHVzZXIgaGFzIGNob29zZSB3ZSBuZWVkIGRpZmZlcmVudCBhbW91bnQKICAgICAgICAgICAgICAgIC8vIG9mIHNwYWNlLiBXZSB0aGVyZWZvcmUgY3JlYXRlIGEgdHlwaWNhbCBzdHJpbmcgZm9yIHRoZSBjaG9vc2VuIGZvcm1hdAogICAgICAgICAgICAgICAgLy8gYW5kIGRldGVybWluZSB0aGUgbGVuZ3RoIG9mIHRoYXQgc3RyaW5nLgogICAgICAgICAgICAgICAgc3dpdGNoKCAkdGhpcy0+c2NhbGUtPmhvdXItPmlTdHlsZSApIHsKICAgICAgICAgICAgICAgICAgICBjYXNlIEhPVVJTVFlMRV9ITUFNUE06CiAgICAgICAgICAgICAgICAgICAgICAgICR0eHQgPSAnMTI6MDBwbSc7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgSE9VUlNUWUxFX0gyNDoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gMTMKICAgICAgICAgICAgICAgICAgICAgICAgJHR4dCA9ICcyNCc7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgSE9VUlNUWUxFX0hBTVBNOgogICAgICAgICAgICAgICAgICAgICAgICAkdHh0ID0gJzEycG0nOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIEhPVVJTVFlMRV9DVVNUT006CiAgICAgICAgICAgICAgICAgICAgICAgICR0eHQgPSBkYXRlKCR0aGlzLT5zY2FsZS0+aG91ci0+aUxhYmVsRm9ybVN0cixzdHJ0b3RpbWUoJzIwMDMtMTItMjAgMTg6MDAnKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgSE9VUlNUWUxFX0hNMjQ6CiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgJHR4dCA9ICcyNDowMCc7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICRoZncgPSAkdGhpcy0+c2NhbGUtPmhvdXItPkdldFN0cldpZHRoKCR0aGlzLT5pbWcsJHR4dCkrNjsKICAgICAgICAgICAgICAgICRtdyA9ICRoZnc7CiAgICAgICAgICAgICAgICBpZiggJHRoaXMtPnNjYWxlLT5Jc0Rpc3BsYXlNaW51dGUoKSApIHsKICAgICAgICAgICAgICAgICAgICAvLyBEZXBlbmRpbmcgb24gd2hhdCBmb3JtYXQgdGhlIHVzZXIgaGFzIGNob29zZSB3ZSBuZWVkIGRpZmZlcmVudCBhbW91bnQKICAgICAgICAgICAgICAgICAgICAvLyBvZiBzcGFjZS4gV2UgdGhlcmVmb3JlIGNyZWF0ZSBhIHR5cGljYWwgc3RyaW5nIGZvciB0aGUgY2hvb3NlbiBmb3JtYXQKICAgICAgICAgICAgICAgICAgICAvLyBhbmQgZGV0ZXJtaW5lIHRoZSBsZW5ndGggb2YgdGhhdCBzdHJpbmcuCiAgICAgICAgICAgICAgICAgICAgc3dpdGNoKCAkdGhpcy0+c2NhbGUtPm1pbnV0ZS0+aVN0eWxlICkgewogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIEhPVVJTVFlMRV9DVVNUT006CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdHh0MiA9IGRhdGUoJHRoaXMtPnNjYWxlLT5taW51dGUtPmlMYWJlbEZvcm1TdHIsc3RydG90aW1lKCcyMDA1LTA1LTE1IDE4OjU1JykpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTUlOVVRFU1RZTEVfTU06CiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdHh0MiA9ICcxNSc7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICRtZncgPSAkdGhpcy0+c2NhbGUtPm1pbnV0ZS0+R2V0U3RyV2lkdGgoJHRoaXMtPmltZywkdHh0MikrNjsKICAgICAgICAgICAgICAgICAgICAkbjIgPSBjZWlsKDYwIC8gJHRoaXMtPnNjYWxlLT5taW51dGUtPkdldEludGVydmFsbCgpICk7CiAgICAgICAgICAgICAgICAgICAgJG13ID0gJG4yICogJG1mdzsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICRoZncgPSAkaGZ3IDwgJG13ID8gJG13IDogJGhmdyA7CiAgICAgICAgICAgICAgICAkbiA9IGNlaWwoMjQqNjAgLyAkdGhpcy0+c2NhbGUtPlRpbWVUb01pbnV0ZXMoJHRoaXMtPnNjYWxlLT5ob3VyLT5HZXRJbnRlcnZhbGwoKSkgKTsKICAgICAgICAgICAgICAgICRodyA9ICRuICogJGhmdzsKICAgICAgICAgICAgICAgICRmdyA9ICRmdyA8ICRodyA\/ICRodyA6ICRmdyA7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFdlIG5lZWQgdG8gcmVwZWF0IHRoaXMgY29kZSBibG9jayBoZXJlIGFzIHdlbGwuCiAgICAgICAgICAgIC8vIFRISVMgaVMgTk9UIEEgTUlTVEFLRSAhCiAgICAgICAgICAgIC8vIFdlIHJlYWxseSBuZWVkIGl0IHNpbmNlIHdlIG5lZWQgdG8gYWRqdXN0IGZvciBtaW51dGVzIGJvdGggaW4gdGhlIGNhc2UKICAgICAgICAgICAgLy8gd2hlcmUgaG91ciBzY2FsZSBpcyBzaG93biBhbmQgd2hlbiBpdCBpcyBub3Qgc2hvd24uCgogICAgICAgICAgICBpZiggJHRoaXMtPnNjYWxlLT5Jc0Rpc3BsYXlNaW51dGUoKSApIHsKICAgICAgICAgICAgICAgIC8vIERlcGVuZGluZyBvbiB3aGF0IGZvcm1hdCB0aGUgdXNlciBoYXMgY2hvb3NlIHdlIG5lZWQgZGlmZmVyZW50IGFtb3VudAogICAgICAgICAgICAgICAgLy8gb2Ygc3BhY2UuIFdlIHRoZXJlZm9yZSBjcmVhdGUgYSB0eXBpY2FsIHN0cmluZyBmb3IgdGhlIGNob29zZW4gZm9ybWF0CiAgICAgICAgICAgICAgICAvLyBhbmQgZGV0ZXJtaW5lIHRoZSBsZW5ndGggb2YgdGhhdCBzdHJpbmcuCiAgICAgICAgICAgICAgICBzd2l0Y2goICR0aGlzLT5zY2FsZS0+bWludXRlLT5pU3R5bGUgKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBIT1VSU1RZTEVfQ1VTVE9NOgogICAgICAgICAgICAgICAgICAgICAgICAkdHh0ID0gZGF0ZSgkdGhpcy0+c2NhbGUtPm1pbnV0ZS0+aUxhYmVsRm9ybVN0cixzdHJ0b3RpbWUoJzIwMDUtMDUtMTUgMTg6NTUnKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgTUlOVVRFU1RZTEVfTU06CiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgJHR4dCA9ICcxNSc7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICRtZncgPSAkdGhpcy0+c2NhbGUtPm1pbnV0ZS0+R2V0U3RyV2lkdGgoJHRoaXMtPmltZywkdHh0KSs2OwogICAgICAgICAgICAgICAgJG4gPSBjZWlsKDYwIC8gJHRoaXMtPnNjYWxlLT5UaW1lVG9NaW51dGVzKCR0aGlzLT5zY2FsZS0+bWludXRlLT5HZXRJbnRlcnZhbGwoKSkgKTsKICAgICAgICAgICAgICAgICRtdyA9ICRuICogJG1mdzsKICAgICAgICAgICAgICAgICRmdyA9ICRmdyA8ICRtdyA\/ICRtdyA6ICRmdyA7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIElmIHdlIGRpc3BsYXkgd2VlayB3ZSBtdXN0IG1ha2Ugc3VyZSB0aGF0IDcqJGZ3IGlzIGVub3VnaAogICAgICAgICAgICAvLyB0byBmaXQgdXAgdG8gMTAgY2hhcmFjdGVycyBvZiB0aGUgd2VlayBmb250IChpZiB0aGUgd2VlayBpcyBlbmFibGVkKQogICAgICAgICAgICBpZiggJHRoaXMtPnNjYWxlLT5Jc0Rpc3BsYXlXZWVrKCkgKSB7CiAgICAgICAgICAgICAgICAvLyBEZXBlbmRpbmcgb24gd2hhdCBmb3JtYXQgdGhlIHVzZXIgaGFzIGNob29zZSB3ZSBuZWVkIGRpZmZlcmVudCBhbW91bnQKICAgICAgICAgICAgICAgIC8vIG9mIHNwYWNlCiAgICAgICAgICAgICAgICAkZnN3ID0gc3RybGVuKCR0aGlzLT5zY2FsZS0+d2Vlay0+aUxhYmVsRm9ybVN0cik7CiAgICAgICAgICAgICAgICBpZiggJHRoaXMtPnNjYWxlLT53ZWVrLT5pU3R5bGU9PVdFRUtTVFlMRV9GSVJTVERBWTJXTkJSICkgewogICAgICAgICAgICAgICAgICAgICRmc3cgKz0gODsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2VpZiggJHRoaXMtPnNjYWxlLT53ZWVrLT5pU3R5bGU9PVdFRUtTVFlMRV9GSVJTVERBWVdOQlIgKSB7CiAgICAgICAgICAgICAgICAgICAgJGZzdyArPSA3OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgJGZzdyArPSA0OwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICR3dyA9ICRmc3cqJHRoaXMtPnNjYWxlLT53ZWVrLT5HZXRGb250V2lkdGgoJHRoaXMtPmltZyk7CiAgICAgICAgICAgICAgICBpZiggNyokZncgPCAkd3cgKSB7CiAgICAgICAgICAgICAgICAgICAgJGZ3ID0gY2VpbCgkd3cvNyk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGlmKCAhJHRoaXMtPnNjYWxlLT5Jc0Rpc3BsYXlEYXkoKSAmJiAhJHRoaXMtPnNjYWxlLT5Jc0Rpc3BsYXlIb3VyKCkgJiYKICAgICAgICAgICAgCSEoICgkdGhpcy0+c2NhbGUtPndlZWstPmlTdHlsZT09V0VFS1NUWUxFX0ZJUlNUREFZV05CUiB8fAogICAgICAgICAgICAJCSR0aGlzLT5zY2FsZS0+d2Vlay0+aVN0eWxlPT1XRUVLU1RZTEVfRklSU1REQVkyV05CUikgJiYgJHRoaXMtPnNjYWxlLT5Jc0Rpc3BsYXlXZWVrKCkgKSApIHsKICAgICAgICAgICAgICAgIC8vIElmIHdlIGRvbid0IGRpc3BsYXkgdGhlIGluZGl2aWR1YWwgZGF5cyB3ZSBjYW4gc2hyaW5rIHRoZQogICAgICAgICAgICAgICAgLy8gc2NhbGUgYSBsaXR0bGUgYml0LiBUaGlzIGlzIGEgbGl0dGxlIGJpdCBwcmFnbWF0aWMgYXQgdGhlCiAgICAgICAgICAgICAgICAvLyBtb21lbnQgYW5kIHNob3VsZCBiZSByZS13cml0dGVuIHRvIHRha2UgaW50byBhY2NvdW50CiAgICAgICAgICAgICAgICAvLyBhKSBXaGF0IHNjYWxlcyBleGFjdGx5IGFyZSBzaG93biBhbmQKICAgICAgICAgICAgICAgIC8vIGIpIHdoYXQgZm9ybWF0IGRvIHRoZXkgdXNlIHNvIHdlIGtub3cgaG93IHdpZGUgd2UgbmVlZCB0bwogICAgICAgICAgICAgICAgLy8gbWFrZSBlYWNoIHNjYWxlIHRleHQgc3BhY2UgYXQgbWluaW11bS4KICAgICAgICAgICAgICAgICRmdyAvPSAyOwogICAgICAgICAgICAgICAgaWYoICEkdGhpcy0+c2NhbGUtPklzRGlzcGxheVdlZWsoKSApIHsKICAgICAgICAgICAgICAgICAgICAkZncgLz0gMS44OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAkY3cgPSAkdGhpcy0+R2V0TWF4QWN0SW5mb0NvbFdpZHRoKCkgOwogICAgICAgICAgICAkdGhpcy0+c2NhbGUtPmFjdGluZm8tPlNldE1pbkNvbFdpZHRoKCRjdyk7CiAgICAgICAgICAgIGlmKCAkdGhpcy0+aW1nLT53aWR0aCA8PSAwICkgewogICAgICAgICAgICAgICAgLy8gTm93IGRldGVybWluZSB0aGUgd2lkdGggZm9yIHRoZSBhY3Rpdml0eSB0aXRsZXMgY29sdW1uCgogICAgICAgICAgICAgICAgLy8gRmlyZHN0IGZpbmQgb3V0IHRoZSBtYXhpbXVtIHdpZHRoIG9mIGVhY2ggb2JqZWN0IGNvbHVtbgogICAgICAgICAgICAgICAgJHRpdGxld2lkdGggPSBtYXgobWF4KCR0aGlzLT5HZXRNYXhMYWJlbFdpZHRoKCksCiAgICAgICAgICAgICAgICAkdGhpcy0+c2NhbGUtPnRhYmxlVGl0bGUtPkdldFdpZHRoKCR0aGlzLT5pbWcpKSwKICAgICAgICAgICAgICAgICR0aGlzLT5zY2FsZS0+YWN0aW5mby0+R2V0V2lkdGgoJHRoaXMtPmltZykpOwoKICAgICAgICAgICAgICAgIC8vIEFkZCB0aGUgd2lkdGggb2YgdGhlIHZlcnRpdmNhbCBkaXZpZGVyIGxpbmUKICAgICAgICAgICAgICAgICR0aXRsZXdpZHRoICs9ICR0aGlzLT5zY2FsZS0+ZGl2aWRlci0+aVdlaWdodCoyOwoKCQkJCS8vIEFkanVzdCB0aGUgd2lkdGggYnkgdGhlIHVzZXIgc3BlY2lmaWVkIHpvb20gZmFjdG9yCgkJCQkkZncgKj0gJHRoaXMtPmlab29tRmFjdG9yOwoKICAgICAgICAgICAgICAgIC8vIE5vdyBnZXQgdGhlIHRvdGFsIHdpZHRoIHRha2luZwogICAgICAgICAgICAgICAgLy8gdGl0bGV3aWR0aCwgbGVmdCBhbmQgcmlndCBtYXJnaW4sIGRheWZvbnQgc2l6ZQogICAgICAgICAgICAgICAgLy8gaW50byBhY2NvdW50CiAgICAgICAgICAgICAgICAkd2lkdGggPSAkdGl0bGV3aWR0aCArICRuZCokZncgKyAkbG0rJHJtOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgJHdpZHRoID0gJHRoaXMtPmltZy0+d2lkdGg7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICR3aWR0aCA9IHJvdW5kKCR3aWR0aCk7CiAgICAgICAgICAgICRoZWlnaHQgPSByb3VuZCgkaGVpZ2h0KTsKICAgICAgICAgICAgLy8gTWFrZSBhIHNhbml0eSBjaGVjayBvbiBpbWFnZSBzaXplCiAgICAgICAgICAgIGlmKCAkd2lkdGggPiBNQVhfR0FOVFRJTUdfU0laRV9XIHx8ICRoZWlnaHQgPiBNQVhfR0FOVFRJTUdfU0laRV9IICkgewogICAgICAgICAgICAgICAgSnBncmFwaEVycm9yOjpSYWlzZUwoNjAwNywkd2lkdGgsJGhlaWdodCk7CiAgICAgICAgICAgICAgICAvLygiU2FuaXR5IGNoZWNrIGZvciBhdXRvbWF0aWMgR2FudHQgY2hhcnQgc2l6ZSBmYWlsZWQuIEVpdGhlciB0aGUgd2lkdGggKD0kd2lkdGgpIG9yIGhlaWdodCAoPSRoZWlnaHQpIGlzIGxhcmdlciB0aGFuIE1BWF9HQU5UVElNR19TSVpFLiBUaGlzIGNvdWxkIHBvdGVudGlhbGx5IGJlIGNhdXNlZCBieSBhIHdyb25nIGRhdGUgaW4gb25lIG9mIHRoZSBhY3Rpdml0aWVzLiIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgICR0aGlzLT5pbWctPkNyZWF0ZUltZ0NhbnZhcygkd2lkdGgsJGhlaWdodCk7CiAgICAgICAgICAgICR0aGlzLT5pbWctPlNldE1hcmdpbigkbG0sJHJtLCR0bSwkYm0pOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBSZXR1cm4gYW4gYXJyYXkgd2lkdGggdGhlIG1heGltdW0gd2lkdGggZm9yIGVhY2ggYWN0aXZpdHkKICAgIC8vIGNvbHVtbi4gVGhpcyBpcyB1c2VkIHdoZW4gd2UgYXV0b3NpemUgdGhlIGNvbHVtbnMgd2hlcmUgd2UgbmVlZAogICAgLy8gdG8gZmluZCBvdXQgdGhlIG1heGltdW0gd2lkdGggb2YgZWFjaCBjb2x1bW4uIEluIG9yZGVyIHRvIGRvIHRoYXQgd2UKICAgIC8vIG11c3Qgd2FsayB0aHJvdWdoIGFsbCB0aGUgb2JqZWN0cywgc2lnaC4uLgogICAgZnVuY3Rpb24gR2V0TWF4QWN0SW5mb0NvbFdpZHRoKCkgewogICAgICAgICRuID0gY291bnQoJHRoaXMtPmlPYmopOwogICAgICAgIGlmKCAkbiA9PSAwICkgcmV0dXJuOwogICAgICAgICR3ID0gYXJyYXkoKTsKICAgICAgICAkbSA9ICR0aGlzLT5zY2FsZS0+YWN0aW5mby0+aUxlZnRDb2xNYXJnaW4gKyAkdGhpcy0+c2NhbGUtPmFjdGluZm8tPmlSaWdodENvbE1hcmdpbjsKCiAgICAgICAgZm9yKCAkaT0wOyAkaSA8ICRuOyArKyRpICkgewogICAgICAgICAgICAkdG1wID0gJHRoaXMtPmlPYmpbJGldLT50aXRsZS0+R2V0Q29sV2lkdGgoJHRoaXMtPmltZywkbSk7CiAgICAgICAgICAgICRubiA9IGNvdW50KCR0bXApOwogICAgICAgICAgICBmb3IoICRqPTA7ICRqIDwgJG5uOyArKyRqICkgewogICAgICAgICAgICAgICAgaWYoIGVtcHR5KCR3WyRqXSkgKQogICAgICAgICAgICAgICAgJHdbJGpdID0gJHRtcFskal07CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAkd1skal0gPSBtYXgoJHdbJGpdLCR0bXBbJGpdKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gJHc7CiAgICB9CgogICAgLy8gU3Ryb2tlIHRoZSBnYW50dCBjaGFydAogICAgZnVuY3Rpb24gU3Ryb2tlKCRhU3Ryb2tlRmlsZU5hbWU9IiIpIHsKCiAgICAgICAgLy8gSWYgdGhlIGZpbGVuYW1lIGlzIHRoZSBwcmVkZWZpbmVkIHZhbHVlID0gJ19jc2ltX3NwZWNpYWxfJwogICAgICAgIC8vIHdlIGFzc3VtZSB0aGF0IHRoZSBjYWxsIHRvIHN0cm9rZSBvbmx5IG5lZWRzIHRvIGRvIGVub3VnaAogICAgICAgIC8vIHRvIGNvcnJlY3RseSBnZW5lcmF0ZSB0aGUgQ1NJTSBtYXBzLgogICAgICAgIC8vIFdlIHVzZSB0aGlzIHZhcmlhYmxlIHRvIHNraXAgdGhpbmdzIHdlIGRvbid0IHN0cmljdGx5IG5lZWQKICAgICAgICAvLyB0byBkbyB0byBnZW5lcmF0ZSB0aGUgaW1hZ2UgbWFwIHRvIGltcHJvdmUgcGVyZm9ybWFuY2UKICAgICAgICAvLyBhIGJlc3Qgd2UgY2FuLiBUaGVyZWZvciB5b3Ugd2lsbCBzZWUgYSBsb3Qgb2YgdGVzdHMgISRfY3NpbSBpbiB0aGUKICAgICAgICAvLyBjb2RlIGJlbG93LgogICAgICAgICRfY3NpbSA9ICgkYVN0cm9rZUZpbGVOYW1lPT09X0NTSU1fU1BFQ0lBTEZJTEUpOwoKICAgICAgICAvLyBTaG91bGQgd2UgYXV0b3NjYWxlIGRhdGVzPwoKICAgICAgICBpZiggISR0aGlzLT5zY2FsZS0+SXNSYW5nZVNldCgpICkgewogICAgICAgICAgICBsaXN0KCRtaW4sJG1heCkgPSAkdGhpcy0+R2V0QmFyTWluTWF4KCk7CiAgICAgICAgICAgICR0aGlzLT5zY2FsZS0+U2V0UmFuZ2UoJG1pbiwkbWF4KTsKICAgICAgICB9CgogICAgICAgICR0aGlzLT5zY2FsZS0+QWRqdXN0U3RhcnRFbmREYXkoKTsKCiAgICAgICAgLy8gQ2hlY2sgaWYgd2Ugc2hvdWxkIGF1dG9zY2FsZSB0aGUgaW1hZ2UKICAgICAgICAkdGhpcy0+QXV0b1NpemUoKTsKCiAgICAgICAgLy8gU2hvdWxkIHdlIHN0YXJ0IGZyb20gdGhlIHRvcCBvciBqdXN0IHNwcmVhZCB0aGUgYmFycyBvdXQgZXZlbiBvdmVyIHRoZQogICAgICAgIC8vIGF2YWlsYWJsZSBoZWlnaHQKICAgICAgICAkdGhpcy0+c2NhbGUtPlNldFZlcnRMYXlvdXQoJHRoaXMtPmlMYXlvdXQpOwogICAgICAgIGlmKCAkdGhpcy0+aUxheW91dCA9PSBHQU5UVF9GUk9NVE9QICkgewogICAgICAgICAgICAkbWF4aGVpZ2h0PW1heCgkdGhpcy0+R2V0TWF4TGFiZWxIZWlnaHQoKSwkdGhpcy0+R2V0TWF4QmFyQWJzSGVpZ2h0KCkpOwogICAgICAgICAgICAkdGhpcy0+c2NhbGUtPlNldFZlcnRTcGFjaW5nKCRtYXhoZWlnaHQqKDErJHRoaXMtPmlMYWJlbFZNYXJnaW5GYWN0b3IpKTsKICAgICAgICB9CiAgICAgICAgLy8gSWYgaXQgaGFzbid0IGJlZW4gc2V0IGZpbmQgb3V0IHRoZSBtYXhpbXVtIGxpbmUgbnVtYmVyCiAgICAgICAgaWYoICR0aGlzLT5zY2FsZS0+aVZlcnRMaW5lcyA9PSAtMSApCiAgICAgICAgCSR0aGlzLT5zY2FsZS0+aVZlcnRMaW5lcyA9ICR0aGlzLT5HZXRCYXJNYXhMaW5lTnVtYmVyKCkrMTsKCiAgICAgICAgJG1heHdpZHRoPW1heCgkdGhpcy0+c2NhbGUtPmFjdGluZm8tPkdldFdpZHRoKCR0aGlzLT5pbWcpLAogICAgICAgIG1heCgkdGhpcy0+R2V0TWF4TGFiZWxXaWR0aCgpLAogICAgICAgICR0aGlzLT5zY2FsZS0+dGFibGVUaXRsZS0+R2V0V2lkdGgoJHRoaXMtPmltZykpKTsKCiAgICAgICAgJHRoaXMtPnNjYWxlLT5TZXRMYWJlbFdpZHRoKCRtYXh3aWR0aCskdGhpcy0+c2NhbGUtPmRpdmlkZXItPmlXZWlnaHQpOy8vKigxKyR0aGlzLT5pTGFiZWxITWFyZ2luRmFjdG9yKSk7CgogICAgICAgIGlmKCAhJF9jc2ltICkgewogICAgICAgICAgICAkdGhpcy0+U3Ryb2tlUGxvdEFyZWEoKTsKICAgICAgICAgICAgaWYoICR0aGlzLT5pSWNvbkRlcHRoID09IERFUFRIX0JBQ0sgKSB7CiAgICAgICAgICAgICAgICAkdGhpcy0+U3Ryb2tlSWNvbnMoKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgJHRoaXMtPnNjYWxlLT5TdHJva2UoKTsKCiAgICAgICAgaWYoICEkX2NzaW0gKSB7CiAgICAgICAgICAgIC8vIER1ZSB0byBhIG1pbm9yIG9mZiBieSAxIGJ1ZyB3ZSBuZWVkIHRvIHRlbXBvcmFyaWx5IGFkanVzdCB0aGUgbWFyZ2luCiAgICAgICAgICAgICR0aGlzLT5pbWctPnJpZ2h0X21hcmdpbi0tOwogICAgICAgICAgICAkdGhpcy0+U3Ryb2tlUGxvdEJveCgpOwogICAgICAgICAgICAkdGhpcy0+aW1nLT5yaWdodF9tYXJnaW4rKzsKICAgICAgICB9CgogICAgICAgIC8vIFN0cm9rZSBHcmlkIGxpbmUKICAgICAgICAkdGhpcy0+aGdyaWQtPlN0cm9rZSgkdGhpcy0+aW1nLCR0aGlzLT5zY2FsZSk7CgogICAgICAgICRuID0gY291bnQoJHRoaXMtPmlPYmopOwogICAgICAgIGZvcigkaT0wOyAkaSA8ICRuOyArKyRpKSB7CiAgICAgICAgICAgIC8vJHRoaXMtPmlPYmpbJGldLT5TZXRMYWJlbExlZnRNYXJnaW4ocm91bmQoJG1heHdpZHRoKiR0aGlzLT5pTGFiZWxITWFyZ2luRmFjdG9yLzIpKTsKICAgICAgICAgICAgJHRoaXMtPmlPYmpbJGldLT5TdHJva2UoJHRoaXMtPmltZywkdGhpcy0+c2NhbGUpOwogICAgICAgIH0KCiAgICAgICAgJHRoaXMtPlN0cm9rZVRpdGxlcygpOwoKICAgICAgICBpZiggISRfY3NpbSApIHsKICAgICAgICAgICAgJHRoaXMtPlN0cm9rZUNvbnN0cmFpbnMoKTsKICAgICAgICAgICAgJHRoaXMtPmZvb3Rlci0+U3Ryb2tlKCR0aGlzLT5pbWcpOwoKCiAgICAgICAgICAgIGlmKCAkdGhpcy0+aUljb25EZXB0aCA9PSBERVBUSF9GUk9OVCkgewogICAgICAgICAgICAgICAgJHRoaXMtPlN0cm9rZUljb25zKCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIFN0cm9rZSBhbGwgYWRkZWQgdXNlciB0ZXh0cwogICAgICAgICAgICAkdGhpcy0+U3Ryb2tlVGV4dHMoKTsKCiAgICAgICAgICAgIC8vIFNob3VsZCB3ZSBkbyBhbnkgZmluYWwgaW1hZ2UgdHJhbnNmb3JtYXRpb24KICAgICAgICAgICAgaWYoICR0aGlzLT5pSW1nVHJhbnMgKSB7CiAgICAgICAgICAgICAgICBpZiggIWNsYXNzX2V4aXN0cygnSW1nVHJhbnMnLGZhbHNlKSApIHsKICAgICAgICAgICAgICAgICAgICByZXF1aXJlX29uY2UoJ2pwZ3JhcGhfaW1ndHJhbnMucGhwJyk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgJHRmb3JtID0gbmV3IEltZ1RyYW5zKCR0aGlzLT5pbWctPmltZyk7CiAgICAgICAgICAgICAgICAkdGhpcy0+aW1nLT5pbWcgPSAkdGZvcm0tPlNrZXczRCgkdGhpcy0+aUltZ1RyYW5zSG9yaXpvbiwkdGhpcy0+aUltZ1RyYW5zU2tld0Rpc3QsCiAgICAgICAgICAgICAgICAkdGhpcy0+aUltZ1RyYW5zRGlyZWN0aW9uLCR0aGlzLT5pSW1nVHJhbnNIaWdoUSwKICAgICAgICAgICAgICAgICR0aGlzLT5pSW1nVHJhbnNNaW5TaXplLCR0aGlzLT5pSW1nVHJhbnNGaWxsQ29sb3IsCiAgICAgICAgICAgICAgICAkdGhpcy0+aUltZ1RyYW5zQm9yZGVyKTsKICAgICAgICAgICAgfQoKCiAgICAgICAgICAgIC8vIElmIHRoZSBmaWxlbmFtZSBpcyBnaXZlbiBhcyB0aGUgc3BlY2lhbCAiX19oYW5kbGUiCiAgICAgICAgICAgIC8vIHRoZW4gdGhlIGltYWdlIGhhbmRsZXIgaXMgcmV0dXJuZWQgYW5kIHRoZSBpbWFnZSBpcyBOT1QKICAgICAgICAgICAgLy8gc3RyZWFtZWQgYmFjawogICAgICAgICAgICBpZiggJGFTdHJva2VGaWxlTmFtZSA9PSBfSU1HX0hBTkRMRVIgKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gJHRoaXMtPmltZy0+aW1nOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgLy8gRmluYWxseSBzdHJlYW0gdGhlIGdlbmVyYXRlZCBwaWN0dXJlCiAgICAgICAgICAgICAgICAkdGhpcy0+Y2FjaGUtPlB1dEFuZFN0cmVhbSgkdGhpcy0+aW1nLCR0aGlzLT5jYWNoZV9uYW1lLCR0aGlzLT5pbmxpbmUsCiAgICAgICAgICAgICAgICAkYVN0cm9rZUZpbGVOYW1lKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBTdHJva2VDb25zdHJhaW5zKCkgewogICAgICAgICRuID0gY291bnQoJHRoaXMtPmlPYmopOwoKICAgICAgICAvLyBTdHJva2UgYWxsIGNvbnN0cmFpbnMKICAgICAgICBmb3IoJGk9MDsgJGkgPCAkbjsgKyskaSkgewoKICAgICAgICAgICAgLy8gU29tZSBnYW50dCBvYmplY3RzIG1heSBub3QgaGF2ZSBjb25zdHJhaW50cyBhc3NvY2lhdGVkIHdpdGggdGhlbQogICAgICAgICAgICAvLyBmb3IgZXhhbXBsZSB3ZSBjYW4gYWRkIEljb25QbG90cyB3aGljaCBkb2Vzbid0IGhhdmUgdGhpcyBwcm9wZXJ0eS4KICAgICAgICAgICAgaWYoIGVtcHR5KCR0aGlzLT5pT2JqWyRpXS0+Y29uc3RyYWludHMpICkgY29udGludWU7CgogICAgICAgICAgICAkbnVtQ29uc3RyYWlucyA9IGNvdW50KCR0aGlzLT5pT2JqWyRpXS0+Y29uc3RyYWludHMpOwoKICAgICAgICAgICAgZm9yKCAkayA9IDA7ICRrIDwgJG51bUNvbnN0cmFpbnM7ICRrKysgKSB7CiAgICAgICAgICAgICAgICAkdnBvcyA9ICR0aGlzLT5pT2JqWyRpXS0+Y29uc3RyYWludHNbJGtdLT5pQ29uc3RyYWluUm93OwogICAgICAgICAgICAgICAgaWYoICR2cG9zID49IDAgKSB7CiAgICAgICAgICAgICAgICAgICAgJGMxID0gJHRoaXMtPmlPYmpbJGldLT5pQ29uc3RyYWluUG9zOwoKICAgICAgICAgICAgICAgICAgICAvLyBGaW5kIG91dCB3aGljaCBvYmplY3QgaXMgb24gdGhlIHRhcmdldCByb3cKICAgICAgICAgICAgICAgICAgICAkdGFyZ2V0b2JqID0gLTE7CiAgICAgICAgICAgICAgICAgICAgZm9yKCAkaj0wOyAkaiA8ICRuICYmICR0YXJnZXRvYmogPT0gLTE7ICsrJGogKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCAkdGhpcy0+aU9ialskal0tPmlWUG9zID09ICR2cG9zICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRhcmdldG9iaiA9ICRqOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmKCAkdGFyZ2V0b2JqID09IC0xICkgewogICAgICAgICAgICAgICAgICAgICAgICBKcEdyYXBoRXJyb3I6OlJhaXNlTCg2MDA4LCR0aGlzLT5pT2JqWyRpXS0+aVZQb3MsJHZwb3MpOwogICAgICAgICAgICAgICAgICAgICAgICAvLygnWW91IGhhdmUgc3BlY2lmZWQgYSBjb25zdHJhaW4gZnJvbSByb3c9Jy4kdGhpcy0+aU9ialskaV0tPmlWUG9zLicgdG8gcm93PScuJHZwb3MuJyB3aGljaCBkb2VzIG5vdCBoYXZlIGFueSBhY3Rpdml0eS4nKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJGMyID0gJHRoaXMtPmlPYmpbJHRhcmdldG9ial0tPmlDb25zdHJhaW5Qb3M7CiAgICAgICAgICAgICAgICAgICAgaWYoIGNvdW50KCRjMSkgPT0gNCAmJiBjb3VudCgkYzIgKSA9PSA0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCggJHRoaXMtPmlPYmpbJGldLT5jb25zdHJhaW50c1ska10tPmlDb25zdHJhaW5UeXBlICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBDT05TVFJBSU5fRU5EU1RBUlQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoICRjMVsxXSA8ICRjMlsxXSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGxpbmsgPSBuZXcgR2FudHRMaW5rKCRjMVsyXSwkYzFbM10sJGMyWzBdLCRjMlsxXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbGluayA9IG5ldyBHYW50dExpbmsoJGMxWzJdLCRjMVsxXSwkYzJbMF0sJGMyWzNdKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGxpbmstPlNldFBhdGgoMyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIENPTlNUUkFJTl9TVEFSVEVORDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiggJGMxWzFdIDwgJGMyWzFdICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbGluayA9IG5ldyBHYW50dExpbmsoJGMxWzBdLCRjMVszXSwkYzJbMl0sJGMyWzFdKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRsaW5rID0gbmV3IEdhbnR0TGluaygkYzFbMF0sJGMxWzFdLCRjMlsyXSwkYzJbM10pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbGluay0+U2V0UGF0aCgwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgQ09OU1RSQUlOX0VOREVORDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiggJGMxWzFdIDwgJGMyWzFdICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbGluayA9IG5ldyBHYW50dExpbmsoJGMxWzJdLCRjMVszXSwkYzJbMl0sJGMyWzFdKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRsaW5rID0gbmV3IEdhbnR0TGluaygkYzFbMl0sJGMxWzFdLCRjMlsyXSwkYzJbM10pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbGluay0+U2V0UGF0aCgxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgQ09OU1RSQUlOX1NUQVJUU1RBUlQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoICRjMVsxXSA8ICRjMlsxXSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGxpbmsgPSBuZXcgR2FudHRMaW5rKCRjMVswXSwkYzFbM10sJGMyWzBdLCRjMlsxXSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbGluayA9IG5ldyBHYW50dExpbmsoJGMxWzBdLCRjMVsxXSwkYzJbMF0sJGMyWzNdKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGxpbmstPlNldFBhdGgoMyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDYwMDksJHRoaXMtPmlPYmpbJGldLT5pVlBvcywkdnBvcyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8oJ1Vua25vd24gY29uc3RyYWluIHR5cGUgc3BlY2lmaWVkIGZyb20gcm93PScuJHRoaXMtPmlPYmpbJGldLT5pVlBvcy4nIHRvIHJvdz0nLiR2cG9zKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgJGxpbmstPlNldENvbG9yKCR0aGlzLT5pT2JqWyRpXS0+Y29uc3RyYWludHNbJGtdLT5pQ29uc3RyYWluQ29sb3IpOwogICAgICAgICAgICAgICAgICAgICAgICAkbGluay0+U2V0QXJyb3coJHRoaXMtPmlPYmpbJGldLT5jb25zdHJhaW50c1ska10tPmlDb25zdHJhaW5BcnJvd1NpemUsCiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5pT2JqWyRpXS0+Y29uc3RyYWludHNbJGtdLT5pQ29uc3RyYWluQXJyb3dUeXBlKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICRsaW5rLT5TdHJva2UoJHRoaXMtPmltZyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIGZ1bmN0aW9uIEdldENTSU1BcmVhcygpIHsKICAgICAgICBpZiggISR0aGlzLT5pSGFzU3Ryb2tlZCApCiAgICAgICAgJHRoaXMtPlN0cm9rZShfQ1NJTV9TUEVDSUFMRklMRSk7CgogICAgICAgICRjc2ltID0gJHRoaXMtPnRpdGxlLT5HZXRDU0lNQXJlYXMoKTsKICAgICAgICAkY3NpbSAuPSAkdGhpcy0+c3VidGl0bGUtPkdldENTSU1BcmVhcygpOwogICAgICAgICRjc2ltIC49ICR0aGlzLT5zdWJzdWJ0aXRsZS0+R2V0Q1NJTUFyZWFzKCk7CgogICAgICAgICRuID0gY291bnQoJHRoaXMtPmlPYmopOwogICAgICAgIGZvciggJGk9JG4tMTsgJGkgPj0gMDsgLS0kaSApCiAgICAgICAgJGNzaW0gLj0gJHRoaXMtPmlPYmpbJGldLT5HZXRDU0lNQXJlYSgpOwogICAgICAgIHJldHVybiAkY3NpbTsKICAgIH0KfQoKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gQ0xBU1MgUHJlZGVmSWNvbnMKLy8gRGVzY3JpcHRpb246IFByZWRlZmluZWQgaWNvbnMgZm9yIHVzZSB3aXRoIEdhbnR0IGNoYXJ0cwovLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpkZWZpbmUoJ0dJQ09OX1dBUk5JTkdSRUQnLDApOwpkZWZpbmUoJ0dJQ09OX1RFWFQnLDEpOwpkZWZpbmUoJ0dJQ09OX0VORENPTlMnLDIpOwpkZWZpbmUoJ0dJQ09OX01BSUwnLDMpOwpkZWZpbmUoJ0dJQ09OX1NUQVJUQ09OUycsNCk7CmRlZmluZSgnR0lDT05fQ0FMQycsNSk7CmRlZmluZSgnR0lDT05fTUFHTklGSUVSJyw2KTsKZGVmaW5lKCdHSUNPTl9MT0NLJyw3KTsKZGVmaW5lKCdHSUNPTl9TVE9QJyw4KTsKZGVmaW5lKCdHSUNPTl9XQVJOSU5HWUVMTE9XJyw5KTsKZGVmaW5lKCdHSUNPTl9GT0xERVJPUEVOJywxMCk7CmRlZmluZSgnR0lDT05fRk9MREVSJywxMSk7CmRlZmluZSgnR0lDT05fVEVYVElNUE9SVEFOVCcsMTIpOwoKY2xhc3MgUHJlZGVmSWNvbnMgewogICAgcHJpdmF0ZSAkaUJ1aWx0aW5JY29uID0gbnVsbCwgJGlMZW4gPSAtMSA7CgogICAgZnVuY3Rpb24gR2V0TGVuKCkgewogICAgICAgIHJldHVybiAkdGhpcy0+aUxlbiA7CiAgICB9CgogICAgZnVuY3Rpb24gR2V0SW1nKCRhSWR4KSB7CiAgICAgICAgaWYoICRhSWR4IDwgMCB8fCAkYUlkeCA+PSAkdGhpcy0+aUxlbiApIHsKICAgICAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoNjAxMCwkYUlkeCk7CiAgICAgICAgICAgIC8vKCdJbGxlZ2FsIGljb24gaW5kZXggZm9yIEdhbnR0IGJ1aWx0aW4gaWNvbiBbJy4kYUlkeC4nXScpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gSW1hZ2U6OkNyZWF0ZUZyb21TdHJpbmcoYmFzZTY0X2RlY29kZSgkdGhpcy0+aUJ1aWx0aW5JY29uWyRhSWR4XVsxXSkpOwogICAgfQoKICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCkgewogICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgICAgIC8vIHdhcm5pbmcucG5nCiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAgICAgJHRoaXMtPmlCdWlsdGluSWNvblswXVswXT0gMTA0MyA7CiAgICAgICAgJHRoaXMtPmlCdWlsdGluSWNvblswXVsxXT0KICAgICAnaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUNBQUFBQWdDQVlBQUFCemVucjBBQUFBQm1KTFIwUUEvd0QvQVArZ3ZhZVRBQUFBQ1hCSVdYTUFBQXNTQUFBTEVnSFMzWDc4QUFBQScuCiAgICAgJ0IzUkpUVVVIMHdnS0ZTZ2lsV1BoVVFBQUE2QkpSRUZVZU5ydGw5MXJIRlVZaDUvM3pNeCtaNUpOVW9PYW1DWk5hcVRaNklXSWtxUmlRV21pMUlEZXRIZmVpQ2lsdGdYQlA4QUwnLgogICAgICcwU0lVeGYvQXZmUlNCUzlFS0lMRkZxeUlIOUNFbUZadFBxckJKTHM3YytiMVluZVQzV1RUYk5zVUZQTENjQWJtelB0NzNvOXp6Z3pzMlo3OTMyMzFVT2R2M3c5azlaMnV6T2RBJy4KICAgICAnNSsyKzc5eU5lTDdIbDdodzdvZWl4Uk1aNlBKTTI2VzE4RE5BbS9WaDdsUjhmcWg5N05tTUYxMWVzMWlGcE1BVHFkaXJ3TU5BL0o0RHBJemtyNVlzQUYxUE82Z0lNWUhSZFB3bCcuCiAgICAgJ29PMmVsbUIrcUgzc203WG96YmtnWXZ5OFN6WW5aUHRjYmx5TTZJKzV6M2pRKzB2SmZncEV1NTZCZkk5dlVrYnlpMkhaZDFRSm9lV1JpQWpCZDRTRENXOFNTQU95NndCSE16RjcnLgogICAgICdZZFYyQStST3V2UlBMZkhvaVNVMEVNWS9jREFJaHhKZUduZ0thTjFWZ0h5UEw3TkJ4STFLOVA0UXhCenczSzF6Si96a0c4Qjl1d2FRNy9ITnNSWnY5a29oQkdEMG83SnFNWVMvJy4KICAgICAnL3luUGlkUXcvTHJCaVBCY1MveUZDVDk1RHZCMkJXQXk0NTc1UGFRYlFLVyt0UGQzR0NJdHUyb2RLSSsrWXhpS3UwZDI2b1dtQUQ3cGFaVS9yTHozN1ZxSWlqRDJZYm56TkJCRScuCiAgICAgJ0lCSGY4Szhxakw3dlloQ0dFckVVOENUZzN4WEFlTXA5NkdySkVxa3lYa205Qmh1aTF4ZnN1bmpkR2hjWUxxK0l6anNHbUJ0NVlIL2NtSmtGcTZnSXFsb24zdTRMeGRLR3VDSW8nLgogICAgICdRdTQxZzBFNDFwbysyUjMzWHQ1dXo5a1JJQjJVVGxlN1BuZktyUk9QMUhENHNSalpscTBsemh3b1o2ckROZVRpM25FZzFzaS83RlQ3a1lRYlhTNkU1RTY1dEE1dVJGOXR1dHEwJy4KICAgICAnSy9Wd0FGKy9GYklZV3Q2K3RqUU0vQXFVbXM3QTRXeTZkN1lTZlNOeGdNbXppMHljV1d3b3JpbzRRSnZqNExwdUw1QnF1Z1RuWHp6cUpzSnd1cnJsTmhKWEZhYXZXNjdOUnczRicuCiAgICAgJ3ErYUpjQ1FWZTlmenZKR21BWTcvZFBIMGdpMGY2NE92ZUd4YSt1c0N1UU1lWjAra3Q4QlZyWCtxUE85Qnp4ME1ncUJ2cythMlBmRGRZSWYrV0FqWFUxdWI0dHFOYVBQelJzOEEnLgogICAgICdibHJsaStXVm43OWNYbjBjV0tsK3RHeDdITGM3cHUzQ1NtbmZpdEwrbDFVaWhBaHdqRmtQUWV2NEsvZlNBQmpCTThKQ2FGdXVySlUrcmdXNDFTcm9BOGFOTVZOQUZ0Z0hKQ3NuJy4KICAgICAnWEd5LzU4UVZ4QUM5TWNjSnRaNWtJek5sVzQ0MFdySjJlYTRZUEE5Y0Fvb0E3aTBBL2dTK2lxTG9PcEIxSE9lZ3FyWUIzVUJtSnJBdFFBSndwd1ByMVJ5OTJ3VmxnWnNpWWxXMScuCiAgICAgJ3VYMWdVMzZkeW1ncVl4SklKSk5KVDFXOVFxSGdOd0ZRQkdZcW85NE93SFpRVXVQRDdBQ2dsU3ZjKzVuNVQ5bS93ZkpKWDRVOXF6RUFBQUFBU1VWT1JLNUNZSUk9JyA7CgogICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgICAgIC8vIGVkaXQucG5nCiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAgICAgJHRoaXMtPmlCdWlsdGluSWNvblsxXVswXT0gOTU5IDsKICAgICAgICAkdGhpcy0+aUJ1aWx0aW5JY29uWzFdWzFdPQogICAgICdpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQllBQUFBV0NBWUFBQURFdEd3N0FBQUFCR2RCVFVFQUFMR1BDL3hoQlFBQUFBWmlTMGRFQUZnQVdBQlk5aitadXdBQUFBbHdTRmx6Jy4KICAgICAnQUFBTEVBQUFDeEFCclNPOWRRQUFBQWQwU1UxRkI5QUtEQXdiSUVYT0E2QUFBQU04U1VSQlZIaWNwZFJQYUJ4bEhNYng3Nlp2c21PVG1tMWRzRXFRU0lJc0VtR1ZCQVFqaXZFUScuCiAgICAgJ1BBVUpuZ3BXc0FXbEJ3OGVncFFlcEt3cGxONFVMRUc5Q2prRXlVRktsU0pyV1RHMElVNTFwQ3NkWVcybmNVUGpkdHA5WitmM3Z1Tmh1OG5LYm1oYWY1Y1plR2MrUE84emYxTGMnLgogICAgICdtMEtoa0FDSUNDS0NNZWFCamlMQzB0TFNuak52UG11T0hScEgwVFpUVTFNOHpCaTl3YWt6bjdPRlRzNXN3OFlZQUNZbUpycmU3SGtldVZ5dTY5cVBGNzdobFQxWG1aMGVRMDNPJy4KICAgICAnd09MSlR2aEJ4MXJMejE4Vm1KMGVZK2pWZDJGeERrS1hudllMSGdiOTdPZ0x6RTRPTjlIemMxQjFRYVF6c2VkNU8wTHRhM0VjODlPblI1aDVNY2ZRK013MnFnUVVuZkJPUGJaMycuCiAgICAgJ2JLM2wreE92TVQwKzNFUkxwNUZORjZVRWpjTDMyK0RkVm1HdDVXTGhEWVlQWnJiUnFyZUZ1bVh3cWwwUzN3OXRuRHZMV0Q1UFppZ1BwZE93dVlwU0NvM0M4d1UzVUh4UWRIYmYnLgogICAgICdjWklrTk02ZHhjbmxVTTRrMWVVRk1sVVBwVUFEYnBrdHRGYXJIZTZvWXFlT3I2eXQ0UnpNUUhZVWNVc1FWdEdpY0hEd0twclZpdUxEa2tPdFZuc0hDSFpWUlZ5L3pjajFpNUFmJy4KICAgICAnaDhBamRJdHMraFVjR2NZUEszaUJ0S00zZ0QvdUF6Zi9BZFkybW1tVmd5Nlg4WU5OS21HSXZ5bG9QY0I4U1VpbjA3UlE0RVpIRmRzZEcwd2tKRW5FYUhBSnh2S0VwU0xlYW9rVicuCiAgICAgJ3I0eldtaFVaWUxsWTRiMUQwM3k1ZUlFV0N0Uzd2c2NpQWdpSXhrUVJhYldPcmxRb3I2Nnk0cFVwaG9KYjFqaU80dU81bzBTM3E2UlNxVmJpT21DN1ZDRWdBaExTYURRNDhkSDcnLgogICAgICd2RDQ2UkVZMGl5c2VnU2pLUWNpUnQ5OWliN3FYd1gwTytwRzR0ZU02WUtITEI5Sk1xNG1UbUY5LytBS0E0d3ZMWkJ5SDdPZ1lMNytVWTJxdncvN0JmZzVrSGlYakpGeXYzQ0dPJy4KICAgICAnWTFyb2YrQlc0dC9YTGlQRzBEQ0dyNzlkNFh6UnhSbklNbjk4aHVYU1RZeUo2ZXQxVU5ZUWhSdmNpbnBKcTg2SDN3R1BQUE0waUJEZCtRZmZEMWc0ZVpqTHZ1RzdTMVdlZjI2RScuCiAgICAgJ0o3TDdlU3g3Z0FIVmc3VjNNU2JpNm0vcjkzYmFCZDZxUWplckFKZy85UWwvWHJ2RzBPTjErdnY3R0gzcVNmWTVmYWhVblNUcHdaZ0lFUWVzYVZYUlBiSFJHL3h5SlNBeE1ZbHAnLgogICAgICdFT203MUhVSU5pWTdtR2I5NWwvOGpaQ3lRbUpqTURHSmpVbXNkQ1JPdFowbi9QL1o4djRGczJNVFVVZjd2WW9BQUFBQVNVVk9SSzVDWUlJPScgOwoKICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgICAgICAvLyBlbmRjb25zdHJhaW4ucG5nCiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAgICAgJHRoaXMtPmlCdWlsdGluSWNvblsyXVswXT0gNjY2IDsKICAgICAgICAkdGhpcy0+aUJ1aWx0aW5JY29uWzJdWzFdPQogICAgICdpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQllBQUFBV0NBWUFBQURFdEd3N0FBQUFCR2RCVFVFQUFMR1BDL3hoQlFBQUFBWmlTMGRFQVA4QS93RC9vTDJua3dBQUFBbHdTRmx6Jy4KICAgICAnQUFBTER3QUFDdzhCa3ZrRHBRQUFBQWQwU1UxRkI5QUxFUkVJTGtoMCtlUUFBQUlYU1VSQlZIaWN0WlU5YUZOUkZNZC9OODFIWDc3YXB0SlVXbXAxTEhScEljV2hnNXNJRGxVUScuCiAgICAgJ0xBWEI0dDdSUlVwd0VoeTdpUTQ2Q0NJb1NIY2wwQ0Zhb1ZBUlUyTUZNWWt0YWRMWEpOb2s3eDJIdENFeHZ1WUZtbk80dy8zZ3grR2MvejFIS1JUZE1FZFhxSGJCL3NnYy9zaWMnLgogICAgICduRG9ZQUk4WHdEYThvMVJNTFQrMmhBc2lndFR2YklHVnFoWDQ2c3pVaWZCR3N3VWVDUGdBR0I3UWVMazBYNE9yaytIT3hvMVZnU3FHQVNqTXFrbjhXNHI0dlZ0RWdJL1JSUUVMJy4KICAgICAndmFvR0Q4NWNsNVYzbnlTUi9TMW14V3hhYjdmMzVQbm50TnlNSmVScjlrQ01xaUhUeTA5RW9lVG9Md2dneDZ5bWlNT0QvVndjRDdPYS9NSGtjSWlReDAyNldHWXRvNVAvVStaWicuCiAgICAgJzdnRDBRd0R1VDV6OU4zTHJWUGkwWHM1NDNlUVBLa1J6YVM1NGV2aUpJcDR0TUZRRk1sbEFXTjJxY1JaSEJuaXhOTThOWUQxNjJ4cTh1N2VQU1ErR1gyUGp3eGMyZEIyY0x0QjgnLgogICAgICc3R2dhbUNiMGFuQllCZUNoTXRsODg1NUNhcmNseFUxZ3ZWaWlVSzR3Mk9Na05EbkdlSjhidDlmSDkweU9uT2tDd0xGVHdoenlraHZ0WXpPV29CQmJZLy9SM2RiYU5UWWhmMlJPJy4KICAgICAnUXBldVVNenYxODhNbHd1SHkwSDEzSG5FNDhVek1jTDBXQXRVSFg4T3haSG9HMVVSaUZ3N3JuTExDc3d1U1BEMXVsemUvaVdqVDJQU2YrZEJYUkZ0VlZHSXZ6cXBoMHBRTDdWRScuCiAgICAgJ2F2WFlhWFh4UHdzbnQwaW1kdHRDb2NNbVpCZEs3WVU5RDh3dU5PVzBuWGM2UVd6UHNTYTVuYVoxYmViOUJiR0I2ZHhHdE1uWEFBQUFBRWxGVGtTdVFtQ0MnIDsKCiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAgICAgLy8gbWFpbC5wbmcKICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgICAgICAkdGhpcy0+aUJ1aWx0aW5JY29uWzNdWzBdPSAxMTIyIDsKICAgICAgICAkdGhpcy0+aUJ1aWx0aW5JY29uWzNdWzFdPQogICAgICdpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQllBQUFBV0NBWUFBQURFdEd3N0FBQUFCR2RCVFVFQUFMR1BDL3hoQlFBQUFBWmlTMGRFQVA4QS93RC9vTDJua3dBQUFBbHdTRmx6Jy4KICAgICAnQUFBTEVBQUFDeEFCclNPOWRRQUFBQWQwU1UxRkI5QUpIQU1mRnZMOU9VOEFBQVBmU1VSQlZIaWN0WlJkYUJSWEZNZC85ODdIN3RiTng4YVl0R0NyRWV4RHNPQkRhS0hGeGlyYicuCiAgICAgJ2gwcWhzaVkweWtwcEtxMW9zSTk5QzRIMldTaUZGTUhXVWhYQnJqUmkwdUNtdFNFVUdnUDFRV3FoV2pHa29XN00xa1RYM1dSbjVwNCtUSkpOR29sUTZJWERuRHR6K04wei8zUFAnLgogICAgICdVV0JJcGRwWWEyM2I5ZzA5UFoya1VyT3J2bVV5R1ZLcDFBby9tVXlpNTZZblZnV2ZPL1AxQ2loQWQvZEpNcG1hTlJPSVJxOEJrTTFtMGJINlRhc0MzajZRWGdGZFhJK0RSNlBSJy4KICAgICAnSlgvUG5vOEIrS0xuTUtxbHBVVTh6OE1ZczJSQkVEeldmOUorMFJjUmJNZHhHQnNidy9mbUNYd1BNVUVZSUQ0aUFWcDh3SVJtRElITW80eUhTSUJTQVNLQytDV0UwQy9QRjlqVScuCiAgICAgJzNCNkNwKzRNMDdDNUZVdEtHTnZHd1FKY3RQZ0lzZ0Qyd1JoRUlxQU1HQitVUVlrSEpnWVlaRDdQMUh3VmxtV2hIY2ZoeWs4M0tlUkdVVzR0NkNnb0c1U05VUzRLQldnUURVb3YnLgogICAgICc3QUdsd1lBU0JWcUgwQms0OWRYcEN2aVZWM2R3L3RJMUJ2cjdrTUlJbGgwTllVcGpsRjBCQVl2Y3hTWG1FVkxLY2VIU0NKbStQbmJ1ZUJIYnRrTndUWFVOQnpvNmFHcHE0c1NaJy4KICAgICAnR3dUNUg3QnNGNldkZjFHV0hRQW9NMHVwZUk5UFQxeWlvUzdCN3RkYVNkU3V3N0tzVUdNQXk3SFlzbVV6dFRXMW5Nd00wdHhzc1gxcmxIampTNWp5L1VxMllrSy9lSnVMbDYveicuCiAgICAgJ3grMXhrc2xXNm1yaXhHSU9EeDhFRlNsRUJDMCt0bVhUME5oQTI3NjNpRVVqbkx2NEM4WHBVYlNiQUIxbUtrR0ozSjgzT2Q3N0hXNUVzenZaU3FLMmlsak1JZUphUkdOdUplUEYnLgogICAgICc2bXNwWTdCSjFEWHdRbkNkMmZ4R1JxNU9VQ3o4eHQ3MmR5aE1aY24rK0N1M3h1OVNLaGRwMmI0WkhXbkF0VFN4bUlXbGhjSWpsa3NSM2xOQll6bHhac2I3K2Y3bmUreHRTek9kJy4KICAgICAndTgzc3pIMU9uVGhPUHAvbithMGJlZVAxbDRtdnErUFUyUXlkKzVQWTFSdXdsQXFMWUZhQmZiVGJ5UFNkZmdhSDc3QS8vUUY0ZjFPL3ZwcjZSSnlxK0M1S2MvTThGYkZ4WEl0WScuCiAgICAgJ3hPSERydmZvL2Z4TERuYnNKQnA1Qm93QlJlVldZQXphYmVUaDVBQkR3N2NXb05OTDNZWVlOdFN2NTdsbm42WitReDAxVmV1SXVCYTJEVjFIRDNINjNCQVBadTR1MVdHcGVMSHEnLgogICAgICdSaDcrTmNqQTBPKzBwNCtDTndYaWd3bmJXbFFRZHB1RXBsaStuK1BJa2NPYy8vWUt1Y2tKSkZoMksyYW5yakZ3K1FadDZTNmtQSW1JRi9iK2NxQUpEMUxpaFdBeEM2MXR3QlRvJy4KICAgICAnZlBjUUYvb0dzVlc1b3ZIUWxhdnMyLzgrdVluUlZTT1VnSEFtbUFDbEJJT0J3S0MwZ1BqaElSZ0VJWDJ3ZzdObndwWlczZDNkNHZzK3Z1OFRCTUdLNTFydlBNOWI4aGR0ZVp4ZCcuCiAgICAgJ0xCYlZSOGZlSkRzMFJsdjZHRktlWEoyMXJOUlhFU3hNUFIrQ0JVbDBuTjdQanRPK2R5ZTdVcC84djFJODhiZi9peFQvQU8xL2hac3FXK0M2QUFBQUFFbEZUa1N1UW1DQycgOwoKICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgICAgICAvLyBzdGFydGNvbnN0cmFpbi5wbmcKICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgICAgICAkdGhpcy0+aUJ1aWx0aW5JY29uWzRdWzBdPSA3MjUgOwogICAgICAgICR0aGlzLT5pQnVpbHRpbkljb25bNF1bMV09CiAgICAgJ2lWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFCWUFBQUFXQ0FZQUFBREV0R3c3QUFBQUJHZEJUVUVBQUxHUEMveGhCUUFBQUFaaVMwZEVBUDhBL3dEL29MMm5rd0FBQUFsd1NGbHonLgogICAgICdBQUFMRGdBQUN3NEJRTDdoUVFBQUFBZDBTVTFGQjlBTEVSRUlDSnA1ZkJrQUFBSlNTVVJCVkhpYzNkUzlhMU5SR01meDc3a3h0Uyt4cVM5Rkc2cDFFUjNxVkpwQlFVVWMzQ1JVJy4KICAgICAnQndVUlZMQjFFQXVLSVAwVEhKUWlpTlJKQkszaUpsMThBeWVsdFJaYTBiYmFKTWJVTm1sTlNtNWU3czI1ajBOcXBTU215YWcvT01NOVBPZHpEdWZsd244ZGp6OGdDbFZSclZFVicuCiAgICAgJ3VyNEJsMUZUTlN6THJTUzZ2Ym1sMGpVVXdTWGo4UWZrM1BrTHRMVzJBZUJJeWJtcmd6MytnRnpwdWNqbEU0ZjRidHVGVHVXdUNGNVhEcjNhM1VQZjZjTThHUXZ4emJzUkFKZGgnLgogICAgICdTY2Z4U3l3bWw1ajdtVnlwTjBlR0VKMHRlYklyZSt6eEI2VHY3alBSZVMyaFJFcE92cG1VWFUrSDVlQzkxM0puTkNTUlZFNjBwVVZiV29aanByUjM5WXE3MGJkcWo0cFc3UEVIJy4KICAgICAnNUZwdkw5ZTc5ak9UVEhNN3NzREw2Q0paMDhMYnZBR25ycFpnMm1JMlovTWxaZk44SWt4dVN3dTRWOStXSXJqN3pGbE9IZlh6S3JMSWkyU0doNUVDS2puTlZOeGtRRWM1NXZPdycuCiAgICAgJ3JiNk84SkxGZEh5SitheUZFbFVlSHZqd2tmdGVML1Y3ZktUU2tGdklRRTREb0xJMk16L211VGtUQXBjQktJd2FOOHB3SVVyS3crYWpXd0RrbkFPMGQvcjR6RmFNdVJTNjNzV20nLgogICAgICdSb09kbSt2UklyaVVZaktleHJRVit0MW8wWUVWd2ZaU1ZKbUQvZElBQkp1TzBMRzNsUkZ4MEdPZmlBRUxFOU9nQ3JmVTBYbklwNUZ3R0xFeTVXRUFPeGxSNXVOK0FSaFA3R04zJy4KICAgICAnNXc3R3Y0YlFJMit4cHQ0amp2Mm5XQm1JbGNFeEUydkRBSFlpb3N6QlpYdzZDUEU0QURvV1ZIbWQvdHV3bFpSOWVYWXlvc3pCZnBpTlFxYUFPVTUrVFhSTitEZWVlbkFEUFQ5YicuCiAgICAgJ0VWZ0tWc3V0S1BsMFRHV0dod29mb3F1YW9LSzRhcHNxL3RIL2Uva0Z3Qk1YTGdBRUtLNEFBQUFBU1VWT1JLNUNZSUk9JyA7CgogICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgICAgIC8vIGNhbGMucG5nCiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAgICAgJHRoaXMtPmlCdWlsdGluSWNvbls1XVswXT0gNTg5IDsKICAgICAgICAkdGhpcy0+aUJ1aWx0aW5JY29uWzVdWzFdPQogICAgICdpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQllBQUFBV0NBWUFBQURFdEd3N0FBQUFCR2RCVFVFQUFMR1BDL3hoQlFBQUFBWmlTMGRFQUE0QUl3QmJnTUYxMndBQUFBbHdTRmx6Jy4KICAgICAnQUFBTEVRQUFDeEVCZjJSZmtRQUFBQWQwU1UxRkI5QUhCeFFlRnNxbjB3UUFBQUhLU1VSQlZIaWNuWldmZitSQUdJZWYzVS9nY09FZ1VBZ1VDZ2NMaFlYQ3dzSEJRZUdnVURncycuCiAgICAgJ0ZnTUhCNFZBLzRCZzRYQ2hXRmdJRklxQndrSmhzUkFZZU9HRitUUUhtV1NUVGJLZDlwVTM3L3g0NWp2ZlRESVRYRXluQWJkV0tWUUIwTmF6Y1ZtMGFsY0w0ckphUlZ6bSt3L2UnLgogICAgICczaXdBa3piWVJjbm5ZZ0kwNEdDdnN4eFNQYWJZYUVkdDJSYTZEMGF0Y3Z2dkRteXJNV0JYMXpQcTJpcmNQL1RrOThEaUp0alYvZmltNnppT0NMNmRESFpOaHhRM2FySU1zb3g0Jy4KICAgICAndmVqbGVMMkF5OStqYXc2QSs0T1NJQ0cyY2FjR0toc0d4ZytDeGVxQVFTMFk3QllKdm93cTdpR01PaFhIRWZ6cHZwUWtBOWJMS2dPZ1dLdCs0TG8xbU05aHM5bTE3UU5zSjcwUCcuCiAgICAgJ0ZqYy9PNTJqb29nb1g4TVpLaUJpQUZ4ZDlaMXZjajl3ZlNwVWxEUk5NY1lReHpGcG1uSjBGUEg4bkRlMU1RYVdTejl3b1FwV1NaS0VvakRrZWFXb0tBeXIxdGx1K3M0OHdmVngnLgogICAgICd1N241aTdqdGhtR0lpRUdjVCszNlBQK2dGZUpyeFdMaGIwVUEvbGI0Z2dHczFUMHJaczB6d00vWmpOZmlsY0lZNXR1dFB4Z09XM0Y2ZFVYNDY0THJLSUxMaXcrQTdXRXJybCsyJy4KICAgICAnckFCRzFFTC9CaWxaUDhEalUydVI0VSsyRTQ5UDFaOFFKbU5YVXpsMjRBOUdCVDBJcnVDZmk4NmQ5eCtEMTJSR3p0K3BOQUFBQUFCSlJVNUVya0pnZ2c9PScgOwoKICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgICAgICAvLyBtYWcucG5nCiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAgICAgJHRoaXMtPmlCdWlsdGluSWNvbls2XVswXT0gMTQxNSA7CiAgICAgICAgJHRoaXMtPmlCdWlsdGluSWNvbls2XVsxXT0KICAgICAnaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUJZQUFBQVdDQVlBQUFERXRHdzdBQUFBQkdkQlRVRUFBTEdQQy94aEJRQUFBQVppUzBkRUFQOEEvd0Qvb0wybmt3QUFBQWx3U0ZseicuCiAgICAgJ0FBQUxEQUFBQ3d3QlAwQWl5QUFBQUFkMFNVMUZCOUFMRHhFV0RZNlVsK1VBQUFVRVNVUkJWSGljZFpWcmJGUkZHSWFmc3l5RjBuYWxWMVI2V2lnZ2FBcHRsenNyMU9nRW9nbUMnLgogICAgICcwSWdvQkFzQmdrSXJCQVBFaEJqL0FQNnhSVENVRkV3Ukk0amNnc2l0WE1yRkNKcHRKV3ZCTnBYWWJiWHRidHR0dDZlN2U4NmVjL3l4YWRsQ2ZaUEpaREl6NzN6enpqZnZSMlZMJy4KICAgICAnRjdVK2hmMEhEMkpkdUl6VEZ5NlNsSlJrUHRrY0RnZENDRTY1T3hGQzhOUFY2d2doeU03T3B0YW5rSjJkemJTQzVRZ2hFRUlnQ1NIb2c5UHBOQUYyN2RsTjZtaVp1UGdFbEI0LycuCiAgICAgJ25tWTNPN1p0QnlBMU5WVUNrR1dad2VEMWVrbEpTY0VTVGJxeHVJanJkKy94NnVJbDVNMTloU3k3bmZHT2VVeGYrZzdWalUxc0tpN0M0L0dZc2l5ejd0QUpBRDQvY1JhQTF0WlcnLgogICAgICdBSElQbkVDVVZHRDErLzNVMTllYkc0dUxlSGYxYWthbWpzSXdvVm5WQ092UUVkTG9WSUxZWW1NbzNQSXhTQkpmbHBTYURYNUZBbWp1MVFBWXYvOGsvczgrd0xWeE9VMGpSMkxaJy4KICAgICAnOHNNRkFBcFdyQ0FwYlJSRHJSWmlyQllTTEJLYW9SUFF3M1NGZXJuZjJzYXY3VDBVYnQ0S3dMNEZNd0Y0VnU4Rm9IQkNLZ0N6RGh3SHdMSWhaN3k1YTg5dTRtMkpoQTB3VGREQycuCiAgICAgJ09ycGhFakpNTkVsQ0h4S0RFamFvYm12bGZvL0tyajI3Q1FRQ0pzQ0dKVzhDMEtYcUFNeE1pb3NRQThoWldjVEZ4OU9zYW5pREtoMXFtRzdWb0ZzTDB4MEswNmtiZUFNaFdwUmUnLgogICAgICcvS3BHK2d3SEFLVW56N0R6M0JVTXc2REsxOG51dzk5d3QwTmg2VmRISThSSmljbUVUUWdGZzdTRndqU3JHditvS3A2Z2hsZFY2ZFowdWdKQmxGNkZtQ0VTUTJ3MkFJcVhMc2FuJy4KICAgICAnQnJGWUxKVG5UQ0JyZEJxdmVlb3BXWmlQRmFCSFVlZ0poZWdNcUdneEVrSER3Qi9VYVE5cmRJVjA2djArVEQyRUVRalFGdEFZMGRzTmdOdnQ1c2lhbFFBSUlYaDd3UUt1VmY2SicuCiAgICAgJ2dUc1NjY1BEV2xRc3RDbEJHanI5ZUhwVld2VVFuY0V3ZFlFZWRGOG5vUTR2bVltcFpNVEgwblR2RG4yNXZMYnJObXU3YnZmbnNZRWJBTW5oY1BEZ3dRUHpVbzJMSnVzdy9taHAnLgogICAgICdRd2xITk8wS0JBbm9JZnh0cmNRTVQyRGUxTW04OTF3eVV6TmxVbEpTcEl5TURCb2JHemx6cjVyRk0vS29xNnZyUDhBU0d4c0x3UG1LY3ZJU2hqUEdaaVBPYWtFM1ZGQjhoSHdkJy4KICAgICAndkpBeGhyazVMN0x5K1JRdUgvc1dnUGRYcndGZy82SERGQlVzSWowOW5laGZiQVd3UFdPVDluNVJZaHFHd2FyTld4a1JNNVRSQ2ZGNFUxUFFzRERKRms5dVlod1h2enZLam0zYicuCiAgICAgJ0tTc3JvM0RKSW5OVzVSWHA3dTJiQUtTbHBlSDFlc25QejZlcXFncUxwbW1jcjNGaHQ5dWxmYVY3bVprMUJzK2xNNlQxZGpNOWZoZzVlZ0RQcFROTXk1VFpzVzA3a3lkUFlkV00nLgogICAgICdhWHg5Nml4T3A5TzhjZlVhODBzcm1EcGpPZ0F1bHl0aVFxWnBNbnZPYkxidC9KVHRIeFhqOS90UlZkVTBER09BdWZScGV2UERUZWFjMGhKeWMzTnhPT2F3ZnYxNjFsVldTNmVYJy4KICAgICAneis5L1VPQ3h1MVZXVnZhVFJHdjE2TkZmakIyYk5lQVFwOU5wVHBtU000RGNicmRMMFdzR0RLTFJSKzUydXdlMXlQOGpiMmxwWWZpa3lZOXQ4MG4wM1VDV1plYVhWancxZit6cycuCiAgICAgJ09lbisvZCtwcWFuaHpwMmZLU3NydytsMG1pNlhpeVBsNVpHSVRkTjhmQVZKd2pSTkpFbWkxcWZ3MWt3N3NpeVRuSnhNZTNzNzFkWFYzR3BvWk82NERHNDFOUEp5bHZ4VTVEL2UnLgogICAgICdxSktzZldRRDlJa2FaMlJtVXZyOWFWNGFHWWNRZ2pmTzNhV29ZQkY1ZVhtNGV3SXN1L0NiZFB6MWFXYjAvcDFiTm9PclF4bFVpdWlhRm8zYzNGeUVFT3g5K0M5Q0NENnBhYVRXJy4KICAgICAncC9UWHlZa1RKMFhlNTlqZjdRT3lBS0RXcC9RWHhjRlE2MVA0cFQzU2hCQmN2blVISVFUanhtWDE5LzhCQ2VWZysvR1Bwc2tBQUFBQVNVVk9SSzVDWUlJPScgOwoKICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgICAgICAvLyBsb2NrLnBuZwogICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgICAgICR0aGlzLT5pQnVpbHRpbkljb25bN11bMF09IDk2MyA7CiAgICAgICAgJHRoaXMtPmlCdWlsdGluSWNvbls3XVsxXT0KICAgICAnaVZCT1J3MEtHZ29BQUFBTlNVaEVVZ0FBQUJZQUFBQVdDQVlBQUFERXRHdzdBQUFBQkdkQlRVRUFBTEdQQy94aEJRQUFBQVppUzBkRUFBQUFBQUFBK1VPN2Z3QUFBQWx3U0ZseicuCiAgICAgJ0FBQUxDd0FBQ3dzQmJRU0V0d0FBQUFkMFNVMUZCOUFLQXcwWERtd01Pd0lBQUFOQVNVUkJWSGljN1pYZlMxdDNHTVkvMytQcHJJN2Fpc3ZvMllVNmg2QVRBOEpXNHJybHNGNFUnLgogICAgICdxaUFzRjltaGwwTjJjWVRSeTlHL3dwdEFZV1BEOWlKdFJ5NWFzRGU3Y1lGbXlqYVhPTGFNSW1Pcm1rUnJqTDl5VG1JUzMxMjBKeWJXUWdmYjNSNzR3dWM4THp3ODU4dkxPVXBFJy4KICAgICAnT0s2cHFTbTJ0cmJZMzkrbnU3dGJQSFljaDdtNU9jTGhNSUE2N2tXajBhTVFFV2s2dG0xN3JObTJMU0lpZTN0N2tzdmxKSjFPU3lxVmtsczNaOFN5TE1ubGNxVFRhVktwRkxkdScuCiAgICAgJ3ptQlpWajFIZVkyVlV0aTJUU1FTUVNtbDJiWmRpMFFpcksydE1UMDl6ZXJxS3Rsc2xxR2hJU1luSjRuSHYyTitmb0ZzTnF1T2U5Rm90TGx4T0J3bWs4bGdXUmJoY0ZneW1ZeFknLgogICAgICdsaVVpMG1xYUpvQXVJaTJtYWNyZE83ZkZzaXp4M3RvMFRlN2V1VjF2clh0WEVncUZtSm1aWVdWbGhYSzVMQjQvVTlrd0RMNzg0a1lWMEEzRFlIZDNtNHNYUnltWHl3S29SaThVJy4KICAgICAnQ2gwMURnUUNKQklKTE1zaUVBaElJcEh3MnVMeitlcXRZckVZSXFLWnBpbXhXRXlDd2FDTWpZMDF6WVBCSUpwWHFWUXFzYnk4VExWYWJXS0EvdjUrUmtaR01BeURycTR1bEZLSCcuCiAgICAgJ0hzZmpjV1puWituczdLVFJxd2NuazBtS3hTS0ZRcUdKbFZLdHJ1dVNUQ1lCNk8zdHJXOVVJL3Y5L2laUEIvajhzMkhPblgwRmdIZmVYcGVmZm56SytmV2YrZmlqdmhMczBQdEcnLgogICAgICdEL24xT0o5K01zcmxTd2IzNzMzRHdNQ0F0MUV5UGo2dUFDWW1KcDU2MTY4TlU2blVxRlNFOW5aZFBFNytXcUMvcjROS1RhZ2NDSlZxRGFVVUI1VkRBQTRQYTl4N3NNTGxTd2FuJy4KICAgICAnV2pSbXYxM0Q3L2VycGFXbG82MDRxT3A4OE9GN0xDNDhyUE5vc01xNVRoK0RneGQ0L1h5QTFyYnpBRGk3ajhqbmYyUCsrd2RjdlNyOE1KL2k4ZW9tQUtsVXFuNDFPc0RBUURlRCcuCiAgICAgJ2crK3l1UEN3em0vMnZVOCtuMmE3c01GZmo3OW1wN0JCdVZ6aW9GU2lYSEp4M1NLdVcyUnp5MFVwOWR4blFWdk9EQUxRZXJxTlJuNFpLZTBNdnRjNlRwenBtcWJ4YWxjWTlBdG8nLgogICAgICcydjA2dDUxNUM3M1lRZnRaQjlHTG5EcnQ0TG91anVQZ09BNFVpK0M2eU9wWEp3WnJKN3IvZ3Y0UC91K0Q5VzdmTHhUeisxU2NReHJaM2F0UkxhVnhkamJZMmQxODRSNi9zTEhlJy4KICAgICAnb3BIUDcvRG85MFVhK1dXVXllenpaSE9iUC83Y2ZYNTQvZG93RTFkNjZzOFRWM29FK01mbitML3piNFhtSFBqUkc5WWpBQUFBQUVsRlRrU3VRbUNDJyA7CgogICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgICAgIC8vIHN0b3AucG5nCiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAgICAgJHRoaXMtPmlCdWlsdGluSWNvbls4XVswXT0gODg5IDsKICAgICAgICAkdGhpcy0+aUJ1aWx0aW5JY29uWzhdWzFdPQogICAgICdpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQllBQUFBV0NBWUFBQURFdEd3N0FBQUFCR2RCVFVFQUFMR1BDL3hoQlFBQUFBWmlTMGRFQUFBQUFBQUErVU83ZndBQUFBbHdTRmx6Jy4KICAgICAnQUFBTER3QUFDdzhCa3ZrRHBRQUFBQWQwU1UxRkI5QUpEd0V2TnlENk0vMEFBQUwyU1VSQlZIaWMxWlRMYXhWbkdJZWZiMmJPNU9TY0hKTjRvV3JGTnFjVUpZb1VFZ1UzL1FmNicuCiAgICAgJ0Y3Z3dDa0lydmRCTFV0cXFpTGhTZzliZ0JkdUZTSFpkaUc1Y3RrSjN4UkRiVUZ3VW1naE56QkRhblBHTWt6T1g3OUxGSkdQTU9TZDIwNFUvK0JienZkLzc4RjRIL2llSmRvYWQnLgogICAgICdwWkt4UkZzekFJL0RjUDBIYXpYWTIyditIQjAxa2VlMVBBL3YzemZuang0eGdHbkhjTlplN092dU5qK2NPRUYxWkFUdjVuVUE0amhCU2dtQURDVldvOEdlMk9mOXdiMThQL0c3Jy4KICAgICAnb1VYbVlpMzB6cWxUVkVkR1dMaDFnMkQ2TVlsS2tYR0UwVmw4YWEyR0VCMTQ5KzR4WFN6eW9PSXcvbWltaVpWL0RQYjI1cEZPajEzQTlnT01FQ2hoVUVxaFZZcVdLVWs5UUFVcCcuCiAgICAgJ3NUL1A0czhQbUtsVW1OaFFhSUpia0RWcUJicHc2d1oyelVjNE5tK2VQa3U1cDRlT3JncHVlUU9GVW9WQ1Z4Y0Q0K04wN2RwRjkrNXRWSmVXR1BCamh2cjdXRjF6QzhBU2d0Y1AnLgogICAgICdIOGE3ZVoxb2RoNHNoNTBuendDdzlaTmgzTTRTdHV0aXUwWDJuQi9MeWpaNmxjSWJWVHBkUVUvaldWUHpMQURNOCtaR0JSZHRDN3dyRi9PN2JSOTlpdTI2Vkw4NmlVNFNBSDRiJy4KICAgICAnUG81ZDZBUWhzdE1Tdkd5STR3UzVGSkJLU1J3bnpGOGJ5eC91K1BqenpNRjFtZnJ5UTFLL2puQ2FocXAxeEVvcGpGTG9ORUZKU1JKSHpGNzk5Z1dIcWErL1FLY1NVWEJJNjA5ZicuCiAgICAgJ0FsNVc0dGVRU2lIRE9pcE5VS25NSTEzUnZuT1hBSUVLUWl4dkdXeWE5OFNDNTYwTUZ3UGlxRUc4NkpNOHE3OVEwNmx2aG5PbmR5NS9CNkdQQ1VPTVV1M0JRZ2c4ejBNM0dtQlonLgogICAgICdpR0puM3YyVm1zcW5mek54N0ZEdWVPRHVqOFJPQ0ZwanRHNVRDbU9ZdjMyYkowOW1zUDBJU3lkTWZuQVVnRjgvTzQ1UkFBNldUUGpsdlhjQitHbjdGdVJmL3pBbk5YNngzQVJlJy4KICAgICAnUFNkbXFMK1AvWUhrd01HRE9HV0RaVGxRY05CUmhQRUNvbWdCL1llSGZxMkluRjFrTGxYVU9rcE1iaW8xYmQ3YUFUUkQvWDBNMWxQZVNsTTJ2dDJYMVhCWmpabnBMRzJ0bVpPNicuCiAgICAgJ0xiUVZPSWNQK0hHMlVhdUgzeGd3QnFPejlDYzNsMXRDMjRGeitNdlVEcm9lR05iNWlmOUgvMWRNL3dMUENZTXc5ZnJ5S2dBQUFBQkpSVTVFcmtKZ2dnPT0nIDsKCiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAgICAgLy8gZXJyb3IucG5nCiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAgICAgJHRoaXMtPmlCdWlsdGluSWNvbls5XVswXT0gNTQxIDsKICAgICAgICAkdGhpcy0+aUJ1aWx0aW5JY29uWzldWzFdPQogICAgICdpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQ2dBQUFBb0NBTUFBQUM3SUVoZkFBQUFhVkJNVkVYLy8vLy8vMlh5OG1MbDVWL1oyVnZNekZpL3YxV3lzbEtscFUrWm1VeU1qRWgvJy4KICAgICAnZjBWeWNrSmxaVDlZV0R4TVREakF3TUR5OHNMbDViblkySy9NektXL3Y1eXlzcEtscFlpWW1IK01qSFkvUHpWL2YyeHljbUpsWlZsWldVOU1URVhZMk1zL1B6d3lNakxGVGplYScuCiAgICAgJ0FBQUFBWFJTVGxNQVFPYllaZ0FBQUFGaVMwZEVBSWdGSFVnQUFBQUpjRWhaY3dBQUN4SUFBQXNTQWRMZGZ2d0FBQUFIZEVsTlJRZlRDQWtVTVNqOXdXU09BQUFCTFVsRVFWUjQnLgogICAgICcyczJVM1pLQ01BeEdqZnpKYW5GQVhGa1VsZS85SDlKVUtBMWdLVE43WXk2WU1qbCtrTlBLNXJsWlZTdXhmMVpSbmxaeEZZQW05M05uSUt2UitNRUhVZ3FCWHg5M3daR0lVclNlJy4KICAgICAnaCtjdEVnYnBpTW8zaVE0a2lvSENHeGlyL1pZVWJyN0FnUFhzOWJYMEJDWU04dk4vY1BlOG9RWXpvbTN0VnNTQk1WSEVvT0o1ZG01RjFSc0llOUN0cUdnUmFjQ0FrVXZSdGV2VCcuCiAgICAgJ2UycGQ2dk9XRitnQ3VjL2JyY3VoeUFSYWtCVTlGZ0s1YlVCV2RIRUg4dEhwRHNablJUWlFHemRMVnZRM0N6eVlaaVRBbVNJT0RFd3pGQ0FkSm9wdXZicGVaRGlzSjRwS0VjakQnLgogICAgICdpaldQSmhVMU1qQ285ZGtZZmlVVmpRTlRES1k2Q1ZiUjZBMG5pVVNaalJ3RmFuUjBsOWkvVHl2R25GZHF3U3RxNWF4TWZEYnlCa3NsZC9GVXVtdnhTL0JkOVZ5SnZRRFdpaU14Jy4KICAgICAnaU9zQ0hnQUFBQUJKUlU1RXJrSmdnZz09JyA7CgogICAgICAgIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgICAgIC8vIG9wZW5mb2xkZXIucG5nCiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAgICAgJHRoaXMtPmlCdWlsdGluSWNvblsxMF1bMF09IDIwNDAgOwogICAgICAgICR0aGlzLT5pQnVpbHRpbkljb25bMTBdWzFdPQogICAgICdpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQ0FBQUFBZ0NBWUFBQUJ6ZW5yMEFBQUFCR2RCVFVFQUFMR1BDL3hoQlFBQUFBWmlTMGRFQU5BQXR3Q2xGaHQ3MUFBQUFBbHdTRmx6Jy4KICAgICAnQUFBTEVBQUFDeEFCclNPOWRRQUFBQWQwU1UxRkI5QUtEUTRSSVhNZWFMY0FBQWQxU1VSQlZIaWN4WmQ3akJYVkhjYy81OHpjdlROekg4dnVzcXc4RnNUc0tpQ1VVaDVXQlpYRycuCiAgICAgJ0drT3B0bXF3TldzV0xLWEZHbEVwelpJMEFXTktTeTBXaERTMjJnSkt0V2xUc1NScXpZSXVMR0IyV1Z2REl3UU1aUU1zeTJPRmZkemRlKy9PbkhQNng5MDd2SmFGcGpiOUpaTTUnLgogICAgICdjODVNZnAvZjkvczdKeG40UDRlNDFndFN5cDc4V0d2dGZkRUFjcURGWVVPSDlIUzBOaEdrOXRQYi9pbFN5cDc4OVVVQjJBTXVxaFF5M1V6bTdIR2tFNlczZFROWk1SSTNFY1dPJy4KICAgICAnamY5Q2xMbVdCVDNkelc4alVzZXZXSENHM1VwV2wrSWtIU3huYkRoL01jejEyTmV2QmN1V1hUbWY2VGpuWHZKODhnRG1WQjNwdzMrbnQzVXpIYTFOcU16QlMyenFQTEdGanRNTicuCiAgICAgJ1pOcjNYZFcrcXlxd1pjRms3NkhYL3RIV2Z1UXZ5TzRXN3FoYUh3TDhlZmtNUmxSVXBQdjdycUQwUnJKK0ZnQWpMeTFhMjBPSXhaSkVFdU5DUmZJQXBqK29tNGJHTTN1Mi9zWVUnLgogICAgICc5SjQxZDg5NzNmM0RoZzFwSVNUVjFkWFhCUk5KeFBHRkN6aG91K0RDUXJTY1pPa2t0TmFlRFpqYW1nZVo5TWdpWW1WRGNjdkhoakF6SncwTlRoOC9hbHlaTWFWSmljcDBpVEhqJy4KICAgICAnSnBnTnYzOHRqV1VoaEdST2RiVUw5VzUvTUg1WENramxjaWJpK0tJb3A1TFZITEtFdThBL2Y0cjI4NmRvYTlwR3JHd1lBQXNmcWJiSDNiOE1nTy9OcWd5Nld2ZGJiWEhNa0VGSicuCiAgICAgJzR4VU9NVkV2YVRadTNCZ212RjRZazRoejlyTy9VbHI1Y0U5b3dhZS9yY0d4b2hTT3VpV2tDMklqY0lxS3lQWm0rT21DSDdHaG9aRUYwNzdFRXpWVndlQWJKK3JpRWVPMEV5OHknLgogICAgICdVdWJxT0huMEFPZ013dmY1OXR4bkJyU3A5ZGd4S21mLytrSVAxTlk4U0ZrMGpoNWFqbU5IQVdnNWIyRTVFZXhvakdIamJpVlJNb1JNTnMwTEMrWXo0NnZUdUgzZW5ON0JJOGZyJy4KICAgICAncUZkbzBCb1ZaTkM5YVZTUTRmTmpCekVtUUppQVJ4YisvQXFZUE1BVkI1RnNQVTV2MzdnOU94Z0xoZTE0Wk01L2p1MDUyRTZNTlp2ZjVwbUhIdUxtbVdPa0V5c3hVdHBHQXRtZScuCiAgICAgJ2R0SFRmbEprZXpxUXRvM2pGUm5Mc3N5ZjFqeWR4aWlNN3pObnllL2MzWnNxTHUyQk41ZmNNZnpydi9oYnkxdFB6bVJVb2loY1RKODdDd1FJMnlMdERjSXFzSWpZVWY1MXFCbGYnLgogICAgICdPblNjT1NyZFFVT01VUmtpWHNMVXpKbnZiR2hvQkdESEg1Y0d5WkxoT3BZb05sNWhxWW5ZRVhPdTVmRGw5ZVlBSG50eDk4bjhoRkhaY1BIVXVUU3hTQVNBZUsvQ0dJT3hKSjBmJy4KICAgICAnYk9HTlBVMjgwZGdrcTZZMnl1OHZmakNJbHd3enIrL1pRL1BITzBnT0x1TzVxc2Z0RFEyTmJOKzRPQ2dxRzZXVHhXVmFxNnpwRitEaVNIV25pY2R5bHAzcjZhWlRXdGhJT3JOcCcuCiAgICAgJ2t0SGN2QnUwc0hYMVNtNm96QjNCNDJkOTB6WkE5YlFwN1B2Z1BTelhaZm5xWC9IUzRES0tLMit4NjlZL0hVUnMyNmlCQU41Y2NzZnc3Nzc0VWN1bUYzN0M2ZjA3S1N0Mk9IamknLgogICAgICdERVVKRDB0SVNqeVByclNQbEFLdk4wSlAvVTRPMU5manVoRzJydmtsTjFTT3BmWHdmdHBiVHFBeUtScmZmNWZiN3JzOVYxUjdtNHdsejJpaEEzSHBtWGZsVVd5T0gydW1wTGlZJy4KICAgICAndWkzdjhNKzZiV3pmc1JOYlNncWt4YUNraXkwc2ltTXVFV0VocGNSekloUVdPSUFoNnRpQXdTNG93SW5GaVRvdTVkT25NbmwyTlIrK3VqQndYRWM5dGVyRDZNNDNucmo2TGdBQicuCiAgICAgJ1FuRFBBOS9pcnRrUDhKUlM3SHIvM1Q2WWVrRFExcEVpRVhPd3BVVkp6Q1ZsWlpGUzRtWnRrcEVvOUNoQWtEcC9qdExNQkFDeTZTNFJpUWdoTHl2NWNnQlJQbktVT1g2c21VR0YnLgogICAgICdoU2lsME1ZdzlkNzdtUHkxZTVtbkZFM2JhdG0zY3p2YjZuWWdFSnp0U0ZHVTlMQ1JsTVJkVWpJSDArbG5FTUl3UE5YRDNOdW1vVkpuck1DSmFpY2lNVVpmdlFuejRRY0JTdlYxJy4KICAgICAndmpFNUdLMzU4dDB6bVhEbkRCNzlzYUxwbzIwYythU1JEK3QyNUpUcDdHWlF3c0VXRmlWeGw2aGxVZi9XTzl6MzJDeG1MMXJPZTZ1L0kyS3V3R2h6TFFDQjcvc1lZOUJhaDNlbCcuCiAgICAgJ0ZLYnZyclZtNHZTN0dILzduY3grY2hFSEd6N215Q2VOYlB0b08wSkkyanE3OFdJUkxHa3pzcXM3VjVTZkZWNUVvdlhBQ29pcXFzZk5wazJ2bzVWQ1d0WUZCZm9VMFZvVEJBRmEnLgogICAgICdhN1RSYUsycCtNb1VSaytjeE16cStSemJ2NDlERGJ1bzI3VVRXOWgwZGVkc3NQeHVLK2tJZk44WHhoZ0RZUFZYZjJGaDRYS3RGSWw0QWlrbEFsQktBWVJLS0szNndISXdlVEN0Jy4KICAgICAnTmZIaUVrYU9uOGowKzcvQm1ERmphVDMwR2JIeXdTeGN1WmtwRmZGZyttMWpqWi9ObW5Wdk5mUnZ3ZDY5ZThXQkEvdU5GQUloNEpWWFhtSHNtREhFNHZFUVFnalEybHhRSW05TicuCiAgICAgJ256MzVxM0JFT1pPSHphRzJ0aGFBNG1SVStMMjlJdCtJVjIxQ3BiUlFmZU1GQzM1Z1JCL00yclZydWJueVptTHhXSmhFQ0JFbXovZUh5by83bE1sSDNMRkZ1anN0aE5GQ0NHT3UnLgogICAgICcrV055ZVVncGpTVnpNS3RXcmFLeXNoTFBkY1BFZVlXQ0lFQmRwSXhTaXZyNmV0YTh2STdkNitjR25oZFYwNnBlMVFQK0YvUVhXbXVSTCtqWlo1OExsVm14WWdVVkZSVjRyaHR1Jy4KICAgICAnNFR6TXhYQUE2WFJhUkF0c1lVa3g4SS9KdFNKUU9sU3dwbVpwQ0xOOCtmUGNkTk5vSE1mQjkvMFFKZ1JvUDI5NVRsUjdVVnY4eHhaY0hNdVdJWjkvSG4zNXZHM0pFR1pwelZKRycuCiAgICAgJ2p4NU4xSWxpdEthaHNaRTFMNjlqNjlxSGd4K3VyRlgvbFFMOUpZZExsZm5aaWhVaHpPTEZpOE4zTWwxZHRoT3hWSC9mLzgvQ3RxU0oySmFKMkpaNTlKN1JQc0MvQVZpSnNRUy8nLgogICAgICdkQm50QUFBQUFFbEZUa1N1UW1DQycgOwoKICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgICAgICAvLyBmb2xkZXIucG5nCiAgICAgICAgLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAgICAgJHRoaXMtPmlCdWlsdGluSWNvblsxMV1bMF09IDE4MjQgOwogICAgICAgICR0aGlzLT5pQnVpbHRpbkljb25bMTFdWzFdPQogICAgICdpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBQ0lBQUFBaUNBWUFBQUE2Und2Q0FBQUFCR2RCVFVFQUFMR1BDL3hoQlFBQUFBWmlTMGRFQUFBQUFBQUErVU83ZndBQUFBbHdTRmx6Jy4KICAgICAnQUFBTEVBQUFDeEFCclNPOWRRQUFBQWQwU1UxRkI5RUNBUWdGRnlkOWNSVUFBQWFkU1VSQlZIaWN6ZGh2YkJQM0hjZng5LzJ4ZmVmRU9BNUpvQ05ObklUOEFkdFptWUJFVEpzSScuCiAgICAgJzYralFPbFFpaFQxQVlneXRxelpwRDFhdGZ5WXFsVDFoMGxScFQ3YVJKNE5RcFJ2WkdFTFZ1bzVVYTlqRUpESUVUUXNOUXlQQnNVSk1XR1Buai8vZStlNzJ3Tmc0eEVsTVI2ZWQnLgogICAgICdaTmxuMzkzM2RaL2Y5M2Y2eWZCL3NnbXJIZERWMVdYbFBnOE5EWlVEU2NEOExGRkZFWlpsV1laaFdNRmcwT3JxNnNxL2dESkFmRnkxaWlaeTlPanJWbmo0SnpRMXJNV3FmeG0vJy4KICAgICAnMzA5all5TnRiVzBrRWdudTNidkg0Y09IODhjL2pxU0tRbDQvWEdrZCtlVnRBTjQ2dXAxTEg5Mmt0cVlTKytaWDhQdjlORFEwc0duVEpsS3BGT0Z3bU83dTd2eTVJeU1qZVZSZCcuCiAgICAgJ1hWMStXRU9oMElyWTRwRG5xNndYWC9zVGlDSmFNa0ZaZFJOcXhlZm9lN1Z0Q1NxWFZEcWRabloybHRyYVdrelRwS3FxaWp0M0pwRmxHN2R2ajdOeloxZisrcUZReUEzRUNsSEwnLgogICAgICdRbDc0M25Ga2h4UER0SkFkNWVUYVlTVlVmWDA5bFpXVmxKV1ZJVW5TZzdzVlFNQkNVY3U0Y2VNR2UvYnNJUlFLMVFBek9jeXlrSU05UDBLeXVkQXlDV3lxRzhuaHdxYTRTa0x0Jy4KICAgICAnM3IwYlZWVnh1OTI0WEM0MFRVT1daVVF4ZTk3Q3dnSWRIUjJMTUhJeFNDYVZJblZ2RkVseEUwdk1ZMVBkMk5VS0pNV05UWEhsVWZGLy80dkVUSkNlbHdicEZtM01qUDJkdDM3eCcuCiAgICAgJ0FsTitQelUxTlZpV1JTd1c0KzdkdTNnOEhqd2VENHFpNUVGQUp6QUV4SXBDQU5ib294aHBsZkIwRkp2VGc2eFdJcXNWUlZGNk1vcGtVM0ZYUGNua0p4R1UwVkVBZEYybm9xS0MnLgogICAgICdXMy84RHBucUxqemVwMmx1YnNibGNqRThQRXhIUjhmYm9WRElEOXhZRnBMQkRwSkYwakRRSW5jUXBXbGttMzFGbEZMdHA5UGZ5dVcvdllRajFrUFN1UlcvMzgrbGoyN1MyUTd2Jy4KICAgICAnL2FXWFVCVlVmZlZOdG0zYmxpdlZDRXdzQzVFeWM1aWlBcEVwREVBWE1xUWRsZGhTaVdWUUhqSmFndWQrOEZ1ZXhjay96ditLODJkZm9TYlNDc0RlNzUva20rNEdWUGQ2K2w1dCcuCiAgICAgJzR6SkhjcVZVWU4yeUVFdFpRRENTSkN1ZVJBWXNQWTQ5SHNGSVpWRzZwMjVKVXVtRmFmVDRES0pONGFtdFQ3TnozOHNrNSs1QTcwSE10RVl5TWtGaVpoeHpqUS9wb1hyTFFyUlUnLgogICAgICdERkdFZUZwQWxrUWttNHBSaUNwSUtvZEt6azBULzJRTWgrcGlQanhLWlB3aVNrVXR1L2I5bU5uSkVXUzdFOG5oQW12cE02MG9KRGtYSnhxTm96eFJSVXhQSWVzaXNwQkJsc1hWJy4KICAgICAnVWFLRUZvOGd6b2FKaHo4czJsT21ycFVHK1dCaEo5LzYwZytaK2ZEWFRBWGZ4bGxSamwxVmtPME9GQVRzWWhZbGlpSzIxWktLaGhIbkZ2ZVVxU2RLZ3dBRU9wN0YydjUxdnZ3OCcuCiAgICAgJ1hINy9OMXdkL0JsVHdldVVWNjVCZHRnZm9MVFNraXBzZEQzdFJpMFZZcG9tbVV3R3d6RHdkVDVIWUVjM2dpQXdjdkgzakx6M0JsUEI2N2pXZVpCRUtZc1NCV3dwSFp0TktvNHEnLgogICAgICdhSFREc0plZWlHRVlXSmFGWlZtWXBvbW1hUmlHUWRQbnYwYmIxbThnU1JML3ZQSU9WOTc5YVI0bG1BSjJwNHFDZ0N4a3NOdUtKNlZOcHg0TlloZ0dwbWt1UWhtR1FUcWR4akFNJy4KICAgICAncXIyZDdIdHhFRUVRdUgxdGtLdnZ2a0Y0NHRxRG5ySWNLSktBUGYxZytMQVVFbHE4ZElpdTYwc0FwbW5tOTNQZnpjN09ZaGdHcmllK3dGZSsrenRjTGhjVDF3ZjU0UHpQQ1U5YycuCiAgICAgJ3c3WFdqV1MzSWRzZE9BVUJXWkF4clJKblRRNlNHNWJjZTJGQ3Bta3VnaG1HUVNxVlltNXVEdG5qNDRzSDM4VHRkaFA2K0R3Zi8vVjR0dEhYcmtHVVJaSmFpYzhSZ0hRNmpXbWEnLgogICAgICdTSktVTDVSTEtOZklPY3pES0YzWFNTYVRSQ0lSaExKV250cDNuR2ZXclNNeGM1T0xmM2lOUDQrNjhUOVViOW5GNzZsVHB4Z2ZIeWNhalpKS3BkQTBMWjlHYmpZVjdoY0RXWmFGJy4KICAgICAncG1uTXo4OFRpOFVZdW5TTG11MUhGaTJhVmt4a2FHaklOVFkydHREYjI0dlg2K1hRb1VOczNyeVo4dkp5SUR1MUJVRllra3hoZ3hlaVdscGFPSFBtREUxTlRkVFgxeGU5OGVXRycuCiAgICAgJ0puRi85ZFFaQ29YVVlEQTRBT0QxZWpsdzRBQ3RyYTJVbDVmbml3bUNrRWNVSmlVSUFvRkFnTDYrUG53K0gyMXRiZlQzOXo4U3hDUzdoSHNmV0g5LzhkTDRNS3FucDRlV2xoYWMnLgogICAgICdUbWNla0V2TU5FMmFtNXM1Y2VJRWdVQ0E5dloyVHA0OGljL25ZM2o0VXNtUUhDWU9qSkh0cGVCS3FMMTc5OUxjM0l6VDZVVFhkUm9iR3hrWUdLQzl2WjNXMXRaOEtvODZOSjhhJy4KICAgICAndFhIalJvNGRPOGJwMDZmWnNtVUxHelpzb0wrL24wQWdnTmZyNWV6WnMvOFZwR1RVNU9Ta2MvLysvYWNCZkQ0ZjFkWFY3TnExaTRhR0JzNmRPNGZQNStQcTFTdVBCYklpeWpUTicuCiAgICAgJ1JVblYxZFVOWExod0FhL1h5NDRkTzRqRllnQkVvOUZGRjFyMTM0QlB1WWxrMTZMckFZWHNBbG10cTZzYktEd29GQXA5bSt5a3VQNVpRVlpGM2Y4dENkd0NvdjhMeUhJb0FBTkknLgogICAgICdBWGYvQTFUSTBYQ0RoN09XQUFBQUFFbEZUa1N1UW1DQycgOwoKICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgICAgICAvLyBmaWxlX2ltcG9ydGFudC5wbmcKICAgICAgICAvLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KICAgICAgICAkdGhpcy0+aUJ1aWx0aW5JY29uWzEyXVswXT0gMTc4NSA7CiAgICAgICAgJHRoaXMtPmlCdWlsdGluSWNvblsxMl1bMV09CiAgICAgJ2lWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFDSUFBQUFpQ0FZQUFBQTZSd3ZDQUFBQUJHZEJUVUVBQUxHUEMveGhCUUFBQUFaaVMwZEVBQUFBQUFBQStVTzdmd0FBQUFsd1NGbHonLgogICAgICdBQUFMRHdBQUN3OEJrdmtEcFFBQUFBZDBTVTFGQjlFQ0RBY2pEZUQzbEtzQUFBWjJTVVJCVkhpY3JaaFBhRnpISGNjLzg5N3M3bHV0SkNzcjJWSHNPSFdNazBNUGJzQlVyY25GJy4KICAgICAnT0ZSZFNvNkZOaGRCNlNHSGxwRG1ZdEpDRHlveHlLZTZFQnhLUWt0N0tLTDBUNkFCbzBOYmNpcWlndEM2UGhXS0kyTkZxcXhkU2Q3VjIvZG1mdFBEdlBkMjEydDU1ZENCWWZiTicuCiAgICAgJ3pwdmZaNzd6Ky8xbWRoVWp5dFdyVjkzSGYvMjRlRDV6OWd3aU1sRGpPS2JiN2RMdGRoRVIydTAydTd1NzNMcDFDeEVaQnc0QWVad2ROUXFrTWQ5d2J6aUZHSU5KVXQ2clJiejUnLgogICAgICcxcHRVcTFYSzVUSkJFQUFVTUh0N2UrenU3Z0t3dkx6TXlzb0t3QW5nL3VOZzlDZ1FnRktsZ2cxRFVKNjdWcXR4NnRRcFptZG5pYUlJcFJUT09aUlNkRG9kZG5aMmFMZmJMQzh2Jy4KICAgICAnczdTMHhKVXJWN1pHd1FTajFQaGhmUm9kVmREbE1ycGM1dnVwNVoyZnZNUGR1M2ZaMjl2RFdqdnd6dGpZR1BWNm5WcXRScVZTNGRLbFN5d3RMUUZzQWRPSDJYd3NDRUFwZzNqbCcuCiAgICAgJ3c5OFJhazJndllqTlpwTm1zMG1TSkRqbkhna0RNRGMzZHlTWVEwRWE4dzEzOVlVWDBPVUt1bHp5ZzdVbUNFTytsMWh1dkh1RHJhMHQ5dmYzaDFUSllTcVZ5cEZoSHF1SXJsUUknLgogICAgICdTNXF2L3VJREFDNy80YmNFUVlBS3ZLKzBXcTFEVlFHSW9vZzdkKzRjQ2VhUklJMzVocnQrOFNzRU9rUmxVYUV5UjBVcEZJclhIeHlNVktWVUtuSHYzcjBqd1J3YU5lbEJqQmpMJy4KICAgICAnU3ovN0tZdUxpd0FzTGk3eTR6LzlrWTllK1Rwa0N1U3FqSStQbzdYdUFXZUtYTHQyRFdOTVVaTWt3UmpEaFFzWFdGdGJLNkpwQ0NUM2pmUWd4b21QdFBYMTlZSFdpY001eDNjMicuCiAgICAgJzczUGozUnU4L2FPM21acWFvbEtwb0hWdnl1dlhyL1BwbmYvUTd1enozODBOUHR1NHkvcW5HK3p0ZDFoZlgyZHRiUTNnSXZEblJ5cVN4bDFVb1BqeXo5OEQ0UFRwMHdQdHEzOVonLgogICAgICc0ZmR6THhlZ3JWYUxWcXZGNU9Ra1lSZ1dxcFJLSlo3N3d2TnNiVzFSRzV0Z2ZLTE9USDJHN1oxdHdxQlFyZ3JNRHZoSW5qZlNPQ1k1aUl2K2hZV0ZnUlpBckVXc1pXRjk0MUJmJy4KICAgICAnU2RNVWdNbkpDV3BqVlU0Y24rSFV5ZVBNMUdjNCtmUlVQa3pCSTV3MWpidWtjY3pMdi81bDBYZm16Sm1CRnVDYmEzOHIvQ1JYcFQrQ3JEVW9aMGpqQjRSWW9uSkFPWVJvYkpLVCcuCiAgICAgJ3o1emdxZnF4QWJzRlNINm1wSEZNMnFkR1hoNFZub1ZpRDZtU0pGMmNUUWVxRHFCYUtWSFdtb25KQ1dwWmpoa0M2YW5SNVdzZmZUZ3dhSFYxRmFVVXE2dXJBLzJ2M2Y1azRMblYnLgogICAgICdhckc5dFVuM29JMllCQ2NXSFlBeE1WWXMxcVpFWlkyU0ZCMmFZWkRHZk1OOWQ3dUppV1BTZUZpTm81UmNsYzNOVFhaYk82UnBGN0VKVml4WUE5YWd3d0RuVWlxbEVQZFEzaW1pJy4KICAgICAnSm8yN0JHSEl0Lzd4OXlFamMzTnpoMjdOYTdjLzRUZGZmS2w0YmphM2FlNU1VSXUwVC9IT0VJYU9wSnQ0Z3dvU3NWVEs0U0JJWTc3aEZ0WTNBQkJqQmlaOTByS3d2c0g3Ny8rSycuCiAgICAgJ3QzN3dPaE8xaVBwVGs0U0J3MW1Mc3o2Q25LUTRsM3FWK2tFK3Q5WEhsTlpPaytiVUpMVklFMVZDY0lKV1FtSjZxamozME5iY1hMa1pNdDhZUGlnK1ozbjFHNWZaMzkvai92WTInLgogICAgICc5Y2txWlQyT2NoYm4wcDRxTmtVL2REZlVBRGRYYmg0SFhnUk80ek5kRVUwWEwxNzg0UExseTV3OWU3WjRTYXpGT2ZHckVvdERjT0tyY29KUG1yWUlYZi9ab3AzUU5kMXNrdUd0Jy4KICAgICAnY1VBYjJNZ0F4dkhaVGdGVXExV21wNmVablowRjhKbFRqRGR1RFRoQm5EZUVDRW9KdGJHSXA2ZW5xRWJsekNjRVoxUEVDVTR5VlJpT0dnZDBnYytBQjBDWnZrdjFzV1BIT0hmdScuCiAgICAgJ0hPZlBuOGRhNDFjcGtrbHRFQkVQSmhZbkJrVFFKY2RZVktHa2dSeENmQnNxNXhYTmdBYTJCbitoalRPZ0hFS0JQOHB6UlV4eWtJSDRpZkxKUlRKQWwrVU1CSnpQSFE2YmZlL2YnLgogICAgICdjV0l6UHhsVXBEK3p1Z3pJWnRWazFkOHpuQkFxUnhnb1F1VlFnU0pRM2g5QzVRaERSWWdqVUlMQ0F6bG5FZHNIWVRLZk1URUJjUDdGNTRZVUdWbWMyR0xsSW42dmU2djBhaFN0Jy4KICAgICAnOFgyNVR6akorckl4MWdyS3BRUFdSNExrR1ZWc01nZ2h2UzBxalBkdm01T2VjZU9UV0E1RXZvMm1GemtqUWZMN2haUFV5NXl2dkYvdVBGUUwzK25iRG1zTENFbVQzc1RtQ1ROcicuCiAgICAgJ3JvZ1Q2eUZzT2l4M2Z0dzdPd1Foa3ZTVTZDdWluaENrMCtrQWtGb0JhekVFSUNIYUhIaVBWbVUwZ25VcDRFQWMxbVlyRjBFQlZwd1BpMzRWckJrd1B4S2szVzVqdS9lNS9jK2QnLgogICAgICdiR1VISUFJdXlkVElFNXpmYzVXcjRsSmNhaEhuSFRQM0NWR203OERyZ1kzOE4rREVpYnA3ZG1ZS2RBUW1CaDFoakVGamlzKzlDVFdZR0syMUg2UHhQeU9JMERvYll3elpGL3o3Jy4KICAgICAnN2phZFR2SnRZRzBrQ0Q3bGZ3bDQ5aWpnVDFnYzBBSCtkWlNKQS94QitNei9HU0l2Rm9qL0I3SDFtQWQ4Q08vekFBQUFBRWxGVGtTdVFtQ0MnIDsKCiAgICAgICAgJHRoaXMtPmlMZW4gPSBjb3VudCgkdGhpcy0+aUJ1aWx0aW5JY29uKTsKICAgIH0KfQoKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gR2xvYmFsIGNhY2hlIGZvciBidWlsdGluIGltYWdlcwovLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQokX2dQcmVkZWZJY29ucyA9IG5ldyBQcmVkZWZJY29ucygpOwoKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gQ0xBU1MgSWNvbkltYWdlCi8vIERlc2NyaXB0aW9uOiBIb2xkcyBwcm9wZXJ0aWVzIGZvciBhbiBpY29uIGltYWdlCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmNsYXNzIEljb25JbWFnZSB7CiAgICBwcml2YXRlICRpR0RJbWFnZT1udWxsOwogICAgcHJpdmF0ZSAkaVdpZHRoLCRpSGVpZ2h0OwogICAgcHJpdmF0ZSAkaXhhbGlnbj0nbGVmdCcsJGl5YWxpZ249J2NlbnRlcic7CiAgICBwcml2YXRlICRpU2NhbGU9MS4wOwoKICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRhSWNvbiwkYVNjYWxlPTEpIHsKICAgICAgICBHTE9CQUwgJF9nUHJlZGVmSWNvbnMgOwogICAgICAgIGlmKCBpc19zdHJpbmcoJGFJY29uKSApIHsKICAgICAgICAgICAgJHRoaXMtPmlHREltYWdlID0gR3JhcGg6OkxvYWRCa2dJbWFnZSgnJywkYUljb24pOwogICAgICAgIH0KICAgICAgICBlbHNlaWYoIGlzX2ludGVnZXIoJGFJY29uKSApIHsKICAgICAgICAgICAgLy8gQnVpbHRpbiBpbWFnZQogICAgICAgICAgICAkdGhpcy0+aUdESW1hZ2UgPSAkX2dQcmVkZWZJY29ucy0+R2V0SW1nKCRhSWNvbik7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICBKcEdyYXBoRXJyb3I6OlJhaXNlTCg2MDExKTsKICAgICAgICAgICAgLy8oJ0FyZ3VtZW50IHRvIEljb25JbWFnZSBtdXN0IGJlIHN0cmluZyBvciBpbnRlZ2VyJyk7CiAgICAgICAgfQogICAgICAgICR0aGlzLT5pU2NhbGUgPSAkYVNjYWxlOwogICAgICAgICR0aGlzLT5pV2lkdGggPSBJbWFnZTo6R2V0V2lkdGgoJHRoaXMtPmlHREltYWdlKTsKICAgICAgICAkdGhpcy0+aUhlaWdodCA9IEltYWdlOjpHZXRIZWlnaHQoJHRoaXMtPmlHREltYWdlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBHZXRXaWR0aCgpIHsKICAgICAgICByZXR1cm4gcm91bmQoJHRoaXMtPmlTY2FsZSokdGhpcy0+aVdpZHRoKTsKICAgIH0KCiAgICBmdW5jdGlvbiBHZXRIZWlnaHQoKSB7CiAgICAgICAgcmV0dXJuIHJvdW5kKCR0aGlzLT5pU2NhbGUqJHRoaXMtPmlIZWlnaHQpOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldEFsaWduKCRhWD0nbGVmdCcsJGFZPSdjZW50ZXInKSB7CiAgICAgICAgJHRoaXMtPml4YWxpZ24gPSAkYVg7CiAgICAgICAgJHRoaXMtPml5YWxpZ24gPSAkYVk7CiAgICB9CgogICAgZnVuY3Rpb24gU3Ryb2tlKCRhSW1nLCR4LCR5KSB7CgogICAgICAgIGlmKCAkdGhpcy0+aXhhbGlnbiA9PSAncmlnaHQnICkgewogICAgICAgICAgICAkeCAtPSAkdGhpcy0+aVdpZHRoOwogICAgICAgIH0KICAgICAgICBlbHNlaWYoICR0aGlzLT5peGFsaWduID09ICdjZW50ZXInICkgewogICAgICAgICAgICAkeCAtPSByb3VuZCgkdGhpcy0+aVdpZHRoLzIqJHRoaXMtPmlTY2FsZSk7CiAgICAgICAgfQoKICAgICAgICBpZiggJHRoaXMtPml5YWxpZ24gPT0gJ2JvdHRvbScgKSB7CiAgICAgICAgICAgICR5IC09ICR0aGlzLT5pSGVpZ2h0OwogICAgICAgIH0KICAgICAgICBlbHNlaWYoICR0aGlzLT5peWFsaWduID09ICdjZW50ZXInICkgewogICAgICAgICAgICAkeSAtPSByb3VuZCgkdGhpcy0+aUhlaWdodC8yKiR0aGlzLT5pU2NhbGUpOwogICAgICAgIH0KCiAgICAgICAgJGFJbWctPkNvcHkoJHRoaXMtPmlHREltYWdlLAogICAgICAgIAkJCSR4LCR5LDAsMCwKICAgICAgICAJCQlyb3VuZCgkdGhpcy0+aVdpZHRoKiR0aGlzLT5pU2NhbGUpLHJvdW5kKCR0aGlzLT5pSGVpZ2h0KiR0aGlzLT5pU2NhbGUpLAogICAgICAgIAkJCSR0aGlzLT5pV2lkdGgsJHRoaXMtPmlIZWlnaHQpOwogICAgfQp9CgoKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gQ0xBU1MgVGV4dFByb3BlcnR5Ci8vIERlc2NyaXB0aW9uOiBIb2xkcyBwcm9wZXJ0aWVzIGZvciBhIHRleHQKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KY2xhc3MgVGV4dFByb3BlcnR5IHsKICAgIHB1YmxpYyAkaVNob3c9dHJ1ZTsKICAgIHB1YmxpYyAkY3NpbXRhcmdldD0nJywkY3NpbXdpbnRhcmdldD0nJywkY3NpbWFsdD0nJzsKICAgIHByaXZhdGUgJGlGRmFtaWx5PUZGX0ZPTlQxLCRpRlN0eWxlPUZTX05PUk1BTCwkaUZTaXplPTEwOwogICAgcHJpdmF0ZSAkaUZvbnRBcnJheT1hcnJheSgpOwogICAgcHJpdmF0ZSAkaUNvbG9yPSJibGFjayI7CiAgICBwcml2YXRlICRpVGV4dD0iIjsKICAgIHByaXZhdGUgJGlIQWxpZ249ImxlZnQiLCRpVkFsaWduPSJib3R0b20iOwoKICAgIC8vLS0tLS0tLS0tLS0tLS0tCiAgICAvLyBDT05TVFJVQ1RPUgogICAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGFUeHQ9JycpIHsKICAgICAgICAkdGhpcy0+aVRleHQgPSAkYVR4dDsKICAgIH0KCiAgICAvLy0tLS0tLS0tLS0tLS0tLQogICAgLy8gUFVCTElDIE1FVEhPRFMKICAgIGZ1bmN0aW9uIFNldCgkYVR4dCkgewogICAgICAgICR0aGlzLT5pVGV4dCA9ICRhVHh0OwogICAgfQoKICAgIGZ1bmN0aW9uIFNldENTSU1UYXJnZXQoJGFUYXJnZXQsJGFBbHRUZXh0PScnLCRhV2luVGFyZ2V0PScnKSB7CiAgICAgICAgaWYoIGlzX3N0cmluZygkYVRhcmdldCkgKQogICAgICAgICRhVGFyZ2V0ID0gYXJyYXkoJGFUYXJnZXQpOwogICAgICAgICR0aGlzLT5jc2ltdGFyZ2V0PSRhVGFyZ2V0OwoKICAgICAgICBpZiggaXNfc3RyaW5nKCRhV2luVGFyZ2V0KSApCiAgICAgICAgJGFXaW5UYXJnZXQgPSBhcnJheSgkYVdpblRhcmdldCk7CiAgICAgICAgJHRoaXMtPmNzaW13aW50YXJnZXQ9JGFXaW5UYXJnZXQ7CgogICAgICAgIGlmKCBpc19zdHJpbmcoJGFBbHRUZXh0KSApCiAgICAgICAgJGFBbHRUZXh0ID0gYXJyYXkoJGFBbHRUZXh0KTsKICAgICAgICAkdGhpcy0+Y3NpbWFsdD0kYUFsdFRleHQ7CgogICAgfQoKICAgIGZ1bmN0aW9uIFNldENTSU1BbHQoJGFBbHRUZXh0KSB7CiAgICAgICAgaWYoIGlzX3N0cmluZygkYUFsdFRleHQpICkKICAgICAgICAkYUFsdFRleHQgPSBhcnJheSgkYUFsdFRleHQpOwogICAgICAgICR0aGlzLT5jc2ltYWx0PSRhQWx0VGV4dDsKICAgIH0KCiAgICAvLyBTZXQgdGV4dCBjb2xvcgogICAgZnVuY3Rpb24gU2V0Q29sb3IoJGFDb2xvcikgewogICAgICAgICR0aGlzLT5pQ29sb3IgPSAkYUNvbG9yOwogICAgfQoKICAgIGZ1bmN0aW9uIEhhc1RhYnMoKSB7CiAgICAgICAgaWYoIGlzX3N0cmluZygkdGhpcy0+aVRleHQpICkgewogICAgICAgICAgICByZXR1cm4gc3Vic3RyX2NvdW50KCR0aGlzLT5pVGV4dCwiXHQiKSA+IDA7CiAgICAgICAgfQogICAgICAgIGVsc2VpZiggaXNfYXJyYXkoJHRoaXMtPmlUZXh0KSApIHsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBHZXQgbnVtYmVyIG9mIHRhYnMgaW4gc3RyaW5nCiAgICBmdW5jdGlvbiBHZXROYnJUYWJzKCkgewogICAgICAgIGlmKCBpc19zdHJpbmcoJHRoaXMtPmlUZXh0KSApIHsKICAgICAgICAgICAgcmV0dXJuIHN1YnN0cl9jb3VudCgkdGhpcy0+aVRleHQsIlx0IikgOwogICAgICAgIH0KICAgICAgICBlbHNlewogICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICB9CiAgICB9CgogICAgLy8gU2V0IGFsaWdubWVudAogICAgZnVuY3Rpb24gQWxpZ24oJGFIQWxpZ24sJGFWQWxpZ249ImJvdHRvbSIpIHsKICAgICAgICAkdGhpcy0+aUhBbGlnbj0kYUhBbGlnbjsKICAgICAgICAkdGhpcy0+aVZBbGlnbj0kYVZBbGlnbjsKICAgIH0KCiAgICAvLyBTeW5vbnltCiAgICBmdW5jdGlvbiBTZXRBbGlnbigkYUhBbGlnbiwkYVZBbGlnbj0iYm90dG9tIikgewogICAgICAgICR0aGlzLT5pSEFsaWduPSRhSEFsaWduOwogICAgICAgICR0aGlzLT5pVkFsaWduPSRhVkFsaWduOwogICAgfQoKICAgIC8vIFNwZWNpZnkgZm9udAogICAgZnVuY3Rpb24gU2V0Rm9udCgkYUZGYW1pbHksJGFGU3R5bGU9RlNfTk9STUFMLCRhRlNpemU9MTApIHsKICAgICAgICAkdGhpcy0+aUZGYW1pbHkgPSAkYUZGYW1pbHk7CiAgICAgICAgJHRoaXMtPmlGU3R5bGUgID0gJGFGU3R5bGU7CiAgICAgICAgJHRoaXMtPmlGU2l6ZSAgPSAkYUZTaXplOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldENvbHVtbkZvbnRzKCRhRm9udEFycmF5KSB7CiAgICAgICAgaWYoICFpc19hcnJheSgkYUZvbnRBcnJheSkgfHwgY291bnQoJGFGb250QXJyYXlbMF0pICE9IDMgKSB7CiAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDYwMzMpOwogICAgICAgICAgICAvLyAnQXJyYXkgb2YgZm9udHMgbXVzdCBjb250YWluIGFycmF5cyB3aXRoIDMgZWxlbWVudHMsIGkuZS4gKEZhbWlseSwgU3R5bGUsIFNpemUpJwogICAgICAgIH0KICAgICAgICAkdGhpcy0+aUZvbnRBcnJheSA9ICRhRm9udEFycmF5OwogICAgfQoKCiAgICBmdW5jdGlvbiBJc0NvbHVtbnMoKSB7CiAgICAgICAgcmV0dXJuIGlzX2FycmF5KCR0aGlzLT5pVGV4dCkgOwogICAgfQoKICAgIC8vIEdldCB3aWR0aCBvZiB0ZXh0LiBJZiB0ZXh0IGNvbnRhaW5zIHNldmVyYWwgY29sdW1ucyBzZXBhcmF0ZWQgYnkKICAgIC8vIHRhYnMgdGhlbiByZXR1cm4gYm90aCB0aGUgdG90YWwgd2lkdGggYXMgd2VsbCBhcyBhbiBhcnJheSB3aXRoIGEKICAgIC8vIHdpZHRoIGZvciBlYWNoIGNvbHVtbi4KICAgIGZ1bmN0aW9uIEdldFdpZHRoKCRhSW1nLCRhVXNlVGFicz1mYWxzZSwkYVRhYkV4dHJhTWFyZ2luPTEuMSkgewogICAgICAgICRleHRyYV9tYXJnaW49NDsKICAgICAgICAkYUltZy0+U2V0Rm9udCgkdGhpcy0+aUZGYW1pbHksJHRoaXMtPmlGU3R5bGUsJHRoaXMtPmlGU2l6ZSk7CiAgICAgICAgaWYoIGlzX3N0cmluZygkdGhpcy0+aVRleHQpICkgewogICAgICAgICAgICBpZiggc3RybGVuKCR0aGlzLT5pVGV4dCkgPT0gMCApIHJldHVybiAwOwogICAgICAgICAgICAkdG1wID0gcHJlZ19zcGxpdCgnL1x0LycsJHRoaXMtPmlUZXh0KTsKICAgICAgICAgICAgaWYoIGNvdW50KCR0bXApIDw9IDEgfHwgISRhVXNlVGFicyApIHsKICAgICAgICAgICAgICAgICR3ID0gJGFJbWctPkdldFRleHRXaWR0aCgkdGhpcy0+aVRleHQpOwogICAgICAgICAgICAgICAgcmV0dXJuICR3ICsgMiokZXh0cmFfbWFyZ2luOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgJHRvdD0wOwogICAgICAgICAgICAgICAgJG4gPSBjb3VudCgkdG1wKTsKICAgICAgICAgICAgICAgIGZvcigkaT0wOyAkaSA8ICRuOyArKyRpKSB7CiAgICAgICAgICAgICAgICAgICAgJHJlc1skaV0gPSAkYUltZy0+R2V0VGV4dFdpZHRoKCR0bXBbJGldKTsKICAgICAgICAgICAgICAgICAgICAkdG90ICs9ICRyZXNbJGldKiRhVGFiRXh0cmFNYXJnaW47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm4gYXJyYXkocm91bmQoJHRvdCksJHJlcyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZWlmKCBpc19vYmplY3QoJHRoaXMtPmlUZXh0KSApIHsKICAgICAgICAgICAgLy8gQSBzaW5nbGUgaWNvbgogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmlUZXh0LT5HZXRXaWR0aCgpKzIqJGV4dHJhX21hcmdpbjsKICAgICAgICB9CiAgICAgICAgZWxzZWlmKCBpc19hcnJheSgkdGhpcy0+aVRleHQpICkgewogICAgICAgICAgICAvLyBNdXN0IGJlIGFuIGFycmF5IG9mIHRleHRzLiBJbiB0aGlzIGNhc2Ugd2UgcmV0dXJuIHRoZSBzdW0gb2YgdGhlCiAgICAgICAgICAgIC8vIGxlbmd0aCArIGEgZml4ZWQgbWFyZ2luIG9mIDQgcGl4ZWxzIG9uIGVhY2ggdGV4dCBzdHJpbmcKICAgICAgICAgICAgJG4gPSBjb3VudCgkdGhpcy0+aVRleHQpOwogICAgICAgICAgICAkbmYgPSBjb3VudCgkdGhpcy0+aUZvbnRBcnJheSk7CiAgICAgICAgICAgIGZvciggJGk9MCwgJHc9MDsgJGkgPCAkbjsgKyskaSApIHsKICAgICAgICAgICAgICAgIGlmKCAkaSA8ICRuZiApIHsKICAgICAgICAgICAgICAgICAgICAkYUltZy0+U2V0Rm9udCgkdGhpcy0+aUZvbnRBcnJheVskaV1bMF0sJHRoaXMtPmlGb250QXJyYXlbJGldWzFdLCR0aGlzLT5pRm9udEFycmF5WyRpXVsyXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkYUltZy0+U2V0Rm9udCgkdGhpcy0+aUZGYW1pbHksJHRoaXMtPmlGU3R5bGUsJHRoaXMtPmlGU2l6ZSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkdG1wID0gJHRoaXMtPmlUZXh0WyRpXTsKICAgICAgICAgICAgICAgIGlmKCBpc19zdHJpbmcoJHRtcCkgKSB7CiAgICAgICAgICAgICAgICAgICAgJHcgKz0gJGFJbWctPkdldFRleHRXaWR0aCgkdG1wKSskZXh0cmFfbWFyZ2luOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaWYoIGlzX29iamVjdCgkdG1wKSA9PT0gZmFsc2UgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDYwMTIpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAkdyArPSAkdG1wLT5HZXRXaWR0aCgpKyRleHRyYV9tYXJnaW47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuICR3OwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoNjAxMik7CiAgICAgICAgfQogICAgfQoKICAgIC8vIGZvciB0aGUgY2FzZSB3aGVyZSB3ZSBoYXZlIG11bHRpcGxlIGNvbHVtbnMgdGhpcyBmdW5jdGlvbiByZXR1cm5zIHRoZSB3aWR0aCBvZiBlYWNoCiAgICAvLyBjb2x1bW4gaW5kaXZpZHVhbGx5LiBJZiB0aGVyZSBpcyBubyBjb2x1bW5zIGp1c3QgcmV0dXJuIHRoZSB3aWR0aCBvZiB0aGUgc2luZ2xlCiAgICAvLyBjb2x1bW4gYXMgYW4gYXJyYXkgb2Ygb25lCiAgICBmdW5jdGlvbiBHZXRDb2xXaWR0aCgkYUltZywkYU1hcmdpbj0wKSB7CiAgICAgICAgJGFJbWctPlNldEZvbnQoJHRoaXMtPmlGRmFtaWx5LCR0aGlzLT5pRlN0eWxlLCR0aGlzLT5pRlNpemUpOwogICAgICAgIGlmKCBpc19hcnJheSgkdGhpcy0+aVRleHQpICkgewogICAgICAgICAgICAkbiA9IGNvdW50KCR0aGlzLT5pVGV4dCk7CiAgICAgICAgICAgICRuZiA9IGNvdW50KCR0aGlzLT5pRm9udEFycmF5KTsKICAgICAgICAgICAgZm9yKCAkaT0wLCAkdz1hcnJheSgpOyAkaSA8ICRuOyArKyRpICkgewogICAgICAgICAgICAgICAgJHRtcCA9ICR0aGlzLT5pVGV4dFskaV07CiAgICAgICAgICAgICAgICBpZiggaXNfc3RyaW5nKCR0bXApICkgewogICAgICAgICAgICAgICAgICAgIGlmKCAkaSA8ICRuZiApIHsKICAgICAgICAgICAgICAgICAgICAgICAgJGFJbWctPlNldEZvbnQoJHRoaXMtPmlGb250QXJyYXlbJGldWzBdLCR0aGlzLT5pRm9udEFycmF5WyRpXVsxXSwkdGhpcy0+aUZvbnRBcnJheVskaV1bMl0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgJGFJbWctPlNldEZvbnQoJHRoaXMtPmlGRmFtaWx5LCR0aGlzLT5pRlN0eWxlLCR0aGlzLT5pRlNpemUpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAkd1skaV0gPSAkYUltZy0+R2V0VGV4dFdpZHRoKCR0bXApKyRhTWFyZ2luOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgaWYoIGlzX29iamVjdCgkdG1wKSA9PT0gZmFsc2UgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDYwMTIpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAkd1skaV0gPSAkdG1wLT5HZXRXaWR0aCgpKyRhTWFyZ2luOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiAkdzsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBhcnJheSgkdGhpcy0+R2V0V2lkdGgoJGFJbWcpKTsKICAgICAgICB9CiAgICB9CgogICAgLy8gR2V0IHRvdGFsIGhlaWdodCBvZiB0ZXh0CiAgICBmdW5jdGlvbiBHZXRIZWlnaHQoJGFJbWcpIHsKICAgICAgICAkbmYgPSBjb3VudCgkdGhpcy0+aUZvbnRBcnJheSk7CiAgICAgICAgJG1heGhlaWdodCA9IC0xOwoKICAgICAgICBpZiggJG5mID4gMCApIHsKICAgICAgICAgICAgLy8gV2UgaGF2ZSB0byBmaW5kIG91dCB0aGUgbGFyZ2VzdCBmb250IGFuZCB0YWtlIHRoYXQgb25lIGFzIHRoZQogICAgICAgICAgICAvLyBoZWlnaHQgb2YgdGhlIHJvdwogICAgICAgICAgICBmb3IoJGk9MDsgJGkgPCAkbmY7ICsrJGkgKSB7CiAgICAgICAgICAgICAgICAkYUltZy0+U2V0Rm9udCgkdGhpcy0+aUZvbnRBcnJheVskaV1bMF0sJHRoaXMtPmlGb250QXJyYXlbJGldWzFdLCR0aGlzLT5pRm9udEFycmF5WyRpXVsyXSk7CiAgICAgICAgICAgICAgICAkaGVpZ2h0ID0gJGFJbWctPkdldEZvbnRIZWlnaHQoKTsKICAgICAgICAgICAgICAgICRtYXhoZWlnaHQgPSBtYXgoJGhlaWdodCwkbWF4aGVpZ2h0KTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgJGFJbWctPlNldEZvbnQoJHRoaXMtPmlGRmFtaWx5LCR0aGlzLT5pRlN0eWxlLCR0aGlzLT5pRlNpemUpOwogICAgICAgICRoZWlnaHQgPSAkYUltZy0+R2V0Rm9udEhlaWdodCgpOwogICAgICAgICRtYXhoZWlnaHQgPSBtYXgoJGhlaWdodCwkbWF4aGVpZ2h0KTsKICAgICAgICByZXR1cm4gJG1heGhlaWdodDsKICAgIH0KCiAgICAvLyBVbmhpZGUvaGlkZSB0aGUgdGV4dAogICAgZnVuY3Rpb24gU2hvdygkYVNob3c9dHJ1ZSkgewogICAgICAgICR0aGlzLT5pU2hvdz0kYVNob3c7CiAgICB9CgogICAgLy8gU3Ryb2tlIHRleHQgYXQgKHgseSkgY29vcmRpbmF0ZXMuIElmIHRoZSB0ZXh0IGNvbnRhaW5zIHRhYnMgdGhlbiB0aGUKICAgIC8vIHggcGFyYW1ldGVyIHNob3VsZCBiZSBhbiBhcnJheSBvZiBwb3NpdGlvbnMgdG8gYmUgdXNlZCBmb3IgZWFjaCBzdWNjZXNzaXZlCiAgICAvLyB0YWIgbWFyay4gSWYgbm8gYXJyYXkgaXMgc3VwcGxpZWQgdGhlbiB0aGUgdGFicyB3aWxsIGJlIGlnbm9yZWQuCiAgICBmdW5jdGlvbiBTdHJva2UoJGFJbWcsJGFYLCRhWSkgewogICAgICAgIGlmKCAkdGhpcy0+aVNob3cgKSB7CiAgICAgICAgICAgICRhSW1nLT5TZXRDb2xvcigkdGhpcy0+aUNvbG9yKTsKICAgICAgICAgICAgJGFJbWctPlNldEZvbnQoJHRoaXMtPmlGRmFtaWx5LCR0aGlzLT5pRlN0eWxlLCR0aGlzLT5pRlNpemUpOwogICAgICAgICAgICAkYUltZy0+U2V0VGV4dEFsaWduKCR0aGlzLT5pSEFsaWduLCR0aGlzLT5pVkFsaWduKTsKICAgICAgICAgICAgaWYoICR0aGlzLT5HZXROYnJUYWJzKCkgPCAxICkgewogICAgICAgICAgICAgICAgaWYoIGlzX3N0cmluZygkdGhpcy0+aVRleHQpICkgewogICAgICAgICAgICAgICAgICAgIGlmKCBpc19hcnJheSgkYVgpICkgJGFYPSRhWFswXTsKICAgICAgICAgICAgICAgICAgICBpZiggaXNfYXJyYXkoJGFZKSApICRhWT0kYVlbMF07CiAgICAgICAgICAgICAgICAgICAgJGFJbWctPlN0cm9rZVRleHQoJGFYLCRhWSwkdGhpcy0+aVRleHQpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZWlmKCBpc19hcnJheSgkdGhpcy0+aVRleHQpICYmICgkbiA9IGNvdW50KCR0aGlzLT5pVGV4dCkpID4gMCApIHsKICAgICAgICAgICAgICAgICAgICAkYXggPSBpc19hcnJheSgkYVgpIDsKICAgICAgICAgICAgICAgICAgICAkYXkgPSBpc19hcnJheSgkYVkpIDsKICAgICAgICAgICAgICAgICAgICBpZiggJGF4ICYmICRheSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90aGluZzsgYm90aCBhcmUgYWxyZWFkeSBhcnJheXMKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZWlmKCAkYXggKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRhWSA9IGFycmF5X2ZpbGwoMCwkbiwkYVkpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlaWYoICRheSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgJGFYID0gYXJyYXlfZmlsbCgwLCRuLCRhWCk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAkYVggPSBhcnJheV9maWxsKDAsJG4sJGFYKTsKICAgICAgICAgICAgICAgICAgICAgICAgJGFZID0gYXJyYXlfZmlsbCgwLCRuLCRhWSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICRuID0gbWluKCRuLCBjb3VudCgkYVgpICkgOwogICAgICAgICAgICAgICAgICAgICRuID0gbWluKCRuLCBjb3VudCgkYVkpICkgOwogICAgICAgICAgICAgICAgICAgIGZvcigkaT0wOyAkaSA8ICRuOyArKyRpICkgewogICAgICAgICAgICAgICAgICAgICAgICAkdG1wID0gJHRoaXMtPmlUZXh0WyRpXTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoIGlzX29iamVjdCgkdG1wKSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0bXAtPlN0cm9rZSgkYUltZywkYVhbJGldLCRhWVskaV0pOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoICRpIDwgY291bnQoJHRoaXMtPmlGb250QXJyYXkpICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRmb250ID0gJHRoaXMtPmlGb250QXJyYXlbJGldOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhSW1nLT5TZXRGb250KCRmb250WzBdLCRmb250WzFdLCRmb250WzJdKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhSW1nLT5TZXRGb250KCR0aGlzLT5pRkZhbWlseSwkdGhpcy0+aUZTdHlsZSwkdGhpcy0+aUZTaXplKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgCSRhSW1nLT5TdHJva2VUZXh0KCRhWFskaV0sJGFZWyRpXSxzdHJfcmVwbGFjZSgiXHQiLCIgIiwkdG1wKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAkdG1wID0gcHJlZ19zcGxpdCgnL1x0LycsJHRoaXMtPmlUZXh0KTsKICAgICAgICAgICAgICAgICRuID0gbWluKGNvdW50KCR0bXApLGNvdW50KCRhWCkpOwogICAgICAgICAgICAgICAgZm9yKCRpPTA7ICRpIDwgJG47ICsrJGkpIHsKICAgICAgICAgICAgICAgICAgICBpZiggJGkgPCBjb3VudCgkdGhpcy0+aUZvbnRBcnJheSkgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRmb250ID0gJHRoaXMtPmlGb250QXJyYXlbJGldOwogICAgICAgICAgICAgICAgICAgICAgICAkYUltZy0+U2V0Rm9udCgkZm9udFswXSwkZm9udFsxXSwkZm9udFsyXSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAkYUltZy0+U2V0Rm9udCgkdGhpcy0+aUZGYW1pbHksJHRoaXMtPmlGU3R5bGUsJHRoaXMtPmlGU2l6ZSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICRhSW1nLT5TdHJva2VUZXh0KCRhWFskaV0sJGFZLCR0bXBbJGldKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gQ0xBU1MgSGVhZGVyUHJvcGVydHkKLy8gRGVzY3JpcHRpb246IERhdGEgZW5jYXBzdWxhdGluZyBjbGFzcyB0byBob2xkIHByb3BlcnR5Ci8vIGZvciBlYWNoIHR5cGUgb2YgdGhlIHNjYWxlIGhlYWRlcnMKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KY2xhc3MgSGVhZGVyUHJvcGVydHkgewogICAgcHVibGljICRncmlkOwogICAgcHVibGljICRpU2hvd0xhYmVscz10cnVlLCRpU2hvd0dyaWQ9dHJ1ZTsKICAgIHB1YmxpYyAkaVRpdGxlVmVydE1hcmdpbj0zLCRpRkZhbWlseT1GRl9GT05UMCwkaUZTdHlsZT1GU19OT1JNQUwsJGlGU2l6ZT04OwogICAgcHVibGljICRpU3R5bGU9MDsKICAgIHB1YmxpYyAkaUZyYW1lQ29sb3I9ImJsYWNrIiwkaUZyYW1lV2VpZ2h0PTE7CiAgICBwdWJsaWMgJGlCYWNrZ3JvdW5kQ29sb3I9IndoaXRlIjsKICAgIHB1YmxpYyAkaVdlZWtlbmRCYWNrZ3JvdW5kQ29sb3I9ImxpZ2h0Z3JheSIsJGlTdW5kYXlUZXh0Q29sb3I9InJlZCI7IC8vIHRoZXNlIGFyZSBvbmx5IHVzZWQgd2l0aCBkYXkgc2NhbGUKICAgIHB1YmxpYyAkaVRleHRDb2xvcj0iYmxhY2siOwogICAgcHVibGljICRpTGFiZWxGb3JtU3RyPSIlZCI7CiAgICBwdWJsaWMgJGlJbnRlcnZhbGwgPSAxOwoKICAgIC8vLS0tLS0tLS0tLS0tLS0tCiAgICAvLyBDT05TVFJVQ1RPUgogICAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoKSB7CiAgICAgICAgJHRoaXMtPmdyaWQgPSBuZXcgTGluZVByb3BlcnR5KCk7CiAgICB9CgogICAgLy8tLS0tLS0tLS0tLS0tLS0KICAgIC8vIFBVQkxJQyBNRVRIT0RTCiAgICBmdW5jdGlvbiBTaG93KCRhU2hvdz10cnVlKSB7CiAgICAgICAgJHRoaXMtPmlTaG93TGFiZWxzID0gJGFTaG93OwogICAgfQoKICAgIGZ1bmN0aW9uIFNldEludGVydmFsbCgkYUludCkgewogICAgCSR0aGlzLT5pSW50ZXJ2YWxsID0gJGFJbnQ7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0SW50ZXJ2YWwoJGFJbnQpIHsKICAgICAgICAkdGhpcy0+aUludGVydmFsbCA9ICRhSW50OwogICAgfQoKICAgIGZ1bmN0aW9uIEdldEludGVydmFsbCgpIHsKICAgICAgICByZXR1cm4gJHRoaXMtPmlJbnRlcnZhbGwgOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldEZvbnQoJGFGRmFtaWx5LCRhRlN0eWxlPUZTX05PUk1BTCwkYUZTaXplPTEwKSB7CiAgICAgICAgJHRoaXMtPmlGRmFtaWx5ID0gJGFGRmFtaWx5OwogICAgICAgICR0aGlzLT5pRlN0eWxlICA9ICRhRlN0eWxlOwogICAgICAgICR0aGlzLT5pRlNpemUgID0gJGFGU2l6ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRGb250Q29sb3IoJGFDb2xvcikgewogICAgICAgICR0aGlzLT5pVGV4dENvbG9yID0gJGFDb2xvcjsKICAgIH0KCiAgICBmdW5jdGlvbiBHZXRGb250SGVpZ2h0KCRhSW1nKSB7CiAgICAgICAgJGFJbWctPlNldEZvbnQoJHRoaXMtPmlGRmFtaWx5LCR0aGlzLT5pRlN0eWxlLCR0aGlzLT5pRlNpemUpOwogICAgICAgIHJldHVybiAkYUltZy0+R2V0Rm9udEhlaWdodCgpOwogICAgfQoKICAgIGZ1bmN0aW9uIEdldEZvbnRXaWR0aCgkYUltZykgewogICAgICAgICRhSW1nLT5TZXRGb250KCR0aGlzLT5pRkZhbWlseSwkdGhpcy0+aUZTdHlsZSwkdGhpcy0+aUZTaXplKTsKICAgICAgICByZXR1cm4gJGFJbWctPkdldEZvbnRXaWR0aCgpOwogICAgfQoKICAgIGZ1bmN0aW9uIEdldFN0cldpZHRoKCRhSW1nLCRhU3RyKSB7CiAgICAgICAgJGFJbWctPlNldEZvbnQoJHRoaXMtPmlGRmFtaWx5LCR0aGlzLT5pRlN0eWxlLCR0aGlzLT5pRlNpemUpOwogICAgICAgIHJldHVybiAkYUltZy0+R2V0VGV4dFdpZHRoKCRhU3RyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRTdHlsZSgkYVN0eWxlKSB7CiAgICAgICAgJHRoaXMtPmlTdHlsZSA9ICRhU3R5bGU7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0QmFja2dyb3VuZENvbG9yKCRhQ29sb3IpIHsKICAgICAgICAkdGhpcy0+aUJhY2tncm91bmRDb2xvcj0kYUNvbG9yOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldEZyYW1lV2VpZ2h0KCRhV2VpZ2h0KSB7CiAgICAgICAgJHRoaXMtPmlGcmFtZVdlaWdodD0kYVdlaWdodDsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRGcmFtZUNvbG9yKCRhQ29sb3IpIHsKICAgICAgICAkdGhpcy0+aUZyYW1lQ29sb3I9JGFDb2xvcjsKICAgIH0KCiAgICAvLyBPbmx5IHVzZWQgYnkgZGF5IHNjYWxlCiAgICBmdW5jdGlvbiBTZXRXZWVrZW5kQ29sb3IoJGFDb2xvcikgewogICAgICAgICR0aGlzLT5pV2Vla2VuZEJhY2tncm91bmRDb2xvcj0kYUNvbG9yOwogICAgfQoKICAgIC8vIE9ubHkgdXNlZCBieSBkYXkgc2NhbGUKICAgIGZ1bmN0aW9uIFNldFN1bmRheUZvbnRDb2xvcigkYUNvbG9yKSB7CiAgICAgICAgJHRoaXMtPmlTdW5kYXlUZXh0Q29sb3I9JGFDb2xvcjsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRUaXRsZVZlcnRNYXJnaW4oJGFNYXJnaW4pIHsKICAgICAgICAkdGhpcy0+aVRpdGxlVmVydE1hcmdpbj0kYU1hcmdpbjsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRMYWJlbEZvcm1hdFN0cmluZygkYVN0cikgewogICAgICAgICR0aGlzLT5pTGFiZWxGb3JtU3RyPSRhU3RyOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldEZvcm1hdFN0cmluZygkYVN0cikgewogICAgICAgICR0aGlzLT5TZXRMYWJlbEZvcm1hdFN0cmluZygkYVN0cik7CiAgICB9CgoKfQoKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gQ0xBU1MgR2FudHRTY2FsZQovLyBEZXNjcmlwdGlvbjogUmVzcG9uc2libGUgZm9yIGNhbGN1bGF0aW5nIGFuZCBzaG93aW5nCi8vIHRoZSBzY2FsZSBpbiBhIGdhbnR0IGNoYXJ0LiBUaGlzIGluY2x1ZGVzIHByb3ZpZGluZyBtZXRob2RzIGZvcgovLyBjb252ZXJ0aW5nIGRhdGVzIHRvIHBvc2l0aW9uIGluIHRoZSBjaGFydCBhcyB3ZWxsIGFzIHN0cm9raW5nIHRoZQovLyBkYXRlIGhlYWRlcnMgKGRheXMsIHdlZWssIGV0YykuCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmNsYXNzIEdhbnR0U2NhbGUgewogICAgcHVibGljICRtaW51dGUsJGhvdXIsJGRheSwkd2VlaywkbW9udGgsJHllYXI7CiAgICBwdWJsaWMgJGRpdmlkZXIsJGRpdmlkZXJoLCR0YWJsZVRpdGxlOwogICAgcHVibGljICRpU3RhcnREYXRlPS0xLCRpRW5kRGF0ZT0tMTsKICAgIC8vIE51bWJlciBvZiBnYW50dCBiYXIgcG9zaXRpb24gKG4uYiBub3QgbmVjZXNzYXJpbGl5IHRoZSBzYW1lIGFzIHRoZSBudW1iZXIgb2YgYmFycykKICAgIC8vIHdlIGNvdWxkIGhhdmUgb24gYmFyIGluIHBvc2l0aW9uIDEsIGFuZCBvbmUgYmFyIGluIHBvc2l0aW9uIDUgdGhlbiB0aGVyZSBhcmUgdHdvCiAgICAvLyBiYXJzIGJ1dCB0aGUgbnVtYmVyIG9mIGJhciBwb3NpdGlvbnMgaXMgNQogICAgcHVibGljICRhY3RpbmZvOwogICAgcHVibGljICRpVG9wUGxvdE1hcmdpbj0xMCwkaUJvdHRvbVBsb3RNYXJnaW49MTU7CiAgICBwdWJsaWMgJGlWZXJ0TGluZXM9LTE7CiAgICBwdWJsaWMgJGlWZXJ0SGVhZGVyU2l6ZT0tMTsKICAgIC8vIFRoZSB3aWR0aCBvZiB0aGUgbGFiZWxzIChkZWZhdWx0cyB0byB0aGUgd2lkZXN0IG9mIGFsbCBsYWJlbHMpCiAgICBwcml2YXRlICRpTGFiZWxXaWR0aDsKICAgIC8vIE91dCBpbWFnZSB0byBzdHJva2UgdGhlIHNjYWxlIHRvCiAgICBwcml2YXRlICRpSW1nOwogICAgcHJpdmF0ZSAkaVRhYmxlSGVhZGVyQmFja2dyb3VuZENvbG9yPSJ3aGl0ZSIsJGlUYWJsZUhlYWRlckZyYW1lQ29sb3I9ImJsYWNrIjsKICAgIHByaXZhdGUgJGlUYWJsZUhlYWRlckZyYW1lV2VpZ2h0PTE7CiAgICBwcml2YXRlICRpQXZhaWxhYmxlSGVpZ2h0PS0xLCRpVmVydFNwYWNpbmc9LTE7CiAgICBwcml2YXRlICRpRGF0ZUxvY2FsZTsKICAgIHByaXZhdGUgJGlWZXJ0TGF5b3V0PUdBTlRUX0VWRU47CiAgICBwcml2YXRlICRpVXNlUGxvdFdlZWtlbmRCYWNrZ3JvdW5kPXRydWU7CiAgICBwcml2YXRlICRpV2Vla1N0YXJ0ID0gMTsgLy8gRGVmYXVsdCB0byBoYXZlIHdlZWtlbmRzIHN0YXJ0IG9uIE1vbmRheQoKICAgIC8vLS0tLS0tLS0tLS0tLS0tCiAgICAvLyBDT05TVFJVQ1RPUgogICAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGFJbWcpIHsKICAgICAgICAkdGhpcy0+aUltZyA9ICRhSW1nOwogICAgICAgICR0aGlzLT5pRGF0ZUxvY2FsZSA9IG5ldyBEYXRlTG9jYWxlKCk7CgogICAgICAgICR0aGlzLT5taW51dGUgPSBuZXcgSGVhZGVyUHJvcGVydHkoKTsKICAgICAgICAkdGhpcy0+bWludXRlLT5TZXRJbnRlcnZhbGwoMTUpOwogICAgICAgICR0aGlzLT5taW51dGUtPlNldExhYmVsRm9ybWF0U3RyaW5nKCdpJyk7CiAgICAgICAgJHRoaXMtPm1pbnV0ZS0+U2V0Rm9udChGRl9GT05UMCk7CiAgICAgICAgJHRoaXMtPm1pbnV0ZS0+Z3JpZC0+U2V0Q29sb3IoImdyYXkiKTsKCiAgICAgICAgJHRoaXMtPmhvdXIgPSBuZXcgSGVhZGVyUHJvcGVydHkoKTsKICAgICAgICAkdGhpcy0+aG91ci0+U2V0Rm9udChGRl9GT05UMCk7CiAgICAgICAgJHRoaXMtPmhvdXItPlNldEludGVydmFsbCg2KTsKICAgICAgICAkdGhpcy0+aG91ci0+U2V0U3R5bGUoSE9VUlNUWUxFX0hNMjQpOwogICAgICAgICR0aGlzLT5ob3VyLT5TZXRMYWJlbEZvcm1hdFN0cmluZygnSDppJyk7CiAgICAgICAgJHRoaXMtPmhvdXItPmdyaWQtPlNldENvbG9yKCJncmF5Iik7CgogICAgICAgICR0aGlzLT5kYXkgPSBuZXcgSGVhZGVyUHJvcGVydHkoKTsKICAgICAgICAkdGhpcy0+ZGF5LT5ncmlkLT5TZXRDb2xvcigiZ3JheSIpOwogICAgICAgICR0aGlzLT5kYXktPlNldExhYmVsRm9ybWF0U3RyaW5nKCdsJyk7CgogICAgICAgICR0aGlzLT53ZWVrID0gbmV3IEhlYWRlclByb3BlcnR5KCk7CiAgICAgICAgJHRoaXMtPndlZWstPlNldExhYmVsRm9ybWF0U3RyaW5nKCJ3JWQiKTsKICAgICAgICAkdGhpcy0+d2Vlay0+U2V0Rm9udChGRl9GT05UMSk7CgogICAgICAgICR0aGlzLT5tb250aCA9IG5ldyBIZWFkZXJQcm9wZXJ0eSgpOwogICAgICAgICR0aGlzLT5tb250aC0+U2V0Rm9udChGRl9GT05UMSxGU19CT0xEKTsKCiAgICAgICAgJHRoaXMtPnllYXIgPSBuZXcgSGVhZGVyUHJvcGVydHkoKTsKICAgICAgICAkdGhpcy0+eWVhci0+U2V0Rm9udChGRl9GT05UMSxGU19CT0xEKTsKCiAgICAgICAgJHRoaXMtPmRpdmlkZXI9bmV3IExpbmVQcm9wZXJ0eSgpOwogICAgICAgICR0aGlzLT5kaXZpZGVyaD1uZXcgTGluZVByb3BlcnR5KCk7CiAgICAgICAgJHRoaXMtPmRpdmlkZXJoLT5TZXRXZWlnaHQoMik7CiAgICAgICAgJHRoaXMtPmRpdmlkZXItPlNldFdlaWdodCg2KTsKICAgICAgICAkdGhpcy0+ZGl2aWRlci0+U2V0Q29sb3IoJ2dyYXknKTsKICAgICAgICAkdGhpcy0+ZGl2aWRlci0+U2V0U3R5bGUoJ2ZhbmN5Jyk7CgogICAgICAgICR0aGlzLT50YWJsZVRpdGxlPW5ldyBUZXh0UHJvcGVydHkoKTsKICAgICAgICAkdGhpcy0+dGFibGVUaXRsZS0+U2hvdyhmYWxzZSk7CiAgICAgICAgJHRoaXMtPmFjdGluZm8gPSBuZXcgR2FudHRBY3Rpdml0eUluZm8oKTsKICAgIH0KCiAgICAvLy0tLS0tLS0tLS0tLS0tLQogICAgLy8gUFVCTElDIE1FVEhPRFMKICAgIC8vIFNwZWNpZnkgd2hhdCBoZWFkZXJzIHNob3VsZCBiZSB2aXNpYmxlCiAgICBmdW5jdGlvbiBTaG93SGVhZGVycygkYUZsZykgewogICAgICAgICR0aGlzLT5kYXktPlNob3coJGFGbGcgJiBHQU5UVF9IREFZKTsKICAgICAgICAkdGhpcy0+d2Vlay0+U2hvdygkYUZsZyAmIEdBTlRUX0hXRUVLKTsKICAgICAgICAkdGhpcy0+bW9udGgtPlNob3coJGFGbGcgJiBHQU5UVF9ITU9OVEgpOwogICAgICAgICR0aGlzLT55ZWFyLT5TaG93KCRhRmxnICYgR0FOVFRfSFlFQVIpOwogICAgICAgICR0aGlzLT5ob3VyLT5TaG93KCRhRmxnICYgR0FOVFRfSEhPVVIpOwogICAgICAgICR0aGlzLT5taW51dGUtPlNob3coJGFGbGcgJiBHQU5UVF9ITUlOKTsKCiAgICAgICAgLy8gTWFrZSBzb21lIGRlZmF1bHQgc2V0dGluZ3Mgb2YgZ3JpZGxpbmVzIHdoaWhjIG1ha2VzIHNlbnNlCiAgICAgICAgaWYoICRhRmxnICYgR0FOVFRfSFdFRUsgKSB7CiAgICAgICAgICAgICR0aGlzLT5tb250aC0+Z3JpZC0+U2hvdyhmYWxzZSk7CiAgICAgICAgICAgICR0aGlzLT55ZWFyLT5ncmlkLT5TaG93KGZhbHNlKTsKICAgICAgICB9CiAgICAgICAgaWYoICRhRmxnICYgR0FOVFRfSEhPVVIgKSB7CiAgICAgICAgICAgICR0aGlzLT5kYXktPmdyaWQtPlNldENvbG9yKCJibGFjayIpOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBTaG91bGQgdGhlIHdlZWtlbmQgYmFja2dyb3VuZCBzdHJldGNoIGFsbCB0aGUgd2F5IGRvd24gaW4gdGhlIHBsb3RhcmVhCiAgICBmdW5jdGlvbiBVc2VXZWVrZW5kQmFja2dyb3VuZCgkYVNob3cpIHsKICAgICAgICAkdGhpcy0+aVVzZVBsb3RXZWVrZW5kQmFja2dyb3VuZCA9ICRhU2hvdzsKICAgIH0KCiAgICAvLyBIYXZlIGEgcmFuZ2UgYmVlbiBzcGVjaWZpZWQ\/CiAgICBmdW5jdGlvbiBJc1JhbmdlU2V0KCkgewogICAgICAgIHJldHVybiAkdGhpcy0+aVN0YXJ0RGF0ZSE9LTEgJiYgJHRoaXMtPmlFbmREYXRlIT0tMTsKICAgIH0KCiAgICAvLyBTaG91bGQgdGhlIGxheW91dCBiZSBmcm9tIHRvcCBvciBldmVuPwogICAgZnVuY3Rpb24gU2V0VmVydExheW91dCgkYUxheW91dCkgewogICAgICAgICR0aGlzLT5pVmVydExheW91dCA9ICRhTGF5b3V0OwogICAgfQoKICAgIC8vIFdoaWNoIGxvY2FsZSBzaG91bGQgYmUgdXNlZD8KICAgIGZ1bmN0aW9uIFNldERhdGVMb2NhbGUoJGFMb2NhbGUpIHsKICAgICAgICAkdGhpcy0+aURhdGVMb2NhbGUtPlNldCgkYUxvY2FsZSk7CiAgICB9CgogICAgLy8gTnVtYmVyIG9mIGRheXMgd2UgYXJlIHNob3dpbmcKICAgIGZ1bmN0aW9uIEdldE51bWJlck9mRGF5cygpIHsKICAgICAgICByZXR1cm4gcm91bmQoKCR0aGlzLT5pRW5kRGF0ZS0kdGhpcy0+aVN0YXJ0RGF0ZSkvU0VDUEVSREFZKTsKICAgIH0KCiAgICAvLyBUaGUgd2lkdGggb2YgdGhlIGFjdHVhbCBwbG90IGFyZWEKICAgIGZ1bmN0aW9uIEdldFBsb3RXaWR0aCgpIHsKICAgICAgICAkaW1nPSR0aGlzLT5pSW1nOwogICAgICAgIHJldHVybiAkaW1nLT53aWR0aCAtICRpbWctPmxlZnRfbWFyZ2luIC0gJGltZy0+cmlnaHRfbWFyZ2luOwogICAgfQoKICAgIC8vIFNwZWNpZnkgdGhlIHdpZHRoIG9mIHRoZSB0aXRsZXMobGFiZWxzKSBmb3IgdGhlIGFjdGl2aXRpZXMKICAgIC8vIChUaGlzIGlzIGJ5IGRlZmF1bHQgc2V0IHRvIHRoZSBtaW5pbXVtIHdpZHRoIGVub3VnaHQgZm9yIHRoZQogICAgLy8gd2lkZXN0IHRpdGxlKQogICAgZnVuY3Rpb24gU2V0TGFiZWxXaWR0aCgkYUxhYmVsV2lkdGgpIHsKICAgICAgICAkdGhpcy0+aUxhYmVsV2lkdGg9JGFMYWJlbFdpZHRoOwogICAgfQoKICAgIC8vIFdoaWNoIGRheSBzaG91bGQgdGhlIHdlZWsgc3RhcnQ\/CiAgICAvLyAwPT1TdW4sIDE9PU1vbmRheSwgMj09VHVlc2RheSBldGMKICAgIGZ1bmN0aW9uIFNldFdlZWtTdGFydCgkYVN0YXJ0RGF5KSB7CiAgICAgICAgJHRoaXMtPmlXZWVrU3RhcnQgPSAkYVN0YXJ0RGF5ICUgNzsKCiAgICAgICAgLy9SZWNhbGN1bGF0ZSB0aGUgc3RhcnRkYXkgc2luY2UgdGhpcyB3aWxsIGNoYW5nZSB0aGUgd2VlayBzdGFydAogICAgICAgICR0aGlzLT5TZXRSYW5nZSgkdGhpcy0+aVN0YXJ0RGF0ZSwkdGhpcy0+aUVuZERhdGUpOwogICAgfQoKICAgIC8vIERvIHdlIHNob3cgbWluIHNjYWxlPwogICAgZnVuY3Rpb24gSXNEaXNwbGF5TWludXRlKCkgewogICAgICAgIHJldHVybiAkdGhpcy0+bWludXRlLT5pU2hvd0xhYmVsczsKICAgIH0KCiAgICAvLyBEbyB3ZSBzaG93IGRheSBzY2FsZT8KICAgIGZ1bmN0aW9uIElzRGlzcGxheUhvdXIoKSB7CiAgICAgICAgcmV0dXJuICR0aGlzLT5ob3VyLT5pU2hvd0xhYmVsczsKICAgIH0KCgogICAgLy8gRG8gd2Ugc2hvdyBkYXkgc2NhbGU\/CiAgICBmdW5jdGlvbiBJc0Rpc3BsYXlEYXkoKSB7CiAgICAgICAgcmV0dXJuICR0aGlzLT5kYXktPmlTaG93TGFiZWxzOwogICAgfQoKICAgIC8vIERvIHdlIHNob3cgd2VlayBzY2FsZT8KICAgIGZ1bmN0aW9uIElzRGlzcGxheVdlZWsoKSB7CiAgICAgICAgcmV0dXJuICR0aGlzLT53ZWVrLT5pU2hvd0xhYmVsczsKICAgIH0KCiAgICAvLyBEbyB3ZSBzaG93IG1vbnRoIHNjYWxlPwogICAgZnVuY3Rpb24gSXNEaXNwbGF5TW9udGgoKSB7CiAgICAgICAgcmV0dXJuICR0aGlzLT5tb250aC0+aVNob3dMYWJlbHM7CiAgICB9CgogICAgLy8gRG8gd2Ugc2hvdyB5ZWFyIHNjYWxlPwogICAgZnVuY3Rpb24gSXNEaXNwbGF5WWVhcigpIHsKICAgICAgICByZXR1cm4gJHRoaXMtPnllYXItPmlTaG93TGFiZWxzOwogICAgfQoKICAgIC8vIFNwZWNpZnkgc3BhY2luZyAoaW4gcGVyY2VudCBvZiBiYXIgaGVpZ2h0KSBiZXR3ZWVuIGFjdGl2aXR5IGJhcnMKICAgIGZ1bmN0aW9uIFNldFZlcnRTcGFjaW5nKCRhU3BhY2luZykgewogICAgICAgICR0aGlzLT5pVmVydFNwYWNpbmcgPSAkYVNwYWNpbmc7CiAgICB9CgogICAgLy8gU3BlY2lmeSBzY2FsZSBtaW4gYW5kIG1heCBkYXRlIGVpdGhlciBhcyB0aW1lc3RhbXAgb3IgYXMgZGF0ZSBzdHJpbmdzCiAgICAvLyBBbHdheXMgcm91bmQgdG8gdGhlIG5lYXJlc3Qgd2VlayBib3VuZGFyeQogICAgZnVuY3Rpb24gU2V0UmFuZ2UoJGFNaW4sJGFNYXgpIHsKICAgICAgICAkdGhpcy0+aVN0YXJ0RGF0ZSA9ICR0aGlzLT5Ob3JtYWxpemVEYXRlKCRhTWluKTsKICAgICAgICAkdGhpcy0+aUVuZERhdGUgPSAkdGhpcy0+Tm9ybWFsaXplRGF0ZSgkYU1heCk7CiAgICB9CgoKICAgIC8vIEFkanVzdCB0aGUgc3RhcnQgYW5kIGVuZCBkYXRlIHNvIHRoZXkgZml0IHRvIGJlZ2lubmluZy9lbmRpbmcKICAgIC8vIG9mIHRoZSB3ZWVrIHRha2luZyB0aGUgc3BlY2lmaWVkIHdlZWsgc3RhcnQgZGF5IGludG8gYWNjb3VudC4KICAgIGZ1bmN0aW9uIEFkanVzdFN0YXJ0RW5kRGF5KCkgewoKICAgICAgICBpZiggISgkdGhpcy0+SXNEaXNwbGF5WWVhcigpIHx8JHRoaXMtPklzRGlzcGxheU1vbnRoKCkgfHwgJHRoaXMtPklzRGlzcGxheVdlZWsoKSkgKSB7CiAgICAgICAgICAgIC8vIERvbid0IGFkanVzdAogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAvLyBHZXQgZGF5IGluIHdlZWsgZm9yIHN0YXJ0IGFuZCBlbmRpbmcgZGF0ZSAoU3VuPT0wKQogICAgICAgICRkcz1zdHJmdGltZSgiJXciLCR0aGlzLT5pU3RhcnREYXRlKTsKICAgICAgICAkZGU9c3RyZnRpbWUoIiV3IiwkdGhpcy0+aUVuZERhdGUpOwoKICAgICAgICAvLyBXZSB3YW50IHRvIHN0YXJ0IG9uIGlXZWVrU3RhcnQgZGF5LiBCdXQgZmlyc3Qgd2Ugc3VidHJhY3QgYSB3ZWVrCiAgICAgICAgLy8gaWYgdGhlIHN0YXJ0ZGF0ZSBpcyAiYmVoaW5kIiB0aGUgZGF5IHRoZSB3ZWVrIHN0YXJ0IGF0LgogICAgICAgIC8vIFRoaXMgd2F5IHdlIGVuc3VyZSB0aGF0IHRoZSBnaXZlbiBzdGFydCBkYXRlIGlzIGFsd2F5cyBpbmNsdWRlZAogICAgICAgIC8vIGluIHRoZSByYW5nZS4gSWYgd2UgZG9uJ3QgZG8gdGhpcyB0aGUgbmVhcmVzdCBjb3JyZWN0IHdlZWtkYXkgaW4gdGhlIHdlZWsKICAgICAgICAvLyB0byBzdGFydCBhdCBtaWdodCBiZSBsYXRlciB0aGFuIHRoZSBzdGFydCBkYXRlLgogICAgICAgIGlmKCAkZHMgPCAkdGhpcy0+aVdlZWtTdGFydCApCiAgICAgICAgJGQgPSBzdHJ0b3RpbWUoJy03IGRheScsJHRoaXMtPmlTdGFydERhdGUpOwogICAgICAgIGVsc2UKICAgICAgICAkZCA9ICR0aGlzLT5pU3RhcnREYXRlOwogICAgICAgICRhZGpkYXRlID0gc3RydG90aW1lKCgkdGhpcy0+aVdlZWtTdGFydC0kZHMpLicgZGF5JywkZCAvKiR0aGlzLT5pU3RhcnREYXRlKi8gKTsKICAgICAgICAkdGhpcy0+aVN0YXJ0RGF0ZSA9ICRhZGpkYXRlOwoKICAgICAgICAvLyBXZSB3YW50IHRvIGVuZCBvbiB0aGUgbGFzdCBkYXkgb2YgdGhlIHdlZWsKICAgICAgICAkcHJlZmVycmVkRW5kRGF5ID0gKCR0aGlzLT5pV2Vla1N0YXJ0KzYpJTc7CiAgICAgICAgaWYoICRwcmVmZXJyZWRFbmREYXkgIT0gJGRlICkgewogICAgICAgICAgICAvLyBTb2x2ZSBlcXVpdmFsZW5jZSBlcTogICAgJGRlICsgeCB+ICRwcmVmZXJyZWREYXkgKG1vZCA3KQogICAgICAgICAgICAkYWRqID0gKDcrKCRwcmVmZXJyZWRFbmREYXkgLSAkZGUpKSAlIDc7CiAgICAgICAgICAgICRhZGpkYXRlID0gc3RydG90aW1lKCIrJGFkaiBkYXkiLCR0aGlzLT5pRW5kRGF0ZSk7CiAgICAgICAgICAgICR0aGlzLT5pRW5kRGF0ZSA9ICRhZGpkYXRlOwogICAgICAgIH0KICAgIH0KCiAgICAvLyBTcGVjaWZ5IGJhY2tncm91bmQgZm9yIHRoZSB0YWJsZSB0aXRsZSBhcmVhICh1cHBlciBsZWZ0IGNvcm5lciBvZiB0aGUgdGFibGUpCiAgICBmdW5jdGlvbiBTZXRUYWJsZVRpdGxlQmFja2dyb3VuZCgkYUNvbG9yKSB7CiAgICAgICAgJHRoaXMtPmlUYWJsZUhlYWRlckJhY2tncm91bmRDb2xvciA9ICRhQ29sb3I7CiAgICB9CgogICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vCiAgICAvLyBQUklWQVRFIE1ldGhvZHMKCiAgICAvLyBEZXRlcm1pbmUgdGhlIGhlaWdodCBvZiBhbGwgdGhlIHNjYWxlIGhlYWRlcnMgY29tYmluZWQKICAgIGZ1bmN0aW9uIEdldEhlYWRlckhlaWdodCgpIHsKICAgICAgICAkaW1nPSR0aGlzLT5pSW1nOwogICAgICAgICRoZWlnaHQ9MTsKICAgICAgICBpZiggJHRoaXMtPm1pbnV0ZS0+aVNob3dMYWJlbHMgKSB7CiAgICAgICAgICAgICRoZWlnaHQgKz0gJHRoaXMtPm1pbnV0ZS0+R2V0Rm9udEhlaWdodCgkaW1nKTsKICAgICAgICAgICAgJGhlaWdodCArPSAkdGhpcy0+bWludXRlLT5pVGl0bGVWZXJ0TWFyZ2luOwogICAgICAgIH0KICAgICAgICBpZiggJHRoaXMtPmhvdXItPmlTaG93TGFiZWxzICkgewogICAgICAgICAgICAkaGVpZ2h0ICs9ICR0aGlzLT5ob3VyLT5HZXRGb250SGVpZ2h0KCRpbWcpOwogICAgICAgICAgICAkaGVpZ2h0ICs9ICR0aGlzLT5ob3VyLT5pVGl0bGVWZXJ0TWFyZ2luOwogICAgICAgIH0KICAgICAgICBpZiggJHRoaXMtPmRheS0+aVNob3dMYWJlbHMgKSB7CiAgICAgICAgICAgICRoZWlnaHQgKz0gJHRoaXMtPmRheS0+R2V0Rm9udEhlaWdodCgkaW1nKTsKICAgICAgICAgICAgJGhlaWdodCArPSAkdGhpcy0+ZGF5LT5pVGl0bGVWZXJ0TWFyZ2luOwogICAgICAgIH0KICAgICAgICBpZiggJHRoaXMtPndlZWstPmlTaG93TGFiZWxzICkgewogICAgICAgICAgICAkaGVpZ2h0ICs9ICR0aGlzLT53ZWVrLT5HZXRGb250SGVpZ2h0KCRpbWcpOwogICAgICAgICAgICAkaGVpZ2h0ICs9ICR0aGlzLT53ZWVrLT5pVGl0bGVWZXJ0TWFyZ2luOwogICAgICAgIH0KICAgICAgICBpZiggJHRoaXMtPm1vbnRoLT5pU2hvd0xhYmVscyApIHsKICAgICAgICAgICAgJGhlaWdodCArPSAkdGhpcy0+bW9udGgtPkdldEZvbnRIZWlnaHQoJGltZyk7CiAgICAgICAgICAgICRoZWlnaHQgKz0gJHRoaXMtPm1vbnRoLT5pVGl0bGVWZXJ0TWFyZ2luOwogICAgICAgIH0KICAgICAgICBpZiggJHRoaXMtPnllYXItPmlTaG93TGFiZWxzICkgewogICAgICAgICAgICAkaGVpZ2h0ICs9ICR0aGlzLT55ZWFyLT5HZXRGb250SGVpZ2h0KCRpbWcpOwogICAgICAgICAgICAkaGVpZ2h0ICs9ICR0aGlzLT55ZWFyLT5pVGl0bGVWZXJ0TWFyZ2luOwogICAgICAgIH0KICAgICAgICByZXR1cm4gJGhlaWdodDsKICAgIH0KCiAgICAvLyBHZXQgd2lkdGggKGluIHBpeGVscykgZm9yIGEgc2luZ2xlIGRheQogICAgZnVuY3Rpb24gR2V0RGF5V2lkdGgoKSB7CiAgICAgICAgcmV0dXJuICgkdGhpcy0+R2V0UGxvdFdpZHRoKCktJHRoaXMtPmlMYWJlbFdpZHRoKzEpLyR0aGlzLT5HZXROdW1iZXJPZkRheXMoKTsKICAgIH0KCiAgICAvLyBHZXQgd2lkdGggKGluIHBpeGVscykgZm9yIGEgc2luZ2xlIGhvdXIKICAgIGZ1bmN0aW9uIEdldEhvdXJXaWR0aCgpIHsKICAgICAgICByZXR1cm4gJHRoaXMtPkdldERheVdpZHRoKCkgLyAyNCA7CiAgICB9CgogICAgZnVuY3Rpb24gR2V0TWludXRlV2lkdGgoKSB7CiAgICAgICAgcmV0dXJuICR0aGlzLT5HZXRIb3VyV2lkdGgoKSAvIDYwIDsKICAgIH0KCiAgICAvLyBOdWJlciBvZiBkYXlzIGluIGEgeWVhcgogICAgZnVuY3Rpb24gR2V0TnVtRGF5c0luWWVhcigkYVllYXIpIHsKICAgICAgICBpZiggJHRoaXMtPklzTGVhcCgkYVllYXIpICkKICAgICAgICByZXR1cm4gMzY2OwogICAgICAgIGVsc2UKICAgICAgICByZXR1cm4gMzY1OwogICAgfQoKICAgIC8vIEdldCB3ZWVrIG51bWJlcgogICAgZnVuY3Rpb24gR2V0V2Vla05icigkYURhdGUsJGFTdW5TdGFydD10cnVlKSB7CiAgICAgICAgLy8gV2UgY2FuJ3QgdXNlIHRoZSBpbnRlcm5hbCBzdHJmdGltZSgpIHNpbmNlIGl0IGdldHMgdGhlIHdlZWtudW1iZXIKICAgICAgICAvLyB3cm9uZyBzaW5jZSBpdCBkb2Vzbid0IGZvbGxvdyBJU08gb24gYWxsIHN5c3RlbXMgc2luY2UgdGhpcyBpcwogICAgICAgIC8vIHN5c3RlbSBsaW5yYXJ5IGRlcGVuZGVudC4KICAgICAgICAvLyBFdmVuIHdvcnNlIGlzIHRoYXQgdGhpcyB3b3JrcyBkaWZmZXJlbnRseSBpZiB3ZSBhcmUgb24gYSBXaW5kb3dzCiAgICAgICAgLy8gb3IgVU5JWCBib3ggKGl0IGV2ZW4gZGlmZmVycyBiZXR3ZWVuIFVOSVggYm94ZXMgaG93IHN0cmZ0aW1lKCkKICAgICAgICAvLyBpcyBuYXRpdmVseSBpbXBsZW1lbnRlZCkKICAgICAgICAvLwogICAgICAgIC8vIENyZWRpdCB0byBOaWNvbGFzIEhvaXpleSA8bmhvaXpleUBwaHBoZWF2ZW4ubmV0PiBmb3IgdGhpcyBlbGVnYW50CiAgICAgICAgLy8gdmVyc2lvbiBvZiBXZWVrIE5iciBjYWxjdWxhdGlvbi4KCiAgICAgICAgJGRheSA9ICR0aGlzLT5Ob3JtYWxpemVEYXRlKCRhRGF0ZSk7CiAgICAgICAgaWYoICRhU3VuU3RhcnQgKQogICAgICAgICRkYXkgKz0gNjAqNjAqMjQ7CgogICAgICAgIC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogICAgICAgICBBY2NvcmRpbmcgdG8gSVNPLTg2MDEgOgogICAgICAgICAiV2VlayAwMSBvZiBhIHllYXIgaXMgcGVyIGRlZmluaXRpb24gdGhlIGZpcnN0IHdlZWsgdGhhdCBoYXMgdGhlIFRodXJzZGF5IGluIHRoaXMgeWVhciwKICAgICAgICAgd2hpY2ggaXMgZXF1aXZhbGVudCB0byB0aGUgd2VlayB0aGF0IGNvbnRhaW5zIHRoZSBmb3VydGggZGF5IG9mIEphbnVhcnkuCiAgICAgICAgIEluIG90aGVyIHdvcmRzLCB0aGUgZmlyc3Qgd2VlayBvZiBhIG5ldyB5ZWFyIGlzIHRoZSB3ZWVrIHRoYXQgaGFzIHRoZSBtYWpvcml0eSBvZiBpdHMKICAgICAgICAgZGF5cyBpbiB0aGUgbmV3IHllYXIuIgoKICAgICAgICAgQmUgY2FyZWZ1bGwsIHdpdGggUEhQLCAtMyAlIDcgPSAtMywgaW5zdGVhZCBvZiA0ICEhIQoKICAgICAgICAgZGF5IG9mIHllYXIgICAgICAgICAgICAgPSBkYXRlKCJ6IiwgJGRheSkgKyAxCiAgICAgICAgIG9mZnNldCB0byB0aHVyc2RheSAgICAgID0gMyAtIChkYXRlKCJ3IiwgJGRheSkgKyA2KSAlIDcKICAgICAgICAgZmlyc3QgdGh1cnNkYXkgb2YgeWVhciAgPSAxICsgKDExIC0gZGF0ZSgidyIsIG1rdGltZSgwLCAwLCAwLCAxLCAxLCBkYXRlKCJZIiwgJGRheSkpKSkgJSA3CiAgICAgICAgIHdlZWsgbnVtYmVyICAgICAgICAgICAgID0gKHRodXJzZGF5J3MgZGF5IG9mIHllYXIgLSBmaXJzdCB0aHVyc2RheSdzIGRheSBvZiB5ZWFyKSAvIDcgKyAxCiAgICAgICAgIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgogICAgICAgICR0aHVyc2RheSA9ICRkYXkgKyA2MCAqIDYwICogMjQgKiAoMyAtIChkYXRlKCJ3IiwgJGRheSkgKyA2KSAlIDcpOyAgICAgICAgICAgICAgLy8gdGFrZSB3ZWVrJ3MgdGh1cnNkYXkKICAgICAgICAkd2VlayA9IDEgKyAoZGF0ZSgieiIsICR0aHVyc2RheSkgLSAoMTEgLSBkYXRlKCJ3IiwgbWt0aW1lKDAsIDAsIDAsIDEsIDEsIGRhdGUoIlkiLCAkdGh1cnNkYXkpKSkpICUgNykgLyA3OwoKICAgICAgICByZXR1cm4gJHdlZWs7CiAgICB9CgogICAgLy8gSXMgeWVhciBhIGxlYXAgeWVhcj8KICAgIGZ1bmN0aW9uIElzTGVhcCgkYVllYXIpIHsKICAgICAgICAvLyBJcyB0aGUgeWVhciBhIGxlYXAgeWVhcj8KICAgICAgICAvLyR5ZWFyID0gMCtkYXRlKCJZIiwkYURhdGUpOwogICAgICAgIGlmKCAkYVllYXIgJSA0ID09IDApCiAgICAgICAgaWYoICEoJGFZZWFyICUgMTAwID09IDApIHx8ICgkYVllYXIgJSA0MDAgPT0gMCkgKQogICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KCiAgICAvLyBHZXQgY3VycmVudCB5ZWFyCiAgICBmdW5jdGlvbiBHZXRZZWFyKCRhRGF0ZSkgewogICAgICAgIHJldHVybiAwK0RhdGUoIlkiLCRhRGF0ZSk7CiAgICB9CgogICAgLy8gUmV0dXJuIG51bWJlciBvZiBkYXlzIGluIGEgeWVhcgogICAgZnVuY3Rpb24gR2V0TnVtRGF5c0luTW9udGgoJGFNb250aCwkYVllYXIpIHsKICAgICAgICAkZGF5cz1hcnJheSgzMSwyOCwzMSwzMCwzMSwzMCwzMSwzMSwzMCwzMSwzMCwzMSk7CiAgICAgICAgJGRheXNsPWFycmF5KDMxLDI5LDMxLDMwLDMxLDMwLDMxLDMxLDMwLDMxLDMwLDMxKTsKICAgICAgICBpZiggJHRoaXMtPklzTGVhcCgkYVllYXIpKQogICAgICAgIHJldHVybiAkZGF5c2xbJGFNb250aF07CiAgICAgICAgZWxzZQogICAgICAgIHJldHVybiAkZGF5c1skYU1vbnRoXTsKICAgIH0KCiAgICAvLyBHZXQgZGF5IGluIG1vbnRoCiAgICBmdW5jdGlvbiBHZXRNb250aERheU5icigkYURhdGUpIHsKICAgICAgICByZXR1cm4gMCtzdHJmdGltZSgiJWQiLCRhRGF0ZSk7CiAgICB9CgogICAgLy8gR2V0IGRheSBpbiB5ZWFyCiAgICBmdW5jdGlvbiBHZXRZZWFyRGF5TmJyKCRhRGF0ZSkgewogICAgICAgIHJldHVybiAwK3N0cmZ0aW1lKCIlaiIsJGFEYXRlKTsKICAgIH0KCiAgICAvLyBHZXQgbW9udGggbnVtYmVyCiAgICBmdW5jdGlvbiBHZXRNb250aE5icigkYURhdGUpIHsKICAgICAgICByZXR1cm4gMCtzdHJmdGltZSgiJW0iLCRhRGF0ZSk7CiAgICB9CgogICAgLy8gVHJhbnNsYXRlIGEgZGF0ZSB0byBzY3JlZW4gY29vcmRpbmF0ZXMgKGhvcml6b250YWwgc2NhbGUpCiAgICBmdW5jdGlvbiBUcmFuc2xhdGVEYXRlKCRhRGF0ZSkgewogICAgICAgIC8vCiAgICAgICAgLy8gSW4gb3JkZXIgdG8gaGFuZGxlIHRoZSBwcm9ibGVtIHdpdGggRGF5bGlnaHQgc2F2aW5ncyB0aW1lCiAgICAgICAgLy8gdGhlIHNjYWxlIHdyaXR0ZW4gd2l0aCBlcXVhbCBudW1iZXIgb2Ygc2Vjb25kcyBwZXIgZGF5IGJlZ2lubmluZwogICAgICAgIC8vIHdpdGggdGhlIHN0YXJ0IGRhdGUuIFRoaXMgbWVhbnMgdGhhdCB3ZSAiY2VtZW50IiB0aGUgc3RhdGUgb2YKICAgICAgICAvLyBEU1QgYXMgaXQgaXMgaW4gdGhlIHN0YXJ0IGRhdGUuIElmIGxhdGVyIHRoZSBzY2FsZSBpbmNsdWRlcyB0aGUKICAgICAgICAvLyBzd2l0Y2hvdmVyIGRhdGUgKGRlcGVuZHMgb24gdGhlIGxvY2FsZSkgd2UgbmVlZCB0byBhZGp1c3QgYmFjawogICAgICAgIC8vIGlmIHRoZSBkYXRlIHdlIHRyeSB0byB0cmFuc2xhdGUgaGFzIGEgZGlmZmVyZW50IERTVCBzdGF0dXMgc2luY2UKICAgICAgICAvLyB3ZSB3b3VsZCBvdGhlcndpc2UgYmUgb2ZmIGJ5IG9uZSBob3VyLgogICAgICAgICRhRGF0ZSA9ICR0aGlzLT5Ob3JtYWxpemVEYXRlKCRhRGF0ZSk7CiAgICAgICAgJHRtcCA9IGxvY2FsdGltZSgkYURhdGUpOwogICAgICAgICRjbG9jID0gJHRtcFs4XTsKICAgICAgICAkdG1wID0gbG9jYWx0aW1lKCR0aGlzLT5pU3RhcnREYXRlKTsKICAgICAgICAkc2xvYyA9ICR0bXBbOF07CiAgICAgICAgJG9mZnNldCA9IDA7CiAgICAgICAgaWYoICRzbG9jICE9ICRjbG9jKSB7CiAgICAgICAgICAgIGlmKCAkc2xvYyApCiAgICAgICAgICAgICRvZmZzZXQgPSAzNjAwOwogICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICRvZmZzZXQgPSAtMzYwMDsKICAgICAgICB9CiAgICAgICAgJGltZz0kdGhpcy0+aUltZzsKICAgICAgICByZXR1cm4gKCRhRGF0ZS0kdGhpcy0+aVN0YXJ0RGF0ZS0kb2Zmc2V0KS9TRUNQRVJEQVkqJHRoaXMtPkdldERheVdpZHRoKCkrJGltZy0+bGVmdF9tYXJnaW4rJHRoaXMtPmlMYWJlbFdpZHRoOzsKICAgIH0KCiAgICAvLyBHZXQgc2NyZWVuIGNvb3JkaW5hdGVzeiBmb3IgdGhlIHZlcnRpY2FsIHBvc2l0aW9uIGZvciBhIGJhcgogICAgZnVuY3Rpb24gVHJhbnNsYXRlVmVydFBvcygkYVBvcywkYXRUb3A9ZmFsc2UpIHsKICAgICAgICAkaW1nPSR0aGlzLT5pSW1nOwogICAgICAgIGlmKCAkYVBvcyA+ICR0aGlzLT5pVmVydExpbmVzICkKICAgICAgICAJSnBHcmFwaEVycm9yOjpSYWlzZUwoNjAxNSwkYVBvcyk7CiAgICAgICAgLy8gJ0lsbGVnYWwgdmVydGljYWwgcG9zaXRpb24gJWQnCiAgICAgICAgaWYoICR0aGlzLT5pVmVydExheW91dCA9PSBHQU5UVF9FVkVOICkgewogICAgICAgICAgICAvLyBQb3NpdGlvbiB0aGUgdG9wIGJhciBhdCAxIHZlcnQgc3BhY2luZyBmcm9tIHRoZSBzY2FsZQogICAgICAgICAgICAkcG9zID0gIHJvdW5kKCRpbWctPnRvcF9tYXJnaW4gKyAkdGhpcy0+aVZlcnRIZWFkZXJTaXplICsgICgkYVBvcysxKSokdGhpcy0+aVZlcnRTcGFjaW5nKTsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgIC8vIHBvc2l0aW9uIHRoZSB0b3AgYmFyIGF0IDEvMiBhIHZlcnQgc3BhY2luZyBmcm9tIHRoZSBzY2FsZQogICAgICAgICAgICAkcG9zID0gcm91bmQoJGltZy0+dG9wX21hcmdpbiArICR0aGlzLT5pVmVydEhlYWRlclNpemUgICsgJHRoaXMtPmlUb3BQbG90TWFyZ2luICsgKCRhUG9zKzEpKiR0aGlzLT5pVmVydFNwYWNpbmcpOwogICAgICAgIH0KCiAgICAgICAgaWYoICRhdFRvcCApCiAgICAgICAgICAgICRwb3MgLT0gJHRoaXMtPmlWZXJ0U3BhY2luZzsKCiAgICAgICAgcmV0dXJuICRwb3M7CiAgICB9CgogICAgLy8gV2hhdCBpcyB0aGUgdmVydGljYWwgc3BhY2luZz8KICAgIGZ1bmN0aW9uIEdldFZlcnRTcGFjaW5nKCkgewogICAgICAgIHJldHVybiAkdGhpcy0+aVZlcnRTcGFjaW5nOwogICAgfQoKICAgIC8vIENvbnZlcnQgYSBkYXRlIHRvIHRpbWVzdGFtcAogICAgZnVuY3Rpb24gTm9ybWFsaXplRGF0ZSgkYURhdGUpIHsKICAgICAgICBpZiggJGFEYXRlID09PSBmYWxzZSApIHJldHVybiBmYWxzZTsKICAgICAgICBpZiggaXNfc3RyaW5nKCRhRGF0ZSkgKSB7CiAgICAgICAgICAgICR0ID0gc3RydG90aW1lKCRhRGF0ZSk7CiAgICAgICAgICAgIGlmKCAkdCA9PT0gRkFMU0UgfHwgJHQgPT09IC0xICkgewogICAgICAgICAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoNjAxNiwkYURhdGUpOwogICAgICAgICAgICAgICAgLy8oIkRhdGUgc3RyaW5nICgkYURhdGUpIHNwZWNpZmllZCBmb3IgR2FudHQgYWN0aXZpdHkgY2FuIG5vdCBiZSBpbnRlcnByZXRhdGVkLiBQbGVhc2UgbWFrZSBzdXJlIGl0IGlzIGEgdmFsaWQgdGltZSBzdHJpbmcsIGUuZy4gMjAwNS0wNC0yMyAxMzozMCIpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiAkdDsKICAgICAgICB9CiAgICAgICAgZWxzZWlmKCBpc19pbnQoJGFEYXRlKSB8fCBpc19mbG9hdCgkYURhdGUpICkKICAgICAgICAgICAgcmV0dXJuICRhRGF0ZTsKICAgICAgICBlbHNlCiAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDYwMTcsJGFEYXRlKTsKICAgICAgICAvL1Vua25vd24gZGF0ZSBmb3JtYXQgaW4gR2FudHRTY2FsZSAoJGFEYXRlKS4iKTsKICAgIH0KCgogICAgLy8gQ29udmVydCBhIHRpbWUgc3RyaW5nIHRvIG1pbnV0ZXMKCiAgICBmdW5jdGlvbiBUaW1lVG9NaW51dGVzKCRhVGltZVN0cmluZykgewogICAgICAgIC8vIFNwbGl0IGluIGhvdXJzIGFuZCBtaW51dGVzCiAgICAgICAgJHBvcz1zdHJwb3MoJGFUaW1lU3RyaW5nLCc6Jyk7CiAgICAgICAgJG1pbmludD02MDsKICAgICAgICBpZiggJHBvcyA9PT0gZmFsc2UgKSB7CiAgICAgICAgICAgICRob3VyaW50ID0gJGFUaW1lU3RyaW5nOwogICAgICAgICAgICAkbWluaW50ID0gMDsKICAgICAgICB9CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICRob3VyaW50ID0gZmxvb3Ioc3Vic3RyKCRhVGltZVN0cmluZywwLCRwb3MpKTsKICAgICAgICAgICAgJG1pbmludCA9IGZsb29yKHN1YnN0cigkYVRpbWVTdHJpbmcsJHBvcysxKSk7CiAgICAgICAgfQogICAgICAgICRtaW5pbnQgKz0gNjAgKiAkaG91cmludDsKICAgICAgICByZXR1cm4gJG1pbmludDsKICAgIH0KCiAgICAvLyBTdHJva2UgdGhlIGRheSBzY2FsZSAoaW5jbHVkaW5nIGdyaWRsaW5lcykKICAgIGZ1bmN0aW9uIFN0cm9rZU1pbnV0ZXMoJGFZQ29vcmQsJGdldEhlaWdodD1mYWxzZSkgewogICAgICAgICRpbWc9JHRoaXMtPmlJbWc7CiAgICAgICAgJHh0PSRpbWctPmxlZnRfbWFyZ2luKyR0aGlzLT5pTGFiZWxXaWR0aDsKICAgICAgICAkeXQ9JGFZQ29vcmQrJGltZy0+dG9wX21hcmdpbjsKICAgICAgICBpZiggJHRoaXMtPm1pbnV0ZS0+aVNob3dMYWJlbHMgKSB7CiAgICAgICAgICAgICRpbWctPlNldEZvbnQoJHRoaXMtPm1pbnV0ZS0+aUZGYW1pbHksJHRoaXMtPm1pbnV0ZS0+aUZTdHlsZSwkdGhpcy0+bWludXRlLT5pRlNpemUpOwogICAgICAgICAgICAkeWIgPSAkeXQgKyAkaW1nLT5HZXRGb250SGVpZ2h0KCkgKwogICAgICAgICAgICAkdGhpcy0+bWludXRlLT5pVGl0bGVWZXJ0TWFyZ2luICsgJHRoaXMtPm1pbnV0ZS0+aUZyYW1lV2VpZ2h0OwogICAgICAgICAgICBpZiggJGdldEhlaWdodCApIHsKICAgICAgICAgICAgICAgIHJldHVybiAkeWIgLSAkaW1nLT50b3BfbWFyZ2luOwogICAgICAgICAgICB9CiAgICAgICAgICAgICR4YiA9ICRpbWctPndpZHRoLSRpbWctPnJpZ2h0X21hcmdpbisxOwogICAgICAgICAgICAkaW1nLT5TZXRDb2xvcigkdGhpcy0+bWludXRlLT5pQmFja2dyb3VuZENvbG9yKTsKICAgICAgICAgICAgJGltZy0+RmlsbGVkUmVjdGFuZ2xlKCR4dCwkeXQsJHhiLCR5Yik7CgogICAgICAgICAgICAkeCA9ICR4dDsKICAgICAgICAgICAgJGltZy0+U2V0VGV4dEFsaWduKCJjZW50ZXIiKTsKICAgICAgICAgICAgJGRheSA9IGRhdGUoJ3cnLCR0aGlzLT5pU3RhcnREYXRlKTsKICAgICAgICAgICAgJG1pbmludCA9ICR0aGlzLT5taW51dGUtPkdldEludGVydmFsbCgpIDsKCiAgICAgICAgICAgIGlmKCA2MCAlICRtaW5pbnQgIT09IDAgKSB7CiAgICAgICAgICAgICAgICBKcEdyYXBoRXJyb3I6OlJhaXNlTCg2MDE4LCRtaW5pbnQpOwogICAgICAgICAgICAgICAgLy8nSW50ZXJ2YWxsIGZvciBtaW51dGVzIG11c3QgZGl2aWRlIHRoZSBob3VyIGV2ZW5seSwgZS5nLiAxLDUsMTAsMTIsMTUsMjAsMzAgZXRjIFlvdSBoYXZlIHNwZWNpZmllZCBhbiBpbnRlcnZhbGwgb2YgJy4kbWluaW50LicgbWludXRlcy4nKTsKICAgICAgICAgICAgfQoKCiAgICAgICAgICAgICRuID0gNjAgLyAkbWluaW50OwogICAgICAgICAgICAkZGF0ZXN0YW1wID0gJHRoaXMtPmlTdGFydERhdGU7CiAgICAgICAgICAgICR3aWR0aCA9ICR0aGlzLT5HZXRIb3VyV2lkdGgoKSAvICRuIDsKICAgICAgICAgICAgaWYoICR3aWR0aCA8IDggKSB7CiAgICAgICAgICAgICAgICAvLyBUTyBzbWFsbCB3aWR0aCB0byBkcmF3IG1pbnV0ZSBzY2FsZQogICAgICAgICAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoNjAxOSwkd2lkdGgpOwogICAgICAgICAgICAgICAgLy8oJ1RoZSBhdmFpbGFibGUgd2lkdGggKCcuJHdpZHRoLicpIGZvciBtaW51dGVzIGFyZSB0byBzbWFsbCBmb3IgdGhpcyBzY2FsZSB0byBiZSBkaXNwbGF5ZWQuIFBsZWFzZSB1c2UgYXV0by1zaXppbmcgb3IgaW5jcmVhc2UgdGhlIHdpZHRoIG9mIHRoZSBncmFwaC4nKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJG5oID0gY2VpbCgyNCo2MCAvICR0aGlzLT5UaW1lVG9NaW51dGVzKCR0aGlzLT5ob3VyLT5HZXRJbnRlcnZhbGwoKSkgKTsKICAgICAgICAgICAgJG5kID0gJHRoaXMtPkdldE51bWJlck9mRGF5cygpOwogICAgICAgICAgICAvLyBDb252ZXJ0IHRvIGludGVydmFsbCB0byBzZWNvbmRzCiAgICAgICAgICAgICRtaW5pbnQgKj0gNjA7CiAgICAgICAgICAgIGZvcigkaj0wOyAkaiA8ICRuZDsgKyskaiwgJGRheSArPSAxLCAkZGF5ICU9IDcpIHsKICAgICAgICAgICAgICAgIGZvciggJGs9MDsgJGsgPCAkbmg7ICsrJGsgKSB7CiAgICAgICAgICAgICAgICAgICAgZm9yKCRpPTA7ICRpIDwgJG4gOysrJGksICR4Kz0kd2lkdGgsICRkYXRlc3RhbXAgKz0gJG1pbmludCApIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYoICRkYXk9PTYgfHwgJGRheT09MCApIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaW1nLT5QdXNoQ29sb3IoJHRoaXMtPmRheS0+aVdlZWtlbmRCYWNrZ3JvdW5kQ29sb3IpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoICR0aGlzLT5pVXNlUGxvdFdlZWtlbmRCYWNrZ3JvdW5kICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRpbWctPkZpbGxlZFJlY3RhbmdsZSgkeCwkeXQrJHRoaXMtPmRheS0+aUZyYW1lV2VpZ2h0LCR4KyR3aWR0aCwkaW1nLT5oZWlnaHQtJGltZy0+Ym90dG9tX21hcmdpbik7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaW1nLT5GaWxsZWRSZWN0YW5nbGUoJHgsJHl0KyR0aGlzLT5kYXktPmlGcmFtZVdlaWdodCwkeCskd2lkdGgsJHliLSR0aGlzLT5kYXktPmlGcmFtZVdlaWdodCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaW1nLT5Qb3BDb2xvcigpOwoKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYoICRkYXk9PTAgKQogICAgICAgICAgICAgICAgICAgICAgICAkaW1nLT5TZXRDb2xvcigkdGhpcy0+ZGF5LT5pU3VuZGF5VGV4dENvbG9yKTsKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAkaW1nLT5TZXRDb2xvcigkdGhpcy0+ZGF5LT5pVGV4dENvbG9yKTsKCiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCggJHRoaXMtPm1pbnV0ZS0+aVN0eWxlICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBNSU5VVEVTVFlMRV9DVVNUT006CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHR4dCA9IGRhdGUoJHRoaXMtPm1pbnV0ZS0+aUxhYmVsRm9ybVN0ciwkZGF0ZXN0YW1wKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgTUlOVVRFU1RZTEVfTU06CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIDE1CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHR4dCA9IGRhdGUoJ2knLCRkYXRlc3RhbXApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICRpbWctPlN0cm9rZVRleHQocm91bmQoJHgrJHdpZHRoLzIpLHJvdW5kKCR5Yi0kdGhpcy0+bWludXRlLT5pVGl0bGVWZXJ0TWFyZ2luKSwkdHh0KTsKCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEZpeCBhIHJvdW5kaW5nIHByb2JsZW0gdGhlIHdyb25nIHdheSAuLgogICAgICAgICAgICAgICAgICAgICAgICAvLyBJZiB3ZSBhbHNvIGhhdmUgaG91ciBzY2FsZSB0aGVuIGRvbid0IGRyYXcgdGhlIGZpcnN0YSBvciBsYXN0CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdyaWRsaW5lIHNpbmNlIHRoYXQgd2lsbCBiZSBvdmVyd3JpdHRlbiBieSB0aGUgaG91ciBzY2FsZSBncmlkbGluZSBpZiBzdWNoIGV4aXN0cy4KICAgICAgICAgICAgICAgICAgICAgICAgLy8gSG93ZXZlciwgZHVlIHRvIHRoZSBwcm9wYWdhdGlvbiBvZiByb3VuZGluZyBvZiB0aGUgJ3grPXdpZHRoJyB0ZXJtIGluIHRoZSBsb29wCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoaXMgbWlnaHQgc29tZXRpbWVzIGJlIG9uZSBwaXhlbCBvZiBzbyB3ZSBmaXggdGhpcyBieSBub3QgZHJhd2luZyBpdC4KICAgICAgICAgICAgICAgICAgICAgICAgLy8gVGhlIHByb3BlciB3YXkgdG8gZml4IGl0IHdvdWxkIGJlIHRvIHJlLWNhbGN1bGF0ZSB0aGUgc2NhbGUgZm9yIGVhY2ggc3RlcCBhbmQKICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm90IHVzaW5nIHRoZSBhZGRpdGl2ZSB0ZXJtLgogICAgICAgICAgICAgICAgICAgICAgICBpZiggISgoJGkgPT0gJG4gfHwgJGk9PTApICYmICR0aGlzLT5ob3VyLT5pU2hvd0xhYmVscyAmJiAkdGhpcy0+aG91ci0+Z3JpZC0+aVNob3cpICkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGltZy0+U2V0Q29sb3IoJHRoaXMtPm1pbnV0ZS0+Z3JpZC0+aUNvbG9yKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRpbWctPlNldExpbmVXZWlnaHQoJHRoaXMtPm1pbnV0ZS0+Z3JpZC0+aVdlaWdodCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkaW1nLT5MaW5lKCR4LCR5dCwkeCwkeWIpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPm1pbnV0ZS0+Z3JpZC0+U3Ryb2tlKCRpbWcsJHgsJHliLCR4LCRpbWctPmhlaWdodC0kaW1nLT5ib3R0b21fbWFyZ2luKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAkaW1nLT5TZXRDb2xvcigkdGhpcy0+bWludXRlLT5pRnJhbWVDb2xvcik7CiAgICAgICAgICAgICRpbWctPlNldExpbmVXZWlnaHQoJHRoaXMtPm1pbnV0ZS0+aUZyYW1lV2VpZ2h0KTsKICAgICAgICAgICAgJGltZy0+UmVjdGFuZ2xlKCR4dCwkeXQsJHhiLCR5Yik7CiAgICAgICAgICAgIHJldHVybiAkeWIgLSAkaW1nLT50b3BfbWFyZ2luOwogICAgICAgIH0KICAgICAgICByZXR1cm4gJGFZQ29vcmQ7CiAgICB9CgogICAgLy8gU3Ryb2tlIHRoZSBkYXkgc2NhbGUgKGluY2x1ZGluZyBncmlkbGluZXMpCiAgICBmdW5jdGlvbiBTdHJva2VIb3VycygkYVlDb29yZCwkZ2V0SGVpZ2h0PWZhbHNlKSB7CiAgICAgICAgJGltZz0kdGhpcy0+aUltZzsKICAgICAgICAkeHQ9JGltZy0+bGVmdF9tYXJnaW4rJHRoaXMtPmlMYWJlbFdpZHRoOwogICAgICAgICR5dD0kYVlDb29yZCskaW1nLT50b3BfbWFyZ2luOwogICAgICAgIGlmKCAkdGhpcy0+aG91ci0+aVNob3dMYWJlbHMgKSB7CiAgICAgICAgICAgICRpbWctPlNldEZvbnQoJHRoaXMtPmhvdXItPmlGRmFtaWx5LCR0aGlzLT5ob3VyLT5pRlN0eWxlLCR0aGlzLT5ob3VyLT5pRlNpemUpOwogICAgICAgICAgICAkeWIgPSAkeXQgKyAkaW1nLT5HZXRGb250SGVpZ2h0KCkgKwogICAgICAgICAgICAkdGhpcy0+aG91ci0+aVRpdGxlVmVydE1hcmdpbiArICR0aGlzLT5ob3VyLT5pRnJhbWVXZWlnaHQ7CiAgICAgICAgICAgIGlmKCAkZ2V0SGVpZ2h0ICkgewogICAgICAgICAgICAgICAgcmV0dXJuICR5YiAtICRpbWctPnRvcF9tYXJnaW47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJHhiID0gJGltZy0+d2lkdGgtJGltZy0+cmlnaHRfbWFyZ2luKzE7CiAgICAgICAgICAgICRpbWctPlNldENvbG9yKCR0aGlzLT5ob3VyLT5pQmFja2dyb3VuZENvbG9yKTsKICAgICAgICAgICAgJGltZy0+RmlsbGVkUmVjdGFuZ2xlKCR4dCwkeXQsJHhiLCR5Yik7CgogICAgICAgICAgICAkeCA9ICR4dDsKICAgICAgICAgICAgJGltZy0+U2V0VGV4dEFsaWduKCJjZW50ZXIiKTsKICAgICAgICAgICAgJHRtcCA9ICR0aGlzLT5ob3VyLT5HZXRJbnRlcnZhbGwoKSA7CiAgICAgICAgICAgICRtaW5pbnQgPSAkdGhpcy0+VGltZVRvTWludXRlcygkdG1wKTsKICAgICAgICAgICAgaWYoIDE0NDAgJSAkbWluaW50ICE9PSAwICkgewogICAgICAgICAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoNjAyMCwkdG1wKTsKICAgICAgICAgICAgICAgIC8vKCdJbnRlcnZhbGwgZm9yIGhvdXJzIG11c3QgZGl2aWRlIHRoZSBkYXkgZXZlbmx5LCBlLmcuIDA6MzAsIDE6MDAsIDE6MzAsIDQ6MDAgZXRjLiBZb3UgaGF2ZSBzcGVjaWZpZWQgYW4gaW50ZXJ2YWxsIG9mICcuJHRtcCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRuID0gY2VpbCgyNCo2MCAvICRtaW5pbnQgKTsKICAgICAgICAgICAgJGRhdGVzdGFtcCA9ICR0aGlzLT5pU3RhcnREYXRlOwogICAgICAgICAgICAkZGF5ID0gZGF0ZSgndycsJHRoaXMtPmlTdGFydERhdGUpOwogICAgICAgICAgICAkZG9iYWNrID0gISR0aGlzLT5taW51dGUtPmlTaG93TGFiZWxzOwogICAgICAgICAgICAkd2lkdGggPSAkdGhpcy0+R2V0RGF5V2lkdGgoKSAvICRuIDsKICAgICAgICAgICAgZm9yKCRqPTA7ICRqIDwgJHRoaXMtPkdldE51bWJlck9mRGF5cygpOyArKyRqLCAkZGF5ICs9IDEsJGRheSAlPSA3KSB7CiAgICAgICAgICAgICAgICBmb3IoJGk9MDsgJGkgPCAkbiA7KyskaSwgJHgrPSR3aWR0aCkgewogICAgICAgICAgICAgICAgICAgIGlmKCAkZGF5PT02IHx8ICRkYXk9PTAgKSB7CgogICAgICAgICAgICAgICAgICAgICAgICAkaW1nLT5QdXNoQ29sb3IoJHRoaXMtPmRheS0+aVdlZWtlbmRCYWNrZ3JvdW5kQ29sb3IpOwogICAgICAgICAgICAgICAgICAgICAgICBpZiggJHRoaXMtPmlVc2VQbG90V2Vla2VuZEJhY2tncm91bmQgJiYgJGRvYmFjayApCiAgICAgICAgICAgICAgICAgICAgICAgICRpbWctPkZpbGxlZFJlY3RhbmdsZSgkeCwkeXQrJHRoaXMtPmRheS0+aUZyYW1lV2VpZ2h0LCR4KyR3aWR0aCwkaW1nLT5oZWlnaHQtJGltZy0+Ym90dG9tX21hcmdpbik7CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgJGltZy0+RmlsbGVkUmVjdGFuZ2xlKCR4LCR5dCskdGhpcy0+ZGF5LT5pRnJhbWVXZWlnaHQsJHgrJHdpZHRoLCR5Yi0kdGhpcy0+ZGF5LT5pRnJhbWVXZWlnaHQpOwogICAgICAgICAgICAgICAgICAgICAgICAkaW1nLT5Qb3BDb2xvcigpOwoKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmKCAkZGF5PT0wICkKICAgICAgICAgICAgICAgICAgICAkaW1nLT5TZXRDb2xvcigkdGhpcy0+ZGF5LT5pU3VuZGF5VGV4dENvbG9yKTsKICAgICAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgJGltZy0+U2V0Q29sb3IoJHRoaXMtPmRheS0+aVRleHRDb2xvcik7CgogICAgICAgICAgICAgICAgICAgIHN3aXRjaCggJHRoaXMtPmhvdXItPmlTdHlsZSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBIT1VSU1RZTEVfSE1BTVBNOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gMTozNXBtCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdHh0ID0gZGF0ZSgnZzppYScsJGRhdGVzdGFtcCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBIT1VSU1RZTEVfSDI0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gMTMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0eHQgPSBkYXRlKCdIJywkZGF0ZXN0YW1wKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIEhPVVJTVFlMRV9IQU1QTToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0eHQgPSBkYXRlKCdnYScsJGRhdGVzdGFtcCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBIT1VSU1RZTEVfQ1VTVE9NOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHR4dCA9IGRhdGUoJHRoaXMtPmhvdXItPmlMYWJlbEZvcm1TdHIsJGRhdGVzdGFtcCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBIT1VSU1RZTEVfSE0yNDoKICAgICAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0eHQgPSBkYXRlKCdIOmknLCRkYXRlc3RhbXApOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICRpbWctPlN0cm9rZVRleHQocm91bmQoJHgrJHdpZHRoLzIpLHJvdW5kKCR5Yi0kdGhpcy0+aG91ci0+aVRpdGxlVmVydE1hcmdpbiksJHR4dCk7CiAgICAgICAgICAgICAgICAgICAgJGltZy0+U2V0Q29sb3IoJHRoaXMtPmhvdXItPmdyaWQtPmlDb2xvcik7CiAgICAgICAgICAgICAgICAgICAgJGltZy0+U2V0TGluZVdlaWdodCgkdGhpcy0+aG91ci0+Z3JpZC0+aVdlaWdodCk7CiAgICAgICAgICAgICAgICAgICAgJGltZy0+TGluZSgkeCwkeXQsJHgsJHliKTsKICAgICAgICAgICAgICAgICAgICAkdGhpcy0+aG91ci0+Z3JpZC0+U3Ryb2tlKCRpbWcsJHgsJHliLCR4LCRpbWctPmhlaWdodC0kaW1nLT5ib3R0b21fbWFyZ2luKTsKICAgICAgICAgICAgICAgICAgICAvLyRkYXRlc3RhbXAgKz0gJG1pbmludCo2MAogICAgICAgICAgICAgICAgICAgICRkYXRlc3RhbXAgPSBta3RpbWUoZGF0ZSgnSCcsJGRhdGVzdGFtcCksZGF0ZSgnaScsJGRhdGVzdGFtcCkrJG1pbmludCwwLAogICAgICAgICAgICAgICAgICAgIGRhdGUoIm0iLCRkYXRlc3RhbXApLGRhdGUoImQiLCRkYXRlc3RhbXApKzEsZGF0ZSgiWSIsJGRhdGVzdGFtcCkpOwoKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAkaW1nLT5TZXRDb2xvcigkdGhpcy0+aG91ci0+aUZyYW1lQ29sb3IpOwogICAgICAgICAgICAkaW1nLT5TZXRMaW5lV2VpZ2h0KCR0aGlzLT5ob3VyLT5pRnJhbWVXZWlnaHQpOwogICAgICAgICAgICAkaW1nLT5SZWN0YW5nbGUoJHh0LCR5dCwkeGIsJHliKTsKICAgICAgICAgICAgcmV0dXJuICR5YiAtICRpbWctPnRvcF9tYXJnaW47CiAgICAgICAgfQogICAgICAgIHJldHVybiAkYVlDb29yZDsKICAgIH0KCgogICAgLy8gU3Ryb2tlIHRoZSBkYXkgc2NhbGUgKGluY2x1ZGluZyBncmlkbGluZXMpCiAgICBmdW5jdGlvbiBTdHJva2VEYXlzKCRhWUNvb3JkLCRnZXRIZWlnaHQ9ZmFsc2UpIHsKICAgICAgICAkaW1nPSR0aGlzLT5pSW1nOwogICAgICAgICRkYXl3aWR0aD0kdGhpcy0+R2V0RGF5V2lkdGgoKTsKICAgICAgICAkeHQ9JGltZy0+bGVmdF9tYXJnaW4rJHRoaXMtPmlMYWJlbFdpZHRoOwogICAgICAgICR5dD0kYVlDb29yZCskaW1nLT50b3BfbWFyZ2luOwogICAgICAgIGlmKCAkdGhpcy0+ZGF5LT5pU2hvd0xhYmVscyApIHsKICAgICAgICAgICAgJGltZy0+U2V0Rm9udCgkdGhpcy0+ZGF5LT5pRkZhbWlseSwkdGhpcy0+ZGF5LT5pRlN0eWxlLCR0aGlzLT5kYXktPmlGU2l6ZSk7CiAgICAgICAgICAgICR5Yj0keXQgKyAkaW1nLT5HZXRGb250SGVpZ2h0KCkgKyAkdGhpcy0+ZGF5LT5pVGl0bGVWZXJ0TWFyZ2luICsgJHRoaXMtPmRheS0+aUZyYW1lV2VpZ2h0OwogICAgICAgICAgICBpZiggJGdldEhlaWdodCApIHsKICAgICAgICAgICAgICAgIHJldHVybiAkeWIgLSAkaW1nLT50b3BfbWFyZ2luOwogICAgICAgICAgICB9CiAgICAgICAgICAgICR4Yj0kaW1nLT53aWR0aC0kaW1nLT5yaWdodF9tYXJnaW4rMTsKICAgICAgICAgICAgJGltZy0+U2V0Q29sb3IoJHRoaXMtPmRheS0+aUJhY2tncm91bmRDb2xvcik7CiAgICAgICAgICAgICRpbWctPkZpbGxlZFJlY3RhbmdsZSgkeHQsJHl0LCR4YiwkeWIpOwoKICAgICAgICAgICAgJHggPSAkeHQ7CiAgICAgICAgICAgICRpbWctPlNldFRleHRBbGlnbigiY2VudGVyIik7CiAgICAgICAgICAgICRkYXkgPSBkYXRlKCd3JywkdGhpcy0+aVN0YXJ0RGF0ZSk7CiAgICAgICAgICAgICRkYXRlc3RhbXAgPSAkdGhpcy0+aVN0YXJ0RGF0ZTsKCiAgICAgICAgICAgICRkb2JhY2sgPSAhKCR0aGlzLT5ob3VyLT5pU2hvd0xhYmVscyB8fCAkdGhpcy0+bWludXRlLT5pU2hvd0xhYmVscyk7CgogICAgICAgICAgICBzZXRsb2NhbGUoTENfVElNRSwkdGhpcy0+aURhdGVMb2NhbGUtPmlMb2NhbGUpOwoKICAgICAgICAgICAgZm9yKCRpPTA7ICRpIDwgJHRoaXMtPkdldE51bWJlck9mRGF5cygpOyArKyRpLCAkeCs9JGRheXdpZHRoLCAkZGF5ICs9IDEsJGRheSAlPSA3KSB7CiAgICAgICAgICAgICAgICBpZiggJGRheT09NiB8fCAkZGF5PT0wICkgewogICAgICAgICAgICAgICAgICAgICRpbWctPlNldENvbG9yKCR0aGlzLT5kYXktPmlXZWVrZW5kQmFja2dyb3VuZENvbG9yKTsKICAgICAgICAgICAgICAgICAgICBpZiggJHRoaXMtPmlVc2VQbG90V2Vla2VuZEJhY2tncm91bmQgJiYgJGRvYmFjaykKICAgICAgICAgICAgICAgICAgICAgICAgJGltZy0+RmlsbGVkUmVjdGFuZ2xlKCR4LCR5dCskdGhpcy0+ZGF5LT5pRnJhbWVXZWlnaHQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkeCskZGF5d2lkdGgsJGltZy0+aGVpZ2h0LSRpbWctPmJvdHRvbV9tYXJnaW4pOwogICAgICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAgICAgJGltZy0+RmlsbGVkUmVjdGFuZ2xlKCR4LCR5dCskdGhpcy0+ZGF5LT5pRnJhbWVXZWlnaHQsCiAgICAgICAgICAgICAgICAgICAgJHgrJGRheXdpZHRoLCR5Yi0kdGhpcy0+ZGF5LT5pRnJhbWVXZWlnaHQpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICRtbiA9IHN0cmZ0aW1lKCclbScsJGRhdGVzdGFtcCk7CiAgICAgICAgICAgICAgICBpZiggJG1uWzBdPT0nMCcgKQogICAgICAgICAgICAgICAgICAgICRtbiA9ICRtblsxXTsKCiAgICAgICAgICAgICAgICBzd2l0Y2goICR0aGlzLT5kYXktPmlTdHlsZSApIHsKICAgICAgICAgICAgICAgICAgICBjYXNlIERBWVNUWUxFX0xPTkc6CiAgICAgICAgICAgICAgICAgICAgICAgIC8vICJNb25kYXkiCiAgICAgICAgICAgICAgICAgICAgICAgICR0eHQgPSBzdHJmdGltZSgnJUEnLCRkYXRlc3RhbXApOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIERBWVNUWUxFX1NIT1JUOgogICAgICAgICAgICAgICAgICAgICAgICAvLyAiTW9uIgogICAgICAgICAgICAgICAgICAgICAgICAkdHh0ID0gc3RyZnRpbWUoJyVhJywkZGF0ZXN0YW1wKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBEQVlTVFlMRV9TSE9SVERBWURBVEUxOgogICAgICAgICAgICAgICAgICAgICAgICAvLyAiTW9uIDIzLzYiCiAgICAgICAgICAgICAgICAgICAgICAgICR0eHQgPSBzdHJmdGltZSgnJWEgJWQvJy4kbW4sJGRhdGVzdGFtcCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgREFZU1RZTEVfU0hPUlREQVlEQVRFMjoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gIk1vbiAyMyBKdW4iCiAgICAgICAgICAgICAgICAgICAgICAgICR0eHQgPSBzdHJmdGltZSgnJWEgJWQgJWInLCRkYXRlc3RhbXApOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIERBWVNUWUxFX1NIT1JUREFZREFURTM6CiAgICAgICAgICAgICAgICAgICAgICAgIC8vICJNb24gMjMgSnVuIDIwMDMiCiAgICAgICAgICAgICAgICAgICAgICAgICR0eHQgPSBzdHJmdGltZSgnJWEgJWQgJWIgJVknLCRkYXRlc3RhbXApOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIERBWVNUWUxFX0xPTkdEQVlEQVRFMToKICAgICAgICAgICAgICAgICAgICAgICAgLy8gIk1vbmRheSAyMyBKdW4iCiAgICAgICAgICAgICAgICAgICAgICAgICR0eHQgPSBzdHJmdGltZSgnJUEgJWQgJWInLCRkYXRlc3RhbXApOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIERBWVNUWUxFX0xPTkdEQVlEQVRFMjoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gIk1vbmRheSAyMyBKdW4gMjAwMyIKICAgICAgICAgICAgICAgICAgICAgICAgJHR4dCA9IHN0cmZ0aW1lKCclQSAlZCAlYiAlWScsJGRhdGVzdGFtcCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgREFZU1RZTEVfU0hPUlREQVRFMToKICAgICAgICAgICAgICAgICAgICAgICAgLy8gIjIzLzYiCiAgICAgICAgICAgICAgICAgICAgICAgICR0eHQgPSBzdHJmdGltZSgnJWQvJy4kbW4sJGRhdGVzdGFtcCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgREFZU1RZTEVfU0hPUlREQVRFMjoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gIjIzIEp1biIKICAgICAgICAgICAgICAgICAgICAgICAgJHR4dCA9IHN0cmZ0aW1lKCclZCAlYicsJGRhdGVzdGFtcCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgREFZU1RZTEVfU0hPUlREQVRFMzoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gIk1vbiAyMyIKICAgICAgICAgICAgICAgICAgICAgICAgJHR4dCA9IHN0cmZ0aW1lKCclYSAlZCcsJGRhdGVzdGFtcCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgREFZU1RZTEVfU0hPUlREQVRFNDoKICAgICAgICAgICAgICAgICAgICAgICAgLy8gIjIzIgogICAgICAgICAgICAgICAgICAgICAgICAkdHh0ID0gc3RyZnRpbWUoJyVkJywkZGF0ZXN0YW1wKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSBEQVlTVFlMRV9DVVNUT006CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEN1c3RvbSBmb3JtYXQKICAgICAgICAgICAgICAgICAgICAgICAgJHR4dCA9IHN0cmZ0aW1lKCR0aGlzLT5kYXktPmlMYWJlbEZvcm1TdHIsJGRhdGVzdGFtcCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgREFZU1RZTEVfT05FTEVUVEVSOgogICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIC8vICJNIgogICAgICAgICAgICAgICAgICAgICAgICAkdHh0ID0gc3RyZnRpbWUoJyVBJywkZGF0ZXN0YW1wKTsKICAgICAgICAgICAgICAgICAgICAgICAgJHR4dCA9IHN0cnRvdXBwZXIoJHR4dFswXSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmKCAkZGF5PT0wICkKICAgICAgICAgICAgICAgICAgICAkaW1nLT5TZXRDb2xvcigkdGhpcy0+ZGF5LT5pU3VuZGF5VGV4dENvbG9yKTsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAkaW1nLT5TZXRDb2xvcigkdGhpcy0+ZGF5LT5pVGV4dENvbG9yKTsKICAgICAgICAgICAgICAgICRpbWctPlN0cm9rZVRleHQocm91bmQoJHgrJGRheXdpZHRoLzIrMSksCiAgICAgICAgICAgICAgICByb3VuZCgkeWItJHRoaXMtPmRheS0+aVRpdGxlVmVydE1hcmdpbiksJHR4dCk7CiAgICAgICAgICAgICAgICAkaW1nLT5TZXRDb2xvcigkdGhpcy0+ZGF5LT5ncmlkLT5pQ29sb3IpOwogICAgICAgICAgICAgICAgJGltZy0+U2V0TGluZVdlaWdodCgkdGhpcy0+ZGF5LT5ncmlkLT5pV2VpZ2h0KTsKICAgICAgICAgICAgICAgICRpbWctPkxpbmUoJHgsJHl0LCR4LCR5Yik7CiAgICAgICAgICAgICAgICAkdGhpcy0+ZGF5LT5ncmlkLT5TdHJva2UoJGltZywkeCwkeWIsJHgsJGltZy0+aGVpZ2h0LSRpbWctPmJvdHRvbV9tYXJnaW4pOwogICAgICAgICAgICAgICAgJGRhdGVzdGFtcCA9IG1rdGltZSgwLDAsMCxkYXRlKCJtIiwkZGF0ZXN0YW1wKSxkYXRlKCJkIiwkZGF0ZXN0YW1wKSsxLGRhdGUoIlkiLCRkYXRlc3RhbXApKTsKICAgICAgICAgICAgICAgIC8vJGRhdGVzdGFtcCArPSBTRUNQRVJEQVk7CgogICAgICAgICAgICB9CiAgICAgICAgICAgICRpbWctPlNldENvbG9yKCR0aGlzLT5kYXktPmlGcmFtZUNvbG9yKTsKICAgICAgICAgICAgJGltZy0+U2V0TGluZVdlaWdodCgkdGhpcy0+ZGF5LT5pRnJhbWVXZWlnaHQpOwogICAgICAgICAgICAkaW1nLT5SZWN0YW5nbGUoJHh0LCR5dCwkeGIsJHliKTsKICAgICAgICAgICAgcmV0dXJuICR5YiAtICRpbWctPnRvcF9tYXJnaW47CiAgICAgICAgfQogICAgICAgIHJldHVybiAkYVlDb29yZDsKICAgIH0KCiAgICAvLyBTdHJva2Ugd2VlayBoZWFkZXIgYW5kIGdyaWQKICAgIGZ1bmN0aW9uIFN0cm9rZVdlZWtzKCRhWUNvb3JkLCRnZXRIZWlnaHQ9ZmFsc2UpIHsKICAgICAgICBpZiggJHRoaXMtPndlZWstPmlTaG93TGFiZWxzICkgewogICAgICAgICAgICAkaW1nPSR0aGlzLT5pSW1nOwogICAgICAgICAgICAkeXQ9JGFZQ29vcmQrJGltZy0+dG9wX21hcmdpbjsKICAgICAgICAgICAgJGltZy0+U2V0Rm9udCgkdGhpcy0+d2Vlay0+aUZGYW1pbHksJHRoaXMtPndlZWstPmlGU3R5bGUsJHRoaXMtPndlZWstPmlGU2l6ZSk7CiAgICAgICAgICAgICR5Yj0keXQgKyAkaW1nLT5HZXRGb250SGVpZ2h0KCkgKyAkdGhpcy0+d2Vlay0+aVRpdGxlVmVydE1hcmdpbiArICR0aGlzLT53ZWVrLT5pRnJhbWVXZWlnaHQ7CgogICAgICAgICAgICBpZiggJGdldEhlaWdodCApIHsKICAgICAgICAgICAgICAgIHJldHVybiAkeWIgLSAkaW1nLT50b3BfbWFyZ2luOwogICAgICAgICAgICB9CgogICAgICAgICAgICAkeHQ9JGltZy0+bGVmdF9tYXJnaW4rJHRoaXMtPmlMYWJlbFdpZHRoOwogICAgICAgICAgICAkd2Vla3dpZHRoPSR0aGlzLT5HZXREYXlXaWR0aCgpKjc7CiAgICAgICAgICAgICR3ZGF5cz0kdGhpcy0+aURhdGVMb2NhbGUtPkdldERheUFiYigpOwogICAgICAgICAgICAkeGI9JGltZy0+d2lkdGgtJGltZy0+cmlnaHRfbWFyZ2luKzE7CiAgICAgICAgICAgICR3ZWVrID0gJHRoaXMtPmlTdGFydERhdGU7CiAgICAgICAgICAgICR3ZWVrbmJyPSR0aGlzLT5HZXRXZWVrTmJyKCR3ZWVrKTsKICAgICAgICAgICAgJGltZy0+U2V0Q29sb3IoJHRoaXMtPndlZWstPmlCYWNrZ3JvdW5kQ29sb3IpOwogICAgICAgICAgICAkaW1nLT5GaWxsZWRSZWN0YW5nbGUoJHh0LCR5dCwkeGIsJHliKTsKICAgICAgICAgICAgJGltZy0+U2V0Q29sb3IoJHRoaXMtPndlZWstPmdyaWQtPmlDb2xvcik7CiAgICAgICAgICAgICR4ID0gJHh0OwogICAgICAgICAgICBpZiggJHRoaXMtPndlZWstPmlTdHlsZT09V0VFS1NUWUxFX1dOQlIgKSB7CiAgICAgICAgICAgICAgICAkaW1nLT5TZXRUZXh0QWxpZ24oImNlbnRlciIpOwogICAgICAgICAgICAgICAgJHR4dE9mZnNldCA9ICR3ZWVrd2lkdGgvMisxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2VpZiggJHRoaXMtPndlZWstPmlTdHlsZT09V0VFS1NUWUxFX0ZJUlNUREFZICB8fAogICAgICAgICAgICAgICAgICAgICR0aGlzLT53ZWVrLT5pU3R5bGU9PVdFRUtTVFlMRV9GSVJTVERBWTIgfHwKICAgICAgICAgICAgICAgICAgICAkdGhpcy0+d2Vlay0+aVN0eWxlPT1XRUVLU1RZTEVfRklSU1REQVlXTkJSIHx8CiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPndlZWstPmlTdHlsZT09V0VFS1NUWUxFX0ZJUlNUREFZMldOQlIgKSB7CiAgICAgICAgICAgICAgICAkaW1nLT5TZXRUZXh0QWxpZ24oImxlZnQiKTsKICAgICAgICAgICAgICAgICR0eHRPZmZzZXQgPSAzOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoNjAyMSk7CiAgICAgICAgICAgICAgICAvLygiVW5rbm93biBmb3JtYXR0aW5nIHN0eWxlIGZvciB3ZWVrLiIpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmb3IoJGk9MDsgJGk8JHRoaXMtPkdldE51bWJlck9mRGF5cygpLzc7ICsrJGksICR4Kz0kd2Vla3dpZHRoKSB7CiAgICAgICAgICAgICAgICAkaW1nLT5QdXNoQ29sb3IoJHRoaXMtPndlZWstPmlUZXh0Q29sb3IpOwoKICAgICAgICAgICAgICAgIGlmKCAkdGhpcy0+d2Vlay0+aVN0eWxlPT1XRUVLU1RZTEVfV05CUiApCiAgICAgICAgICAgICAgICAgICAgJHR4dCA9IHNwcmludGYoJHRoaXMtPndlZWstPmlMYWJlbEZvcm1TdHIsJHdlZWtuYnIpOwogICAgICAgICAgICAgICAgZWxzZWlmKCAkdGhpcy0+d2Vlay0+aVN0eWxlPT1XRUVLU1RZTEVfRklSU1REQVkgfHwKICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPndlZWstPmlTdHlsZT09V0VFS1NUWUxFX0ZJUlNUREFZV05CUiApCiAgICAgICAgICAgICAgICAgICAgJHR4dCA9IGRhdGUoImovbiIsJHdlZWspOwogICAgICAgICAgICAgICAgZWxzZWlmKCAkdGhpcy0+d2Vlay0+aVN0eWxlPT1XRUVLU1RZTEVfRklSU1REQVkyIHx8CiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT53ZWVrLT5pU3R5bGU9PVdFRUtTVFlMRV9GSVJTVERBWTJXTkJSICkgewogICAgICAgICAgICAgICAgICAgICRtb250aG5iciA9IGRhdGUoIm4iLCR3ZWVrKS0xOwogICAgICAgICAgICAgICAgICAgICRzaG9ydG1vbnRoID0gJHRoaXMtPmlEYXRlTG9jYWxlLT5HZXRTaG9ydE1vbnRoTmFtZSgkbW9udGhuYnIpOwogICAgICAgICAgICAgICAgICAgICR0eHQgPSBEYXRlKCJqIiwkd2VlaykuIiAiLiRzaG9ydG1vbnRoOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmKCAkdGhpcy0+d2Vlay0+aVN0eWxlPT1XRUVLU1RZTEVfRklSU1REQVlXTkJSIHx8CiAgICAgICAgICAgICAgICAkdGhpcy0+d2Vlay0+aVN0eWxlPT1XRUVLU1RZTEVfRklSU1REQVkyV05CUiApIHsKICAgICAgICAgICAgICAgICAgICAkdyA9IHNwcmludGYoJHRoaXMtPndlZWstPmlMYWJlbEZvcm1TdHIsJHdlZWtuYnIpOwogICAgICAgICAgICAgICAgICAgICR0eHQgLj0gJyAnLiR3OwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICRpbWctPlN0cm9rZVRleHQocm91bmQoJHgrJHR4dE9mZnNldCksCiAgICAgICAgICAgICAgICByb3VuZCgkeWItJHRoaXMtPndlZWstPmlUaXRsZVZlcnRNYXJnaW4pLCR0eHQpOwoKICAgICAgICAgICAgICAgICR3ZWVrID0gc3RydG90aW1lKCcrNyBkYXknLCR3ZWVrKTsKICAgICAgICAgICAgICAgICR3ZWVrbmJyID0gJHRoaXMtPkdldFdlZWtOYnIoJHdlZWspOwogICAgICAgICAgICAgICAgJGltZy0+UG9wQ29sb3IoKTsKICAgICAgICAgICAgICAgICRpbWctPlNldExpbmVXZWlnaHQoJHRoaXMtPndlZWstPmdyaWQtPmlXZWlnaHQpOwogICAgICAgICAgICAgICAgJGltZy0+TGluZSgkeCwkeXQsJHgsJHliKTsKICAgICAgICAgICAgICAgICR0aGlzLT53ZWVrLT5ncmlkLT5TdHJva2UoJGltZywkeCwkeWIsJHgsJGltZy0+aGVpZ2h0LSRpbWctPmJvdHRvbV9tYXJnaW4pOwogICAgICAgICAgICB9CiAgICAgICAgICAgICRpbWctPlNldENvbG9yKCR0aGlzLT53ZWVrLT5pRnJhbWVDb2xvcik7CiAgICAgICAgICAgICRpbWctPlNldExpbmVXZWlnaHQoJHRoaXMtPndlZWstPmlGcmFtZVdlaWdodCk7CiAgICAgICAgICAgICRpbWctPlJlY3RhbmdsZSgkeHQsJHl0LCR4YiwkeWIpOwogICAgICAgICAgICByZXR1cm4gJHliLSRpbWctPnRvcF9tYXJnaW47CiAgICAgICAgfQogICAgICAgIHJldHVybiAkYVlDb29yZDsKICAgIH0KCiAgICAvLyBGb3JtYXQgdGhlIG1vbnQgc2NhbGUgaGVhZGVyIHN0cmluZwogICAgZnVuY3Rpb24gR2V0TW9udGhMYWJlbCgkYU1vbnRoTmJyLCR5ZWFyKSB7CiAgICAgICAgJHNuID0gJHRoaXMtPmlEYXRlTG9jYWxlLT5HZXRTaG9ydE1vbnRoTmFtZSgkYU1vbnRoTmJyKTsKICAgICAgICAkbG4gPSAkdGhpcy0+aURhdGVMb2NhbGUtPkdldExvbmdNb250aE5hbWUoJGFNb250aE5icik7CiAgICAgICAgc3dpdGNoKCR0aGlzLT5tb250aC0+aVN0eWxlKSB7CiAgICAgICAgICAgIGNhc2UgTU9OVEhTVFlMRV9TSE9SVE5BTUU6CiAgICAgICAgICAgICAgICAkbT0kc247CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBNT05USFNUWUxFX0xPTkdOQU1FOgogICAgICAgICAgICAgICAgJG09JGxuOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgTU9OVEhTVFlMRV9TSE9SVE5BTUVZRUFSMjoKICAgICAgICAgICAgICAgICRtPSRzbi4iICciLnN1YnN0cigiIi4keWVhciwyKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIE1PTlRIU1RZTEVfU0hPUlROQU1FWUVBUjQ6CiAgICAgICAgICAgICAgICAkbT0kc24uIiAiLiR5ZWFyOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgTU9OVEhTVFlMRV9MT05HTkFNRVlFQVIyOgogICAgICAgICAgICAgICAgJG09JGxuLiIgJyIuc3Vic3RyKCIiLiR5ZWFyLDIpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgTU9OVEhTVFlMRV9MT05HTkFNRVlFQVI0OgogICAgICAgICAgICAgICAgJG09JGxuLiIgIi4keWVhcjsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIE1PTlRIU1RZTEVfRklSU1RMRVRURVI6CiAgICAgICAgICAgICAgICAkbT0kc25bMF07CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICRtOwogICAgfQoKICAgIC8vIFN0cm9rZSBtb250aCBzY2FsZSBhbmQgZ3JpZGxpbmVzCiAgICBmdW5jdGlvbiBTdHJva2VNb250aHMoJGFZQ29vcmQsJGdldEhlaWdodD1mYWxzZSkgewogICAgICAgIGlmKCAkdGhpcy0+bW9udGgtPmlTaG93TGFiZWxzICkgewogICAgICAgICAgICAkaW1nPSR0aGlzLT5pSW1nOwogICAgICAgICAgICAkaW1nLT5TZXRGb250KCR0aGlzLT5tb250aC0+aUZGYW1pbHksJHRoaXMtPm1vbnRoLT5pRlN0eWxlLCR0aGlzLT5tb250aC0+aUZTaXplKTsKICAgICAgICAgICAgJHl0PSRhWUNvb3JkKyRpbWctPnRvcF9tYXJnaW47CiAgICAgICAgICAgICR5Yj0keXQgKyAkaW1nLT5HZXRGb250SGVpZ2h0KCkgKyAkdGhpcy0+bW9udGgtPmlUaXRsZVZlcnRNYXJnaW4gKyAkdGhpcy0+bW9udGgtPmlGcmFtZVdlaWdodDsKICAgICAgICAgICAgaWYoICRnZXRIZWlnaHQgKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gJHliIC0gJGltZy0+dG9wX21hcmdpbjsKICAgICAgICAgICAgfQogICAgICAgICAgICAkbW9udGhuYnIgPSAkdGhpcy0+R2V0TW9udGhOYnIoJHRoaXMtPmlTdGFydERhdGUpLTE7CiAgICAgICAgICAgICR4dD0kaW1nLT5sZWZ0X21hcmdpbiskdGhpcy0+aUxhYmVsV2lkdGg7CiAgICAgICAgICAgICR4Yj0kaW1nLT53aWR0aC0kaW1nLT5yaWdodF9tYXJnaW4rMTsKCiAgICAgICAgICAgICRpbWctPlNldENvbG9yKCR0aGlzLT5tb250aC0+aUJhY2tncm91bmRDb2xvcik7CiAgICAgICAgICAgICRpbWctPkZpbGxlZFJlY3RhbmdsZSgkeHQsJHl0LCR4YiwkeWIpOwoKICAgICAgICAgICAgJGltZy0+U2V0TGluZVdlaWdodCgkdGhpcy0+bW9udGgtPmdyaWQtPmlXZWlnaHQpOwogICAgICAgICAgICAkaW1nLT5TZXRDb2xvcigkdGhpcy0+bW9udGgtPmlUZXh0Q29sb3IpOwogICAgICAgICAgICAkeWVhciA9IDArc3RyZnRpbWUoIiVZIiwkdGhpcy0+aVN0YXJ0RGF0ZSk7CiAgICAgICAgICAgICRpbWctPlNldFRleHRBbGlnbigiY2VudGVyIik7CiAgICAgICAgICAgIGlmKCAkdGhpcy0+R2V0TW9udGhOYnIoJHRoaXMtPmlTdGFydERhdGUpID09ICR0aGlzLT5HZXRNb250aE5icigkdGhpcy0+aUVuZERhdGUpCiAgICAgICAgICAgICAgICAmJiAkdGhpcy0+R2V0WWVhcigkdGhpcy0+aVN0YXJ0RGF0ZSk9PSR0aGlzLT5HZXRZZWFyKCR0aGlzLT5pRW5kRGF0ZSkgKSB7CiAgICAgICAgICAgICAgICAkbW9udGh3aWR0aD0kdGhpcy0+R2V0RGF5V2lkdGgoKSooJHRoaXMtPkdldE1vbnRoRGF5TmJyKCR0aGlzLT5pRW5kRGF0ZSkgLSAkdGhpcy0+R2V0TW9udGhEYXlOYnIoJHRoaXMtPmlTdGFydERhdGUpICsgMSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAkbW9udGh3aWR0aD0kdGhpcy0+R2V0RGF5V2lkdGgoKSooJHRoaXMtPkdldE51bURheXNJbk1vbnRoKCRtb250aG5iciwkeWVhciktJHRoaXMtPkdldE1vbnRoRGF5TmJyKCR0aGlzLT5pU3RhcnREYXRlKSsxKTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyBJcyBpdCBlbm91Z2ggc3BhY2UgdG8gc3Ryb2tlIHRoZSBmaXJzdCBtb250aD8KICAgICAgICAgICAgJG1vbnRoTmFtZSA9ICR0aGlzLT5HZXRNb250aExhYmVsKCRtb250aG5iciwkeWVhcik7CiAgICAgICAgICAgIGlmKCAkbW9udGh3aWR0aCA+PSAxLjIqJGltZy0+R2V0VGV4dFdpZHRoKCRtb250aE5hbWUpICkgewogICAgICAgICAgICAgICAgJGltZy0+U2V0Q29sb3IoJHRoaXMtPm1vbnRoLT5pVGV4dENvbG9yKTsKICAgICAgICAgICAgICAgICRpbWctPlN0cm9rZVRleHQocm91bmQoJHh0KyRtb250aHdpZHRoLzIrMSksCiAgICAgICAgICAgICAgICByb3VuZCgkeWItJHRoaXMtPm1vbnRoLT5pVGl0bGVWZXJ0TWFyZ2luKSwKICAgICAgICAgICAgICAgICRtb250aE5hbWUpOwogICAgICAgICAgICB9CiAgICAgICAgICAgICR4ID0gJHh0ICsgJG1vbnRod2lkdGg7CiAgICAgICAgICAgIHdoaWxlKCAkeCA8ICR4YiApIHsKICAgICAgICAgICAgICAgICRpbWctPlNldENvbG9yKCR0aGlzLT5tb250aC0+Z3JpZC0+aUNvbG9yKTsKICAgICAgICAgICAgICAgICRpbWctPkxpbmUoJHgsJHl0LCR4LCR5Yik7CiAgICAgICAgICAgICAgICAkdGhpcy0+bW9udGgtPmdyaWQtPlN0cm9rZSgkaW1nLCR4LCR5YiwkeCwkaW1nLT5oZWlnaHQtJGltZy0+Ym90dG9tX21hcmdpbik7CiAgICAgICAgICAgICAgICAkbW9udGhuYnIrKzsKICAgICAgICAgICAgICAgIGlmKCAkbW9udGhuYnI9PTEyICkgewogICAgICAgICAgICAgICAgICAgICRtb250aG5icj0wOwogICAgICAgICAgICAgICAgICAgICR5ZWFyKys7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkbW9udGhOYW1lID0gJHRoaXMtPkdldE1vbnRoTGFiZWwoJG1vbnRobmJyLCR5ZWFyKTsKICAgICAgICAgICAgICAgICRtb250aHdpZHRoPSR0aGlzLT5HZXREYXlXaWR0aCgpKiR0aGlzLT5HZXROdW1EYXlzSW5Nb250aCgkbW9udGhuYnIsJHllYXIpOwogICAgICAgICAgICAgICAgaWYoICR4ICsgJG1vbnRod2lkdGggPCAkeGIgKQogICAgICAgICAgICAgICAgICAgICR3ID0gJG1vbnRod2lkdGg7CiAgICAgICAgICAgICAgICBlbHNlCiAgICAgICAgICAgICAgICAgICAgJHcgPSAkeGItJHg7CiAgICAgICAgICAgICAgICBpZiggJHcgPj0gMS4yKiRpbWctPkdldFRleHRXaWR0aCgkbW9udGhOYW1lKSApIHsKICAgICAgICAgICAgICAgICAgICAkaW1nLT5TZXRDb2xvcigkdGhpcy0+bW9udGgtPmlUZXh0Q29sb3IpOwogICAgICAgICAgICAgICAgICAgICRpbWctPlN0cm9rZVRleHQocm91bmQoJHgrJHcvMisxKSwKICAgICAgICAgICAgICAgICAgICByb3VuZCgkeWItJHRoaXMtPm1vbnRoLT5pVGl0bGVWZXJ0TWFyZ2luKSwkbW9udGhOYW1lKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICR4ICs9ICRtb250aHdpZHRoOwogICAgICAgICAgICB9CiAgICAgICAgICAgICRpbWctPlNldENvbG9yKCR0aGlzLT5tb250aC0+aUZyYW1lQ29sb3IpOwogICAgICAgICAgICAkaW1nLT5TZXRMaW5lV2VpZ2h0KCR0aGlzLT5tb250aC0+aUZyYW1lV2VpZ2h0KTsKICAgICAgICAgICAgJGltZy0+UmVjdGFuZ2xlKCR4dCwkeXQsJHhiLCR5Yik7CiAgICAgICAgICAgIHJldHVybiAkeWItJGltZy0+dG9wX21hcmdpbjsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICRhWUNvb3JkOwogICAgfQoKICAgIC8vIFN0cm9rZSB5ZWFyIHNjYWxlIGFuZCBncmlkbGluZXMKICAgIGZ1bmN0aW9uIFN0cm9rZVllYXJzKCRhWUNvb3JkLCRnZXRIZWlnaHQ9ZmFsc2UpIHsKICAgICAgICBpZiggJHRoaXMtPnllYXItPmlTaG93TGFiZWxzICkgewogICAgICAgICAgICAkaW1nPSR0aGlzLT5pSW1nOwogICAgICAgICAgICAkeXQ9JGFZQ29vcmQrJGltZy0+dG9wX21hcmdpbjsKICAgICAgICAgICAgJGltZy0+U2V0Rm9udCgkdGhpcy0+eWVhci0+aUZGYW1pbHksJHRoaXMtPnllYXItPmlGU3R5bGUsJHRoaXMtPnllYXItPmlGU2l6ZSk7CiAgICAgICAgICAgICR5Yj0keXQgKyAkaW1nLT5HZXRGb250SGVpZ2h0KCkgKyAkdGhpcy0+eWVhci0+aVRpdGxlVmVydE1hcmdpbiArICR0aGlzLT55ZWFyLT5pRnJhbWVXZWlnaHQ7CgogICAgICAgICAgICBpZiggJGdldEhlaWdodCApIHsKICAgICAgICAgICAgICAgIHJldHVybiAkeWIgLSAkaW1nLT50b3BfbWFyZ2luOwogICAgICAgICAgICB9CgogICAgICAgICAgICAkeGI9JGltZy0+d2lkdGgtJGltZy0+cmlnaHRfbWFyZ2luKzE7CiAgICAgICAgICAgICR4dD0kaW1nLT5sZWZ0X21hcmdpbiskdGhpcy0+aUxhYmVsV2lkdGg7CiAgICAgICAgICAgICR5ZWFyID0gJHRoaXMtPkdldFllYXIoJHRoaXMtPmlTdGFydERhdGUpOwogICAgICAgICAgICAkaW1nLT5TZXRDb2xvcigkdGhpcy0+eWVhci0+aUJhY2tncm91bmRDb2xvcik7CiAgICAgICAgICAgICRpbWctPkZpbGxlZFJlY3RhbmdsZSgkeHQsJHl0LCR4YiwkeWIpOwogICAgICAgICAgICAkaW1nLT5TZXRMaW5lV2VpZ2h0KCR0aGlzLT55ZWFyLT5ncmlkLT5pV2VpZ2h0KTsKICAgICAgICAgICAgJGltZy0+U2V0VGV4dEFsaWduKCJjZW50ZXIiKTsKICAgICAgICAgICAgaWYoICR5ZWFyID09ICR0aGlzLT5HZXRZZWFyKCR0aGlzLT5pRW5kRGF0ZSkgKQogICAgICAgICAgICAgICAgJHllYXJ3aWR0aD0kdGhpcy0+R2V0RGF5V2lkdGgoKSooJHRoaXMtPkdldFllYXJEYXlOYnIoJHRoaXMtPmlFbmREYXRlKS0kdGhpcy0+R2V0WWVhckRheU5icigkdGhpcy0+aVN0YXJ0RGF0ZSkrMSk7CiAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICR5ZWFyd2lkdGg9JHRoaXMtPkdldERheVdpZHRoKCkqKCR0aGlzLT5HZXROdW1EYXlzSW5ZZWFyKCR5ZWFyKS0kdGhpcy0+R2V0WWVhckRheU5icigkdGhpcy0+aVN0YXJ0RGF0ZSkrMSk7CgogICAgICAgICAgICAvLyBUaGUgc3BhY2UgZm9yIGEgeWVhciBtdXN0IGJlIGF0IGxlYXN0IDIwJSBiaWdnZXIgdGhhbiB0aGUgYWN0dWFsIHRleHQKICAgICAgICAgICAgLy8gc28gd2UgYWxsb3cgMTAlIG1hcmdpbiBvbiBlYWNoIHNpZGUKICAgICAgICAgICAgaWYoICR5ZWFyd2lkdGggPj0gMS4yMCokaW1nLT5HZXRUZXh0V2lkdGgoIiIuJHllYXIpICkgewogICAgICAgICAgICAgICAgJGltZy0+U2V0Q29sb3IoJHRoaXMtPnllYXItPmlUZXh0Q29sb3IpOwogICAgICAgICAgICAgICAgJGltZy0+U3Ryb2tlVGV4dChyb3VuZCgkeHQrJHllYXJ3aWR0aC8yKzEpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3VuZCgkeWItJHRoaXMtPnllYXItPmlUaXRsZVZlcnRNYXJnaW4pLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkeWVhcik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJHggPSAkeHQgKyAkeWVhcndpZHRoOwogICAgICAgICAgICB3aGlsZSggJHggPCAkeGIgKSB7CiAgICAgICAgICAgICAgICAkaW1nLT5TZXRDb2xvcigkdGhpcy0+eWVhci0+Z3JpZC0+aUNvbG9yKTsKICAgICAgICAgICAgICAgICRpbWctPkxpbmUoJHgsJHl0LCR4LCR5Yik7CiAgICAgICAgICAgICAgICAkdGhpcy0+eWVhci0+Z3JpZC0+U3Ryb2tlKCRpbWcsJHgsJHliLCR4LCRpbWctPmhlaWdodC0kaW1nLT5ib3R0b21fbWFyZ2luKTsKICAgICAgICAgICAgICAgICR5ZWFyICs9IDE7CiAgICAgICAgICAgICAgICAkeWVhcndpZHRoPSR0aGlzLT5HZXREYXlXaWR0aCgpKiR0aGlzLT5HZXROdW1EYXlzSW5ZZWFyKCR5ZWFyKTsKICAgICAgICAgICAgICAgIGlmKCAkeCArICR5ZWFyd2lkdGggPCAkeGIgKQogICAgICAgICAgICAgICAgICAgICR3ID0gJHllYXJ3aWR0aDsKICAgICAgICAgICAgICAgIGVsc2UKICAgICAgICAgICAgICAgICAgICAkdyA9ICR4Yi0keDsKICAgICAgICAgICAgICAgIGlmKCAkdyA+PSAxLjIqJGltZy0+R2V0VGV4dFdpZHRoKCIiLiR5ZWFyKSApIHsKICAgICAgICAgICAgICAgICAgICAkaW1nLT5TZXRDb2xvcigkdGhpcy0+eWVhci0+aVRleHRDb2xvcik7CiAgICAgICAgICAgICAgICAgICAgJGltZy0+U3Ryb2tlVGV4dChyb3VuZCgkeCskdy8yKzEpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91bmQoJHliLSR0aGlzLT55ZWFyLT5pVGl0bGVWZXJ0TWFyZ2luKSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR5ZWFyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICR4ICs9ICR5ZWFyd2lkdGg7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJGltZy0+U2V0Q29sb3IoJHRoaXMtPnllYXItPmlGcmFtZUNvbG9yKTsKICAgICAgICAgICAgJGltZy0+U2V0TGluZVdlaWdodCgkdGhpcy0+eWVhci0+aUZyYW1lV2VpZ2h0KTsKICAgICAgICAgICAgJGltZy0+UmVjdGFuZ2xlKCR4dCwkeXQsJHhiLCR5Yik7CiAgICAgICAgICAgIHJldHVybiAkeWItJGltZy0+dG9wX21hcmdpbjsKICAgICAgICB9CiAgICAgICAgcmV0dXJuICRhWUNvb3JkOwogICAgfQoKICAgIC8vIFN0cm9rZSB0YWJsZSB0aXRsZSAodXBwZXIgbGVmdCBjb3JuZXIpCiAgICBmdW5jdGlvbiBTdHJva2VUYWJsZUhlYWRlcnMoJGFZQm90dG9tKSB7CiAgICAgICAgJGltZz0kdGhpcy0+aUltZzsKICAgICAgICAkeHQ9JGltZy0+bGVmdF9tYXJnaW47CiAgICAgICAgJHl0PSRpbWctPnRvcF9tYXJnaW47CiAgICAgICAgJHhiPSR4dCskdGhpcy0+aUxhYmVsV2lkdGg7CiAgICAgICAgJHliPSRhWUJvdHRvbSskaW1nLT50b3BfbWFyZ2luOwoKICAgICAgICBpZiggJHRoaXMtPnRhYmxlVGl0bGUtPmlTaG93ICkgewogICAgICAgICAgICAkaW1nLT5TZXRDb2xvcigkdGhpcy0+aVRhYmxlSGVhZGVyQmFja2dyb3VuZENvbG9yKTsKICAgICAgICAgICAgJGltZy0+RmlsbGVkUmVjdGFuZ2xlKCR4dCwkeXQsJHhiLCR5Yik7CiAgICAgICAgICAgICR0aGlzLT50YWJsZVRpdGxlLT5BbGlnbigiY2VudGVyIiwidG9wIik7CiAgICAgICAgICAgICR0aGlzLT50YWJsZVRpdGxlLT5TdHJva2UoJGltZywkeHQrKCR4Yi0keHQpLzIrMSwkeXQrMik7CiAgICAgICAgICAgICRpbWctPlNldENvbG9yKCR0aGlzLT5pVGFibGVIZWFkZXJGcmFtZUNvbG9yKTsKICAgICAgICAgICAgJGltZy0+U2V0TGluZVdlaWdodCgkdGhpcy0+aVRhYmxlSGVhZGVyRnJhbWVXZWlnaHQpOwogICAgICAgICAgICAkaW1nLT5SZWN0YW5nbGUoJHh0LCR5dCwkeGIsJHliKTsKICAgICAgICB9CgogICAgICAgICR0aGlzLT5hY3RpbmZvLT5TdHJva2UoJGltZywkeHQsJHl0LCR4YiwkeWIsJHRoaXMtPnRhYmxlVGl0bGUtPmlTaG93KTsKCgogICAgICAgIC8vIERyYXcgdGhlIGhvcml6b250YWwgZGl2aWRpbmcgbGluZQogICAgICAgICR0aGlzLT5kaXZpZGVyaC0+U3Ryb2tlKCRpbWcsJHh0LCR5YiwkaW1nLT53aWR0aC0kaW1nLT5yaWdodF9tYXJnaW4sJHliKTsKCiAgICAgICAgLy8gRHJhdyB0aGUgdmVydGljYWwgZGl2aWRpbmcgbGluZQogICAgICAgIC8vIFdlIGRvIHRoZSB3aWR0aCAibWFudWFsbHkiIHNpbmNlIHdlIHdhbnQgdGhlIGxpbmUgb25seSB0byBncm93CiAgICAgICAgLy8gdG8gdGhlIGxlZnQKICAgICAgICAkZmFuY3kgPSAkdGhpcy0+ZGl2aWRlci0+aVN0eWxlID09ICdmYW5jeScgOwogICAgICAgIGlmKCAkZmFuY3kgKSB7CiAgICAgICAgICAgICR0aGlzLT5kaXZpZGVyLT5pU3R5bGUgPSAnc29saWQnOwogICAgICAgIH0KCiAgICAgICAgJHRtcCA9ICR0aGlzLT5kaXZpZGVyLT5pV2VpZ2h0OwogICAgICAgICR0aGlzLT5kaXZpZGVyLT5pV2VpZ2h0PTE7CiAgICAgICAgJHkgPSAkaW1nLT5oZWlnaHQtJGltZy0+Ym90dG9tX21hcmdpbjsKICAgICAgICBmb3IoJGk9MDsgJGkgPCAkdG1wOyArKyRpICkgewogICAgICAgICAgICAkdGhpcy0+ZGl2aWRlci0+U3Ryb2tlKCRpbWcsJHhiLSRpLCR5dCwkeGItJGksJHkpOwogICAgICAgIH0KCiAgICAgICAgLy8gU2hvdWxkIHdlIGRyYXcgImZhbmN5IiBkaXZpZGVyCiAgICAgICAgaWYoICRmYW5jeSApIHsKICAgICAgICAgICAgJGltZy0+U2V0TGluZVdlaWdodCgxKTsKICAgICAgICAgICAgJGltZy0+U2V0Q29sb3IoJHRoaXMtPmlUYWJsZUhlYWRlckZyYW1lQ29sb3IpOwogICAgICAgICAgICAkaW1nLT5MaW5lKCR4YiwkeXQsJHhiLCR5KTsKICAgICAgICAgICAgJGltZy0+TGluZSgkeGItJHRtcCsxLCR5dCwkeGItJHRtcCsxLCR5KTsKICAgICAgICAgICAgJGltZy0+U2V0Q29sb3IoJ3doaXRlJyk7CiAgICAgICAgICAgICRpbWctPkxpbmUoJHhiLSR0bXArMiwkeXQsJHhiLSR0bXArMiwkeSk7CiAgICAgICAgfQogICAgfQoKICAgIC8vIE1haW4gZW50cnkgcG9pbnQgdG8gc3Ryb2tlIHNjYWxlCiAgICBmdW5jdGlvbiBTdHJva2UoKSB7CiAgICAgICAgaWYoICEkdGhpcy0+SXNSYW5nZVNldCgpICkgewogICAgICAgIAlKcEdyYXBoRXJyb3I6OlJhaXNlTCg2MDIyKTsKICAgICAgICAJLy8oIkdhbnR0IHNjYWxlIGhhcyBub3QgYmVlbiBzcGVjaWZpZWQuIik7CiAgICAgICAgfQogICAgICAgICRpbWc9JHRoaXMtPmlJbWc7CgogICAgICAgIC8vIElmIG1pbnV0ZXMgYXJlIGRpc3BsYXllZCB0aGVuIGhvdXIgaW50ZXJ2YWwgbXVzdCBiZSAxCiAgICAgICAgaWYoICR0aGlzLT5Jc0Rpc3BsYXlNaW51dGUoKSAmJiAkdGhpcy0+aG91ci0+R2V0SW50ZXJ2YWxsKCkgPiAxICkgewogICAgICAgICAgICBKcEdyYXBoRXJyb3I6OlJhaXNlTCg2MDIzKTsKICAgICAgICAgICAgLy8oJ0lmIHlvdSBkaXNwbGF5IGJvdGggaG91ciBhbmQgbWludXRlcyB0aGUgaG91ciBpbnRlcnZhbGwgbXVzdCBiZSAxIChPdGhlcndpc2UgaXQgZG9lc25cJyBtYWtlIHNlbnNlIHRvIGRpc3BsYXkgbWludXRlcykuJyk7CiAgICAgICAgfQoKICAgICAgICAvLyBTdHJva2UgYWxsIGhlYWRlcnMuIEFzIGFyZ3VtZW50IHdlIHN1cHBseSB0aGUgb2Zmc2V0IGZyb20gdGhlCiAgICAgICAgLy8gdG9wIHdoaWNoIGRlcGVuZHMgb24gYW55IHByZXZpb3VzIGhlYWRlcnMKCiAgICAgICAgLy8gRmlyc3QgZmluZCBvdXQgdGhlIGhlaWdodCBvZiBlYWNoIGhlYWRlcgogICAgICAgICRvZmZ5PSR0aGlzLT5TdHJva2VZZWFycygwLHRydWUpOwogICAgICAgICRvZmZtPSR0aGlzLT5TdHJva2VNb250aHMoJG9mZnksdHJ1ZSk7CiAgICAgICAgJG9mZnc9JHRoaXMtPlN0cm9rZVdlZWtzKCRvZmZtLHRydWUpOwogICAgICAgICRvZmZkPSR0aGlzLT5TdHJva2VEYXlzKCRvZmZ3LHRydWUpOwogICAgICAgICRvZmZoPSR0aGlzLT5TdHJva2VIb3Vycygkb2ZmZCx0cnVlKTsKICAgICAgICAkb2ZmbWluPSR0aGlzLT5TdHJva2VNaW51dGVzKCRvZmZoLHRydWUpOwoKCiAgICAgICAgLy8gLi4uIHRoZW4gd2UgY2FuIHN0cm9rZSB0aGVtIGluIHRoZSAiYmFja3dhcmRzIG9yZGVyIHRvIGVuc3VyZSB0aGF0CiAgICAgICAgLy8gdGhlIGxhcmdlciBzY2FsZSBncmlkbGluZXMgaXMgc3Ryb2tlZCBvdmVyIHRoZSBzbWFsbGVyIHNjYWxlIGdyaWRsaW5lCiAgICAgICAgJHRoaXMtPlN0cm9rZU1pbnV0ZXMoJG9mZmgpOwogICAgICAgICR0aGlzLT5TdHJva2VIb3Vycygkb2ZmZCk7CiAgICAgICAgJHRoaXMtPlN0cm9rZURheXMoJG9mZncpOwogICAgICAgICR0aGlzLT5TdHJva2VXZWVrcygkb2ZmbSk7CiAgICAgICAgJHRoaXMtPlN0cm9rZU1vbnRocygkb2ZmeSk7CiAgICAgICAgJHRoaXMtPlN0cm9rZVllYXJzKDApOwoKICAgICAgICAvLyBOb3cgd2hlbiB3ZSBub3cgdGhlIG9hdmVyYWxsIHNpemUgb2YgdGhlIHNjYWxlIGhlYWRlcnMKICAgICAgICAvLyB3ZSBjYW4gc3Ryb2tlIHRoZSBvdmVyYWxsIHRhYmxlIGhlYWRlcnMKICAgICAgICAkdGhpcy0+U3Ryb2tlVGFibGVIZWFkZXJzKCRvZmZtaW4pOwoKICAgICAgICAvLyBOb3cgd2UgY2FuIGNhbGN1bGF0ZSB0aGUgY29ycmVjdCBzY2FsaW5nIGZhY3RvciBmb3IgZWFjaCB2ZXJ0aWNhbCBwb3NpdGlvbgogICAgICAgICR0aGlzLT5pQXZhaWxhYmxlSGVpZ2h0ID0gJGltZy0+aGVpZ2h0IC0gJGltZy0+dG9wX21hcmdpbiAtICRpbWctPmJvdHRvbV9tYXJnaW4gLSAkb2ZmZDsKCiAgICAgICAgJHRoaXMtPmlWZXJ0SGVhZGVyU2l6ZSA9ICRvZmZtaW47CiAgICAgICAgaWYoICR0aGlzLT5pVmVydFNwYWNpbmcgPT0gLTEgKQogICAgICAgIAkkdGhpcy0+aVZlcnRTcGFjaW5nID0gJHRoaXMtPmlBdmFpbGFibGVIZWlnaHQgLyAkdGhpcy0+aVZlcnRMaW5lczsKICAgIH0KfQoKCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIENMQVNTIEdhbnR0Q29uc3RyYWludAovLyBKdXN0IGEgc3RydWN0dXJlIHRvIHN0b3JlIGFsbCB0aGUgdmFsdWVzIGZvciBhIGNvbnN0cmFpbnQKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KY2xhc3MgR2FudHRDb25zdHJhaW50IHsKICAgIHB1YmxpYyAkaUNvbnN0cmFpblJvdzsKICAgIHB1YmxpYyAkaUNvbnN0cmFpblR5cGU7CiAgICBwdWJsaWMgJGlDb25zdHJhaW5Db2xvcjsKICAgIHB1YmxpYyAkaUNvbnN0cmFpbkFycm93U2l6ZTsKICAgIHB1YmxpYyAkaUNvbnN0cmFpbkFycm93VHlwZTsKCiAgICAvLy0tLS0tLS0tLS0tLS0tLQogICAgLy8gQ09OU1RSVUNUT1IKICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRhUm93LCRhVHlwZSwkYUNvbG9yLCRhQXJyb3dTaXplLCRhQXJyb3dUeXBlKXsKICAgICAgICAkdGhpcy0+aUNvbnN0cmFpblR5cGUgPSAkYVR5cGU7CiAgICAgICAgJHRoaXMtPmlDb25zdHJhaW5Sb3cgPSAkYVJvdzsKICAgICAgICAkdGhpcy0+aUNvbnN0cmFpbkNvbG9yPSRhQ29sb3I7CiAgICAgICAgJHRoaXMtPmlDb25zdHJhaW5BcnJvd1NpemU9JGFBcnJvd1NpemU7CiAgICAgICAgJHRoaXMtPmlDb25zdHJhaW5BcnJvd1R5cGU9JGFBcnJvd1R5cGU7CiAgICB9Cn0KCgovLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQovLyBDTEFTUyBHYW50dFBsb3RPYmplY3QKLy8gVGhlIGNvbW1vbiBzaWduYXR1cmUgZm9yIGEgR2FudHQgb2JqZWN0Ci8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmNsYXNzIEdhbnR0UGxvdE9iamVjdCB7CiAgICBwdWJsaWMgJHRpdGxlLCRjYXB0aW9uOwogICAgcHVibGljICRjc2ltYXJlYT0nJywkY3NpbXRhcmdldD0nJywkY3NpbXdpbnRhcmdldD0nJywkY3NpbWFsdD0nJzsKICAgIHB1YmxpYyAkY29uc3RyYWludHMgPSBhcnJheSgpOwogICAgcHVibGljICRpQ2FwdGlvbk1hcmdpbj01OwogICAgcHVibGljICRpQ29uc3RyYWluUG9zPWFycmF5KCk7CiAgICBwcm90ZWN0ZWQgJGlTdGFydD0iIjsgICAgLy8gU3RhcnQgZGF0ZQogICAgcHVibGljICRpVlBvcz0wOyAgICAgLy8gVmVydGljYWwgcG9zaXRpb24KICAgIHByb3RlY3RlZCAkaUxhYmVsTGVmdE1hcmdpbj0yOyAvLyBUaXRsZSBtYXJnaW4KCiAgICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgpIHsKICAgICAgICAkdGhpcy0+dGl0bGUgPSBuZXcgVGV4dFByb3BlcnR5KCk7CiAgICAgICAgJHRoaXMtPnRpdGxlLT5BbGlnbignbGVmdCcsJ2NlbnRlcicpOwogICAgICAgICR0aGlzLT5jYXB0aW9uID0gbmV3IFRleHRQcm9wZXJ0eSgpOwogICAgfQoKICAgIGZ1bmN0aW9uIEdldENTSU1BcmVhKCkgewogICAgICAgIHJldHVybiAkdGhpcy0+Y3NpbWFyZWE7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0Q1NJTVRhcmdldCgkYVRhcmdldCwkYUFsdD0nJywkYVdpblRhcmdldD0nJykgewogICAgICAgIGlmKCAhaXNfc3RyaW5nKCRhVGFyZ2V0KSApIHsKICAgICAgICAgICAgJHR2ID0gc3Vic3RyKHZhcl9leHBvcnQoJGFUYXJnZXQsdHJ1ZSksMCw0MCk7CiAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDYwMjQsJHR2KTsKICAgICAgICAgICAgLy8oJ0NTSU0gVGFyZ2V0IG11c3QgYmUgc3BlY2lmaWVkIGFzIGEgc3RyaW5nLicuIlxuU3RhcnQgb2YgdGFyZ2V0IGlzOlxuJHR2Iik7CiAgICAgICAgfQogICAgICAgIGlmKCAhaXNfc3RyaW5nKCRhQWx0KSApIHsKICAgICAgICAgICAgJHR2ID0gc3Vic3RyKHZhcl9leHBvcnQoJGFBbHQsdHJ1ZSksMCw0MCk7CiAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDYwMjUsJHR2KTsKICAgICAgICAgICAgLy8oJ0NTSU0gQWx0IHRleHQgbXVzdCBiZSBzcGVjaWZpZWQgYXMgYSBzdHJpbmcuJy4iXG5TdGFydCBvZiBhbHQgdGV4dCBpczpcbiR0diIpOwogICAgICAgIH0KCiAgICAgICAgJHRoaXMtPmNzaW10YXJnZXQ9JGFUYXJnZXQ7CiAgICAgICAgJHRoaXMtPmNzaW13aW50YXJnZXQ9JGFXaW5UYXJnZXQ7CiAgICAgICAgJHRoaXMtPmNzaW1hbHQ9JGFBbHQ7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0Q1NJTUFsdCgkYUFsdCkgewogICAgICAgIGlmKCAhaXNfc3RyaW5nKCRhQWx0KSApIHsKICAgICAgICAgICAgJHR2ID0gc3Vic3RyKHZhcl9leHBvcnQoJGFBbHQsdHJ1ZSksMCw0MCk7CiAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDYwMjUsJHR2KTsKICAgICAgICAgICAgLy8oJ0NTSU0gQWx0IHRleHQgbXVzdCBiZSBzcGVjaWZpZWQgYXMgYSBzdHJpbmcuJy4iXG5TdGFydCBvZiBhbHQgdGV4dCBpczpcbiR0diIpOwogICAgICAgIH0KICAgICAgICAkdGhpcy0+Y3NpbWFsdD0kYUFsdDsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRDb25zdHJhaW4oJGFSb3csJGFUeXBlLCRhQ29sb3I9J2JsYWNrJywkYUFycm93U2l6ZT1BUlJPV19TMiwkYUFycm93VHlwZT1BUlJPV1RfU09MSUQpIHsKICAgICAgICAkdGhpcy0+Y29uc3RyYWludHNbXSA9IG5ldyBHYW50dENvbnN0cmFpbnQoJGFSb3csICRhVHlwZSwgJGFDb2xvciwgJGFBcnJvd1NpemUsICRhQXJyb3dUeXBlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRDb25zdHJhaW5Qb3MoJHh0LCR5dCwkeGIsJHliKSB7CiAgICAgICAgJHRoaXMtPmlDb25zdHJhaW5Qb3MgPSBhcnJheSgkeHQsJHl0LCR4YiwkeWIpOwogICAgfQoKICAgIGZ1bmN0aW9uIEdldE1pbkRhdGUoKSB7CiAgICAgICAgcmV0dXJuICR0aGlzLT5pU3RhcnQ7CiAgICB9CgogICAgZnVuY3Rpb24gR2V0TWF4RGF0ZSgpIHsKICAgICAgICByZXR1cm4gJHRoaXMtPmlTdGFydDsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRDYXB0aW9uTWFyZ2luKCRhTWFyZykgewogICAgICAgICR0aGlzLT5pQ2FwdGlvbk1hcmdpbj0kYU1hcmc7CiAgICB9CgogICAgZnVuY3Rpb24gR2V0QWJzSGVpZ2h0KCRhSW1nKSB7CiAgICAgICAgcmV0dXJuIDA7CiAgICB9CgogICAgZnVuY3Rpb24gR2V0TGluZU5icigpIHsKICAgICAgICByZXR1cm4gJHRoaXMtPmlWUG9zOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldExhYmVsTGVmdE1hcmdpbigkYU9mZikgewogICAgICAgICR0aGlzLT5pTGFiZWxMZWZ0TWFyZ2luPSRhT2ZmOwogICAgfQoKICAgIGZ1bmN0aW9uIFN0cm9rZUFjdEluZm8oJGFJbWcsJGFTY2FsZSwkYVlQb3MpIHsKICAgICAgICAkY29scz1hcnJheSgpOwogICAgICAgICRhU2NhbGUtPmFjdGluZm8tPkdldENvbFN0YXJ0KCRhSW1nLCRjb2xzLHRydWUpOwogICAgICAgICR0aGlzLT50aXRsZS0+U3Ryb2tlKCRhSW1nLCRjb2xzLCRhWVBvcyk7CiAgICB9Cn0KCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIENMQVNTIFByb2dyZXNzCi8vIEhvbGRzIHBhcmFtZXRlcnMgZm9yIHRoZSBwcm9ncmVzcyBpbmRpY2F0b3IKLy8gZGlzcGx5ZWQgd2l0aGluIGEgYmFyCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmNsYXNzIFByb2dyZXNzIHsKICAgIHB1YmxpYyAkaVByb2dyZXNzPS0xOwogICAgcHVibGljICRpUGF0dGVybj1HQU5UVF9TT0xJRDsKICAgIHB1YmxpYyAkaUNvbG9yPSJibGFjayIsICRpRmlsbENvbG9yPSdibGFjayc7CiAgICBwdWJsaWMgJGlEZW5zaXR5PTk4LCAkaUhlaWdodD0wLjY1OwoKICAgIGZ1bmN0aW9uIFNldCgkYVByb2cpIHsKICAgICAgICBpZiggJGFQcm9nIDwgMC4wIHx8ICRhUHJvZyA+IDEuMCApIHsKICAgICAgICAJSnBHcmFwaEVycm9yOjpSYWlzZUwoNjAyNyk7CiAgICAgICAgCS8vKCJQcm9ncmVzcyB2YWx1ZSBtdXN0IGluIHJhbmdlIFswLCAxXSIpOwogICAgICAgIH0KICAgICAgICAkdGhpcy0+aVByb2dyZXNzID0gJGFQcm9nOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldFBhdHRlcm4oJGFQYXR0ZXJuLCRhQ29sb3I9ImJsdWUiLCRhRGVuc2l0eT05OCkgewogICAgICAgICR0aGlzLT5pUGF0dGVybiA9ICRhUGF0dGVybjsKICAgICAgICAkdGhpcy0+aUNvbG9yID0gJGFDb2xvcjsKICAgICAgICAkdGhpcy0+aURlbnNpdHkgPSAkYURlbnNpdHk7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0RmlsbENvbG9yKCRhQ29sb3IpIHsKICAgICAgICAkdGhpcy0+aUZpbGxDb2xvciA9ICRhQ29sb3I7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0SGVpZ2h0KCRhSGVpZ2h0KSB7CiAgICAgICAgJHRoaXMtPmlIZWlnaHQgPSAkYUhlaWdodDsKICAgIH0KfQoKZGVmaW5lKCdHQU5UVF9IR1JJRDEnLDApOwpkZWZpbmUoJ0dBTlRUX0hHUklEMicsMSk7CgovLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQovLyBDTEFTUyBIb3Jpem9udGFsR3JpZExpbmUKLy8gUmVzcG9uc2libGUgZm9yIGRyYXdpbmYgaG9yaXpvbnRhbCBncmlkbGluZXMgYW5kIGZpbGxlZCBhbHRlcm5hdGliZyByb3dzCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmNsYXNzIEhvcml6b250YWxHcmlkTGluZSB7CiAgICBwcml2YXRlICRpR3JhcGg9TlVMTDsKICAgIHByaXZhdGUgJGlSb3dDb2xvcjEgPSAnJywgJGlSb3dDb2xvcjIgPSAnJzsKICAgIHByaXZhdGUgJGlTaG93PWZhbHNlOwogICAgcHJpdmF0ZSAkbGluZT1udWxsOwogICAgcHJpdmF0ZSAkaVN0YXJ0PTA7IC8vIDA9ZnJvbSBsZWZ0IG1hcmdpbiwgMT1qdXN0IGFsb25nIGhlYWRlcgoKICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCkgewogICAgICAgICR0aGlzLT5saW5lID0gbmV3IExpbmVQcm9wZXJ0eSgpOwogICAgICAgICR0aGlzLT5saW5lLT5TZXRDb2xvcignZ3JheUAwLjQnKTsKICAgICAgICAkdGhpcy0+bGluZS0+U2V0U3R5bGUoJ2Rhc2hlZCcpOwogICAgfQoKICAgIGZ1bmN0aW9uIFNob3coJGFTaG93PXRydWUpIHsKICAgICAgICAkdGhpcy0+aVNob3cgPSAkYVNob3c7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0Um93RmlsbENvbG9yKCRhQ29sb3IxLCRhQ29sb3IyPScnKSB7CiAgICAgICAgJHRoaXMtPmlSb3dDb2xvcjEgPSAkYUNvbG9yMTsKICAgICAgICAkdGhpcy0+aVJvd0NvbG9yMiA9ICRhQ29sb3IyOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldFN0YXJ0KCRhU3RhcnQpIHsKICAgICAgICAkdGhpcy0+aVN0YXJ0ID0gJGFTdGFydDsKICAgIH0KCiAgICBmdW5jdGlvbiBTdHJva2UoJGFJbWcsJGFTY2FsZSkgewoKICAgICAgICBpZiggISAkdGhpcy0+aVNob3cgKSByZXR1cm47CgogICAgICAgIC8vIEdldCBob3Jpem9udGFsIHdpZHRoIG9mIGxpbmUKICAgICAgICAvKgogICAgICAgICRsaW1zdCA9ICRhU2NhbGUtPmlTdGFydERhdGU7CiAgICAgICAgJGxpbWVuID0gJGFTY2FsZS0+aUVuZERhdGU7CiAgICAgICAgJHh0ID0gcm91bmQoJGFTY2FsZS0+VHJhbnNsYXRlRGF0ZSgkYVNjYWxlLT5pU3RhcnREYXRlKSk7CiAgICAgICAgJHhiID0gcm91bmQoJGFTY2FsZS0+VHJhbnNsYXRlRGF0ZSgkbGltZW4pKTsKICAgICAgICAqLwoKICAgICAgICBpZiggJHRoaXMtPmlTdGFydCA9PT0gMCApIHsKICAgICAgICAgICAgJHh0ID0gJGFJbWctPmxlZnRfbWFyZ2luLTE7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAkeHQgPSByb3VuZCgkYVNjYWxlLT5UcmFuc2xhdGVEYXRlKCRhU2NhbGUtPmlTdGFydERhdGUpKSsxOwogICAgICAgIH0KCiAgICAgICAgJHhiID0gJGFJbWctPndpZHRoLSRhSW1nLT5yaWdodF9tYXJnaW47CgogICAgICAgICR5dCA9IHJvdW5kKCRhU2NhbGUtPlRyYW5zbGF0ZVZlcnRQb3MoMCkpOwogICAgICAgICR5YiA9IHJvdW5kKCRhU2NhbGUtPlRyYW5zbGF0ZVZlcnRQb3MoMSkpOwogICAgICAgICRoZWlnaHQgPSAkeWIgLSAkeXQ7CgogICAgICAgIC8vIExvb3AgYXJvdW5kIGZvciBhbGwgbGluZXMgaW4gdGhlIGNoYXJ0CiAgICAgICAgZm9yKCRpPTA7ICRpIDwgJGFTY2FsZS0+aVZlcnRMaW5lczsgKyskaSApIHsKICAgICAgICAgICAgJHliID0gJHl0IC0gJGhlaWdodDsKICAgICAgICAgICAgJHRoaXMtPmxpbmUtPlN0cm9rZSgkYUltZywkeHQsJHliLCR4YiwkeWIpOwogICAgICAgICAgICBpZiggJHRoaXMtPmlSb3dDb2xvcjEgIT09ICcnICkgewogICAgICAgICAgICAgICAgaWYoICRpICUgMiA9PSAwICkgewogICAgICAgICAgICAgICAgICAgICRhSW1nLT5QdXNoQ29sb3IoJHRoaXMtPmlSb3dDb2xvcjEpOwogICAgICAgICAgICAgICAgICAgICRhSW1nLT5GaWxsZWRSZWN0YW5nbGUoJHh0LCR5dCwkeGIsJHliKTsKICAgICAgICAgICAgICAgICAgICAkYUltZy0+UG9wQ29sb3IoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2VpZiggJHRoaXMtPmlSb3dDb2xvcjIgIT09ICcnICkgewogICAgICAgICAgICAgICAgICAgICRhSW1nLT5QdXNoQ29sb3IoJHRoaXMtPmlSb3dDb2xvcjIpOwogICAgICAgICAgICAgICAgICAgICRhSW1nLT5GaWxsZWRSZWN0YW5nbGUoJHh0LCR5dCwkeGIsJHliKTsKICAgICAgICAgICAgICAgICAgICAkYUltZy0+UG9wQ29sb3IoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAkeXQgPSByb3VuZCgkYVNjYWxlLT5UcmFuc2xhdGVWZXJ0UG9zKCRpKzEpKTsKICAgICAgICB9CiAgICAgICAgJHliID0gJHl0IC0gJGhlaWdodDsKICAgICAgICAkdGhpcy0+bGluZS0+U3Ryb2tlKCRhSW1nLCR4dCwkeWIsJHhiLCR5Yik7CiAgICB9Cn0KCgovLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQovLyBDTEFTUyBHYW50dEJhcgovLyBSZXNwb25zaWJsZSBmb3IgZm9ybWF0dGluZyBpbmRpdmlkdWFsIGdhbnR0IGJhcnMKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KY2xhc3MgR2FudHRCYXIgZXh0ZW5kcyBHYW50dFBsb3RPYmplY3QgewogICAgcHVibGljICRwcm9ncmVzczsKICAgIHB1YmxpYyAkbGVmdE1hcmssJHJpZ2h0TWFyazsKICAgIHByaXZhdGUgJGlFbmQ7CiAgICBwcml2YXRlICRpSGVpZ2h0RmFjdG9yPTAuNTsKICAgIHByaXZhdGUgJGlGaWxsQ29sb3I9IndoaXRlIiwkaUZyYW1lQ29sb3I9ImJsYWNrIjsKICAgIHByaXZhdGUgJGlTaGFkb3c9ZmFsc2UsJGlTaGFkb3dDb2xvcj0iZGFya2dyYXkiLCRpU2hhZG93V2lkdGg9MSwkaVNoYWRvd0ZyYW1lPSJibGFjayI7CiAgICBwcml2YXRlICRpUGF0dGVybj1HQU5UVF9SRElBRywkaVBhdHRlcm5Db2xvcj0iYmx1ZSIsJGlQYXR0ZXJuRGVuc2l0eT05NTsKICAgIHByaXZhdGUgJGlCcmVha1N0eWxlPWZhbHNlLCAkaUJyZWFrTGluZVN0eWxlPSdkb3R0ZWQnLCRpQnJlYWtMaW5lV2VpZ2h0PTE7CiAgICAvLy0tLS0tLS0tLS0tLS0tLQogICAgLy8gQ09OU1RSVUNUT1IKICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCRhUG9zLCRhTGFiZWwsJGFTdGFydCwkYUVuZCwkYUNhcHRpb249IiIsJGFIZWlnaHRGYWN0b3I9MC42KSB7CiAgICAgICAgcGFyZW50OjpfX2NvbnN0cnVjdCgpOwogICAgICAgICR0aGlzLT5pU3RhcnQgPSAkYVN0YXJ0OwogICAgICAgIC8vIElzIHRoZSBlbmQgZGF0ZSBnaXZlbiBhcyBhIGRhdGUgb3IgYXMgbnVtYmVyIG9mIGRheXMgYWRkZWQgdG8gc3RhcnQgZGF0ZT8KICAgICAgICBpZiggaXNfc3RyaW5nKCRhRW5kKSApIHsKICAgICAgICAgICAgLy8gSWYgZW5kIGRhdGUgaGFzIGJlZW4gc3BlY2lmaWVkIHdpdGhvdXQgYSB0aW1lIHdlIHdpbGwgYXNzc3VtZQogICAgICAgICAgICAvLyBlbmQgZGF0ZSBpcyBhdCB0aGUgZW5kIG9mIHRoYXQgZGF0ZQogICAgICAgICAgICBpZiggc3RycG9zKCRhRW5kLCc6JykgPT09IGZhbHNlICkgewogICAgICAgICAgICAJJHRoaXMtPmlFbmQgPSBzdHJ0b3RpbWUoJGFFbmQpK1NFQ1BFUkRBWS0xOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAJJHRoaXMtPmlFbmQgPSAkYUVuZDsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBlbHNlaWYoaXNfaW50KCRhRW5kKSB8fCBpc19mbG9hdCgkYUVuZCkgKSB7CiAgICAgICAgCSR0aGlzLT5pRW5kID0gc3RydG90aW1lKCRhU3RhcnQpK3JvdW5kKCRhRW5kKlNFQ1BFUkRBWSk7CiAgICAgICAgfQogICAgICAgICR0aGlzLT5pVlBvcyA9ICRhUG9zOwogICAgICAgICR0aGlzLT5pSGVpZ2h0RmFjdG9yID0gJGFIZWlnaHRGYWN0b3I7CiAgICAgICAgJHRoaXMtPnRpdGxlLT5TZXQoJGFMYWJlbCk7CiAgICAgICAgJHRoaXMtPmNhcHRpb24gPSBuZXcgVGV4dFByb3BlcnR5KCRhQ2FwdGlvbik7CiAgICAgICAgJHRoaXMtPmNhcHRpb24tPkFsaWduKCJsZWZ0IiwiY2VudGVyIik7CiAgICAgICAgJHRoaXMtPmxlZnRNYXJrID1uZXcgUGxvdE1hcmsoKTsKICAgICAgICAkdGhpcy0+bGVmdE1hcmstPkhpZGUoKTsKICAgICAgICAkdGhpcy0+cmlnaHRNYXJrPW5ldyBQbG90TWFyaygpOwogICAgICAgICR0aGlzLT5yaWdodE1hcmstPkhpZGUoKTsKICAgICAgICAkdGhpcy0+cHJvZ3Jlc3MgPSBuZXcgUHJvZ3Jlc3MoKTsKICAgIH0KCiAgICAvLy0tLS0tLS0tLS0tLS0tLQogICAgLy8gUFVCTElDIE1FVEhPRFMKICAgIGZ1bmN0aW9uIFNldFNoYWRvdygkYVNoYWRvdz10cnVlLCRhQ29sb3I9ImdyYXkiKSB7CiAgICAgICAgJHRoaXMtPmlTaGFkb3c9JGFTaGFkb3c7CiAgICAgICAgJHRoaXMtPmlTaGFkb3dDb2xvcj0kYUNvbG9yOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldEJyZWFrU3R5bGUoJGFGbGc9dHJ1ZSwkYUxpbmVTdHlsZT0nZG90dGVkJywkYUxpbmVXZWlnaHQ9MSkgewogICAgCSR0aGlzLT5pQnJlYWtTdHlsZSA9ICRhRmxnOwogICAgCSR0aGlzLT5pQnJlYWtMaW5lU3R5bGUgPSAkYUxpbmVTdHlsZTsKICAgIAkkdGhpcy0+aUJyZWFrTGluZVdlaWdodCA9ICRhTGluZVdlaWdodDsKICAgIH0KCiAgICBmdW5jdGlvbiBHZXRNYXhEYXRlKCkgewogICAgICAgIHJldHVybiAkdGhpcy0+aUVuZDsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRIZWlnaHQoJGFIZWlnaHQpIHsKICAgICAgICAkdGhpcy0+aUhlaWdodEZhY3RvciA9ICRhSGVpZ2h0OwogICAgfQoKICAgIGZ1bmN0aW9uIFNldENvbG9yKCRhQ29sb3IpIHsKICAgICAgICAkdGhpcy0+aUZyYW1lQ29sb3IgPSAkYUNvbG9yOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldEZpbGxDb2xvcigkYUNvbG9yKSB7CiAgICAgICAgJHRoaXMtPmlGaWxsQ29sb3IgPSAkYUNvbG9yOwogICAgfQoKICAgIGZ1bmN0aW9uIEdldEFic0hlaWdodCgkYUltZykgewogICAgICAgIGlmKCBpc19pbnQoJHRoaXMtPmlIZWlnaHRGYWN0b3IpIHx8ICR0aGlzLT5sZWZ0TWFyay0+c2hvdyB8fCAkdGhpcy0+cmlnaHRNYXJrLT5zaG93ICkgewogICAgICAgICAgICAkbT0tMTsKICAgICAgICAgICAgaWYoIGlzX2ludCgkdGhpcy0+aUhlaWdodEZhY3RvcikgKQogICAgICAgICAgICAJJG0gPSAkdGhpcy0+aUhlaWdodEZhY3RvcjsKICAgICAgICAgICAgaWYoICR0aGlzLT5sZWZ0TWFyay0+c2hvdyApCiAgICAgICAgICAgIAkkbSA9IG1heCgkbSwkdGhpcy0+bGVmdE1hcmstPndpZHRoKjIpOwogICAgICAgICAgICBpZiggJHRoaXMtPnJpZ2h0TWFyay0+c2hvdyApCiAgICAgICAgICAgIAkkbSA9IG1heCgkbSwkdGhpcy0+cmlnaHRNYXJrLT53aWR0aCoyKTsKICAgICAgICAgICAgcmV0dXJuICRtOwogICAgICAgIH0KICAgICAgICBlbHNlCiAgICAgICAgCXJldHVybiAtMTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRQYXR0ZXJuKCRhUGF0dGVybiwkYUNvbG9yPSJibHVlIiwkYURlbnNpdHk9OTUpIHsKICAgICAgICAkdGhpcy0+aVBhdHRlcm4gPSAkYVBhdHRlcm47CiAgICAgICAgJHRoaXMtPmlQYXR0ZXJuQ29sb3IgPSAkYUNvbG9yOwogICAgICAgICR0aGlzLT5pUGF0dGVybkRlbnNpdHkgPSAkYURlbnNpdHk7CiAgICB9CgogICAgZnVuY3Rpb24gU3Ryb2tlKCRhSW1nLCRhU2NhbGUpIHsKICAgICAgICAkZmFjdG9yeSA9IG5ldyBSZWN0UGF0dGVybkZhY3RvcnkoKTsKICAgICAgICAkcHJlY3QgPSAkZmFjdG9yeS0+Q3JlYXRlKCR0aGlzLT5pUGF0dGVybiwkdGhpcy0+aVBhdHRlcm5Db2xvcik7CiAgICAgICAgJHByZWN0LT5TZXREZW5zaXR5KCR0aGlzLT5pUGF0dGVybkRlbnNpdHkpOwoKICAgICAgICAvLyBJZiBoZWlnaHQgZmFjdG9yIGlzIHNwZWNpZmllZCBhcyBhIGZsb2F0IGJldHdlZW4gMCwxIHRoZW4gd2UgdGFrZSBpdCBhcyBtZWFuaW5nCiAgICAgICAgLy8gcGVyY2V0YWdlIG9mIHRoZSBzY2FsZSB3aWR0aCBiZXR3ZWVuIGhvcml6b250YWwgbGluZS4KICAgICAgICAvLyBJZiBpdCBpcyBhbiBpbnRlZ2VyID4gMSB3ZSB0YWtlIGl0IHRvIG1lYW4gdGhlIGFic29sdXRlIGhlaWdodCBpbiBwaXhlbHMKICAgICAgICBpZiggJHRoaXMtPmlIZWlnaHRGYWN0b3IgPiAtMC4wICYmICR0aGlzLT5pSGVpZ2h0RmFjdG9yIDw9IDEuMSkKICAgICAgICAJJHZzID0gJGFTY2FsZS0+R2V0VmVydFNwYWNpbmcoKSokdGhpcy0+aUhlaWdodEZhY3RvcjsKICAgICAgICBlbHNlaWYoaXNfaW50KCR0aGlzLT5pSGVpZ2h0RmFjdG9yKSAmJiAkdGhpcy0+aUhlaWdodEZhY3Rvcj4yICYmICR0aGlzLT5pSGVpZ2h0RmFjdG9yIDwgMjAwICkKICAgICAgICAJJHZzID0gJHRoaXMtPmlIZWlnaHRGYWN0b3I7CiAgICAgICAgZWxzZSB7CiAgICAgICAgCUpwR3JhcGhFcnJvcjo6UmFpc2VMKDYwMjgsJHRoaXMtPmlIZWlnaHRGYWN0b3IpOwogICAgICAgIAkvLwkoIlNwZWNpZmllZCBoZWlnaHQgKCIuJHRoaXMtPmlIZWlnaHRGYWN0b3IuIikgZm9yIGdhbnR0IGJhciBpcyBvdXQgb2YgcmFuZ2UuIik7CiAgICAgICAgfQoKICAgICAgICAvLyBDbGlwIGRhdGUgdG8gbWluIG1heCBkYXRlcyB0byBzaG93CiAgICAgICAgJHN0ID0gJGFTY2FsZS0+Tm9ybWFsaXplRGF0ZSgkdGhpcy0+aVN0YXJ0KTsKICAgICAgICAkZW4gPSAkYVNjYWxlLT5Ob3JtYWxpemVEYXRlKCR0aGlzLT5pRW5kKTsKCiAgICAgICAgJGxpbXN0ID0gbWF4KCRzdCwkYVNjYWxlLT5pU3RhcnREYXRlKTsKICAgICAgICAkbGltZW4gPSBtaW4oJGVuLCRhU2NhbGUtPmlFbmREYXRlKTsKCiAgICAgICAgJHh0ID0gcm91bmQoJGFTY2FsZS0+VHJhbnNsYXRlRGF0ZSgkbGltc3QpKTsKICAgICAgICAkeGIgPSByb3VuZCgkYVNjYWxlLT5UcmFuc2xhdGVEYXRlKCRsaW1lbikpOwogICAgICAgICR5dCA9IHJvdW5kKCRhU2NhbGUtPlRyYW5zbGF0ZVZlcnRQb3MoJHRoaXMtPmlWUG9zKS0kdnMtKCRhU2NhbGUtPkdldFZlcnRTcGFjaW5nKCkvMi0kdnMvMikpOwogICAgICAgICR5YiA9IHJvdW5kKCRhU2NhbGUtPlRyYW5zbGF0ZVZlcnRQb3MoJHRoaXMtPmlWUG9zKS0oJGFTY2FsZS0+R2V0VmVydFNwYWNpbmcoKS8yLSR2cy8yKSk7CiAgICAgICAgJG1pZGRsZSA9IHJvdW5kKCR5dCsoJHliLSR5dCkvMik7CiAgICAgICAgJHRoaXMtPlN0cm9rZUFjdEluZm8oJGFJbWcsJGFTY2FsZSwkbWlkZGxlKTsKCiAgICAgICAgLy8gQ1NJTSBmb3IgdGl0bGUKICAgICAgICBpZiggISBlbXB0eSgkdGhpcy0+dGl0bGUtPmNzaW10YXJnZXQpICkgewogICAgICAgICAgICAkY29sd2lkdGggPSAkdGhpcy0+dGl0bGUtPkdldENvbFdpZHRoKCRhSW1nKTsKICAgICAgICAgICAgJGNvbHN0YXJ0cz1hcnJheSgpOwogICAgICAgICAgICAkYVNjYWxlLT5hY3RpbmZvLT5HZXRDb2xTdGFydCgkYUltZywkY29sc3RhcnRzLHRydWUpOwogICAgICAgICAgICAkbiA9IG1pbihjb3VudCgkY29sd2lkdGgpLGNvdW50KCR0aGlzLT50aXRsZS0+Y3NpbXRhcmdldCkpOwogICAgICAgICAgICBmb3IoICRpPTA7ICRpIDwgJG47ICsrJGkgKSB7CiAgICAgICAgICAgICAgICAkdGl0bGVfeHQgPSAkY29sc3RhcnRzWyRpXTsKICAgICAgICAgICAgICAgICR0aXRsZV94YiA9ICR0aXRsZV94dCArICRjb2x3aWR0aFskaV07CiAgICAgICAgICAgICAgICAkY29vcmRzID0gIiR0aXRsZV94dCwkeXQsJHRpdGxlX3hiLCR5dCwkdGl0bGVfeGIsJHliLCR0aXRsZV94dCwkeWIiOwoKICAgICAgICAgICAgICAgIGlmKCAhIGVtcHR5KCR0aGlzLT50aXRsZS0+Y3NpbXRhcmdldFskaV0pICkgewogICAgICAgICAgICAgICAgICAgICR0aGlzLT5jc2ltYXJlYSAuPSAiPGFyZWEgc2hhcGU9XCJwb2x5XCIgY29vcmRzPVwiJGNvb3Jkc1wiIGhyZWY9XCIiLiR0aGlzLT50aXRsZS0+Y3NpbXRhcmdldFskaV0uIlwiIjsKCiAgICAgICAgICAgICAgICAgICAgaWYoICEgZW1wdHkoJHRoaXMtPnRpdGxlLT5jc2ltd2ludGFyZ2V0WyRpXSkgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5jc2ltYXJlYSAuPSAidGFyZ2V0PVwiIi4kdGhpcy0+dGl0bGUtPmNzaW13aW50YXJnZXRbJGldLiJcIiAiOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYoICEgZW1wdHkoJHRoaXMtPnRpdGxlLT5jc2ltYWx0WyRpXSkgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICR0bXAgPSAkdGhpcy0+dGl0bGUtPmNzaW1hbHRbJGldOwogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y3NpbWFyZWEgLj0gIiB0aXRsZT1cIiR0bXBcIiBhbHQ9XCIkdG1wXCIgIjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmNzaW1hcmVhIC49ICIgLz5cbiI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIENoZWNrIGlmIHRoZSBiYXIgaXMgdG90YWxseSBvdXRzaWRlIHRoZSBjdXJyZW50IHNjYWxlIHJhbmdlCiAgICAgICAgaWYoICRlbiA8ICAkYVNjYWxlLT5pU3RhcnREYXRlIHx8ICRzdCA+ICRhU2NhbGUtPmlFbmREYXRlICkKICAgICAgICAJcmV0dXJuOwoKCiAgICAgICAgLy8gUmVtZW1iZXIgdGhlIHBvc2l0aW9ucyBmb3IgdGhlIGJhcgogICAgICAgICR0aGlzLT5TZXRDb25zdHJhaW5Qb3MoJHh0LCR5dCwkeGIsJHliKTsKCgoKICAgICAgICAkcHJlY3QtPlNob3dGcmFtZShmYWxzZSk7CiAgICAgICAgJHByZWN0LT5TZXRCYWNrZ3JvdW5kKCR0aGlzLT5pRmlsbENvbG9yKTsKICAgICAgICBpZiggJHRoaXMtPmlCcmVha1N0eWxlICkgewogICAgICAgIAkkYUltZy0+U2V0Q29sb3IoJHRoaXMtPmlGcmFtZUNvbG9yKTsKICAgICAgICAJJG9sZHMgPSAkYUltZy0+U2V0TGluZVN0eWxlKCR0aGlzLT5pQnJlYWtMaW5lU3R5bGUpOwogICAgICAgIAkkb2xkdyA9ICRhSW1nLT5TZXRMaW5lV2VpZ2h0KCR0aGlzLT5pQnJlYWtMaW5lV2VpZ2h0KTsKICAgICAgICAJJGFJbWctPlN0eWxlTGluZSgkeHQsJHl0LCR4YiwkeXQpOwogICAgICAgIAkkYUltZy0+U3R5bGVMaW5lKCR4dCwkeWIsJHhiLCR5Yik7CiAgICAgICAgCSRhSW1nLT5TZXRMaW5lU3R5bGUoJG9sZHMpOwogICAgICAgIAkkYUltZy0+U2V0TGluZVdlaWdodCgkb2xkdyk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewoJICAgICAgICBpZiggJHRoaXMtPmlTaGFkb3cgKSB7CgkgICAgICAgICAgICAkYUltZy0+U2V0Q29sb3IoJHRoaXMtPmlGcmFtZUNvbG9yKTsKCSAgICAgICAgICAgICRhSW1nLT5TaGFkb3dSZWN0YW5nbGUoJHh0LCR5dCwkeGIsJHliLCR0aGlzLT5pRmlsbENvbG9yLCR0aGlzLT5pU2hhZG93V2lkdGgsJHRoaXMtPmlTaGFkb3dDb2xvcik7CgkgICAgICAgICAgICAkcHJlY3QtPlNldFBvcyhuZXcgUmVjdGFuZ2xlKCR4dCsxLCR5dCsxLCR4Yi0keHQtJHRoaXMtPmlTaGFkb3dXaWR0aC0yLCR5Yi0keXQtJHRoaXMtPmlTaGFkb3dXaWR0aC0yKSk7CgkgICAgICAgICAgICAkcHJlY3QtPlN0cm9rZSgkYUltZyk7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAkcHJlY3QtPlNldFBvcyhuZXcgUmVjdGFuZ2xlKCR4dCwkeXQsJHhiLSR4dCsxLCR5Yi0keXQrMSkpOwoJICAgICAgICAgICAgJHByZWN0LT5TdHJva2UoJGFJbWcpOwoJICAgICAgICAgICAgJGFJbWctPlNldENvbG9yKCR0aGlzLT5pRnJhbWVDb2xvcik7CgkgICAgICAgICAgICAkYUltZy0+UmVjdGFuZ2xlKCR4dCwkeXQsJHhiLCR5Yik7CgkgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLy8gQ1NJTSBmb3IgYmFyCiAgICAgICAgaWYoICEgZW1wdHkoJHRoaXMtPmNzaW10YXJnZXQpICkgewoKICAgICAgICAgICAgJGNvb3JkcyA9ICIkeHQsJHl0LCR4YiwkeXQsJHhiLCR5YiwkeHQsJHliIjsKICAgICAgICAgICAgJHRoaXMtPmNzaW1hcmVhIC49ICI8YXJlYSBzaGFwZT1cInBvbHlcIiBjb29yZHM9XCIkY29vcmRzXCIgaHJlZj1cIiIuJHRoaXMtPmNzaW10YXJnZXQuIlwiIjsKCiAgICAgICAgICAgIGlmKCAhZW1wdHkoJHRoaXMtPmNzaW13aW50YXJnZXQpICkgewogICAgICAgICAgICAgICAgJHRoaXMtPmNzaW1hcmVhIC49ICIgdGFyZ2V0PVwiIi4kdGhpcy0+Y3NpbXdpbnRhcmdldC4iXCIgIjsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYoICR0aGlzLT5jc2ltYWx0ICE9ICcnICkgewogICAgICAgICAgICAgICAgJHRtcCA9ICR0aGlzLT5jc2ltYWx0OwogICAgICAgICAgICAgICAgJHRoaXMtPmNzaW1hcmVhIC49ICIgdGl0bGU9XCIkdG1wXCIgYWx0PVwiJHRtcFwiICI7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJHRoaXMtPmNzaW1hcmVhIC49ICIgLz5cbiI7CiAgICAgICAgfQoKICAgICAgICAvLyBEcmF3IHByb2dyZXNzIGJhciBpbnNpZGUgYWN0aXZpdHkgYmFyCiAgICAgICAgaWYoICR0aGlzLT5wcm9ncmVzcy0+aVByb2dyZXNzID4gMCApIHsKCiAgICAgICAgICAgICR4dHAgPSAkYVNjYWxlLT5UcmFuc2xhdGVEYXRlKCRzdCk7CiAgICAgICAgICAgICR4YnAgPSAkYVNjYWxlLT5UcmFuc2xhdGVEYXRlKCRlbik7CiAgICAgICAgICAgICRsZW4gPSAoJHhicC0keHRwKSokdGhpcy0+cHJvZ3Jlc3MtPmlQcm9ncmVzczsKCiAgICAgICAgICAgICRlbmRwb3MgPSAkeHRwKyRsZW47CiAgICAgICAgICAgIGlmKCAkZW5kcG9zID4gJHh0ICkgewoKICAgICAgICAgICAgICAgIC8vIFRha2UgYXdheSB0aGUgbGVuZ3RoIG9mIHRoZSBwcm9ncmVzcyB0aGF0IGlzIG5vdCB2aXNpYmxlIChiZWZvcmUgdGhlIHN0YXJ0IGRhdGUpCiAgICAgICAgICAgICAgICAkbGVuIC09ICgkeHQtJHh0cCk7CgogICAgICAgICAgICAgICAgLy8gSXMgdGhlIHRoZSBwcm9ncmVzcyBiYXIgdmlzaWJsZSBhZnRlciB0aGUgc3RhcnQgZGF0ZT8KICAgICAgICAgICAgICAgIGlmKCAkeHRwIDwgJHh0ICkKICAgICAgICAgICAgICAgICR4dHAgPSAkeHQ7CgogICAgICAgICAgICAgICAgLy8gTWFrZSBzdXJlIHRoYXQgdGhlIHByb2dlc3MgYmFyIGRvZXNuJ3QgZXh0ZW5kIG92ZXIgdGhlIGVuZCBkYXRlCiAgICAgICAgICAgICAgICBpZiggJHh0cCskbGVuLTEgPiAkeGIgKQogICAgICAgICAgICAgICAgJGxlbiA9ICR4YiAtICR4dHAgOwoKICAgICAgICAgICAgICAgICRwcm9nID0gJGZhY3RvcnktPkNyZWF0ZSgkdGhpcy0+cHJvZ3Jlc3MtPmlQYXR0ZXJuLCR0aGlzLT5wcm9ncmVzcy0+aUNvbG9yKTsKICAgICAgICAgICAgICAgICRwcm9nLT5TZXREZW5zaXR5KCR0aGlzLT5wcm9ncmVzcy0+aURlbnNpdHkpOwogICAgICAgICAgICAgICAgJHByb2ctPlNldEJhY2tncm91bmQoJHRoaXMtPnByb2dyZXNzLT5pRmlsbENvbG9yKTsKICAgICAgICAgICAgICAgICRiYXJoZWlnaHQgPSAoJHliLSR5dCsxKTsKICAgICAgICAgICAgICAgIGlmKCAkdGhpcy0+aVNoYWRvdyApCiAgICAgICAgICAgICAgICAJJGJhcmhlaWdodCAtPSAkdGhpcy0+aVNoYWRvd1dpZHRoOwogICAgICAgICAgICAgICAgJHByb2dyZXNzaGVpZ2h0ID0gZmxvb3IoJGJhcmhlaWdodCokdGhpcy0+cHJvZ3Jlc3MtPmlIZWlnaHQpOwogICAgICAgICAgICAgICAgJG1hcmcgPSBjZWlsKCgkYmFyaGVpZ2h0LSRwcm9ncmVzc2hlaWdodCkvMik7CiAgICAgICAgICAgICAgICAkcG9zID0gbmV3IFJlY3RhbmdsZSgkeHRwLCR5dCArICRtYXJnLCAkbGVuLCRiYXJoZWlnaHQtMiokbWFyZyk7CiAgICAgICAgICAgICAgICAkcHJvZy0+U2V0UG9zKCRwb3MpOwogICAgICAgICAgICAgICAgJHByb2ctPlN0cm9rZSgkYUltZyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIFdlIGRvbid0IHBsb3QgdGhlIGVuZCBtYXJrIGlmIHRoZSBiYXIgaGFzIGJlZW4gY2FwcGVkCiAgICAgICAgaWYoICRsaW1zdCA9PSAkc3QgKSB7CiAgICAgICAgICAgICR5ID0gJG1pZGRsZTsKICAgICAgICAgICAgLy8gV2UgdHJlYXQgdGhlIFJJR0hUIGFuZCBMRUZUIHRyaWFuZ2xlIG1hcmsgYSBsaXR0bGUgYmkKICAgICAgICAgICAgLy8gc3BlY2lhbCBzbyB0aGF0IHRoZXNlIG1hcmtzIGFyZSBwbGFjZWQgcmlnaHQgdW5kZXIgdGhlCiAgICAgICAgICAgIC8vIGJhci4KICAgICAgICAgICAgaWYoICR0aGlzLT5sZWZ0TWFyay0+R2V0VHlwZSgpID09IE1BUktfTEVGVFRSSUFOR0xFICkgewogICAgICAgICAgICAgICAgJHkgPSAkeWIgOwogICAgICAgICAgICB9CiAgICAgICAgICAgICR0aGlzLT5sZWZ0TWFyay0+U3Ryb2tlKCRhSW1nLCR4dCwkeSk7CiAgICAgICAgfQogICAgICAgIGlmKCAkbGltZW4gPT0gJGVuICkgewogICAgICAgICAgICAkeSA9ICRtaWRkbGU7CiAgICAgICAgICAgIC8vIFdlIHRyZWF0IHRoZSBSSUdIVCBhbmQgTEVGVCB0cmlhbmdsZSBtYXJrIGEgbGl0dGxlIGJpCiAgICAgICAgICAgIC8vIHNwZWNpYWwgc28gdGhhdCB0aGVzZSBtYXJrcyBhcmUgcGxhY2VkIHJpZ2h0IHVuZGVyIHRoZQogICAgICAgICAgICAvLyBiYXIuCiAgICAgICAgICAgIGlmKCAkdGhpcy0+cmlnaHRNYXJrLT5HZXRUeXBlKCkgPT0gTUFSS19SSUdIVFRSSUFOR0xFICkgewogICAgICAgICAgICAgICAgJHkgPSAkeWIgOwogICAgICAgICAgICB9CiAgICAgICAgICAgICR0aGlzLT5yaWdodE1hcmstPlN0cm9rZSgkYUltZywkeGIsJHkpOwoKICAgICAgICAgICAgJG1hcmdpbiA9ICR0aGlzLT5pQ2FwdGlvbk1hcmdpbjsKICAgICAgICAgICAgaWYoICR0aGlzLT5yaWdodE1hcmstPnNob3cgKQogICAgICAgICAgICAJJG1hcmdpbiArPSAkdGhpcy0+cmlnaHRNYXJrLT5HZXRXaWR0aCgpOwogICAgICAgICAgICAkdGhpcy0+Y2FwdGlvbi0+U3Ryb2tlKCRhSW1nLCR4YiskbWFyZ2luLCRtaWRkbGUpOwogICAgICAgIH0KICAgIH0KfQoKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gQ0xBU1MgTWlsZVN0b25lCi8vIFJlc3BvbnNpYmxlIGZvciBmb3JtYXR0aW5nIGluZGl2aWR1YWwgbWlsZXN0b25lcwovLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpjbGFzcyBNaWxlU3RvbmUgZXh0ZW5kcyBHYW50dFBsb3RPYmplY3QgewogICAgcHVibGljICRtYXJrOwoKICAgIC8vLS0tLS0tLS0tLS0tLS0tCiAgICAvLyBDT05TVFJVQ1RPUgogICAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGFWUG9zLCRhTGFiZWwsJGFEYXRlLCRhQ2FwdGlvbj0iIikgewogICAgICAgIEdhbnR0UGxvdE9iamVjdDo6X19jb25zdHJ1Y3QoKTsKICAgICAgICAkdGhpcy0+Y2FwdGlvbi0+U2V0KCRhQ2FwdGlvbik7CiAgICAgICAgJHRoaXMtPmNhcHRpb24tPkFsaWduKCJsZWZ0IiwiY2VudGVyIik7CiAgICAgICAgJHRoaXMtPmNhcHRpb24tPlNldEZvbnQoRkZfRk9OVDEsRlNfQk9MRCk7CiAgICAgICAgJHRoaXMtPnRpdGxlLT5TZXQoJGFMYWJlbCk7CiAgICAgICAgJHRoaXMtPnRpdGxlLT5TZXRDb2xvcigiZGFya3JlZCIpOwogICAgICAgICR0aGlzLT5tYXJrID0gbmV3IFBsb3RNYXJrKCk7CiAgICAgICAgJHRoaXMtPm1hcmstPlNldFdpZHRoKDEwKTsKICAgICAgICAkdGhpcy0+bWFyay0+U2V0VHlwZShNQVJLX0RJQU1PTkQpOwogICAgICAgICR0aGlzLT5tYXJrLT5TZXRDb2xvcigiZGFya3JlZCIpOwogICAgICAgICR0aGlzLT5tYXJrLT5TZXRGaWxsQ29sb3IoImRhcmtyZWQiKTsKICAgICAgICAkdGhpcy0+aVZQb3MgPSAkYVZQb3M7CiAgICAgICAgJHRoaXMtPmlTdGFydCA9ICRhRGF0ZTsKICAgIH0KCiAgICAvLy0tLS0tLS0tLS0tLS0tLQogICAgLy8gUFVCTElDIE1FVEhPRFMKCiAgICBmdW5jdGlvbiBHZXRBYnNIZWlnaHQoJGFJbWcpIHsKICAgICAgICByZXR1cm4gbWF4KCR0aGlzLT50aXRsZS0+R2V0SGVpZ2h0KCRhSW1nKSwkdGhpcy0+bWFyay0+R2V0V2lkdGgoKSk7CiAgICB9CgogICAgZnVuY3Rpb24gU3Ryb2tlKCRhSW1nLCRhU2NhbGUpIHsKICAgICAgICAvLyBQdXQgdGhlIG1hcmsgaW4gdGhlIG1pZGRsZSBhdCB0aGUgbWlkZGxlIG9mIHRoZSBkYXkKICAgICAgICAkZCA9ICRhU2NhbGUtPk5vcm1hbGl6ZURhdGUoJHRoaXMtPmlTdGFydCkrU0VDUEVSREFZLzI7CiAgICAgICAgJHggPSAkYVNjYWxlLT5UcmFuc2xhdGVEYXRlKCRkKTsKICAgICAgICAkeSA9ICRhU2NhbGUtPlRyYW5zbGF0ZVZlcnRQb3MoJHRoaXMtPmlWUG9zKS0oJGFTY2FsZS0+R2V0VmVydFNwYWNpbmcoKS8yKTsKCiAgICAgICAgJHRoaXMtPlN0cm9rZUFjdEluZm8oJGFJbWcsJGFTY2FsZSwkeSk7CgogICAgICAgIC8vIENTSU0gZm9yIHRpdGxlCiAgICAgICAgaWYoICEgZW1wdHkoJHRoaXMtPnRpdGxlLT5jc2ltdGFyZ2V0KSApIHsKCiAgICAgICAgICAgICR5dCA9IHJvdW5kKCR5IC0gJHRoaXMtPnRpdGxlLT5HZXRIZWlnaHQoJGFJbWcpLzIpOwogICAgICAgICAgICAkeWIgPSByb3VuZCgkeSArICR0aGlzLT50aXRsZS0+R2V0SGVpZ2h0KCRhSW1nKS8yKTsKCiAgICAgICAgICAgICRjb2x3aWR0aCA9ICR0aGlzLT50aXRsZS0+R2V0Q29sV2lkdGgoJGFJbWcpOwogICAgICAgICAgICAkY29sc3RhcnRzPWFycmF5KCk7CiAgICAgICAgICAgICRhU2NhbGUtPmFjdGluZm8tPkdldENvbFN0YXJ0KCRhSW1nLCRjb2xzdGFydHMsdHJ1ZSk7CiAgICAgICAgICAgICRuID0gbWluKGNvdW50KCRjb2x3aWR0aCksY291bnQoJHRoaXMtPnRpdGxlLT5jc2ltdGFyZ2V0KSk7CiAgICAgICAgICAgIGZvciggJGk9MDsgJGkgPCAkbjsgKyskaSApIHsKICAgICAgICAgICAgICAgICR0aXRsZV94dCA9ICRjb2xzdGFydHNbJGldOwogICAgICAgICAgICAgICAgJHRpdGxlX3hiID0gJHRpdGxlX3h0ICsgJGNvbHdpZHRoWyRpXTsKICAgICAgICAgICAgICAgICRjb29yZHMgPSAiJHRpdGxlX3h0LCR5dCwkdGl0bGVfeGIsJHl0LCR0aXRsZV94YiwkeWIsJHRpdGxlX3h0LCR5YiI7CgogICAgICAgICAgICAgICAgaWYoICFlbXB0eSgkdGhpcy0+dGl0bGUtPmNzaW10YXJnZXRbJGldKSApIHsKCiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmNzaW1hcmVhIC49ICI8YXJlYSBzaGFwZT1cInBvbHlcIiBjb29yZHM9XCIkY29vcmRzXCIgaHJlZj1cIiIuJHRoaXMtPnRpdGxlLT5jc2ltdGFyZ2V0WyRpXS4iXCIiOwoKICAgICAgICAgICAgICAgICAgICBpZiggIWVtcHR5KCR0aGlzLT50aXRsZS0+Y3NpbXdpbnRhcmdldFskaV0pICkgewogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y3NpbWFyZWEgLj0gInRhcmdldD1cIiIuJHRoaXMtPnRpdGxlLT5jc2ltd2ludGFyZ2V0WyRpXS4iXCIiOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYoICEgZW1wdHkoJHRoaXMtPnRpdGxlLT5jc2ltYWx0WyRpXSkgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICR0bXAgPSAkdGhpcy0+dGl0bGUtPmNzaW1hbHRbJGldOwogICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy0+Y3NpbWFyZWEgLj0gIiB0aXRsZT1cIiR0bXBcIiBhbHQ9XCIkdG1wXCIgIjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmNzaW1hcmVhIC49ICIgLz5cbiI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmKCAkZCA8ICAkYVNjYWxlLT5pU3RhcnREYXRlIHx8ICRkID4gJGFTY2FsZS0+aUVuZERhdGUgKQogICAgICAgIAlyZXR1cm47CgogICAgICAgIC8vIFJlbWVtYmVyIHRoZSBjb29yZGluYXRlcyBmb3IgYW55IGNvbnN0cmFpbnMgbGlua2luZyB0bwogICAgICAgIC8vIHRoaXMgbWlsZXN0b25lCiAgICAgICAgJHcgPSAkdGhpcy0+bWFyay0+R2V0V2lkdGgoKS8yOwogICAgICAgICR0aGlzLT5TZXRDb25zdHJhaW5Qb3MoJHgscm91bmQoJHktJHcpLCR4LHJvdW5kKCR5KyR3KSk7CgogICAgICAgIC8vIFNldHVwIENTSU0KICAgICAgICBpZiggJHRoaXMtPmNzaW10YXJnZXQgIT0gJycgKSB7CiAgICAgICAgICAgICR0aGlzLT5tYXJrLT5TZXRDU0lNVGFyZ2V0KCAkdGhpcy0+Y3NpbXRhcmdldCApOwogICAgICAgICAgICAkdGhpcy0+bWFyay0+U2V0Q1NJTUFsdCggJHRoaXMtPmNzaW1hbHQgKTsKICAgICAgICB9CgogICAgICAgICR0aGlzLT5tYXJrLT5TdHJva2UoJGFJbWcsJHgsJHkpOwogICAgICAgICR0aGlzLT5jYXB0aW9uLT5TdHJva2UoJGFJbWcsJHgrJHRoaXMtPm1hcmstPndpZHRoLzIrJHRoaXMtPmlDYXB0aW9uTWFyZ2luLCR5KTsKCiAgICAgICAgJHRoaXMtPmNzaW1hcmVhIC49ICR0aGlzLT5tYXJrLT5HZXRDU0lNQXJlYXMoKTsKICAgIH0KfQoKCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIENMQVNTIEdhbnR0VkxpbmUKLy8gUmVzcG9uc2libGUgZm9yIGZvcm1hdHRpbmcgaW5kaXZpZHVhbCBtaWxlc3RvbmVzCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBUZXh0UHJvcGVydHlCZWxvdyBleHRlbmRzIFRleHRQcm9wZXJ0eSB7CiAgICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkYVR4dD0nJykgewogICAgICAgIHBhcmVudDo6X19jb25zdHJ1Y3QoJGFUeHQpOwogICAgfQoKICAgIGZ1bmN0aW9uIEdldENvbFdpZHRoKCRhSW1nLCRhTWFyZ2luPTApIHsKICAgICAgICAvLyBTaW5jZSB3ZSBhcmUgbm90IHN0cm9raW5nIHRoZSB0aXRsZSBpbiB0aGUgY29sdW1ucwogICAgICAgIC8vIGJ1dCByYXRoZXIgdW5kZXIgdGhlIGdyYXBoIHdlIHdhbnQgdGhpcyB0byByZXR1cm4gMC4KICAgICAgICByZXR1cm4gYXJyYXkoMCk7CiAgICB9Cn0KCmNsYXNzIEdhbnR0VkxpbmUgZXh0ZW5kcyBHYW50dFBsb3RPYmplY3QgewoKICAgIHByaXZhdGUgJGlMaW5lLCR0aXRsZV9tYXJnaW49MywgJGlEYXlPZmZzZXQ9MC41OwogICAgcHJpdmF0ZSAkaVN0YXJ0Um93ID0gLTEsICRpRW5kUm93ID0gLTE7CgogICAgLy8tLS0tLS0tLS0tLS0tLS0KICAgIC8vIENPTlNUUlVDVE9SCiAgICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkYURhdGUsJGFUaXRsZT0iIiwkYUNvbG9yPSJkYXJrcmVkIiwkYVdlaWdodD0yLCRhU3R5bGU9InNvbGlkIikgewogICAgICAgIEdhbnR0UGxvdE9iamVjdDo6X19jb25zdHJ1Y3QoKTsKICAgICAgICAkdGhpcy0+aUxpbmUgPSBuZXcgTGluZVByb3BlcnR5KCk7CiAgICAgICAgJHRoaXMtPmlMaW5lLT5TZXRDb2xvcigkYUNvbG9yKTsKICAgICAgICAkdGhpcy0+aUxpbmUtPlNldFdlaWdodCgkYVdlaWdodCk7CiAgICAgICAgJHRoaXMtPmlMaW5lLT5TZXRTdHlsZSgkYVN0eWxlKTsKICAgICAgICAkdGhpcy0+aVN0YXJ0ID0gJGFEYXRlOwogICAgICAgICR0aGlzLT50aXRsZSA9IG5ldyBUZXh0UHJvcGVydHlCZWxvdygpOwogICAgICAgICR0aGlzLT50aXRsZS0+U2V0KCRhVGl0bGUpOwogICAgfQoKICAgIC8vLS0tLS0tLS0tLS0tLS0tCiAgICAvLyBQVUJMSUMgTUVUSE9EUwoKICAgIC8vIFNldCBzdGFydCBhbmQgZW5kIHJvd3MgZm9yIHRoZSBWTGluZS4gQnkgZGVmYXVsdCB0aGUgZW50aXJlIGhlaWdoIG9mIHRoZQogICAgLy8gR2FudHQgY2hhcnQgaXMgdXNlZAogICAgZnVuY3Rpb24gU2V0Um93U3BhbigkYVN0YXJ0LCAkYUVuZD0tMSkgewogICAgICAgICR0aGlzLT5pU3RhcnRSb3cgPSAkYVN0YXJ0OwogICAgICAgICR0aGlzLT5pRW5kUm93ID0gJGFFbmQ7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0RGF5T2Zmc2V0KCRhT2ZmPTAuNSkgewogICAgICAgIGlmKCAkYU9mZiA8IDAuMCB8fCAkYU9mZiA+IDEuMCApIHsKICAgICAgICAJSnBHcmFwaEVycm9yOjpSYWlzZUwoNjAyOSk7CiAgICAgICAgCS8vKCJPZmZzZXQgZm9yIHZlcnRpY2FsIGxpbmUgbXVzdCBiZSBpbiByYW5nZSBbMCwxXSIpOwogICAgICAgIH0KICAgICAgICAkdGhpcy0+aURheU9mZnNldCA9ICRhT2ZmOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldFRpdGxlTWFyZ2luKCRhTWFyZykgewogICAgICAgICR0aGlzLT50aXRsZV9tYXJnaW4gPSAkYU1hcmc7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0V2VpZ2h0KCRhV2VpZ2h0KSB7CiAgICAgICAgJHRoaXMtPmlMaW5lLT5TZXRXZWlnaHQoJGFXZWlnaHQpOwogICAgfQoKICAgIGZ1bmN0aW9uIFN0cm9rZSgkYUltZywkYVNjYWxlKSB7CiAgICAgICAgJGQgPSAkYVNjYWxlLT5Ob3JtYWxpemVEYXRlKCR0aGlzLT5pU3RhcnQpOwogICAgICAgIGlmKCAkZCA8ICAkYVNjYWxlLT5pU3RhcnREYXRlIHx8ICRkID4gJGFTY2FsZS0+aUVuZERhdGUgKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgaWYoJHRoaXMtPmlEYXlPZmZzZXQgIT0gMC4wKQogICAgICAgICAgICAkZCArPSAyNCo2MCo2MCokdGhpcy0+aURheU9mZnNldDsKICAgICAgICAkeCA9ICRhU2NhbGUtPlRyYW5zbGF0ZURhdGUoJGQpOy8vZD0xMDA2ODU4ODAwLAoKICAgICAgICBpZiggJHRoaXMtPmlTdGFydFJvdyA+IC0xICkgewogICAgICAgICAgICAkeTEgPSAkYVNjYWxlLT5UcmFuc2xhdGVWZXJ0UG9zKCR0aGlzLT5pU3RhcnRSb3csdHJ1ZSkgOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJHkxID0gJGFTY2FsZS0+aVZlcnRIZWFkZXJTaXplKyRhSW1nLT50b3BfbWFyZ2luOwogICAgICAgIH0KCiAgICAgICAgaWYoICR0aGlzLT5pRW5kUm93ID4gLTEgKSB7CiAgICAgICAgICAgICR5MiA9ICRhU2NhbGUtPlRyYW5zbGF0ZVZlcnRQb3MoJHRoaXMtPmlFbmRSb3cpOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJHkyID0gJGFJbWctPmhlaWdodCAtICRhSW1nLT5ib3R0b21fbWFyZ2luOwogICAgICAgIH0KCiAgICAgICAgJHRoaXMtPmlMaW5lLT5TdHJva2UoJGFJbWcsJHgsJHkxLCR4LCR5Mik7CiAgICAgICAgJHRoaXMtPnRpdGxlLT5BbGlnbigiY2VudGVyIiwidG9wIik7CiAgICAgICAgJHRoaXMtPnRpdGxlLT5TdHJva2UoJGFJbWcsJHgsJHkyKyR0aGlzLT50aXRsZV9tYXJnaW4pOwogICAgfQp9CgovLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQovLyBDTEFTUyBMaW5rQXJyb3cKLy8gSGFuZGxlcyB0aGUgZHJhd2luZyBvZiBhIGFuIGFycm93Ci8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmNsYXNzIExpbmtBcnJvdyB7CiAgICBwcml2YXRlICRpeCwkaXk7CiAgICBwcml2YXRlICRpc2l6ZXNwZWMgPSBhcnJheSgKICAgIGFycmF5KDIsMyksYXJyYXkoMyw1KSxhcnJheSgzLDgpLGFycmF5KDYsMTUpLGFycmF5KDgsMjIpKTsKICAgIHByaXZhdGUgJGlEaXJlY3Rpb249QVJST1dfRE9XTiwkaVR5cGU9QVJST1dUX1NPTElELCRpU2l6ZT1BUlJPV19TMjsKICAgIHByaXZhdGUgJGlDb2xvcj0nYmxhY2snOwoKICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCR4LCR5LCRhRGlyZWN0aW9uLCRhVHlwZT1BUlJPV1RfU09MSUQsJGFTaXplPUFSUk9XX1MyKSB7CiAgICAgICAgJHRoaXMtPmlEaXJlY3Rpb24gPSAkYURpcmVjdGlvbjsKICAgICAgICAkdGhpcy0+aVR5cGUgPSAkYVR5cGU7CiAgICAgICAgJHRoaXMtPmlTaXplID0gJGFTaXplOwogICAgICAgICR0aGlzLT5peCA9ICR4OwogICAgICAgICR0aGlzLT5peSA9ICR5OwogICAgfQoKICAgIGZ1bmN0aW9uIFNldENvbG9yKCRhQ29sb3IpIHsKICAgICAgICAkdGhpcy0+aUNvbG9yID0gJGFDb2xvcjsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRTaXplKCRhU2l6ZSkgewogICAgICAgICR0aGlzLT5pU2l6ZSA9ICRhU2l6ZTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRUeXBlKCRhVHlwZSkgewogICAgICAgICR0aGlzLT5pVHlwZSA9ICRhVHlwZTsKICAgIH0KCiAgICBmdW5jdGlvbiBTdHJva2UoJGFJbWcpIHsKICAgICAgICBsaXN0KCRkeCwkZHkpID0gJHRoaXMtPmlzaXplc3BlY1skdGhpcy0+aVNpemVdOwogICAgICAgICR4ID0gJHRoaXMtPml4OwogICAgICAgICR5ID0gJHRoaXMtPml5OwogICAgICAgIHN3aXRjaCAoICR0aGlzLT5pRGlyZWN0aW9uICkgewogICAgICAgICAgICBjYXNlIEFSUk9XX0RPV046CiAgICAgICAgICAgICAgICAkYyA9IGFycmF5KCR4LCR5LCR4LSRkeCwkeS0kZHksJHgrJGR4LCR5LSRkeSwkeCwkeSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBBUlJPV19VUDoKICAgICAgICAgICAgICAgICRjID0gYXJyYXkoJHgsJHksJHgtJGR4LCR5KyRkeSwkeCskZHgsJHkrJGR5LCR4LCR5KTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIEFSUk9XX0xFRlQ6CiAgICAgICAgICAgICAgICAkYyA9IGFycmF5KCR4LCR5LCR4KyRkeSwkeS0kZHgsJHgrJGR5LCR5KyRkeCwkeCwkeSk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBBUlJPV19SSUdIVDoKICAgICAgICAgICAgICAgICRjID0gYXJyYXkoJHgsJHksJHgtJGR5LCR5LSRkeCwkeC0kZHksJHkrJGR4LCR4LCR5KTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoNjAzMCk7CiAgICAgICAgICAgICAgICAvLygnVW5rbm93biBhcnJvdyBkaXJlY3Rpb24gZm9yIGxpbmsuJyk7CiAgICAgICAgICAgICAgICBkaWUoKTsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICAkYUltZy0+U2V0Q29sb3IoJHRoaXMtPmlDb2xvcik7CiAgICAgICAgc3dpdGNoKCAkdGhpcy0+aVR5cGUgKSB7CiAgICAgICAgICAgIGNhc2UgQVJST1dUX1NPTElEOgogICAgICAgICAgICAgICAgJGFJbWctPkZpbGxlZFBvbHlnb24oJGMpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgQVJST1dUX09QRU46CiAgICAgICAgICAgICAgICAkYUltZy0+UG9seWdvbigkYyk7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDYwMzEpOwogICAgICAgICAgICAgICAgLy8oJ1Vua25vd24gYXJyb3cgdHlwZSBmb3IgbGluay4nKTsKICAgICAgICAgICAgICAgIGRpZSgpOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgfQp9CgovLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQovLyBDTEFTUyBHYW50dExpbmsKLy8gSGFuZGxlcyB0aGUgZHJhd2luZyBvZiBhIGxpbmsgbGluZSBiZXR3ZWVuIDIgcG9pbnRzCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CgpjbGFzcyBHYW50dExpbmsgewogICAgcHJpdmF0ZSAkaXgxLCRpeDIsJGl5MSwkaXkyOwogICAgcHJpdmF0ZSAkaVBhdGhUeXBlPTIsJGlQYXRoRXh0ZW5kPTE1OwogICAgcHJpdmF0ZSAkaUNvbG9yPSdibGFjaycsJGlXZWlnaHQ9MTsKICAgIHByaXZhdGUgJGlBcnJvd1NpemU9QVJST1dfUzIsJGlBcnJvd1R5cGU9QVJST1dUX1NPTElEOwoKICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCR4MT0wLCR5MT0wLCR4Mj0wLCR5Mj0wKSB7CiAgICAgICAgJHRoaXMtPml4MSA9ICR4MTsKICAgICAgICAkdGhpcy0+aXgyID0gJHgyOwogICAgICAgICR0aGlzLT5peTEgPSAkeTE7CiAgICAgICAgJHRoaXMtPml5MiA9ICR5MjsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRQb3MoJHgxLCR5MSwkeDIsJHkyKSB7CiAgICAgICAgJHRoaXMtPml4MSA9ICR4MTsKICAgICAgICAkdGhpcy0+aXgyID0gJHgyOwogICAgICAgICR0aGlzLT5peTEgPSAkeTE7CiAgICAgICAgJHRoaXMtPml5MiA9ICR5MjsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRQYXRoKCRhUGF0aCkgewogICAgICAgICR0aGlzLT5pUGF0aFR5cGUgPSAkYVBhdGg7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0Q29sb3IoJGFDb2xvcikgewogICAgICAgICR0aGlzLT5pQ29sb3IgPSAkYUNvbG9yOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldEFycm93KCRhU2l6ZSwkYVR5cGU9QVJST1dUX1NPTElEKSB7CiAgICAgICAgJHRoaXMtPmlBcnJvd1NpemUgPSAkYVNpemU7CiAgICAgICAgJHRoaXMtPmlBcnJvd1R5cGUgPSAkYVR5cGU7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0V2VpZ2h0KCRhV2VpZ2h0KSB7CiAgICAgICAgJHRoaXMtPmlXZWlnaHQgPSAkYVdlaWdodDsKICAgIH0KCiAgICBmdW5jdGlvbiBTdHJva2UoJGFJbWcpIHsKICAgICAgICAvLyBUaGUgd2F5IHRoZSBwYXRoIGZvciB0aGUgYXJyb3cgaXMgY29uc3RydWN0ZWQgaXMgcGFydGx5IGJhc2VkCiAgICAgICAgLy8gb24gc29tZSBoZXVyaXN0aWNzLiBUaGlzIGlzIG5vdCBhbiBleGFjdCBzY2llbmNlIGJ1dCBkcmF3cyB0aGUKICAgICAgICAvLyBwYXRoIGluIGEgd2F5IHRoYXQsIGZvciBtZSwgbWFrZXMgZXN0aGV0aWMgc2VuY2UuIEZvciBleGFtcGxlCiAgICAgICAgLy8gaWYgdGhlIHN0YXJ0IGFuZCBlbmQgYWN0aXZpdGllcyBhcmUgdmVyeSBjbG9zZSB3ZSBtYWtlIGEgc21hbGwKICAgICAgICAvLyBkZXRvdXIgdG8gZW5kdGVyIHRoZSB0YXJnZXQgaG9yaXhvbnRhbGx5LiBJZiB0aGVyZSBhcmUgbW9yZQogICAgICAgIC8vIHNwYWNlIGJldHdlZW4gYXhjdGl2aXRpZXMgdGhlbiBubyBzdWggZGV0b3VyIGlzIG1hZGUgYW5kIHRoZQogICAgICAgIC8vIHRhcmdldCBpcyAiaGl0IiBkaXJlY3RseSB2ZXJ0aWNhbC4gSSBoYXZlIHRyaWVkIHRvIGtlZXAgdGhpcwogICAgICAgIC8vIHNpbXBsZS4gbm8gZG91YnQgdGhpcyBjb3VsZCBiZWNvbWUgYWxtb3N0IGluZmluaXRpdmUgY29tcGxleAogICAgICAgIC8vIGFuZCBoYXZlIHNvbWUgcmVhbCBBSS4gRmVlbCBmcmVlIHRvIG1vZGlmeSB0aGlzLgogICAgICAgIC8vIFRoaXMgd2lsbCBuby1kb3VidCBiZSB0d2Vha2VkIGFzIHRpbWVzIGdvIGJ5LiBPbmUgZGVzaWduIGFpbQogICAgICAgIC8vIGlzIHRvIGF2b2lkIGhhdmluZyB0aGUgdXNlciBjaG9vc2Ugd2hhdCB0eXBlcyBvZiBhcnJvdwogICAgICAgIC8vIGhlIHdhbnRzLgoKICAgICAgICAvLyBUaGUgYXJyb3cgaXMgZHJhd24gYmV0d2VlbiAoeDEseTEpIHRvICh4Mix5MikKICAgICAgICAkeDEgPSAkdGhpcy0+aXgxIDsKICAgICAgICAkeDIgPSAkdGhpcy0+aXgyIDsKICAgICAgICAkeTEgPSAkdGhpcy0+aXkxIDsKICAgICAgICAkeTIgPSAkdGhpcy0+aXkyIDsKCiAgICAgICAgLy8gRGVwZW5kaW5nIG9uIGlmIHRoZSB0YXJnZXQgaXMgYmVsb3cgb3IgYWJvdmUgd2UgaGF2ZSB0bwogICAgICAgIC8vIGhhbmRsZSB0aGkgZGlmZmVyZW50LgogICAgICAgIGlmKCAkeTIgPiAkeTEgKSB7CiAgICAgICAgICAgICRhcnJvd3R5cGUgPSBBUlJPV19ET1dOOwogICAgICAgICAgICAkbWlkeSA9IHJvdW5kKCgkeTItJHkxKS8yKyR5MSk7CiAgICAgICAgICAgIGlmKCAkeDIgPiAkeDEgKSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKCAkdGhpcy0+aVBhdGhUeXBlICApIHsKICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICRjID0gYXJyYXkoJHgxLCR5MSwkeDEsJG1pZHksJHgyLCRtaWR5LCR4MiwkeTIpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICAgICAgJGMgPSBhcnJheSgkeDEsJHkxLCR4MiwkeTEsJHgyLCR5Mik7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDYwMzIsJHRoaXMtPmlQYXRoVHlwZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vKCdJbnRlcm5hbCBlcnJvcjogVW5rbm93biBwYXRoIHR5cGUgKD0nLiR0aGlzLT5pUGF0aFR5cGUgLicpIHNwZWNpZmllZCBmb3IgbGluay4nKTsKICAgICAgICAgICAgICAgICAgICAgICAgZXhpdCgxKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBzd2l0Y2ggKCAkdGhpcy0+aVBhdGhUeXBlICApIHsKICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgICAgICAgICAgICAkYyA9IGFycmF5KCR4MSwkeTEsJHgxLCRtaWR5LCR4MiwkbWlkeSwkeDIsJHkyKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgICAgICAgICAvLyBBbHdheXMgZXh0ZW5kIG91dCBob3Jpem9udGFsbHkgYSBiaXQgZnJvbSB0aGUgZmlyc3QgcG9pbnQKICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgd2UgZHJhdyBhIGxpbmsgYmFjayBpbiB0aW1lIChlbmQgdG8gc3RhcnQpIGFuZCB0aGUgYmFycwogICAgICAgICAgICAgICAgICAgICAgICAvLyBhcmUgdmVyeSBjbG9zZSB3ZSBhbHNvIGNoYW5nZSB0aGUgcGF0aCBzbyBpdCBjb21lcyBpbiBmcm9tCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRoZSBsZWZ0IG9uIHRoZSBhY3Rpdml0eQogICAgICAgICAgICAgICAgICAgICAgICAkYyA9IGFycmF5KCR4MSwkeTEsJHgxKyR0aGlzLT5pUGF0aEV4dGVuZCwkeTEsCiAgICAgICAgICAgICAgICAgICAgICAgICR4MSskdGhpcy0+aVBhdGhFeHRlbmQsJG1pZHksCiAgICAgICAgICAgICAgICAgICAgICAgICR4MiwkbWlkeSwkeDIsJHkyKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICBpZiggJHkyLSRtaWR5IDwgNiApIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjID0gYXJyYXkoJHgxLCR5MSwkeDEsJG1pZHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkeDItJHRoaXMtPmlQYXRoRXh0ZW5kLCRtaWR5LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHgyLSR0aGlzLT5pUGF0aEV4dGVuZCwkeTIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkeDIsJHkyKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRhcnJvd3R5cGUgPSBBUlJPV19SSUdIVDsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjID0gYXJyYXkoJHgxLCR5MSwkeDEsJG1pZHksJHgyLCRtaWR5LCR4MiwkeTIpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDYwMzIsJHRoaXMtPmlQYXRoVHlwZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vKCdJbnRlcm5hbCBlcnJvcjogVW5rbm93biBwYXRoIHR5cGUgc3BlY2lmaWVkIGZvciBsaW5rLicpOwogICAgICAgICAgICAgICAgICAgICAgICBleGl0KDEpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAkYXJyb3cgPSBuZXcgTGlua0Fycm93KCR4MiwkeTIsJGFycm93dHlwZSk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAvLyBZMiA8IFkxCiAgICAgICAgICAgICRhcnJvd3R5cGUgPSBBUlJPV19VUDsKICAgICAgICAgICAgJG1pZHkgPSByb3VuZCgoJHkxLSR5MikvMiskeTIpOwogICAgICAgICAgICBpZiggJHgyID4gJHgxICkgewogICAgICAgICAgICAgICAgc3dpdGNoICggJHRoaXMtPmlQYXRoVHlwZSAgKSB7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgICAgJGMgPSBhcnJheSgkeDEsJHkxLCR4MSwkbWlkeSwkeDIsJG1pZHksJHgyLCR5Mik7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgICAgICAgICAgaWYoICRtaWR5LSR5MiA8IDggKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYXJyb3d0eXBlID0gQVJST1dfUklHSFQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYyA9IGFycmF5KCR4MSwkeTEsJHgxLCR5MiwkeDIsJHkyKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRjID0gYXJyYXkoJHgxLCR5MSwkeDEsJG1pZHksJHgyLCRtaWR5LCR4MiwkeTIpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDYwMzIsJHRoaXMtPmlQYXRoVHlwZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vKCdJbnRlcm5hbCBlcnJvcjogVW5rbm93biBwYXRoIHR5cGUgc3BlY2lmaWVkIGZvciBsaW5rLicpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgIHN3aXRjaCAoICR0aGlzLT5pUGF0aFR5cGUgICkgewogICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICBjYXNlIDE6CiAgICAgICAgICAgICAgICAgICAgICAgICRjID0gYXJyYXkoJHgxLCR5MSwkeDEsJG1pZHksJHgyLCRtaWR5LCR4MiwkeTIpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFsd2F5cyBleHRlbmQgb3V0IGhvcml6b250YWxseSBhIGJpdCBmcm9tIHRoZSBmaXJzdCBwb2ludAogICAgICAgICAgICAgICAgICAgICAgICAkYyA9IGFycmF5KCR4MSwkeTEsJHgxKyR0aGlzLT5pUGF0aEV4dGVuZCwkeTEsCiAgICAgICAgICAgICAgICAgICAgICAgICR4MSskdGhpcy0+aVBhdGhFeHRlbmQsJG1pZHksCiAgICAgICAgICAgICAgICAgICAgICAgICR4MiwkbWlkeSwkeDIsJHkyKTsKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgICAgICAgICBpZiggJG1pZHktJHkyIDwgMTYgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYXJyb3d0eXBlID0gQVJST1dfUklHSFQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYyA9IGFycmF5KCR4MSwkeTEsJHgxLCRtaWR5LCR4Mi0kdGhpcy0+aVBhdGhFeHRlbmQsJG1pZHksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkeDItJHRoaXMtPmlQYXRoRXh0ZW5kLCR5MiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICR4MiwkeTIpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJGMgPSBhcnJheSgkeDEsJHkxLCR4MSwkbWlkeSwkeDIsJG1pZHksJHgyLCR5Mik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoNjAzMiwkdGhpcy0+aVBhdGhUeXBlKTsKICAgICAgICAgICAgICAgICAgICAgICAgLy8oJ0ludGVybmFsIGVycm9yOiBVbmtub3duIHBhdGggdHlwZSBzcGVjaWZpZWQgZm9yIGxpbmsuJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgICRhcnJvdyA9IG5ldyBMaW5rQXJyb3coJHgyLCR5MiwkYXJyb3d0eXBlKTsKICAgICAgICB9CiAgICAgICAgJGFJbWctPlNldENvbG9yKCR0aGlzLT5pQ29sb3IpOwogICAgICAgICRhSW1nLT5TZXRMaW5lV2VpZ2h0KCR0aGlzLT5pV2VpZ2h0KTsKICAgICAgICAkYUltZy0+UG9seWdvbigkYyk7CiAgICAgICAgJGFJbWctPlNldExpbmVXZWlnaHQoMSk7CiAgICAgICAgJGFycm93LT5TZXRDb2xvcigkdGhpcy0+aUNvbG9yKTsKICAgICAgICAkYXJyb3ctPlNldFNpemUoJHRoaXMtPmlBcnJvd1NpemUpOwogICAgICAgICRhcnJvdy0+U2V0VHlwZSgkdGhpcy0+aUFycm93VHlwZSk7CiAgICAgICAgJGFycm93LT5TdHJva2UoJGFJbWcpOwogICAgfQp9CgovLyA8RU9GPgo\/Pgo=",
    "size": "160481"
}