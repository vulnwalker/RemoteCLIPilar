{
    "namaFile": "js\/persediaan\/closingPersediaan\/closingPersediaan.js",
    "lastUpdate": "2018-09-28+13:21:48.52",
    "contentFile": "dmFyIGNsb3NpbmdQZXJzZWRpYWFuRmlsdGVyU0tQRCA9IG5ldyBTa3BkQ2xzKHsKICAgIHByZWZpeDogImNsb3NpbmdQZXJzZWRpYWFuIiwKICAgIGZvcm1OYW1lOiAiY2xvc2luZ1BlcnNlZGlhYW5Gb3JtIiwKICAgIHBpbGloVXJ1c2FuZnRlcjogZnVuY3Rpb24gKCkgewogICAgICAgIGNsb3NpbmdQZXJzZWRpYWFuLmZpbHRlclJlbmRlcih0cnVlKTsKICAgIH0sCiAgICBwaWxpaEJpZGFuZ0FmdGVyOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgY2xvc2luZ1BlcnNlZGlhYW4uZmlsdGVyUmVuZGVyKHRydWUpOwogICAgfSwKICAgIHBpbGloVW5pdEFmdGVyOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgY2xvc2luZ1BlcnNlZGlhYW4uZmlsdGVyUmVuZGVyKHRydWUpOwogICAgfSwKICAgIHBpbGloU3ViVW5pdEFmdGVyOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgY2xvc2luZ1BlcnNlZGlhYW4uZmlsdGVyUmVuZGVyKHRydWUpOwogICAgfSwKICAgIHBpbGloU2Vrc2lBZnRlcjogZnVuY3Rpb24gKCkgewogICAgICAgIGNsb3NpbmdQZXJzZWRpYWFuLmZpbHRlclJlbmRlcih0cnVlKTsKICAgIH0KfSk7CnZhciBjbG9zaW5nUGVyc2VkaWFhbiA9IG5ldyBEYWZ0YXJPYmoyKHsKICAgIHByZWZpeDogImNsb3NpbmdQZXJzZWRpYWFuIiwKICAgIHVybDogInBnUGVyc2VkaWFhbi5waHA\/UGc9Y2xvc2luZ1BlcnNlZGlhYW4iLAogICAgZm9ybU5hbWU6ICJjbG9zaW5nUGVyc2VkaWFhbkZvcm0iLAogICAgY2xvc2luZ1BlcnNlZGlhYW5fZm9ybTogIjAiLCAvL2RlZmF1bHQganMgY2xvc2luZ1BlcnNlZGlhYW4KICAgIGxvYWRpbmc6IGZ1bmN0aW9uICgpIHsKICAgICAgICAvL2FsZXJ0KCdsb2FkaW5nJyk7CiAgICAgICAgdGhpcy50b3BCYXJSZW5kZXIoKTsKICAgICAgICB0aGlzLmZpbHRlclJlbmRlcigpOwogICAgICAgIHRoaXMuZGFmdGFyUmVuZGVyKCk7CiAgICAgICAgdGhpcy5zdW1IYWxSZW5kZXIoKTsKICAgIH0sCiAgICBmaWx0ZXJSZW5kZXJBZnRlcjogZnVuY3Rpb24gKCkgewogICAgICAgIC8vIHRoaXMuZGFmdGFyUmVuZGVyKCk7CiAgICB9LAogICAgZHVtbXlQb3N0OiBmdW5jdGlvbiAoKSB7CiAgICAgICQuYWpheCh7CiAgICAgICAgICB1cmw6IHRoaXMudXJsICsgIiZ0aXBlPXByb3Nlc0NvdW50QW5kQ2xvc2luZyIsCiAgICAgICAgICB0eXBlOiAiUE9TVCIsCiAgICAgICAgICBkYXRhOiB7CiAgICAgICAgICAgIGZpbHRlclBlcmlvZGUgOiAyLAogICAgICAgICAgICBqdW1sYWhEYXRhIDogMzQwLAogICAgICAgICAgICBrZXRlcmFuZ2FuIDogInd3ZXd3ZSIsCiAgICAgICAgICAgIGtvZGVDbG9zaW5nOiIxLjAxLjAxLjAxLjAwMTswOC4wMS4wMy4wMi4wMDEuMDAwMSIsCiAgICAgICAgICAgIG5vbW9yUG9zdCA6IDAsCiAgICAgICAgICAgIHRvdGFsQmFyYW5nIDogMzQwLAogICAgICAgICAgfSwKICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgdmFyIHJlc3AgPSBldmFsKCIoIiArIGRhdGEgKyAiKSIpOwogICAgICAgICAgICAgIGFsZXJ0KHJlc3AuY29udGVudC5pZFBlbmdlbHVhcmFuRGlzdHJpYnVzaSk7CiAgICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHByb2dyYW1DaGFuZ2VkOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGFycmF5UCA9ICQoIiNwIikKICAgICAgICAgICAgLnZhbCgpCiAgICAgICAgICAgIC5zcGxpdCgiLiIpOwogICAgICAgIHZhciBiayA9IGFycmF5UFswXTsKICAgICAgICB2YXIgY2sgPSBhcnJheVBbMV07CiAgICAgICAgdmFyIGhpZGRlblAgPSBhcnJheVBbMl07CgogICAgICAgICQoIiNiayIpLnZhbChiayk7CiAgICAgICAgJCgiI2NrIikudmFsKGNrKTsKICAgICAgICAkKCIjaGlkZGVuUCIpLnZhbChoaWRkZW5QKTsKICAgICAgICAkKCIjcSIpLnZhbCgiIik7CiAgICAgICAgY2xvc2luZ1BlcnNlZGlhYW4ucmVmcmVzaExpc3QodHJ1ZSk7CiAgICB9LAogICAgZGV0YWlsOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgLy9hbGVydCgnZGV0YWlsJyk7CiAgICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgICBlcnJtc2cgPSB0aGlzLkNla0NoZWNrYm94KCk7CiAgICAgICAgaWYgKGVycm1zZyA9PSAiIikgewogICAgICAgICAgICB2YXIgYm94ID0gdGhpcy5HZXRDYnhDaGVja2VkKCk7CiAgICAgICAgICAgIC8vVXNlckFrdGl2aXRhc0RldC5nZW5EZXRhaWwoKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhbGVydChlcnJtc2cpOwogICAgICAgIH0KICAgIH0sCiAgICBwaWxpaEJpZGFuZzogZnVuY3Rpb24gKCkgewogICAgICAgIGNsb3NpbmdQZXJzZWRpYWFuLnJlZnJlc2hMaXN0KHRydWUpOwogICAgfSwKICAgIEJpZGFuZ0FmdGVyMjogZnVuY3Rpb24gKCkgewogICAgICAgIGNsb3NpbmdQZXJzZWRpYWFuLnJlZnJlc2hMaXN0KHRydWUpOwogICAgfSwKICAgIGNvbWJvU0tQRENoYW5nZWQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICBjbG9zaW5nUGVyc2VkaWFhbi5yZWZyZXNoTGlzdCh0cnVlKTsKICAgIH0sCiAgICBDYXJpTW9kdWw6IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgbWUgPSB0aGlzOwoKICAgICAgICBwb3B1cE1vZHVsLmVsX25hbWFNb2R1bCA9ICJuYW1hTW9kdWwiOwogICAgICAgIHBvcHVwTW9kdWwuZWxfaWRNb2R1bCA9ICJpZE1vZHVsIjsKICAgICAgICAvKgkJUmVmQmFyYW5nQnV0dWguZWxfbmFtYV9iYXJhbmc9ICduYW1hX2JhcmFuZyc7CQkqLwogICAgICAgIHBvcHVwTW9kdWwud2luZG93U2F2ZUFmdGVyID0gZnVuY3Rpb24gKCkgeyB9OwogICAgICAgIHBvcHVwTW9kdWwud2luZG93U2hvdygpOwogICAgfSwKCiAgICBoaXN0b3JpOiBmdW5jdGlvbiAoaWQpIHsKICAgICAgICB2YXIgbWUgPSB0aGlzOwoKICAgICAgICBwb3B1cEhpc3RvcmkuZWxfbmFtYUhpc3RvcmkgPSAibmFtYUhpc3RvcmkiOwogICAgICAgIHBvcHVwSGlzdG9yaS5lbF9pZEhpc3RvcmkgPSAiaWRIaXN0b3JpIjsKICAgICAgICBwb3B1cEhpc3Rvcmkud2luZG93U2F2ZUFmdGVyID0gZnVuY3Rpb24gKCkgeyB9OwogICAgICAgIHBvcHVwSGlzdG9yaS53aW5kb3dTaG93KGlkKTsKICAgIH0sCiAgICBkYWZ0YXJSZW5kZXI6IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgbWUgPSB0aGlzOyAvL3JlbmRlciBkYWZ0YXIKICAgICAgICBhZGRDb3ZlclBhZ2UyKCJkYWZ0YXJfY292ZXIiLCAxLCB0cnVlLCB0cnVlLCB7CiAgICAgICAgICAgIHJlbmRlclRvOiB0aGlzLnByZWZpeCArICJfY29udF9kYWZ0YXIiLAogICAgICAgICAgICBpbWdzcmM6ICJpbWFnZXMvd2FpdC5naWYiLAogICAgICAgICAgICBzdHlsZTogeyBwb3NpdGlvbjogImFic29sdXRlIiwgdG9wOiAiNSIsIGxlZnQ6ICI1IiB9CiAgICAgICAgfSk7CgogICAgICAgICQuYWpheCh7CiAgICAgICAgICAgIHVybDogdGhpcy51cmwgKyAiJnRpcGU9ZGFmdGFyIiwKICAgICAgICAgICAgdHlwZTogIlBPU1QiLAogICAgICAgICAgICBkYXRhOiAkKCIjIiArIHRoaXMuZm9ybU5hbWUpLnNlcmlhbGl6ZSgpLAogICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgdmFyIHJlc3AgPSBldmFsKCIoIiArIGRhdGEgKyAiKSIpOwogICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobWUucHJlZml4ICsgIl9jb250X2RhZnRhciIpLmlubmVySFRNTCA9CiAgICAgICAgICAgICAgICAgICAgcmVzcC5jb250ZW50OwoKICAgICAgICAgICAgICAgIG1lLnN1bUhhbFJlbmRlcigpOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9LAogICAgQmFydVRURDogZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBtZSA9IHRoaXM7CiAgICAgICAgdmFyIGVyciA9ICIiOwogICAgICAgIHZhciB1cnVzYW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZmlsdGVyVXJ1c2FuIikudmFsdWU7CiAgICAgICAgdmFyIGJpZGFuZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmaWx0ZXJCaWRhbmciKS52YWx1ZTsKICAgICAgICB2YXIgc2twZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmaWx0ZXJTS1BEIikudmFsdWU7CiAgICAgICAgdmFyIHVuaXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZmlsdGVyVW5pdCIpLnZhbHVlOwogICAgICAgIHZhciBzdWJ1bml0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZpbHRlclN1YlVuaXQiKS52YWx1ZTsKCiAgICAgICAgdmFyIGNvdmVyID0gdGhpcy5wcmVmaXggKyAiX2Zvcm1jb3ZlciI7CiAgICAgICAgaWYgKGVyciA9PSAiIikgewogICAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gImhpZGRlbiI7CiAgICAgICAgICAgIGFkZENvdmVyUGFnZTIoY292ZXIsIDk5OSwgdHJ1ZSwgZmFsc2UpOwogICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgdHlwZTogIlBPU1QiLAogICAgICAgICAgICAgICAgZGF0YToKICAgICAgICAgICAgICAgICAgICAkKCIjIiArIHRoaXMuZm9ybU5hbWUpLnNlcmlhbGl6ZSgpICsKICAgICAgICAgICAgICAgICAgICAiJnVydXNhbj0iICsKICAgICAgICAgICAgICAgICAgICB1cnVzYW4gKwogICAgICAgICAgICAgICAgICAgICImYmlkYW5nPSIgKwogICAgICAgICAgICAgICAgICAgIGJpZGFuZyArCiAgICAgICAgICAgICAgICAgICAgIiZza3BkPSIgKwogICAgICAgICAgICAgICAgICAgIHNrcGQgKwogICAgICAgICAgICAgICAgICAgICImdW5pdD0iICsKICAgICAgICAgICAgICAgICAgICB1bml0ICsKICAgICAgICAgICAgICAgICAgICAiJnN1YnVuaXQ9IiArCiAgICAgICAgICAgICAgICAgICAgc3VidW5pdCwKICAgICAgICAgICAgICAgIHVybDogdGhpcy51cmwgKyAiJnRpcGU9Zm9ybUJhcnVUVEQiLAogICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICBkZWxFbGVtKGNvdmVyKTsKICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcCA9IGV2YWwoIigiICsgZGF0YSArICIpIik7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3AuZXJyID09ICIiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvdmVyKS5pbm5lckhUTUwgPSByZXNwLmNvbnRlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgIG1lLkFmdGVyRm9ybUJhcnUocmVzcCk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQocmVzcC5lcnIpOwoKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICJhdXRvIjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGFsZXJ0KGVycik7CiAgICAgICAgfQogICAgfSwKICAgIHBpbGloUGFuZ2thdDogZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBtZSA9IHRoaXM7CiAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgdXJsOiB0aGlzLnVybCArICImdGlwZT1waWxpaFBhbmdrYXQiLAogICAgICAgICAgICB0eXBlOiAiUE9TVCIsCiAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICAgIGMxOiAkKCIjZmlsdGVyVXJ1c2FuIikudmFsKCksCiAgICAgICAgICAgICAgICBjOiAkKCIjZmlsdGVyQmlkYW5nIikudmFsKCksCiAgICAgICAgICAgICAgICBkOiAkKCIjZmlsdGVyU0tQRCIpLnZhbCgpLAogICAgICAgICAgICAgICAgZTogJCgiI2ZpbHRlclVuaXQiKS52YWwoKSwKICAgICAgICAgICAgICAgIGUxOiAkKCIjZmlsdGVyU3ViVW5pdCIpLnZhbCgpLAogICAgICAgICAgICAgICAgZGMxOiAkKCIjZGMxIikudmFsKCksCiAgICAgICAgICAgICAgICBkYzogJCgiI2RjIikudmFsKCksCiAgICAgICAgICAgICAgICBkZDogJCgiI2RkIikudmFsKCksCiAgICAgICAgICAgICAgICBrYXRlZ29yaTogJCgiI2thdGVnb3JpIikudmFsKCksCiAgICAgICAgICAgICAgICBuYW1hcGVnYXdhaTogJCgiI25hbWFwZWdhd2FpIikudmFsKCksCiAgICAgICAgICAgICAgICBuaXBwZWdhd2FpOiAkKCIjbmlwcGVnYXdhaSIpLnZhbCgpLAogICAgICAgICAgICAgICAgcGFuZ2thdGFraGlyOiAkKCIjcGFuZ2thdGFraGlyIikudmFsKCksCiAgICAgICAgICAgICAgICBnb2xhbmdfYWtoaXI6ICQoIiNnb2xhbmdfYWtoaXIiKS52YWwoKSwKICAgICAgICAgICAgICAgIGphYmF0YW46ICQoIiNqYWJhdGFuIikudmFsKCksCiAgICAgICAgICAgICAgICBlc2Vsb25fYWtoaXI6ICQoIiNlc2Vsb25fYWtoaXIiKS52YWwoKQogICAgICAgICAgICB9LAogICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgdmFyIHJlc3AgPSBldmFsKCIoIiArIGRhdGEgKyAiKSIpOwoKICAgICAgICAgICAgICAgIGlmIChyZXNwLmVyciA9PSAiIikgewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJnb2xhbmdfYWtoaXIiKS52YWx1ZSA9IHJlc3AuY29udGVudDsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgYWxlcnQocmVzcC5lcnIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9LAogICAgQmFydTogZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBtZSA9IHRoaXM7CiAgICAgICAgaWYgKCQoIiNmaWx0ZXJVcnVzYW4iKS52YWwoKSA9PSAiMDAiKSB7CiAgICAgICAgICAgIGFsZXJ0KCJQaWxpaCBVcnVzYW4iKTsKICAgICAgICB9IGVsc2UgaWYgKCQoIiNmaWx0ZXJCaWRhbmciKS52YWwoKSA9PSAiMDAiKSB7CiAgICAgICAgICAgIGFsZXJ0KCJQaWxpaCBCaWRhbmciKTsKICAgICAgICB9IGVsc2UgaWYgKCQoIiNmaWx0ZXJTS1BEIikudmFsKCkgPT0gIjAwIikgewogICAgICAgICAgICBhbGVydCgiUGlsaWggU0tQRCIpOwogICAgICAgIH0gZWxzZSBpZiAoJCgiI2ZpbHRlclVuaXQiKS52YWwoKSA9PSAiMDAiKSB7CiAgICAgICAgICAgIGFsZXJ0KCJQaWxpaCBVbml0Iik7CiAgICAgICAgfSBlbHNlIGlmICgkKCIjZmlsdGVyU3ViVW5pdCIpLnZhbCgpID09ICIwMDAiKSB7CiAgICAgICAgICAgIGFsZXJ0KCJQaWxpaCBTdWIgVW5pdCIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHZhciBjb3ZlciA9IHRoaXMucHJlZml4ICsgIl9mb3JtY292ZXIiOwogICAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gImhpZGRlbiI7CiAgICAgICAgICAgIGFkZENvdmVyUGFnZTIoY292ZXIsIDEsIHRydWUsIGZhbHNlKTsKICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgIHR5cGU6ICJQT1NUIiwKICAgICAgICAgICAgICAgIGRhdGE6ICQoIiMiICsgdGhpcy5mb3JtTmFtZSkuc2VyaWFsaXplKCksCiAgICAgICAgICAgICAgICB1cmw6IHRoaXMudXJsICsgIiZ0aXBlPUJhcnUiLAogICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcCA9IGV2YWwoIigiICsgZGF0YSArICIpIik7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY292ZXIpLmlubmVySFRNTCA9IHJlc3AuY29udGVudDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgfSwKICAgIEhhcHVzOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5wcmVmaXggKyAiX2ptbGNlayIpKSB7CiAgICAgICAgICAgIHZhciBqbWxjZWsgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLnByZWZpeCArICJfam1sY2VrIikudmFsdWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdmFyIGptbGNlayA9ICIiOwogICAgICAgIH0KCiAgICAgICAgaWYgKGptbGNlayA9PSAwKSB7CiAgICAgICAgICAgIGFsZXJ0KCJEYXRhIEJlbHVtIERpcGlsaWghIik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKGNvbmZpcm0oIllha2luIEhhcHVzICIgKyBqbWxjZWsgKyAiIERhdGEgPyIpKSB7CiAgICAgICAgICAgICAgICB2YXIgY292ZXIgPSB0aGlzLnByZWZpeCArICJfaGFwdXNjb3ZlciI7CiAgICAgICAgICAgICAgICBhZGRDb3ZlclBhZ2UyKGNvdmVyLCAxLCB0cnVlLCBmYWxzZSk7CiAgICAgICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJQT1NUIiwKICAgICAgICAgICAgICAgICAgICBkYXRhOiAkKCIjIiArIHRoaXMuZm9ybU5hbWUpLnNlcmlhbGl6ZSgpLAogICAgICAgICAgICAgICAgICAgIHVybDogdGhpcy51cmwgKyAiJnRpcGU9aGFwdXMiLAogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwID0gZXZhbCgiKCIgKyBkYXRhICsgIikiKTsKICAgICAgICAgICAgICAgICAgICAgICAgZGVsRWxlbShjb3Zlcik7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwLmVyciA9PSAiIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUuQWZ0ZXJIYXB1cygpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQocmVzcC5lcnIpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgICAgICBlcnJvcjogYWpheEVycm9yCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0sCiAgICBSZW1vdmU6IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgbWUgPSB0aGlzOwogICAgICAgIGVycm1zZyA9IHRoaXMuQ2VrQ2hlY2tib3goKTsKICAgICAgICBpZiAoJCgiI2NtYlVydXNhbiIpLnZhbCgpID09ICIiKSB7CiAgICAgICAgICAgIGFsZXJ0KCJQaWxpaCBVcnVzYW4iKTsKICAgICAgICB9IGVsc2UgaWYgKCQoIiNjbWJCaWRhbmciKS52YWwoKSA9PSAiIikgewogICAgICAgICAgICBhbGVydCgiUGlsaWggQmlkYW5nIik7CiAgICAgICAgfSBlbHNlIGlmICgkKCIjY21iU0tQRCIpLnZhbCgpID09ICIiKSB7CiAgICAgICAgICAgIGFsZXJ0KCJQaWxpaCBTS1BEIik7CiAgICAgICAgfSBlbHNlIGlmICgkKCIjY21iVW5pdCIpLnZhbCgpID09ICIiKSB7CiAgICAgICAgICAgIGFsZXJ0KCJQaWxpaCBVbml0Iik7CiAgICAgICAgfSBlbHNlIGlmICgkKCIjY21iU3ViVW5pdCIpLnZhbCgpID09ICIiKSB7CiAgICAgICAgICAgIGFsZXJ0KCJQaWxpaCBTdWIgVW5pdCIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChlcnJtc2cgPT0gIiIpIHsKICAgICAgICAgICAgICAgIHZhciBib3ggPSB0aGlzLkdldENieENoZWNrZWQoKTsKICAgICAgICAgICAgICAgIHZhciBza3BkID0KICAgICAgICAgICAgICAgICAgICAkKCIjY21iVXJ1c2FuIikudmFsKCkgKwogICAgICAgICAgICAgICAgICAgICIuIiArCiAgICAgICAgICAgICAgICAgICAgJCgiI2NtYkJpZGFuZyIpLnZhbCgpICsKICAgICAgICAgICAgICAgICAgICAiLiIgKwogICAgICAgICAgICAgICAgICAgICQoIiNjbWJTS1BEIikudmFsKCkgKwogICAgICAgICAgICAgICAgICAgICIuIiArCiAgICAgICAgICAgICAgICAgICAgJCgiI2NtYlVuaXQiKS52YWwoKSArCiAgICAgICAgICAgICAgICAgICAgIi4iICsKICAgICAgICAgICAgICAgICAgICAkKCIjY21iU3ViVW5pdCIpLnZhbCgpOwoKICAgICAgICAgICAgICAgICQuYWpheCh7CiAgICAgICAgICAgICAgICAgICAgdXJsOiB0aGlzLnVybCArICImdGlwZT1SZW1vdmUiLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJQT1NUIiwKICAgICAgICAgICAgICAgICAgICBkYXRhOiAkKCIjIiArIHRoaXMuZm9ybU5hbWUpLnNlcmlhbGl6ZSgpLAogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwID0gZXZhbCgiKCIgKyBkYXRhICsgIikiKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3AuZXJyID09ICIiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9zaW5nUGVyc2VkaWFhbi5yZWZyZXNoTGlzdCh0cnVlKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KHJlc3AuZXJyKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgYWxlcnQoZXJybXNnKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0sCiAgICBmb3JtYXRDdXJyZW5jeTogZnVuY3Rpb24gKG51bSkgewogICAgICAgIG51bSA9IG51bS50b1N0cmluZygpLnJlcGxhY2UoL1wkfFwsL2csICIiKTsKICAgICAgICBpZiAoaXNOYU4obnVtKSkgbnVtID0gIjAiOwogICAgICAgIHNpZ24gPSBudW0gPT0gKG51bSA9IE1hdGguYWJzKG51bSkpOwogICAgICAgIG51bSA9IE1hdGguZmxvb3IobnVtICogMTAwICsgMC41MDAwMDAwMDAwMSk7CiAgICAgICAgY2VudHMgPSBudW0gJSAxMDA7CiAgICAgICAgbnVtID0gTWF0aC5mbG9vcihudW0gLyAxMDApLnRvU3RyaW5nKCk7CiAgICAgICAgaWYgKGNlbnRzIDwgMTApIGNlbnRzID0gIjAiICsgY2VudHM7CiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBNYXRoLmZsb29yKChudW0ubGVuZ3RoIC0gKDEgKyBpKSkgLyAzKTsgaSsrKQogICAgICAgICAgICBudW0gPQogICAgICAgICAgICAgICAgbnVtLnN1YnN0cmluZygwLCBudW0ubGVuZ3RoIC0gKDQgKiBpICsgMykpICsKICAgICAgICAgICAgICAgICIuIiArCiAgICAgICAgICAgICAgICBudW0uc3Vic3RyaW5nKG51bS5sZW5ndGggLSAoNCAqIGkgKyAzKSk7CiAgICAgICAgcmV0dXJuIChzaWduID8gIiIgOiAiLSIpICsgIiIgKyBudW0gKyAiLCIgKyBjZW50czsKICAgIH0sCiAgICBmb3JtYXRDdXJyZW5jeTI6IGZ1bmN0aW9uIChudW0pIHsKICAgICAgICBudW0gPSBudW0udG9TdHJpbmcoKS5yZXBsYWNlKC9cJHxcLC9nLCAiIik7CiAgICAgICAgaWYgKGlzTmFOKG51bSkpIG51bSA9ICIwIjsKICAgICAgICBzaWduID0gbnVtID09IChudW0gPSBNYXRoLmFicyhudW0pKTsKICAgICAgICBudW0gPSBNYXRoLmZsb29yKG51bSAqIDEwMCArIDAuNTAwMDAwMDAwMDEpOwogICAgICAgIGNlbnRzID0gbnVtICUgMTAwOwogICAgICAgIG51bSA9IE1hdGguZmxvb3IobnVtIC8gMTAwKS50b1N0cmluZygpOwogICAgICAgIGlmIChjZW50cyA8IDEwKSBjZW50cyA9ICIwIiArIGNlbnRzOwogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgTWF0aC5mbG9vcigobnVtLmxlbmd0aCAtICgxICsgaSkpIC8gMyk7IGkrKykKICAgICAgICAgICAgbnVtID0KICAgICAgICAgICAgICAgIG51bS5zdWJzdHJpbmcoMCwgbnVtLmxlbmd0aCAtICg0ICogaSArIDMpKSArCiAgICAgICAgICAgICAgICAiLiIgKwogICAgICAgICAgICAgICAgbnVtLnN1YnN0cmluZyhudW0ubGVuZ3RoIC0gKDQgKiBpICsgMykpOwogICAgICAgIHJldHVybiAoc2lnbiA\/ICIiIDogIi0iKSArICIiICsgbnVtOwogICAgfSwKICAgIFNpbXBhblRURDogZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBtZSA9IHRoaXM7CiAgICAgICAgdGhpcy5PbkVycm9yQ2xvc2UgPSBmYWxzZTsKICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gImhpZGRlbiI7CiAgICAgICAgdmFyIGNvdmVyID0gdGhpcy5wcmVmaXggKyAiX2Zvcm1zaW1wYW4iOwogICAgICAgIGFkZENvdmVyUGFnZTIoY292ZXIsIDEsIHRydWUsIGZhbHNlKTsKICAgICAgICAkLmFqYXgoewogICAgICAgICAgICB0eXBlOiAiUE9TVCIsCiAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICAgIGplbmlzS2VnaWF0YW46ICQoIiNqZW5pc0tlZ2lhdGFuIikudmFsKCksCiAgICAgICAgICAgICAgICBjZXRha2phbmc6ICQoIiNjZXRha2phbmciKS52YWwoKSwKICAgICAgICAgICAgICAgIHR0ZDogJCgiI3R0ZCIpLnZhbCgpLAogICAgICAgICAgICAgICAgYzE6ICQoIiNmaWx0ZXJVcnVzYW4iKS52YWwoKSwKICAgICAgICAgICAgICAgIGM6ICQoIiNmaWx0ZXJCaWRhbmciKS52YWwoKSwKICAgICAgICAgICAgICAgIGQ6ICQoIiNmaWx0ZXJTS1BEIikudmFsKCksCiAgICAgICAgICAgICAgICBlOiAkKCIjZmlsdGVyVW5pdCIpLnZhbCgpLAogICAgICAgICAgICAgICAgZTE6ICQoIiNmaWx0ZXJTdWJVbml0IikudmFsKCksCiAgICAgICAgICAgICAgICBkYzE6ICQoIiNkYzEiKS52YWwoKSwKICAgICAgICAgICAgICAgIGRjOiAkKCIjZGMiKS52YWwoKSwKICAgICAgICAgICAgICAgIGRkOiAkKCIjZGQiKS52YWwoKSwKICAgICAgICAgICAgICAgIGthdGVnb3JpOiAkKCIja2F0ZWdvcmkiKS52YWwoKSwKICAgICAgICAgICAgICAgIG5hbWFwZWdhd2FpOiAkKCIjbmFtYXBlZ2F3YWkiKS52YWwoKSwKICAgICAgICAgICAgICAgIG5pcHBlZ2F3YWk6ICQoIiNuaXBwZWdhd2FpIikudmFsKCksCiAgICAgICAgICAgICAgICBwYW5na2F0YWtoaXI6ICQoIiNwYW5na2F0YWtoaXIiKS52YWwoKSwKICAgICAgICAgICAgICAgIGdvbGFuZ19ha2hpcjogJCgiI2dvbGFuZ19ha2hpciIpLnZhbCgpLAogICAgICAgICAgICAgICAgamFiYXRhbjogJCgiI2phYmF0YW4iKS52YWwoKSwKICAgICAgICAgICAgICAgIGVzZWxvbl9ha2hpcjogJCgiI2VzZWxvbl9ha2hpciIpLnZhbCgpCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHVybDogdGhpcy51cmwgKyAiJnRpcGU9c2ltcGFuVFREIiwKICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgIHZhciByZXNwID0gZXZhbCgiKCIgKyBkYXRhICsgIikiKTsKICAgICAgICAgICAgICAgIGRlbEVsZW0oY292ZXIpOwogICAgICAgICAgICAgICAgLy9kb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb3ZlcikuaW5uZXJIVE1MID0gcmVzcC5jb250ZW50OwogICAgICAgICAgICAgICAgaWYgKHJlc3AuZXJyID09ICIiKSB7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInR0ZCIpLmlubmVySFRNTCA9IHJlc3AuY29udGVudC5jb21ib3R0ZDsKICAgICAgICAgICAgICAgICAgICBjbG9zaW5nUGVyc2VkaWFhbi5DbG9zZSgpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBhbGVydChyZXNwLmVycik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sCgogICAgc2F2ZUNsb3Npbmc6IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgbWUgPSB0aGlzOwogICAgICAgIHRoaXMuT25FcnJvckNsb3NlID0gZmFsc2U7CiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICJoaWRkZW4iOwogICAgICAgIHZhciBjb3ZlciA9IHRoaXMucHJlZml4ICsgIl9mb3Jtc2ltcGFuIjsKICAgICAgICBhZGRDb3ZlclBhZ2UyKGNvdmVyLCAxLCB0cnVlLCBmYWxzZSk7CiAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgdHlwZTogIlBPU1QiLAogICAgICAgICAgICBkYXRhOiAkKCIjIiArIHRoaXMucHJlZml4ICsgIl9mb3JtIikuc2VyaWFsaXplKCksCiAgICAgICAgICAgIHVybDogdGhpcy51cmwgKyAiJnRpcGU9c2F2ZUNsb3NpbmciLAogICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgdmFyIHJlc3AgPSBldmFsKCIoIiArIGRhdGEgKyAiKSIpOwogICAgICAgICAgICAgICAgZGVsRWxlbShjb3Zlcik7CiAgICAgICAgICAgICAgICBpZiAocmVzcC5lcnIgPT0gIiIpIHsKICAgICAgICAgICAgICAgICAgICBtZS5DbG9zZSgpOwogICAgICAgICAgICAgICAgICAgIG1lLnJlZnJlc2hMaXN0KHRydWUpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBhbGVydChyZXNwLmVycik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sCiAgICBzYXZlRWRpdDogZnVuY3Rpb24gKGlkRWRpdCkgewogICAgICAgIHZhciBtZSA9IHRoaXM7CiAgICAgICAgdGhpcy5PbkVycm9yQ2xvc2UgPSBmYWxzZTsKICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gImhpZGRlbiI7CiAgICAgICAgdmFyIGNvdmVyID0gdGhpcy5wcmVmaXggKyAiX2Zvcm1zaW1wYW4iOwogICAgICAgIGFkZENvdmVyUGFnZTIoY292ZXIsIDEsIHRydWUsIGZhbHNlKTsKICAgICAgICAkLmFqYXgoewogICAgICAgICAgICB0eXBlOiAiUE9TVCIsCiAgICAgICAgICAgIGRhdGE6ICQoIiMiICsgdGhpcy5wcmVmaXggKyAiX2Zvcm0iKS5zZXJpYWxpemUoKSArICImaWRFZGl0PSIgKyBpZEVkaXQsCiAgICAgICAgICAgIHVybDogdGhpcy51cmwgKyAiJnRpcGU9c2F2ZUVkaXQiLAogICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgdmFyIHJlc3AgPSBldmFsKCIoIiArIGRhdGEgKyAiKSIpOwogICAgICAgICAgICAgICAgZGVsRWxlbShjb3Zlcik7CiAgICAgICAgICAgICAgICBpZiAocmVzcC5lcnIgPT0gIiIpIHsKICAgICAgICAgICAgICAgICAgICBtZS5DbG9zZSgpOwogICAgICAgICAgICAgICAgICAgIG1lLnJlZnJlc2hMaXN0KHRydWUpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBhbGVydChyZXNwLmVycik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sCiAgICBSZXBvcnQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgYUZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0aGlzLnByZWZpeCArICJfZm9ybSIpOwogICAgICAgIHZhciBtZSA9IHRoaXM7CiAgICAgICAgdGhpcy5PbkVycm9yQ2xvc2UgPSBmYWxzZTsKICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gImhpZGRlbiI7CiAgICAgICAgdmFyIGNvdmVyID0gdGhpcy5wcmVmaXggKyAiX2Zvcm1zaW1wYW4iOwogICAgICAgIGFkZENvdmVyUGFnZTIoY292ZXIsIDEsIHRydWUsIGZhbHNlKTsKICAgICAgICB2YXIgdXJsMiA9IHRoaXMudXJsOwogICAgICAgICQuYWpheCh7CiAgICAgICAgICAgIHR5cGU6ICJQT1NUIiwKICAgICAgICAgICAgZGF0YTogewogICAgICAgICAgICAgICAgamVuaXNLZWdpYXRhbjogJCgiI2plbmlzS2VnaWF0YW4iKS52YWwoKSwKICAgICAgICAgICAgICAgIGNldGFramFuZzogJCgiI2NldGFramFuZyIpLnZhbCgpLAogICAgICAgICAgICAgICAgdHRkOiAkKCIjdHRkIikudmFsKCksCiAgICAgICAgICAgICAgICBjMTogJCgiI2ZpbHRlclVydXNhbiIpLnZhbCgpLAogICAgICAgICAgICAgICAgYzogJCgiI2ZpbHRlckJpZGFuZyIpLnZhbCgpLAogICAgICAgICAgICAgICAgZDogJCgiI2ZpbHRlclNLUEQiKS52YWwoKSwKICAgICAgICAgICAgICAgIGU6ICQoIiNmaWx0ZXJVbml0IikudmFsKCksCiAgICAgICAgICAgICAgICBlMTogJCgiI2ZpbHRlclN1YlVuaXQiKS52YWwoKQogICAgICAgICAgICB9LAogICAgICAgICAgICB1cmw6IHRoaXMudXJsICsgIiZ0aXBlPVJlcG9ydCIsCiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICB2YXIgcmVzcCA9IGV2YWwoIigiICsgZGF0YSArICIpIik7CiAgICAgICAgICAgICAgICBkZWxFbGVtKGNvdmVyKTsKICAgICAgICAgICAgICAgIGlmIChyZXNwLmVyciA9PSAiIikgewogICAgICAgICAgICAgICAgICAgIGFGb3JtLmFjdGlvbiA9CiAgICAgICAgICAgICAgICAgICAgICAgIHVybDIgKwogICAgICAgICAgICAgICAgICAgICAgICAiJnRpcGU9IiArCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3AuY29udGVudC50byArCiAgICAgICAgICAgICAgICAgICAgICAgICImdXJ1c2FuPSIgKwogICAgICAgICAgICAgICAgICAgICAgICAkKCIjZmlsdGVyVXJ1c2FuIikudmFsKCkgKwogICAgICAgICAgICAgICAgICAgICAgICAiJmJpZGFuZz0iICsKICAgICAgICAgICAgICAgICAgICAgICAgJCgiI2ZpbHRlckJpZGFuZyIpLnZhbCgpICsKICAgICAgICAgICAgICAgICAgICAgICAgIiZza3BkPSIgKwogICAgICAgICAgICAgICAgICAgICAgICAkKCIjZmlsdGVyU0tQRCIpLnZhbCgpICsKICAgICAgICAgICAgICAgICAgICAgICAgIiZ1bml0PSIgKwogICAgICAgICAgICAgICAgICAgICAgICAkKCIjZmlsdGVyVW5pdCIpLnZhbCgpICsKICAgICAgICAgICAgICAgICAgICAgICAgIiZzdWJ1bml0PSIgKwogICAgICAgICAgICAgICAgICAgICAgICAkKCIjZmlsdGVyU3ViVW5pdCIpLnZhbCgpICsKICAgICAgICAgICAgICAgICAgICAgICAgIiZrb3RhPSIgKwogICAgICAgICAgICAgICAgICAgICAgICByZXNwLmNvbnRlbnQubmFtYVBlbWRhICsKICAgICAgICAgICAgICAgICAgICAgICAgIiZ0YW5nZ2FsQ2V0YWs9IiArCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3AuY29udGVudC5jZXRha2phbmcgKwogICAgICAgICAgICAgICAgICAgICAgICAiJnR0ZD0iICsKICAgICAgICAgICAgICAgICAgICAgICAgcmVzcC5jb250ZW50LnR0ZDsKICAgICAgICAgICAgICAgICAgICBhRm9ybS50YXJnZXQgPSAiX2JsYW5rIjsKICAgICAgICAgICAgICAgICAgICBhRm9ybS5zdWJtaXQoKTsKICAgICAgICAgICAgICAgICAgICBhRm9ybS50YXJnZXQgPSAiIjsKICAgICAgICAgICAgICAgICAgICBtZS5DbG9zZSgpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBhbGVydChyZXNwLmVycik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sCiAgICBCYXJ1VFREOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgICB2YXIgZXJyID0gIiI7CiAgICAgICAgdmFyIHVydXNhbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmaWx0ZXJVcnVzYW4iKS52YWx1ZTsKICAgICAgICB2YXIgYmlkYW5nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZpbHRlckJpZGFuZyIpLnZhbHVlOwogICAgICAgIHZhciBza3BkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZpbHRlclNLUEQiKS52YWx1ZTsKICAgICAgICB2YXIgdW5pdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmaWx0ZXJVbml0IikudmFsdWU7CiAgICAgICAgdmFyIHN1YnVuaXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZmlsdGVyU3ViVW5pdCIpLnZhbHVlOwoKICAgICAgICB2YXIgY292ZXIgPSB0aGlzLnByZWZpeCArICJfZm9ybWNvdmVyIjsKICAgICAgICBpZiAoZXJyID09ICIiKSB7CiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAiaGlkZGVuIjsKICAgICAgICAgICAgYWRkQ292ZXJQYWdlMihjb3ZlciwgOTk5LCB0cnVlLCBmYWxzZSk7CiAgICAgICAgICAgICQuYWpheCh7CiAgICAgICAgICAgICAgICB0eXBlOiAiUE9TVCIsCiAgICAgICAgICAgICAgICBkYXRhOgogICAgICAgICAgICAgICAgICAgICQoIiMiICsgdGhpcy5mb3JtTmFtZSkuc2VyaWFsaXplKCkgKwogICAgICAgICAgICAgICAgICAgICImdXJ1c2FuPSIgKwogICAgICAgICAgICAgICAgICAgIHVydXNhbiArCiAgICAgICAgICAgICAgICAgICAgIiZiaWRhbmc9IiArCiAgICAgICAgICAgICAgICAgICAgYmlkYW5nICsKICAgICAgICAgICAgICAgICAgICAiJnNrcGQ9IiArCiAgICAgICAgICAgICAgICAgICAgc2twZCArCiAgICAgICAgICAgICAgICAgICAgIiZ1bml0PSIgKwogICAgICAgICAgICAgICAgICAgIHVuaXQgKwogICAgICAgICAgICAgICAgICAgICImc3VidW5pdD0iICsKICAgICAgICAgICAgICAgICAgICBzdWJ1bml0LAogICAgICAgICAgICAgICAgdXJsOiB0aGlzLnVybCArICImdGlwZT1mb3JtQmFydVRURCIsCiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIGRlbEVsZW0oY292ZXIpOwogICAgICAgICAgICAgICAgICAgIHZhciByZXNwID0gZXZhbCgiKCIgKyBkYXRhICsgIikiKTsKICAgICAgICAgICAgICAgICAgICBpZiAocmVzcC5lcnIgPT0gIiIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY292ZXIpLmlubmVySFRNTCA9IHJlc3AuY29udGVudDsKICAgICAgICAgICAgICAgICAgICAgICAgbWUuQWZ0ZXJGb3JtQmFydShyZXNwKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBhbGVydChyZXNwLmVycik7CgogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gImF1dG8iOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYWxlcnQoZXJyKTsKICAgICAgICB9CiAgICB9LAogICAgRWRpdDogZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBtZSA9IHRoaXM7CiAgICAgICAgZXJybXNnID0gdGhpcy5DZWtDaGVja2JveCgpOwoKICAgICAgICBpZiAoZXJybXNnID09ICIiKSB7CiAgICAgICAgICAgIHZhciBib3ggPSB0aGlzLkdldENieENoZWNrZWQoKTsKICAgICAgICAgICAgdmFyIGFGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5mb3JtTmFtZSk7CiAgICAgICAgICAgIHZhciBjb3ZlciA9IHRoaXMucHJlZml4ICsgIl9mb3JtY292ZXIiOwogICAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gImhpZGRlbiI7CiAgICAgICAgICAgIGFkZENvdmVyUGFnZTIoY292ZXIsIDEsIHRydWUsIGZhbHNlKTsKICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgIHR5cGU6ICJQT1NUIiwKICAgICAgICAgICAgICAgIGRhdGE6ICQoIiMiICsgdGhpcy5mb3JtTmFtZSkuc2VyaWFsaXplKCksCiAgICAgICAgICAgICAgICB1cmw6IHRoaXMudXJsICsgIiZ0aXBlPUVkaXQiLAogICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcCA9IGV2YWwoIigiICsgZGF0YSArICIpIik7CiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY292ZXIpLmlubmVySFRNTCA9IHJlc3AuY29udGVudDsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYWxlcnQoZXJybXNnKTsKICAgICAgICB9CiAgICB9LAogICAgUmVwb3J0MjogZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBhRm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMucHJlZml4ICsgIl9mb3JtIik7CiAgICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgICBlcnJtc2cgPSB0aGlzLkNla0NoZWNrYm94KCk7CiAgICAgICAgdmFyIGplbmlzS2VnaWF0YW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiamVuaXNLZWdpYXRhbiIpLnZhbHVlOwogICAgICAgIHZhciBjZXRha2phbmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2V0YWtqYW5nIikudmFsdWU7CiAgICAgICAgLy8gdmFyIHR0ZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0dGQnKS52YWx1ZTsKICAgICAgICB2YXIgYzEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZmlsdGVyVXJ1c2FuIikudmFsdWU7CiAgICAgICAgdmFyIGMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZmlsdGVyQmlkYW5nIikudmFsdWU7CiAgICAgICAgdmFyIGQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZmlsdGVyU0tQRCIpLnZhbHVlOwogICAgICAgIHZhciBlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZpbHRlclVuaXQiKS52YWx1ZTsKICAgICAgICB2YXIgZTEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiZmlsdGVyU3ViVW5pdCIpLnZhbHVlOwogICAgICAgIHRoaXMuT25FcnJvckNsb3NlID0gZmFsc2U7CiAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICJoaWRkZW4iOwogICAgICAgIHZhciBjb3ZlciA9IHRoaXMucHJlZml4ICsgIl9mb3Jtc2ltcGFuIjsKICAgICAgICBhZGRDb3ZlclBhZ2UyKGNvdmVyLCAxLCB0cnVlLCBmYWxzZSk7CiAgICAgICAgdmFyIHVybDIgPSB0aGlzLnVybDsKICAgICAgICAkLmFqYXgoewogICAgICAgICAgICB0eXBlOiAiUE9TVCIsCiAgICAgICAgICAgIGRhdGE6CiAgICAgICAgICAgICAgICAkKCIjIiArIHRoaXMuZm9ybU5hbWUpLnNlcmlhbGl6ZSgpICsKICAgICAgICAgICAgICAgICImamVuaXNLZWdpYXRhbj0iICsKICAgICAgICAgICAgICAgIGplbmlzS2VnaWF0YW4gKwogICAgICAgICAgICAgICAgIiZjZXRha2phbmc9IiArCiAgICAgICAgICAgICAgICBjZXRha2phbmcgKwogICAgICAgICAgICAgICAgIiZ1cnVzYW49IiArCiAgICAgICAgICAgICAgICBjMSArCiAgICAgICAgICAgICAgICAiJmJpZGFuZz0iICsKICAgICAgICAgICAgICAgIGMgKwogICAgICAgICAgICAgICAgIiZza3BkPSIgKwogICAgICAgICAgICAgICAgZCArCiAgICAgICAgICAgICAgICAiJnVuaXQ9IiArCiAgICAgICAgICAgICAgICBlICsKICAgICAgICAgICAgICAgICImc3VidW5pdD0iICsKICAgICAgICAgICAgICAgIGUxLAogICAgICAgICAgICAvLyB7CiAgICAgICAgICAgIC8vIAlqZW5pc0tlZ2lhdGFuIDogJCgiI2plbmlzS2VnaWF0YW4iKS52YWwoKSwKICAgICAgICAgICAgLy8gCWNldGFramFuZwkgIDogJCgiI2NldGFramFuZyIpLnZhbCgpLAogICAgICAgICAgICAvLyAJdHRkCQkJICA6ICQoIiN0dGQiKS52YWwoKSwKICAgICAgICAgICAgLy8gCWMxCQkJICA6ICQoIiNmaWx0ZXJVcnVzYW4iKS52YWwoKSwKICAgICAgICAgICAgLy8gCWMgCQkJICA6ICQoIiNmaWx0ZXJCaWRhbmciKS52YWwoKSwKICAgICAgICAgICAgLy8gCWQgCQkJICA6ICQoIiNmaWx0ZXJTS1BEIikudmFsKCksCiAgICAgICAgICAgIC8vIAllICAJCQkgIDogJCgiI2ZpbHRlclVuaXQiKS52YWwoKSwKICAgICAgICAgICAgLy8gCWUxIAkJCSAgOiAkKCIjZmlsdGVyU3ViVW5pdCIpLnZhbCgpLAoKICAgICAgICAgICAgLy8gfSwKICAgICAgICAgICAgdXJsOiB0aGlzLnVybCArICImdGlwZT1SZXBvcnQyIiwKICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgIHZhciByZXNwID0gZXZhbCgiKCIgKyBkYXRhICsgIikiKTsKICAgICAgICAgICAgICAgIGRlbEVsZW0oY292ZXIpOwogICAgICAgICAgICAgICAgaWYgKHJlc3AuZXJyID09ICIiKSB7CiAgICAgICAgICAgICAgICAgICAgYUZvcm0uYWN0aW9uID0KICAgICAgICAgICAgICAgICAgICAgICAgdXJsMiArCiAgICAgICAgICAgICAgICAgICAgICAgICImdGlwZT0iICsKICAgICAgICAgICAgICAgICAgICAgICAgcmVzcC5jb250ZW50LnRvICsKICAgICAgICAgICAgICAgICAgICAgICAgIiZub21vcj0iICsKICAgICAgICAgICAgICAgICAgICAgICAgcmVzcC5jb250ZW50Lm5vbW9yICsKICAgICAgICAgICAgICAgICAgICAgICAgIiZpZG5hPSIgKwogICAgICAgICAgICAgICAgICAgICAgICByZXNwLmNvbnRlbnQuaWRuYSArCiAgICAgICAgICAgICAgICAgICAgICAgICImdXJ1c2FuPSIgKwogICAgICAgICAgICAgICAgICAgICAgICAkKCIjZmlsdGVyVXJ1c2FuIikudmFsKCkgKwogICAgICAgICAgICAgICAgICAgICAgICAiJmJpZGFuZz0iICsKICAgICAgICAgICAgICAgICAgICAgICAgJCgiI2ZpbHRlckJpZGFuZyIpLnZhbCgpICsKICAgICAgICAgICAgICAgICAgICAgICAgIiZza3BkPSIgKwogICAgICAgICAgICAgICAgICAgICAgICAkKCIjZmlsdGVyU0tQRCIpLnZhbCgpICsKICAgICAgICAgICAgICAgICAgICAgICAgIiZ1bml0PSIgKwogICAgICAgICAgICAgICAgICAgICAgICAkKCIjZmlsdGVyVW5pdCIpLnZhbCgpICsKICAgICAgICAgICAgICAgICAgICAgICAgIiZzdWJ1bml0PSIgKwogICAgICAgICAgICAgICAgICAgICAgICAkKCIjZmlsdGVyU3ViVW5pdCIpLnZhbCgpICsKICAgICAgICAgICAgICAgICAgICAgICAgIiZrb3RhPSIgKwogICAgICAgICAgICAgICAgICAgICAgICByZXNwLmNvbnRlbnQubmFtYVBlbWRhICsKICAgICAgICAgICAgICAgICAgICAgICAgIiZ0YW5nZ2FsQ2V0YWs9IiArCiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3AuY29udGVudC5jZXRha2phbmcgKwogICAgICAgICAgICAgICAgICAgICAgICAiJnR0ZD0iICsKICAgICAgICAgICAgICAgICAgICAgICAgcmVzcC5jb250ZW50LnR0ZDsKICAgICAgICAgICAgICAgICAgICBhRm9ybS50YXJnZXQgPSAiX2JsYW5rIjsKICAgICAgICAgICAgICAgICAgICBhRm9ybS5zdWJtaXQoKTsKICAgICAgICAgICAgICAgICAgICBhRm9ybS50YXJnZXQgPSAiIjsKICAgICAgICAgICAgICAgICAgICBtZS5DbG9zZSgpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBhbGVydChyZXNwLmVycik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sCiAgICBMYXBvcmFuOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgICB2YXIgZXJyID0gIiI7CiAgICAgICAgdmFyIGNvdmVyID0gdGhpcy5wcmVmaXggKyAiX2Zvcm1jb3ZlciI7CiAgICAgICAgaWYgKCQoIiNmaWx0ZXJVcnVzYW4iKS52YWwoKSA9PSAiMDAiKSB7CiAgICAgICAgICAgIGVyciA9ICJQaWxpaCBVcnVzYW4iOwogICAgICAgIH0gZWxzZSBpZiAoJCgiI2ZpbHRlckJpZGFuZyIpLnZhbCgpID09ICIwMCIpIHsKICAgICAgICAgICAgZXJyID0gIlBpbGloIEJpZGFuZyI7CiAgICAgICAgfSBlbHNlIGlmICgkKCIjZmlsdGVyU0tQRCIpLnZhbCgpID09ICIwMCIpIHsKICAgICAgICAgICAgZXJyID0gIlBpbGloIFNLUEQiOwogICAgICAgIH0gZWxzZSBpZiAoJCgiI2ZpbHRlclVuaXQiKS52YWwoKSA9PSAiMDAiKSB7CiAgICAgICAgICAgIGVyciA9ICJQaWxpaCBVbml0IjsKICAgICAgICB9IGVsc2UgaWYgKCQoIiNmaWx0ZXJTdWJVbml0IikudmFsKCkgPT0gIjAwMCIpIHsKICAgICAgICAgICAgZXJyID0gIlBpbGloIFN1YiBVbml0IjsKICAgICAgICB9CiAgICAgICAgaWYgKGVyciA9PSAiIikgewogICAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gImhpZGRlbiI7CiAgICAgICAgICAgIGFkZENvdmVyUGFnZTIoY292ZXIsIDIsIHRydWUsIGZhbHNlKTsKICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgIHR5cGU6ICJQT1NUIiwKICAgICAgICAgICAgICAgIGRhdGE6ICQoIiMiICsgdGhpcy5mb3JtTmFtZSkuc2VyaWFsaXplKCksCiAgICAgICAgICAgICAgICB1cmw6IHRoaXMudXJsICsgIiZ0aXBlPUxhcG9yYW4iLAogICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcCA9IGV2YWwoIigiICsgZGF0YSArICIpIik7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3AuZXJyID09ICIiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvdmVyKS5pbm5lckhUTUwgPSByZXNwLmNvbnRlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgIG1lLkFmdGVyRm9ybUJhcnUocmVzcCk7CiAgICAgICAgICAgICAgICAgICAgICAgICQoIiN0YW5nZ2FsQ2V0YWsiKS5kYXRlcGlja2VyKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVGb3JtYXQ6ICJkZC1tbS15eSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93QW5pbTogInNsaWRlRG93biIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmxpbmU6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93T246ICJidXR0b24iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uSW1hZ2U6ICJpbWFnZXMvY2FsZW5kYXIuZ2lmIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvbkltYWdlT25seTogdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoYW5nZU1vbnRoOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hhbmdlWWVhcjogZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB5ZWFyUmFuZ2U6IHJlc3AuY29udGVudC55ZWFyUmFuZ2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b25UZXh0OiAiIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHREYXRlOiArMAogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBhbGVydChyZXNwLmVycik7CiAgICAgICAgICAgICAgICAgICAgICAgIGRlbEVsZW0oY292ZXIpOwogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gImF1dG8iOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYWxlcnQoZXJyKTsKICAgICAgICB9CiAgICB9LAoKICAgIExhcG9yYW40OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgICB2YXIgY292ZXIgPSB0aGlzLnByZWZpeCArICJfZm9ybWNvdmVyIjsKICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gImhpZGRlbiI7CiAgICAgICAgaWYgKG1lLnNhdHVhbl9mb3JtID09IDApIHsKICAgICAgICAgICAgLy9iYXJ1IGRhcmkgc2F0dWFuCiAgICAgICAgICAgIGFkZENvdmVyUGFnZTIoY292ZXIsIDEsIHRydWUsIGZhbHNlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvL2JhcnUgZGFyaSBiYXJhbmcKICAgICAgICAgICAgYWRkQ292ZXJQYWdlMihjb3ZlciwgOTk5LCB0cnVlLCBmYWxzZSk7CiAgICAgICAgfQogICAgICAgICQuYWpheCh7CiAgICAgICAgICAgIHR5cGU6ICJQT1NUIiwKICAgICAgICAgICAgZGF0YTogJCgiIyIgKyB0aGlzLmZvcm1OYW1lKS5zZXJpYWxpemUoKSwKICAgICAgICAgICAgdXJsOiB0aGlzLnVybCArICImdGlwZT1MYXBvcmFuNCIsCiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICB2YXIgcmVzcCA9IGV2YWwoIigiICsgZGF0YSArICIpIik7CiAgICAgICAgICAgICAgICBpZiAocmVzcC5lcnIgPT0gIiIpIHsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb3ZlcikuaW5uZXJIVE1MID0gcmVzcC5jb250ZW50OwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBkZWxFbGVtKGNvdmVyKTsKICAgICAgICAgICAgICAgICAgICBhbGVydChyZXNwLmVycik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sCiAgICBuZXdUYW5kYVRhbmdhbmdhbjogZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBtZSA9IHRoaXM7CiAgICAgICAgdmFyIGVyciA9ICIiOwogICAgICAgIHZhciBjb3ZlciA9IHRoaXMucHJlZml4ICsgIl9mb3JtY292ZXJUYW5kYVRhbmdhbiI7CgogICAgICAgIGlmIChlcnIgPT0gIiIpIHsKICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICJoaWRkZW4iOwogICAgICAgICAgICBhZGRDb3ZlclBhZ2UyKGNvdmVyLCA5OSwgdHJ1ZSwgZmFsc2UpOwogICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgdHlwZTogIlBPU1QiLAogICAgICAgICAgICAgICAgZGF0YTogJCgiIyIgKyB0aGlzLnByZWZpeCArICJfZm9ybSIpLnNlcmlhbGl6ZSgpLAogICAgICAgICAgICAgICAgdXJsOiB0aGlzLnVybCArICImdGlwZT1uZXdUYW5kYVRhbmdhbmdhbiIsCiAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIHZhciByZXNwID0gZXZhbCgiKCIgKyBkYXRhICsgIikiKTsKICAgICAgICAgICAgICAgICAgICBpZiAocmVzcC5lcnIgPT0gIiIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY292ZXIpLmlubmVySFRNTCA9IHJlc3AuY29udGVudDsKICAgICAgICAgICAgICAgICAgICAgICAgbWUuQWZ0ZXJGb3JtQmFydShyZXNwKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBhbGVydChyZXNwLmVycik7CiAgICAgICAgICAgICAgICAgICAgICAgIGRlbEVsZW0oY292ZXIpOwogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gImF1dG8iOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYWxlcnQoZXJyKTsKICAgICAgICB9CiAgICB9LAogICAgdmlld0xhcG9yYW46IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgbWUgPSB0aGlzOwogICAgICAgIGVycm1zZyA9ICIiOwogICAgICAgIGlmIChlcnJtc2cgPT0gIiIpIHsKICAgICAgICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgICAgICAgdmFyIGFGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGhpcy5wcmVmaXggKyAiX2Zvcm0iKTsKICAgICAgICAgICAgYUZvcm0uYWN0aW9uID0gInBnUGVyc2VkaWFhbi5waHA\/UGc9Y2xvc2luZ1BlcnNlZGlhYW4mdGlwZT12aWV3TGFwb3JhbiI7CiAgICAgICAgICAgIGFGb3JtLnRhcmdldCA9ICJfYmxhbmsiOwogICAgICAgICAgICBhRm9ybS5zdWJtaXQoKTsKICAgICAgICAgICAgYUZvcm0udGFyZ2V0ID0gIiI7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYWxlcnQoZXJybXNnKTsKICAgICAgICB9CiAgICB9LAogICAgY2xvc2VUYW5kYVRhbmdhbkZvcm06IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgY292ZXIgPSB0aGlzLnByZWZpeCArICJfZm9ybWNvdmVyVGFuZGFUYW5nYW4iOwogICAgICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb3ZlcikpIGRlbEVsZW0oY292ZXIpOwogICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAiYXV0byI7CiAgICB9LAogICAgc2F2ZU5ld1RhbmRhVGFuZ2FuOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgICB0aGlzLk9uRXJyb3JDbG9zZSA9IGZhbHNlOwogICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAiaGlkZGVuIjsKICAgICAgICB2YXIgY292ZXIgPSAicmVuamFBc2V0IiArICJfZm9ybXNpbXBhbiI7CiAgICAgICAgYWRkQ292ZXJQYWdlMihjb3ZlciwgMSwgdHJ1ZSwgZmFsc2UpOwogICAgICAgICQuYWpheCh7CiAgICAgICAgICAgIHR5cGU6ICJQT1NUIiwKICAgICAgICAgICAgZGF0YTogewogICAgICAgICAgICAgICAgYzE6ICQoIiNjMSIpLnZhbCgpLAogICAgICAgICAgICAgICAgYzogJCgiI2MiKS52YWwoKSwKICAgICAgICAgICAgICAgIGQ6ICQoIiNkIikudmFsKCksCiAgICAgICAgICAgICAgICBlOiAkKCIjZSIpLnZhbCgpLAogICAgICAgICAgICAgICAgZTE6ICQoIiNlMSIpLnZhbCgpLAogICAgICAgICAgICAgICAga2F0ZWdvcmk6ICQoIiNrYXRlZ29yaSIpLnZhbCgpLAogICAgICAgICAgICAgICAgbmFtYXBlZ2F3YWk6ICQoIiNuYW1hcGVnYXdhaSIpLnZhbCgpLAogICAgICAgICAgICAgICAgbmlwcGVnYXdhaTogJCgiI25pcHBlZ2F3YWkiKS52YWwoKSwKICAgICAgICAgICAgICAgIHBhbmdrYXRha2hpcjogJCgiI3BhbmdrYXRha2hpciIpLnZhbCgpLAogICAgICAgICAgICAgICAgZ29sYW5nX2FraGlyOiAkKCIjZ29sYW5nX2FraGlyIikudmFsKCksCiAgICAgICAgICAgICAgICBqYWJhdGFuOiAkKCIjamFiYXRhbiIpLnZhbCgpLAogICAgICAgICAgICAgICAgZXNlbG9uX2FraGlyOiAkKCIjZXNlbG9uX2FraGlyIikudmFsKCkKICAgICAgICAgICAgfSwKICAgICAgICAgICAgdXJsOiB0aGlzLnVybCArICImdGlwZT1zYXZlTmV3VGFuZGFUYW5nYW4iLAogICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgdmFyIHJlc3AgPSBldmFsKCIoIiArIGRhdGEgKyAiKSIpOwogICAgICAgICAgICAgICAgZGVsRWxlbShjb3Zlcik7CiAgICAgICAgICAgICAgICAvL2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvdmVyKS5pbm5lckhUTUwgPSByZXNwLmNvbnRlbnQ7CiAgICAgICAgICAgICAgICBpZiAocmVzcC5lcnIgPT0gIiIpIHsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiaWRQZW5hbmRhVGFuZ2FuIikuaW5uZXJIVE1MID0KICAgICAgICAgICAgICAgICAgICAgICAgcmVzcC5jb250ZW50LmNvbWJvdHRkOwogICAgICAgICAgICAgICAgICAgIG1lLmNsb3NlVGFuZGFUYW5nYW5Gb3JtKCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGFsZXJ0KHJlc3AuZXJyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIENsb3Npbmc6IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgbWUgPSB0aGlzOwogICAgICAgIHZhciBjb3ZlciA9IHRoaXMucHJlZml4ICsgIl9mb3JtY292ZXIiOwogICAgICAgIC8vIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAiaGlkZGVuIjsKICAgICAgICBhZGRDb3ZlclBhZ2UyKGNvdmVyLCAxMCwgdHJ1ZSwgZmFsc2UpOwogICAgICAgICQuYWpheCh7CiAgICAgICAgICAgIHR5cGU6ICJQT1NUIiwKICAgICAgICAgICAgZGF0YTogJCgiIyIgKyB0aGlzLmZvcm1OYW1lKS5zZXJpYWxpemUoKSwKICAgICAgICAgICAgdXJsOiB0aGlzLnVybCArICImdGlwZT1DbG9zaW5nIiwKICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgIHZhciByZXNwID0gZXZhbCgiKCIgKyBkYXRhICsgIikiKTsKICAgICAgICAgICAgICAgIGlmIChyZXNwLmVyciA9PSAiIikgewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvdmVyKS5pbm5lckhUTUwgPSByZXNwLmNvbnRlbnQ7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGRlbEVsZW0oY292ZXIpOwogICAgICAgICAgICAgICAgICAgIGFsZXJ0KHJlc3AuZXJyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIFR1dHVwQnVrdTogZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBtZSA9IHRoaXM7CiAgICAgICAgdmFyIGNvdmVyID0gdGhpcy5wcmVmaXggKyAiX2Zvcm1jb3ZlciI7CiAgICAgICAgLy8gZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICJoaWRkZW4iOwogICAgICAgIGFkZENvdmVyUGFnZTIoY292ZXIsIDEwLCB0cnVlLCBmYWxzZSk7CiAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgdHlwZTogIlBPU1QiLAogICAgICAgICAgICBkYXRhOiAkKCIjIiArIHRoaXMuZm9ybU5hbWUpLnNlcmlhbGl6ZSgpLAogICAgICAgICAgICB1cmw6IHRoaXMudXJsICsgIiZ0aXBlPVR1dHVwQnVrdSIsCiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICB2YXIgcmVzcCA9IGV2YWwoIigiICsgZGF0YSArICIpIik7CiAgICAgICAgICAgICAgICBpZiAocmVzcC5lcnIgPT0gIiIpIHsKICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb3ZlcikuaW5uZXJIVE1MID0gcmVzcC5jb250ZW50OwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBkZWxFbGVtKGNvdmVyKTsKICAgICAgICAgICAgICAgICAgICBhbGVydChyZXNwLmVycik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sCiAgICBleGVjdXRlQ2xvc2luZzogZnVuY3Rpb24gKCkgewogICAgICAgICQoIiNza3BkTm90Q0xvc2luZyIpLnZhbCgiIik7CiAgICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgICB2YXIgY292ZXIgPSB0aGlzLnByZWZpeCArICJfZm9ybWNvdmVyTG9hZGluZyI7CiAgICAgICAgLy8gZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICJoaWRkZW4iOwogICAgICAgIGFkZENvdmVyUGFnZTIoY292ZXIsIDE1LCB0cnVlLCBmYWxzZSk7CiAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgdHlwZTogIlBPU1QiLAogICAgICAgICAgICBkYXRhOiAkKCIjIiArIHRoaXMucHJlZml4ICsgIl9mb3JtIikuc2VyaWFsaXplKCksCiAgICAgICAgICAgIHVybDogdGhpcy51cmwgKyAiJnRpcGU9ZXhlY3V0ZUNsb3NpbmciLAogICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgZGVsRWxlbShjb3Zlcik7CiAgICAgICAgICAgICAgICB2YXIgcmVzcCA9IGV2YWwoIigiICsgZGF0YSArICIpIik7CiAgICAgICAgICAgICAgICBpZiAocmVzcC5lcnIgPT0gIiIpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgY292ZXIyID0gInBlbGFwb3JhblBlcnNlZGlhYW5fZm9ybWNvdmVyX2xvYWQiOwogICAgICAgICAgICAgICAgICAgIGFkZENvdmVyUGFnZTIoY292ZXIyLCAyMCwgdHJ1ZSwgZmFsc2UpOwogICAgICAgICAgICAgICAgICAgIC8vIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAiaGlkZGVuIjsKICAgICAgICAgICAgICAgICAgICAkKCIjbG9nSGl0dW5nIikudGV4dCgiIik7CiAgICAgICAgICAgICAgICAgICAgbWUucHJvc2VzQ2xvc2luZygwLCAiYmVsb20iKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgYWxlcnQocmVzcC5lcnIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9LAogICAgZXhlY3V0ZVR1dHVwQnVrdTogZnVuY3Rpb24gKCkgewogICAgICAgICQoIiNza3BkTm90Q0xvc2luZyIpLnZhbCgiIik7CiAgICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgICB2YXIgY292ZXIgPSB0aGlzLnByZWZpeCArICJfZm9ybWNvdmVyTG9hZGluZyI7CiAgICAgICAgLy8gZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICJoaWRkZW4iOwogICAgICAgIGFkZENvdmVyUGFnZTIoY292ZXIsIDE1LCB0cnVlLCBmYWxzZSk7CiAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgdHlwZTogIlBPU1QiLAogICAgICAgICAgICBkYXRhOiAkKCIjIiArIHRoaXMucHJlZml4ICsgIl9mb3JtIikuc2VyaWFsaXplKCksCiAgICAgICAgICAgIHVybDogdGhpcy51cmwgKyAiJnRpcGU9ZXhlY3V0ZVR1dHVwQnVrdSIsCiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICBkZWxFbGVtKGNvdmVyKTsKICAgICAgICAgICAgICAgIHZhciByZXNwID0gZXZhbCgiKCIgKyBkYXRhICsgIikiKTsKICAgICAgICAgICAgICAgIGlmIChyZXNwLmVyciA9PSAiIikgewogICAgICAgICAgICAgICAgICAgIHZhciBjb3ZlcjIgPSAicGVsYXBvcmFuUGVyc2VkaWFhbl9mb3JtY292ZXJfbG9hZCI7CiAgICAgICAgICAgICAgICAgICAgYWRkQ292ZXJQYWdlMihjb3ZlcjIsIDIwLCB0cnVlLCBmYWxzZSk7CiAgICAgICAgICAgICAgICAgICAgLy8gZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICJoaWRkZW4iOwogICAgICAgICAgICAgICAgICAgICQoIiNsb2dDbG9zaW5nIikudGV4dCgiIik7CiAgICAgICAgICAgICAgICAgICAgbWUucHJvc2VzVHV0dXBCdWt1KDAsICJiZWxvbSIpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkKCIjbG9nQ2xvc2luZyIpLnRleHQocmVzcC5jb250ZW50LmxvZ0Nsb3NpbmcpOwoKICAgICAgICAgICAgICAgICAgICBhbGVydChyZXNwLmVycik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sCiAgICBleGVjdXRlQ291bnRBbmRDbG9zZTogZnVuY3Rpb24gKGp1bWxhaFNLUEQsIG5vbW9ySW5kZXgpIHsKICAgICAgICAkKCIjc2twZE5vdENMb3NpbmciKS52YWwoIiIpOwogICAgICAgIHZhciBtZSA9IHRoaXM7CiAgICAgICAgdmFyIGNvdmVyID0gdGhpcy5wcmVmaXggKyAiX2Zvcm1jb3ZlckxvYWRpbmciOwogICAgICAgIC8vIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAiaGlkZGVuIjsKICAgICAgICBhZGRDb3ZlclBhZ2UyKGNvdmVyLCAxNSwgdHJ1ZSwgZmFsc2UpOwogICAgICAgICQuYWpheCh7CiAgICAgICAgICAgIHR5cGU6ICJQT1NUIiwKICAgICAgICAgICAgZGF0YTogJCgiIyIgKyB0aGlzLnByZWZpeCArICJfZm9ybSIpLnNlcmlhbGl6ZSgpICsgIiZub21vckluZGV4PSIgKyBub21vckluZGV4LAogICAgICAgICAgICB1cmw6IHRoaXMudXJsICsgIiZ0aXBlPWV4ZWN1dGVDb3VudEFuZENsb3NlIiwKICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgIGRlbEVsZW0oY292ZXIpOwogICAgICAgICAgICAgICAgdmFyIHJlc3AgPSBldmFsKCIoIiArIGRhdGEgKyAiKSIpOwogICAgICAgICAgICAgICAgaWYgKHJlc3AuZXJyID09ICIiKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKGp1bWxhaFNLUEQgPT0gbm9tb3JJbmRleCkgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgY292ZXIyID0gInBlbGFwb3JhblBlcnNlZGlhYW5fZm9ybWNvdmVyX2xvYWQiOwogICAgICAgICAgICAgICAgICAgICAgICBhZGRDb3ZlclBhZ2UyKGNvdmVyMiwgMjAsIHRydWUsIGZhbHNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICJoaWRkZW4iOwogICAgICAgICAgICAgICAgICAgICAgICAkKCIjbG9nSGl0dW5nIikudGV4dCgiIik7CiAgICAgICAgICAgICAgICAgICAgICAgIG1lLnByb3Nlc0NvdW50QW5kQ2xvc2luZygwLCAiYmVsb20iKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAkKCcjbG9nQ2xvc2luZycpLnZhbCgkKCcjbG9nQ2xvc2luZycpLnZhbCgpICsgJ1xuJyArIHJlc3AuY29udGVudC5sb2dDaGVjayk7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0QXJlYU9iamVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dDbG9zaW5nJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBcmVhT2JqZWN0LnNjcm9sbFRvcCA9IHRleHRBcmVhT2JqZWN0LnNjcm9sbEhlaWdodDsKICAgICAgICAgICAgICAgICAgICAgICAgbm9tb3JJbmRleCA9IG5vbW9ySW5kZXggKyAxOwogICAgICAgICAgICAgICAgICAgICAgICBtZS5leGVjdXRlQ291bnRBbmRDbG9zZShqdW1sYWhTS1BELCBub21vckluZGV4KTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBhbGVydChyZXNwLmVycik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0sCiAgICBwcm9zZXNDbG9zaW5nOiBmdW5jdGlvbiAodXJ1dGFuLCBzdGF0dXNTZWxlc2FpKSB7CiAgICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgICB2YXIgY292ZXIgPSB0aGlzLnByZWZpeCArICJfZm9ybWNvdmVyIjsKICAgICAgICB2YXIgb2JqID0gSlNPTi5wYXJzZSgkKCIjYXJyYXlEYXRhUG9zdCIpLnZhbCgpKTsKICAgICAgICB2YXIgYXJyYXlLb2RlQmFyYW5nID0gSlNPTi5wYXJzZSgkKCIjYXJyYXlLb2RlQmFyYW5nIikudmFsKCkpOwogICAgICAgIGlmIChzdGF0dXNTZWxlc2FpICE9ICJPSyIpIHsKICAgICAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgICAgIHR5cGU6ICJQT1NUIiwKICAgICAgICAgICAgICAgIGRhdGE6IHsKICAgICAgICAgICAgICAgICAgICBub21vclBvc3Q6IHVydXRhbiwKICAgICAgICAgICAgICAgICAgICB0b3RhbEJhcmFuZzogJCgiI3RvdGFsQmFyYW5nIikudmFsKCksCiAgICAgICAgICAgICAgICAgICAga29kZUNsb3Npbmc6IG9ialt1cnV0YW5dLAogICAgICAgICAgICAgICAgICAgIGp1bWxhaERhdGE6ICQoIiNsZW5ndGhQcm9jY2VzcyIpLnZhbCgpLAogICAgICAgICAgICAgICAgICAgIGZpbHRlclBlcmlvZGU6ICQoIiNmaWx0ZXJQZXJpb2RlIikudmFsKCksCiAgICAgICAgICAgICAgICAgICAga2V0ZXJhbmdhbjogJCgiI2tldGVyYW5nYW4iKS52YWwoKSwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICB1cmw6IHRoaXMudXJsICsgIiZ0aXBlPXByb3Nlc0Nsb3NpbmciLAogICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcCA9IGV2YWwoIigiICsgZGF0YSArICIpIik7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3AuZXJyID09ICIiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwLmNvbnRlbnQuc2twZEJlbHVtQ2xvc2luZyAhPSAnJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQoIiNza3BkTm90Q0xvc2luZyIpLnZhbCgpID09ICIiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgiI3NrcGROb3RDTG9zaW5nIikudmFsKHJlc3AuY29udGVudC5za3BkQmVsdW1DbG9zaW5nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3AuY29udGVudC5za3BkQmVsdW1DbG9zaW5nICE9ICdudWxsJyAmJiByZXNwLmNvbnRlbnQuc2twZEJlbHVtQ2xvc2luZyAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIiNza3BkTm90Q0xvc2luZyIpLnZhbCgkKCIjc2twZE5vdENMb3NpbmciKS52YWwoKSArICI7IiArIHJlc3AuY29udGVudC5za3BkQmVsdW1DbG9zaW5nKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoInN0YXR1c3R4dCIpLnN0eWxlLndpZHRoID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3AuY29udGVudC5wZXJzZW4gKyAiJSI7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzdGF0dXN0eHQiKS5pbm5lckhUTUwgPQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzcC5jb250ZW50LnBlcnNlbiArICIlIjsKICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2xvZ0Nsb3NpbmcnKS52YWwoJCgnI2xvZ0Nsb3NpbmcnKS52YWwoKSArICdcbicgKyByZXNwLmNvbnRlbnQubG9nQ2xvc2luZyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0QXJlYU9iamVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dDbG9zaW5nJyk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRleHRBcmVhT2JqZWN0LnNjcm9sbFRvcCA9IHRleHRBcmVhT2JqZWN0LnNjcm9sbEhlaWdodDsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3AuY29udGVudC5zdGF0dXNOZXh0ID09ICJ0cnVlIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJ1dGFuID0gdXJ1dGFuICsgMTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lLnByb3Nlc0Nsb3NpbmcoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJ1dGFuLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3AuY29udGVudC5zdGF0dXNTZWxlc2FpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUucHJvc2VzU2V0U2FsZG9Bd2FsKDAsIHVydXRhbik7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQocmVzcC5lcnIpOwogICAgICAgICAgICAgICAgICAgICAgICAkKCcjbG9nQ2xvc2luZycpLnZhbChyZXNwLmVycik7CiAgICAgICAgICAgICAgICAgICAgICAgIGRlbEVsZW0oInBlbGFwb3JhblBlcnNlZGlhYW5fZm9ybWNvdmVyX2xvYWQiKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGRlbEVsZW0oInBlbGFwb3JhblBlcnNlZGlhYW5fZm9ybWNvdmVyX2xvYWQiKTsKICAgICAgICAgICAgaWYgKCQoIiNza3BkTm90Q0xvc2luZyIpLnZhbCgpICE9ICIiKSB7CiAgICAgICAgICAgICAgICB2YXIgYXJyYXlOb3RDbG9zaW5nID0gJCgiI3NrcGROb3RDTG9zaW5nIikudmFsKCkuc3BsaXQoIjsiKTsKICAgICAgICAgICAgICAgIGlmIChjb25maXJtKCJBZGEgIiArIGFycmF5Tm90Q2xvc2luZy5sZW5ndGgudG9TdHJpbmcoKSArICIgZGF0YSB5YW5nIGJlbHVtIGRpIGhpdHVuZyAhLCBoaXR1bmcgZGFuIGNsb3NpbmcgZGF0YSB5YW5nIHRlcnNpc2EgPyAiKSkgewogICAgICAgICAgICAgICAgICAgIHZhciBsaXN0S29kZVNLUEQgPSAkKCIjc2twZE5vdENMb3NpbmciKS52YWwoKTsKICAgICAgICAgICAgICAgICAgICB2YXIga2V0ZXJhbmdhbiA9ICQoIiNrZXRlcmFuZ2FuIikudmFsKCk7CiAgICAgICAgICAgICAgICAgICAgbWUuQ2xvc2UoKTsKICAgICAgICAgICAgICAgICAgICBtZS5Db3VudEFuZENsb3NlKGxpc3RLb2RlU0tQRCwga2V0ZXJhbmdhbik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBhbGVydCgiQ2xvc2luZyBTZWxlc2FpICEiKTsKICAgICAgICAgICAgICAgIG1lLkNsb3NlKCk7CiAgICAgICAgICAgICAgICBtZS5yZWZyZXNoTGlzdCh0cnVlKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0sCiAgICBwcm9zZXNUdXR1cEJ1a3U6IGZ1bmN0aW9uICh1cnV0YW4sIHN0YXR1c1NlbGVzYWkpIHsKICAgICAgICB2YXIgbWUgPSB0aGlzOwogICAgICAgIHZhciBjb3ZlciA9IHRoaXMucHJlZml4ICsgIl9mb3JtY292ZXIiOwogICAgICAgIHZhciBvYmogPSBKU09OLnBhcnNlKCQoIiNhcnJheURhdGFQb3N0IikudmFsKCkpOwogICAgICAgIHZhciBhcnJheUtvZGVCYXJhbmcgPSBKU09OLnBhcnNlKCQoIiNhcnJheUtvZGVCYXJhbmciKS52YWwoKSk7CiAgICAgICAgaWYgKHN0YXR1c1NlbGVzYWkgIT0gIk9LIikgewogICAgICAgICAgICAkLmFqYXgoewogICAgICAgICAgICAgICAgdHlwZTogIlBPU1QiLAogICAgICAgICAgICAgICAgZGF0YTogewogICAgICAgICAgICAgICAgICAgIG5vbW9yUG9zdDogdXJ1dGFuLAogICAgICAgICAgICAgICAgICAgIHRvdGFsQmFyYW5nOiAkKCIjdG90YWxCYXJhbmciKS52YWwoKSwKICAgICAgICAgICAgICAgICAgICBrb2RlQ2xvc2luZzogb2JqW3VydXRhbl0sCiAgICAgICAgICAgICAgICAgICAganVtbGFoRGF0YTogJCgiI2xlbmd0aFByb2NjZXNzIikudmFsKCksCiAgICAgICAgICAgICAgICAgICAgZmlsdGVyUGVyaW9kZTogJCgiI2ZpbHRlclBlcmlvZGUiKS52YWwoKSwKICAgICAgICAgICAgICAgICAgICBrZXRlcmFuZ2FuOiAkKCIja2V0ZXJhbmdhbiIpLnZhbCgpLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIHVybDogdGhpcy51cmwgKyAiJnRpcGU9cHJvc2VzVHV0dXBCdWt1IiwKICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3AgPSBldmFsKCIoIiArIGRhdGEgKyAiKSIpOwogICAgICAgICAgICAgICAgICAgIGlmIChyZXNwLmVyciA9PSAiIikgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcC5jb250ZW50LnNrcGRCZWx1bUNsb3NpbmcgIT0gJycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkKCIjc2twZE5vdENMb3NpbmciKS52YWwoKSA9PSAiIikgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIiNza3BkTm90Q0xvc2luZyIpLnZhbChyZXNwLmNvbnRlbnQuc2twZEJlbHVtQ2xvc2luZyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwLmNvbnRlbnQuc2twZEJlbHVtQ2xvc2luZyAhPSAnbnVsbCcgJiYgcmVzcC5jb250ZW50LnNrcGRCZWx1bUNsb3NpbmcgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCIjc2twZE5vdENMb3NpbmciKS52YWwoJCgiI3NrcGROb3RDTG9zaW5nIikudmFsKCkgKyAiOyIgKyByZXNwLmNvbnRlbnQuc2twZEJlbHVtQ2xvc2luZyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzdGF0dXN0eHQiKS5zdHlsZS53aWR0aCA9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNwLmNvbnRlbnQucGVyc2VuICsgIiUiOwogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic3RhdHVzdHh0IikuaW5uZXJIVE1MID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3AuY29udGVudC5wZXJzZW4gKyAiJSI7CiAgICAgICAgICAgICAgICAgICAgICAgICQoJyNsb2dDbG9zaW5nJykudmFsKCQoJyNsb2dDbG9zaW5nJykudmFsKCkgKyAnXG4nICsgcmVzcC5jb250ZW50LmxvZ0Nsb3NpbmcpOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dEFyZWFPYmplY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9nQ2xvc2luZycpOwogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QXJlYU9iamVjdC5zY3JvbGxUb3AgPSB0ZXh0QXJlYU9iamVjdC5zY3JvbGxIZWlnaHQ7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwLmNvbnRlbnQuc3RhdHVzTmV4dCA9PSAidHJ1ZSIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVydXRhbiA9IHVydXRhbiArIDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZS5wcm9zZXNUdXR1cEJ1a3UoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJ1dGFuLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3AuY29udGVudC5zdGF0dXNTZWxlc2FpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUucHJvc2VzU2V0U2FsZG9Bd2FsVGFodW5EZXBhbigwLCB1cnV0YW4pOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KHJlc3AuZXJyKTsKICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2xvZ0Nsb3NpbmcnKS52YWwocmVzcC5lcnIpOwogICAgICAgICAgICAgICAgICAgICAgICBkZWxFbGVtKCJwZWxhcG9yYW5QZXJzZWRpYWFuX2Zvcm1jb3Zlcl9sb2FkIik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkZWxFbGVtKCJwZWxhcG9yYW5QZXJzZWRpYWFuX2Zvcm1jb3Zlcl9sb2FkIik7CiAgICAgICAgICAgIGFsZXJ0KCJUdXR1cCBidWt1IFNlbGVzYWkgISIpOwogICAgICAgICAgICBtZS5DbG9zZSgpOwogICAgICAgIH0KICAgIH0sCiAgICBwcm9zZXNTZXRTYWxkb0F3YWw6IGZ1bmN0aW9uIChub21vckJhcmFuZywgdXJ1dGFuU0tQRCkgewogICAgICAgIHZhciBhcnJheUtvZGVTS1BEID0gSlNPTi5wYXJzZSgkKCIjYXJyYXlEYXRhUG9zdCIpLnZhbCgpKTsKICAgICAgICB2YXIgYXJyYXlLb2RlQmFyYW5nID0gSlNPTi5wYXJzZSgkKCIjYXJyYXlLb2RlQmFyYW5nIikudmFsKCkpOwogICAgICAgICQuYWpheCh7CiAgICAgICAgICAgIHR5cGU6ICJQT1NUIiwKICAgICAgICAgICAgZGF0YTogewogICAgICAgICAgICAgICAgbm9tb3JCYXJhbmc6IG5vbW9yQmFyYW5nLAogICAgICAgICAgICAgICAgdG90YWxCYXJhbmc6ICQoIiN0b3RhbEJhcmFuZyIpLnZhbCgpLAogICAgICAgICAgICAgICAga29kZVNLUEQ6IGFycmF5S29kZVNLUERbdXJ1dGFuU0tQRF0sCiAgICAgICAgICAgICAgICBrb2RlQmFyYW5nOiBhcnJheUtvZGVCYXJhbmdbbm9tb3JCYXJhbmddLAogICAgICAgICAgICAgICAgZmlsdGVyUGVyaW9kZTogJCgiI2ZpbHRlclBlcmlvZGUiKS52YWwoKSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgdXJsOiB0aGlzLnVybCArICImdGlwZT1wcm9zZXNTZXRTYWxkb0F3YWwiLAogICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgdmFyIHJlc3AgPSBldmFsKCIoIiArIGRhdGEgKyAiKSIpOwogICAgICAgICAgICAgICAgaWYgKHJlc3AuY29udGVudC5zdGF0dXNTZWxlc2FpICE9ICJzZWxlc2FpIikgewogICAgICAgICAgICAgICAgICAgIG5vbW9yQmFyYW5nID0gbm9tb3JCYXJhbmcgKyAxOwogICAgICAgICAgICAgICAgICAgIC8vICQoJyNsb2dDbG9zaW5nJykudmFsKCQoJyNsb2dDbG9zaW5nJykudmFsKCkgKyAnXG4nICsgcmVzcC5jb250ZW50LmxvZ0Nsb3NpbmcpOwogICAgICAgICAgICAgICAgICAgIC8vIHZhciB0ZXh0QXJlYU9iamVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dDbG9zaW5nJyk7CiAgICAgICAgICAgICAgICAgICAgLy8gdGV4dEFyZWFPYmplY3Quc2Nyb2xsVG9wID0gdGV4dEFyZWFPYmplY3Quc2Nyb2xsSGVpZ2h0OwogICAgICAgICAgICAgICAgICAgIGNsb3NpbmdQZXJzZWRpYWFuLnByb3Nlc1NldFNhbGRvQXdhbCgKICAgICAgICAgICAgICAgICAgICAgICAgbm9tb3JCYXJhbmcsCiAgICAgICAgICAgICAgICAgICAgICAgIHVydXRhblNLUEQsCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdXJ1dGFuU0tQRCA9IHVydXRhblNLUEQgKyAxOwogICAgICAgICAgICAgICAgICAgIGlmICh1cnV0YW5TS1BEID09ICQoIiNsZW5ndGhQcm9jY2VzcyIpLnZhbCgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NpbmdQZXJzZWRpYWFuLnByb3Nlc0Nsb3NpbmcodXJ1dGFuU0tQRCwgIk9LIik7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2luZ1BlcnNlZGlhYW4ucHJvc2VzQ2xvc2luZyh1cnV0YW5TS1BELCAiYmVsb20iKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICB9LAogICAgcHJvc2VzU2V0U2FsZG9Bd2FsVGFodW5EZXBhbjogZnVuY3Rpb24gKG5vbW9yQmFyYW5nLCB1cnV0YW5TS1BEKSB7CiAgICAgICAgdmFyIGFycmF5S29kZVNLUEQgPSBKU09OLnBhcnNlKCQoIiNhcnJheURhdGFQb3N0IikudmFsKCkpOwogICAgICAgIHZhciBhcnJheUtvZGVCYXJhbmcgPSBKU09OLnBhcnNlKCQoIiNhcnJheUtvZGVCYXJhbmciKS52YWwoKSk7CiAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgdHlwZTogIlBPU1QiLAogICAgICAgICAgICBkYXRhOiB7CiAgICAgICAgICAgICAgICBub21vckJhcmFuZzogbm9tb3JCYXJhbmcsCiAgICAgICAgICAgICAgICB0b3RhbEJhcmFuZzogJCgiI3RvdGFsQmFyYW5nIikudmFsKCksCiAgICAgICAgICAgICAgICBrb2RlU0tQRDogYXJyYXlLb2RlU0tQRFt1cnV0YW5TS1BEXSwKICAgICAgICAgICAgICAgIGtvZGVCYXJhbmc6IGFycmF5S29kZUJhcmFuZ1tub21vckJhcmFuZ10sCiAgICAgICAgICAgICAgICBmaWx0ZXJQZXJpb2RlOiAkKCIjZmlsdGVyUGVyaW9kZSIpLnZhbCgpLAogICAgICAgICAgICB9LAogICAgICAgICAgICB1cmw6IHRoaXMudXJsICsgIiZ0aXBlPXByb3Nlc1NldFNhbGRvQXdhbFRhaHVuRGVwYW4iLAogICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgdmFyIHJlc3AgPSBldmFsKCIoIiArIGRhdGEgKyAiKSIpOwogICAgICAgICAgICAgICAgaWYgKHJlc3AuY29udGVudC5zdGF0dXNTZWxlc2FpICE9ICJzZWxlc2FpIikgewogICAgICAgICAgICAgICAgICAgIG5vbW9yQmFyYW5nID0gbm9tb3JCYXJhbmcgKyAxOwogICAgICAgICAgICAgICAgICAgIC8vICQoJyNsb2dDbG9zaW5nJykudmFsKCQoJyNsb2dDbG9zaW5nJykudmFsKCkgKyAnXG4nICsgcmVzcC5jb250ZW50LmxvZ0Nsb3NpbmcpOwogICAgICAgICAgICAgICAgICAgIC8vIHZhciB0ZXh0QXJlYU9iamVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2dDbG9zaW5nJyk7CiAgICAgICAgICAgICAgICAgICAgLy8gdGV4dEFyZWFPYmplY3Quc2Nyb2xsVG9wID0gdGV4dEFyZWFPYmplY3Quc2Nyb2xsSGVpZ2h0OwogICAgICAgICAgICAgICAgICAgIGNsb3NpbmdQZXJzZWRpYWFuLnByb3Nlc1NldFNhbGRvQXdhbFRhaHVuRGVwYW4oCiAgICAgICAgICAgICAgICAgICAgICAgIG5vbW9yQmFyYW5nLAogICAgICAgICAgICAgICAgICAgICAgICB1cnV0YW5TS1BELAogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHVydXRhblNLUEQgPSB1cnV0YW5TS1BEICsgMTsKICAgICAgICAgICAgICAgICAgICBpZiAodXJ1dGFuU0tQRCA9PSAkKCIjbGVuZ3RoUHJvY2Nlc3MiKS52YWwoKSkgewogICAgICAgICAgICAgICAgICAgICAgICBjbG9zaW5nUGVyc2VkaWFhbi5wcm9zZXNUdXR1cEJ1a3UodXJ1dGFuU0tQRCwgIk9LIik7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2luZ1BlcnNlZGlhYW4ucHJvc2VzVHV0dXBCdWt1KHVydXRhblNLUEQsICJiZWxvbSIpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgIH0sCiAgICBwcm9zZXNTZXRTYWxkb0F3YWxDb3VudDogZnVuY3Rpb24gKG5vbW9yQmFyYW5nLCB1cnV0YW5TS1BELGtvZGVTS1BEKSB7CiAgICAgICAgdmFyIGFycmF5S29kZVNLUEQgPSBKU09OLnBhcnNlKCQoIiNhcnJheURhdGFQb3N0IikudmFsKCkpOwogICAgICAgIHZhciBhcnJheUtvZGVCYXJhbmcgPSBKU09OLnBhcnNlKCQoIiNhcnJheUtvZGVCYXJhbmciKS52YWwoKSk7CiAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgdHlwZTogIlBPU1QiLAogICAgICAgICAgICBkYXRhOiB7CiAgICAgICAgICAgICAgICBub21vckJhcmFuZzogbm9tb3JCYXJhbmcsCiAgICAgICAgICAgICAgICB0b3RhbEJhcmFuZzogJCgiI3RvdGFsQmFyYW5nIikudmFsKCksCiAgICAgICAgICAgICAgICBrb2RlU0tQRDoga29kZVNLUEQsCiAgICAgICAgICAgICAgICBrb2RlQmFyYW5nOiBhcnJheUtvZGVCYXJhbmdbbm9tb3JCYXJhbmddLAogICAgICAgICAgICAgICAgZmlsdGVyUGVyaW9kZTogJCgiI2ZpbHRlclBlcmlvZGUiKS52YWwoKSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgdXJsOiB0aGlzLnVybCArICImdGlwZT1wcm9zZXNTZXRTYWxkb0F3YWxDb3VudCIsCiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICB2YXIgcmVzcCA9IGV2YWwoIigiICsgZGF0YSArICIpIik7CiAgICAgICAgICAgICAgICBpZiAocmVzcC5jb250ZW50LnN0YXR1c1NlbGVzYWkgIT0gInNlbGVzYWkiKSB7CiAgICAgICAgICAgICAgICAgICAgbm9tb3JCYXJhbmcgPSBub21vckJhcmFuZyArIDE7CiAgICAgICAgICAgICAgICAgICAgJCgnI2xvZ0Nsb3NpbmcnKS52YWwoJCgnI2xvZ0Nsb3NpbmcnKS52YWwoKSArICdcbicgKyByZXNwLmNvbnRlbnQubG9nQ2xvc2luZyk7CiAgICAgICAgICAgICAgICAgICAgdmFyIHRleHRBcmVhT2JqZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvZ0Nsb3NpbmcnKTsKICAgICAgICAgICAgICAgICAgICB0ZXh0QXJlYU9iamVjdC5zY3JvbGxUb3AgPSB0ZXh0QXJlYU9iamVjdC5zY3JvbGxIZWlnaHQ7CiAgICAgICAgICAgICAgICAgICAgY2xvc2luZ1BlcnNlZGlhYW4ucHJvc2VzU2V0U2FsZG9Bd2FsQ291bnQoCiAgICAgICAgICAgICAgICAgICAgICAgIG5vbW9yQmFyYW5nLAogICAgICAgICAgICAgICAgICAgICAgICB1cnV0YW5TS1BELAogICAgICAgICAgICAgICAgICAgICAgICBrb2RlU0tQRCwKICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB1cnV0YW5TS1BEID0gdXJ1dGFuU0tQRCArIDE7CiAgICAgICAgICAgICAgICAgICAgaWYgKHVydXRhblNLUEQgPT0gJCgiI2xlbmd0aFByb2NjZXNzIikudmFsKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2luZ1BlcnNlZGlhYW4ucHJvc2VzQ291bnRBbmRDbG9zaW5nKHVydXRhblNLUEQsICJPSyIpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NpbmdQZXJzZWRpYWFuLnByb3Nlc0NvdW50QW5kQ2xvc2luZyh1cnV0YW5TS1BELCAiYmVsb20iKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICB9LAogICAgcHJvc2VzQ291bnRBbmRDbG9zaW5nOiBmdW5jdGlvbiAodXJ1dGFuLCBzdGF0dXNTZWxlc2FpKSB7CiAgICAgICAgdmFyIG1lID0gdGhpczsKICAgICAgICB2YXIgY292ZXIgPSB0aGlzLnByZWZpeCArICJfZm9ybWNvdmVyIjsKICAgICAgICB2YXIgb2JqID0gSlNPTi5wYXJzZSgkKCIjYXJyYXlEYXRhUG9zdCIpLnZhbCgpKTsKICAgICAgICBpZiAoc3RhdHVzU2VsZXNhaSAhPSAiT0siKSB7CiAgICAgICAgICAgICQuYWpheCh7CiAgICAgICAgICAgICAgICB0eXBlOiAiUE9TVCIsCiAgICAgICAgICAgICAgICBkYXRhOiB7CiAgICAgICAgICAgICAgICAgICAgbm9tb3JQb3N0OiB1cnV0YW4sCiAgICAgICAgICAgICAgICAgICAgdG90YWxCYXJhbmc6ICQoIiN0b3RhbEJhcmFuZyIpLnZhbCgpLAogICAgICAgICAgICAgICAgICAgIGtvZGVDbG9zaW5nOiBvYmpbdXJ1dGFuXSwKICAgICAgICAgICAgICAgICAgICBqdW1sYWhEYXRhOiAkKCIjbGVuZ3RoUHJvY2Nlc3MiKS52YWwoKSwKICAgICAgICAgICAgICAgICAgICBmaWx0ZXJQZXJpb2RlOiAkKCIjZmlsdGVyUGVyaW9kZSIpLnZhbCgpLAogICAgICAgICAgICAgICAgICAgIGtldGVyYW5nYW46ICQoIiNrZXRlcmFuZ2FuIikudmFsKCksCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgdXJsOiB0aGlzLnVybCArICImdGlwZT1wcm9zZXNDb3VudEFuZENsb3NpbmciLAogICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcCA9IGV2YWwoIigiICsgZGF0YSArICIpIik7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3AuZXJyID09ICIiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJzdGF0dXN0eHQiKS5zdHlsZS53aWR0aCA9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNwLmNvbnRlbnQucGVyc2VuICsgIiUiOwogICAgICAgICAgICAgICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgic3RhdHVzdHh0IikuaW5uZXJIVE1MID0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3AuY29udGVudC5wZXJzZW4gKyAiJSI7CiAgICAgICAgICAgICAgICAgICAgICAgICQoJyNsb2dDbG9zaW5nJykudmFsKCQoJyNsb2dDbG9zaW5nJykudmFsKCkgKyAnXG4nICsgcmVzcC5jb250ZW50LmxvZ0Nsb3NpbmcpOwogICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dEFyZWFPYmplY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9nQ2xvc2luZycpOwogICAgICAgICAgICAgICAgICAgICAgICB0ZXh0QXJlYU9iamVjdC5zY3JvbGxUb3AgPSB0ZXh0QXJlYU9iamVjdC5zY3JvbGxIZWlnaHQ7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmKHJlc3AuY29udGVudC5rb2RlQmFyYW5nID09ICcwOC4wMS4wMy4wMi4wMDEuMDAwMScpewogICAgICAgICAgICAgICAgICAgICAgICAvLyAgIGFsZXJ0KHJlc3AuY29udGVudC5pZFBlbmdlbHVhcmFuRGlzdHJpYnVzaSk7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vIH0KICAgICAgICAgICAgICAgICAgICAgICAgJCgiI2lkUGVuZ2VsdWFyYW5EaXN0cmlidXNpIikudmFsKCIiKTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYocmVzcC5jb250ZW50LmlkUGVuZ2VsdWFyYW5EaXN0cmlidXNpICE9ICcnKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAkKCIjaWRQZW5nZWx1YXJhbkRpc3RyaWJ1c2kiKS52YWwoJCgiI2lkUGVuZ2VsdWFyYW5EaXN0cmlidXNpIikudmFsKCkrIjsiK3Jlc3AuY29udGVudC5pZFBlbmdlbHVhcmFuRGlzdHJpYnVzaSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3AuY29udGVudC5zdGF0dXNTZXRTYWxkb0F3YWwgIT0gInRydWUiKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZigkKCIjaWRQZW5nZWx1YXJhbkRpc3RyaWJ1c2kiKS52YWwoKSAhPScnKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWUucHJvc2VzUmVDb3VudCgwKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVydXRhbiA9IHVydXRhbiArIDE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZS5wcm9zZXNDb3VudEFuZENsb3NpbmcoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJ1dGFuLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3AuY29udGVudC5zdGF0dXNTZWxlc2FpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lLnByb3Nlc1NldFNhbGRvQXdhbENvdW50KDAsIHVydXRhbixyZXNwLmNvbnRlbnQua29kZVNLUEQpOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KHJlc3AuZXJyKTsKICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2xvZ0Nsb3NpbmcnKS52YWwocmVzcC5lcnIpOwogICAgICAgICAgICAgICAgICAgICAgICBkZWxFbGVtKCJwZWxhcG9yYW5QZXJzZWRpYWFuX2Zvcm1jb3Zlcl9sb2FkIik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBkZWxFbGVtKCJwZWxhcG9yYW5QZXJzZWRpYWFuX2Zvcm1jb3Zlcl9sb2FkIik7CiAgICAgICAgICAgICQoIiNpZFBlbmdlbHVhcmFuRGlzdHJpYnVzaSIpLnZhbCgiIik7CiAgICAgICAgICAgIGFsZXJ0KCJDbG9zaW5nIFNlbGVzYWkgISIpOwogICAgICAgICAgICBtZS5DbG9zZSgpOwogICAgICAgICAgICBtZS5yZWZyZXNoTGlzdCh0cnVlKTsKICAgICAgICB9CiAgICB9LAogICAgQ291bnRBbmRDbG9zZTogZnVuY3Rpb24gKGxpc3RLb2RlU0tQRCwga2V0ZXJhbmdhbikgewogICAgICAgIHZhciBtZSA9IHRoaXM7CiAgICAgICAgdmFyIGNvdmVyID0gdGhpcy5wcmVmaXggKyAiX2Zvcm1jb3ZlciI7CiAgICAgICAgLy8gZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICJoaWRkZW4iOwogICAgICAgIGFkZENvdmVyUGFnZTIoY292ZXIsIDEwLCB0cnVlLCBmYWxzZSk7CiAgICAgICAgJC5hamF4KHsKICAgICAgICAgICAgdHlwZTogIlBPU1QiLAogICAgICAgICAgICBkYXRhOiAkKCIjIiArIHRoaXMuZm9ybU5hbWUpLnNlcmlhbGl6ZSgpICsgIiZsaXN0S29kZVNLUEQ9IiArIGxpc3RLb2RlU0tQRCArICIma2V0ZXJhbmdhbj0iICsga2V0ZXJhbmdhbiwKICAgICAgICAgICAgdXJsOiB0aGlzLnVybCArICImdGlwZT1Db3VudEFuZENsb3NlIiwKICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgIHZhciByZXNwID0gZXZhbCgiKCIgKyBkYXRhICsgIikiKTsKICAgICAgICAgICAgICAgIGlmIChyZXNwLmVyciA9PSAiIikgewogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvdmVyKS5pbm5lckhUTUwgPSByZXNwLmNvbnRlbnQ7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGRlbEVsZW0oY292ZXIpOwogICAgICAgICAgICAgICAgICAgIGFsZXJ0KHJlc3AuZXJyKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfSwKICAgIHByb3Nlc1JlQ291bnQ6IGZ1bmN0aW9uKHVydXRhbikgewogICAgICB2YXIgbWUgPSB0aGlzOwogICAgICB2YXIgY292ZXIgPSB0aGlzLnByZWZpeCArICJfZm9ybWNvdmVyIjsKICAgICAgdmFyIG9iaiA9ICQoIiNpZFBlbmdlbHVhcmFuRGlzdHJpYnVzaSIpLnZhbCgpLnNwbGl0KCc7Jyk7CiAgICAgIGlmICh1cnV0YW4gIT0gb2JqLmxlbmd0aCkgewogICAgICAgICQuYWpheCh7CiAgICAgICAgICB0eXBlOiAiUE9TVCIsCiAgICAgICAgICBkYXRhOiB7CiAgICAgICAgICAgIG5vbW9yUG9zdDogdXJ1dGFuLAogICAgICAgICAgICBpZEthcnR1UGVyc2VkaWFhbjogb2JqW3VydXRhbl0gLAogICAgICAgICAgICBhbGxJZDogJCgiI2lkUGVuZ2VsdWFyYW5EaXN0cmlidXNpIikudmFsKCkgLAogICAgICAgICAgICBmaWx0ZXJQZXJpb2RlOiAkKCIjZmlsdGVyUGVyaW9kZSIpLnZhbCgpLAogICAgICAgICAgfSwKICAgICAgICAgIHVybDogdGhpcy51cmwgKyAiJnRpcGU9cHJvc2VzUmVDb3VudCIsCiAgICAgICAgICBhc3luYzpmYWxzZSwKICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKGRhdGEpIHsKICAgICAgICAgICAgdmFyIHJlc3AgPSBldmFsKCIoIiArIGRhdGEgKyAiKSIpOwogICAgICAgICAgICBpZiAocmVzcC5lcnIgPT0gIiIpIHsKICAgICAgICAgICAgICB1cnV0YW4gPSB1cnV0YW4gKyAxOwogICAgICAgICAgICAgICAgbWUucHJvc2VzUmVDb3VudCgKICAgICAgICAgICAgICAgICAgdXJ1dGFuLAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBhbGVydChyZXNwLmVycik7CiAgICAgICAgICAgICAgJCgnI2xvZ0hpdHVuZycpLnZhbChyZXNwLmVycik7CiAgICAgICAgICAgICAgZGVsRWxlbSgicGVsYXBvcmFuUGVyc2VkaWFhbl9mb3JtY292ZXJfbG9hZCIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCn0pOwo=",
    "size": "49487"
}