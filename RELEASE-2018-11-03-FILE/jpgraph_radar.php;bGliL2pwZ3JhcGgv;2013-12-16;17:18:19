{
    "namaFile": "lib\/jpgraph\/jpgraph_radar.php",
    "lastUpdate": "2013-12-16+17:18:19.00",
    "contentFile": "PD9waHAKLyo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogLy8gRmlsZTogICAgICAgIEpQR1JBUEhfUkFEQVIuUEhQCiAvLyBEZXNjcmlwdGlvbjogUmFkYXIgcGxvdCBleHRlbnNpb24gZm9yIEpwR3JhcGgKIC8vIENyZWF0ZWQ6ICAgICAyMDAxLTAyLTA0CiAvLyBWZXI6ICAgICAgICAgJElkOiBqcGdyYXBoX3JhZGFyLnBocCAxNzgzIDIwMDktMDgtMjUgMTE6NDE6MDFaIGxqcCAkCiAvLwogLy8gQ29weXJpZ2h0IChjKSBBc2lhbCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KIC8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAqLwoKcmVxdWlyZV9vbmNlKCdqcGdyYXBoX3Bsb3RtYXJrLmluYy5waHAnKTsKCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIENMQVNTIFJhZGFyTG9nVGlja3MKLy8gRGVzY3JpcHRpb246IExvZ2FyaXRobWljIHRpY2tzCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CmNsYXNzIFJhZGFyTG9nVGlja3MgZXh0ZW5kcyBUaWNrcyB7CgogICAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoKSB7CiAgICAgICAgICAgIC8vIEVtcHR5CiAgICB9CgogICAgZnVuY3Rpb24gU3Ryb2tlKCRhSW1nLCYkZ3JpZCwkYVBvcywkYUF4aXNBbmdsZSwkYVNjYWxlLCYkYU1halBvcywmJGFNYWpMYWJlbCkgewogICAgICAgICRzdGFydCA9ICRhU2NhbGUtPkdldE1pblZhbCgpOwogICAgICAgICRsaW1pdCA9ICRhU2NhbGUtPkdldE1heFZhbCgpOwogICAgICAgICRuZXh0TWFqb3IgPSAxMCokc3RhcnQ7CiAgICAgICAgJHN0ZXAgPSAkbmV4dE1ham9yIC8gMTAuMDsKICAgICAgICAkY291bnQ9MTsKCiAgICAgICAgJHRpY2tsZW5fbWFqPTU7CiAgICAgICAgJGR4X21haj1yb3VuZChzaW4oJGFBeGlzQW5nbGUpKiR0aWNrbGVuX21haik7CiAgICAgICAgJGR5X21haj1yb3VuZChjb3MoJGFBeGlzQW5nbGUpKiR0aWNrbGVuX21haik7CiAgICAgICAgJHRpY2tsZW5fbWluPTM7CiAgICAgICAgJGR4X21pbj1yb3VuZChzaW4oJGFBeGlzQW5nbGUpKiR0aWNrbGVuX21pbik7CiAgICAgICAgJGR5X21pbj1yb3VuZChjb3MoJGFBeGlzQW5nbGUpKiR0aWNrbGVuX21pbik7CgogICAgICAgICRhTWFqUG9zPWFycmF5KCk7CiAgICAgICAgJGFNYWpMYWJlbD1hcnJheSgpOwoKICAgICAgICBpZiggJHRoaXMtPnN1cHJlc3NfZmlyc3QgKSB7CiAgICAgICAgICAgICRhTWFqTGFiZWxbXSA9ICcnOwogICAgICAgIH0KICAgICAgICBlbHNlIHsKICAgICAgICAgICAgJGFNYWpMYWJlbFtdPSRzdGFydDsKICAgICAgICB9CgogICAgICAgICR5cj0kYVNjYWxlLT5SZWxUcmFuc2xhdGUoJHN0YXJ0KTsKICAgICAgICAkeHQ9cm91bmQoJHlyKmNvcygkYUF4aXNBbmdsZSkpKyRhU2NhbGUtPnNjYWxlX2Fic1swXTsKICAgICAgICAkeXQ9JGFQb3Mtcm91bmQoJHlyKnNpbigkYUF4aXNBbmdsZSkpOwogICAgICAgICRhTWFqUG9zW109JHh0KzIqJGR4X21hajsKICAgICAgICAkYU1halBvc1tdPSR5dC0kYUltZy0+R2V0Rm9udGhlaWdodCgpLzI7CiAgICAgICAgJGdyaWRbXT0keHQ7CiAgICAgICAgJGdyaWRbXT0keXQ7CgogICAgICAgICRhSW1nLT5TZXRMaW5lV2VpZ2h0KCR0aGlzLT53ZWlnaHQpOwoKICAgICAgICBmb3IoJHk9JHN0YXJ0OyAkeTw9JGxpbWl0OyAkeSs9JHN0ZXAsKyskY291bnQgICkgewogICAgICAgICAgICAkeXI9JGFTY2FsZS0+UmVsVHJhbnNsYXRlKCR5KTsKICAgICAgICAgICAgJHh0PXJvdW5kKCR5cipjb3MoJGFBeGlzQW5nbGUpKSskYVNjYWxlLT5zY2FsZV9hYnNbMF07CiAgICAgICAgICAgICR5dD0kYVBvcy1yb3VuZCgkeXIqc2luKCRhQXhpc0FuZ2xlKSk7CiAgICAgICAgICAgIGlmKCAkY291bnQgJSAxMCA9PSAwICkgewogICAgICAgICAgICAgICAgJGdyaWRbXT0keHQ7CiAgICAgICAgICAgICAgICAkZ3JpZFtdPSR5dDsKICAgICAgICAgICAgICAgICRhTWFqUG9zW109JHh0KzIqJGR4X21hajsKICAgICAgICAgICAgICAgICRhTWFqUG9zW109JHl0LSRhSW1nLT5HZXRGb250aGVpZ2h0KCkvMjsKICAgICAgICAgICAgICAgIGlmKCAhJHRoaXMtPnN1cHJlc3NfdGlja21hcmtzICkgewogICAgICAgICAgICAgICAgICAgIGlmKCAkdGhpcy0+bWFqY29sb3IgIT0gJycgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRhSW1nLT5QdXNoQ29sb3IoJHRoaXMtPm1hamNvbG9yKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgJGFJbWctPkxpbmUoJHh0KyRkeF9tYWosJHl0KyRkeV9tYWosJHh0LSRkeF9tYWosJHl0LSRkeV9tYWopOwogICAgICAgICAgICAgICAgICAgIGlmKCAkdGhpcy0+bWFqY29sb3IgIT0gJycgKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRhSW1nLT5Qb3BDb2xvcigpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmKCAkdGhpcy0+bGFiZWxfZm9ybWZ1bmMgIT0gJycgKSB7CiAgICAgICAgICAgICAgICAgICAgJGY9JHRoaXMtPmxhYmVsX2Zvcm1mdW5jOwogICAgICAgICAgICAgICAgICAgICRsID0gY2FsbF91c2VyX2Z1bmMoJGYsJG5leHRNYWpvcik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAkbCA9ICRuZXh0TWFqb3I7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgJGFNYWpMYWJlbFtdPSRsOwogICAgICAgICAgICAgICAgJG5leHRNYWpvciAqPSAxMDsKICAgICAgICAgICAgICAgICRzdGVwICo9IDEwOwogICAgICAgICAgICAgICAgJGNvdW50PTE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICBpZiggISR0aGlzLT5zdXByZXNzX21pbm9yX3RpY2ttYXJrcyApIHsKICAgICAgICAgICAgICAgICAgICBpZiggJHRoaXMtPm1pbmNvbG9yICE9ICcnICkgewogICAgICAgICAgICAgICAgICAgICAgICAkYUltZy0+UHVzaENvbG9yKCR0aGlzLT5taW5jb2xvcik7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICRhSW1nLT5MaW5lKCR4dCskZHhfbWluLCR5dCskZHlfbWluLCR4dC0kZHhfbWluLCR5dC0kZHlfbWluKTsKICAgICAgICAgICAgICAgICAgICBpZiggJHRoaXMtPm1pbmNvbG9yICE9ICcnICkgewogICAgICAgICAgICAgICAgICAgICAgICAkYUltZy0+UG9wQ29sb3IoKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9Cn0KCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIENMQVNTIFJhZGFyTGluZWFyCi8vIERlc2NyaXB0aW9uOiBMaW5lYXIgdGlja3MKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KY2xhc3MgUmFkYXJMaW5lYXJUaWNrcyBleHRlbmRzIFRpY2tzIHsKCiAgICBwcml2YXRlICRtaW5vcl9zdGVwPTEsICRtYWpvcl9zdGVwPTI7CiAgICBwcml2YXRlICR4bGFiZWxfb2Zmc2V0PTAsJHh0aWNrX29mZnNldD0wOwoKICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCkgewogICAgICAgIC8vIEVtcHR5CiAgICB9CgogICAgLy8gUmV0dXJuIG1ham9yIHN0ZXAgc2l6ZSBpbiB3b3JsZCBjb29yZGluYXRlcwogICAgZnVuY3Rpb24gR2V0TWFqb3IoKSB7CiAgICAgICAgcmV0dXJuICR0aGlzLT5tYWpvcl9zdGVwOwogICAgfQoKICAgIC8vIFJldHVybiBtaW5vciBzdGVwIHNpemUgaW4gd29ybGQgY29vcmRpbmF0ZXMKICAgIGZ1bmN0aW9uIEdldE1pbm9yKCkgewogICAgICAgIHJldHVybiAkdGhpcy0+bWlub3Jfc3RlcDsKICAgIH0KCiAgICAvLyBTZXQgTWlub3IgYW5kIE1ham9yIHRpY2tzIChpbiB3b3JsZCBjb29yZGluYXRlcykKICAgIGZ1bmN0aW9uIFNldCgkYU1halN0ZXAsJGFNaW5TdGVwPWZhbHNlKSB7CiAgICAgICAgaWYoICRhTWluU3RlcD09ZmFsc2UgKSB7CiAgICAgICAgICAgICRhTWluU3RlcD0kYU1halN0ZXA7CiAgICAgICAgfQoKICAgICAgICBpZiggJGFNYWpTdGVwIDw9IDAgfHwgJGFNaW5TdGVwIDw9IDAgKSB7CiAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDI1MDY0KTsKICAgICAgICAgICAgLy9KcEdyYXBoRXJyb3I6OlJhaXNlKCIgTWlub3Igb3IgbWFqb3Igc3RlcCBzaXplIGlzIDAuIENoZWNrIHRoYXQgeW91IGhhdmVuJ3QgZ290IGFuIGFjY2lkZW50YWwgU2V0VGV4dFRpY2tzKDApIGluIHlvdXIgY29kZS4gSWYgdGhpcyBpcyBub3QgdGhlIGNhc2UgeW91IG1pZ2h0IGhhdmUgc3R1bWJsZWQgdXBvbiBhIGJ1ZyBpbiBKcEdyYXBoLiBQbGVhc2UgcmVwb3J0IHRoaXMgYW5kIGlmIHBvc3NpYmxlIGluY2x1ZGUgdGhlIGRhdGEgdGhhdCBjYXVzZWQgdGhlIHByb2JsZW0uIik7CiAgICAgICAgfQoKICAgICAgICAkdGhpcy0+bWFqb3Jfc3RlcD0kYU1halN0ZXA7CiAgICAgICAgJHRoaXMtPm1pbm9yX3N0ZXA9JGFNaW5TdGVwOwogICAgICAgICR0aGlzLT5pc19zZXQgPSB0cnVlOwogICAgfQoKICAgIGZ1bmN0aW9uIFN0cm9rZSgkYUltZywmJGdyaWQsJGFQb3MsJGFBeGlzQW5nbGUsJGFTY2FsZSwmJGFNYWpQb3MsJiRhTWFqTGFiZWwpIHsKICAgICAgICAvLyBQcmVwYXJlIHRvIGRyYXcgbGluZWFyIHRpY2tzCiAgICAgICAgJG1hal9zdGVwX2FicyA9IGFicygkYVNjYWxlLT5zY2FsZV9mYWN0b3IqJHRoaXMtPm1ham9yX3N0ZXApOwogICAgICAgICRtaW5fc3RlcF9hYnMgPSBhYnMoJGFTY2FsZS0+c2NhbGVfZmFjdG9yKiR0aGlzLT5taW5vcl9zdGVwKTsKICAgICAgICAkbmJybWFqID0gcm91bmQoJGFTY2FsZS0+d29ybGRfYWJzX3NpemUvJG1hal9zdGVwX2Ficyk7CiAgICAgICAgJG5icm1pbiA9IHJvdW5kKCRhU2NhbGUtPndvcmxkX2Fic19zaXplLyRtaW5fc3RlcF9hYnMpOwogICAgICAgICRza2lwID0gcm91bmQoJG5icm1pbi8kbmJybWFqKTsgLy8gRG9uJ3QgZHJhdyBtaW5vciBvbiB0b3Agb2YgbWFqb3IKCiAgICAgICAgLy8gRHJhdyBtYWpvciB0aWNrcwogICAgICAgICR0aWNrbGVuMj0kdGhpcy0+bWFqb3JfYWJzX3NpemU7CiAgICAgICAgJGR4PXJvdW5kKHNpbigkYUF4aXNBbmdsZSkqJHRpY2tsZW4yKTsKICAgICAgICAkZHk9cm91bmQoY29zKCRhQXhpc0FuZ2xlKSokdGlja2xlbjIpOwogICAgICAgICRsYWJlbD0kYVNjYWxlLT5zY2FsZVswXSskdGhpcy0+bWFqb3Jfc3RlcDsKCiAgICAgICAgJGFJbWctPlNldExpbmVXZWlnaHQoJHRoaXMtPndlaWdodCk7CgogICAgICAgICRhTWFqUG9zID0gYXJyYXkoKTsKICAgICAgICAkYU1hakxhYmVsID0gYXJyYXkoKTsKCiAgICAgICAgZm9yKCRpPTE7ICRpPD0kbmJybWFqOyArKyRpKSB7CiAgICAgICAgICAgICR4dD1yb3VuZCgkaSokbWFqX3N0ZXBfYWJzKmNvcygkYUF4aXNBbmdsZSkpKyRhU2NhbGUtPnNjYWxlX2Fic1swXTsKICAgICAgICAgICAgJHl0PSRhUG9zLXJvdW5kKCRpKiRtYWpfc3RlcF9hYnMqc2luKCRhQXhpc0FuZ2xlKSk7CgogICAgICAgICAgICBpZiggJHRoaXMtPmxhYmVsX2Zvcm1mdW5jICE9ICcnICkgewogICAgICAgICAgICAgICAgJGY9JHRoaXMtPmxhYmVsX2Zvcm1mdW5jOwogICAgICAgICAgICAgICAgJGwgPSBjYWxsX3VzZXJfZnVuYygkZiwkbGFiZWwpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2UgewogICAgICAgICAgICAgICAgJGwgPSAkbGFiZWw7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRhTWFqTGFiZWxbXT0kbDsKICAgICAgICAgICAgJGxhYmVsICs9ICR0aGlzLT5tYWpvcl9zdGVwOwogICAgICAgICAgICAkZ3JpZFtdPSR4dDsKICAgICAgICAgICAgJGdyaWRbXT0keXQ7CiAgICAgICAgICAgICRhTWFqUG9zWygkaS0xKSoyXT0keHQrMiokZHg7CiAgICAgICAgICAgICRhTWFqUG9zWygkaS0xKSoyKzFdPSR5dC0kYUltZy0+R2V0Rm9udGhlaWdodCgpLzI7CiAgICAgICAgICAgIGlmKCAhJHRoaXMtPnN1cHJlc3NfdGlja21hcmtzICkgewogICAgICAgICAgICAgICAgaWYoICR0aGlzLT5tYWpjb2xvciAhPSAnJyApIHsKICAgICAgICAgICAgICAgICAgICAkYUltZy0+UHVzaENvbG9yKCR0aGlzLT5tYWpjb2xvcik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkYUltZy0+TGluZSgkeHQrJGR4LCR5dCskZHksJHh0LSRkeCwkeXQtJGR5KTsKICAgICAgICAgICAgICAgIGlmKCAkdGhpcy0+bWFqY29sb3IgIT0gJycgKSB7CiAgICAgICAgICAgICAgICAgICAgJGFJbWctPlBvcENvbG9yKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIC8vIERyYXcgbWlub3IgdGlja3MKICAgICAgICAkdGlja2xlbjI9JHRoaXMtPm1pbm9yX2Fic19zaXplOwogICAgICAgICRkeD1yb3VuZChzaW4oJGFBeGlzQW5nbGUpKiR0aWNrbGVuMik7CiAgICAgICAgJGR5PXJvdW5kKGNvcygkYUF4aXNBbmdsZSkqJHRpY2tsZW4yKTsKICAgICAgICBpZiggISR0aGlzLT5zdXByZXNzX3RpY2ttYXJrcyAmJiAhJHRoaXMtPnN1cHJlc3NfbWlub3JfdGlja21hcmtzKSB7CiAgICAgICAgICAgIGlmKCAkdGhpcy0+bWluY29sb3IgIT0gJycgKSB7CiAgICAgICAgICAgICAgICAkYUltZy0+UHVzaENvbG9yKCR0aGlzLT5taW5jb2xvcik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZm9yKCRpPTE7ICRpPD0kbmJybWluOyArKyRpKSB7CiAgICAgICAgICAgICAgICBpZiggKCRpICUgJHNraXApID09IDAgKSB7CiAgICAgICAgICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkeHQ9cm91bmQoJGkqJG1pbl9zdGVwX2Ficypjb3MoJGFBeGlzQW5nbGUpKSskYVNjYWxlLT5zY2FsZV9hYnNbMF07CiAgICAgICAgICAgICAgICAkeXQ9JGFQb3Mtcm91bmQoJGkqJG1pbl9zdGVwX2FicypzaW4oJGFBeGlzQW5nbGUpKTsKICAgICAgICAgICAgICAgICRhSW1nLT5MaW5lKCR4dCskZHgsJHl0KyRkeSwkeHQtJGR4LCR5dC0kZHkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmKCAkdGhpcy0+bWluY29sb3IgIT0gJycgKSB7CiAgICAgICAgICAgICAgICAkYUltZy0+UG9wQ29sb3IoKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIENMQVNTIFJhZGFyQXhpcwovLyBEZXNjcmlwdGlvbjogSW1wbGVtZW50cyBheGlzIGZvciB0aGUgcmFkYXIgZ3JhcGgKLy89PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KY2xhc3MgUmFkYXJBeGlzIGV4dGVuZHMgQXhpc1Byb3RvdHlwZSB7CiAgICBwdWJsaWMgJHRpdGxlPW51bGw7CiAgICBwcml2YXRlICR0aXRsZV9jb2xvcj0nbmF2eSc7CiAgICBwcml2YXRlICRsZW49MDsKCiAgICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgkaW1nLCRhU2NhbGUsJGNvbG9yPWFycmF5KDAsMCwwKSkgewogICAgICAgIHBhcmVudDo6X19jb25zdHJ1Y3QoJGltZywkYVNjYWxlLCRjb2xvcik7CiAgICAgICAgJHRoaXMtPmxlbiA9ICRpbWctPnBsb3RoZWlnaHQ7CiAgICAgICAgJHRoaXMtPnRpdGxlID0gbmV3IFRleHQoKTsKICAgICAgICAkdGhpcy0+dGl0bGUtPlNldEZvbnQoRkZfRk9OVDEsRlNfQk9MRCk7CiAgICAgICAgJHRoaXMtPmNvbG9yID0gYXJyYXkoMCwwLDApOwogICAgfQoKICAgIC8vIFN0cm9rZSB0aGUgYXhpcwogICAgLy8gJHBvcyAgICA9IFZlcnRpY2FsIHBvc2l0aW9uIG9mIGF4aXMKICAgIC8vICRhQXhpc0FuZ2xlID0gQXhpcyBhbmdsZQogICAgLy8gJGdyaWQgICA9IFJldHVybnMgYW4gYXJyYXkgd2l0aCBwb3NpdGlvbnMgdXNlZCB0byBkcmF3IHRoZSBncmlkCiAgICAvLyAkbGYgICA9IExhYmVsIGZsYWcsIFRSVUUgaWYgdGhlIGF4aXMgc2hvdWxkIGhhdmUgbGFiZWxzCiAgICBmdW5jdGlvbiBTdHJva2UoJHBvcywkYUF4aXNBbmdsZSwmJGdyaWQsJHRpdGxlLCRsZikgewogICAgICAgICR0aGlzLT5pbWctPlNldENvbG9yKCR0aGlzLT5jb2xvcik7CgogICAgICAgIC8vIERldGVybWluZSBlbmQgcG9pbnRzIGZvciB0aGUgYXhpcwogICAgICAgICR4PXJvdW5kKCR0aGlzLT5zY2FsZS0+d29ybGRfYWJzX3NpemUqY29zKCRhQXhpc0FuZ2xlKSskdGhpcy0+c2NhbGUtPnNjYWxlX2Fic1swXSk7CiAgICAgICAgJHk9cm91bmQoJHBvcy0kdGhpcy0+c2NhbGUtPndvcmxkX2Fic19zaXplKnNpbigkYUF4aXNBbmdsZSkpOwoKICAgICAgICAvLyBEcmF3IGF4aXMKICAgICAgICAkdGhpcy0+aW1nLT5TZXRDb2xvcigkdGhpcy0+Y29sb3IpOwogICAgICAgICR0aGlzLT5pbWctPlNldExpbmVXZWlnaHQoJHRoaXMtPndlaWdodCk7CiAgICAgICAgaWYoICEkdGhpcy0+aGlkZSApIHsKICAgICAgICAgICAgJHRoaXMtPmltZy0+TGluZSgkdGhpcy0+c2NhbGUtPnNjYWxlX2Fic1swXSwkcG9zLCR4LCR5KTsKICAgICAgICB9CgogICAgICAgICR0aGlzLT5zY2FsZS0+dGlja3MtPlN0cm9rZSgkdGhpcy0+aW1nLCRncmlkLCRwb3MsJGFBeGlzQW5nbGUsJHRoaXMtPnNjYWxlLCRtYWpwb3MsJG1hamxhYmVsKTsKICAgICAgICAkbmNvbG9yPTA7CiAgICAgICAgaWYoIGlzc2V0KCR0aGlzLT50aWNrc19sYWJlbF9jb2xvcnMpICkgewogICAgICAgICAgICAkbmNvbG9yPWNvdW50KCR0aGlzLT50aWNrc19sYWJlbF9jb2xvcnMpOwogICAgICAgIH0KCiAgICAgICAgLy8gRHJhdyBsYWJlbHMKICAgICAgICBpZiggJGxmICYmICEkdGhpcy0+aGlkZSApIHsKICAgICAgICAgICAgJHRoaXMtPmltZy0+U2V0Rm9udCgkdGhpcy0+Zm9udF9mYW1pbHksJHRoaXMtPmZvbnRfc3R5bGUsJHRoaXMtPmZvbnRfc2l6ZSk7CiAgICAgICAgICAgICR0aGlzLT5pbWctPlNldFRleHRBbGlnbignbGVmdCcsJ3RvcCcpOwogICAgICAgICAgICAkdGhpcy0+aW1nLT5TZXRDb2xvcigkdGhpcy0+bGFiZWxfY29sb3IpOwoKICAgICAgICAgICAgLy8gbWFqcG9zIGNvbnRhaW5zICh4LHkpIGNvb3JkaW5hdGVzIGZvciBsYWJlbHMKICAgICAgICAgICAgaWYoICEgJHRoaXMtPmhpZGVfbGFiZWxzICkgewogICAgICAgICAgICAgICAgJG4gPSBmbG9vcihjb3VudCgkbWFqcG9zKS8yKTsKICAgICAgICAgICAgICAgIGZvcigkaT0wOyAkaSA8ICRuOyArKyRpKSB7CiAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHNwZWNpZmljIGxhYmVsIGNvbG9yIGlmIHNwZWNpZmllZAogICAgICAgICAgICAgICAgICAgIGlmKCAkbmNvbG9yID4gMCApIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmltZy0+U2V0Q29sb3IoJHRoaXMtPnRpY2tzX2xhYmVsX2NvbG9yc1skaSAlICRuY29sb3JdKTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmKCAkdGhpcy0+dGlja3NfbGFiZWwgIT0gbnVsbCAmJiBpc3NldCgkdGhpcy0+dGlja3NfbGFiZWxbJGldKSApIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmltZy0+U3Ryb2tlVGV4dCgkbWFqcG9zWyRpKjJdLCRtYWpwb3NbJGkqMisxXSwkdGhpcy0+dGlja3NfbGFiZWxbJGldKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5pbWctPlN0cm9rZVRleHQoJG1hanBvc1skaSoyXSwkbWFqcG9zWyRpKjIrMV0sJG1hamxhYmVsWyRpXSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgICR0aGlzLT5fU3Ryb2tlQXhpc1RpdGxlKCRwb3MsJGFBeGlzQW5nbGUsJHRpdGxlKTsKICAgIH0KCiAgICBmdW5jdGlvbiBfU3Ryb2tlQXhpc1RpdGxlKCRwb3MsJGFBeGlzQW5nbGUsJHRpdGxlKSB7CiAgICAgICAgJHRoaXMtPnRpdGxlLT5TZXQoJHRpdGxlKTsKICAgICAgICAkbWFyZz02KyR0aGlzLT50aXRsZS0+bWFyZ2luOwogICAgICAgICR4dD1yb3VuZCgoJHRoaXMtPnNjYWxlLT53b3JsZF9hYnNfc2l6ZSskbWFyZykqY29zKCRhQXhpc0FuZ2xlKSskdGhpcy0+c2NhbGUtPnNjYWxlX2Fic1swXSk7CiAgICAgICAgJHl0PXJvdW5kKCRwb3MtKCR0aGlzLT5zY2FsZS0+d29ybGRfYWJzX3NpemUrJG1hcmcpKnNpbigkYUF4aXNBbmdsZSkpOwoKICAgICAgICAvLyBQb3NpdGlvbiB0aGUgYXhpcyB0aXRsZS4KICAgICAgICAvLyBkeCwgZHkgaXMgdGhlIG9mZnNldCBmcm9tIHRoZSB0b3AgbGVmdCBjb3JuZXIgb2YgdGhlIGJvdW5kaW5nIGJveCB0aGF0IHNvcnJvdW5kcyB0aGUgdGV4dAogICAgICAgIC8vIHRoYXQgaW50ZXJzZWN0cyB3aXRoIHRoZSBleHRlbnNpb24gb2YgdGhlIGNvcnJlc3BvbmRpbmcgYXhpcy4gVGhlIGNvZGUgbG9va3MgYSBsaXR0bGUKICAgICAgICAvLyBiaXQgbWVzc3kgYnV0IHRoaXMgaXMgcmVhbGx5IHRoZSBvbmx5IHdheSBvZiBoYXZpbmcgYSByZWFzb25hYmxlIHBvc2l0aW9uIG9mIHRoZQogICAgICAgIC8vIGF4aXMgdGl0bGVzLgogICAgICAgIGlmKCAkdGhpcy0+dGl0bGUtPmlXb3Jkd3JhcCA+IDAgKSB7CiAgICAgICAgICAgICR0aXRsZSA9IHdvcmR3cmFwKCR0aXRsZSwkdGhpcy0+dGl0bGUtPmlXb3Jkd3JhcCwiXG4iKTsKICAgICAgICB9CgogICAgICAgICRoPSR0aGlzLT5pbWctPkdldFRleHRIZWlnaHQoJHRpdGxlKSoxLjI7CiAgICAgICAgJHc9JHRoaXMtPmltZy0+R2V0VGV4dFdpZHRoKCR0aXRsZSkqMS4yOwoKICAgICAgICB3aGlsZSggJGFBeGlzQW5nbGUgPiAyKk1fUEkgKQogICAgICAgICAgICAkYUF4aXNBbmdsZSAtPSAyKk1fUEk7CgogICAgICAgIC8vIEFyb3VuZCAzIGEnY2xvY2sKICAgICAgICBpZiggJGFBeGlzQW5nbGU+PTcqTV9QSS80IHx8ICRhQXhpc0FuZ2xlIDw9IE1fUEkvNCApICRkeD0tMC4xNTsgLy8gU21hbGwgdHJpbW1pbmcgdG8gbWFrZSB0aGUgZGlzdCB0byB0aGUgYXhpcyBtb3JlIGV2ZW4KCiAgICAgICAgLy8gQXJvdW5kIDEyIGEnY2xvY2sKICAgICAgICBpZiggJGFBeGlzQW5nbGU+PU1fUEkvNCAmJiAkYUF4aXNBbmdsZSA8PSAzKk1fUEkvNCApICRkeD0oJGFBeGlzQW5nbGUtTV9QSS80KSoyL01fUEk7CgogICAgICAgIC8vIEFyb3VuZCA5IGEnY2xvY2sKICAgICAgICBpZiggJGFBeGlzQW5nbGU+PTMqTV9QSS80ICYmICRhQXhpc0FuZ2xlIDw9IDUqTV9QSS80ICkgJGR4PTE7CgogICAgICAgIC8vIEFyb3VuZCA2IGEnY2xvY2sKICAgICAgICBpZiggJGFBeGlzQW5nbGU+PTUqTV9QSS80ICYmICRhQXhpc0FuZ2xlIDw9IDcqTV9QSS80ICkgJGR4PSgxLSgkYUF4aXNBbmdsZS1NX1BJKjUvNCkqMi9NX1BJKTsKCiAgICAgICAgaWYoICRhQXhpc0FuZ2xlPj03Kk1fUEkvNCApICRkeT0oKCRhQXhpc0FuZ2xlLU1fUEkpLTMqTV9QSS80KSoyL01fUEk7CiAgICAgICAgaWYoICRhQXhpc0FuZ2xlPD1NX1BJLzEyICkgJGR5PSgwLjUtJGFBeGlzQW5nbGUqMi9NX1BJKTsKICAgICAgICBpZiggJGFBeGlzQW5nbGU8PU1fUEkvNCAmJiAkYUF4aXNBbmdsZSA+IE1fUEkvMTIpICRkeT0oMS0kYUF4aXNBbmdsZSoyL01fUEkpOwogICAgICAgIGlmKCAkYUF4aXNBbmdsZT49TV9QSS80ICYmICRhQXhpc0FuZ2xlIDw9IDMqTV9QSS80ICkgJGR5PTE7CiAgICAgICAgaWYoICRhQXhpc0FuZ2xlPj0zKk1fUEkvNCAmJiAkYUF4aXNBbmdsZSA8PSA1Kk1fUEkvNCApICRkeT0oMS0oJGFBeGlzQW5nbGUtMypNX1BJLzQpKjIvTV9QSSk7CiAgICAgICAgaWYoICRhQXhpc0FuZ2xlPj01Kk1fUEkvNCAmJiAkYUF4aXNBbmdsZSA8PSA3Kk1fUEkvNCApICRkeT0wOwoKICAgICAgICBpZiggISR0aGlzLT5oaWRlICkgewogICAgICAgICAgICAkdGhpcy0+dGl0bGUtPlN0cm9rZSgkdGhpcy0+aW1nLCR4dC0kZHgqJHcsJHl0LSRkeSokaCwkdGl0bGUpOwogICAgICAgIH0KICAgIH0KCn0gLy8gQ2xhc3MKCgovLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQovLyBDTEFTUyBSYWRhckdyaWQKLy8gRGVzY3JpcHRpb246IERyYXdzIGdyaWQgZm9yIHRoZSByYWRhciBncmFwaAovLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpjbGFzcyBSYWRhckdyaWQgeyAvL2V4dGVuZHMgR3JpZCB7CiAgICBwcml2YXRlICR0eXBlPSdzb2xpZCc7CiAgICBwcml2YXRlICRncmlkX2NvbG9yPScjREREREREJzsKICAgIHByaXZhdGUgJHNob3c9ZmFsc2UsICR3ZWlnaHQ9MTsKCiAgICBmdW5jdGlvbiBfX2NvbnN0cnVjdCgpIHsKICAgICAgICAvLyBFbXB0eQogICAgfQoKICAgIGZ1bmN0aW9uIFNldENvbG9yKCRhTWFqQ29sb3IpIHsKICAgICAgICAkdGhpcy0+Z3JpZF9jb2xvciA9ICRhTWFqQ29sb3I7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0V2VpZ2h0KCRhV2VpZ2h0KSB7CiAgICAgICAgJHRoaXMtPndlaWdodD0kYVdlaWdodDsKICAgIH0KCiAgICAvLyBTcGVjaWZ5IGlmIGdyaWQgc2hvdWxkIGJlIGRhc2hlZCwgZG90dGVkIG9yIHNvbGlkCiAgICBmdW5jdGlvbiBTZXRMaW5lU3R5bGUoJGFUeXBlKSB7CiAgICAgICAgJHRoaXMtPnR5cGUgPSAkYVR5cGU7CiAgICB9CgogICAgLy8gRGVjaWRlIGlmIGJvdGggbWFqb3IgYW5kIG1pbm9yIGdyaWQgc2hvdWxkIGJlIGRpc3BsYXllZAogICAgZnVuY3Rpb24gU2hvdygkYVNob3dNYWpvcj10cnVlKSB7CiAgICAgICAgJHRoaXMtPnNob3c9JGFTaG93TWFqb3I7CiAgICB9CgogICAgZnVuY3Rpb24gU3Ryb2tlKCRpbWcsJGdyaWQpIHsKICAgICAgICBpZiggISR0aGlzLT5zaG93ICkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICAkbmJydGlja3MgPSBjb3VudCgkZ3JpZFswXSkvMjsKICAgICAgICAkbmJycG50cyA9IGNvdW50KCRncmlkKTsKICAgICAgICAkaW1nLT5TZXRDb2xvcigkdGhpcy0+Z3JpZF9jb2xvcik7CiAgICAgICAgJGltZy0+U2V0TGluZVdlaWdodCgkdGhpcy0+d2VpZ2h0KTsKCiAgICAgICAgZm9yKCRpPTA7ICRpPCRuYnJ0aWNrczsgKyskaSkgewogICAgICAgICAgICBmb3IoJGo9MDsgJGo8JG5icnBudHM7ICsrJGopIHsKICAgICAgICAgICAgICAgICRwbnRzWyRqKjJdPSRncmlkWyRqXVskaSoyXTsKICAgICAgICAgICAgICAgICRwbnRzWyRqKjIrMV09JGdyaWRbJGpdWyRpKjIrMV07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZm9yKCRrPTA7ICRrPCRuYnJwbnRzOyArKyRrICl7CiAgICAgICAgICAgICAgICAkbD0oJGsrMSklJG5icnBudHM7CiAgICAgICAgICAgICAgICBpZiggJHRoaXMtPnR5cGUgPT0gJ3NvbGlkJyApCiAgICAgICAgICAgICAgICAgICAgJGltZy0+TGluZSgkcG50c1skayoyXSwkcG50c1skayoyKzFdLCRwbnRzWyRsKjJdLCRwbnRzWyRsKjIrMV0pOwogICAgICAgICAgICAgICAgZWxzZWlmKCAkdGhpcy0+dHlwZSA9PSAnZG90dGVkJyApCiAgICAgICAgICAgICAgICAgICAgJGltZy0+RGFzaGVkTGluZSgkcG50c1skayoyXSwkcG50c1skayoyKzFdLCRwbnRzWyRsKjJdLCRwbnRzWyRsKjIrMV0sMSw2KTsKICAgICAgICAgICAgICAgIGVsc2VpZiggJHRoaXMtPnR5cGUgPT0gJ2Rhc2hlZCcgKQogICAgICAgICAgICAgICAgICAgICRpbWctPkRhc2hlZExpbmUoJHBudHNbJGsqMl0sJHBudHNbJGsqMisxXSwkcG50c1skbCoyXSwkcG50c1skbCoyKzFdLDIsNCk7CiAgICAgICAgICAgICAgICBlbHNlaWYoICR0aGlzLT50eXBlID09ICdsb25nZGFzaGVkJyApCiAgICAgICAgICAgICAgICAgICAgJGltZy0+RGFzaGVkTGluZSgkcG50c1skayoyXSwkcG50c1skayoyKzFdLCRwbnRzWyRsKjJdLCRwbnRzWyRsKjIrMV0sOCw2KTsKICAgICAgICAgICAgfQogICAgICAgICAgICAkcG50cz1hcnJheSgpOwogICAgICAgIH0KICAgIH0KfSAvLyBDbGFzcwoKCi8vPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci8vIENMQVNTIFJhZGFyUGxvdAovLyBEZXNjcmlwdGlvbjogUGxvdCBhIHJhZGFycGxvdAovLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpjbGFzcyBSYWRhclBsb3QgewogICAgcHVibGljICRtYXJrPW51bGw7CiAgICBwdWJsaWMgJGxlZ2VuZD0nJzsKICAgIHB1YmxpYyAkbGVnZW5kY3NpbXRhcmdldD0nJzsKICAgIHB1YmxpYyAkbGVnZW5kY3NpbWFsdD0nJzsKICAgIHB1YmxpYyAkY3NpbXRhcmdldHM9YXJyYXkoKTsgLy8gQXJyYXkgb2YgdGFyZ2V0cyBmb3IgQ1NJTQogICAgcHVibGljICRjc2ltYXJlYXM9IiI7ICAgLy8gUmVzdWx0YW50IENTSU0gYXJlYSB0YWdzCiAgICBwdWJsaWMgJGNzaW1hbHRzPW51bGw7ICAgLy8gQUxUOnMgZm9yIGNvcnJlc3BvbmRpbmcgdGFyZ2V0CiAgICBwcml2YXRlICRkYXRhPWFycmF5KCk7CiAgICBwcml2YXRlICRmaWxsPWZhbHNlLCAkZmlsbF9jb2xvcj1hcnJheSgyMDAsMTcwLDE4MCk7CiAgICBwcml2YXRlICRjb2xvcj1hcnJheSgwLDAsMCk7CiAgICBwcml2YXRlICR3ZWlnaHQ9MTsKICAgIHByaXZhdGUgJGxpbmVzdHlsZT0nc29saWQnOwoKICAgIC8vLS0tLS0tLS0tLS0tLS0tCiAgICAvLyBDT05TVFJVQ1RPUgogICAgZnVuY3Rpb24gX19jb25zdHJ1Y3QoJGRhdGEpIHsKICAgICAgICAkdGhpcy0+ZGF0YSA9ICRkYXRhOwogICAgICAgICR0aGlzLT5tYXJrID0gbmV3IFBsb3RNYXJrKCk7CiAgICB9CgogICAgZnVuY3Rpb24gTWluKCkgewogICAgICAgIHJldHVybiBNaW4oJHRoaXMtPmRhdGEpOwogICAgfQoKICAgIGZ1bmN0aW9uIE1heCgpIHsKICAgICAgICByZXR1cm4gTWF4KCR0aGlzLT5kYXRhKTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRMZWdlbmQoJGxlZ2VuZCkgewogICAgICAgICR0aGlzLT5sZWdlbmQ9JGxlZ2VuZDsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRMaW5lU3R5bGUoJGFTdHlsZSkgewogICAgICAgICR0aGlzLT5saW5lc3R5bGU9JGFTdHlsZTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRMaW5lV2VpZ2h0KCR3KSB7CiAgICAgICAgJHRoaXMtPndlaWdodD0kdzsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRGaWxsQ29sb3IoJGFDb2xvcikgewogICAgICAgICR0aGlzLT5maWxsX2NvbG9yID0gJGFDb2xvcjsKICAgICAgICAkdGhpcy0+ZmlsbCA9IHRydWU7CiAgICB9CgogICAgZnVuY3Rpb24gU2V0RmlsbCgkZj10cnVlKSB7CiAgICAgICAgJHRoaXMtPmZpbGwgPSAkZjsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRDb2xvcigkYUNvbG9yLCRhRmlsbENvbG9yPWZhbHNlKSB7CiAgICAgICAgJHRoaXMtPmNvbG9yID0gJGFDb2xvcjsKICAgICAgICBpZiggJGFGaWxsQ29sb3IgKSB7CiAgICAgICAgICAgICR0aGlzLT5TZXRGaWxsQ29sb3IoJGFGaWxsQ29sb3IpOwogICAgICAgICAgICAkdGhpcy0+ZmlsbCA9IHRydWU7CiAgICAgICAgfQogICAgfQoKICAgIC8vIFNldCBocmVmIHRhcmdldHMgZm9yIENTSU0KICAgIGZ1bmN0aW9uIFNldENTSU1UYXJnZXRzKCRhVGFyZ2V0cywkYUFsdHM9bnVsbCkgewogICAgICAgICR0aGlzLT5jc2ltdGFyZ2V0cz0kYVRhcmdldHM7CiAgICAgICAgJHRoaXMtPmNzaW1hbHRzPSRhQWx0czsKICAgIH0KCiAgICAvLyBHZXQgYWxsIGNyZWF0ZWQgYXJlYXMKICAgIGZ1bmN0aW9uIEdldENTSU1hcmVhcygpIHsKICAgICAgICByZXR1cm4gJHRoaXMtPmNzaW1hcmVhczsKICAgIH0KCiAgICBmdW5jdGlvbiBTdHJva2UoJGltZywgJHBvcywgJHNjYWxlLCAkc3RhcnRhbmdsZSkgewogICAgICAgICRuYnJwbnRzID0gY291bnQoJHRoaXMtPmRhdGEpOwogICAgICAgICRhc3RlcD0yKk1fUEkvJG5icnBudHM7CiAgICAgICAgJGE9JHN0YXJ0YW5nbGU7CgogICAgICAgIGZvcigkaT0wOyAkaTwkbmJycG50czsgKyskaSkgewoKICAgICAgICAgICAgLy8gUm90YXRlIGVhY2ggbm9uIG51bGwgcG9pbnQgdG8gdGhlIGNvcnJlY3QgYXhpcy1hbmdsZQogICAgICAgICAgICAkY3M9JHNjYWxlLT5SZWxUcmFuc2xhdGUoJHRoaXMtPmRhdGFbJGldKTsKICAgICAgICAgICAgJHg9cm91bmQoJGNzKmNvcygkYSkrJHNjYWxlLT5zY2FsZV9hYnNbMF0pOwogICAgICAgICAgICAkeT1yb3VuZCgkcG9zLSRjcypzaW4oJGEpKTsKCiAgICAgICAgICAgICRwbnRzWyRpKjJdPSR4OwogICAgICAgICAgICAkcG50c1skaSoyKzFdPSR5OwoKICAgICAgICAgICAgLy8gSWYgdGhlIG5leHQgcG9pbnQgaXMgbnVsbCB0aGVuIHdlIGRyYXcgdGhpcyBwb2x5Z29uIHNlZ21lbnQKICAgICAgICAgICAgLy8gdG8gdGhlIGNlbnRlciwgc2tpcCB0aGUgbmV4dCBhbmQgZHJhdyB0aGUgbmV4dCBzZWdtZW50IGZyb20KICAgICAgICAgICAgLy8gdGhlIGNlbnRlciB1cCB0byB0aGUgcG9pbnQgb24gdGhlIGF4aXMgd2l0aCB0aGUgZmlyc3Qgbm9uLW51bGwKICAgICAgICAgICAgLy8gdmFsdWUgYW5kIGNvbnRpbnVlcyBmcm9tIHRoYXQgcG9pbnQuIFNvbWUgYWRkaXRvaW5hbCBsb2dpYyBpcyBuZWNlc3NhcnkKICAgICAgICAgICAgLy8gdG8gaGFuZGxlIHRoZSBib3VuZGFyeSBjb25kaXRpb25zCiAgICAgICAgICAgIGlmKCAkaSA8ICRuYnJwbnRzLTEgKSB7CiAgICAgICAgICAgICAgICBpZiggaXNfbnVsbCgkdGhpcy0+ZGF0YVskaSsxXSkgKSB7CiAgICAgICAgICAgICAgICAgICAgJGNzID0gMDsKICAgICAgICAgICAgICAgICAgICAkeD1yb3VuZCgkY3MqY29zKCRhKSskc2NhbGUtPnNjYWxlX2Fic1swXSk7CiAgICAgICAgICAgICAgICAgICAgJHk9cm91bmQoJHBvcy0kY3Mqc2luKCRhKSk7CiAgICAgICAgICAgICAgICAgICAgJHBudHNbJGkqMl09JHg7CiAgICAgICAgICAgICAgICAgICAgJHBudHNbJGkqMisxXT0keTsKICAgICAgICAgICAgICAgICAgICAkYSArPSAkYXN0ZXA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRhICs9ICRhc3RlcDsKICAgICAgICB9CgogICAgICAgIGlmKCAkdGhpcy0+ZmlsbCApIHsKICAgICAgICAgICAgJGltZy0+U2V0Q29sb3IoJHRoaXMtPmZpbGxfY29sb3IpOwogICAgICAgICAgICAkaW1nLT5GaWxsZWRQb2x5Z29uKCRwbnRzKTsKICAgICAgICB9CgogICAgICAgICRpbWctPlNldExpbmVXZWlnaHQoJHRoaXMtPndlaWdodCk7CiAgICAgICAgJGltZy0+U2V0Q29sb3IoJHRoaXMtPmNvbG9yKTsKICAgICAgICAkaW1nLT5TZXRMaW5lU3R5bGUoJHRoaXMtPmxpbmVzdHlsZSk7CiAgICAgICAgJHBudHNbXSA9ICRwbnRzWzBdOwogICAgICAgICRwbnRzW10gPSAkcG50c1sxXTsKICAgICAgICAkaW1nLT5Qb2x5Z29uKCRwbnRzKTsKICAgICAgICAkaW1nLT5TZXRMaW5lU3R5bGUoJ3NvbGlkJyk7IC8vIFJlc2V0IGxpbmUgc3R5bGUgdG8gZGVmYXVsdAoKICAgICAgICAvLyBBZGQgcGxvdG1hcmtzIG9uIHRvcAogICAgICAgIGlmKCAkdGhpcy0+bWFyay0+c2hvdyApIHsKCQkJZm9yKCRpPTA7ICRpIDwgJG5icnBudHM7ICsrJGkpIHsKCSAgICAgICAgICAgIGlmKCBpc3NldCgkdGhpcy0+Y3NpbXRhcmdldHNbJGldKSApIHsKCSAgICAgICAgICAgICAgICAkdGhpcy0+bWFyay0+U2V0Q1NJTVRhcmdldCgkdGhpcy0+Y3NpbXRhcmdldHNbJGldKTsKCSAgICAgICAgICAgICAgICAkdGhpcy0+bWFyay0+U2V0Q1NJTUFsdCgkdGhpcy0+Y3NpbWFsdHNbJGldKTsKCSAgICAgICAgICAgICAgICAkdGhpcy0+bWFyay0+U2V0Q1NJTUFsdFZhbCgkcG50c1skaSoyXSwgJHBudHNbJGkqMisxXSk7CgkgICAgICAgICAgICAgICAgJHRoaXMtPm1hcmstPlN0cm9rZSgkaW1nLCAkcG50c1skaSoyXSwgJHBudHNbJGkqMisxXSk7CgkgICAgICAgICAgICAgICAgJHRoaXMtPmNzaW1hcmVhcyAuPSAkdGhpcy0+bWFyay0+R2V0Q1NJTUFyZWFzKCk7CgkgICAgICAgICAgICB9CgkgICAgICAgICAgICBlbHNlIHsKCQkJCQkkdGhpcy0+bWFyay0+U3Ryb2tlKCRpbWcsJHBudHNbJGkqMl0sJHBudHNbJGkqMisxXSk7CgkgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgfQoKICAgIGZ1bmN0aW9uIEdldENvdW50KCkgewogICAgICAgIHJldHVybiBjb3VudCgkdGhpcy0+ZGF0YSk7CiAgICB9CgogICAgZnVuY3Rpb24gTGVnZW5kKCRncmFwaCkgewogICAgICAgIGlmKCAkdGhpcy0+bGVnZW5kID09ICcnICkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmKCAkdGhpcy0+ZmlsbCApIHsKICAgICAgICAgICAgJGdyYXBoLT5sZWdlbmQtPkFkZCgkdGhpcy0+bGVnZW5kLCR0aGlzLT5maWxsX2NvbG9yLCR0aGlzLT5tYXJrKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkZ3JhcGgtPmxlZ2VuZC0+QWRkKCR0aGlzLT5sZWdlbmQsJHRoaXMtPmNvbG9yLCR0aGlzLT5tYXJrKTsKICAgICAgICB9CiAgICB9Cgp9IC8vIENsYXNzCgovLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQovLyBDTEFTUyBSYWRhckdyYXBoCi8vIERlc2NyaXB0aW9uOiBNYWluIGNvbnRhaW5lciBmb3IgYSByYWRhciBncmFwaAovLz09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpjbGFzcyBSYWRhckdyYXBoIGV4dGVuZHMgR3JhcGggewogICAgcHVibGljICRncmlkLCRheGlzPW51bGw7CiAgICBwcml2YXRlICRwb3N4LCRwb3N5OwogICAgcHJpdmF0ZSAkbGVuOwogICAgcHJpdmF0ZSAkYXhpc190aXRsZT1udWxsOwoKICAgIGZ1bmN0aW9uIF9fY29uc3RydWN0KCR3aWR0aD0zMDAsJGhlaWdodD0yMDAsJGNhY2hlZE5hbWU9IiIsJHRpbWVvdXQ9MCwkaW5saW5lPTEpIHsKICAgICAgICBwYXJlbnQ6Ol9fY29uc3RydWN0KCR3aWR0aCwkaGVpZ2h0LCRjYWNoZWROYW1lLCR0aW1lb3V0LCRpbmxpbmUpOwogICAgICAgICR0aGlzLT5wb3N4ID0gJHdpZHRoLzI7CiAgICAgICAgJHRoaXMtPnBvc3kgPSAkaGVpZ2h0LzI7CiAgICAgICAgJHRoaXMtPmxlbiA9IG1pbigkd2lkdGgsJGhlaWdodCkqMC4zNTsKICAgICAgICAkdGhpcy0+U2V0Q29sb3IoYXJyYXkoMjU1LDI1NSwyNTUpKTsKICAgICAgICAkdGhpcy0+U2V0VGlja0RlbnNpdHkoVElDS0RfTk9STUFMKTsKICAgICAgICAkdGhpcy0+U2V0U2NhbGUoJ2xpbicpOwogICAgICAgICR0aGlzLT5TZXRHcmlkRGVwdGgoREVQVEhfRlJPTlQpOwogICAgfQoKICAgIGZ1bmN0aW9uIEhpZGVUaWNrTWFya3MoJGFGbGFnPXRydWUpIHsKICAgICAgICAkdGhpcy0+YXhpcy0+c2NhbGUtPnRpY2tzLT5TdXByZXNzVGlja01hcmtzKCRhRmxhZyk7CiAgICB9CgogICAgZnVuY3Rpb24gU2hvd01pbm9yVGlja21hcmtzKCRhRmxhZz10cnVlKSB7CiAgICAgICAgJHRoaXMtPnlzY2FsZS0+dGlja3MtPlN1cHJlc3NNaW5vclRpY2tNYXJrcyghJGFGbGFnKTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRTY2FsZSgkYXh0eXBlLCR5bWluPTEsJHltYXg9MSwkZHVtbXkxPW51bGwsJGR1bXkyPW51bGwpIHsKICAgICAgICBpZiggJGF4dHlwZSAhPSAnbGluJyAmJiAkYXh0eXBlICE9ICdsb2cnICkgewogICAgICAgICAgICBKcEdyYXBoRXJyb3I6OlJhaXNlTCgxODAwMywkYXh0eXBlKTsKICAgICAgICAgICAgLy8oIklsbGVnYWwgc2NhbGUgZm9yIHJhZGFycGxvdCAoJGF4dHlwZSkuIE11c3QgYmUgXCJsaW5cIiBvciBcImxvZ1wiIik7CiAgICAgICAgfQogICAgICAgIGlmKCAkYXh0eXBlID09ICdsaW4nICkgewogICAgICAgICAgICAkdGhpcy0+eXNjYWxlID0gbmV3IExpbmVhclNjYWxlKCR5bWluLCR5bWF4KTsKICAgICAgICAgICAgJHRoaXMtPnlzY2FsZS0+dGlja3MgPSBuZXcgUmFkYXJMaW5lYXJUaWNrcygpOwogICAgICAgICAgICAkdGhpcy0+eXNjYWxlLT50aWNrcy0+U3VwcmVzc01pbm9yVGlja01hcmtzKCk7CiAgICAgICAgfQogICAgICAgIGVsc2VpZiggJGF4dHlwZSA9PSAnbG9nJyApIHsKICAgICAgICAgICAgJHRoaXMtPnlzY2FsZSA9IG5ldyBMb2dTY2FsZSgkeW1pbiwkeW1heCk7CiAgICAgICAgICAgICR0aGlzLT55c2NhbGUtPnRpY2tzID0gbmV3IFJhZGFyTG9nVGlja3MoKTsKICAgICAgICB9CgogICAgICAgICR0aGlzLT5heGlzID0gbmV3IFJhZGFyQXhpcygkdGhpcy0+aW1nLCR0aGlzLT55c2NhbGUpOwogICAgICAgICR0aGlzLT5ncmlkID0gbmV3IFJhZGFyR3JpZCgpOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldFNpemUoJGFTaXplKSB7CiAgICAgICAgaWYoICRhU2l6ZSA8IDAuMSB8fCAkYVNpemU+MSApIHsKICAgICAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoMTgwMDQsJGFTaXplKTsKICAgICAgICAgICAgLy8oIlJhZGFyIFBsb3Qgc2l6ZSBtdXN0IGJlIGJldHdlZW4gMC4xIGFuZCAxLiAoWW91ciB2YWx1ZT0kcykiKTsKICAgICAgICB9CiAgICAgICAgJHRoaXMtPmxlbj1taW4oJHRoaXMtPmltZy0+d2lkdGgsJHRoaXMtPmltZy0+aGVpZ2h0KSokYVNpemUvMjsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRQbG90U2l6ZSgkYVNpemUpIHsKICAgICAgICAkdGhpcy0+U2V0U2l6ZSgkYVNpemUpOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldFRpY2tEZW5zaXR5KCRkZW5zeT1USUNLRF9OT1JNQUwsJGR1bW15MT1udWxsKSB7CiAgICAgICAgJHRoaXMtPnl0aWNrX2ZhY3Rvcj0yNTsKICAgICAgICBzd2l0Y2goICRkZW5zeSApIHsKICAgICAgICAgICAgY2FzZSBUSUNLRF9ERU5TRToKICAgICAgICAgICAgICAgICR0aGlzLT55dGlja19mYWN0b3I9MTI7CiAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSBUSUNLRF9OT1JNQUw6CiAgICAgICAgICAgICAgICAkdGhpcy0+eXRpY2tfZmFjdG9yPTI1OwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgVElDS0RfU1BBUlNFOgogICAgICAgICAgICAgICAgJHRoaXMtPnl0aWNrX2ZhY3Rvcj00MDsKICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICBjYXNlIFRJQ0tEX1ZFUllTUEFSU0U6CiAgICAgICAgICAgICAgICAkdGhpcy0+eXRpY2tfZmFjdG9yPTcwOwogICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgICBKcEdyYXBoRXJyb3I6OlJhaXNlTCgxODAwNSwkZGVuc3kpOwogICAgICAgICAgICAgICAgLy8oIlJhZGFyUGxvdCBVbnN1cHBvcnRlZCBUaWNrIGRlbnNpdHk6ICRkZW5zeSIpOwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBTZXRQb3MoJHB4LCRweT0wLjUpIHsKICAgICAgICAkdGhpcy0+U2V0Q2VudGVyKCRweCwkcHkpOwogICAgfQoKICAgIGZ1bmN0aW9uIFNldENlbnRlcigkcHgsJHB5PTAuNSkgewogICAgICAgIGlmKCAkcHggPj0gMCAmJiAkcHggPD0gMSApIHsKICAgICAgICAJJHRoaXMtPnBvc3ggPSAkdGhpcy0+aW1nLT53aWR0aCokcHg7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgIAkkdGhpcy0+cG9zeCA9ICRweDsKICAgICAgICB9CiAgICAgICAgaWYoICRweSA+PSAwICYmICRweSA8PSAxICkgewogICAgICAgIAkkdGhpcy0+cG9zeSA9ICR0aGlzLT5pbWctPmhlaWdodCokcHk7CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgIAkkdGhpcy0+cG9zeSA9ICRweTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gU2V0Q29sb3IoJGFDb2xvcikgewogICAgICAgICR0aGlzLT5TZXRNYXJnaW5Db2xvcigkYUNvbG9yKTsKICAgIH0KCiAgICBmdW5jdGlvbiBTZXRUaXRsZXMoJGFUaXRsZUFycmF5KSB7CiAgICAgICAgJHRoaXMtPmF4aXNfdGl0bGUgPSAkYVRpdGxlQXJyYXk7CiAgICB9CgogICAgZnVuY3Rpb24gQWRkKCRhUGxvdCkgewogICAgCWlmKCAkYVBsb3QgPT0gbnVsbCApIHsKICAgICAgICAgICAgSnBHcmFwaEVycm9yOjpSYWlzZUwoMjUwMTApOy8vKCJHcmFwaDo6QWRkKCkgWW91IHRyaWVkIHRvIGFkZCBhIG51bGwgcGxvdCB0byB0aGUgZ3JhcGguIik7CiAgICAgICAgfQogICAgICAgIGlmKCBpc19hcnJheSgkYVBsb3QpICYmIGNvdW50KCRhUGxvdCkgPiAwICkgewogICAgICAgICAgICAkY2wgPSAkYVBsb3RbMF07CiAgICAgICAgfQogICAgICAgIGVsc2UgewogICAgICAgICAgICAkY2wgPSAkYVBsb3Q7CiAgICAgICAgfQoKICAgICAgICBpZiggJGNsIGluc3RhbmNlb2YgVGV4dCApICR0aGlzLT5BZGRUZXh0KCRhUGxvdCk7CiAgICAgICAgZWxzZWlmKCBjbGFzc19leGlzdHMoJ0ljb25QbG90JyxmYWxzZSkgJiYgKCRjbCBpbnN0YW5jZW9mIEljb25QbG90KSApICR0aGlzLT5BZGRJY29uKCRhUGxvdCk7CiAgICAgICAgZWxzZSB7CiAgICAgICAgICAgICR0aGlzLT5wbG90c1tdID0gJGFQbG90OwogICAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBHZXRQbG90c1lNaW5NYXgoJGFQbG90cykgewogICAgICAgICRtaW49JGFQbG90c1swXS0+TWluKCk7CiAgICAgICAgJG1heD0kYVBsb3RzWzBdLT5NYXgoKTsKICAgICAgICBmb3JlYWNoKCAkdGhpcy0+cGxvdHMgYXMgJHAgKSB7CiAgICAgICAgICAgICRtYXg9bWF4KCRtYXgsJHAtPk1heCgpKTsKICAgICAgICAgICAgJG1pbj1taW4oJG1pbiwkcC0+TWluKCkpOwogICAgICAgIH0KICAgICAgICBpZiggJG1pbiA8IDAgKSB7CiAgICAgICAgICAgIEpwR3JhcGhFcnJvcjo6UmFpc2VMKDE4MDA2LCRtaW4pOwogICAgICAgICAgICAvLygiTWluaW11bSBkYXRhICRtaW4gKFJhZGFyIHBsb3RzIHNob3VsZCBvbmx5IGJlIHVzZWQgd2hlbiBhbGwgZGF0YSBwb2ludHMgPiAwKSIpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gYXJyYXkoJG1pbiwkbWF4KTsKICAgIH0KCiAgICBmdW5jdGlvbiBTdHJva2VJY29ucygpIHsKICAgIAlpZiggJHRoaXMtPmlJY29ucyAhPSBudWxsICkgewogICAgICAgIAkkbiA9IGNvdW50KCR0aGlzLT5pSWNvbnMpOwogICAgICAgIAlmb3IoICRpPTA7ICRpIDwgJG47ICsrJGkgKSB7CiAgICAgICAgICAgIAkkdGhpcy0+aUljb25zWyRpXS0+U3Ryb2tlKCR0aGlzLT5pbWcpOwogICAgICAgIAl9CiAgICAJfQogICAgfQoKCWZ1bmN0aW9uIFN0cm9rZVRleHRzKCkgewogICAgICAgIGlmKCAkdGhpcy0+dGV4dHMgIT0gbnVsbCApIHsKCQkJJG4gPSBjb3VudCgkdGhpcy0+dGV4dHMpOwogICAgICAgICAgICBmb3IoICRpPTA7ICRpIDwgJG47ICsrJGkgKSB7CiAgICAgICAgICAgICAgICAkdGhpcy0+dGV4dHNbJGldLT5TdHJva2UoJHRoaXMtPmltZyk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLy8gU3Ryb2tlIHRoZSBSYWRhciBncmFwaAogICAgZnVuY3Rpb24gU3Ryb2tlKCRhU3Ryb2tlRmlsZU5hbWU9JycpIHsKCiAgICAgICAgLy8gSWYgdGhlIGZpbGVuYW1lIGlzIHRoZSBwcmVkZWZpbmVkIHZhbHVlID0gJ19jc2ltX3NwZWNpYWxfJwogICAgICAgIC8vIHdlIGFzc3VtZSB0aGF0IHRoZSBjYWxsIHRvIHN0cm9rZSBvbmx5IG5lZWRzIHRvIGRvIGVub3VnaAogICAgICAgIC8vIHRvIGNvcnJlY3RseSBnZW5lcmF0ZSB0aGUgQ1NJTSBtYXBzLgogICAgICAgIC8vIFdlIHVzZSB0aGlzIHZhcmlhYmxlIHRvIHNraXAgdGhpbmdzIHdlIGRvbid0IHN0cmljdGx5IG5lZWQKICAgICAgICAvLyB0byBkbyB0byBnZW5lcmF0ZSB0aGUgaW1hZ2UgbWFwIHRvIGltcHJvdmUgcGVyZm9ybWFuY2UKICAgICAgICAvLyBhIGJlc3Qgd2UgY2FuLiBUaGVyZWZvciB5b3Ugd2lsbCBzZWUgYSBsb3Qgb2YgdGVzdHMgISRfY3NpbSBpbiB0aGUKICAgICAgICAvLyBjb2RlIGJlbG93LgogICAgICAgICRfY3NpbSA9ICggJGFTdHJva2VGaWxlTmFtZSA9PT0gX0NTSU1fU1BFQ0lBTEZJTEUgKTsKCiAgICAgICAgLy8gV2UgbmVlZCB0byBrbm93IGlmIHdlIGhhdmUgc3Ryb2tlZCB0aGUgcGxvdCBpbiB0aGUKICAgICAgICAvLyBHZXRDU0lNYXJlYXMuIE90aGVyd2lzZSB0aGUgQ1NJTSBoYXNuJ3QgYmVlbiBnZW5lcmF0ZWQKICAgICAgICAvLyBhbmQgaW4gdGhlIGNhc2Ugb2YgR2V0Q1NJTSBjYWxsZWQgYmVmb3JlIHN0cm9rZSB0byBnZW5lcmF0ZQogICAgICAgIC8vIENTSU0gd2l0aG91dCBzdG9yaW5nIGFuIGltYWdlIHRvIGRpc2sgR2V0Q1NJTSBtdXN0IGNhbGwgU3Ryb2tlLgogICAgICAgICR0aGlzLT5pSGFzU3Ryb2tlZCA9IHRydWU7CgogICAgICAgICRuID0gY291bnQoJHRoaXMtPnBsb3RzKTsKICAgICAgICAvLyBTZXQgWS1zY2FsZQoKICAgICAgICBpZiggISR0aGlzLT55c2NhbGUtPklzU3BlY2lmaWVkKCkgJiYgY291bnQoJHRoaXMtPnBsb3RzKSA+IDAgKSB7CiAgICAgICAgICAgIGxpc3QoJG1pbiwkbWF4KSA9ICR0aGlzLT5HZXRQbG90c1lNaW5NYXgoJHRoaXMtPnBsb3RzKTsKICAgICAgICAgICAgJHRoaXMtPnlzY2FsZS0+QXV0b1NjYWxlKCR0aGlzLT5pbWcsMCwkbWF4LCR0aGlzLT5sZW4vJHRoaXMtPnl0aWNrX2ZhY3Rvcik7CiAgICAgICAgfQogICAgICAgIGVsc2VpZiggJHRoaXMtPnlzY2FsZS0+SXNTcGVjaWZpZWQoKSAmJgogICAgICAgICAgICAgICAgKCAkdGhpcy0+eXNjYWxlLT5hdXRvX3RpY2tzIHx8ICEkdGhpcy0+eXNjYWxlLT50aWNrcy0+SXNTcGVjaWZpZWQoKSkgKSB7CgogICAgICAgICAgICAvLyBUaGUgdGljayBjYWxjdWxhdGlvbiB3aWxsIHVzZSB0aGUgdXNlciBzdXBsaWVkIG1pbi9tYXggdmFsdWVzIHRvIGRldGVybWluZQogICAgICAgICAgICAvLyB0aGUgdGlja3MuIElmIGF1dG9fdGlja3MgaXMgZmFsc2UgdGhlIGV4YWN0IHVzZXIgc3BlY2lmZWQgbWluIGFuZCBtYXgKICAgICAgICAgICAgLy8gdmFsdWVzIHdpbGwgYmUgdXNlZCBmb3IgdGhlIHNjYWxlLgogICAgICAgICAgICAvLyBJZiBhdXRvX3RpY2tzIGlzIHRydWUgdGhlbiB0aGUgc2NhbGUgbWlnaHQgYmUgc2xpZ2h0bHkgYWRqdXN0ZWQKICAgICAgICAgICAgLy8gc28gdGhhdCB0aGUgbWluIGFuZCBtYXggdmFsdWVzIGZhbGxzIG9uIGFuIGV2ZW4gbWFqb3Igc3RlcC4KICAgICAgICAgICAgJG1pbiA9ICR0aGlzLT55c2NhbGUtPnNjYWxlWzBdOwogICAgICAgICAgICAkbWF4ID0gJHRoaXMtPnlzY2FsZS0+c2NhbGVbMV07CiAgICAgICAgICAgICR0aGlzLT55c2NhbGUtPkF1dG9TY2FsZSgkdGhpcy0+aW1nLCRtaW4sJG1heCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT5sZW4vJHRoaXMtPnl0aWNrX2ZhY3RvciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLT55c2NhbGUtPmF1dG9fdGlja3MpOwogICAgICAgIH0KCiAgICAgICAgLy8gU2V0IHN0YXJ0IHBvc2l0aW9uIGVuZCBsZW5ndGggb2Ygc2NhbGUgKGluIGFic29sdXRlIHBpeGVscykKICAgICAgICAkdGhpcy0+eXNjYWxlLT5TZXRDb25zdGFudHMoJHRoaXMtPnBvc3gsJHRoaXMtPmxlbik7CgogICAgICAgIC8vIFdlIG5lZWQgYXMgbWFueSBheGlzIGFzIHRoZXJlIGFyZSBkYXRhIHBvaW50cwogICAgICAgICRuYnJwbnRzPSR0aGlzLT5wbG90c1swXS0+R2V0Q291bnQoKTsKCiAgICAgICAgLy8gSWYgd2UgaGF2ZSBubyB0aXRsZXMganVzdCBudW1iZXIgdGhlIGF4aXMgMSwyLDMsLi4uCiAgICAgICAgaWYoICR0aGlzLT5heGlzX3RpdGxlPT1udWxsICkgewogICAgICAgICAgICBmb3IoJGk9MDsgJGkgPCAkbmJycG50czsgKyskaSApIHsKICAgICAgICAgICAgICAgICR0aGlzLT5heGlzX3RpdGxlWyRpXSA9ICRpKzE7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgZWxzZWlmKCBjb3VudCgkdGhpcy0+YXhpc190aXRsZSkgPCAkbmJycG50cykgewogICAgICAgICAgICBKcEdyYXBoRXJyb3I6OlJhaXNlTCgxODAwNyk7CiAgICAgICAgICAgIC8vICgiTnVtYmVyIG9mIHRpdGxlcyBkb2VzIG5vdCBtYXRjaCBudW1iZXIgb2YgcG9pbnRzIGluIHBsb3QuIik7CiAgICAgICAgfQogICAgICAgIGZvciggJGk9MDsgJGkgPCAkbjsgKyskaSApIHsKICAgICAgICAgICAgaWYoICRuYnJwbnRzICE9ICR0aGlzLT5wbG90c1skaV0tPkdldENvdW50KCkgKSB7CiAgICAgICAgICAgICAgICBKcEdyYXBoRXJyb3I6OlJhaXNlTCgxODAwOCk7CiAgICAgICAgICAgICAgICAvLygiRWFjaCByYWRhciBwbG90IG11c3QgaGF2ZSB0aGUgc2FtZSBudW1iZXIgb2YgZGF0YSBwb2ludHMuIik7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmKCAhJF9jc2ltICkgewogICAgICAgIAlpZiggJHRoaXMtPmJhY2tncm91bmRfaW1hZ2UgIT0gJycgKSB7CiAgICAgICAgICAgIAkkdGhpcy0+U3Ryb2tlRnJhbWVCYWNrZ3JvdW5kKCk7CiAgICAgICAgCX0KICAgICAgICAJZWxzZSB7CiAgICAgICAgICAgIAkkdGhpcy0+U3Ryb2tlRnJhbWUoKTsKICAgICAgICAgICAgCSR0aGlzLT5TdHJva2VCYWNrZ3JvdW5kR3JhZCgpOwogICAgICAgIAl9CiAgICAgICAgfQogICAgICAgICRhc3RlcD0yKk1fUEkvJG5icnBudHM7CgoJCWlmKCAhJF9jc2ltICkgewogICAgIAkJaWYoICR0aGlzLT5pSWNvbkRlcHRoID09IERFUFRIX0JBQ0sgKSB7CiAgICAgICAgCQkkdGhpcy0+U3Ryb2tlSWNvbnMoKTsKICAgICAgICAJfQoKCgkgICAgICAgIC8vIFByZXBhcmUgbGVnZW5kcwogICAgCSAgICBmb3IoJGk9MDsgJGkgPCAkbjsgKyskaSkgewogICAgICAgIAkgICAgJHRoaXMtPnBsb3RzWyRpXS0+TGVnZW5kKCR0aGlzKTsKCSAgICAgICAgfQogICAgCSAgICAkdGhpcy0+bGVnZW5kLT5TdHJva2UoJHRoaXMtPmltZyk7CiAgICAgICAgCSR0aGlzLT5mb290ZXItPlN0cm9rZSgkdGhpcy0+aW1nKTsKCQl9CgoJCWlmKCAhJF9jc2ltICkgewoJICAgICAgICBpZiggJHRoaXMtPmdyaWRfZGVwdGggPT0gREVQVEhfQkFDSyApIHsKCSAgICAgICAgICAgIC8vIERyYXcgYXhpcyBhbmQgZ3JpZAoJICAgICAgICAgICAgZm9yKCAkaT0wLCRhPU1fUEkvMjsgJGkgPCAkbmJycG50czsgKyskaSwgJGEgKz0gJGFzdGVwICkgewoJICAgICAgICAgICAgICAgICR0aGlzLT5heGlzLT5TdHJva2UoJHRoaXMtPnBvc3ksJGEsJGdyaWRbJGldLCR0aGlzLT5heGlzX3RpdGxlWyRpXSwkaT09MCk7CgkgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkdGhpcy0+Z3JpZC0+U3Ryb2tlKCR0aGlzLT5pbWcsJGdyaWQpOwoJICAgICAgICB9CiAgICAgICAgICAgIGlmKCAkdGhpcy0+aUljb25EZXB0aCA9PSBERVBUSF9CQUNLICkgewogICAgICAgICAgICAgICAgJHRoaXMtPlN0cm9rZUljb25zKCk7CiAgICAgICAgICAgIH0KCgkJfQoKICAgICAgICAvLyBQbG90IHBvaW50cwogICAgICAgICRhPU1fUEkvMjsKICAgICAgICBmb3IoJGk9MDsgJGkgPCAkbjsgKyskaSApIHsKICAgICAgICAgICAgJHRoaXMtPnBsb3RzWyRpXS0+U3Ryb2tlKCR0aGlzLT5pbWcsICR0aGlzLT5wb3N5LCAkdGhpcy0+eXNjYWxlLCAkYSk7CiAgICAgICAgfQoKICAgICAgICBpZiggISRfY3NpbSApIHsKICAgICAgICAgICAgaWYoICR0aGlzLT5ncmlkX2RlcHRoICE9IERFUFRIX0JBQ0sgKSB7CiAgICAgICAgICAgICAgICAvLyBEcmF3IGF4aXMgYW5kIGdyaWQKICAgICAgICAgICAgICAgIGZvciggJGk9MCwkYT1NX1BJLzI7ICRpIDwgJG5icnBudHM7ICsrJGksICRhICs9ICRhc3RlcCApIHsKICAgICAgICAgICAgICAgICAgICR0aGlzLT5heGlzLT5TdHJva2UoJHRoaXMtPnBvc3ksJGEsJGdyaWRbJGldLCR0aGlzLT5heGlzX3RpdGxlWyRpXSwkaT09MCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkdGhpcy0+Z3JpZC0+U3Ryb2tlKCR0aGlzLT5pbWcsJGdyaWQpOwogICAgICAgICAgICB9CgogICAgICAgIAkkdGhpcy0+U3Ryb2tlVGl0bGVzKCk7CiAgICAgICAJCSR0aGlzLT5TdHJva2VUZXh0cygpOwogICAgICAgCQlpZiggJHRoaXMtPmlJY29uRGVwdGggPT0gREVQVEhfRlJPTlQgKSB7CiAgICAgICAgCQkkdGhpcy0+U3Ryb2tlSWNvbnMoKTsKICAgICAgICAJfQoJCX0KCiAgICAgICAgLy8gU2hvdWxkIHdlIGRvIGFueSBmaW5hbCBpbWFnZSB0cmFuc2Zvcm1hdGlvbgogICAgICAgIGlmKCAkdGhpcy0+aUltZ1RyYW5zICYmICEkX2NzaW0gKSB7CiAgICAgICAgICAgIGlmKCAhY2xhc3NfZXhpc3RzKCdJbWdUcmFucycsZmFsc2UpICkgewogICAgICAgICAgICAgICAgcmVxdWlyZV9vbmNlKCdqcGdyYXBoX2ltZ3RyYW5zLnBocCcpOwogICAgICAgICAgICB9CgogICAgICAgICAgICAkdGZvcm0gPSBuZXcgSW1nVHJhbnMoJHRoaXMtPmltZy0+aW1nKTsKICAgICAgICAgICAgJHRoaXMtPmltZy0+aW1nID0gJHRmb3JtLT5Ta2V3M0QoJHRoaXMtPmlJbWdUcmFuc0hvcml6b24sJHRoaXMtPmlJbWdUcmFuc1NrZXdEaXN0LAogICAgICAgICAgICAkdGhpcy0+aUltZ1RyYW5zRGlyZWN0aW9uLCR0aGlzLT5pSW1nVHJhbnNIaWdoUSwKICAgICAgICAgICAgJHRoaXMtPmlJbWdUcmFuc01pblNpemUsJHRoaXMtPmlJbWdUcmFuc0ZpbGxDb2xvciwKICAgICAgICAgICAgJHRoaXMtPmlJbWdUcmFuc0JvcmRlcik7CiAgICAgICAgfQoKCQlpZiggISRfY3NpbSApIHsKCSAgICAgICAgLy8gSWYgdGhlIGZpbGVuYW1lIGlzIGdpdmVuIGFzIHRoZSBzcGVjaWFsICJfX2hhbmRsZSIKCSAgICAgICAgLy8gdGhlbiB0aGUgaW1hZ2UgaGFuZGxlciBpcyByZXR1cm5lZCBhbmQgdGhlIGltYWdlIGlzIE5PVAoJICAgICAgICAvLyBzdHJlYW1lZCBiYWNrCgkgICAgICAgIGlmKCAkYVN0cm9rZUZpbGVOYW1lID09IF9JTUdfSEFORExFUiApIHsKCSAgICAgICAgICAgIHJldHVybiAkdGhpcy0+aW1nLT5pbWc7CgkgICAgICAgIH0KCSAgICAgICAgZWxzZSB7CgkgICAgICAgICAgICAvLyBGaW5hbGx5IHN0cmVhbSB0aGUgZ2VuZXJhdGVkIHBpY3R1cmUKCSAgICAgICAgICAgICR0aGlzLT5jYWNoZS0+UHV0QW5kU3RyZWFtKCR0aGlzLT5pbWcsJHRoaXMtPmNhY2hlX25hbWUsJHRoaXMtPmlubGluZSwkYVN0cm9rZUZpbGVOYW1lKTsKCSAgICAgICAgfQoJCX0KICAgIH0KfSAvLyBDbGFzcwoKLyogRU9GICovCj8+Cg==",
    "size": "28816"
}