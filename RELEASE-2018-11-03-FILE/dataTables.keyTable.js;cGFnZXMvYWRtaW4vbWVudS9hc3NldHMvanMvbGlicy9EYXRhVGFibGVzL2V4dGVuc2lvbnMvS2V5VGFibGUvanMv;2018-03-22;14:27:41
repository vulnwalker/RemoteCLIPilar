{
    "namaFile": "pages\/admin\/menu\/assets\/js\/libs\/DataTables\/extensions\/KeyTable\/js\/dataTables.keyTable.js",
    "lastUpdate": "2018-03-22+14:27:41.14",
    "contentFile": "LyohIEtleVRhYmxlIDEuMi4xCiAqIMKpMjAxMC0yMDE0IFNwcnlNZWRpYSBMdGQgLSBkYXRhdGFibGVzLm5ldC9saWNlbnNlCiAqLwoKLyoqCiAqIEBzdW1tYXJ5ICAgICBLZXlUYWJsZQogKiBAZGVzY3JpcHRpb24gU3ByZWFkc2hlZXQgbGlrZSBrZXlib2FyZCBuYXZpZ2F0aW9uIGZvciBEYXRhVGFibGVzCiAqIEB2ZXJzaW9uICAgICAxLjIuMQogKiBAZmlsZSAgICAgICAgZGF0YVRhYmxlcy5rZXlUYWJsZS5qcwogKiBAYXV0aG9yICAgICAgU3ByeU1lZGlhIEx0ZCAod3d3LnNwcnltZWRpYS5jby51aykKICogQGNvbnRhY3QgICAgIHd3dy5zcHJ5bWVkaWEuY28udWsvY29udGFjdAogKiBAY29weXJpZ2h0ICAgQ29weXJpZ2h0IDIwMDktMjAxNCBTcHJ5TWVkaWEgTHRkLgogKgogKiBUaGlzIHNvdXJjZSBmaWxlIGlzIGZyZWUgc29mdHdhcmUsIGF2YWlsYWJsZSB1bmRlciB0aGUgZm9sbG93aW5nIGxpY2Vuc2U6CiAqICAgTUlUIGxpY2Vuc2UgLSBodHRwOi8vZGF0YXRhYmxlcy5uZXQvbGljZW5zZS9taXQKICoKICogVGhpcyBzb3VyY2UgZmlsZSBpcyBkaXN0cmlidXRlZCBpbiB0aGUgaG9wZSB0aGF0IGl0IHdpbGwgYmUgdXNlZnVsLCBidXQKICogV0lUSE9VVCBBTlkgV0FSUkFOVFk7IHdpdGhvdXQgZXZlbiB0aGUgaW1wbGllZCB3YXJyYW50eSBvZiBNRVJDSEFOVEFCSUxJVFkKICogb3IgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UuIFNlZSB0aGUgbGljZW5zZSBmaWxlcyBmb3IgZGV0YWlscy4KICoKICogRm9yIGRldGFpbHMgcGxlYXNlIHJlZmVyIHRvOiBodHRwOi8vd3d3LmRhdGF0YWJsZXMubmV0CiAqLwoKLy8gR2xvYmFsIHNjb3BlIGZvciBLZXlUYWJsZSBmb3IgYmFja3dhcmRzIGNvbXBhdGliaWxpdHkuIFdpbGwgYmUgcmVtb3ZlZCBpbiAxLjMKdmFyIEtleVRhYmxlOwoKCihmdW5jdGlvbih3aW5kb3csIGRvY3VtZW50LCB1bmRlZmluZWQpIHsKCgp2YXIgZmFjdG9yeSA9IGZ1bmN0aW9uKCAkLCBEYXRhVGFibGUgKSB7CiJ1c2Ugc3RyaWN0IjsKCktleVRhYmxlID0gZnVuY3Rpb24gKCBvSW5pdCApCnsKCS8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoKCSAqIEFQSSBwYXJhbWV0ZXJzCgkgKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqLwoKCS8qCgkgKiBWYXJpYWJsZTogYmxvY2sKCSAqIFB1cnBvc2U6ICBGbGFnIHdoZXRoZXIgb3Igbm90IEtleVRhYmxlIGV2ZW50cyBzaG91bGQgYmUgcHJvY2Vzc2VkCgkgKiBTY29wZTogICAgS2V5VGFibGUgLSBwdWJsaWMKCSAqLwoJdGhpcy5ibG9jayA9IGZhbHNlOwoKCS8qCgkgKiBWYXJpYWJsZTogZXZlbnQKCSAqIFB1cnBvc2U6ICBDb250YWluZXIgZm9yIGFsbCBldmVudCBhcHBsaWNhdGlvbiBtZXRob2RzCgkgKiBTY29wZTogICAgS2V5VGFibGUgLSBwdWJsaWMKCSAqIE5vdGVzOiAgICBUaGlzIG9iamVjdCBjb250YWlucyBhbGwgdGhlIHB1YmxpYyBtZXRob2RzIGZvciBhZGRpbmcgYW5kIHJlbW92aW5nIGV2ZW50cyAtIHRoZXNlCgkgKiAgICAgICAgICAgYXJlIGR5bmFtaWNhbGx5IGFkZGVkIGxhdGVyIG9uCgkgKi8KCXRoaXMuZXZlbnQgPSB7CgkJInJlbW92ZSI6IHt9Cgl9OwoKCgkvKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqCgkgKiBBUEkgbWV0aG9kcwoJICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKi8KCgkvKgoJICogRnVuY3Rpb246IGZuR2V0Q3VycmVudFBvc2l0aW9uCgkgKiBQdXJwb3NlOiAgR2V0IHRoZSBjdXJyZW50bHkgZm9jdXNlZCBjZWxsJ3MgcG9zaXRpb24KCSAqIFJldHVybnM6ICBhcnJheSBpbnQ6IFsgeCwgeSBdCgkgKiBJbnB1dHM6ICAgdm9pZAoJICovCgl0aGlzLmZuR2V0Q3VycmVudFBvc2l0aW9uID0gZnVuY3Rpb24gKCkKCXsKCQlyZXR1cm4gWyBfaU9sZFgsIF9pT2xkWSBdOwoJfTsKCgoJLyoKCSAqIEZ1bmN0aW9uOiBmbkdldEN1cnJlbnREYXRhCgkgKiBQdXJwb3NlOiAgR2V0IHRoZSBjdXJyZW50bHkgZm9jdXNlZCBjZWxsJ3MgZGF0YSAoaW5uZXJIVE1MKQoJICogUmV0dXJuczogIHN0cmluZzogLSBkYXRhIHJlcXVlc3RlZAoJICogSW5wdXRzOiAgIHZvaWQKCSAqLwoJdGhpcy5mbkdldEN1cnJlbnREYXRhID0gZnVuY3Rpb24gKCkKCXsKCQlyZXR1cm4gX25PbGRGb2N1cy5pbm5lckhUTUw7Cgl9OwoKCgkvKgoJICogRnVuY3Rpb246IGZuR2V0Q3VycmVudFRECgkgKiBQdXJwb3NlOiAgR2V0IHRoZSBjdXJyZW50bHkgZm9jdXNlZCBjZWxsCgkgKiBSZXR1cm5zOiAgbm9kZTogLSBmb2N1c2VkIGVsZW1lbnQKCSAqIElucHV0czogICB2b2lkCgkgKi8KCXRoaXMuZm5HZXRDdXJyZW50VEQgPSBmdW5jdGlvbiAoKQoJewoJCXJldHVybiBfbk9sZEZvY3VzOwoJfTsKCgoJLyoKCSAqIEZ1bmN0aW9uOiBmblNldFBvc2l0aW9uCgkgKiBQdXJwb3NlOiAgU2V0IHRoZSBwb3NpdGlvbiBvZiB0aGUgZm9jdXNlZCBjZWxsCgkgKiBSZXR1cm5zOiAgLQoJICogSW5wdXRzOiAgIGludDp4IC0geCBjb29yZGluYXRlCgkgKiAgICAgICAgICAgaW50OnkgLSB5IGNvb3JkaW5hdGUKCSAqIE5vdGVzOiAgICBUaGFua3MgdG8gUm9oYW4gRGF4aW5pIGZvciB0aGUgYmFzaXMgb2YgdGhpcyBmdW5jdGlvbgoJICovCgl0aGlzLmZuU2V0UG9zaXRpb24gPSBmdW5jdGlvbiggeCwgeSApCgl7CgkJaWYgKCB0eXBlb2YgeCA9PSAnb2JqZWN0JyAmJiB4Lm5vZGVOYW1lICkKCQl7CgkJCV9mblNldEZvY3VzKCB4ICk7CgkJfQoJCWVsc2UKCQl7CgkJCV9mblNldEZvY3VzKCBfZm5DZWxsRnJvbUNvb3Jkcyh4LCB5KSApOwoJCX0KCX07CgoKCS8qCgkgKiBGdW5jdGlvbjogZm5CbHVyCgkgKiBQdXJwb3NlOiAgQmx1ciB0aGUgY3VycmVudCBmb2N1cwoJICogUmV0dXJuczogIC0KCSAqIElucHV0czogICAtCgkgKi8KCXRoaXMuZm5CbHVyID0gZnVuY3Rpb24oKQoJewoJCV9mbkJsdXIoKTsKCX07CgoKCS8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoKCSAqIFByaXZhdGUgcGFyYW1ldGVycwoJICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKi8KCgkvKgoJICogVmFyaWFibGU6IF9uQm9keQoJICogUHVycG9zZTogIEJvZHkgbm9kZSBvZiB0aGUgdGFibGUgLSBjYWNoZWQgZm9yIHJlbmZlcmVuY2UKCSAqIFNjb3BlOiAgICBLZXlUYWJsZSAtIHByaXZhdGUKCSAqLwoJdmFyIF9uQm9keSA9IG51bGw7CgoJLyoKCSAqIFZhcmlhYmxlOiAKCSAqIFB1cnBvc2U6ICAKCSAqIFNjb3BlOiAgICBLZXlUYWJsZSAtIHByaXZhdGUKCSAqLwoJdmFyIF9uT2xkRm9jdXMgPSBudWxsOwoKCS8qCgkgKiBWYXJpYWJsZTogX2lPbGRYIGFuZCBfaU9sZFkKCSAqIFB1cnBvc2U6ICBYIGFuZCBZIGNvb3JkcyBvZiB0aGUgb2xkIGVsZW1ldCB0aGF0IHdhcyBmb2N1c2VkIG9uCgkgKiBTY29wZTogICAgS2V5VGFibGUgLSBwcml2YXRlCgkgKi8KCXZhciBfaU9sZFggPSBudWxsOwoJdmFyIF9pT2xkWSA9IG51bGw7CgoJLyoKCSAqIFZhcmlhYmxlOiBfdGhhdAoJICogUHVycG9zZTogIFNjb3BlIHNhdmluZyBmb3IgJ3RoaXMnIGFmdGVyIGEgalF1ZXJ5IGV2ZW50CgkgKiBTY29wZTogICAgS2V5VGFibGUgLSBwcml2YXRlCgkgKi8KCXZhciBfdGhhdCA9IG51bGw7CgoJLyoKCSAqIFZhcmlhYmxlOiBzRm9jdXNDbGFzcwoJICogUHVycG9zZTogIENsYXNzIHRoYXQgc2hvdWxkIGJlIHVzZWQgZm9yIGZvY3VzaW5nIG9uIGEgY2VsbAoJICogU2NvcGU6ICAgIEtleVRhYmxlIC0gcHJpdmF0ZQoJICovCgl2YXIgX3NGb2N1c0NsYXNzID0gImZvY3VzIjsKCgkvKgoJICogVmFyaWFibGU6IF9iS2V5Q2FwdHVyZQoJICogUHVycG9zZTogIEZsYWcgZm9yIHNob3VsZCBLZXlUYWJsZSBjYXB0dXJlIGtleSBldmVudHMgb3Igbm90CgkgKiBTY29wZTogICAgS2V5VGFibGUgLSBwcml2YXRlCgkgKi8KCXZhciBfYktleUNhcHR1cmUgPSBmYWxzZTsKCgkvKgoJICogVmFyaWFibGU6IF9vYW9FdmVudHMKCSAqIFB1cnBvc2U6ICBFdmVudCBjYWNoZSBvYmplY3QsIG9uZSBhcnJheSBmb3IgZWFjaCBzdXBwb3J0ZWQgZXZlbnQgZm9yIHNwZWVkIG9mIHNlYXJjaGluZwoJICogU2NvcGU6ICAgIEtleVRhYmxlIC0gcHJpdmF0ZQoJICovCgl2YXIgX29hb0V2ZW50cyA9IHsKCQkiYWN0aW9uIjogW10sCgkJImVzYyI6IFtdLAoJCSJmb2N1cyI6IFtdLAoJCSJibHVyIjogW10KCX07CgoJLyoKCSAqIFZhcmlhYmxlOiBfb0RhdGF0YWJsZQoJICogUHVycG9zZTogIERhdGFUYWJsZXMgc2V0dGluZ3Mgb2JqZWN0IGZvciBpZiB3ZSBhcmUgYWN0dWFsbHkgdXNpbmcgYSAKCSAqICAgICAgICAgICBEYXRhVGFibGVzIHRhYmxlCgkgKiBTY29wZTogICAgS2V5VGFibGUgLSBwcml2YXRlCgkgKi8KCXZhciBfb0RhdGF0YWJsZSA9IG51bGw7CgoJdmFyIF9iRm9ybTsKCXZhciBfbklucHV0OwoJdmFyIF9iSW5wdXRGb2N1c2VkID0gZmFsc2U7CgoKCS8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoKCSAqIFByaXZhdGUgbWV0aG9kcwoJICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKi8KCgkvKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqCgkgKiBLZXkgdGFibGUgZXZlbnRzCgkgKi8KCgkvKgoJICogRnVuY3Rpb246IF9mbkV2ZW50QWRkVGVtcGxhdGUKCSAqIFB1cnBvc2U6ICBDcmVhdGUgYSBmdW5jdGlvbiAod2l0aCBjbG9zdXJlIGZvciBzS2V5KSBldmVudCBhZGRpdGlvbiBBUEkKCSAqIFJldHVybnM6ICBmdW5jdGlvbjogLSB0ZW1wbGF0ZSBmdW5jdGlvbgoJICogSW5wdXRzOiAgIHN0cmluZzpzS2V5IC0gdHlwZSBvZiBldmVudCB0byBkZXRlY3QKCSAqLwoJZnVuY3Rpb24gX2ZuRXZlbnRBZGRUZW1wbGF0ZSggc0tleSApCgl7CgkJLyoKCQkgKiBGdW5jdGlvbjogLQoJCSAqIFB1cnBvc2U6ICBBUEkgZnVuY3Rpb24gZm9yIGFkZGluZyBldmVudCB0byBjYWNoZQoJCSAqIFJldHVybnM6ICAtCgkJICogSW5wdXRzOiAgIDEuIG5vZGU6eCAtIHRhcmdldCBub2RlIHRvIGFkZCBldmVudCBmb3IKCQkgKiAgICAgICAgICAgMi4gZnVuY3Rpb246eSAtIGNhbGxiYWNrIGZ1bmN0aW9uIHRvIGFwcGx5CgkJICogICAgICAgICBvcgoJCSAqICAgICAgICAgICAxLiBpbnQ6eCAtIHggY29vcmQuIG9mIHRhcmdldCBjZWxsIChjYW4gYmUgbnVsbCBmb3IgbGl2ZSBldmVudHMpCgkJICogICAgICAgICAgIDIuIGludDp5IC0geSBjb29yZC4gb2YgdGFyZ2V0IGNlbGwgKGNhbiBiZSBudWxsIGZvciBsaXZlIGV2ZW50cykKCQkgKiAgICAgICAgICAgMy4gZnVuY3Rpb246eiAtIGNhbGxiYWNrIGZ1bmN0aW9uIHRvIGFwcGx5CgkJICogTm90ZXM6ICAgIFRoaXMgZnVuY3Rpb24gaXMgKGludGVyYWxseSkgb3ZlcmxvYWRlZCAoaW4gYXMgbXVjaCBhcyBqYXZhc2NyaXB0IGFsbG93cyBmb3IKCQkgKiAgICAgICAgICAgdGhhdCkgLSB0aGUgdGFyZ2V0IGNlbGwgY2FuIGJlIGdpdmVuIGJ5IGVpdGhlciBub2RlIG9yIGNvb3Jkcy4KCQkgKi8KCQlyZXR1cm4gZnVuY3Rpb24gKCB4LCB5LCB6ICkgewoJCQlpZiAoICh4PT09bnVsbCB8fCB0eXBlb2YgeCA9PSAibnVtYmVyIikgJiYKCQkJCSAoeT09PW51bGwgfHwgdHlwZW9mIHkgPT0gIm51bWJlciIpICYmCgkJCQkgdHlwZW9mIHogPT0gImZ1bmN0aW9uIiApCgkJCXsKCQkJCV9mbkV2ZW50QWRkKCBzS2V5LCB4LCB5LCB6ICk7CgkJCX0KCQkJZWxzZSBpZiAoIHR5cGVvZiB4ID09ICJvYmplY3QiICYmIHR5cGVvZiB5ID09ICJmdW5jdGlvbiIgKQoJCQl7CgkJCQl2YXIgYUNvb3JkcyA9IF9mbkNvb3Jkc0Zyb21DZWxsKCB4ICk7CgkJCQlfZm5FdmVudEFkZCggc0tleSwgYUNvb3Jkc1swXSwgYUNvb3Jkc1sxXSwgeSApOwoJCQl9CgkJCWVsc2UKCQkJewoJCQkJYWxlcnQoICJVbmhhbmRhYmxlIGV2ZW50IHR5cGUgd2FzIGFkZGVkOiB4IiAreCsgIiAgeToiICt5KyAiICB6OiIgK3ogKTsKCQkJfQoJCX07Cgl9CgoKCS8qCgkgKiBGdW5jdGlvbjogX2ZuRXZlbnRSZW1vdmVUZW1wbGF0ZQoJICogUHVycG9zZTogIENyZWF0ZSBhIGZ1bmN0aW9uICh3aXRoIGNsb3N1cmUgZm9yIHNLZXkpIGV2ZW50IHJlbW92YWwgQVBJCgkgKiBSZXR1cm5zOiAgZnVuY3Rpb246IC0gdGVtcGxhdGUgZnVuY3Rpb24KCSAqIElucHV0czogICBzdHJpbmc6c0tleSAtIHR5cGUgb2YgZXZlbnQgdG8gZGV0ZWN0CgkgKi8KCWZ1bmN0aW9uIF9mbkV2ZW50UmVtb3ZlVGVtcGxhdGUoIHNLZXkgKQoJewoJCS8qCgkJICogRnVuY3Rpb246IC0KCQkgKiBQdXJwb3NlOiAgQVBJIGZ1bmN0aW9uIGZvciByZW1vdmluZyBldmVudCBmcm9tIGNhY2hlCgkJICogUmV0dXJuczogIGludDogLSBudW1iZXIgb2YgZXZlbnRzIHJlbW92ZWQKCQkgKiBJbnB1dHM6ICAgMS4gbm9kZTp4IC0gdGFyZ2V0IG5vZGUgdG8gcmVtb3ZlIGV2ZW50IGZyb20KCQkgKiAgICAgICAgICAgMi4gZnVuY3Rpb246eSAtIGNhbGxiYWNrIGZ1bmN0aW9uIHRvIGFwcGx5CgkJICogICAgICAgICBvcgoJCSAqICAgICAgICAgICAxLiBpbnQ6eCAtIHggY29vcmQuIG9mIHRhcmdldCBjZWxsIChjYW4gYmUgbnVsbCBmb3IgbGl2ZSBldmVudHMpCgkJICogICAgICAgICAgIDIuIGludDp5IC0geSBjb29yZC4gb2YgdGFyZ2V0IGNlbGwgKGNhbiBiZSBudWxsIGZvciBsaXZlIGV2ZW50cykKCQkgKiAgICAgICAgICAgMy4gZnVuY3Rpb246eiAtIGNhbGxiYWNrIGZ1bmN0aW9uIHRvIHJlbW92ZSAtIG9wdGlvbmFsCgkJICogTm90ZXM6ICAgIFRoaXMgZnVuY3Rpb24gaXMgKGludGVyYWxseSkgb3ZlcmxvYWRlZCAoaW4gYXMgbXVjaCBhcyBqYXZhc2NyaXB0IGFsbG93cyBmb3IKCQkgKiAgICAgICAgICAgdGhhdCkgLSB0aGUgdGFyZ2V0IGNlbGwgY2FuIGJlIGdpdmVuIGJ5IGVpdGhlciBub2RlIG9yIGNvb3JkcyBhbmQgdGhlIGZ1bmN0aW9uCgkJICogICAgICAgICAgIHRvIHJlbW92ZSBpcyBvcHRpb25hbAoJCSAqLwoJCXJldHVybiBmdW5jdGlvbiAoIHgsIHksIHogKSB7CgkJCWlmICggKHg9PT1udWxsIHx8IHR5cGVvZiBhcmd1bWVudHNbMF0gPT0gIm51bWJlciIpICYmCgkJCQkgKHk9PT1udWxsIHx8IHR5cGVvZiBhcmd1bWVudHNbMV0gPT0gIm51bWJlciIgKSApCgkJCXsKCQkJCWlmICggdHlwZW9mIGFyZ3VtZW50c1syXSA9PSAiZnVuY3Rpb24iICkKCQkJCXsKCQkJCQlfZm5FdmVudFJlbW92ZSggc0tleSwgeCwgeSwgeiApOwoJCQkJfQoJCQkJZWxzZQoJCQkJewoJCQkJCV9mbkV2ZW50UmVtb3ZlKCBzS2V5LCB4LCB5ICk7CgkJCQl9CgkJCX0KCQkJZWxzZSBpZiAoIHR5cGVvZiBhcmd1bWVudHNbMF0gPT0gIm9iamVjdCIgKQoJCQl7CgkJCQl2YXIgYUNvb3JkcyA9IF9mbkNvb3Jkc0Zyb21DZWxsKCB4ICk7CgkJCQlpZiAoIHR5cGVvZiBhcmd1bWVudHNbMV0gPT0gImZ1bmN0aW9uIiApCgkJCQl7CgkJCQkJX2ZuRXZlbnRSZW1vdmUoIHNLZXksIGFDb29yZHNbMF0sIGFDb29yZHNbMV0sIHkgKTsKCQkJCX0KCQkJCWVsc2UKCQkJCXsKCQkJCQlfZm5FdmVudFJlbW92ZSggc0tleSwgYUNvb3Jkc1swXSwgYUNvb3Jkc1sxXSApOwoJCQkJfQoJCQl9CgkJCWVsc2UKCQkJewoJCQkJYWxlcnQoICJVbmhhbmRhYmxlIGV2ZW50IHR5cGUgd2FzIHJlbW92ZWQ6IHgiICt4KyAiICB5OiIgK3krICIgIHo6IiAreiApOwoJCQl9CgkJfTsKCX0KCgkvKiBVc2UgdGhlIHRlbXBsYXRlIGZ1bmN0aW9ucyB0byBhZGQgdGhlIGV2ZW50IEFQSSBmdW5jdGlvbnMgKi8KCWZvciAoIHZhciBzS2V5IGluIF9vYW9FdmVudHMgKQoJewoJCWlmICggc0tleSApCgkJewoJCQl0aGlzLmV2ZW50W3NLZXldID0gX2ZuRXZlbnRBZGRUZW1wbGF0ZSggc0tleSApOwoJCQl0aGlzLmV2ZW50LnJlbW92ZVtzS2V5XSA9IF9mbkV2ZW50UmVtb3ZlVGVtcGxhdGUoIHNLZXkgKTsKCQl9Cgl9CgoKCS8qCgkgKiBGdW5jdGlvbjogX2ZuRXZlbnRBZGQKCSAqIFB1cnBvc2U6ICBBZGQgYW4gZXZlbnQgdG8gdGhlIGludGVybmFsIGNhY2hlCgkgKiBSZXR1cm5zOiAgLQoJICogSW5wdXRzOiAgIHN0cmluZzpzVHlwZSAtIHR5cGUgb2YgZXZlbnQgdG8gYWRkLCBnaXZlbiBieSB0aGUgYXZhaWxhYmxlIGVsZW1lbnRzIGluIF9vYW9FdmVudHMKCSAqICAgICAgICAgICBpbnQ6eCAtIHgtY29vcmRzIHRvIGFkZCBldmVudCB0byAtIGNhbiBiZSBudWxsIGZvciAiYmxhbmtldCIgZXZlbnQKCSAqICAgICAgICAgICBpbnQ6eSAtIHktY29vcmRzIHRvIGFkZCBldmVudCB0byAtIGNhbiBiZSBudWxsIGZvciAiYmxhbmtldCIgZXZlbnQKCSAqICAgICAgICAgICBmdW5jdGlvbjpmbiAtIGNhbGxiYWNrIGZ1bmN0aW9uIGZvciB3aGVuIHRyaWdnZXJlZAoJICovCglmdW5jdGlvbiBfZm5FdmVudEFkZCggc1R5cGUsIHgsIHksIGZuICkKCXsKCQlfb2FvRXZlbnRzW3NUeXBlXS5wdXNoKCB7CgkJCSJ4IjogeCwKCQkJInkiOiB5LAoJCQkiZm4iOiBmbgoJCX0gKTsKCX0KCgoJLyoKCSAqIEZ1bmN0aW9uOiBfZm5FdmVudFJlbW92ZQoJICogUHVycG9zZTogIFJlbW92ZSBhbiBldmVudCBmcm9tIHRoZSBldmVudCBjYWNoZQoJICogUmV0dXJuczogIGludDogLSBudW1iZXIgb2YgbWF0Y2hpbmcgZXZlbnRzIHJlbW92ZWQKCSAqIElucHV0czogICBzdHJpbmc6c1R5cGUgLSB0eXBlIG9mIGV2ZW50IHRvIGxvb2sgZm9yCgkgKiAgICAgICAgICAgbm9kZTpuVGFyZ2V0IC0gdGFyZ2V0IHRhYmxlIGNlbGwKCSAqICAgICAgICAgICBmdW5jdGlvbjpmbiAtIG9wdGlvbmFsIC0gcmVtb3ZlIHRoaXMgZnVuY3Rpb24uIElmIG5vdCBnaXZlbiBhbGwgaGFuZGxlcnMgb2YgdGhpcwoJICogICAgICAgICAgICAgdHlwZSB3aWxsIGJlIHJlbW92ZWQKCSAqLwoJZnVuY3Rpb24gX2ZuRXZlbnRSZW1vdmUoIHNUeXBlLCB4LCB5LCBmbiApCgl7CgkJdmFyIGlDb3JyZWN0b3IgPSAwOwoKCQlmb3IgKCB2YXIgaT0wLCBpTGVuPV9vYW9FdmVudHNbc1R5cGVdLmxlbmd0aCA7IGk8aUxlbi1pQ29ycmVjdG9yIDsgaSsrICkKCQl7CgkJCWlmICggdHlwZW9mIGZuICE9ICd1bmRlZmluZWQnICkKCQkJewoJCQkJaWYgKCBfb2FvRXZlbnRzW3NUeXBlXVtpLWlDb3JyZWN0b3JdLnggPT0geCAmJgoJCQkJCSBfb2FvRXZlbnRzW3NUeXBlXVtpLWlDb3JyZWN0b3JdLnkgPT0geSAmJgoJCQkJCSAgIF9vYW9FdmVudHNbc1R5cGVdW2ktaUNvcnJlY3Rvcl0uZm4gPT0gZm4gKQoJCQkJewoJCQkJCV9vYW9FdmVudHNbc1R5cGVdLnNwbGljZSggaS1pQ29ycmVjdG9yLCAxICk7CgkJCQkJaUNvcnJlY3RvcisrOwoJCQkJfQoJCQl9CgkJCWVsc2UKCQkJewoJCQkJaWYgKCBfb2FvRXZlbnRzW3NUeXBlXVtpLWlDb3JyZWN0b3JdLnggPT0geCAmJgoJCQkJCSBfb2FvRXZlbnRzW3NUeXBlXVtpLWlDb3JyZWN0b3JdLnkgPT0geSApCgkJCQl7CgkJCQkJX29hb0V2ZW50c1tzVHlwZV0uc3BsaWNlKCBpLCAxICk7CgkJCQkJcmV0dXJuIDE7CgkJCQl9CgkJCX0KCQl9CgkJcmV0dXJuIGlDb3JyZWN0b3I7Cgl9CgoKCS8qCgkgKiBGdW5jdGlvbjogX2ZuRXZlbnRGaXJlCgkgKiBQdXJwb3NlOiAgTG9vayB0aG91Z2h0IHRoZSBldmVudHMgY2FjaGUgYW5kIGZpcmUgb2ZmIHRoZSBldmVudCBvZiBpbnRlcmVzdAoJICogUmV0dXJuczogIGludDppRmlyZWQgLSBudW1iZXIgb2YgZXZlbnRzIGZpcmVkCgkgKiBJbnB1dHM6ICAgc3RyaW5nOnNUeXBlIC0gdHlwZSBvZiBldmVudCB0byBsb29rIGZvcgoJICogICAgICAgICAgIGludDp4IC0geCBjb29yZCBvZiBjZWxsCgkgKiAgICAgICAgICAgaW50OnkgLSB5IGNvb3JkIG9mICBlbGwKCSAqIE5vdGVzOiAgICBJdCBtaWdodCBiZSBtb3JlIGVmZmljaWVudCB0byByZXR1cm4gYWZ0ZXIgdGhlIGZpcnN0IGV2ZW50IGhhcyBiZWVuIHRpcmdnZXJlZCwKCSAqICAgICAgICAgICBidXQgdGhhdCB3b3VsZCBtZWFuIHRoYXQgb25seSBvbmUgZnVuY3Rpb24gb2YgYSBwYXJ0aWN1bGFyIHR5cGUgY2FuIGJlCgkgKiAgICAgICAgICAgc3Vic2NyaWJlZCB0byBhIHBhcnRpY3VsYXIgbm9kZS4KCSAqLwoJZnVuY3Rpb24gX2ZuRXZlbnRGaXJlICggc1R5cGUsIHgsIHkgKQoJewoJCXZhciBpRmlyZWQgPSAwOwoJCXZhciBhRXZlbnRzID0gX29hb0V2ZW50c1tzVHlwZV07CgkJZm9yICggdmFyIGk9MCA7IGk8YUV2ZW50cy5sZW5ndGggOyBpKysgKQoJCXsKCQkJaWYgKCAoYUV2ZW50c1tpXS54ID09IHggICAgICYmIGFFdmVudHNbaV0ueSA9PSB5ICAgICkgfHwKCQkJCSAoYUV2ZW50c1tpXS54ID09PSBudWxsICYmIGFFdmVudHNbaV0ueSA9PSB5ICAgICkgfHwKCQkJCSAoYUV2ZW50c1tpXS54ID09IHggICAgICYmIGFFdmVudHNbaV0ueSA9PT0gbnVsbCApIHx8CgkJCQkgKGFFdmVudHNbaV0ueCA9PT0gbnVsbCAmJiBhRXZlbnRzW2ldLnkgPT09IG51bGwgKQoJCQkpCgkJCXsKCQkJCWFFdmVudHNbaV0uZm4oIF9mbkNlbGxGcm9tQ29vcmRzKHgseSksIHgsIHkgKTsKCQkJCWlGaXJlZCsrOwoJCQl9CgkJfQoJCXJldHVybiBpRmlyZWQ7Cgl9CgoKCgkvKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqCgkgKiBGb2N1cyBmdW5jdGlvbnMKCSAqLwoKCS8qCgkgKiBGdW5jdGlvbjogX2ZuU2V0Rm9jdXMKCSAqIFB1cnBvc2U6ICBTZXQgZm9jdXMgb24gYSBub2RlLCBhbmQgcmVtb3ZlIGZyb20gYW4gb2xkIG5vZGUgaWYgbmVlZGVkCgkgKiBSZXR1cm5zOiAgLQoJICogSW5wdXRzOiAgIG5vZGU6blRhcmdldCAtIG5vZGUgd2Ugd2FudCB0byBmb2N1cyBvbgoJICogICAgICAgICAgIGJvb2w6YkF1dG9TY3JvbGwgLSBvcHRpb25hbCAtIHNob3VsZCB3ZSBzY3JvbGwgdGhlIHZpZXcgcG9ydCB0byB0aGUgZGlzcGxheQoJICovCglmdW5jdGlvbiBfZm5TZXRGb2N1cyggblRhcmdldCwgYkF1dG9TY3JvbGwgKQoJewoJCS8qIElmIG5vZGUgYWxyZWFkeSBoYXMgZm9jdXMsIGp1c3QgaWdub3JlIHRoaXMgY2FsbCAqLwoJCWlmICggX25PbGRGb2N1cyA9PSBuVGFyZ2V0ICkKCQl7CgkJCXJldHVybjsKCQl9CgoJCWlmICggdHlwZW9mIGJBdXRvU2Nyb2xsID09ICd1bmRlZmluZWQnICkKCQl7CgkJCWJBdXRvU2Nyb2xsID0gdHJ1ZTsKCQl9CgoJCS8qIFJlbW92ZSBvbGQgZm9jdXMgKHdpdGggYmx1ciBldmVudCBpZiBuZWVkZWQpICovCgkJaWYgKCBfbk9sZEZvY3VzICE9PSBudWxsICkKCQl7CgkJCV9mblJlbW92ZUZvY3VzKCBfbk9sZEZvY3VzICk7CgkJfQoKCQkvKiBBZGQgdGhlIG5ldyBjbGFzcyB0byBoaWdobGlnaHQgdGhlIGZvY3VzZWQgY2VsbCAqLwoJCSQoblRhcmdldCkuYWRkQ2xhc3MoIF9zRm9jdXNDbGFzcyApOwoJCSQoblRhcmdldCkucGFyZW50KCkuYWRkQ2xhc3MoIF9zRm9jdXNDbGFzcyApOwoKCQkvKiBJZiBpdCdzIGEgRGF0YVRhYmxlIHRoZW4gd2UgbmVlZCB0byBqdW1wIHRoZSBwYWdpbmcgdG8gdGhlIHJlbGV2YW50IHBhZ2UgKi8KCQl2YXIgb1NldHRpbmdzOwoJCWlmICggX29EYXRhdGFibGUgKQoJCXsKCQkJb1NldHRpbmdzID0gX29EYXRhdGFibGU7CgkJCXZhciBpUm93ID0gX2ZuRmluZER0Q2VsbCggblRhcmdldCApWzFdOwoJCQl2YXIgYktleUNhcHR1cmVDYWNoZSA9IF9iS2V5Q2FwdHVyZTsKCgkJCS8qIFBhZ2UgZm9yd2FyZHMgKi8KCQkJd2hpbGUgKCBpUm93ID49IG9TZXR0aW5ncy5mbkRpc3BsYXlFbmQoKSApCgkJCXsKCQkJCWlmICggb1NldHRpbmdzLl9pRGlzcGxheUxlbmd0aCA+PSAwICkKCQkJCXsKCQkJCQkvKiBNYWtlIHN1cmUgd2UgYXJlIG5vdCBvdmVyIHJ1bm5pbmcgdGhlIGRpc3BsYXkgYXJyYXkgKi8KCQkJCQlpZiAoIG9TZXR0aW5ncy5faURpc3BsYXlTdGFydCArIG9TZXR0aW5ncy5faURpc3BsYXlMZW5ndGggPCBvU2V0dGluZ3MuZm5SZWNvcmRzRGlzcGxheSgpICkKCQkJCQl7CgkJCQkJCW9TZXR0aW5ncy5faURpc3BsYXlTdGFydCArPSBvU2V0dGluZ3MuX2lEaXNwbGF5TGVuZ3RoOwoJCQkJCX0KCQkJCX0KCQkJCWVsc2UKCQkJCXsKCQkJCQlvU2V0dGluZ3MuX2lEaXNwbGF5U3RhcnQgPSAwOwoJCQkJfQoJCQkJX29EYXRhdGFibGUub0FwaS5fZm5DYWxjdWxhdGVFbmQoIG9TZXR0aW5ncyApOwoJCQl9CgoJCQkvKiBQYWdlIGJhY2t3YXJkcyAqLwoJCQl3aGlsZSAoIGlSb3cgPCBvU2V0dGluZ3MuX2lEaXNwbGF5U3RhcnQgKQoJCQl7CgkJCQlvU2V0dGluZ3MuX2lEaXNwbGF5U3RhcnQgPSBvU2V0dGluZ3MuX2lEaXNwbGF5TGVuZ3RoPj0wID8KCQkJCQlvU2V0dGluZ3MuX2lEaXNwbGF5U3RhcnQgLSBvU2V0dGluZ3MuX2lEaXNwbGF5TGVuZ3RoIDoKCQkJCQkwOwoKCQkJCWlmICggb1NldHRpbmdzLl9pRGlzcGxheVN0YXJ0IDwgMCApCgkJCQl7CgkJCQkgIG9TZXR0aW5ncy5faURpc3BsYXlTdGFydCA9IDA7CgkJCQl9CgkJCQlfb0RhdGF0YWJsZS5vQXBpLl9mbkNhbGN1bGF0ZUVuZCggb1NldHRpbmdzICk7CgkJCX0KCgkJCS8qIFJlLWRyYXcgdGhlIHRhYmxlICovCgkJCV9vRGF0YXRhYmxlLm9BcGkuX2ZuRHJhdyggb1NldHRpbmdzICk7CgoJCQkvKiBSZXN0b3JlIHRoZSBrZXkgY2FwdHVyZSAqLwoJCQlfYktleUNhcHR1cmUgPSBiS2V5Q2FwdHVyZUNhY2hlOwoJCX0KCgkJLyogQ2FjaGUgdGhlIGluZm9ybWF0aW9uIHRoYXQgd2UgYXJlIGludGVyZXN0ZWQgaW4gKi8KCQl2YXIgYU5ld1BvcyA9IF9mbkNvb3Jkc0Zyb21DZWxsKCBuVGFyZ2V0ICk7CgkJX25PbGRGb2N1cyA9IG5UYXJnZXQ7CgkJX2lPbGRYID0gYU5ld1Bvc1swXTsKCQlfaU9sZFkgPSBhTmV3UG9zWzFdOwoKCQl2YXIgaVZpZXdwb3J0SGVpZ2h0LCBpVmlld3BvcnRXaWR0aCwgaVNjcm9sbFRvcCwgaVNjcm9sbExlZnQsIGlIZWlnaHQsIGlXaWR0aCwgYWlQb3M7CgkJaWYgKCBiQXV0b1Njcm9sbCApCgkJewoJCQkvKiBTY3JvbGwgdGhlIHZpZXdwb3J0IHN1Y2ggdGhhdCB0aGUgbmV3IGNlbGwgaXMgZnVsbHkgdmlzaWJsZSBpbiB0aGUgcmVuZGVyZWQgd2luZG93ICovCgkJCWlWaWV3cG9ydEhlaWdodCA9ICQod2luZG93KS5oZWlnaHQoKTsKCQkJaVZpZXdwb3J0V2lkdGggPSAkKHdpbmRvdykud2lkdGgoKTsKCQkJaVNjcm9sbFRvcCA9ICQoZG9jdW1lbnQpLnNjcm9sbFRvcCgpOwoJCQlpU2Nyb2xsTGVmdCA9ICQoZG9jdW1lbnQpLnNjcm9sbExlZnQoKTsKCQkJaUhlaWdodCA9IG5UYXJnZXQub2Zmc2V0SGVpZ2h0OwoJCQlpV2lkdGggPSBuVGFyZ2V0Lm9mZnNldFdpZHRoOwoJCQlhaVBvcyA9IF9mbkdldFBvcyggblRhcmdldCApOwoKCQkJLyogVGFrZSBhY2NvdW50IG9mIHNjcm9sbGluZyBpbiBEYXRhVGFibGVzIDEuNyAtIHJlbW92ZSBzY3JvbGxpbmcgc2luY2UgdGhhdCB3b3VsZCBhZGQgdG8KCQkJICogdGhlIHBvc2l0aW9uaW5nIGNhbGN1bGF0aW9uCgkJCSAqLwoJCQlpZiAoIF9vRGF0YXRhYmxlICYmIHR5cGVvZiBvU2V0dGluZ3Mub1Njcm9sbCAhPSAndW5kZWZpbmVkJyAmJgoJCQkgIChvU2V0dGluZ3Mub1Njcm9sbC5zWCAhPT0gIiIgfHwgb1NldHRpbmdzLm9TY3JvbGwuc1kgIT09ICIiKSApCgkJCXsKCQkJCWFpUG9zWzFdIC09ICQob1NldHRpbmdzLm5UYWJsZS5wYXJlbnROb2RlKS5zY3JvbGxUb3AoKTsKCQkJCWFpUG9zWzBdIC09ICQob1NldHRpbmdzLm5UYWJsZS5wYXJlbnROb2RlKS5zY3JvbGxMZWZ0KCk7CgkJCX0KCgkJCS8qIENvcnJlY3Qgdmlld3BvcnQgcG9zaXRpb25pbmcgZm9yIHZlcnRpY2FsIHNjcm9sbGluZyAqLwoJCQlpZiAoIGFpUG9zWzFdK2lIZWlnaHQgPiBpU2Nyb2xsVG9wK2lWaWV3cG9ydEhlaWdodCApCgkJCXsKCQkJCS8qIERpc3BsYXllZCBlbGVtZW50IGlmIG9mZiB0aGUgYm90dG9tIG9mIHRoZSB2aWV3cG9ydCAqLwoJCQkJX2ZuU2V0U2Nyb2xsVG9wKCBhaVBvc1sxXStpSGVpZ2h0IC0gaVZpZXdwb3J0SGVpZ2h0ICk7CgkJCX0KCQkJZWxzZSBpZiAoIGFpUG9zWzFdIDwgaVNjcm9sbFRvcCApCgkJCXsKCQkJCS8qIERpc3BsYXllZCBlbGVtZW50IGlmIG9mZiB0aGUgdG9wIG9mIHRoZSB2aWV3cG9ydCAqLwoJCQkJX2ZuU2V0U2Nyb2xsVG9wKCBhaVBvc1sxXSApOwoJCQl9CgoJCQkvKiBDb3JyZWN0IHZpZXdwb3J0IHBvc2l0aW9uaW5nIGZvciBob3Jpem9udGFsIHNjcm9sbGluZyAqLwoJCQlpZiAoIGFpUG9zWzBdK2lXaWR0aCA+IGlTY3JvbGxMZWZ0K2lWaWV3cG9ydFdpZHRoICkKCQkJewoJCQkJLyogRGlzcGxheWVkIGVsZW1lbnQgaXMgb2ZmIHRoZSBib3R0b20gb2YgdGhlIHZpZXdwb3J0ICovCgkJCQlfZm5TZXRTY3JvbGxMZWZ0KCBhaVBvc1swXStpV2lkdGggLSBpVmlld3BvcnRXaWR0aCApOwoJCQl9CgkJCWVsc2UgaWYgKCBhaVBvc1swXSA8IGlTY3JvbGxMZWZ0ICkKCQkJewoJCQkJLyogRGlzcGxheWVkIGVsZW1lbnQgaWYgb2ZmIHRoZSBMZWZ0IG9mIHRoZSB2aWV3cG9ydCAqLwoJCQkJX2ZuU2V0U2Nyb2xsTGVmdCggYWlQb3NbMF0gKTsKCQkJfQoJCX0KCgkJLyogVGFrZSBhY2NvdW50IG9mIHNjcm9sbGluZyBpbiBEYXRhVGFibGVzIDEuNyAqLwoJCWlmICggX29EYXRhdGFibGUgJiYgdHlwZW9mIG9TZXR0aW5ncy5vU2Nyb2xsICE9ICd1bmRlZmluZWQnICYmCgkJICAob1NldHRpbmdzLm9TY3JvbGwuc1ggIT09ICIiIHx8IG9TZXR0aW5ncy5vU2Nyb2xsLnNZICE9PSAiIikgKQoJCXsKCQkJdmFyIGR0U2Nyb2xsQm9keSA9IG9TZXR0aW5ncy5uVGFibGUucGFyZW50Tm9kZTsKCQkJaVZpZXdwb3J0SGVpZ2h0ID0gZHRTY3JvbGxCb2R5LmNsaWVudEhlaWdodDsKCQkJaVZpZXdwb3J0V2lkdGggPSBkdFNjcm9sbEJvZHkuY2xpZW50V2lkdGg7CgkJCWlTY3JvbGxUb3AgPSBkdFNjcm9sbEJvZHkuc2Nyb2xsVG9wOwoJCQlpU2Nyb2xsTGVmdCA9IGR0U2Nyb2xsQm9keS5zY3JvbGxMZWZ0OwoJCQlpSGVpZ2h0ID0gblRhcmdldC5vZmZzZXRIZWlnaHQ7CgkJCWlXaWR0aCA9IG5UYXJnZXQub2Zmc2V0V2lkdGg7CgoJCQkvKiBDb3JyZWN0IGZvciB2ZXJ0aWNhbCBzY3JvbGxpbmcgKi8KCQkJaWYgKCBuVGFyZ2V0Lm9mZnNldFRvcCArIGlIZWlnaHQgPiBpVmlld3BvcnRIZWlnaHQraVNjcm9sbFRvcCApCgkJCXsKCQkJCWR0U2Nyb2xsQm9keS5zY3JvbGxUb3AgPSAoblRhcmdldC5vZmZzZXRUb3AgKyBpSGVpZ2h0KSAtIGlWaWV3cG9ydEhlaWdodDsKCQkJfQoJCQllbHNlIGlmICggblRhcmdldC5vZmZzZXRUb3AgPCBpU2Nyb2xsVG9wICkKCQkJewoJCQkJZHRTY3JvbGxCb2R5LnNjcm9sbFRvcCA9IG5UYXJnZXQub2Zmc2V0VG9wOwoJCQl9CgoJCQkvKiBDb3JyZWN0IGZvciBob3Jpem9udGFsIHNjcm9sbGluZyAqLwoJCQlpZiAoIG5UYXJnZXQub2Zmc2V0TGVmdCArIGlXaWR0aCA+IGlWaWV3cG9ydFdpZHRoK2lTY3JvbGxMZWZ0ICkKCQkJewoJCQkJZHRTY3JvbGxCb2R5LnNjcm9sbExlZnQgPSAoblRhcmdldC5vZmZzZXRMZWZ0ICsgaVdpZHRoKSAtIGlWaWV3cG9ydFdpZHRoOwoJCQl9CgkJCWVsc2UgaWYgKCBuVGFyZ2V0Lm9mZnNldExlZnQgPCBpU2Nyb2xsTGVmdCApCgkJCXsKCQkJCWR0U2Nyb2xsQm9keS5zY3JvbGxMZWZ0ID0gblRhcmdldC5vZmZzZXRMZWZ0OwoJCQl9CgkJfQoKCQkvKiBGb2N1c2VkIC0gc28gd2Ugd2FudCB0byBjYXB0dXJlIHRoZSBrZXlzICovCgkJX2ZuQ2FwdHVyZUtleXMoKTsKCgkJLyogRmlyZSBvZiB0aGUgZm9jdXMgZXZlbnQgaWYgdGhlcmUgaXMgb25lICovCgkJX2ZuRXZlbnRGaXJlKCAiZm9jdXMiLCBfaU9sZFgsIF9pT2xkWSApOwoJfQoKCgkvKgoJICogRnVuY3Rpb246IF9mbkJsdXIKCSAqIFB1cnBvc2U6ICBCbHVyIGZvY3VzIGZyb20gdGhlIHdob2xlIHRhYmxlCgkgKiBSZXR1cm5zOiAgLQoJICogSW5wdXRzOiAgIC0KCSAqLwoJZnVuY3Rpb24gX2ZuQmx1cigpCgl7CgkJX2ZuUmVtb3ZlRm9jdXMoIF9uT2xkRm9jdXMgKTsKCQlfaU9sZFggPSBudWxsOwoJCV9pT2xkWSA9IG51bGw7CgkJX25PbGRGb2N1cyA9IG51bGw7CgkJX2ZuUmVsZWFzZUtleXMoKTsKCX0KCgoJLyoKCSAqIEZ1bmN0aW9uOiBfZm5SZW1vdmVGb2N1cwoJICogUHVycG9zZTogIFJlbW92ZSBmb2N1cyBmcm9tIGEgY2VsbCBhbmQgZmlyZSBhbnkgYmx1ciBldmVudHMgd2hpY2ggYXJlIGF0dGFjaGVkCgkgKiBSZXR1cm5zOiAgLQoJICogSW5wdXRzOiAgIG5vZGU6blRhcmdldCAtIGNlbGwgb2YgaW50ZXJlc3QKCSAqLwoJZnVuY3Rpb24gX2ZuUmVtb3ZlRm9jdXMoIG5UYXJnZXQgKQoJewoJCSQoblRhcmdldCkucmVtb3ZlQ2xhc3MoIF9zRm9jdXNDbGFzcyApOwoJCSQoblRhcmdldCkucGFyZW50KCkucmVtb3ZlQ2xhc3MoIF9zRm9jdXNDbGFzcyApOwoJCV9mbkV2ZW50RmlyZSggImJsdXIiLCBfaU9sZFgsIF9pT2xkWSApOwoJfQoKCgkvKgoJICogRnVuY3Rpb246IF9mbkNsaWNrCgkgKiBQdXJwb3NlOiAgRm9jdXMgb24gdGhlIGVsZW1lbnQgdGhhdCBoYXMgYmVlbiBjbGlja2VkIG9uIGJ5IHRoZSB1c2VyCgkgKiBSZXR1cm5zOiAgLQoJICogSW5wdXRzOiAgIGV2ZW50OmUgLSBjbGljayBldmVudAoJICovCglmdW5jdGlvbiBfZm5DbGljayAoIGUgKQoJewoJCXZhciBuVGFyZ2V0ID0gdGhpczsKCQl3aGlsZSAoIG5UYXJnZXQubm9kZU5hbWUgIT0gIlREIiApCgkJewoJCQluVGFyZ2V0ID0gblRhcmdldC5wYXJlbnROb2RlOwoJCX0KCgkJX2ZuU2V0Rm9jdXMoIG5UYXJnZXQgKTsKCQlfZm5DYXB0dXJlS2V5cygpOwoJfQoKCgoJLyogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKgoJICogS2V5IGV2ZW50cwoJICovCgoJLyoKCSAqIEZ1bmN0aW9uOiBfZm5LZXkKCSAqIFB1cnBvc2U6ICBEZWFsIHdpdGggYSBrZXkgZXZlbnRzLCBiZSBpdCBtb3ZpbmcgdGhlIGZvY3VzIG9yIHJldHVybiBldGMuCgkgKiBSZXR1cm5zOiAgYm9vbDogLSBhbGxvdyBicm93c2VyIGRlZmF1bHQgYWN0aW9uCgkgKiBJbnB1dHM6ICAgZXZlbnQ6ZSAtIGtleSBldmVudAoJICovCglmdW5jdGlvbiBfZm5LZXkgKCBlICkKCXsKCQkvKiBJZiB1c2VyIG9yIHN5c3RlbSBoYXMgYmxvY2tlZCBLZXlUYWJsZSBmcm9tIGRvaW5nIGFueXRoaW5nLCBqdXN0IGlnbm9yZSB0aGlzIGV2ZW50ICovCgkJaWYgKCBfdGhhdC5ibG9jayB8fCAhX2JLZXlDYXB0dXJlICkKCQl7CgkJCXJldHVybiB0cnVlOwoJCX0KCgkJLyogSWYgYSBtb2RpZmllciBrZXkgaXMgcHJlc3NlZCAoZXhhcGN0IHNoaWZ0KSwgaWdub3JlIHRoZSBldmVudCAqLwoJCWlmICggZS5tZXRhS2V5IHx8IGUuYWx0S2V5IHx8IGUuY3RybEtleSApCgkJewoJCQlyZXR1cm4gdHJ1ZTsKCQl9CgkJdmFyCgkJCXgsIHksCgkJCWlUYWJsZVdpZHRoID0gX25Cb2R5LmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0cicpWzBdLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0ZCcpLmxlbmd0aCwKCQkJaVRhYmxlSGVpZ2h0OwoKCQkvKiBHZXQgdGFibGUgaGVpZ2h0IGFuZCB3aWR0aCAtIGRvbmUgaGVyZSBzbyBhcyB0byBiZSBkeW5hbWljIChpZiB0YWJsZSBpcyB1cGRhdGVkKSAqLwoJCWlmICggX29EYXRhdGFibGUgKQoJCXsKCQkJLyogCgkJCSAqIExvY2F0ZSB0aGUgY3VycmVudCBub2RlIGluIHRoZSBEYXRhVGFibGUgb3ZlcnJpZGluZyB0aGUgb2xkIHBvc2l0aW9ucyAtIHRoZSByZWFzb24gZm9yCgkJCSAqIGlzIGlzIHRoYXQgdGhlcmUgbWlnaHQgaGF2ZSBiZWVuIHNvbWUgRGF0YVRhYmxlcyBpbnRlcmFjdGlvbiBiZXR3ZWVuIHRoZSBsYXN0IGZvY3VzIGFuZAoJCQkgKiBub3cKCQkJICovCgkJCWlUYWJsZUhlaWdodCA9IF9vRGF0YXRhYmxlLmFpRGlzcGxheS5sZW5ndGg7CgoJCQl2YXIgYUR0UG9zID0gX2ZuRmluZER0Q2VsbCggX25PbGRGb2N1cyApOwoJCQlpZiAoIGFEdFBvcyA9PT0gbnVsbCApCgkJCXsKCQkJCS8qIElmIHRoZSB0YWJsZSBoYXMgYmVlbiB1cGRhdGVkIHN1Y2ggdGhhdCB0aGUgZm9jdXNlZCBjZWxsIGNhbid0IGJlIHNlZW4gLSBkbyBub3RoaW5nICovCgkJCQlyZXR1cm47CgkJCX0KCQkJX2lPbGRYID0gYUR0UG9zWyAwIF07CgkJCV9pT2xkWSA9IGFEdFBvc1sgMSBdOwoJCX0KCQllbHNlCgkJewoJCQlpVGFibGVIZWlnaHQgPSBfbkJvZHkuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RyJykubGVuZ3RoOwoJCX0KCgkJLyogQ2FwdHVyZSBzaGlmdCt0YWIgdG8gbWF0Y2ggdGhlIGxlZnQgYXJyb3cga2V5ICovCgkJdmFyIGlLZXkgPSAoZS5rZXlDb2RlID09IDkgJiYgZS5zaGlmdEtleSkgPyAtMSA6IGUua2V5Q29kZTsKCgkJc3dpdGNoKCBpS2V5ICkKCQl7CgkJCWNhc2UgMTM6IC8qIHJldHVybiAqLwoJCQkJZS5wcmV2ZW50RGVmYXVsdCgpOwoJCQkJZS5zdG9wUHJvcGFnYXRpb24oKTsKCQkJCV9mbkV2ZW50RmlyZSggImFjdGlvbiIsIF9pT2xkWCwgX2lPbGRZICk7CgkJCQlyZXR1cm4gdHJ1ZTsKCgkJCWNhc2UgMjc6IC8qIGVzYyAqLwoJCQkJaWYgKCAhX2ZuRXZlbnRGaXJlKCAiZXNjIiwgX2lPbGRYLCBfaU9sZFkgKSApCgkJCQl7CgkJCQkJLyogT25seSBsb3NlIGZvY3VzIGlmIHRoZXJlIGlzbid0IGFuIGVzY2FwZSBoYW5kbGVyIG9uIHRoZSBjZWxsICovCgkJCQkJX2ZuQmx1cigpOwoJCQkJCXJldHVybjsKCQkJCX0KCQkJCXggPSBfaU9sZFg7CgkJCQl5ID0gX2lPbGRZOwoJCQkJYnJlYWs7CgoJCQljYXNlIC0xOgoJCQljYXNlIDM3OiAvKiBsZWZ0IGFycm93ICovCgkJCQlpZiAoIF9pT2xkWCA+IDAgKSB7CgkJCQkJeCA9IF9pT2xkWCAtIDE7CgkJCQkJeSA9IF9pT2xkWTsKCQkJCX0gZWxzZSBpZiAoIF9pT2xkWSA+IDAgKSB7CgkJCQkJeCA9IGlUYWJsZVdpZHRoLTE7CgkJCQkJeSA9IF9pT2xkWSAtIDE7CgkJCQl9IGVsc2UgewoJCQkJCS8qIGF0IHN0YXJ0IG9mIHRhYmxlICovCgkJCQkJaWYgKCBpS2V5ID09IC0xICYmIF9iRm9ybSApCgkJCQkJewoJCQkJCQkvKiBJZiB3ZSBhcmUgaW4gYSBmb3JtLCByZXR1cm4gZm9jdXMgdG8gdGhlICdpbnB1dCcgZWxlbWVudCBzdWNoIHRoYXQgdGFiYmluZyB3aWxsCgkJCQkJCSAqIGZvbGxvdyBjb3JyZWN0bHkgaW4gdGhlIGJyb3dzZXIKCQkJCQkJICovCgkJCQkJCV9iSW5wdXRGb2N1c2VkID0gdHJ1ZTsKCQkJCQkJX25JbnB1dC5mb2N1cygpOwoKCQkJCQkJLyogVGhpcyB0aW1lb3V0IGlzIGEgbGl0dGxlIG5hc3R5IC0gYnV0IElFIGFwcGVhcnMgdG8gaGF2ZSBzb21lIGFzeWhuYyBiZWhhdmlvdXIgZm9yIAoJCQkJCQkgKiBmb2N1cwoJCQkJCQkgKi8KCQkJCQkJc2V0VGltZW91dCggZnVuY3Rpb24oKXsgX2JJbnB1dEZvY3VzZWQgPSBmYWxzZTsgfSwgMCApOwoJCQkJCQlfYktleUNhcHR1cmUgPSBmYWxzZTsKCQkJCQkJX2ZuQmx1cigpOwoJCQkJCQlyZXR1cm4gdHJ1ZTsKCQkJCQl9CgkJCQkJZWxzZQoJCQkJCXsKCQkJCQkJcmV0dXJuIGZhbHNlOwoJCQkJCX0KCQkJCX0KCQkJCWJyZWFrOwoKCQkJY2FzZSAzODogLyogdXAgYXJyb3cgKi8KCQkJCWlmICggX2lPbGRZID4gMCApIHsKCQkJCQl4ID0gX2lPbGRYOwoJCQkJCXkgPSBfaU9sZFkgLSAxOwoJCQkJfSBlbHNlIHsKCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9CgkJCQlicmVhazsKCgkJCWNhc2UgMzY6IC8qIGhvbWUgKi8KCQkJCXggPSBfaU9sZFg7CgkJCQl5ID0gMDsKCQkJCWJyZWFrOwoKCQkJY2FzZSAzMzogLyogcGFnZSB1cCAqLwoJCQkJeCA9IF9pT2xkWDsKCQkJCXkgPSBfaU9sZFkgLSAxMDsKCQkJCWlmICh5IDwgMCkgewoJCQkJCXkgPSAwOwoJCQkJfQoJCQkJYnJlYWs7CgoJCQljYXNlIDk6IC8qIHRhYiAqLwoJCQljYXNlIDM5OiAvKiByaWdodCBhcnJvdyAqLwoJCQkJaWYgKCBfaU9sZFggPCBpVGFibGVXaWR0aC0xICkgewoJCQkJCXggPSBfaU9sZFggKyAxOwoJCQkJCXkgPSBfaU9sZFk7CgkJCQl9IGVsc2UgaWYgKCBfaU9sZFkgPCBpVGFibGVIZWlnaHQtMSApIHsKCQkJCQl4ID0gMDsKCQkJCQl5ID0gX2lPbGRZICsgMTsKCQkJCX0gZWxzZSB7CgkJCQkJLyogYXQgZW5kIG9mIHRhYmxlICovCgkJCQkJaWYgKCBpS2V5ID09IDkgJiYgX2JGb3JtICkKCQkJCQl7CgkJCQkJCS8qIElmIHdlIGFyZSBpbiBhIGZvcm0sIHJldHVybiBmb2N1cyB0byB0aGUgJ2lucHV0JyBlbGVtZW50IHN1Y2ggdGhhdCB0YWJiaW5nIHdpbGwKCQkJCQkJICogZm9sbG93IGNvcnJlY3RseSBpbiB0aGUgYnJvd3NlcgoJCQkJCQkgKi8KCQkJCQkJX2JJbnB1dEZvY3VzZWQgPSB0cnVlOwoJCQkJCQlfbklucHV0LmZvY3VzKCk7CgoJCQkJCQkvKiBUaGlzIHRpbWVvdXQgaXMgYSBsaXR0bGUgbmFzdHkgLSBidXQgSUUgYXBwZWFycyB0byBoYXZlIHNvbWUgYXN5aG5jIGJlaGF2aW91ciBmb3IgCgkJCQkJCSAqIGZvY3VzCgkJCQkJCSAqLwoJCQkJCQlzZXRUaW1lb3V0KCBmdW5jdGlvbigpeyBfYklucHV0Rm9jdXNlZCA9IGZhbHNlOyB9LCAwICk7CgkJCQkJCV9iS2V5Q2FwdHVyZSA9IGZhbHNlOwoJCQkJCQlfZm5CbHVyKCk7CgkJCQkJCXJldHVybiB0cnVlOwoJCQkJCX0KCQkJCQllbHNlCgkJCQkJewoJCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQkJfQoJCQkJfQoJCQkJYnJlYWs7CgoJCQljYXNlIDQwOiAvKiBkb3duIGFycm93ICovCgkJCQlpZiAoIF9pT2xkWSA8IGlUYWJsZUhlaWdodC0xICkgewoJCQkJCXggPSBfaU9sZFg7CgkJCQkJeSA9IF9pT2xkWSArIDE7CgkJCQl9IGVsc2UgewoJCQkJCXJldHVybiBmYWxzZTsKCQkJCX0KCQkJCWJyZWFrOwoKCQkJY2FzZSAzNTogLyogZW5kICovCgkJCQl4ID0gX2lPbGRYOwoJCQkJeSA9IGlUYWJsZUhlaWdodC0xOwoJCQkJYnJlYWs7CgoJCQljYXNlIDM0OiAvKiBwYWdlIGRvd24gKi8KCQkJCXggPSBfaU9sZFg7CgkJCQl5ID0gX2lPbGRZKzEwOwoJCQkJaWYgKHkgPiBpVGFibGVIZWlnaHQtMSkgewoJCQkJCXkgPSBpVGFibGVIZWlnaHQtMTsKCQkJCX0KCQkJCWJyZWFrOwoKCQkJZGVmYXVsdDogLyogTm90aGluZyB3ZSBhcmUgaW50ZXJlc3RlZCBpbiAqLwoJCQkJcmV0dXJuIHRydWU7CgkJfQoKCQlfZm5TZXRGb2N1cyggX2ZuQ2VsbEZyb21Db29yZHMoeCwgeSkgKTsKCQlyZXR1cm4gZmFsc2U7Cgl9CgoKCS8qCgkgKiBGdW5jdGlvbjogX2ZuQ2FwdHVyZUtleXMKCSAqIFB1cnBvc2U6ICBTdGFydCBjYXB0dXJpbmcga2V5IGV2ZW50cyBmb3IgdGhpcyB0YWJsZQoJICogUmV0dXJuczogIC0KCSAqIElucHV0czogICAtCgkgKi8KCWZ1bmN0aW9uIF9mbkNhcHR1cmVLZXlzKCApCgl7CgkJaWYgKCAhX2JLZXlDYXB0dXJlICkKCQl7CgkJCV9iS2V5Q2FwdHVyZSA9IHRydWU7CgkJfQoJfQoKCgkvKgoJICogRnVuY3Rpb246IF9mblJlbGVhc2VLZXlzCgkgKiBQdXJwb3NlOiAgU3RvcCBjYXB0dXJpbmcga2V5IGV2ZW50cyBmb3IgdGhpcyB0YWJsZQoJICogUmV0dXJuczogIC0KCSAqIElucHV0czogICAtCgkgKi8KCWZ1bmN0aW9uIF9mblJlbGVhc2VLZXlzKCApCgl7CgkJX2JLZXlDYXB0dXJlID0gZmFsc2U7Cgl9CgoKCgkvKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqCgkgKiBTdXBwb3J0IGZ1bmN0aW9ucwoJICovCgoJLyoKCSAqIEZ1bmN0aW9uOiBfZm5DZWxsRnJvbUNvb3JkcwoJICogUHVycG9zZTogIENhbHVsYXRlIHRoZSB0YXJnZXQgVEQgY2VsbCBmcm9tIHggYW5kIHkgY29vcmRpbmF0ZXMKCSAqIFJldHVybnM6ICBub2RlOiAtIFREIHRhcmdldAoJICogSW5wdXRzOiAgIGludDp4IC0geCBjb29yZGluYXRlCgkgKiAgICAgICAgICAgaW50OnkgLSB5IGNvb3JkaW5hdGUKCSAqLwoJZnVuY3Rpb24gX2ZuQ2VsbEZyb21Db29yZHMoIHgsIHkgKQoJewoJCWlmICggX29EYXRhdGFibGUgKQoJCXsKCQkJaWYgKCB0eXBlb2YgX29EYXRhdGFibGUuYW9EYXRhWyBfb0RhdGF0YWJsZS5haURpc3BsYXlbIHkgXSBdICE9ICd1bmRlZmluZWQnICkKCQkJewoJCQkJcmV0dXJuIF9vRGF0YXRhYmxlLmFvRGF0YVsgX29EYXRhdGFibGUuYWlEaXNwbGF5WyB5IF0gXS5uVHIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RkJylbeF07CgkJCX0KCQkJZWxzZQoJCQl7CgkJCQlyZXR1cm4gbnVsbDsKCQkJfQoJCX0KCQllbHNlCgkJewoJCQlyZXR1cm4gJCgndHI6ZXEoJyt5KycpPnRkOmVxKCcreCsnKScsIF9uQm9keSApWzBdOwoJCX0KCX0KCgoJLyoKCSAqIEZ1bmN0aW9uOiBfZm5Db29yZHNGcm9tQ2VsbAoJICogUHVycG9zZTogIENhbGN1bGF0ZSB0aGUgeCBhbmQgeSBwb3NpdGlvbiBpbiBhIHRhYmxlIGZyb20gYSBURCBjZWxsCgkgKiBSZXR1cm5zOiAgYXJyYXlbMl0gaW50OiBbeCwgeV0KCSAqIElucHV0czogICBub2RlOm4gLSBURCBjZWxsIG9mIGludGVyZXN0CgkgKiBOb3RlczogICAgTm90IGFjdHVhbGx5IGludGVyZXN0ZWQgaW4gdGhpcyBmb3IgRGF0YVRhYmxlcyBzaW5jZSBpdCBtaWdodCBnbyBvdXQgb2YgZGF0ZQoJICovCglmdW5jdGlvbiBfZm5Db29yZHNGcm9tQ2VsbCggbiApCgl7CgkJaWYgKCBfb0RhdGF0YWJsZSApCgkJewoJCQlyZXR1cm4gWwoJCQkJJCgndGQnLCBuLnBhcmVudE5vZGUpLmluZGV4KG4pLAoJCQkJJCgndHInLCBuLnBhcmVudE5vZGUucGFyZW50Tm9kZSkuaW5kZXgobi5wYXJlbnROb2RlKSArIF9vRGF0YXRhYmxlLl9pRGlzcGxheVN0YXJ0CgkJCV07CgkJfQoJCWVsc2UKCQl7CgkJCXJldHVybiBbCgkJCQkkKCd0ZCcsIG4ucGFyZW50Tm9kZSkuaW5kZXgobiksCgkJCQkkKCd0cicsIG4ucGFyZW50Tm9kZS5wYXJlbnROb2RlKS5pbmRleChuLnBhcmVudE5vZGUpCgkJCV07CgkJfQoJfQoKCgkvKgoJICogRnVuY3Rpb246IF9mblNldFNjcm9sbFRvcAoJICogUHVycG9zZTogIFNldCB0aGUgdmVydGljYWwgc2Nyb2xsaW5nIHBvc2l0aW9uCgkgKiBSZXR1cm5zOiAgLQoJICogSW5wdXRzOiAgIGludDppUG9zIC0gc2Nyb2xsdG9wCgkgKiBOb3RlczogICAgVGhpcyBpcyBzbyBuYXN0eSwgYnV0IHdpdGhvdXQgYnJvd3NlciBkZXRlY3Rpb24geW91IGNhbid0IHRlbGwgd2hpY2ggeW91IHNob3VsZCBzZXQKCSAqICAgICAgICAgICBTbyBvbiBicm93c2VycyB0aGF0IHN1cHBvcnQgYm90aCwgdGhlIHNjcm9sbCB0b3Agd2lsbCBiZSBzZXQgdHdpY2UuIEkgY2FuIGxpdmUgd2l0aAoJICogICAgICAgICAgIHRoYXQgOi0pCgkgKi8KCWZ1bmN0aW9uIF9mblNldFNjcm9sbFRvcCggaVBvcyApCgl7CgkJZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCA9IGlQb3M7CgkJZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgPSBpUG9zOwoJfQoKCgkvKgoJICogRnVuY3Rpb246IF9mblNldFNjcm9sbExlZnQKCSAqIFB1cnBvc2U6ICBTZXQgdGhlIGhvcml6b250YWwgc2Nyb2xsaW5nIHBvc2l0aW9uCgkgKiBSZXR1cm5zOiAgLQoJICogSW5wdXRzOiAgIGludDppUG9zIC0gc2Nyb2xsbGVmdAoJICovCglmdW5jdGlvbiBfZm5TZXRTY3JvbGxMZWZ0KCBpUG9zICkKCXsKCQlkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdCA9IGlQb3M7CgkJZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0ID0gaVBvczsKCX0KCgoJLyoKCSAqIEZ1bmN0aW9uOiBfZm5HZXRQb3MKCSAqIFB1cnBvc2U6ICBHZXQgdGhlIHBvc2l0aW9uIG9mIGFuIG9iamVjdCBvbiB0aGUgcmVuZGVyZWQgcGFnZQoJICogUmV0dXJuczogIGFycmF5WzJdIGludDogW2xlZnQsIHJpZ2h0XQoJICogSW5wdXRzOiAgIG5vZGU6b2JqIC0gZWxlbWVudCBvZiBpbnRlcmVzdAoJICovCglmdW5jdGlvbiBfZm5HZXRQb3MgKCBvYmogKQoJewoJCXZhciBpTGVmdCA9IDA7CgkJdmFyIGlUb3AgPSAwOwoKCQlpZiAob2JqLm9mZnNldFBhcmVudCkKCQl7CgkJCWlMZWZ0ID0gb2JqLm9mZnNldExlZnQ7CgkJCWlUb3AgPSBvYmoub2Zmc2V0VG9wOwoJCQlvYmogPSBvYmoub2Zmc2V0UGFyZW50OwoJCQl3aGlsZSAob2JqKQoJCQl7CgkJCQlpTGVmdCArPSBvYmoub2Zmc2V0TGVmdDsKCQkJCWlUb3AgKz0gb2JqLm9mZnNldFRvcDsKCQkJCW9iaiA9IG9iai5vZmZzZXRQYXJlbnQ7CgkJCX0KCQl9CgkJcmV0dXJuIFtpTGVmdCxpVG9wXTsKCX0KCgoJLyoKCSAqIEZ1bmN0aW9uOiBfZm5GaW5kRHRDZWxsCgkgKiBQdXJwb3NlOiAgR2V0IHRoZSBjb29yZHMuIG9mIGEgY2VsbCBmcm9tIHRoZSBEYXRhVGFibGVzIGludGVybmFsIGluZm9ybWF0aW9uCgkgKiBSZXR1cm5zOiAgYXJyYXlbMl0gaW50OiBbeCwgeV0gY29vcmRzLiBvciBudWxsIGlmIG5vdCBmb3VuZAoJICogSW5wdXRzOiAgIG5vZGU6blRhcmdldCAtIHRoZSBub2RlIG9mIGludGVyZXN0CgkgKi8KCWZ1bmN0aW9uIF9mbkZpbmREdENlbGwoIG5UYXJnZXQgKQoJewoJCWZvciAoIHZhciBpPTAsIGlMZW49X29EYXRhdGFibGUuYWlEaXNwbGF5Lmxlbmd0aCA7IGk8aUxlbiA7IGkrKyApCgkJewoJCQl2YXIgblRyID0gX29EYXRhdGFibGUuYW9EYXRhWyBfb0RhdGF0YWJsZS5haURpc3BsYXlbaV0gXS5uVHI7CgkJCXZhciBuVGRzID0gblRyLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0ZCcpOwoJCQlmb3IgKCB2YXIgaj0wLCBqTGVuPW5UZHMubGVuZ3RoIDsgajxqTGVuIDsgaisrICkKCQkJewoJCQkJaWYgKCBuVGRzW2pdID09IG5UYXJnZXQgKQoJCQkJewoJCQkJCXJldHVybiBbIGosIGkgXTsKCQkJCX0KCQkJfQoJCX0KCQlyZXR1cm4gbnVsbDsKCX0KCgoKCS8qICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICogKiAqICoKCSAqIEluaXRpYWxpc2F0aW9uCgkgKi8KCgkvKgoJICogRnVuY3Rpb246IF9mbkluaXQKCSAqIFB1cnBvc2U6ICBJbml0aWFsaXNlIHRoZSBLZXlUYWJsZQoJICogUmV0dXJuczogIC0KCSAqIElucHV0czogICBvYmplY3Q6b0luaXQgLSBvcHRpb25hbCAtIEluaXRhbGlzYXRpb24gb2JqZWN0IHdpdGggdGhlIGZvbGxvd2luZyBwYXJhbWV0ZXJzOgoJICogICBhcnJheVsyXSBpbnQ6Zm9jdXMgLSB4IGFuZCB5IGNvb3JkaW5hdGVzIG9mIHRoZSBpbml0aWFsIHRhcmdldAoJICogICAgIG9yCgkgKiAgICAgbm9kZTpmb2N1cyAtIHRoZSBub2RlIHRvIHNldCBpbml0aWFsIGZvY3VzIG9uCgkgKiAgIG5vZGU6dGFibGUgLSB0aGUgdGFibGUgdG8gdXNlLCBpZiBub3QgZ2l2ZW4sIGZpcnN0IHRhYmxlIHdpdGggY2xhc3MgJ0tleVRhYmxlJyB3aWxsIGJlIHVzZWQKCSAqICAgc3RyaW5nOmZvY3VzQ2xhc3MgLSBmb2N1c2luZyBjbGFzcyB0byBnaXZlIHRvIHRhYmxlIGVsZW1lbnRzCgkgKiAgICAgICAgICAgb2JqZWN0OnRoYXQgLSBmb2N1cwoJICogICBib29sOmluaXRTY3JvbGwgLSBzY3JvbGwgdGhlIHZpZXcgcG9ydCBvbiBsb2FkLCBkZWZhdWx0IHRydWUKCSAqICAgaW50OnRhYkluZGV4IC0gdGhlIHRhYiBpbmRleCB0byBnaXZlIHRoZSBoaWRkZW4gaW5wdXQgZWxlbWVudAoJICovCglmdW5jdGlvbiBfZm5Jbml0KCB0YWJsZSwgZGF0YXRhYmxlLCBvSW5pdCwgdGhhdCApCgl7CgkJLyogU2F2ZSBzY29wZSAqLwoJCV90aGF0ID0gdGhhdDsKCgkJLyogQ2FwdHVyZSB1bmRlZmluZWQgaW5pdGlhbGlzYXRpb24gYW5kIGFwcGx5IHRoZSBkZWZhdWx0cyAqLwoJCWlmICggdHlwZW9mIG9Jbml0ID09ICd1bmRlZmluZWQnICkgewoJCQlvSW5pdCA9IHt9OwoJCX0KCgkJaWYgKCB0eXBlb2Ygb0luaXQuZm9jdXMgPT0gJ3VuZGVmaW5lZCcgKSB7CgkJCW9Jbml0LmZvY3VzID0gWzAsMF07CgkJfQoKCQlvSW5pdC50YWJsZSA9IHRhYmxlOwoJCSQob0luaXQudGFibGUpLmFkZENsYXNzKCdLZXlUYWJsZScpOwoKCQlpZiAoIHR5cGVvZiBvSW5pdC5mb2N1c0NsYXNzICE9ICd1bmRlZmluZWQnICkgewoJCQlfc0ZvY3VzQ2xhc3MgPSBvSW5pdC5mb2N1c0NsYXNzOwoJCX0KCgkJaWYgKCB0eXBlb2YgZGF0YXRhYmxlICE9ICd1bmRlZmluZWQnICkgewoJCQlfb0RhdGF0YWJsZSA9IGRhdGF0YWJsZTsKCQl9CgoJCWlmICggdHlwZW9mIG9Jbml0LmluaXRTY3JvbGwgPT0gJ3VuZGVmaW5lZCcgKSB7CgkJCW9Jbml0LmluaXRTY3JvbGwgPSB0cnVlOwoJCX0KCgkJaWYgKCB0eXBlb2Ygb0luaXQuZm9ybSA9PSAndW5kZWZpbmVkJyApIHsKCQkJb0luaXQuZm9ybSA9IGZhbHNlOwoJCX0KCQlfYkZvcm0gPSBvSW5pdC5mb3JtOwoKCQkvKiBDYWNoZSB0aGUgdGJvZHkgbm9kZSBvZiBpbnRlcmVzdCAqLwoJCV9uQm9keSA9IG9Jbml0LnRhYmxlLmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0Ym9keScpWzBdOwoKCQkvKiBJZiB0aGUgdGFibGUgaXMgaW5zaWRlIGEgZm9ybSwgdGhlbiB3ZSBuZWVkIGEgaGlkZGVuIGlucHV0IGJveCB3aGljaCBjYW4gYmUgdXNlZCBieSB0aGUKCQkgKiBicm93c2VyIHRvIGNhdGNoIHRoZSBicm93c2VyIHRhYmJpbmcgZm9yIG91ciB0YWJsZQoJCSAqLwoJCWlmICggX2JGb3JtICkKCQl7CgkJCXZhciBuRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CgkJCV9uSW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpOwoJCQluRGl2LnN0eWxlLmhlaWdodCA9ICIxcHgiOyAvKiBPcGVyYSByZXF1aXJlcyBhIGxpdHRsZSBzb21ldGhpbmcgKi8KCQkJbkRpdi5zdHlsZS53aWR0aCA9ICIwcHgiOwoJCQluRGl2LnN0eWxlLm92ZXJmbG93ID0gImhpZGRlbiI7CgkJCWlmICggdHlwZW9mIG9Jbml0LnRhYkluZGV4ICE9ICd1bmRlZmluZWQnICkKCQkJewoJCQkJX25JbnB1dC50YWJJbmRleCA9IG9Jbml0LnRhYkluZGV4OwoJCQl9CgkJCW5EaXYuYXBwZW5kQ2hpbGQoX25JbnB1dCk7CgkJCW9Jbml0LnRhYmxlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKCBuRGl2LCBvSW5pdC50YWJsZS5uZXh0U2libGluZyApOwoKCQkJJChfbklucHV0KS5mb2N1cyggZnVuY3Rpb24gKCkgewoJCQkJLyogU2VlIGlmIHdlIHdhbnQgdG8gJ3RhYiBpbnRvJyB0aGUgdGFibGUgb3Igb3V0ICovCgkJCQlpZiAoICFfYklucHV0Rm9jdXNlZCApCgkJCQl7CgkJCQkJX2JLZXlDYXB0dXJlID0gdHJ1ZTsKCQkJCQlfYklucHV0Rm9jdXNlZCA9IGZhbHNlOwoJCQkJCWlmICggdHlwZW9mIG9Jbml0LmZvY3VzLm5vZGVOYW1lICE9ICJ1bmRlZmluZWQiICkKCQkJCQl7CgkJCQkJCV9mblNldEZvY3VzKCBvSW5pdC5mb2N1cywgb0luaXQuaW5pdFNjcm9sbCApOwoJCQkJCX0KCQkJCQllbHNlCgkJCQkJewoJCQkJCQlfZm5TZXRGb2N1cyggX2ZuQ2VsbEZyb21Db29yZHMoIG9Jbml0LmZvY3VzWzBdLCBvSW5pdC5mb2N1c1sxXSksIG9Jbml0LmluaXRTY3JvbGwgKTsKCQkJCQl9CgoJCQkJCS8qIE5lZWQgdG8gaW50ZXJ1cCB0aGUgdGhyZWFkIGZvciB0aGlzIHRvIHdvcmsgKi8KCQkJCQlzZXRUaW1lb3V0KCBmdW5jdGlvbigpIHsgX25JbnB1dC5ibHVyKCk7IH0sIDAgKTsKCQkJCX0KCQkJfSApOwoJCQlfYktleUNhcHR1cmUgPSBmYWxzZTsKCQl9CgkJZWxzZQoJCXsKCQkJLyogU2V0IHRoZSBpbml0aWFsIGZvY3VzIG9uIHRoZSB0YWJsZSAqLwoJCQlpZiAoIHR5cGVvZiBvSW5pdC5mb2N1cy5ub2RlTmFtZSAhPSAidW5kZWZpbmVkIiApCgkJCXsKCQkJCV9mblNldEZvY3VzKCBvSW5pdC5mb2N1cywgb0luaXQuaW5pdFNjcm9sbCApOwoJCQl9CgkJCWVsc2UKCQkJewoJCQkJX2ZuU2V0Rm9jdXMoIF9mbkNlbGxGcm9tQ29vcmRzKCBvSW5pdC5mb2N1c1swXSwgb0luaXQuZm9jdXNbMV0pLCBvSW5pdC5pbml0U2Nyb2xsICk7CgkJCX0KCQkJX2ZuQ2FwdHVyZUtleXMoKTsKCQl9CgoJCS8qIEFkZCBldmVudCBsaXN0ZW5lcnMgKi8KCQkkKGRvY3VtZW50KS5iaW5kKCAia2V5ZG93biIsIF9mbktleSApOwoKCQlpZiAoIF9vRGF0YXRhYmxlICkKCQl7CgkJCSQoX29EYXRhdGFibGUublRhYmxlKS5vbiggJ2NsaWNrJywgJ3RkJywgX2ZuQ2xpY2sgKTsKCQl9CgkJZWxzZQoJCXsKCQkJJChfbkJvZHkpLm9uKCAnY2xpY2snLCAndGQnLCBfZm5DbGljayApOwoJCX0KCgkJLyogTG9vc2UgdGFibGUgZm9jdXMgd2hlbiBjbGljayBvdXRzaWRlIHRoZSB0YWJsZSAqLwoJCSQoZG9jdW1lbnQpLmNsaWNrKCBmdW5jdGlvbihlKSB7CgkJCXZhciBuVGFyZ2V0ID0gZS50YXJnZXQ7CgkJCXZhciBiVGFibGVDbGljayA9IGZhbHNlOwoJCQl3aGlsZSAoIG5UYXJnZXQgKQoJCQl7CgkJCQlpZiAoIG5UYXJnZXQgPT0gb0luaXQudGFibGUgKQoJCQkJewoJCQkJCWJUYWJsZUNsaWNrID0gdHJ1ZTsKCQkJCQlicmVhazsKCQkJCX0KCQkJCW5UYXJnZXQgPSBuVGFyZ2V0LnBhcmVudE5vZGU7CgkJCX0KCQkJaWYgKCAhYlRhYmxlQ2xpY2sgKQoJCQl7CgkJCQlfZm5CbHVyKCk7CgkJCX0KCQl9ICk7Cgl9CgoJdmFyIHRhYmxlLCBkYXRhdGFibGU7CgoJaWYgKCBvSW5pdCA9PT0gdW5kZWZpbmVkICkgewoJCXRhYmxlID0gJCgndGFibGUuS2V5VGFibGUnKVswXTsKCQlkYXRhdGFibGUgPSBudWxsOwoJfQoJZWxzZSBpZiAoICQuaXNQbGFpbk9iamVjdCggb0luaXQgKSApIHsKCQl0YWJsZSA9IG9Jbml0LnRhYmxlOwoJCWRhdGF0YWJsZSA9IG9Jbml0LmRhdGF0YWJsZTsKCX0KCWVsc2UgewoJCWRhdGF0YWJsZSA9IG5ldyAkLmZuLmRhdGFUYWJsZS5BcGkoIG9Jbml0ICkuc2V0dGluZ3MoKVswXTsKCQl0YWJsZSA9IGRhdGF0YWJsZS5uVGFibGU7Cgl9CgkvKiBJbml0aWFsaXNlIG91ciBuZXcgb2JqZWN0ICovCglfZm5Jbml0KCB0YWJsZSwgZGF0YXRhYmxlLCBvSW5pdCwgdGhpcyApOwp9OwoKCktleVRhYmxlLnZlcnNpb24gPSAiMS4yLjEiOwoKCiQuZm4uZGF0YVRhYmxlLktleVRhYmxlID0gS2V5VGFibGU7CiQuZm4uRGF0YVRhYmxlLktleVRhYmxlID0gS2V5VGFibGU7CgoKcmV0dXJuIEtleVRhYmxlOwp9OyAvLyAvZmFjdG9yeQoKCi8vIERlZmluZSBhcyBhbiBBTUQgbW9kdWxlIGlmIHBvc3NpYmxlCmlmICggdHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kICkgewoJZGVmaW5lKCBbJ2pxdWVyeScsICdkYXRhdGFibGVzJ10sIGZhY3RvcnkgKTsKfQplbHNlIGlmICggdHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICkgewogICAgLy8gTm9kZS9Db21tb25KUwogICAgZmFjdG9yeSggcmVxdWlyZSgnanF1ZXJ5JyksIHJlcXVpcmUoJ2RhdGF0YWJsZXMnKSApOwp9CmVsc2UgaWYgKCBqUXVlcnkgJiYgIWpRdWVyeS5mbi5kYXRhVGFibGUuS2V5VGFibGUgKSB7CgkvLyBPdGhlcndpc2Ugc2ltcGx5IGluaXRpYWxpc2UgYXMgbm9ybWFsLCBzdG9wcGluZyBtdWx0aXBsZSBldmFsdWF0aW9uCglmYWN0b3J5KCBqUXVlcnksIGpRdWVyeS5mbi5kYXRhVGFibGUgKTsKfQoKCn0pKHdpbmRvdywgZG9jdW1lbnQpOwo=",
    "size": "29477"
}